(function(t, e, i) {
    function n(i) {
        var r = e[i];
        if (!r) {
            var s = t[i];
            if (!s) return;
            var o = {};
            r = e[i] = {
                exports: o
            }, s[0](function(t) {
                return n(s[1][t] || t);
            }, r, o);
        }
        return r.exports;
    }
    for (var r = 0; r < i.length; r++) n(i[r]);
})({
    1: [ function(t) {
        "use strict";
        t("../core/platform/CCClass");
        var e = t("../core/utils/misc");
        cc.Action = cc.Class({
            name: "cc.Action",
            ctor: function() {
                this.originalTarget = null, this.target = null, this.tag = cc.Action.TAG_INVALID;
            },
            clone: function() {
                var t = new cc.Action();
                return t.originalTarget = null, t.target = null, t.tag = this.tag, t;
            },
            isDone: function() {
                return !0;
            },
            startWithTarget: function(t) {
                this.originalTarget = t, this.target = t;
            },
            stop: function() {
                this.target = null;
            },
            step: function() {
                cc.logID(1006);
            },
            update: function() {
                cc.logID(1007);
            },
            getTarget: function() {
                return this.target;
            },
            setTarget: function(t) {
                this.target = t;
            },
            getOriginalTarget: function() {
                return this.originalTarget;
            },
            setOriginalTarget: function(t) {
                this.originalTarget = t;
            },
            getTag: function() {
                return this.tag;
            },
            setTag: function(t) {
                this.tag = t;
            },
            retain: function() {},
            release: function() {}
        }), cc.Action.TAG_INVALID = -1, cc.FiniteTimeAction = cc.Class({
            name: "cc.FiniteTimeAction",
            extends: cc.Action,
            ctor: function() {
                this._duration = 0;
            },
            getDuration: function() {
                return this._duration * (this._timesForRepeat || 1);
            },
            setDuration: function(t) {
                this._duration = t;
            },
            reverse: function() {
                return cc.logID(1008), null;
            },
            clone: function() {
                return new cc.FiniteTimeAction();
            }
        }), cc.Speed = cc.Class({
            name: "cc.Speed",
            extends: cc.Action,
            ctor: function(t, e) {
                this._speed = 0, this._innerAction = null, t && this.initWithAction(t, e);
            },
            getSpeed: function() {
                return this._speed;
            },
            setSpeed: function(t) {
                this._speed = t;
            },
            initWithAction: function(t, e) {
                return t ? (this._innerAction = t, this._speed = e, !0) : (cc.errorID(1021), !1);
            },
            clone: function() {
                var t = new cc.Speed();
                return t.initWithAction(this._innerAction.clone(), this._speed), t;
            },
            startWithTarget: function(t) {
                cc.Action.prototype.startWithTarget.call(this, t), this._innerAction.startWithTarget(t);
            },
            stop: function() {
                this._innerAction.stop(), cc.Action.prototype.stop.call(this);
            },
            step: function(t) {
                this._innerAction.step(t * this._speed);
            },
            isDone: function() {
                return this._innerAction.isDone();
            },
            reverse: function() {
                return new cc.Speed(this._innerAction.reverse(), this._speed);
            },
            setInnerAction: function(t) {
                this._innerAction !== t && (this._innerAction = t);
            },
            getInnerAction: function() {
                return this._innerAction;
            }
        }), cc.speed = function(t, e) {
            return new cc.Speed(t, e);
        }, cc.Follow = cc.Class({
            name: "cc.Follow",
            extends: cc.Action,
            ctor: function(t, e) {
                this._followedNode = null, this._boundarySet = !1, this._boundaryFullyCovered = !1, 
                this._halfScreenSize = null, this._fullScreenSize = null, this.leftBoundary = 0, 
                this.rightBoundary = 0, this.topBoundary = 0, this.bottomBoundary = 0, this._worldRect = cc.rect(0, 0, 0, 0), 
                t && (e ? this.initWithTarget(t, e) : this.initWithTarget(t));
            },
            clone: function() {
                var t = new cc.Follow(), e = this._worldRect, i = new cc.Rect(e.x, e.y, e.width, e.height);
                return t.initWithTarget(this._followedNode, i), t;
            },
            isBoundarySet: function() {
                return this._boundarySet;
            },
            setBoudarySet: function(t) {
                this._boundarySet = t;
            },
            initWithTarget: function(t, e) {
                if (!t) return cc.errorID(1022), !1;
                e = e || cc.rect(0, 0, 0, 0), this._followedNode = t, this._worldRect = e, this._boundarySet = !(0 === e.width && 0 === e.height), 
                this._boundaryFullyCovered = !1;
                var i = cc.winSize;
                return this._fullScreenSize = cc.v2(i.width, i.height), this._halfScreenSize = this._fullScreenSize.mul(.5), 
                this._boundarySet && (this.leftBoundary = -(e.x + e.width - this._fullScreenSize.x), 
                this.rightBoundary = -e.x, this.topBoundary = -e.y, this.bottomBoundary = -(e.y + e.height - this._fullScreenSize.y), 
                this.rightBoundary < this.leftBoundary && (this.rightBoundary = this.leftBoundary = (this.leftBoundary + this.rightBoundary) / 2), 
                this.topBoundary < this.bottomBoundary && (this.topBoundary = this.bottomBoundary = (this.topBoundary + this.bottomBoundary) / 2), 
                this.topBoundary === this.bottomBoundary && this.leftBoundary === this.rightBoundary && (this._boundaryFullyCovered = !0)), 
                !0;
            },
            step: function() {
                var t = this.target.convertToWorldSpaceAR(cc.Vec2.ZERO), i = this._followedNode.convertToWorldSpaceAR(cc.Vec2.ZERO), n = t.sub(i), r = this.target.parent.convertToNodeSpaceAR(n.add(this._halfScreenSize));
                if (this._boundarySet) {
                    if (this._boundaryFullyCovered) return;
                    this.target.setPosition(e.clampf(r.x, this.leftBoundary, this.rightBoundary), e.clampf(r.y, this.bottomBoundary, this.topBoundary));
                } else this.target.setPosition(r.x, r.y);
            },
            isDone: function() {
                return !this._followedNode.activeInHierarchy;
            },
            stop: function() {
                this.target = null, cc.Action.prototype.stop.call(this);
            }
        }), cc.follow = function(t, e) {
            return new cc.Follow(t, e);
        };
    }, {
        "../core/platform/CCClass": 182,
        "../core/utils/misc": 256
    } ],
    2: [ function() {
        "use strict";
        function t(t, e, i, n, r, s) {
            var o = s * s, a = o * s, c = (1 - r) / 2, l = c * (2 * o - a - s), u = c * (-a + o) + (2 * a - 3 * o) + 1, h = c * (a - 2 * o + s) + -2 * a + 3 * o, _ = c * (a - o), f = t.x * l + e.x * u + i.x * h + n.x * _, d = t.y * l + e.y * u + i.y * h + n.y * _;
            return cc.v2(f, d);
        }
        function e(t, e) {
            return t[Math.min(t.length - 1, Math.max(e, 0))];
        }
        function i(t) {
            for (var e = [], i = t.length - 1; i >= 0; i--) e.push(cc.v2(t[i].x, t[i].y));
            return e;
        }
        function n(t) {
            for (var e = [], i = 0; i < t.length; i++) e.push(cc.v2(t[i].x, t[i].y));
            return e;
        }
        cc.CardinalSplineTo = cc.Class({
            name: "cc.CardinalSplineTo",
            extends: cc.ActionInterval,
            ctor: function(t, e, i) {
                this._points = [], this._deltaT = 0, this._tension = 0, this._previousPosition = null, 
                this._accumulatedDiff = null, void 0 !== i && cc.CardinalSplineTo.prototype.initWithDuration.call(this, t, e, i);
            },
            initWithDuration: function(t, e, i) {
                return e && 0 !== e.length ? !!cc.ActionInterval.prototype.initWithDuration.call(this, t) && (this.setPoints(e), 
                this._tension = i, !0) : (cc.errorID(1024), !1);
            },
            clone: function() {
                var t = new cc.CardinalSplineTo();
                return t.initWithDuration(this._duration, n(this._points), this._tension), t;
            },
            startWithTarget: function(t) {
                cc.ActionInterval.prototype.startWithTarget.call(this, t), this._deltaT = 1 / (this._points.length - 1), 
                this._previousPosition = cc.v2(this.target.x, this.target.y), this._accumulatedDiff = cc.v2(0, 0);
            },
            update: function(i) {
                var n, r;
                i = this._computeEaseTime(i);
                var s = this._points;
                if (1 === i) n = s.length - 1, r = 1; else {
                    var o = this._deltaT;
                    r = (i - o * (n = 0 | i / o)) / o;
                }
                var a, c, l = t(e(s, n - 1), e(s, n - 0), e(s, n + 1), e(s, n + 2), this._tension, r);
                if (cc.macro.ENABLE_STACKABLE_ACTIONS && (a = this.target.x - this._previousPosition.x, 
                c = this.target.y - this._previousPosition.y, 0 !== a || 0 !== c)) {
                    var u = this._accumulatedDiff;
                    a = u.x + a, c = u.y + c, u.x = a, u.y = c, l.x += a, l.y += c;
                }
                this.updatePosition(l);
            },
            reverse: function() {
                var t = i(this._points);
                return cc.cardinalSplineTo(this._duration, t, this._tension);
            },
            updatePosition: function(t) {
                this.target.setPosition(t), this._previousPosition = t;
            },
            getPoints: function() {
                return this._points;
            },
            setPoints: function(t) {
                this._points = t;
            }
        }), cc.cardinalSplineTo = function(t, e, i) {
            return new cc.CardinalSplineTo(t, e, i);
        }, cc.CardinalSplineBy = cc.Class({
            name: "cc.CardinalSplineBy",
            extends: cc.CardinalSplineTo,
            ctor: function(t, e, i) {
                this._startPosition = cc.v2(0, 0), void 0 !== i && this.initWithDuration(t, e, i);
            },
            startWithTarget: function(t) {
                cc.CardinalSplineTo.prototype.startWithTarget.call(this, t), this._startPosition.x = t.x, 
                this._startPosition.y = t.y;
            },
            reverse: function() {
                for (var t, e = this._points.slice(), n = e[0], r = 1; r < e.length; ++r) t = e[r], 
                e[r] = t.sub(n), n = t;
                var s = i(e);
                for (n = s[s.length - 1], s.pop(), n.x = -n.x, n.y = -n.y, s.unshift(n), r = 1; r < s.length; ++r) (t = s[r]).x = -t.x, 
                t.y = -t.y, t.x += n.x, t.y += n.y, s[r] = t, n = t;
                return cc.cardinalSplineBy(this._duration, s, this._tension);
            },
            updatePosition: function(t) {
                var e = this._startPosition, i = t.x + e.x, n = t.y + e.y;
                this._previousPosition.x = i, this._previousPosition.y = n, this.target.setPosition(i, n);
            },
            clone: function() {
                var t = new cc.CardinalSplineBy();
                return t.initWithDuration(this._duration, n(this._points), this._tension), t;
            }
        }), cc.cardinalSplineBy = function(t, e, i) {
            return new cc.CardinalSplineBy(t, e, i);
        }, cc.CatmullRomTo = cc.Class({
            name: "cc.CatmullRomTo",
            extends: cc.CardinalSplineTo,
            ctor: function(t, e) {
                e && this.initWithDuration(t, e);
            },
            initWithDuration: function(t, e) {
                return cc.CardinalSplineTo.prototype.initWithDuration.call(this, t, e, .5);
            },
            clone: function() {
                var t = new cc.CatmullRomTo();
                return t.initWithDuration(this._duration, n(this._points)), t;
            }
        }), cc.catmullRomTo = function(t, e) {
            return new cc.CatmullRomTo(t, e);
        }, cc.CatmullRomBy = cc.Class({
            name: "cc.CatmullRomBy",
            extends: cc.CardinalSplineBy,
            ctor: function(t, e) {
                e && this.initWithDuration(t, e);
            },
            initWithDuration: function(t, e) {
                return cc.CardinalSplineTo.prototype.initWithDuration.call(this, t, e, .5);
            },
            clone: function() {
                var t = new cc.CatmullRomBy();
                return t.initWithDuration(this._duration, n(this._points)), t;
            }
        }), cc.catmullRomBy = function(t, e) {
            return new cc.CatmullRomBy(t, e);
        };
    }, {} ],
    3: [ function() {
        "use strict";
        cc.easeIn = function(t) {
            return {
                _rate: t,
                easing: function(t) {
                    return Math.pow(t, this._rate);
                },
                reverse: function() {
                    return cc.easeIn(1 / this._rate);
                }
            };
        }, cc.easeOut = function(t) {
            return {
                _rate: t,
                easing: function(t) {
                    return Math.pow(t, 1 / this._rate);
                },
                reverse: function() {
                    return cc.easeOut(1 / this._rate);
                }
            };
        }, cc.easeInOut = function(t) {
            return {
                _rate: t,
                easing: function(t) {
                    return (t *= 2) < 1 ? .5 * Math.pow(t, this._rate) : 1 - .5 * Math.pow(2 - t, this._rate);
                },
                reverse: function() {
                    return cc.easeInOut(this._rate);
                }
            };
        };
        var t = {
            easing: function(t) {
                return 0 === t ? 0 : Math.pow(2, 10 * (t - 1));
            },
            reverse: function() {
                return e;
            }
        };
        cc.easeExponentialIn = function() {
            return t;
        };
        var e = {
            easing: function(t) {
                return 1 === t ? 1 : 1 - Math.pow(2, -10 * t);
            },
            reverse: function() {
                return t;
            }
        };
        cc.easeExponentialOut = function() {
            return e;
        };
        var i = {
            easing: function(t) {
                return 1 !== t && 0 !== t ? (t *= 2) < 1 ? .5 * Math.pow(2, 10 * (t - 1)) : .5 * (2 - Math.pow(2, -10 * (t - 1))) : t;
            },
            reverse: function() {
                return i;
            }
        };
        cc.easeExponentialInOut = function() {
            return i;
        };
        var n = {
            easing: function(t) {
                return 0 === t || 1 === t ? t : -1 * Math.cos(t * Math.PI / 2) + 1;
            },
            reverse: function() {
                return r;
            }
        };
        cc.easeSineIn = function() {
            return n;
        };
        var r = {
            easing: function(t) {
                return 0 === t || 1 === t ? t : Math.sin(t * Math.PI / 2);
            },
            reverse: function() {
                return n;
            }
        };
        cc.easeSineOut = function() {
            return r;
        };
        var s = {
            easing: function(t) {
                return 0 === t || 1 === t ? t : -.5 * (Math.cos(Math.PI * t) - 1);
            },
            reverse: function() {
                return s;
            }
        };
        cc.easeSineInOut = function() {
            return s;
        };
        var o = {
            easing: function(t) {
                return 0 === t || 1 === t ? t : (t -= 1, -Math.pow(2, 10 * t) * Math.sin((t - .075) * Math.PI * 2 / .3));
            },
            reverse: function() {
                return a;
            }
        };
        cc.easeElasticIn = function(t) {
            return t && .3 !== t ? {
                _period: t,
                easing: function(t) {
                    return 0 === t || 1 === t ? t : (t -= 1, -Math.pow(2, 10 * t) * Math.sin((t - this._period / 4) * Math.PI * 2 / this._period));
                },
                reverse: function() {
                    return cc.easeElasticOut(this._period);
                }
            } : o;
        };
        var a = {
            easing: function(t) {
                return 0 === t || 1 === t ? t : Math.pow(2, -10 * t) * Math.sin((t - .075) * Math.PI * 2 / .3) + 1;
            },
            reverse: function() {
                return o;
            }
        };
        function c(t) {
            return t < 1 / 2.75 ? 7.5625 * t * t : t < 2 / 2.75 ? 7.5625 * (t -= 1.5 / 2.75) * t + .75 : t < 2.5 / 2.75 ? 7.5625 * (t -= 2.25 / 2.75) * t + .9375 : 7.5625 * (t -= 2.625 / 2.75) * t + .984375;
        }
        cc.easeElasticOut = function(t) {
            return t && .3 !== t ? {
                _period: t,
                easing: function(t) {
                    return 0 === t || 1 === t ? t : Math.pow(2, -10 * t) * Math.sin((t - this._period / 4) * Math.PI * 2 / this._period) + 1;
                },
                reverse: function() {
                    return cc.easeElasticIn(this._period);
                }
            } : a;
        }, cc.easeElasticInOut = function(t) {
            return {
                _period: t = t || .3,
                easing: function(t) {
                    var e = 0, i = this._period;
                    if (0 === t || 1 === t) e = t; else {
                        t *= 2, i || (i = this._period = .3 * 1.5);
                        var n = i / 4;
                        e = (t -= 1) < 0 ? -.5 * Math.pow(2, 10 * t) * Math.sin((t - n) * Math.PI * 2 / i) : Math.pow(2, -10 * t) * Math.sin((t - n) * Math.PI * 2 / i) * .5 + 1;
                    }
                    return e;
                },
                reverse: function() {
                    return cc.easeElasticInOut(this._period);
                }
            };
        };
        var l = {
            easing: function(t) {
                return 1 - c(1 - t);
            },
            reverse: function() {
                return u;
            }
        };
        cc.easeBounceIn = function() {
            return l;
        };
        var u = {
            easing: function(t) {
                return c(t);
            },
            reverse: function() {
                return l;
            }
        };
        cc.easeBounceOut = function() {
            return u;
        };
        var h = {
            easing: function(t) {
                return t < .5 ? .5 * (1 - c(1 - (t *= 2))) : .5 * c(2 * t - 1) + .5;
            },
            reverse: function() {
                return h;
            }
        };
        cc.easeBounceInOut = function() {
            return h;
        };
        var _ = {
            easing: function(t) {
                return 0 === t || 1 === t ? t : t * t * (2.70158 * t - 1.70158);
            },
            reverse: function() {
                return f;
            }
        };
        cc.easeBackIn = function() {
            return _;
        };
        var f = {
            easing: function(t) {
                return 0 === t ? 0 : (t -= 1) * t * (2.70158 * t + 1.70158) + 1;
            },
            reverse: function() {
                return _;
            }
        };
        cc.easeBackOut = function() {
            return f;
        };
        var d = {
            easing: function(t) {
                return (t *= 2) < 1 ? t * t * (3.5949095 * t - 2.5949095) / 2 : (t -= 2) * t * (3.5949095 * t + 2.5949095) / 2 + 1;
            },
            reverse: function() {
                return d;
            }
        };
        cc.easeBackInOut = function() {
            return d;
        }, cc.easeBezierAction = function(t, e, i, n) {
            return {
                easing: function(r) {
                    return Math.pow(1 - r, 3) * t + 3 * r * Math.pow(1 - r, 2) * e + 3 * Math.pow(r, 2) * (1 - r) * i + Math.pow(r, 3) * n;
                },
                reverse: function() {
                    return cc.easeBezierAction(n, i, e, t);
                }
            };
        };
        var p = {
            easing: function(t) {
                return Math.pow(t, 2);
            },
            reverse: function() {
                return p;
            }
        };
        cc.easeQuadraticActionIn = function() {
            return p;
        };
        var m = {
            easing: function(t) {
                return -t * (t - 2);
            },
            reverse: function() {
                return m;
            }
        };
        cc.easeQuadraticActionOut = function() {
            return m;
        };
        var v = {
            easing: function(t) {
                return (t *= 2) < 1 ? t * t * .5 : -.5 * (--t * (t - 2) - 1);
            },
            reverse: function() {
                return v;
            }
        };
        cc.easeQuadraticActionInOut = function() {
            return v;
        };
        var y = {
            easing: function(t) {
                return t * t * t * t;
            },
            reverse: function() {
                return y;
            }
        };
        cc.easeQuarticActionIn = function() {
            return y;
        };
        var g = {
            easing: function(t) {
                return -((t -= 1) * t * t * t - 1);
            },
            reverse: function() {
                return g;
            }
        };
        cc.easeQuarticActionOut = function() {
            return g;
        };
        var x = {
            easing: function(t) {
                return (t *= 2) < 1 ? .5 * t * t * t * t : -.5 * ((t -= 2) * t * t * t - 2);
            },
            reverse: function() {
                return x;
            }
        };
        cc.easeQuarticActionInOut = function() {
            return x;
        };
        var A = {
            easing: function(t) {
                return t * t * t * t * t;
            },
            reverse: function() {
                return A;
            }
        };
        cc.easeQuinticActionIn = function() {
            return A;
        };
        var C = {
            easing: function(t) {
                return (t -= 1) * t * t * t * t + 1;
            },
            reverse: function() {
                return C;
            }
        };
        cc.easeQuinticActionOut = function() {
            return C;
        };
        var b = {
            easing: function(t) {
                return (t *= 2) < 1 ? .5 * t * t * t * t * t : .5 * ((t -= 2) * t * t * t * t + 2);
            },
            reverse: function() {
                return b;
            }
        };
        cc.easeQuinticActionInOut = function() {
            return b;
        };
        var S = {
            easing: function(t) {
                return -1 * (Math.sqrt(1 - t * t) - 1);
            },
            reverse: function() {
                return S;
            }
        };
        cc.easeCircleActionIn = function() {
            return S;
        };
        var T = {
            easing: function(t) {
                return t -= 1, Math.sqrt(1 - t * t);
            },
            reverse: function() {
                return T;
            }
        };
        cc.easeCircleActionOut = function() {
            return T;
        };
        var w = {
            easing: function(t) {
                return (t *= 2) < 1 ? -.5 * (Math.sqrt(1 - t * t) - 1) : (t -= 2, .5 * (Math.sqrt(1 - t * t) + 1));
            },
            reverse: function() {
                return w;
            }
        };
        cc.easeCircleActionInOut = function() {
            return w;
        };
        var E = {
            easing: function(t) {
                return t * t * t;
            },
            reverse: function() {
                return E;
            }
        };
        cc.easeCubicActionIn = function() {
            return E;
        };
        var B = {
            easing: function(t) {
                return (t -= 1) * t * t + 1;
            },
            reverse: function() {
                return B;
            }
        };
        cc.easeCubicActionOut = function() {
            return B;
        };
        var M = {
            easing: function(t) {
                return (t *= 2) < 1 ? .5 * t * t * t : .5 * ((t -= 2) * t * t + 2);
            },
            reverse: function() {
                return M;
            }
        };
        cc.easeCubicActionInOut = function() {
            return M;
        };
    }, {} ],
    4: [ function() {
        "use strict";
        cc.ActionInstant = cc.Class({
            name: "cc.ActionInstant",
            extends: cc.FiniteTimeAction,
            isDone: function() {
                return !0;
            },
            step: function() {
                this.update(1);
            },
            update: function() {},
            reverse: function() {
                return this.clone();
            },
            clone: function() {
                return new cc.ActionInstant();
            }
        }), cc.Show = cc.Class({
            name: "cc.Show",
            extends: cc.ActionInstant,
            update: function() {
                for (var t = this.target.getComponentsInChildren(cc.RenderComponent), e = 0; e < t.length; ++e) t[e].enabled = !0;
            },
            reverse: function() {
                return new cc.Hide();
            },
            clone: function() {
                return new cc.Show();
            }
        }), cc.show = function() {
            return new cc.Show();
        }, cc.Hide = cc.Class({
            name: "cc.Hide",
            extends: cc.ActionInstant,
            update: function() {
                for (var t = this.target.getComponentsInChildren(cc.RenderComponent), e = 0; e < t.length; ++e) t[e].enabled = !1;
            },
            reverse: function() {
                return new cc.Show();
            },
            clone: function() {
                return new cc.Hide();
            }
        }), cc.hide = function() {
            return new cc.Hide();
        }, cc.ToggleVisibility = cc.Class({
            name: "cc.ToggleVisibility",
            extends: cc.ActionInstant,
            update: function() {
                for (var t = this.target.getComponentsInChildren(cc.RenderComponent), e = 0; e < t.length; ++e) {
                    var i = t[e];
                    i.enabled = !i.enabled;
                }
            },
            reverse: function() {
                return new cc.ToggleVisibility();
            },
            clone: function() {
                return new cc.ToggleVisibility();
            }
        }), cc.toggleVisibility = function() {
            return new cc.ToggleVisibility();
        }, cc.RemoveSelf = cc.Class({
            name: "cc.RemoveSelf",
            extends: cc.ActionInstant,
            ctor: function(t) {
                this._isNeedCleanUp = !0, void 0 !== t && this.init(t);
            },
            update: function() {
                this.target.removeFromParent(this._isNeedCleanUp);
            },
            init: function(t) {
                return this._isNeedCleanUp = t, !0;
            },
            reverse: function() {
                return new cc.RemoveSelf(this._isNeedCleanUp);
            },
            clone: function() {
                return new cc.RemoveSelf(this._isNeedCleanUp);
            }
        }), cc.removeSelf = function(t) {
            return new cc.RemoveSelf(t);
        }, cc.DestroySelf = cc.Class({
            name: "cc.DestroySelf",
            extends: cc.ActionInstant,
            update: function() {
                this.target.destroy();
            },
            reverse: function() {
                return new cc.DestroySelf();
            },
            clone: function() {
                return new cc.DestroySelf();
            }
        }), cc.destroySelf = function() {
            return new cc.DestroySelf();
        }, cc.FlipX = cc.Class({
            name: "cc.FlipX",
            extends: cc.ActionInstant,
            ctor: function(t) {
                this._flippedX = !1, void 0 !== t && this.initWithFlipX(t);
            },
            initWithFlipX: function(t) {
                return this._flippedX = t, !0;
            },
            update: function() {
                this.target.scaleX = Math.abs(this.target.scaleX) * (this._flippedX ? -1 : 1);
            },
            reverse: function() {
                return new cc.FlipX(!this._flippedX);
            },
            clone: function() {
                var t = new cc.FlipX();
                return t.initWithFlipX(this._flippedX), t;
            }
        }), cc.flipX = function(t) {
            return new cc.FlipX(t);
        }, cc.FlipY = cc.Class({
            name: "cc.FlipY",
            extends: cc.ActionInstant,
            ctor: function(t) {
                this._flippedY = !1, void 0 !== t && this.initWithFlipY(t);
            },
            initWithFlipY: function(t) {
                return this._flippedY = t, !0;
            },
            update: function() {
                this.target.scaleY = Math.abs(this.target.scaleY) * (this._flippedY ? -1 : 1);
            },
            reverse: function() {
                return new cc.FlipY(!this._flippedY);
            },
            clone: function() {
                var t = new cc.FlipY();
                return t.initWithFlipY(this._flippedY), t;
            }
        }), cc.flipY = function(t) {
            return new cc.FlipY(t);
        }, cc.Place = cc.Class({
            name: "cc.Place",
            extends: cc.ActionInstant,
            ctor: function(t, e) {
                this._x = 0, this._y = 0, void 0 !== t && (void 0 !== t.x && (e = t.y, t = t.x), 
                this.initWithPosition(t, e));
            },
            initWithPosition: function(t, e) {
                return this._x = t, this._y = e, !0;
            },
            update: function() {
                this.target.setPosition(this._x, this._y);
            },
            clone: function() {
                var t = new cc.Place();
                return t.initWithPosition(this._x, this._y), t;
            }
        }), cc.place = function(t, e) {
            return new cc.Place(t, e);
        }, cc.CallFunc = cc.Class({
            name: "cc.CallFunc",
            extends: cc.ActionInstant,
            ctor: function(t, e, i) {
                this._selectorTarget = null, this._function = null, this._data = null, this.initWithFunction(t, e, i);
            },
            initWithFunction: function(t, e, i) {
                return t && (this._function = t), e && (this._selectorTarget = e), void 0 !== i && (this._data = i), 
                !0;
            },
            execute: function() {
                this._function && this._function.call(this._selectorTarget, this.target, this._data);
            },
            update: function() {
                this.execute();
            },
            getTargetCallback: function() {
                return this._selectorTarget;
            },
            setTargetCallback: function(t) {
                t !== this._selectorTarget && (this._selectorTarget && (this._selectorTarget = null), 
                this._selectorTarget = t);
            },
            clone: function() {
                var t = new cc.CallFunc();
                return t.initWithFunction(this._function, this._selectorTarget, this._data), t;
            }
        }), cc.callFunc = function(t, e, i) {
            return new cc.CallFunc(t, e, i);
        };
    }, {} ],
    5: [ function() {
        "use strict";
        function t(t, e, i, n, r) {
            return Math.pow(1 - r, 3) * t + 3 * r * Math.pow(1 - r, 2) * e + 3 * Math.pow(r, 2) * (1 - r) * i + Math.pow(r, 3) * n;
        }
        cc.ActionInterval = cc.Class({
            name: "cc.ActionInterval",
            extends: cc.FiniteTimeAction,
            ctor: function(t) {
                this.MAX_VALUE = 2, this._elapsed = 0, this._firstTick = !1, this._easeList = null, 
                this._speed = 1, this._timesForRepeat = 1, this._repeatForever = !1, this._repeatMethod = !1, 
                this._speedMethod = !1, void 0 !== t && cc.ActionInterval.prototype.initWithDuration.call(this, t);
            },
            getElapsed: function() {
                return this._elapsed;
            },
            initWithDuration: function(t) {
                return this._duration = 0 === t ? cc.macro.FLT_EPSILON : t, this._elapsed = 0, this._firstTick = !0, 
                !0;
            },
            isDone: function() {
                return this._elapsed >= this._duration;
            },
            _cloneDecoration: function(t) {
                t._repeatForever = this._repeatForever, t._speed = this._speed, t._timesForRepeat = this._timesForRepeat, 
                t._easeList = this._easeList, t._speedMethod = this._speedMethod, t._repeatMethod = this._repeatMethod;
            },
            _reverseEaseList: function(t) {
                if (this._easeList) {
                    t._easeList = [];
                    for (var e = 0; e < this._easeList.length; e++) t._easeList.push(this._easeList[e].reverse());
                }
            },
            clone: function() {
                var t = new cc.ActionInterval(this._duration);
                return this._cloneDecoration(t), t;
            },
            easing: function() {
                this._easeList ? this._easeList.length = 0 : this._easeList = [];
                for (var t = 0; t < arguments.length; t++) this._easeList.push(arguments[t]);
                return this;
            },
            _computeEaseTime: function(t) {
                var e = this._easeList;
                if (!e || 0 === e.length) return t;
                for (var i = 0, n = e.length; i < n; i++) t = e[i].easing(t);
                return t;
            },
            step: function(t) {
                this._firstTick ? (this._firstTick = !1, this._elapsed = 0) : this._elapsed += t;
                var e = this._elapsed / (this._duration > 1.192092896e-7 ? this._duration : 1.192092896e-7);
                e = 1 > e ? e : 1, this.update(e > 0 ? e : 0), this._repeatMethod && this._timesForRepeat > 1 && this.isDone() && (this._repeatForever || this._timesForRepeat--, 
                this.startWithTarget(this.target), this.step(this._elapsed - this._duration));
            },
            startWithTarget: function(t) {
                cc.Action.prototype.startWithTarget.call(this, t), this._elapsed = 0, this._firstTick = !0;
            },
            reverse: function() {
                return cc.logID(1010), null;
            },
            setAmplitudeRate: function() {
                cc.logID(1011);
            },
            getAmplitudeRate: function() {
                return cc.logID(1012), 0;
            },
            speed: function(t) {
                return t <= 0 ? (cc.logID(1013), this) : (this._speedMethod = !0, this._speed *= t, 
                this);
            },
            getSpeed: function() {
                return this._speed;
            },
            setSpeed: function(t) {
                return this._speed = t, this;
            },
            repeat: function(t) {
                return t = Math.round(t), isNaN(t) || t < 1 ? (cc.logID(1014), this) : (this._repeatMethod = !0, 
                this._timesForRepeat *= t, this);
            },
            repeatForever: function() {
                return this._repeatMethod = !0, this._timesForRepeat = this.MAX_VALUE, this._repeatForever = !0, 
                this;
            }
        }), cc.actionInterval = function(t) {
            return new cc.ActionInterval(t);
        }, cc.Sequence = cc.Class({
            name: "cc.Sequence",
            extends: cc.ActionInterval,
            ctor: function(t) {
                this._actions = [], this._split = null, this._last = 0, this._reversed = !1;
                var e = t instanceof Array ? t : arguments;
                if (1 !== e.length) {
                    var i = e.length - 1;
                    if (i >= 0 && null == e[i] && cc.logID(1015), i >= 0) {
                        for (var n, r = e[0], s = 1; s < i; s++) e[s] && (n = r, r = cc.Sequence._actionOneTwo(n, e[s]));
                        this.initWithTwoActions(r, e[i]);
                    }
                } else cc.errorID(1019);
            },
            initWithTwoActions: function(t, e) {
                if (!t || !e) return cc.errorID(1025), !1;
                var i = t._duration, n = e._duration, r = (i *= t._repeatMethod ? t._timesForRepeat : 1) + (n *= e._repeatMethod ? e._timesForRepeat : 1);
                return this.initWithDuration(r), this._actions[0] = t, this._actions[1] = e, !0;
            },
            clone: function() {
                var t = new cc.Sequence();
                return this._cloneDecoration(t), t.initWithTwoActions(this._actions[0].clone(), this._actions[1].clone()), 
                t;
            },
            startWithTarget: function(t) {
                cc.ActionInterval.prototype.startWithTarget.call(this, t), this._split = this._actions[0]._duration / this._duration, 
                this._split *= this._actions[0]._repeatMethod ? this._actions[0]._timesForRepeat : 1, 
                this._last = -1;
            },
            stop: function() {
                -1 !== this._last && this._actions[this._last].stop(), cc.Action.prototype.stop.call(this);
            },
            update: function(t) {
                var e, i, n = 0, r = this._split, s = this._actions, o = this._last;
                (t = this._computeEaseTime(t)) < r ? (e = 0 !== r ? t / r : 1, 0 === n && 1 === o && this._reversed && (s[1].update(0), 
                s[1].stop())) : (n = 1, e = 1 === r ? 1 : (t - r) / (1 - r), -1 === o && (s[0].startWithTarget(this.target), 
                s[0].update(1), s[0].stop()), 0 === o && (s[0].update(1), s[0].stop())), i = s[n], 
                o === n && i.isDone() || (o !== n && i.startWithTarget(this.target), e *= i._timesForRepeat, 
                i.update(e > 1 ? e % 1 : e), this._last = n);
            },
            reverse: function() {
                var t = cc.Sequence._actionOneTwo(this._actions[1].reverse(), this._actions[0].reverse());
                return this._cloneDecoration(t), this._reverseEaseList(t), t._reversed = !0, t;
            }
        }), cc.sequence = function(t) {
            var e = t instanceof Array ? t : arguments;
            if (1 === e.length) return cc.errorID(1019), null;
            var i = e.length - 1;
            i >= 0 && null == e[i] && cc.logID(1015);
            var n = null;
            if (i >= 0) {
                n = e[0];
                for (var r = 1; r <= i; r++) e[r] && (n = cc.Sequence._actionOneTwo(n, e[r]));
            }
            return n;
        }, cc.Sequence._actionOneTwo = function(t, e) {
            var i = new cc.Sequence();
            return i.initWithTwoActions(t, e), i;
        }, cc.Repeat = cc.Class({
            name: "cc.Repeat",
            extends: cc.ActionInterval,
            ctor: function(t, e) {
                this._times = 0, this._total = 0, this._nextDt = 0, this._actionInstant = !1, this._innerAction = null, 
                void 0 !== e && this.initWithAction(t, e);
            },
            initWithAction: function(t, e) {
                var i = t._duration * e;
                return !!this.initWithDuration(i) && (this._times = e, this._innerAction = t, t instanceof cc.ActionInstant && (this._actionInstant = !0, 
                this._times -= 1), this._total = 0, !0);
            },
            clone: function() {
                var t = new cc.Repeat();
                return this._cloneDecoration(t), t.initWithAction(this._innerAction.clone(), this._times), 
                t;
            },
            startWithTarget: function(t) {
                this._total = 0, this._nextDt = this._innerAction._duration / this._duration, cc.ActionInterval.prototype.startWithTarget.call(this, t), 
                this._innerAction.startWithTarget(t);
            },
            stop: function() {
                this._innerAction.stop(), cc.Action.prototype.stop.call(this);
            },
            update: function(t) {
                t = this._computeEaseTime(t);
                var e = this._innerAction, i = this._duration, n = this._times, r = this._nextDt;
                if (t >= r) {
                    for (;t > r && this._total < n; ) e.update(1), this._total++, e.stop(), e.startWithTarget(this.target), 
                    r += e._duration / i, this._nextDt = r > 1 ? 1 : r;
                    t >= 1 && this._total < n && (e.update(1), this._total++), this._actionInstant || (this._total === n ? e.stop() : e.update(t - (r - e._duration / i)));
                } else e.update(t * n % 1);
            },
            isDone: function() {
                return this._total === this._times;
            },
            reverse: function() {
                var t = new cc.Repeat(this._innerAction.reverse(), this._times);
                return this._cloneDecoration(t), this._reverseEaseList(t), t;
            },
            setInnerAction: function(t) {
                this._innerAction !== t && (this._innerAction = t);
            },
            getInnerAction: function() {
                return this._innerAction;
            }
        }), cc.repeat = function(t, e) {
            return new cc.Repeat(t, e);
        }, cc.RepeatForever = cc.Class({
            name: "cc.RepeatForever",
            extends: cc.ActionInterval,
            ctor: function(t) {
                this._innerAction = null, t && this.initWithAction(t);
            },
            initWithAction: function(t) {
                return t ? (this._innerAction = t, !0) : (cc.errorID(1026), !1);
            },
            clone: function() {
                var t = new cc.RepeatForever();
                return this._cloneDecoration(t), t.initWithAction(this._innerAction.clone()), t;
            },
            startWithTarget: function(t) {
                cc.ActionInterval.prototype.startWithTarget.call(this, t), this._innerAction.startWithTarget(t);
            },
            step: function(t) {
                var e = this._innerAction;
                e.step(t), e.isDone() && (e.startWithTarget(this.target), e.step(e.getElapsed() - e._duration));
            },
            isDone: function() {
                return !1;
            },
            reverse: function() {
                var t = new cc.RepeatForever(this._innerAction.reverse());
                return this._cloneDecoration(t), this._reverseEaseList(t), t;
            },
            setInnerAction: function(t) {
                this._innerAction !== t && (this._innerAction = t);
            },
            getInnerAction: function() {
                return this._innerAction;
            }
        }), cc.repeatForever = function(t) {
            return new cc.RepeatForever(t);
        }, cc.Spawn = cc.Class({
            name: "cc.Spawn",
            extends: cc.ActionInterval,
            ctor: function(t) {
                this._one = null, this._two = null;
                var e = t instanceof Array ? t : arguments;
                if (1 !== e.length) {
                    var i = e.length - 1;
                    if (i >= 0 && null == e[i] && cc.logID(1015), i >= 0) {
                        for (var n, r = e[0], s = 1; s < i; s++) e[s] && (n = r, r = cc.Spawn._actionOneTwo(n, e[s]));
                        this.initWithTwoActions(r, e[i]);
                    }
                } else cc.errorID(1020);
            },
            initWithTwoActions: function(t, e) {
                if (!t || !e) return cc.errorID(1027), !1;
                var i = !1, n = t._duration, r = e._duration;
                return this.initWithDuration(Math.max(n, r)) && (this._one = t, this._two = e, n > r ? this._two = cc.Sequence._actionOneTwo(e, cc.delayTime(n - r)) : n < r && (this._one = cc.Sequence._actionOneTwo(t, cc.delayTime(r - n))), 
                i = !0), i;
            },
            clone: function() {
                var t = new cc.Spawn();
                return this._cloneDecoration(t), t.initWithTwoActions(this._one.clone(), this._two.clone()), 
                t;
            },
            startWithTarget: function(t) {
                cc.ActionInterval.prototype.startWithTarget.call(this, t), this._one.startWithTarget(t), 
                this._two.startWithTarget(t);
            },
            stop: function() {
                this._one.stop(), this._two.stop(), cc.Action.prototype.stop.call(this);
            },
            update: function(t) {
                t = this._computeEaseTime(t), this._one && this._one.update(t), this._two && this._two.update(t);
            },
            reverse: function() {
                var t = cc.Spawn._actionOneTwo(this._one.reverse(), this._two.reverse());
                return this._cloneDecoration(t), this._reverseEaseList(t), t;
            }
        }), cc.spawn = function(t) {
            var e = t instanceof Array ? t : arguments;
            if (1 === e.length) return cc.errorID(1020), null;
            e.length > 0 && null == e[e.length - 1] && cc.logID(1015);
            for (var i = e[0], n = 1; n < e.length; n++) null != e[n] && (i = cc.Spawn._actionOneTwo(i, e[n]));
            return i;
        }, cc.Spawn._actionOneTwo = function(t, e) {
            var i = new cc.Spawn();
            return i.initWithTwoActions(t, e), i;
        }, cc.RotateTo = cc.Class({
            name: "cc.RotateTo",
            extends: cc.ActionInterval,
            statics: {
                _reverse: !1
            },
            ctor: function(t, e) {
                this._startAngle = 0, this._dstAngle = 0, this._angle = 0, void 0 !== e && this.initWithDuration(t, e);
            },
            initWithDuration: function(t, e) {
                return !!cc.ActionInterval.prototype.initWithDuration.call(this, t) && (this._dstAngle = e, 
                !0);
            },
            clone: function() {
                var t = new cc.RotateTo();
                return this._cloneDecoration(t), t.initWithDuration(this._duration, this._dstAngle), 
                t;
            },
            startWithTarget: function(t) {
                cc.ActionInterval.prototype.startWithTarget.call(this, t);
                var e = t.angle % 360, i = cc.RotateTo._reverse ? this._dstAngle - e : this._dstAngle + e;
                i > 180 && (i -= 360), i < -180 && (i += 360), this._startAngle = e, this._angle = cc.RotateTo._reverse ? i : -i;
            },
            reverse: function() {
                cc.logID(1016);
            },
            update: function(t) {
                t = this._computeEaseTime(t), this.target && (this.target.angle = this._startAngle + this._angle * t);
            }
        }), cc.rotateTo = function(t, e) {
            return new cc.RotateTo(t, e);
        }, cc.RotateBy = cc.Class({
            name: "cc.RotateBy",
            extends: cc.ActionInterval,
            statics: {
                _reverse: !1
            },
            ctor: function(t, e) {
                e *= cc.RotateBy._reverse ? 1 : -1, this._deltaAngle = 0, this._startAngle = 0, 
                void 0 !== e && this.initWithDuration(t, e);
            },
            initWithDuration: function(t, e) {
                return !!cc.ActionInterval.prototype.initWithDuration.call(this, t) && (this._deltaAngle = e, 
                !0);
            },
            clone: function() {
                var t = new cc.RotateBy();
                return this._cloneDecoration(t), t.initWithDuration(this._duration, this._deltaAngle), 
                t;
            },
            startWithTarget: function(t) {
                cc.ActionInterval.prototype.startWithTarget.call(this, t), this._startAngle = t.angle;
            },
            update: function(t) {
                t = this._computeEaseTime(t), this.target && (this.target.angle = this._startAngle + this._deltaAngle * t);
            },
            reverse: function() {
                var t = new cc.RotateBy();
                return t.initWithDuration(this._duration, -this._deltaAngle), this._cloneDecoration(t), 
                this._reverseEaseList(t), t;
            }
        }), cc.rotateBy = function(t, e) {
            return new cc.RotateBy(t, e);
        }, cc.MoveBy = cc.Class({
            name: "cc.MoveBy",
            extends: cc.ActionInterval,
            ctor: function(t, e, i) {
                this._positionDelta = cc.v2(0, 0), this._startPosition = cc.v2(0, 0), this._previousPosition = cc.v2(0, 0), 
                void 0 !== e && cc.MoveBy.prototype.initWithDuration.call(this, t, e, i);
            },
            initWithDuration: function(t, e, i) {
                return !!cc.ActionInterval.prototype.initWithDuration.call(this, t) && (void 0 !== e.x && (i = e.y, 
                e = e.x), this._positionDelta.x = e, this._positionDelta.y = i, !0);
            },
            clone: function() {
                var t = new cc.MoveBy();
                return this._cloneDecoration(t), t.initWithDuration(this._duration, this._positionDelta), 
                t;
            },
            startWithTarget: function(t) {
                cc.ActionInterval.prototype.startWithTarget.call(this, t);
                var e = t.x, i = t.y;
                this._previousPosition.x = e, this._previousPosition.y = i, this._startPosition.x = e, 
                this._startPosition.y = i;
            },
            update: function(t) {
                if (t = this._computeEaseTime(t), this.target) {
                    var e = this._positionDelta.x * t, i = this._positionDelta.y * t, n = this._startPosition;
                    if (cc.macro.ENABLE_STACKABLE_ACTIONS) {
                        var r = this.target.x, s = this.target.y, o = this._previousPosition;
                        n.x = n.x + r - o.x, n.y = n.y + s - o.y, e += n.x, i += n.y, o.x = e, o.y = i, 
                        this.target.setPosition(e, i);
                    } else this.target.setPosition(n.x + e, n.y + i);
                }
            },
            reverse: function() {
                var t = new cc.MoveBy(this._duration, cc.v2(-this._positionDelta.x, -this._positionDelta.y));
                return this._cloneDecoration(t), this._reverseEaseList(t), t;
            }
        }), cc.moveBy = function(t, e, i) {
            return new cc.MoveBy(t, e, i);
        }, cc.MoveTo = cc.Class({
            name: "cc.MoveTo",
            extends: cc.MoveBy,
            ctor: function(t, e, i) {
                this._endPosition = cc.v2(0, 0), void 0 !== e && this.initWithDuration(t, e, i);
            },
            initWithDuration: function(t, e, i) {
                return !!cc.MoveBy.prototype.initWithDuration.call(this, t, e, i) && (void 0 !== e.x && (i = e.y, 
                e = e.x), this._endPosition.x = e, this._endPosition.y = i, !0);
            },
            clone: function() {
                var t = new cc.MoveTo();
                return this._cloneDecoration(t), t.initWithDuration(this._duration, this._endPosition), 
                t;
            },
            startWithTarget: function(t) {
                cc.MoveBy.prototype.startWithTarget.call(this, t), this._positionDelta.x = this._endPosition.x - t.x, 
                this._positionDelta.y = this._endPosition.y - t.y;
            }
        }), cc.moveTo = function(t, e, i) {
            return new cc.MoveTo(t, e, i);
        }, cc.SkewTo = cc.Class({
            name: "cc.SkewTo",
            extends: cc.ActionInterval,
            ctor: function(t, e, i) {
                this._skewX = 0, this._skewY = 0, this._startSkewX = 0, this._startSkewY = 0, this._endSkewX = 0, 
                this._endSkewY = 0, this._deltaX = 0, this._deltaY = 0, void 0 !== i && cc.SkewTo.prototype.initWithDuration.call(this, t, e, i);
            },
            initWithDuration: function(t, e, i) {
                var n = !1;
                return cc.ActionInterval.prototype.initWithDuration.call(this, t) && (this._endSkewX = e, 
                this._endSkewY = i, n = !0), n;
            },
            clone: function() {
                var t = new cc.SkewTo();
                return this._cloneDecoration(t), t.initWithDuration(this._duration, this._endSkewX, this._endSkewY), 
                t;
            },
            startWithTarget: function(t) {
                cc.ActionInterval.prototype.startWithTarget.call(this, t), this._startSkewX = t.skewX % 180, 
                this._deltaX = this._endSkewX - this._startSkewX, this._deltaX > 180 && (this._deltaX -= 360), 
                this._deltaX < -180 && (this._deltaX += 360), this._startSkewY = t.skewY % 360, 
                this._deltaY = this._endSkewY - this._startSkewY, this._deltaY > 180 && (this._deltaY -= 360), 
                this._deltaY < -180 && (this._deltaY += 360);
            },
            update: function(t) {
                t = this._computeEaseTime(t), this.target.skewX = this._startSkewX + this._deltaX * t, 
                this.target.skewY = this._startSkewY + this._deltaY * t;
            }
        }), cc.skewTo = function(t, e, i) {
            return new cc.SkewTo(t, e, i);
        }, cc.SkewBy = cc.Class({
            name: "cc.SkewBy",
            extends: cc.SkewTo,
            ctor: function(t, e, i) {
                void 0 !== i && this.initWithDuration(t, e, i);
            },
            initWithDuration: function(t, e, i) {
                var n = !1;
                return cc.SkewTo.prototype.initWithDuration.call(this, t, e, i) && (this._skewX = e, 
                this._skewY = i, n = !0), n;
            },
            clone: function() {
                var t = new cc.SkewBy();
                return this._cloneDecoration(t), t.initWithDuration(this._duration, this._skewX, this._skewY), 
                t;
            },
            startWithTarget: function(t) {
                cc.SkewTo.prototype.startWithTarget.call(this, t), this._deltaX = this._skewX, this._deltaY = this._skewY, 
                this._endSkewX = this._startSkewX + this._deltaX, this._endSkewY = this._startSkewY + this._deltaY;
            },
            reverse: function() {
                var t = new cc.SkewBy(this._duration, -this._skewX, -this._skewY);
                return this._cloneDecoration(t), this._reverseEaseList(t), t;
            }
        }), cc.skewBy = function(t, e, i) {
            return new cc.SkewBy(t, e, i);
        }, cc.JumpBy = cc.Class({
            name: "cc.JumpBy",
            extends: cc.ActionInterval,
            ctor: function(t, e, i, n, r) {
                this._startPosition = cc.v2(0, 0), this._previousPosition = cc.v2(0, 0), this._delta = cc.v2(0, 0), 
                this._height = 0, this._jumps = 0, void 0 !== n && cc.JumpBy.prototype.initWithDuration.call(this, t, e, i, n, r);
            },
            initWithDuration: function(t, e, i, n, r) {
                return !!cc.ActionInterval.prototype.initWithDuration.call(this, t) && (void 0 === r && (r = n, 
                n = i, i = e.y, e = e.x), this._delta.x = e, this._delta.y = i, this._height = n, 
                this._jumps = r, !0);
            },
            clone: function() {
                var t = new cc.JumpBy();
                return this._cloneDecoration(t), t.initWithDuration(this._duration, this._delta, this._height, this._jumps), 
                t;
            },
            startWithTarget: function(t) {
                cc.ActionInterval.prototype.startWithTarget.call(this, t);
                var e = t.x, i = t.y;
                this._previousPosition.x = e, this._previousPosition.y = i, this._startPosition.x = e, 
                this._startPosition.y = i;
            },
            update: function(t) {
                if (t = this._computeEaseTime(t), this.target) {
                    var e = t * this._jumps % 1, i = 4 * this._height * e * (1 - e);
                    i += this._delta.y * t;
                    var n = this._delta.x * t, r = this._startPosition;
                    if (cc.macro.ENABLE_STACKABLE_ACTIONS) {
                        var s = this.target.x, o = this.target.y, a = this._previousPosition;
                        r.x = r.x + s - a.x, r.y = r.y + o - a.y, n += r.x, i += r.y, a.x = n, a.y = i, 
                        this.target.setPosition(n, i);
                    } else this.target.setPosition(r.x + n, r.y + i);
                }
            },
            reverse: function() {
                var t = new cc.JumpBy(this._duration, cc.v2(-this._delta.x, -this._delta.y), this._height, this._jumps);
                return this._cloneDecoration(t), this._reverseEaseList(t), t;
            }
        }), cc.jumpBy = function(t, e, i, n, r) {
            return new cc.JumpBy(t, e, i, n, r);
        }, cc.JumpTo = cc.Class({
            name: "cc.JumpTo",
            extends: cc.JumpBy,
            ctor: function(t, e, i, n, r) {
                this._endPosition = cc.v2(0, 0), void 0 !== n && this.initWithDuration(t, e, i, n, r);
            },
            initWithDuration: function(t, e, i, n, r) {
                return !!cc.JumpBy.prototype.initWithDuration.call(this, t, e, i, n, r) && (void 0 === r && (i = e.y, 
                e = e.x), this._endPosition.x = e, this._endPosition.y = i, !0);
            },
            startWithTarget: function(t) {
                cc.JumpBy.prototype.startWithTarget.call(this, t), this._delta.x = this._endPosition.x - this._startPosition.x, 
                this._delta.y = this._endPosition.y - this._startPosition.y;
            },
            clone: function() {
                var t = new cc.JumpTo();
                return this._cloneDecoration(t), t.initWithDuration(this._duration, this._endPosition, this._height, this._jumps), 
                t;
            }
        }), cc.jumpTo = function(t, e, i, n, r) {
            return new cc.JumpTo(t, e, i, n, r);
        }, cc.BezierBy = cc.Class({
            name: "cc.BezierBy",
            extends: cc.ActionInterval,
            ctor: function(t, e) {
                this._config = [], this._startPosition = cc.v2(0, 0), this._previousPosition = cc.v2(0, 0), 
                e && cc.BezierBy.prototype.initWithDuration.call(this, t, e);
            },
            initWithDuration: function(t, e) {
                return !!cc.ActionInterval.prototype.initWithDuration.call(this, t) && (this._config = e, 
                !0);
            },
            clone: function() {
                var t = new cc.BezierBy();
                this._cloneDecoration(t);
                for (var e = [], i = 0; i < this._config.length; i++) {
                    var n = this._config[i];
                    e.push(cc.v2(n.x, n.y));
                }
                return t.initWithDuration(this._duration, e), t;
            },
            startWithTarget: function(t) {
                cc.ActionInterval.prototype.startWithTarget.call(this, t);
                var e = t.x, i = t.y;
                this._previousPosition.x = e, this._previousPosition.y = i, this._startPosition.x = e, 
                this._startPosition.y = i;
            },
            update: function(e) {
                if (e = this._computeEaseTime(e), this.target) {
                    var i = this._config, n = i[0].x, r = i[1].x, s = i[2].x, o = i[0].y, a = i[1].y, c = i[2].y, l = t(0, n, r, s, e), u = t(0, o, a, c, e), h = this._startPosition;
                    if (cc.macro.ENABLE_STACKABLE_ACTIONS) {
                        var _ = this.target.x, f = this.target.y, d = this._previousPosition;
                        h.x = h.x + _ - d.x, h.y = h.y + f - d.y, l += h.x, u += h.y, d.x = l, d.y = u, 
                        this.target.setPosition(l, u);
                    } else this.target.setPosition(h.x + l, h.y + u);
                }
            },
            reverse: function() {
                var t = this._config, e = t[0].x, i = t[0].y, n = t[1].x, r = t[1].y, s = t[2].x, o = t[2].y, a = [ cc.v2(n - s, r - o), cc.v2(e - s, i - o), cc.v2(-s, -o) ], c = new cc.BezierBy(this._duration, a);
                return this._cloneDecoration(c), this._reverseEaseList(c), c;
            }
        }), cc.bezierBy = function(t, e) {
            return new cc.BezierBy(t, e);
        }, cc.BezierTo = cc.Class({
            name: "cc.BezierTo",
            extends: cc.BezierBy,
            ctor: function(t, e) {
                this._toConfig = [], e && this.initWithDuration(t, e);
            },
            initWithDuration: function(t, e) {
                return !!cc.ActionInterval.prototype.initWithDuration.call(this, t) && (this._toConfig = e, 
                !0);
            },
            clone: function() {
                var t = new cc.BezierTo();
                return this._cloneDecoration(t), t.initWithDuration(this._duration, this._toConfig), 
                t;
            },
            startWithTarget: function(t) {
                cc.BezierBy.prototype.startWithTarget.call(this, t);
                var e = this._startPosition, i = this._toConfig, n = this._config;
                n[0] = i[0].sub(e), n[1] = i[1].sub(e), n[2] = i[2].sub(e);
            }
        }), cc.bezierTo = function(t, e) {
            return new cc.BezierTo(t, e);
        }, cc.ScaleTo = cc.Class({
            name: "cc.ScaleTo",
            extends: cc.ActionInterval,
            ctor: function(t, e, i) {
                this._scaleX = 1, this._scaleY = 1, this._startScaleX = 1, this._startScaleY = 1, 
                this._endScaleX = 0, this._endScaleY = 0, this._deltaX = 0, this._deltaY = 0, void 0 !== e && cc.ScaleTo.prototype.initWithDuration.call(this, t, e, i);
            },
            initWithDuration: function(t, e, i) {
                return !!cc.ActionInterval.prototype.initWithDuration.call(this, t) && (this._endScaleX = e, 
                this._endScaleY = null != i ? i : e, !0);
            },
            clone: function() {
                var t = new cc.ScaleTo();
                return this._cloneDecoration(t), t.initWithDuration(this._duration, this._endScaleX, this._endScaleY), 
                t;
            },
            startWithTarget: function(t) {
                cc.ActionInterval.prototype.startWithTarget.call(this, t), this._startScaleX = t.scaleX, 
                this._startScaleY = t.scaleY, this._deltaX = this._endScaleX - this._startScaleX, 
                this._deltaY = this._endScaleY - this._startScaleY;
            },
            update: function(t) {
                t = this._computeEaseTime(t), this.target && (this.target.scaleX = this._startScaleX + this._deltaX * t, 
                this.target.scaleY = this._startScaleY + this._deltaY * t);
            }
        }), cc.scaleTo = function(t, e, i) {
            return new cc.ScaleTo(t, e, i);
        }, cc.ScaleBy = cc.Class({
            name: "cc.ScaleBy",
            extends: cc.ScaleTo,
            startWithTarget: function(t) {
                cc.ScaleTo.prototype.startWithTarget.call(this, t), this._deltaX = this._startScaleX * this._endScaleX - this._startScaleX, 
                this._deltaY = this._startScaleY * this._endScaleY - this._startScaleY;
            },
            reverse: function() {
                var t = new cc.ScaleBy(this._duration, 1 / this._endScaleX, 1 / this._endScaleY);
                return this._cloneDecoration(t), this._reverseEaseList(t), t;
            },
            clone: function() {
                var t = new cc.ScaleBy();
                return this._cloneDecoration(t), t.initWithDuration(this._duration, this._endScaleX, this._endScaleY), 
                t;
            }
        }), cc.scaleBy = function(t, e, i) {
            return new cc.ScaleBy(t, e, i);
        }, cc.Blink = cc.Class({
            name: "cc.Blink",
            extends: cc.ActionInterval,
            ctor: function(t, e) {
                this._times = 0, this._originalState = !1, void 0 !== e && this.initWithDuration(t, e);
            },
            initWithDuration: function(t, e) {
                return !!cc.ActionInterval.prototype.initWithDuration.call(this, t) && (this._times = e, 
                !0);
            },
            clone: function() {
                var t = new cc.Blink();
                return this._cloneDecoration(t), t.initWithDuration(this._duration, this._times), 
                t;
            },
            update: function(t) {
                if (t = this._computeEaseTime(t), this.target && !this.isDone()) {
                    var e = 1 / this._times, i = t % e;
                    this.target.opacity = i > e / 2 ? 255 : 0;
                }
            },
            startWithTarget: function(t) {
                cc.ActionInterval.prototype.startWithTarget.call(this, t), this._originalState = t.opacity;
            },
            stop: function() {
                this.target.opacity = this._originalState, cc.ActionInterval.prototype.stop.call(this);
            },
            reverse: function() {
                var t = new cc.Blink(this._duration, this._times);
                return this._cloneDecoration(t), this._reverseEaseList(t), t;
            }
        }), cc.blink = function(t, e) {
            return new cc.Blink(t, e);
        }, cc.FadeTo = cc.Class({
            name: "cc.FadeTo",
            extends: cc.ActionInterval,
            ctor: function(t, e) {
                this._toOpacity = 0, this._fromOpacity = 0, void 0 !== e && cc.FadeTo.prototype.initWithDuration.call(this, t, e);
            },
            initWithDuration: function(t, e) {
                return !!cc.ActionInterval.prototype.initWithDuration.call(this, t) && (this._toOpacity = e, 
                !0);
            },
            clone: function() {
                var t = new cc.FadeTo();
                return this._cloneDecoration(t), t.initWithDuration(this._duration, this._toOpacity), 
                t;
            },
            update: function(t) {
                t = this._computeEaseTime(t);
                var e = void 0 !== this._fromOpacity ? this._fromOpacity : 255;
                this.target.opacity = e + (this._toOpacity - e) * t;
            },
            startWithTarget: function(t) {
                cc.ActionInterval.prototype.startWithTarget.call(this, t), this._fromOpacity = t.opacity;
            }
        }), cc.fadeTo = function(t, e) {
            return new cc.FadeTo(t, e);
        }, cc.FadeIn = cc.Class({
            name: "cc.FadeIn",
            extends: cc.FadeTo,
            ctor: function(t) {
                null == t && (t = 0), this._reverseAction = null, this.initWithDuration(t, 255);
            },
            reverse: function() {
                var t = new cc.FadeOut();
                return t.initWithDuration(this._duration, 0), this._cloneDecoration(t), this._reverseEaseList(t), 
                t;
            },
            clone: function() {
                var t = new cc.FadeIn();
                return this._cloneDecoration(t), t.initWithDuration(this._duration, this._toOpacity), 
                t;
            },
            startWithTarget: function(t) {
                this._reverseAction && (this._toOpacity = this._reverseAction._fromOpacity), cc.FadeTo.prototype.startWithTarget.call(this, t);
            }
        }), cc.fadeIn = function(t) {
            return new cc.FadeIn(t);
        }, cc.FadeOut = cc.Class({
            name: "cc.FadeOut",
            extends: cc.FadeTo,
            ctor: function(t) {
                null == t && (t = 0), this._reverseAction = null, this.initWithDuration(t, 0);
            },
            reverse: function() {
                var t = new cc.FadeIn();
                return t._reverseAction = this, t.initWithDuration(this._duration, 255), this._cloneDecoration(t), 
                this._reverseEaseList(t), t;
            },
            clone: function() {
                var t = new cc.FadeOut();
                return this._cloneDecoration(t), t.initWithDuration(this._duration, this._toOpacity), 
                t;
            }
        }), cc.fadeOut = function(t) {
            return new cc.FadeOut(t);
        }, cc.TintTo = cc.Class({
            name: "cc.TintTo",
            extends: cc.ActionInterval,
            ctor: function(t, e, i, n) {
                this._to = cc.color(0, 0, 0), this._from = cc.color(0, 0, 0), e instanceof cc.Color && (n = e.b, 
                i = e.g, e = e.r), void 0 !== n && this.initWithDuration(t, e, i, n);
            },
            initWithDuration: function(t, e, i, n) {
                return !!cc.ActionInterval.prototype.initWithDuration.call(this, t) && (this._to = cc.color(e, i, n), 
                !0);
            },
            clone: function() {
                var t = new cc.TintTo();
                this._cloneDecoration(t);
                var e = this._to;
                return t.initWithDuration(this._duration, e.r, e.g, e.b), t;
            },
            startWithTarget: function(t) {
                cc.ActionInterval.prototype.startWithTarget.call(this, t), this._from = this.target.color;
            },
            update: function(t) {
                t = this._computeEaseTime(t);
                var e = this._from, i = this._to;
                e && (this.target.color = cc.color(e.r + (i.r - e.r) * t, e.g + (i.g - e.g) * t, e.b + (i.b - e.b) * t));
            }
        }), cc.tintTo = function(t, e, i, n) {
            return new cc.TintTo(t, e, i, n);
        }, cc.TintBy = cc.Class({
            name: "cc.TintBy",
            extends: cc.ActionInterval,
            ctor: function(t, e, i, n) {
                this._deltaR = 0, this._deltaG = 0, this._deltaB = 0, this._fromR = 0, this._fromG = 0, 
                this._fromB = 0, void 0 !== n && this.initWithDuration(t, e, i, n);
            },
            initWithDuration: function(t, e, i, n) {
                return !!cc.ActionInterval.prototype.initWithDuration.call(this, t) && (this._deltaR = e, 
                this._deltaG = i, this._deltaB = n, !0);
            },
            clone: function() {
                var t = new cc.TintBy();
                return this._cloneDecoration(t), t.initWithDuration(this._duration, this._deltaR, this._deltaG, this._deltaB), 
                t;
            },
            startWithTarget: function(t) {
                cc.ActionInterval.prototype.startWithTarget.call(this, t);
                var e = t.color;
                this._fromR = e.r, this._fromG = e.g, this._fromB = e.b;
            },
            update: function(t) {
                t = this._computeEaseTime(t), this.target.color = cc.color(this._fromR + this._deltaR * t, this._fromG + this._deltaG * t, this._fromB + this._deltaB * t);
            },
            reverse: function() {
                var t = new cc.TintBy(this._duration, -this._deltaR, -this._deltaG, -this._deltaB);
                return this._cloneDecoration(t), this._reverseEaseList(t), t;
            }
        }), cc.tintBy = function(t, e, i, n) {
            return new cc.TintBy(t, e, i, n);
        }, cc.DelayTime = cc.Class({
            name: "cc.DelayTime",
            extends: cc.ActionInterval,
            update: function() {},
            reverse: function() {
                var t = new cc.DelayTime(this._duration);
                return this._cloneDecoration(t), this._reverseEaseList(t), t;
            },
            clone: function() {
                var t = new cc.DelayTime();
                return this._cloneDecoration(t), t.initWithDuration(this._duration), t;
            }
        }), cc.delayTime = function(t) {
            return new cc.DelayTime(t);
        }, cc.ReverseTime = cc.Class({
            name: "cc.ReverseTime",
            extends: cc.ActionInterval,
            ctor: function(t) {
                this._other = null, t && this.initWithAction(t);
            },
            initWithAction: function(t) {
                return t ? t === this._other ? (cc.errorID(1029), !1) : !!cc.ActionInterval.prototype.initWithDuration.call(this, t._duration) && (this._other = t, 
                !0) : (cc.errorID(1028), !1);
            },
            clone: function() {
                var t = new cc.ReverseTime();
                return this._cloneDecoration(t), t.initWithAction(this._other.clone()), t;
            },
            startWithTarget: function(t) {
                cc.ActionInterval.prototype.startWithTarget.call(this, t), this._other.startWithTarget(t);
            },
            update: function(t) {
                t = this._computeEaseTime(t), this._other && this._other.update(1 - t);
            },
            reverse: function() {
                return this._other.clone();
            },
            stop: function() {
                this._other.stop(), cc.Action.prototype.stop.call(this);
            }
        }), cc.reverseTime = function(t) {
            return new cc.ReverseTime(t);
        }, cc.TargetedAction = cc.Class({
            name: "cc.TargetedAction",
            extends: cc.ActionInterval,
            ctor: function(t, e) {
                this._action = null, this._forcedTarget = null, e && this.initWithTarget(t, e);
            },
            initWithTarget: function(t, e) {
                return !!this.initWithDuration(e._duration) && (this._forcedTarget = t, this._action = e, 
                !0);
            },
            clone: function() {
                var t = new cc.TargetedAction();
                return this._cloneDecoration(t), t.initWithTarget(this._forcedTarget, this._action.clone()), 
                t;
            },
            startWithTarget: function(t) {
                cc.ActionInterval.prototype.startWithTarget.call(this, t), this._action.startWithTarget(this._forcedTarget);
            },
            stop: function() {
                this._action.stop();
            },
            update: function(t) {
                t = this._computeEaseTime(t), this._action.update(t);
            },
            getForcedTarget: function() {
                return this._forcedTarget;
            },
            setForcedTarget: function(t) {
                this._forcedTarget !== t && (this._forcedTarget = t);
            }
        }), cc.targetedAction = function(t, e) {
            return new cc.TargetedAction(t, e);
        };
    }, {} ],
    6: [ function(t) {
        "use strict";
        t("../core/platform/CCClass");
        var e = t("../core/platform/js"), i = function() {
            this.actions = [], this.target = null, this.actionIndex = 0, this.currentAction = null, 
            this.paused = !1, this.lock = !1;
        };
        cc.ActionManager = function() {
            this._hashTargets = e.createMap(!0), this._arrayTargets = [], this._currentTarget = null, 
            cc.director._scheduler && cc.director._scheduler.enableForTarget(this);
        }, cc.ActionManager.prototype = {
            constructor: cc.ActionManager,
            _elementPool: [],
            _searchElementByTarget: function(t, e) {
                for (var i = 0; i < t.length; i++) if (e === t[i].target) return t[i];
                return null;
            },
            _getElement: function(t, e) {
                var n = this._elementPool.pop();
                return n || (n = new i()), n.target = t, n.paused = !!e, n;
            },
            _putElement: function(t) {
                t.actions.length = 0, t.actionIndex = 0, t.currentAction = null, t.paused = !1, 
                t.target = null, t.lock = !1, this._elementPool.push(t);
            },
            addAction: function(t, e, i) {
                if (t && e) {
                    var n = this._hashTargets[e._id];
                    n ? n.actions || (n.actions = []) : (n = this._getElement(e, i), this._hashTargets[e._id] = n, 
                    this._arrayTargets.push(n)), n.actions.push(t), t.startWithTarget(e);
                } else cc.errorID(1e3);
            },
            removeAllActions: function() {
                for (var t = this._arrayTargets, i = 0; i < t.length; i++) {
                    var n = t[i];
                    n && this._putElement(n);
                }
                this._arrayTargets.length = 0, this._hashTargets = e.createMap(!0);
            },
            removeAllActionsFromTarget: function(t) {
                if (null != t) {
                    var e = this._hashTargets[t._id];
                    e && (e.actions.length = 0, this._deleteHashElement(e));
                }
            },
            removeAction: function(t) {
                if (t) {
                    var e = t.getOriginalTarget(), i = this._hashTargets[e._id];
                    if (i) for (var n = 0; n < i.actions.length; n++) if (i.actions[n] === t) {
                        i.actions.splice(n, 1), i.actionIndex >= n && i.actionIndex--;
                        break;
                    }
                }
            },
            _removeActionByTag: function(t, e, i) {
                for (var n = 0, r = e.actions.length; n < r; ++n) {
                    var s = e.actions[n];
                    if (s && s.getTag() === t) {
                        if (i && s.getOriginalTarget() !== i) continue;
                        this._removeActionAtIndex(n, e);
                        break;
                    }
                }
            },
            removeActionByTag: function(t, e) {
                t === cc.Action.TAG_INVALID && cc.logID(1002);
                var i = this._hashTargets;
                if (e) {
                    var n = i[e._id];
                    n && this._removeActionByTag(t, n, e);
                } else for (var r in i) {
                    var s = i[r];
                    this._removeActionByTag(t, s);
                }
            },
            getActionByTag: function(t, e) {
                t === cc.Action.TAG_INVALID && cc.logID(1004);
                var i = this._hashTargets[e._id];
                if (i) {
                    if (null != i.actions) for (var n = 0; n < i.actions.length; ++n) {
                        var r = i.actions[n];
                        if (r && r.getTag() === t) return r;
                    }
                    cc.logID(1005, t);
                }
                return null;
            },
            getNumberOfRunningActionsInTarget: function(t) {
                var e = this._hashTargets[t._id];
                return e && e.actions ? e.actions.length : 0;
            },
            pauseTarget: function(t) {
                var e = this._hashTargets[t._id];
                e && (e.paused = !0);
            },
            resumeTarget: function(t) {
                var e = this._hashTargets[t._id];
                e && (e.paused = !1);
            },
            pauseAllRunningActions: function() {
                for (var t = [], e = this._arrayTargets, i = 0; i < e.length; i++) {
                    var n = e[i];
                    n && !n.paused && (n.paused = !0, t.push(n.target));
                }
                return t;
            },
            resumeTargets: function(t) {
                if (t) for (var e = 0; e < t.length; e++) t[e] && this.resumeTarget(t[e]);
            },
            pauseTargets: function(t) {
                if (t) for (var e = 0; e < t.length; e++) t[e] && this.pauseTarget(t[e]);
            },
            purgeSharedManager: function() {
                cc.director.getScheduler().unscheduleUpdate(this);
            },
            _removeActionAtIndex: function(t, e) {
                e.actions[t], e.actions.splice(t, 1), e.actionIndex >= t && e.actionIndex--, 0 === e.actions.length && this._deleteHashElement(e);
            },
            _deleteHashElement: function(t) {
                var e = !1;
                if (t && !t.lock && this._hashTargets[t.target._id]) {
                    delete this._hashTargets[t.target._id];
                    for (var i = this._arrayTargets, n = 0, r = i.length; n < r; n++) if (i[n] === t) {
                        i.splice(n, 1);
                        break;
                    }
                    this._putElement(t), e = !0;
                }
                return e;
            },
            update: function(t) {
                for (var e, i = this._arrayTargets, n = 0; n < i.length; n++) {
                    if (this._currentTarget = i[n], !(e = this._currentTarget).paused && e.actions) {
                        for (e.lock = !0, e.actionIndex = 0; e.actionIndex < e.actions.length; e.actionIndex++) if (e.currentAction = e.actions[e.actionIndex], 
                        e.currentAction) {
                            if (e.currentAction.step(t * (e.currentAction._speedMethod ? e.currentAction._speed : 1)), 
                            e.currentAction && e.currentAction.isDone()) {
                                e.currentAction.stop();
                                var r = e.currentAction;
                                e.currentAction = null, this.removeAction(r);
                            }
                            e.currentAction = null;
                        }
                        e.lock = !1;
                    }
                    0 === e.actions.length && this._deleteHashElement(e) && n--;
                }
            }
        };
    }, {
        "../core/platform/CCClass": 182,
        "../core/platform/js": 203
    } ],
    7: [ function(t) {
        "use strict";
        t("./CCActionManager"), t("./CCAction"), t("./CCActionInterval"), t("./CCActionInstant"), 
        t("./CCActionEase"), t("./CCActionCatmullRom"), t("./tween");
    }, {
        "./CCAction": 1,
        "./CCActionCatmullRom": 2,
        "./CCActionEase": 3,
        "./CCActionInstant": 4,
        "./CCActionInterval": 5,
        "./CCActionManager": 6,
        "./tween": 8
    } ],
    8: [ function(t) {
        "use strict";
        var e = t("../animation/bezier"), i = 0, n = cc.Class({
            name: "cc.TweenAction",
            extends: cc.ActionInterval,
            ctor: function(t, e, i) {
                if (this._opts = i = i || Object.create(null), this._props = Object.create(null), 
                i.progress = i.progress || this.progress, i.easing && "string" == typeof i.easing) {
                    var n = i.easing;
                    i.easing = cc.easing[n], !i.easing && cc.warnID(1031, n);
                }
                var r = this._opts.relative;
                for (var s in e) {
                    var o = e[s], a = void 0, c = void 0;
                    if (void 0 !== o.value && (o.easing || o.progress) && ("string" == typeof o.easing ? !(a = cc.easing[o.easing]) && cc.warnID(1031, o.easing) : a = o.easing, 
                    c = o.progress, o = o.value), "number" == typeof o || o.lerp && (!r || o.add || o.mul) && o.clone) {
                        var l = Object.create(null);
                        l.value = o, l.easing = a, l.progress = c, this._props[s] = l;
                    } else cc.warn("Can not animate " + s + " property, because it do not have [lerp, (add|mul), clone] function.");
                }
                this._originProps = e, this.initWithDuration(t);
            },
            clone: function() {
                var t = new n(this._duration, this._originProps, this._opts);
                return this._cloneDecoration(t), t;
            },
            startWithTarget: function(t) {
                cc.ActionInterval.prototype.startWithTarget.call(this, t);
                var e = !!this._opts.relative, i = this._props;
                for (var n in i) {
                    var r = t[n], s = i[n];
                    "number" == typeof r ? (s.start = r, s.current = r, s.end = e ? r + s.value : s.value) : (s.start = r.clone(), 
                    s.current = r.clone(), s.end = e ? (r.add || r.mul).call(r, s.value) : s.value);
                }
            },
            update: function(t) {
                var e = this._opts, i = t;
                e.easing && (i = e.easing(t));
                var n = this.target;
                if (n) {
                    var r = this._props, s = this._opts.progress;
                    for (var o in r) {
                        var a = r[o], c = a.easing ? a.easing(t) : i, l = a.current = (a.progress || s)(a.start, a.end, a.current, c);
                        n[o] = l;
                    }
                }
            },
            progress: function(t, e, i, n) {
                return "number" == typeof t ? i = t + (e - t) * n : t.lerp(e, n, i), i;
            }
        }), r = cc.Class({
            name: "cc.SetAction",
            extends: cc.ActionInstant,
            ctor: function(t) {
                this._props = {}, void 0 !== t && this.init(t);
            },
            init: function(t) {
                for (var e in t) this._props[e] = t[e];
                return !0;
            },
            update: function() {
                var t = this._props, e = this.target;
                for (var i in t) e[i] = t[i];
            },
            clone: function() {
                var t = new r();
                return t.init(this._props), t;
            }
        });
        function s(t) {
            this._actions = [], this._finalAction = null, this._target = t, this._tag = cc.Action.TAG_INVALID;
        }
        s.stopAll = function() {
            cc.director.getActionManager().removeAllActions();
        }, s.stopAllByTag = function(t) {
            cc.director.getActionManager().removeActionByTag(t);
        }, s.stopAllByTarget = function(t) {
            cc.director.getActionManager().removeAllActionsFromTarget(t);
        }, s.prototype.then = function(t) {
            return t instanceof cc.Action ? this._actions.push(t.clone()) : this._actions.push(t._union()), 
            this;
        }, s.prototype.target = function(t) {
            return this._target = t, this;
        }, s.prototype.start = function() {
            var t = this._target;
            return t ? t instanceof cc.Object && !t.isValid ? void 0 : (this._finalAction && cc.director.getActionManager().removeAction(this._finalAction), 
            this._finalAction = this._union(), void 0 === t._id && (t._id = ++i), this._finalAction.setTag(this._tag), 
            cc.director.getActionManager().addAction(this._finalAction, t, !1), this) : (cc.warn("Please set target to tween first"), 
            this);
        }, s.prototype.stop = function() {
            return this._finalAction && cc.director.getActionManager().removeAction(this._finalAction), 
            this;
        }, s.prototype.tag = function(t) {
            return this._tag = t, this;
        }, s.prototype.clone = function(t) {
            var e = this._union();
            return cc.tween(t).then(e.clone());
        }, s.prototype.union = function() {
            var t = this._union();
            return this._actions.length = 0, this._actions.push(t), this;
        }, s.prototype._union = function() {
            var t = this._actions;
            return 1 === t.length ? t[0] : cc.sequence(t);
        }, Object.assign(s.prototype, {
            bezierTo: function(t, i, n, r, s) {
                var o = i.x, a = i.y, c = n.x, l = n.y;
                return (s = s || Object.create(null)).progress = function(t, i, n, r) {
                    return n.x = (0, e.bezier)(t.x, o, c, i.x, r), n.y = (0, e.bezier)(t.y, a, l, i.y, r), 
                    n;
                }, this.to(t, {
                    position: r
                }, s);
            },
            bezierBy: function(t, i, n, r, s) {
                var o = i.x, a = i.y, c = n.x, l = n.y;
                return (s = s || Object.create(null)).progress = function(t, i, n, r) {
                    var s = t.x, u = t.y;
                    return n.x = (0, e.bezier)(s, o + s, c + s, i.x, r), n.y = (0, e.bezier)(u, a + u, l + u, i.y, r), 
                    n;
                }, this.by(t, {
                    position: r
                }, s);
            },
            flipX: function() {
                var t = this;
                return this.call(function() {
                    t._target.scaleX *= -1;
                }, this);
            },
            flipY: function() {
                var t = this;
                return this.call(function() {
                    t._target.scaleY *= -1;
                }, this);
            },
            blink: function(t, e, i) {
                var n = 1 / e;
                return (i = i || Object.create(null)).progress = function(t, e, i, r) {
                    return r >= 1 ? t : r % n > n / 2 ? 255 : 0;
                }, this.to(t, {
                    opacity: 1
                }, i);
            }
        });
        var o = [];
        function a(t) {
            return function() {
                o.length = 0;
                for (var e = arguments.length, i = 0; i < e; i++) {
                    var n = o[i] = arguments[i];
                    n instanceof s && (o[i] = n._union());
                }
                return t.apply(this, o);
            };
        }
        for (var c = {
            to: function(t, e, i) {
                return (i = i || Object.create(null)).relative = !1, new n(t, e, i);
            },
            by: function(t, e, i) {
                return (i = i || Object.create(null)).relative = !0, new n(t, e, i);
            },
            set: function(t) {
                return new r(t);
            },
            delay: cc.delayTime,
            call: cc.callFunc,
            hide: cc.hide,
            show: cc.show,
            removeSelf: cc.removeSelf,
            sequence: a(cc.sequence),
            parallel: a(cc.spawn)
        }, l = {
            repeat: cc.repeat,
            repeatForever: function(t) {
                return cc.repeat(t, 1e9);
            },
            reverseTime: cc.reverseTime
        }, u = Object.keys(c), h = function(t) {
            var e = u[t];
            s.prototype[e] = function() {
                var t = c[e].apply(this, arguments);
                return this._actions.push(t), this;
            };
        }, _ = 0; _ < u.length; _++) h(_);
        u = Object.keys(l);
        for (var f = function(t) {
            var e = u[t];
            s.prototype[e] = function() {
                var t = this._actions, i = arguments[arguments.length - 1], n = arguments.length - 1;
                i instanceof cc.Tween ? i = i._union() : i instanceof cc.Action || (i = t[t.length - 1], 
                t.length -= 1, n += 1);
                for (var r = [ i ], s = 0; s < n; s++) r.push(arguments[s]);
                return i = l[e].apply(this, r), t.push(i), this;
            };
        }, d = 0; d < u.length; d++) f(d);
        cc.tween = function(t) {
            return new s(t);
        }, cc.Tween = s;
    }, {
        "../animation/bezier": 14
    } ],
    9: [ function(t, e) {
        "use strict";
        var i = cc.js, n = t("./playable"), r = t("./animation-curves"), s = r.EventAnimCurve, o = r.EventInfo, a = t("./types").WrapModeMask, c = t("../core/utils/binary-search").binarySearchEpsilon;
        function l(t, e) {
            n.call(this), this.target = t, this.animation = e, this._anims = new i.array.MutableForwardIterator([]);
        }
        i.extend(l, n);
        var u = l.prototype;
        function h(t, e) {
            var i = e.clip;
            e.duration = i.duration, e.speed = i.speed, e.wrapMode = i.wrapMode, e.frameRate = i.sample, 
            (e.wrapMode & a.Loop) === a.Loop ? e.repeatCount = 1 / 0 : e.repeatCount = 1;
            var n = e.curves = i.createCurves(e, t), r = i.events;
            if (r) for (var l, u = 0, h = r.length; u < h; u++) {
                l || ((l = new s()).target = t, n.push(l));
                var _ = r[u], f = _.frame / e.duration, d = void 0, p = c(l.ratios, f);
                p >= 0 ? d = l.events[p] : (d = new o(), l.ratios.push(f), l.events.push(d)), d.add(_.func, _.params);
            }
        }
        u.playState = function(t, e) {
            t.clip && (t.curveLoaded || h(this.target, t), t.animator = this, t.play(), "number" == typeof e && t.setTime(e), 
            this.play());
        }, u.stopStatesExcept = function(t) {
            var e = this._anims, i = e.array;
            for (e.i = 0; e.i < i.length; ++e.i) {
                var n = i[e.i];
                n !== t && this.stopState(n);
            }
        }, u.addAnimation = function(t) {
            -1 === this._anims.array.indexOf(t) && this._anims.push(t), t._setEventTarget(this.animation);
        }, u.removeAnimation = function(t) {
            var e = this._anims.array.indexOf(t);
            e >= 0 ? (this._anims.fastRemoveAt(e), 0 === this._anims.array.length && this.stop()) : cc.errorID(3907), 
            t.animator = null;
        }, u.sample = function() {
            var t = this._anims, e = t.array;
            for (t.i = 0; t.i < e.length; ++t.i) e[t.i].sample();
        }, u.stopState = function(t) {
            t && t.stop();
        }, u.pauseState = function(t) {
            t && t.pause();
        }, u.resumeState = function(t) {
            t && t.resume(), this.isPaused && this.resume();
        }, u.setStateTime = function(t, e) {
            if (void 0 !== e) t && (t.setTime(e), t.sample()); else {
                e = t;
                for (var i = this._anims.array, n = 0; n < i.length; ++n) {
                    var r = i[n];
                    r.setTime(e), r.sample();
                }
            }
        }, u.onStop = function() {
            var t = this._anims, e = t.array;
            for (t.i = 0; t.i < e.length; ++t.i) e[t.i].stop();
        }, u.onPause = function() {
            for (var t = this._anims.array, e = 0; e < t.length; ++e) {
                var i = t[e];
                i.pause(), i.animator = null;
            }
        }, u.onResume = function() {
            for (var t = this._anims.array, e = 0; e < t.length; ++e) {
                var i = t[e];
                i.animator = this, i.resume();
            }
        }, u._reloadClip = function(t) {
            h(this.target, t);
        }, e.exports = l;
    }, {
        "../core/utils/binary-search": 250,
        "./animation-curves": 11,
        "./playable": 18,
        "./types": 19
    } ],
    10: [ function(t, e) {
        "use strict";
        var i = t("./types").WrapMode, n = t("./animation-curves"), r = n.DynamicAnimCurve, s = n.quickFindIndex, o = t("./motion-path-helper").sampleMotionPaths, a = t("../core/utils/binary-search").binarySearchEpsilon, c = cc.Class({
            name: "cc.AnimationClip",
            extends: cc.Asset,
            properties: {
                _duration: {
                    default: 0,
                    type: cc.Float
                },
                duration: {
                    get: function() {
                        return this._duration;
                    }
                },
                sample: {
                    default: 60
                },
                speed: {
                    default: 1
                },
                wrapMode: {
                    default: i.Normal
                },
                curveData: {
                    default: {},
                    visible: !1
                },
                events: {
                    default: [],
                    visible: !1
                }
            },
            statics: {
                createWithSpriteFrames: function(t, e) {
                    if (!Array.isArray(t)) return cc.errorID(3905), null;
                    var i = new c();
                    i.sample = e || i.sample, i._duration = t.length / i.sample;
                    for (var n = [], r = 1 / i.sample, s = 0, o = t.length; s < o; s++) n[s] = {
                        frame: s * r,
                        value: t[s]
                    };
                    return i.curveData = {
                        comps: {
                            "cc.Sprite": {
                                spriteFrame: n
                            }
                        }
                    }, i;
                }
            },
            onLoad: function() {
                this._duration = Number.parseFloat(this.duration), this.speed = Number.parseFloat(this.speed), 
                this.wrapMode = Number.parseInt(this.wrapMode), this.frameRate = Number.parseFloat(this.sample);
            },
            createPropCurve: function(t, e, i) {
                var n = [], c = t instanceof cc.Node && "position" === e, l = new r();
                l.target = t, l.prop = e;
                for (var u = 0, h = i.length; u < h; u++) {
                    var _ = i[u], f = _.frame / this.duration;
                    l.ratios.push(f), c && n.push(_.motionPath);
                    var d = _.value;
                    l.values.push(d);
                    var p = _.curve;
                    if (p) {
                        if ("string" == typeof p) {
                            l.types.push(p);
                            continue;
                        }
                        if (Array.isArray(p)) {
                            p[0] === p[1] && p[2] === p[3] ? l.types.push(r.Linear) : l.types.push(r.Bezier(p));
                            continue;
                        }
                    }
                    l.types.push(r.Linear);
                }
                c && o(n, l, this.duration, this.sample, t);
                for (var m, v, y = l.ratios, g = !0, x = 1, A = y.length; x < A; x++) if (m = y[x] - y[x - 1], 
                1 === x) v = m; else if (Math.abs(m - v) > 1e-6) {
                    g = !1;
                    break;
                }
                l._findFrameIndex = g ? s : a;
                var C = l.values[0];
                return null == C || l._lerp || ("number" == typeof C ? l._lerp = r.prototype._lerpNumber : C instanceof cc.Quat ? l._lerp = r.prototype._lerpQuat : C instanceof cc.Vec2 ? l._lerp = r.prototype._lerpVector2 : C instanceof cc.Vec3 ? l._lerp = r.prototype._lerpVector3 : C.lerp && (l._lerp = r.prototype._lerpObject)), 
                l;
            },
            createTargetCurves: function(t, e, i) {
                var n = e.props, r = e.comps;
                if (n) for (var s in n) {
                    var o = n[s], a = this.createPropCurve(t, s, o);
                    i.push(a);
                }
                if (r) for (var c in r) {
                    var l = t.getComponent(c);
                    if (l) {
                        var u = r[c];
                        for (var h in u) {
                            var _ = u[h], f = this.createPropCurve(l, h, _);
                            i.push(f);
                        }
                    }
                }
            },
            createCurves: function(t, e) {
                var i = this.curveData, n = i.paths, r = [];
                for (var s in this.createTargetCurves(e, i, r), n) {
                    var o = cc.find(s, e);
                    if (o) {
                        var a = n[s];
                        this.createTargetCurves(o, a, r);
                    }
                }
                return r;
            }
        });
        cc.AnimationClip = e.exports = c;
    }, {
        "../core/utils/binary-search": 250,
        "./animation-curves": 11,
        "./motion-path-helper": 17,
        "./types": 19
    } ],
    11: [ function(t, e) {
        "use strict";
        var i = t("./bezier").bezierByTime, n = t("../core/utils/binary-search").binarySearchEpsilon, r = t("./types").WrapModeMask, s = t("./types").WrappedInfo;
        function o(t, e) {
            if ("string" == typeof e) {
                var n = cc.easing[e];
                n ? t = n(t) : cc.errorID(3906, e);
            } else Array.isArray(e) && (t = i(e, t));
            return t;
        }
        var a = cc.Class({
            name: "cc.AnimCurve",
            sample: function() {},
            onTimeChangedManually: void 0
        });
        var c, l = cc.Class({
            name: "cc.DynamicAnimCurve",
            extends: a,
            ctor: function() {
                this._cachedIndex = 0;
            },
            properties: {
                target: null,
                prop: "",
                values: [],
                ratios: [],
                types: []
            },
            _findFrameIndex: n,
            _lerp: void 0,
            _lerpNumber: function(t, e, i) {
                return t + (e - t) * i;
            },
            _lerpObject: function(t, e, i) {
                return t.lerp(e, i);
            },
            _lerpQuat: (c = cc.quat(), function(t, e, i) {
                return t.lerp(e, i, c);
            }),
            _lerpVector2: function() {
                var t = cc.v2();
                return function(e, i, n) {
                    return e.lerp(i, n, t);
                };
            }(),
            _lerpVector3: function() {
                var t = cc.v3();
                return function(e, i, n) {
                    return e.lerp(i, n, t);
                };
            }(),
            sample: function(t, e) {
                var i = this.values, n = this.ratios, r = n.length;
                if (0 !== r) {
                    var s, a = !0, c = this._cachedIndex;
                    if (c < 0 && (c = ~c) > 0 && c < n.length) {
                        var l = n[c - 1], u = n[c];
                        e > l && e < u && (a = !1);
                    }
                    a && (this._cachedIndex = this._findFrameIndex(n, e));
                    var h = this._cachedIndex;
                    if (h < 0) if ((h = ~h) <= 0) s = i[0]; else if (h >= r) s = i[r - 1]; else {
                        var _ = i[h - 1];
                        if (this._lerp) {
                            var f = n[h - 1], d = n[h], p = this.types[h - 1], m = (e - f) / (d - f);
                            p && (m = o(m, p));
                            var v = i[h];
                            s = this._lerp(_, v, m);
                        } else s = _;
                    } else s = i[h];
                    this.target[this.prop] = s;
                }
            }
        });
        l.Linear = null, l.Bezier = function(t) {
            return t;
        };
        var u = function() {
            this.events = [];
        };
        u.prototype.add = function(t, e) {
            this.events.push({
                func: t || "",
                params: e || []
            });
        };
        var h = cc.Class({
            name: "cc.EventAnimCurve",
            extends: a,
            properties: {
                target: null,
                ratios: [],
                events: [],
                _wrappedInfo: {
                    default: function() {
                        return new s();
                    }
                },
                _lastWrappedInfo: null,
                _ignoreIndex: NaN
            },
            _wrapIterations: function(t) {
                return t - (0 | t) == 0 && (t -= 1), 0 | t;
            },
            sample: function(t, e, i) {
                var o = this.ratios.length, a = i.getWrappedInfo(i.time, this._wrappedInfo), c = a.direction, l = n(this.ratios, a.ratio);
                if (l < 0 && (l = ~l - 1, c < 0 && (l += 1)), this._ignoreIndex !== l && (this._ignoreIndex = NaN), 
                a.frameIndex = l, !this._lastWrappedInfo) return this._fireEvent(l), void (this._lastWrappedInfo = new s(a));
                var u = i.wrapMode, h = this._wrapIterations(a.iterations), _ = this._lastWrappedInfo, f = this._wrapIterations(_.iterations), d = _.frameIndex, p = _.direction, m = -1 !== f && h !== f;
                if (d === l && m && 1 === o) this._fireEvent(0); else if (d !== l || m) {
                    c = p;
                    do {
                        if (d !== l) {
                            if (-1 === c && 0 === d && l > 0 ? ((u & r.PingPong) === r.PingPong ? c *= -1 : d = o, 
                            f++) : 1 === c && d === o - 1 && l < o - 1 && ((u & r.PingPong) === r.PingPong ? c *= -1 : d = -1, 
                            f++), d === l) break;
                            if (f > h) break;
                        }
                        d += c, cc.director.getAnimationManager().pushDelayEvent(this, "_fireEvent", [ d ]);
                    } while (d !== l && d > -1 && d < o);
                }
                this._lastWrappedInfo.set(a);
            },
            _fireEvent: function(t) {
                if (!(t < 0 || t >= this.events.length || this._ignoreIndex === t)) {
                    var e = this.events[t].events;
                    if (this.target.isValid) for (var i = this.target._components, n = 0; n < e.length; n++) for (var r = e[n], s = r.func, o = 0; o < i.length; o++) {
                        var a = i[o], c = a[s];
                        c && c.apply(a, r.params);
                    }
                }
            },
            onTimeChangedManually: function(t, e) {
                this._lastWrappedInfo = null, this._ignoreIndex = NaN;
                var i = e.getWrappedInfo(t, this._wrappedInfo), r = i.direction, s = n(this.ratios, i.ratio);
                s < 0 && (s = ~s - 1, r < 0 && (s += 1), this._ignoreIndex = s);
            }
        });
        e.exports = {
            AnimCurve: a,
            DynamicAnimCurve: l,
            EventAnimCurve: h,
            EventInfo: u,
            computeRatioByType: o,
            quickFindIndex: function(t, e) {
                var i = t.length - 1;
                if (0 === i) return 0;
                var n = t[0];
                if (e < n) return 0;
                var r = t[i];
                if (e > r) return ~t.length;
                var s = (e = (e - n) / (r - n)) / (1 / i), o = 0 | s;
                return s - o < 1e-6 ? o : o + 1 - s < 1e-6 ? o + 1 : ~(o + 1);
            }
        };
    }, {
        "../core/utils/binary-search": 250,
        "./bezier": 14,
        "./types": 19
    } ],
    12: [ function(t, e) {
        "use strict";
        var i = cc.js, n = cc.Class({
            ctor: function() {
                this._anims = new i.array.MutableForwardIterator([]), this._delayEvents = [], cc.director._scheduler && cc.director._scheduler.enableForTarget(this);
            },
            update: function(t) {
                var e = this._anims, i = e.array;
                for (e.i = 0; e.i < i.length; ++e.i) {
                    var n = i[e.i];
                    n._isPlaying && !n._isPaused && n.update(t);
                }
                for (var r = this._delayEvents, s = 0; s < r.length; s++) {
                    var o = r[s];
                    o.target[o.func].apply(o.target, o.args);
                }
                r.length = 0;
            },
            destruct: function() {},
            addAnimation: function(t) {
                -1 === this._anims.array.indexOf(t) && this._anims.push(t);
            },
            removeAnimation: function(t) {
                var e = this._anims.array.indexOf(t);
                e >= 0 ? this._anims.fastRemoveAt(e) : cc.errorID(3907);
            },
            pushDelayEvent: function(t, e, i) {
                this._delayEvents.push({
                    target: t,
                    func: e,
                    args: i
                });
            }
        });
        cc.AnimationManager = e.exports = n;
    }, {} ],
    13: [ function(t, e) {
        "use strict";
        var i = cc.js, n = t("./playable"), r = t("./types"), s = r.WrappedInfo, o = r.WrapMode, a = r.WrapModeMask;
        function c(t, e) {
            n.call(this), this._currentFramePlayed = !1, this._delay = 0, this._delayTime = 0, 
            this._wrappedInfo = new s(), this._lastWrappedInfo = null, this._process = u, this._clip = t, 
            this._name = e || t && t.name, this.animator = null, this.curves = [], this.delay = 0, 
            this.repeatCount = 1, this.duration = 1, this.speed = 1, this.wrapMode = o.Normal, 
            this.time = 0, this._target = null, this._lastframeEventOn = !1, this.emit = function() {
                for (var t = new Array(arguments.length), e = 0, i = t.length; e < i; e++) t[e] = arguments[e];
                cc.director.getAnimationManager().pushDelayEvent(this, "_emit", t);
            };
        }
        i.extend(c, n);
        var l = c.prototype;
        function u() {
            var t, e = this.sample();
            this._lastframeEventOn && (t = this._lastWrappedInfo ? this._lastWrappedInfo : this._lastWrappedInfo = new s(e), 
            this.repeatCount > 1 && (0 | e.iterations) > (0 | t.iterations) && this.emit("lastframe", this), 
            t.set(e)), e.stopped && (this.stop(), this.emit("finished", this));
        }
        function h() {
            var t = this.time, e = this.duration;
            t > e ? 0 == (t %= e) && (t = e) : t < 0 && 0 != (t %= e) && (t += e);
            for (var i = t / e, n = this.curves, r = 0, s = n.length; r < s; r++) n[r].sample(t, i, this);
            this._lastframeEventOn && (void 0 === this._lastIterations && (this._lastIterations = i), 
            (this.time > 0 && this._lastIterations > i || this.time < 0 && this._lastIterations < i) && this.emit("lastframe", this), 
            this._lastIterations = i);
        }
        l._emit = function(t, e) {
            this._target && this._target.isValid && this._target.emit(t, t, e);
        }, l.on = function(t, e, i) {
            return this._target && this._target.isValid ? ("lastframe" === t && (this._lastframeEventOn = !0), 
            this._target.on(t, e, i)) : null;
        }, l.once = function(t, e, i) {
            if (this._target && this._target.isValid) {
                "lastframe" === t && (this._lastframeEventOn = !0);
                var n = this;
                return this._target.once(t, function(t) {
                    e.call(i, t), n._lastframeEventOn = !1;
                });
            }
            return null;
        }, l.off = function(t, e, i) {
            this._target && this._target.isValid && ("lastframe" === t && (this._target.hasEventListener(t) || (this._lastframeEventOn = !1)), 
            this._target.off(t, e, i));
        }, l._setEventTarget = function(t) {
            this._target = t;
        }, l.onPlay = function() {
            this.setTime(0), this._delayTime = this._delay, cc.director.getAnimationManager().addAnimation(this), 
            this.animator && this.animator.addAnimation(this), this.emit("play", this);
        }, l.onStop = function() {
            this.isPaused || cc.director.getAnimationManager().removeAnimation(this), this.animator && this.animator.removeAnimation(this), 
            this.emit("stop", this);
        }, l.onResume = function() {
            cc.director.getAnimationManager().addAnimation(this), this.emit("resume", this);
        }, l.onPause = function() {
            cc.director.getAnimationManager().removeAnimation(this), this.emit("pause", this);
        }, l.setTime = function(t) {
            this._currentFramePlayed = !1, this.time = t || 0;
            for (var e = this.curves, i = 0, n = e.length; i < n; i++) {
                var r = e[i];
                r.onTimeChangedManually && r.onTimeChangedManually(t, this);
            }
        }, l.update = function(t) {
            this._delayTime > 0 && (this._delayTime -= t, this._delayTime > 0) || (this._currentFramePlayed ? this.time += t * this.speed : this._currentFramePlayed = !0, 
            this._process());
        }, l._needRevers = function(t) {
            var e = this.wrapMode, i = !1;
            return (e & a.PingPong) === a.PingPong && (t - (0 | t) == 0 && t > 0 && (t -= 1), 
            1 & t && (i = !i)), (e & a.Reverse) === a.Reverse && (i = !i), i;
        }, l.getWrappedInfo = function(t, e) {
            e = e || new s();
            var i = !1, n = this.duration, r = this.repeatCount, o = t > 0 ? t / n : -t / n;
            if (o >= r) {
                o = r, i = !0;
                var c = r - (0 | r);
                0 === c && (c = 1), t = c * n * (t > 0 ? 1 : -1);
            }
            if (t > n) {
                var l = t % n;
                t = 0 === l ? n : l;
            } else t < 0 && 0 != (t %= n) && (t += n);
            var u = !1, h = this._wrapMode & a.ShouldWrap;
            h && (u = this._needRevers(o));
            var _ = u ? -1 : 1;
            return this.speed < 0 && (_ *= -1), h && u && (t = n - t), e.ratio = t / n, e.time = t, 
            e.direction = _, e.stopped = i, e.iterations = o, e;
        }, l.sample = function() {
            for (var t = this.getWrappedInfo(this.time, this._wrappedInfo), e = this.curves, i = 0, n = e.length; i < n; i++) e[i].sample(t.time, t.ratio, this);
            return t;
        }, i.get(l, "clip", function() {
            return this._clip;
        }), i.get(l, "name", function() {
            return this._name;
        }), i.obsolete(l, "AnimationState.length", "duration"), i.getset(l, "curveLoaded", function() {
            return this.curves.length > 0;
        }, function() {
            this.curves.length = 0;
        }), i.getset(l, "wrapMode", function() {
            return this._wrapMode;
        }, function(t) {
            this._wrapMode = t, this.time = 0, t & a.Loop ? this.repeatCount = 1 / 0 : this.repeatCount = 1;
        }), i.getset(l, "repeatCount", function() {
            return this._repeatCount;
        }, function(t) {
            this._repeatCount = t;
            var e = this._wrapMode & a.ShouldWrap, i = (this.wrapMode & a.Reverse) === a.Reverse;
            this._process = t !== 1 / 0 || e || i ? u : h;
        }), i.getset(l, "delay", function() {
            return this._delay;
        }, function(t) {
            this._delayTime = this._delay = t;
        }), cc.AnimationState = e.exports = c;
    }, {
        "./playable": 18,
        "./types": 19
    } ],
    14: [ function(t, e) {
        "use strict";
        var i = Math.cos, n = Math.acos, r = Math.max, s = 2 * Math.PI, o = Math.sqrt;
        function a(t) {
            return t < 0 ? -Math.pow(-t, 1 / 3) : Math.pow(t, 1 / 3);
        }
        function c(t, e) {
            var c, l, u, h, _ = e - 0, f = e - t[0], d = 3 * _, p = 3 * f, m = 3 * (e - t[2]), v = 1 / (-_ + p - m + (e - 1)), y = (d - 6 * f + m) * v, g = y * (1 / 3), x = (-d + p) * v, A = 1 / 3 * (3 * x - y * y), C = A * (1 / 3), b = (2 * y * y * y - 9 * y * x + _ * v * 27) / 27, S = b / 2, T = S * S + C * C * C;
            if (T < 0) {
                var w = 1 / 3 * -A, E = o(w * w * w), B = -b / (2 * E), M = n(B < -1 ? -1 : B > 1 ? 1 : B), R = 2 * a(E);
                return l = R * i(M * (1 / 3)) - g, u = R * i((M + s) * (1 / 3)) - g, h = R * i((M + 2 * s) * (1 / 3)) - g, 
                0 <= l && l <= 1 ? 0 <= u && u <= 1 ? 0 <= h && h <= 1 ? r(l, u, h) : r(l, u) : 0 <= h && h <= 1 ? r(l, h) : l : 0 <= u && u <= 1 ? 0 <= h && h <= 1 ? r(u, h) : u : h;
            }
            if (0 === T) return u = -(c = S < 0 ? a(-S) : -a(S)) - g, 0 <= (l = 2 * c - g) && l <= 1 ? 0 <= u && u <= 1 ? r(l, u) : l : u;
            var P = o(T);
            return (c = a(-S + P)) - a(S + P) - g;
        }
        e.exports = {
            bezier: function(t, e, i, n, r) {
                var s = 1 - r;
                return s * (s * (t + (3 * e - t) * r) + 3 * i * r * r) + n * r * r * r;
            },
            bezierByTime: function(t, e) {
                var i = c(t, e), n = t[1];
                return ((1 - i) * (n + (t[3] - n) * i) * 3 + i * i) * i;
            }
        };
    }, {} ],
    15: [ function(t, e) {
        "use strict";
        var i = {
            constant: function() {
                return 0;
            },
            linear: function(t) {
                return t;
            },
            quadIn: function(t) {
                return t * t;
            },
            quadOut: function(t) {
                return t * (2 - t);
            },
            quadInOut: function(t) {
                return (t *= 2) < 1 ? .5 * t * t : -.5 * (--t * (t - 2) - 1);
            },
            cubicIn: function(t) {
                return t * t * t;
            },
            cubicOut: function(t) {
                return --t * t * t + 1;
            },
            cubicInOut: function(t) {
                return (t *= 2) < 1 ? .5 * t * t * t : .5 * ((t -= 2) * t * t + 2);
            },
            quartIn: function(t) {
                return t * t * t * t;
            },
            quartOut: function(t) {
                return 1 - --t * t * t * t;
            },
            quartInOut: function(t) {
                return (t *= 2) < 1 ? .5 * t * t * t * t : -.5 * ((t -= 2) * t * t * t - 2);
            },
            quintIn: function(t) {
                return t * t * t * t * t;
            },
            quintOut: function(t) {
                return --t * t * t * t * t + 1;
            },
            quintInOut: function(t) {
                return (t *= 2) < 1 ? .5 * t * t * t * t * t : .5 * ((t -= 2) * t * t * t * t + 2);
            },
            sineIn: function(t) {
                return 1 - Math.cos(t * Math.PI / 2);
            },
            sineOut: function(t) {
                return Math.sin(t * Math.PI / 2);
            },
            sineInOut: function(t) {
                return .5 * (1 - Math.cos(Math.PI * t));
            },
            expoIn: function(t) {
                return 0 === t ? 0 : Math.pow(1024, t - 1);
            },
            expoOut: function(t) {
                return 1 === t ? 1 : 1 - Math.pow(2, -10 * t);
            },
            expoInOut: function(t) {
                return 0 === t ? 0 : 1 === t ? 1 : (t *= 2) < 1 ? .5 * Math.pow(1024, t - 1) : .5 * (2 - Math.pow(2, -10 * (t - 1)));
            },
            circIn: function(t) {
                return 1 - Math.sqrt(1 - t * t);
            },
            circOut: function(t) {
                return Math.sqrt(1 - --t * t);
            },
            circInOut: function(t) {
                return (t *= 2) < 1 ? -.5 * (Math.sqrt(1 - t * t) - 1) : .5 * (Math.sqrt(1 - (t -= 2) * t) + 1);
            },
            elasticIn: function(t) {
                var e, i = .1;
                return 0 === t ? 0 : 1 === t ? 1 : (!i || i < 1 ? (i = 1, e = .1) : e = .4 * Math.asin(1 / i) / (2 * Math.PI), 
                -i * Math.pow(2, 10 * (t -= 1)) * Math.sin(2 * (t - e) * Math.PI / .4));
            },
            elasticOut: function(t) {
                var e, i = .1;
                return 0 === t ? 0 : 1 === t ? 1 : (!i || i < 1 ? (i = 1, e = .1) : e = .4 * Math.asin(1 / i) / (2 * Math.PI), 
                i * Math.pow(2, -10 * t) * Math.sin(2 * (t - e) * Math.PI / .4) + 1);
            },
            elasticInOut: function(t) {
                var e, i = .1;
                return 0 === t ? 0 : 1 === t ? 1 : (!i || i < 1 ? (i = 1, e = .1) : e = .4 * Math.asin(1 / i) / (2 * Math.PI), 
                (t *= 2) < 1 ? i * Math.pow(2, 10 * (t -= 1)) * Math.sin(2 * (t - e) * Math.PI / .4) * -.5 : i * Math.pow(2, -10 * (t -= 1)) * Math.sin(2 * (t - e) * Math.PI / .4) * .5 + 1);
            },
            backIn: function(t) {
                var e = 1.70158;
                return t * t * ((e + 1) * t - e);
            },
            backOut: function(t) {
                var e = 1.70158;
                return --t * t * ((e + 1) * t + e) + 1;
            },
            backInOut: function(t) {
                var e = 2.5949095;
                return (t *= 2) < 1 ? t * t * ((e + 1) * t - e) * .5 : .5 * ((t -= 2) * t * ((e + 1) * t + e) + 2);
            },
            bounceIn: function(t) {
                return 1 - i.bounceOut(1 - t);
            },
            bounceOut: function(t) {
                return t < 1 / 2.75 ? 7.5625 * t * t : t < 2 / 2.75 ? 7.5625 * (t -= 1.5 / 2.75) * t + .75 : t < 2.5 / 2.75 ? 7.5625 * (t -= 2.25 / 2.75) * t + .9375 : 7.5625 * (t -= 2.625 / 2.75) * t + .984375;
            },
            bounceInOut: function(t) {
                return t < .5 ? .5 * i.bounceIn(2 * t) : .5 * i.bounceOut(2 * t - 1) + .5;
            },
            smooth: function(t) {
                return t <= 0 ? 0 : t >= 1 ? 1 : t * t * (3 - 2 * t);
            },
            fade: function(t) {
                return t <= 0 ? 0 : t >= 1 ? 1 : t * t * t * (t * (6 * t - 15) + 10);
            }
        };
        function n(t, e) {
            return function(i) {
                return i < .5 ? e(2 * i) / 2 : t(2 * i - 1) / 2 + .5;
            };
        }
        i.quadOutIn = n(i.quadIn, i.quadOut), i.cubicOutIn = n(i.cubicIn, i.cubicOut), i.quartOutIn = n(i.quartIn, i.quartOut), 
        i.quintOutIn = n(i.quintIn, i.quintOut), i.sineOutIn = n(i.sineIn, i.sineOut), i.expoOutIn = n(i.expoIn, i.expoOut), 
        i.circOutIn = n(i.circIn, i.circOut), i.backOutIn = n(i.backIn, i.backOut), i.bounceIn = function(t) {
            return 1 - i.bounceOut(1 - t);
        }, i.bounceInOut = function(t) {
            return t < .5 ? .5 * i.bounceIn(2 * t) : .5 * i.bounceOut(2 * t - 1) + .5;
        }, i.bounceOutIn = n(i.bounceIn, i.bounceOut), cc.easing = e.exports = i;
    }, {} ],
    16: [ function(t) {
        "use strict";
        t("./bezier"), t("./easing"), t("./types"), t("./motion-path-helper"), t("./animation-curves"), 
        t("./animation-clip"), t("./animation-manager"), t("./animation-state"), t("./animation-animator");
    }, {
        "./animation-animator": 9,
        "./animation-clip": 10,
        "./animation-curves": 11,
        "./animation-manager": 12,
        "./animation-state": 13,
        "./bezier": 14,
        "./easing": 15,
        "./motion-path-helper": 17,
        "./types": 19
    } ],
    17: [ function(t, e) {
        "use strict";
        var i = t("./animation-curves").DynamicAnimCurve, n = t("./animation-curves").computeRatioByType, r = t("./bezier").bezier, s = t("../core/utils/binary-search").binarySearchEpsilon, o = cc.v2;
        function a(t) {
            this.points = t || [], this.beziers = [], this.ratios = [], this.progresses = [], 
            this.length = 0, this.computeBeziers();
        }
        function c() {
            this.start = o(), this.end = o(), this.startCtrlPoint = o(), this.endCtrlPoint = o();
        }
        function l(t) {
            if (!Array.isArray(t)) return !1;
            for (var e = 0, i = t.length; e < i; e++) {
                var n = t[e];
                if (!Array.isArray(n) || 6 !== n.length) return !1;
            }
            return !0;
        }
        a.prototype.computeBeziers = function() {
            var t;
            this.beziers.length = 0, this.ratios.length = 0, this.progresses.length = 0, this.length = 0;
            for (var e = 1; e < this.points.length; e++) {
                var i = this.points[e - 1], n = this.points[e];
                (t = new c()).start = i.pos, t.startCtrlPoint = i.out, t.end = n.pos, t.endCtrlPoint = n.in, 
                this.beziers.push(t), this.length += t.getLength();
            }
            var r = 0;
            for (e = 0; e < this.beziers.length; e++) t = this.beziers[e], this.ratios[e] = t.getLength() / this.length, 
            this.progresses[e] = r += this.ratios[e];
            return this.beziers;
        }, c.prototype.getPointAt = function(t) {
            var e = this.getUtoTmapping(t);
            return this.getPoint(e);
        }, c.prototype.getPoint = function(t) {
            var e = r(this.start.x, this.startCtrlPoint.x, this.endCtrlPoint.x, this.end.x, t), i = r(this.start.y, this.startCtrlPoint.y, this.endCtrlPoint.y, this.end.y, t);
            return new o(e, i);
        }, c.prototype.getLength = function() {
            var t = this.getLengths();
            return t[t.length - 1];
        }, c.prototype.getLengths = function(t) {
            if (t || (t = this.__arcLengthDivisions ? this.__arcLengthDivisions : 200), this.cacheArcLengths && this.cacheArcLengths.length === t + 1) return this.cacheArcLengths;
            var e, i, n = [], r = this.getPoint(0), s = o(), a = 0;
            for (n.push(0), i = 1; i <= t; i++) e = this.getPoint(i / t), s.x = r.x - e.x, s.y = r.y - e.y, 
            a += s.mag(), n.push(a), r = e;
            return this.cacheArcLengths = n, n;
        }, c.prototype.getUtoTmapping = function(t, e) {
            var i, n = this.getLengths(), r = 0, s = n.length;
            i = e || t * n[s - 1];
            for (var o, a = 0, c = s - 1; a <= c; ) if ((o = n[r = Math.floor(a + (c - a) / 2)] - i) < 0) a = r + 1; else {
                if (!(o > 0)) {
                    c = r;
                    break;
                }
                c = r - 1;
            }
            if (n[r = c] === i) return r / (s - 1);
            var l = n[r];
            return (r + (i - l) / (n[r + 1] - l)) / (s - 1);
        }, e.exports = {
            sampleMotionPaths: function(t, e, r, c, u) {
                function h(t) {
                    return t instanceof cc.Vec2 ? {
                        in: t,
                        pos: t,
                        out: t
                    } : Array.isArray(t) && 6 === t.length ? {
                        in: o(t[2], t[3]),
                        pos: o(t[0], t[1]),
                        out: o(t[4], t[5])
                    } : {
                        in: cc.Vec2.ZERO,
                        pos: cc.Vec2.ZERO,
                        out: cc.Vec2.ZERO
                    };
                }
                var _ = e.values = e.values.map(function(t) {
                    return Array.isArray(t) && (t = 2 === t.length ? cc.v2(t[0], t[1]) : cc.v3(t[0], t[1], t[2])), 
                    t;
                });
                if (0 !== t.length && 0 !== _.length) {
                    for (var f = !1, d = 0; d < t.length; d++) {
                        var p = t[d];
                        if (p && !l(p) && (cc.errorID(3904, u ? u.name : "", "position", d), p = null), 
                        p && p.length > 0) {
                            f = !0;
                            break;
                        }
                    }
                    if (f && 1 !== _.length) {
                        for (var m = e.types, v = e.ratios, y = e.values = [], g = e.types = [], x = e.ratios = [], A = 0, C = i.Linear, b = 0, S = t.length; b < S - 1; b++) {
                            var T, w = t[b], E = v[b], B = v[b + 1] - E, M = _[b], R = _[b + 1], P = m[b], I = [], D = A / B, V = 1 / (B * r * c);
                            if (w && w.length > 0) {
                                var L = [];
                                L.push(h(M));
                                for (var O = 0, F = w.length; O < F; O++) {
                                    var N = h(w[O]);
                                    L.push(N);
                                }
                                L.push(h(R));
                                var G = new a(L);
                                G.computeBeziers();
                                for (var k = G.progresses; 1 - D > 1e-6; ) {
                                    var z, U, H, W;
                                    if ((T = n(T = D, P)) < 0) W = (0 - T) * (U = G.beziers[0]).getLength(), H = U.start.sub(U.endCtrlPoint).normalize(), 
                                    z = U.start.add(H.mul(W)); else if (T > 1) W = (T - 1) * (U = G.beziers[G.beziers.length - 1]).getLength(), 
                                    H = U.end.sub(U.startCtrlPoint).normalize(), z = U.end.add(H.mul(W)); else {
                                        var j = s(k, T);
                                        j < 0 && (j = ~j), T -= j > 0 ? k[j - 1] : 0, T /= G.ratios[j], z = G.beziers[j].getPointAt(T);
                                    }
                                    I.push(z), D += V;
                                }
                            } else for (;1 - D > 1e-6; ) T = n(T = D, P), I.push(M.lerp(R, T)), D += V;
                            for (C = "constant" === P ? P : i.Linear, O = 0, F = I.length; O < F; O++) {
                                var q = E + A + V * O * B;
                                X(I[O], C, q);
                            }
                            A = Math.abs(D - 1) > 1e-6 ? (D - 1) * B : 0;
                        }
                        v[v.length - 1] !== x[x.length - 1] && X(_[_.length - 1], C, v[v.length - 1]);
                    }
                }
                function X(t, e, i) {
                    y.push(t), g.push(e), x.push(i);
                }
            },
            Curve: a,
            Bezier: c
        };
    }, {
        "../core/utils/binary-search": 250,
        "./animation-curves": 11,
        "./bezier": 14
    } ],
    18: [ function(t, e) {
        "use strict";
        var i = cc.js, n = t("../core/CCDebug");
        function r() {
            this._isPlaying = !1, this._isPaused = !1, this._stepOnce = !1;
        }
        var s = r.prototype;
        i.get(s, "isPlaying", function() {
            return this._isPlaying;
        }, !0), i.get(s, "isPaused", function() {
            return this._isPaused;
        }, !0);
        var o = function() {};
        s.onPlay = o, s.onPause = o, s.onResume = o, s.onStop = o, s.onError = o, s.play = function() {
            this._isPlaying ? this._isPaused ? (this._isPaused = !1, this.onResume()) : this.onError(n.getError(3912)) : (this._isPlaying = !0, 
            this.onPlay());
        }, s.stop = function() {
            this._isPlaying && (this._isPlaying = !1, this.onStop(), this._isPaused = !1);
        }, s.pause = function() {
            this._isPlaying && !this._isPaused && (this._isPaused = !0, this.onPause());
        }, s.resume = function() {
            this._isPlaying && this._isPaused && (this._isPaused = !1, this.onResume());
        }, s.step = function() {
            this.pause(), this._stepOnce = !0, this._isPlaying || this.play();
        }, e.exports = r;
    }, {
        "../core/CCDebug": 22
    } ],
    19: [ function(t, e) {
        "use strict";
        var i = {
            Loop: 2,
            ShouldWrap: 4,
            PingPong: 22,
            Reverse: 36
        }, n = cc.Enum({
            Default: 0,
            Normal: 1,
            Reverse: i.Reverse,
            Loop: i.Loop,
            LoopReverse: i.Loop | i.Reverse,
            PingPong: i.PingPong,
            PingPongReverse: i.PingPong | i.Reverse
        });
        function r(t) {
            t ? this.set(t) : (this.ratio = 0, this.time = 0, this.direction = 1, this.stopped = !0, 
            this.iterations = 0, this.frameIndex = void 0);
        }
        cc.WrapMode = n, r.prototype.set = function(t) {
            this.ratio = t.ratio, this.time = t.time, this.direction = t.direction, this.stopped = t.stopped, 
            this.iterations = t.iterations, this.frameIndex = t.frameIndex;
        }, e.exports = {
            WrapModeMask: i,
            WrapMode: n,
            WrappedInfo: r
        };
    }, {} ],
    20: [ function(t, e) {
        "use strict";
        var i, n, r = t("../core/event/event-target"), s = t("../core/platform/CCSys"), o = t("../core/assets/CCAudioClip").LoadMode, a = !1, c = [], l = function t(e) {
            r.call(this), this._shouldRecycleOnEnded = !1, this._src = e, this._element = null, 
            this.id = 0, this._state = t.State.INITIALZING, this._onended = function() {
                this._state = t.State.STOPPED, this.emit("ended");
            }.bind(this);
        };
        cc.js.extend(l, r), l.State = {
            ERROR: -1,
            INITIALZING: 0,
            PLAYING: 1,
            PAUSED: 2,
            STOPPED: 3
        }, (i = l.prototype)._bindEnded = function(t) {
            t = t || this._onended;
            var e = this._element;
            this._src && e instanceof HTMLAudioElement ? e.addEventListener("ended", t) : e.onended = t;
        }, i._unbindEnded = function() {
            var t = this._element;
            t instanceof HTMLAudioElement ? t.removeEventListener("ended", this._onended) : t && (t.onended = null);
        }, i._onLoaded = function() {
            this._createElement(), this._state = l.State.INITIALZING, this.setVolume(1), this.setLoop(!1);
        }, i._createElement = function() {
            var t = this._src._nativeAsset;
            t instanceof HTMLAudioElement ? (this._element || (this._element = document.createElement("audio")), 
            this._element.src = t.src) : this._element = new u(t, this);
        }, i.play = function() {
            var t = this;
            this._src && this._src._ensureLoaded(function() {
                t._state = l.State.PLAYING, t._bindEnded();
                var e = t._element.play();
                window.Promise && e instanceof Promise && e.catch(function() {}), t._touchToPlay();
            });
        }, i._touchToPlay = function() {
            if (this._src && this._src.loadMode === o.DOM_AUDIO && this._element.paused && c.push({
                instance: this,
                offset: 0,
                audio: this._element
            }), !a) {
                a = !0;
                var t = "ontouchend" in window ? "touchend" : "mousedown";
                cc.game.canvas.addEventListener(t, function() {
                    for (var t; t = c.pop(); ) t.audio.play(t.offset);
                });
            }
        }, i.destroy = function() {
            this._element = null;
        }, i.pause = function() {
            if (this.getState() === l.State.PLAYING) {
                var t = this;
                this._src && this._src._ensureLoaded(function() {
                    t._unbindEnded(), t._element.pause(), t._state = l.State.PAUSED;
                });
            }
        }, i.resume = function() {
            if (this.getState() === l.State.PAUSED) {
                var t = this;
                this._src && this._src._ensureLoaded(function() {
                    t._bindEnded(), t._element.play(), t._state = l.State.PLAYING;
                });
            }
        }, i.stop = function() {
            var t = this;
            this._src && this._src._ensureLoaded(function() {
                t._element.pause(), t._element.currentTime = 0;
                for (var e = 0; e < c.length; e++) if (c[e].instance === t) {
                    c.splice(e, 1);
                    break;
                }
                t._unbindEnded(), t.emit("stop"), t._state = l.State.STOPPED;
            });
        }, i.setLoop = function(t) {
            var e = this;
            this._src && this._src._ensureLoaded(function() {
                e._element.loop = t;
            });
        }, i.getLoop = function() {
            return !!this._element && this._element.loop;
        }, i.setVolume = function(t) {
            var e = this;
            this._src && this._src._ensureLoaded(function() {
                e._element.volume = t;
            });
        }, i.getVolume = function() {
            return this._element ? this._element.volume : 1;
        }, i.setCurrentTime = function(t) {
            var e = this;
            this._src && this._src._ensureLoaded(function() {
                e._unbindEnded(), e._bindEnded(function() {
                    e._bindEnded();
                }), e._element.currentTime = t;
            });
        }, i.getCurrentTime = function() {
            return this._element ? this._element.currentTime : 0;
        }, i.getDuration = function() {
            return this._src ? this._src.duration : 0;
        }, i.getState = function(t) {
            return void 0 === t && (t = !0), t && this._forceUpdatingState(), this._state;
        }, i._forceUpdatingState = function() {
            var t = this._element;
            t && (l.State.PLAYING === this._state && t.paused ? this._state = l.State.STOPPED : l.State.STOPPED !== this._state || t.paused || (this._state = l.State.PLAYING));
        }, Object.defineProperty(i, "src", {
            get: function() {
                return this._src;
            },
            set: function(t) {
                if (this._unbindEnded(), t) {
                    if (t !== this._src) if (this._src = t, t.loaded) this._onLoaded(); else {
                        var e = this;
                        t.once("load", function() {
                            t === e._src && e._onLoaded();
                        });
                    }
                } else this._src = null, this._element instanceof u ? this._element = null : this._element && (this._element.src = ""), 
                this._state = l.State.INITIALZING;
                return t;
            },
            enumerable: !0,
            configurable: !0
        }), Object.defineProperty(i, "paused", {
            get: function() {
                return !this._element || this._element.paused;
            },
            enumerable: !0,
            configurable: !0
        }), n = cc.sys.browserType === cc.sys.BROWSER_TYPE_EDGE || cc.sys.browserType === cc.sys.BROWSER_TYPE_BAIDU || cc.sys.browserType === cc.sys.BROWSER_TYPE_UC ? .01 : 0;
        var u = function(t, e) {
            this._audio = e, this._context = s.__audioSupport.context, this._buffer = t, this._gainObj = this._context.createGain(), 
            this.volume = 1, this._gainObj.connect(this._context.destination), this._loop = !1, 
            this._startTime = -1, this._currentSource = null, this.playedLength = 0, this._currentTimer = null, 
            this._endCallback = function() {
                this.onended && this.onended(this);
            }.bind(this);
        };
        (function(t) {
            t.play = function(t) {
                this._currentSource && !this.paused && (this._currentSource.onended = null, this._currentSource.stop(0), 
                this.playedLength = 0);
                var e = this._context.createBufferSource();
                e.buffer = this._buffer, e.connect(this._gainObj), e.loop = this._loop, this._startTime = this._context.currentTime, 
                (t = t || this.playedLength) && (this._startTime -= t);
                var i, n = this._buffer.duration, r = t;
                if (this._loop ? e.start ? e.start(0, r) : e.notoGrainOn ? e.noteGrainOn(0, r) : e.noteOn(0, r) : (i = n - t, 
                e.start ? e.start(0, r, i) : e.noteGrainOn ? e.noteGrainOn(0, r, i) : e.noteOn(0, r, i)), 
                this._currentSource = e, e.onended = this._endCallback, (!e.context.state || "suspended" === e.context.state) && 0 === this._context.currentTime) {
                    var s = this;
                    clearTimeout(this._currentTimer), this._currentTimer = setTimeout(function() {
                        0 === s._context.currentTime && c.push({
                            instance: s._audio,
                            offset: t,
                            audio: s
                        });
                    }, 10);
                }
                var o = cc.sys;
                o.os === o.OS_IOS && o.isBrowser && o.isMobile && ("suspended" === e.context.state && 0 !== this._context.currentTime || "interrupted" === e.context.state) && e.context.resume();
            }, t.pause = function() {
                if (clearTimeout(this._currentTimer), !this.paused) {
                    this.playedLength = this._context.currentTime - this._startTime, this.playedLength %= this._buffer.duration;
                    var t = this._currentSource;
                    this._currentSource = null, this._startTime = -1, t && t.stop(0);
                }
            }, Object.defineProperty(t, "paused", {
                get: function() {
                    return (!this._currentSource || !this._currentSource.loop) && (-1 === this._startTime || this._context.currentTime - this._startTime > this._buffer.duration);
                },
                enumerable: !0,
                configurable: !0
            }), Object.defineProperty(t, "loop", {
                get: function() {
                    return this._loop;
                },
                set: function(t) {
                    return this._currentSource && (this._currentSource.loop = t), this._loop = t;
                },
                enumerable: !0,
                configurable: !0
            }), Object.defineProperty(t, "volume", {
                get: function() {
                    return this._volume;
                },
                set: function(t) {
                    if (this._volume = t, this._gainObj.gain.setTargetAtTime) try {
                        this._gainObj.gain.setTargetAtTime(t, this._context.currentTime, n);
                    } catch (e) {
                        this._gainObj.gain.setTargetAtTime(t, this._context.currentTime, .01);
                    } else this._gainObj.gain.value = t;
                    s.os === s.OS_IOS && !this.paused && this._currentSource && (this._currentSource.onended = null, 
                    this.pause(), this.play());
                },
                enumerable: !0,
                configurable: !0
            }), Object.defineProperty(t, "currentTime", {
                get: function() {
                    return this.paused ? this.playedLength : (this.playedLength = this._context.currentTime - this._startTime, 
                    this.playedLength %= this._buffer.duration, this.playedLength);
                },
                set: function(t) {
                    return this.paused ? this.playedLength = t : (this.pause(), this.playedLength = t, 
                    this.play()), t;
                },
                enumerable: !0,
                configurable: !0
            }), Object.defineProperty(t, "duration", {
                get: function() {
                    return this._buffer.duration;
                },
                enumerable: !0,
                configurable: !0
            });
        })(u.prototype), e.exports = cc._Audio = l;
    }, {
        "../core/assets/CCAudioClip": 59,
        "../core/event/event-target": 129,
        "../core/platform/CCSys": 191
    } ],
    21: [ function(t, e) {
        "use strict";
        var i = t("./CCAudio"), n = t("../core/assets/CCAudioClip"), r = cc.js, s = 0, o = r.createMap(!0), a = {}, c = [], l = function(t) {
            t._shouldRecycleOnEnded && (t._finishCallback = null, t.off("ended"), t.off("stop"), 
            t.src = null, c.includes(t) || (c.length < 32 ? c.push(t) : t.destroy()), t._shouldRecycleOnEnded = !1);
        }, u = function(t) {
            var e = s++, n = a[t];
            if (n || (n = a[t] = []), f._maxAudioInstance <= n.length) {
                var r = n.shift();
                h(r).stop();
            }
            var u = c.pop() || new i(), _ = function() {
                if (h(this.id)) {
                    delete o[this.id];
                    var t = n.indexOf(this.id);
                    cc.js.array.fastRemoveAt(n, t);
                }
                l(this);
            };
            return u.on("ended", function() {
                this._finishCallback && this._finishCallback(), this.getLoop() || _.call(this);
            }, u), u.on("stop", _, u), u.id = e, o[e] = u, n.push(e), u;
        }, h = function(t) {
            return o[t];
        }, _ = function(t) {
            return void 0 === t ? t = 1 : "string" == typeof t && (t = Number.parseFloat(t)), 
            t;
        }, f = {
            AudioState: i.State,
            _maxAudioInstance: 24,
            _id2audio: o,
            play: function(t, e, i) {
                if (!(t instanceof n)) return cc.error("Wrong type of AudioClip.");
                var r = t.nativeUrl, s = u(r);
                return s.src = t, t._ensureLoaded(), s._shouldRecycleOnEnded = !0, s.setLoop(e || !1), 
                i = _(i), s.setVolume(i), s.play(), s.id;
            },
            setLoop: function(t, e) {
                var i = h(t);
                i && i.setLoop && i.setLoop(e);
            },
            isLoop: function(t) {
                var e = h(t);
                return !(!e || !e.getLoop) && e.getLoop();
            },
            setVolume: function(t, e) {
                var i = h(t);
                i && i.setVolume(e);
            },
            getVolume: function(t) {
                var e = h(t);
                return e ? e.getVolume() : 1;
            },
            setCurrentTime: function(t, e) {
                var i = h(t);
                return !!i && (i.setCurrentTime(e), !0);
            },
            getCurrentTime: function(t) {
                var e = h(t);
                return e ? e.getCurrentTime() : 0;
            },
            getDuration: function(t) {
                var e = h(t);
                return e ? e.getDuration() : 0;
            },
            getState: function(t) {
                var e = h(t);
                return e ? e.getState() : this.AudioState.ERROR;
            },
            setFinishCallback: function(t, e) {
                var i = h(t);
                i && (i._finishCallback = e);
            },
            pause: function(t) {
                var e = h(t);
                return !!e && (e.pause(), !0);
            },
            _pauseIDCache: [],
            pauseAll: function() {
                for (var t in o) {
                    var e = o[t];
                    e.getState() === i.State.PLAYING && (this._pauseIDCache.push(t), e.pause());
                }
            },
            resume: function(t) {
                var e = h(t);
                e && e.resume();
            },
            resumeAll: function() {
                for (var t = 0; t < this._pauseIDCache.length; ++t) {
                    var e = this._pauseIDCache[t], i = h(e);
                    i && i.resume();
                }
                this._pauseIDCache.length = 0;
            },
            stop: function(t) {
                var e = h(t);
                return !!e && (e.stop(), !0);
            },
            stopAll: function() {
                for (var t in o) {
                    var e = o[t];
                    e && e.stop();
                }
            },
            setMaxAudioInstance: function() {},
            getMaxAudioInstance: function() {
                return this._maxAudioInstance;
            },
            uncache: function(t) {
                var e = t;
                if ("string" == typeof t) cc.warnID(8401, "cc.audioEngine", "cc.AudioClip", "AudioClip", "cc.AudioClip", "audio"), 
                e = t; else {
                    if (!t) return;
                    e = t.nativeUrl;
                }
                var i = a[e];
                if (i) for (;i.length > 0; ) {
                    var n = i.pop(), r = o[n];
                    r && (r.stop(), delete o[n]);
                }
            },
            uncacheAll: function() {
                var t;
                for (var e in this.stopAll(), o) (t = o[e]) && t.destroy();
                for (;t = c.pop(); ) t.destroy();
                o = r.createMap(!0), a = {};
            },
            _breakCache: null,
            _break: function() {
                for (var t in this._breakCache = [], o) {
                    var e = o[t];
                    e.getState() === i.State.PLAYING && (this._breakCache.push(t), e.pause());
                }
            },
            _restore: function() {
                if (this._breakCache) {
                    for (;this._breakCache.length > 0; ) {
                        var t = this._breakCache.pop(), e = h(t);
                        e && e.resume && e.resume();
                    }
                    this._breakCache = null;
                }
            },
            _music: {
                id: -1,
                loop: !1,
                volume: 1
            },
            _effect: {
                volume: 1,
                pauseCache: []
            },
            playMusic: function(t, e) {
                var i = this._music;
                return this.stop(i.id), i.id = this.play(t, e, i.volume), i.loop = e, i.id;
            },
            stopMusic: function() {
                this.stop(this._music.id);
            },
            pauseMusic: function() {
                return this.pause(this._music.id), this._music.id;
            },
            resumeMusic: function() {
                return this.resume(this._music.id), this._music.id;
            },
            getMusicVolume: function() {
                return this._music.volume;
            },
            setMusicVolume: function(t) {
                t = _(t);
                var e = this._music;
                return e.volume = t, this.setVolume(e.id, e.volume), e.volume;
            },
            isMusicPlaying: function() {
                return this.getState(this._music.id) === this.AudioState.PLAYING;
            },
            playEffect: function(t, e) {
                return this.play(t, e || !1, this._effect.volume);
            },
            setEffectsVolume: function(t) {
                t = _(t);
                var e = this._music.id;
                for (var i in this._effect.volume = t, o) {
                    var n = o[i];
                    n && n.id !== e && f.setVolume(i, t);
                }
            },
            getEffectsVolume: function() {
                return this._effect.volume;
            },
            pauseEffect: function(t) {
                return this.pause(t);
            },
            pauseAllEffects: function() {
                var t = this._music.id, e = this._effect;
                for (var i in e.pauseCache.length = 0, o) {
                    var n = o[i];
                    n && n.id !== t && n.getState() === this.AudioState.PLAYING && (e.pauseCache.push(i), 
                    n.pause());
                }
            },
            resumeEffect: function(t) {
                this.resume(t);
            },
            resumeAllEffects: function() {
                for (var t = this._effect.pauseCache, e = 0; e < t.length; ++e) {
                    var i = t[e], n = o[i];
                    n && n.resume();
                }
            },
            stopEffect: function(t) {
                return this.stop(t);
            },
            stopAllEffects: function() {
                var t = this._music.id;
                for (var e in o) {
                    var i = o[e];
                    i && i.id !== t && i.getState() === f.AudioState.PLAYING && i.stop();
                }
            }
        };
        e.exports = cc.audioEngine = f;
    }, {
        "../core/assets/CCAudioClip": 59,
        "./CCAudio": 20
    } ],
    22: [ function(t, e) {
        "use strict";
        var i, n = t("./platform/utils"), r = (t("../../DebugInfos"), "https://github.com/cocos-creator/engine/blob/master/EngineErrorMap.md");
        function s(t) {
            return function() {
                var e = arguments[0], i = t + " " + e + ", please go to " + r + "#" + e + " to see details.";
                if (1 === arguments.length) return i;
                if (2 === arguments.length) return i + " Arguments: " + arguments[1];
                var n = cc.js.shiftArguments.apply(null, arguments);
                return i + " Arguments: " + n.join(", ");
            };
        }
        cc.log = cc.warn = cc.error = cc.assert = console.log.bind ? console.log.bind(console) : console.log, 
        cc._throw = function(t) {
            n.callInNextTick(function() {
                throw t;
            });
        };
        var o = s("Log");
        cc.logID = function() {
            cc.log(o.apply(null, arguments));
        };
        var a = s("Warning");
        cc.warnID = function() {
            cc.warn(a.apply(null, arguments));
        };
        var c = s("Error");
        cc.errorID = function() {
            cc.error(c.apply(null, arguments));
        };
        var l = s("Assert");
        cc.assertID = function(t) {
            t || cc.assert(!1, l.apply(null, cc.js.shiftArguments.apply(null, arguments)));
        };
        var u = cc.Enum({
            NONE: 0,
            INFO: 1,
            WARN: 2,
            ERROR: 3,
            INFO_FOR_WEB_PAGE: 4,
            WARN_FOR_WEB_PAGE: 5,
            ERROR_FOR_WEB_PAGE: 6
        });
        e.exports = cc.debug = {
            DebugMode: u,
            _resetDebugSetting: function(t) {
                if (cc.log = cc.warn = cc.error = cc.assert = function() {}, t !== u.NONE) {
                    if (t > u.ERROR) {
                        var e = function(t) {
                            if (cc.game.canvas) {
                                if (!i) {
                                    var e = document.createElement("Div");
                                    e.setAttribute("id", "logInfoDiv"), e.setAttribute("width", "200"), e.setAttribute("height", cc.game.canvas.height);
                                    var n = e.style;
                                    n.zIndex = "99999", n.position = "absolute", n.top = n.left = "0", (i = document.createElement("textarea")).setAttribute("rows", "20"), 
                                    i.setAttribute("cols", "30"), i.setAttribute("disabled", "true");
                                    var r = i.style;
                                    r.backgroundColor = "transparent", r.borderBottom = "1px solid #cccccc", r.borderTopWidth = r.borderLeftWidth = r.borderRightWidth = "0px", 
                                    r.borderTopStyle = r.borderLeftStyle = r.borderRightStyle = "none", r.padding = "0px", 
                                    r.margin = 0, e.appendChild(i), cc.game.canvas.parentNode.appendChild(e);
                                }
                                i.value = i.value + t + "\r\n", i.scrollTop = i.scrollHeight;
                            }
                        };
                        cc.error = function() {
                            e("ERROR :  " + cc.js.formatStr.apply(null, arguments));
                        }, cc.assert = function(t, i) {
                            !t && i && (i = cc.js.formatStr.apply(null, cc.js.shiftArguments.apply(null, arguments)), 
                            e("ASSERT: " + i));
                        }, t !== u.ERROR_FOR_WEB_PAGE && (cc.warn = function() {
                            e("WARN :  " + cc.js.formatStr.apply(null, arguments));
                        }), t === u.INFO_FOR_WEB_PAGE && (cc.log = function() {
                            e(cc.js.formatStr.apply(null, arguments));
                        });
                    } else console && console.log.apply && (console.error || (console.error = console.log), 
                    console.warn || (console.warn = console.log), console.error.bind ? cc.error = console.error.bind(console) : cc.error = function() {
                        return console.error.apply(console, arguments);
                    }, cc.assert = function(t, e) {
                        if (!t) throw e && (e = cc.js.formatStr.apply(null, cc.js.shiftArguments.apply(null, arguments))), 
                        new Error(e);
                    });
                    t !== u.ERROR && (console.warn.bind ? cc.warn = console.warn.bind(console) : cc.warn = function() {
                        return console.warn.apply(console, arguments);
                    }), t === u.INFO && (console.log.bind ? cc.log = console.log.bind(console) : cc.log = function() {
                        return console.log.apply(console, arguments);
                    });
                }
            },
            getError: s("ERROR"),
            isDisplayStats: function() {
                return !!cc.profiler && cc.profiler.isShowingStats();
            },
            setDisplayStats: function(t) {
                cc.profiler && cc.game.renderType !== cc.game.RENDER_TYPE_CANVAS && (t ? cc.profiler.showStats() : cc.profiler.hideStats(), 
                cc.game.config.showFPS = !!t);
            }
        };
    }, {
        "../../DebugInfos": void 0,
        "./platform/utils": 206
    } ],
    23: [ function(t, e) {
        "use strict";
        var i = t("./event/event-target"), n = t("./component-scheduler"), r = t("./node-activator"), s = t("./platform/CCObject"), o = t("./CCGame"), a = t("./renderer"), c = t("./event-manager"), l = t("./CCScheduler");
        cc.Director = function() {
            i.call(this), this._paused = !1, this._purgeDirectorInNextLoop = !1, this._winSizeInPoints = null, 
            this._scene = null, this._loadingScene = "", this._totalFrames = 0, this._lastUpdate = 0, 
            this._deltaTime = 0, this._startTime = 0, this._maxParticleDeltaTime = 0, this._scheduler = null, 
            this._compScheduler = null, this._nodeActivator = null, this._actionManager = null;
            var t = this;
            o.on(o.EVENT_SHOW, function() {
                t._lastUpdate = performance.now();
            }), o.once(o.EVENT_ENGINE_INITED, this.init, this);
        }, cc.Director.prototype = {
            constructor: cc.Director,
            init: function() {
                return this._totalFrames = 0, this._lastUpdate = performance.now(), this._startTime = this._lastUpdate, 
                this._paused = !1, this._purgeDirectorInNextLoop = !1, this._winSizeInPoints = cc.size(0, 0), 
                this._scheduler = new l(), cc.ActionManager ? (this._actionManager = new cc.ActionManager(), 
                this._scheduler.scheduleUpdate(this._actionManager, l.PRIORITY_SYSTEM, !1)) : this._actionManager = null, 
                this.sharedInit(), !0;
            },
            sharedInit: function() {
                this._compScheduler = new n(), this._nodeActivator = new r(), c && c.setEnabled(!0), 
                cc.AnimationManager ? (this._animationManager = new cc.AnimationManager(), this._scheduler.scheduleUpdate(this._animationManager, l.PRIORITY_SYSTEM, !1)) : this._animationManager = null, 
                cc.CollisionManager ? (this._collisionManager = new cc.CollisionManager(), this._scheduler.scheduleUpdate(this._collisionManager, l.PRIORITY_SYSTEM, !1)) : this._collisionManager = null, 
                cc.PhysicsManager ? (this._physicsManager = new cc.PhysicsManager(), this._scheduler.scheduleUpdate(this._physicsManager, l.PRIORITY_SYSTEM, !1)) : this._physicsManager = null, 
                cc.Physics3DManager, this._physics3DManager = null, cc._widgetManager && cc._widgetManager.init(this);
            },
            calculateDeltaTime: function(t) {
                t || (t = performance.now()), this._deltaTime = t > this._lastUpdate ? (t - this._lastUpdate) / 1e3 : 0, 
                this._lastUpdate = t;
            },
            convertToGL: function(t) {
                var e = o.container, i = cc.view, n = e.getBoundingClientRect(), r = n.left + window.pageXOffset - e.clientLeft, s = n.top + window.pageYOffset - e.clientTop, a = i._devicePixelRatio * (t.x - r), c = i._devicePixelRatio * (s + n.height - t.y);
                return i._isRotated ? cc.v2(i._viewportRect.width - c, a) : cc.v2(a, c);
            },
            convertToUI: function(t) {
                var e = o.container, i = cc.view, n = e.getBoundingClientRect(), r = n.left + window.pageXOffset - e.clientLeft, s = n.top + window.pageYOffset - e.clientTop, a = cc.v2(0, 0);
                return i._isRotated ? (a.x = r + t.y / i._devicePixelRatio, a.y = s + n.height - (i._viewportRect.width - t.x) / i._devicePixelRatio) : (a.x = r + t.x * i._devicePixelRatio, 
                a.y = s + n.height - t.y * i._devicePixelRatio), a;
            },
            end: function() {
                this._purgeDirectorInNextLoop = !0;
            },
            getWinSize: function() {
                return cc.size(cc.winSize);
            },
            getWinSizeInPixels: function() {
                return cc.size(cc.winSize);
            },
            pause: function() {
                this._paused || (this._paused = !0);
            },
            purgeCachedData: function() {
                cc.assetManager.releaseAll();
            },
            purgeDirector: function() {
                this._scheduler.unscheduleAll(), this._compScheduler.unscheduleAll(), this._nodeActivator.reset(), 
                c && c.setEnabled(!1), cc.isValid(this._scene) && this._scene.destroy(), this._scene = null, 
                cc.renderer.clear(), cc.assetManager.builtins.clear(), cc.game.pause(), cc.assetManager.releaseAll();
            },
            reset: function() {
                this.purgeDirector(), c && c.setEnabled(!0), this._actionManager && this._scheduler.scheduleUpdate(this._actionManager, cc.Scheduler.PRIORITY_SYSTEM, !1), 
                this._animationManager && this._scheduler.scheduleUpdate(this._animationManager, cc.Scheduler.PRIORITY_SYSTEM, !1), 
                this._collisionManager && this._scheduler.scheduleUpdate(this._collisionManager, cc.Scheduler.PRIORITY_SYSTEM, !1), 
                this._physicsManager && this._scheduler.scheduleUpdate(this._physicsManager, cc.Scheduler.PRIORITY_SYSTEM, !1), 
                cc.game.resume();
            },
            runSceneImmediate: function(t, e, i) {
                cc.assertID(t instanceof cc.Scene || t instanceof cc.SceneAsset, 1216), t instanceof cc.SceneAsset && (t = t.scene), 
                t._load();
                for (var n = Object.keys(o._persistRootNodes).map(function(t) {
                    return o._persistRootNodes[t];
                }), r = 0; r < n.length; r++) {
                    var a = n[r], c = t.getChildByUuid(a.uuid);
                    if (c) {
                        var l = c.getSiblingIndex();
                        c._destroyImmediate(), t.insertChild(a, l);
                    } else a.parent = t;
                }
                var u = this._scene;
                cc.assetManager._releaseManager._autoRelease(u, t, n), cc.isValid(u) && u.destroy(), 
                this._scene = null, s._deferredDestroy(), e && e(), this.emit(cc.Director.EVENT_BEFORE_SCENE_LAUNCH, t), 
                this._scene = t, t._activate(), cc.game.resume(), i && i(null, t), this.emit(cc.Director.EVENT_AFTER_SCENE_LAUNCH, t);
            },
            runScene: function(t, e, i) {
                cc.assertID(t, 1205), cc.assertID(t instanceof cc.Scene || t instanceof cc.SceneAsset, 1216), 
                t instanceof cc.SceneAsset && (t = t.scene), t._load(), this.once(cc.Director.EVENT_AFTER_DRAW, function() {
                    this.runSceneImmediate(t, e, i);
                }, this);
            },
            loadScene: function(t, e, i) {
                if (this._loadingScene) return cc.warnID(1208, t, this._loadingScene), !1;
                var n = cc.assetManager.bundles.find(function(e) {
                    return e.getSceneInfo(t);
                });
                if (n) {
                    this.emit(cc.Director.EVENT_BEFORE_SCENE_LOADING, t), this._loadingScene = t;
                    var r = this;
                    return console.time("LoadScene " + t), n.loadScene(t, function(n, s) {
                        console.timeEnd("LoadScene " + t), r._loadingScene = "", n ? (n = "Failed to load scene: " + n, 
                        cc.error(n), e && e(n)) : r.runSceneImmediate(s, i, e);
                    }), !0;
                }
                return cc.errorID(1209, t), !1;
            },
            preloadScene: function(t, e, i) {
                var n = cc.assetManager.bundles.find(function(e) {
                    return e.getSceneInfo(t);
                });
                if (!n) return cc.errorID(1209, t), null;
                n.preloadScene(t, null, e, i);
            },
            resume: function() {
                this._paused && (this._lastUpdate = performance.now(), this._lastUpdate || cc.logID(1200), 
                this._paused = !1, this._deltaTime = 0);
            },
            setDepthTest: function(t) {
                cc.Camera.main && (cc.Camera.main.depth = !!t);
            },
            setClearColor: function(t) {
                cc.Camera.main && (cc.Camera.main.backgroundColor = t);
            },
            getRunningScene: function() {
                return this._scene;
            },
            getScene: function() {
                return this._scene;
            },
            getAnimationInterval: function() {
                return 1e3 / o.getFrameRate();
            },
            setAnimationInterval: function(t) {
                o.setFrameRate(Math.round(1e3 / t));
            },
            getDeltaTime: function() {
                return this._deltaTime;
            },
            getTotalTime: function() {
                return performance.now() - this._startTime;
            },
            getTotalFrames: function() {
                return this._totalFrames;
            },
            isPaused: function() {
                return this._paused;
            },
            getScheduler: function() {
                return this._scheduler;
            },
            setScheduler: function(t) {
                this._scheduler !== t && (this._scheduler = t);
            },
            getActionManager: function() {
                return this._actionManager;
            },
            setActionManager: function(t) {
                this._actionManager !== t && (this._actionManager && this._scheduler.unscheduleUpdate(this._actionManager), 
                this._actionManager = t, this._scheduler.scheduleUpdate(this._actionManager, cc.Scheduler.PRIORITY_SYSTEM, !1));
            },
            getAnimationManager: function() {
                return this._animationManager;
            },
            getCollisionManager: function() {
                return this._collisionManager;
            },
            getPhysicsManager: function() {
                return this._physicsManager;
            },
            getPhysics3DManager: function() {
                return this._physics3DManager;
            },
            startAnimation: function() {
                cc.game.resume();
            },
            stopAnimation: function() {
                cc.game.pause();
            },
            _resetDeltaTime: function() {
                this._lastUpdate = performance.now(), this._deltaTime = 0;
            },
            mainLoop: function(t) {
                this._purgeDirectorInNextLoop ? (this._purgeDirectorInNextLoop = !1, this.purgeDirector()) : (this.calculateDeltaTime(t), 
                this._paused || (this.emit(cc.Director.EVENT_BEFORE_UPDATE), this._compScheduler.startPhase(), 
                this._compScheduler.updatePhase(this._deltaTime), this._scheduler.update(this._deltaTime), 
                this._compScheduler.lateUpdatePhase(this._deltaTime), this.emit(cc.Director.EVENT_AFTER_UPDATE), 
                s._deferredDestroy()), this.emit(cc.Director.EVENT_BEFORE_DRAW), a.render(this._scene, this._deltaTime), 
                this.emit(cc.Director.EVENT_AFTER_DRAW), c.frameUpdateListeners(), this._totalFrames++);
            },
            __fastOn: function(t, e, i) {
                this.on(t, e, i);
            },
            __fastOff: function(t, e, i) {
                this.off(t, e, i);
            }
        }, cc.js.addon(cc.Director.prototype, i.prototype), cc.Director.EVENT_PROJECTION_CHANGED = "director_projection_changed", 
        cc.Director.EVENT_BEFORE_SCENE_LOADING = "director_before_scene_loading", cc.Director.EVENT_BEFORE_SCENE_LAUNCH = "director_before_scene_launch", 
        cc.Director.EVENT_AFTER_SCENE_LAUNCH = "director_after_scene_launch", cc.Director.EVENT_BEFORE_UPDATE = "director_before_update", 
        cc.Director.EVENT_AFTER_UPDATE = "director_after_update", cc.Director.EVENT_BEFORE_VISIT = "director_before_draw", 
        cc.Director.EVENT_AFTER_VISIT = "director_before_draw", cc.Director.EVENT_BEFORE_DRAW = "director_before_draw", 
        cc.Director.EVENT_AFTER_DRAW = "director_after_draw", cc.Director.PROJECTION_2D = 0, 
        cc.Director.PROJECTION_3D = 1, cc.Director.PROJECTION_CUSTOM = 3, cc.Director.PROJECTION_DEFAULT = cc.Director.PROJECTION_2D, 
        cc.Director.EVENT_BEFORE_PHYSICS = "director_before_physics", cc.Director.EVENT_AFTER_PHYSICS = "director_after_physics", 
        cc.director = new cc.Director(), e.exports = cc.director;
    }, {
        "./CCGame": 24,
        "./CCScheduler": 28,
        "./component-scheduler": 95,
        "./event-manager": 127,
        "./event/event-target": 129,
        "./node-activator": 155,
        "./platform/CCObject": 188,
        "./renderer": 213
    } ],
    24: [ function(t, e) {
        "use strict";
        var i = t("./event/event-target");
        t("../audio/CCAudioEngine");
        var n = t("./CCDebug"), r = t("./renderer/index.js"), s = t("../core/renderer/utils/dynamic-atlas/manager"), o = {
            EVENT_HIDE: "game_on_hide",
            EVENT_SHOW: "game_on_show",
            EVENT_RESTART: "game_on_restart",
            EVENT_GAME_INITED: "game_inited",
            EVENT_ENGINE_INITED: "engine_inited",
            EVENT_RENDERER_INITED: "engine_inited",
            RENDER_TYPE_CANVAS: 0,
            RENDER_TYPE_WEBGL: 1,
            RENDER_TYPE_OPENGL: 2,
            _persistRootNodes: {},
            _paused: !0,
            _configLoaded: !1,
            _isCloning: !1,
            _prepared: !1,
            _rendererInitialized: !1,
            _renderContext: null,
            _intervalId: null,
            _lastTime: null,
            _frameTime: null,
            frame: null,
            container: null,
            canvas: null,
            renderType: -1,
            config: null,
            onStart: null,
            setFrameRate: function(t) {
                this.config.frameRate = t, this._intervalId && window.cancelAnimFrame(this._intervalId), 
                this._intervalId = 0, this._paused = !0, this._setAnimFrame(), this._runMainLoop();
            },
            getFrameRate: function() {
                return this.config.frameRate;
            },
            step: function() {
                cc.director.mainLoop();
            },
            pause: function() {
                this._paused || (this._paused = !0, cc.audioEngine && cc.audioEngine._break(), this._intervalId && window.cancelAnimFrame(this._intervalId), 
                this._intervalId = 0);
            },
            resume: function() {
                this._paused && (this._paused = !1, cc.audioEngine && cc.audioEngine._restore(), 
                cc.director._resetDeltaTime(), this._runMainLoop());
            },
            isPaused: function() {
                return this._paused;
            },
            restart: function() {
                cc.director.once(cc.Director.EVENT_AFTER_DRAW, function() {
                    for (var t in o._persistRootNodes) o.removePersistRootNode(o._persistRootNodes[t]);
                    cc.director.getScene().destroy(), cc.Object._deferredDestroy(), cc.audioEngine && cc.audioEngine.uncacheAll(), 
                    cc.director.reset(), o.pause(), cc.assetManager.builtins.init(function() {
                        o.onStart(), o.emit(o.EVENT_RESTART);
                    });
                });
            },
            end: function() {
                close();
            },
            _initEngine: function() {
                this._rendererInitialized || (this._initRenderer(), this._initEvents(), this.emit(this.EVENT_ENGINE_INITED));
            },
            _loadPreviewScript: function(t) {
                t();
            },
            _prepareFinished: function(t) {
                var e = this;
                this._initEngine(), this._setAnimFrame(), cc.assetManager.builtins.init(function() {
                    console.log("Cocos Creator v" + cc.ENGINE_VERSION), e._prepared = !0, e._runMainLoop(), 
                    e.emit(e.EVENT_GAME_INITED), t && t();
                });
            },
            eventTargetOn: i.prototype.on,
            eventTargetOnce: i.prototype.once,
            on: function(t, e, i, n) {
                this._prepared && t === this.EVENT_ENGINE_INITED || !this._paused && t === this.EVENT_GAME_INITED ? e.call(i) : this.eventTargetOn(t, e, i, n);
            },
            once: function(t, e, i) {
                this._prepared && t === this.EVENT_ENGINE_INITED || !this._paused && t === this.EVENT_GAME_INITED ? e.call(i) : this.eventTargetOnce(t, e, i);
            },
            prepare: function(t) {
                var e = this;
                this._prepared ? t && t() : this._loadPreviewScript(function() {
                    e._prepareFinished(t);
                });
            },
            run: function(t, e) {
                this._initConfig(t), this.onStart = e, this.prepare(o.onStart && o.onStart.bind(o));
            },
            addPersistRootNode: function(t) {
                if (cc.Node.isNode(t) && t.uuid) {
                    var e = t.uuid;
                    if (!this._persistRootNodes[e]) {
                        var i = cc.director._scene;
                        if (cc.isValid(i)) if (t.parent) {
                            if (!(t.parent instanceof cc.Scene)) return void cc.warnID(3801);
                            if (t.parent !== i) return void cc.warnID(3802);
                        } else t.parent = i;
                        this._persistRootNodes[e] = t, t._persistNode = !0, cc.assetManager._releaseManager._addPersistNodeRef(t);
                    }
                } else cc.warnID(3800);
            },
            removePersistRootNode: function(t) {
                var e = t.uuid || "";
                t === this._persistRootNodes[e] && (delete this._persistRootNodes[e], t._persistNode = !1, 
                cc.assetManager._releaseManager._removePersistNodeRef(t));
            },
            isPersistRootNode: function(t) {
                return t._persistNode;
            },
            _setAnimFrame: function() {
                this._lastTime = performance.now();
                var t = o.config.frameRate;
                this._frameTime = 1e3 / t, cc.director._maxParticleDeltaTime = this._frameTime / 1e3 * 2, 
                60 !== t && 30 !== t ? (window.requestAnimFrame = this._stTime, window.cancelAnimFrame = this._ctTime) : (window.requestAnimFrame = window.requestAnimationFrame || window.webkitRequestAnimationFrame || window.mozRequestAnimationFrame || window.oRequestAnimationFrame || window.msRequestAnimationFrame || this._stTime, 
                window.cancelAnimFrame = window.cancelAnimationFrame || window.cancelRequestAnimationFrame || window.msCancelRequestAnimationFrame || window.mozCancelRequestAnimationFrame || window.oCancelRequestAnimationFrame || window.webkitCancelRequestAnimationFrame || window.msCancelAnimationFrame || window.mozCancelAnimationFrame || window.webkitCancelAnimationFrame || window.oCancelAnimationFrame || this._ctTime);
            },
            _stTime: function(t) {
                var e = performance.now(), i = Math.max(0, o._frameTime - (e - o._lastTime)), n = window.setTimeout(function() {
                    t();
                }, i);
                return o._lastTime = e + i, n;
            },
            _ctTime: function(t) {
                window.clearTimeout(t);
            },
            _runMainLoop: function() {
                if (this._prepared) {
                    var t, e = this, i = e.config, r = cc.director, s = !0, o = i.frameRate;
                    n.setDisplayStats(i.showFPS), t = function(i) {
                        if (!e._paused) {
                            if (e._intervalId = window.requestAnimFrame(t), 30 === o && (s = !s)) return;
                            r.mainLoop(i);
                        }
                    }, e._intervalId = window.requestAnimFrame(t), e._paused = !1;
                }
            },
            _initConfig: function(t) {
                "number" != typeof t.debugMode && (t.debugMode = 0), t.exposeClassName = !!t.exposeClassName, 
                "number" != typeof t.frameRate && (t.frameRate = 60);
                var e = t.renderMode;
                ("number" != typeof e || e > 2 || e < 0) && (t.renderMode = 0), "boolean" != typeof t.registerSystemEvent && (t.registerSystemEvent = !0), 
                t.showFPS = 1 !== e && !!t.showFPS, this.collisionMatrix = t.collisionMatrix || [], 
                this.groupList = t.groupList || [], n._resetDebugSetting(t.debugMode), this.config = t, 
                this._configLoaded = !0;
            },
            _determineRenderType: function() {
                var t = this.config, e = parseInt(t.renderMode) || 0;
                this.renderType = this.RENDER_TYPE_CANVAS;
                var i = !1;
                if (0 === e ? cc.sys.capabilities.opengl ? (this.renderType = this.RENDER_TYPE_WEBGL, 
                i = !0) : cc.sys.capabilities.canvas && (this.renderType = this.RENDER_TYPE_CANVAS, 
                i = !0) : 1 === e && cc.sys.capabilities.canvas ? (this.renderType = this.RENDER_TYPE_CANVAS, 
                i = !0) : 2 === e && cc.sys.capabilities.opengl && (this.renderType = this.RENDER_TYPE_WEBGL, 
                i = !0), !i) throw new Error(n.getError(3820, e));
            },
            _initRenderer: function() {
                if (!this._rendererInitialized) {
                    var t, e, i, n, o = this.config.id, a = o instanceof HTMLElement ? o : document.querySelector(o) || document.querySelector("#" + o);
                    if ("CANVAS" === a.tagName ? (t = a.width, e = a.height, this.canvas = i = a, this.container = n = document.createElement("DIV"), 
                    i.parentNode && i.parentNode.insertBefore(n, i)) : ("DIV" !== a.tagName && cc.warnID(3819), 
                    t = a.clientWidth, e = a.clientHeight, this.canvas = i = document.createElement("CANVAS"), 
                    this.container = n = document.createElement("DIV"), a.appendChild(n)), n.setAttribute("id", "Cocos2dGameContainer"), 
                    n.appendChild(i), this.frame = n.parentNode === document.body ? document.documentElement : n.parentNode, 
                    function(t) {
                        (" " + t.className + " ").indexOf(" gameCanvas ") > -1 || (t.className && (t.className += " "), 
                        t.className += "gameCanvas");
                    }(i), i.setAttribute("width", t || 480), i.setAttribute("height", e || 320), i.setAttribute("tabindex", 99), 
                    this._determineRenderType(), this.renderType === this.RENDER_TYPE_WEBGL) {
                        var c = {
                            stencil: !0,
                            antialias: cc.macro.ENABLE_WEBGL_ANTIALIAS,
                            alpha: cc.macro.ENABLE_TRANSPARENT_CANVAS
                        };
                        r.initWebGL(i, c), this._renderContext = r.device._gl, !cc.macro.CLEANUP_IMAGE_CACHE && s && (s.enabled = !0);
                    }
                    this._renderContext || (this.renderType = this.RENDER_TYPE_CANVAS, r.initCanvas(i), 
                    this._renderContext = r.device._ctx), this.canvas.oncontextmenu = function() {
                        if (!cc._isContextMenuEnable) return !1;
                    }, this._rendererInitialized = !0;
                }
            },
            _initEvents: function() {
                var t, e = window;
                this.config.registerSystemEvent && cc.internal.inputManager.registerSystemEvent(this.canvas), 
                void 0 !== document.hidden ? t = "hidden" : void 0 !== document.mozHidden ? t = "mozHidden" : void 0 !== document.msHidden ? t = "msHidden" : void 0 !== document.webkitHidden && (t = "webkitHidden");
                var i = !1;
                function n() {
                    i || (i = !0, o.emit(o.EVENT_HIDE));
                }
                function r(t, e, n, r, s) {
                    i && (i = !1, o.emit(o.EVENT_SHOW, t, e, n, r, s));
                }
                if (t) for (var s = [ "visibilitychange", "mozvisibilitychange", "msvisibilitychange", "webkitvisibilitychange", "qbrowserVisibilityChange" ], a = 0; a < s.length; a++) document.addEventListener(s[a], function(e) {
                    var i = document[t];
                    (i = i || e.hidden) ? n() : r();
                }); else e.addEventListener("blur", n), e.addEventListener("focus", r);
                navigator.userAgent.indexOf("MicroMessenger") > -1 && (e.onfocus = r), "onpageshow" in window && "onpagehide" in window && (e.addEventListener("pagehide", n), 
                e.addEventListener("pageshow", r), document.addEventListener("pagehide", n), document.addEventListener("pageshow", r)), 
                this.on(o.EVENT_HIDE, function() {
                    o.pause();
                }), this.on(o.EVENT_SHOW, function() {
                    o.resume();
                });
            }
        };
        i.call(o), cc.js.addon(o, i.prototype), cc.game = e.exports = o;
    }, {
        "../audio/CCAudioEngine": 21,
        "../core/renderer/utils/dynamic-atlas/manager": 216,
        "./CCDebug": 22,
        "./event/event-target": 129,
        "./renderer/index.js": 213
    } ],
    25: [ function(t, e) {
        "use strict";
        var i = t("./value-types"), n = t("./utils/base-node"), r = t("./utils/prefab-helper"), s = t("./utils/trans-pool").NodeMemPool, o = t("./utils/affine-transform"), a = t("./event-manager"), c = t("./platform/CCMacro"), l = t("./platform/js"), u = (t("./event/event"), 
        t("./event/event-target")), h = t("./renderer/render-flow"), _ = cc.Object.Flags.Destroying, f = Math.PI / 180, d = !!cc.ActionManager, p = function() {}, m = new i.Vec3(), v = new i.Quat(), y = new i.Vec3(), g = new i.Vec3(), x = new i.Quat(), A = new i.Quat(), C = new i.Vec3(), b = new i.Vec3(), S = new i.Vec3(), T = new i.Vec3(), w = new i.Vec3(), E = new i.Quat(), B = new i.Quat(), M = new i.Vec3(), R = new i.Quat(), P = new i.Vec3(), I = new i.Quat(), D = new i.Vec3(), V = new i.Vec3(), L = new i.Quat(), O = new i.Quat(), F = (new i.Quat(), 
        cc.mat4()), N = new i.Vec3(), G = new Array(16);
        G.length = 0;
        var k = cc.Enum({
            DEBUG: 31
        }), z = cc.Enum({
            POSITION: 1,
            SCALE: 2,
            ROTATION: 4,
            SKEW: 8,
            TRS: 7,
            RS: 6,
            TRSS: 15,
            PHYSICS_POSITION: 16,
            PHYSICS_SCALE: 32,
            PHYSICS_ROTATION: 64,
            PHYSICS_TRS: 112,
            PHYSICS_RS: 96,
            ALL_POSITION: 17,
            ALL_SCALE: 34,
            ALL_ROTATION: 68,
            ALL_TRS: 119,
            ALL: 65535
        }), U = cc.Enum({
            TOUCH_START: "touchstart",
            TOUCH_MOVE: "touchmove",
            TOUCH_END: "touchend",
            TOUCH_CANCEL: "touchcancel",
            MOUSE_DOWN: "mousedown",
            MOUSE_MOVE: "mousemove",
            MOUSE_ENTER: "mouseenter",
            MOUSE_LEAVE: "mouseleave",
            MOUSE_UP: "mouseup",
            MOUSE_WHEEL: "mousewheel",
            POSITION_CHANGED: "position-changed",
            ROTATION_CHANGED: "rotation-changed",
            SCALE_CHANGED: "scale-changed",
            SIZE_CHANGED: "size-changed",
            ANCHOR_CHANGED: "anchor-changed",
            COLOR_CHANGED: "color-changed",
            CHILD_ADDED: "child-added",
            CHILD_REMOVED: "child-removed",
            CHILD_REORDER: "child-reorder",
            GROUP_CHANGED: "group-changed",
            SIBLING_ORDER_CHANGED: "sibling-order-changed"
        }), H = [ U.TOUCH_START, U.TOUCH_MOVE, U.TOUCH_END, U.TOUCH_CANCEL ], W = [ U.MOUSE_DOWN, U.MOUSE_ENTER, U.MOUSE_MOVE, U.MOUSE_LEAVE, U.MOUSE_UP, U.MOUSE_WHEEL ], j = !0, q = function(t) {
            if (0 !== t) {
                j && cc.warn("`cc.Node.skewX/Y` is deprecated since v2.2.1, please use 3D node instead.", ""), 
                j = !1;
            }
        }, X = null, Y = function(t, e) {
            var i = t.getLocation(), n = this.owner;
            return !!n._hitTest(i, this) && (e.type = U.TOUCH_START, e.touch = t, e.bubbles = !0, 
            n.dispatchEvent(e), !0);
        }, J = function(t, e) {
            var i = this.owner;
            e.type = U.TOUCH_MOVE, e.touch = t, e.bubbles = !0, i.dispatchEvent(e);
        }, Z = function(t, e) {
            var i = t.getLocation(), n = this.owner;
            n._hitTest(i, this) ? e.type = U.TOUCH_END : e.type = U.TOUCH_CANCEL, e.touch = t, 
            e.bubbles = !0, n.dispatchEvent(e);
        }, K = function(t, e) {
            t.getLocation();
            var i = this.owner;
            e.type = U.TOUCH_CANCEL, e.touch = t, e.bubbles = !0, i.dispatchEvent(e);
        }, Q = function(t) {
            var e = t.getLocation(), i = this.owner;
            i._hitTest(e, this) && (t.type = U.MOUSE_DOWN, t.bubbles = !0, i.dispatchEvent(t));
        }, $ = function(t) {
            var e = t.getLocation(), i = this.owner;
            if (i._hitTest(e, this)) this._previousIn || (X && X._mouseListener && (t.type = U.MOUSE_LEAVE, 
            X.dispatchEvent(t), X._mouseListener._previousIn = !1), X = this.owner, t.type = U.MOUSE_ENTER, 
            i.dispatchEvent(t), this._previousIn = !0), t.type = U.MOUSE_MOVE, t.bubbles = !0, 
            i.dispatchEvent(t); else {
                if (!this._previousIn) return;
                t.type = U.MOUSE_LEAVE, i.dispatchEvent(t), this._previousIn = !1, X = null;
            }
            t.stopPropagation();
        }, tt = function(t) {
            var e = t.getLocation(), i = this.owner;
            i._hitTest(e, this) && (t.type = U.MOUSE_UP, t.bubbles = !0, i.dispatchEvent(t), 
            t.stopPropagation());
        }, et = function(t) {
            var e = t.getLocation(), i = this.owner;
            i._hitTest(e, this) && (t.type = U.MOUSE_WHEEL, t.bubbles = !0, i.dispatchEvent(t), 
            t.stopPropagation());
        };
        function it(t, e) {
            if (e) {
                for (var i = 0, n = null, r = t; r && cc.Node.isNode(r); r = r._parent, ++i) if (r.getComponent(e)) {
                    var s = {
                        index: i,
                        node: r
                    };
                    n ? n.push(s) : n = [ s ];
                }
                return n;
            }
            return null;
        }
        function nt(t, e) {
            if (!(t._objFlags & _)) {
                if (t._bubblingListeners) for (var i = 0, n = e.length; i < n; ++i) if (t._bubblingListeners.hasEventListener(e[i])) return !0;
                if (t._capturingListeners) for (var r = 0, s = e.length; r < s; ++r) if (t._capturingListeners.hasEventListener(e[r])) return !0;
                return !1;
            }
            return !0;
        }
        function rt(t, e) {
            var i, n;
            for (e.target = t, G.length = 0, t._getCapturingTargets(e.type, G), e.eventPhase = 1, 
            n = G.length - 1; n >= 0; --n) if ((i = G[n])._capturingListeners && (e.currentTarget = i, 
            i._capturingListeners.emit(e.type, e, G), e._propagationStopped)) return void (G.length = 0);
            if (G.length = 0, e.eventPhase = 2, e.currentTarget = t, t._capturingListeners && t._capturingListeners.emit(e.type, e), 
            !e._propagationImmediateStopped && t._bubblingListeners && t._bubblingListeners.emit(e.type, e), 
            !e._propagationStopped && e.bubbles) for (t._getBubblingTargets(e.type, G), e.eventPhase = 3, 
            n = 0; n < G.length; ++n) if ((i = G[n])._bubblingListeners && (e.currentTarget = i, 
            i._bubblingListeners.emit(e.type, e), e._propagationStopped)) return void (G.length = 0);
            G.length = 0;
        }
        function st(t) {
            var e = t.groupIndex;
            return 0 === e && t.parent && (e = st(t.parent)), e;
        }
        function ot(t) {
            var e = st(t);
            t._cullingMask = 1 << e;
            for (var i = 0; i < t._children.length; i++) ot(t._children[i]);
        }
        function at() {
            if (this._localMatDirty & z.TRSS) {
                var t = this._matrix, e = t.m;
                if (i.Trs.toMat4(t, this._trs), this._skewX || this._skewY) {
                    var n = e[0], r = e[1], s = e[4], o = e[5], a = Math.tan(this._skewX * f), c = Math.tan(this._skewY * f);
                    a === 1 / 0 && (a = 99999999), c === 1 / 0 && (c = 99999999), e[0] = n + s * c, 
                    e[1] = r + o * c, e[4] = s + n * a, e[5] = o + r * a;
                }
                this._localMatDirty &= ~z.TRSS, this._worldMatDirty = !0;
            }
        }
        function ct() {
            var t = this._localMatDirty;
            if (t & z.TRSS) {
                var e = this._matrix.m, i = this._trs;
                if (t & (z.RS | z.SKEW)) {
                    var n = -this._eulerAngles.z, r = this._skewX || this._skewY, s = i[7], o = i[8];
                    if (n || r) {
                        var a = 1, c = 0, l = 0, u = 1;
                        if (n) {
                            var h = n * f;
                            l = Math.sin(h), a = u = Math.cos(h), c = -l;
                        }
                        if (e[0] = a *= s, e[1] = c *= s, e[4] = l *= o, e[5] = u *= o, r) {
                            var _ = e[0], d = e[1], p = e[4], m = e[5], v = Math.tan(this._skewX * f), y = Math.tan(this._skewY * f);
                            v === 1 / 0 && (v = 99999999), y === 1 / 0 && (y = 99999999), e[0] = _ + p * y, 
                            e[1] = d + m * y, e[4] = p + _ * v, e[5] = m + d * v;
                        }
                    } else e[0] = s, e[1] = 0, e[4] = 0, e[5] = o;
                }
                e[12] = i[0], e[13] = i[1], this._localMatDirty &= ~z.TRSS, this._worldMatDirty = !0;
            }
        }
        function lt() {
            if (this._localMatDirty & z.TRSS && this._updateLocalMatrix(), this._parent) {
                var t = this._parent._worldMatrix;
                i.Mat4.mul(this._worldMatrix, t, this._matrix);
            } else i.Mat4.copy(this._worldMatrix, this._matrix);
            this._worldMatDirty = !1;
        }
        function ut() {
            this._localMatDirty & z.TRSS && this._updateLocalMatrix();
            var t = this._parent;
            t ? this._mulMat(this._worldMatrix, t._worldMatrix, this._matrix) : i.Mat4.copy(this._worldMatrix, this._matrix), 
            this._worldMatDirty = !1;
        }
        function ht(t, e, i) {
            var n = e.m, r = i.m, s = t.m, o = n[0], a = n[1], c = n[4], l = n[5], u = n[12], h = n[13], _ = r[0], f = r[1], d = r[4], p = r[5], m = r[12], v = r[13];
            0 !== a || 0 !== c ? (s[0] = _ * o + f * c, s[1] = _ * a + f * l, s[4] = d * o + p * c, 
            s[5] = d * a + p * l, s[12] = o * m + c * v + u, s[13] = a * m + l * v + h) : (s[0] = _ * o, 
            s[1] = f * l, s[4] = d * o, s[5] = p * l, s[12] = o * m + u, s[13] = l * v + h);
        }
        var _t = i.Mat4.mul, ft = {
            name: "cc.Node",
            extends: n,
            properties: {
                _opacity: 255,
                _color: cc.Color.WHITE,
                _contentSize: cc.Size,
                _anchorPoint: cc.v2(.5, .5),
                _position: void 0,
                _scale: void 0,
                _trs: null,
                _eulerAngles: cc.Vec3,
                _skewX: 0,
                _skewY: 0,
                _zIndex: {
                    default: void 0,
                    type: cc.Integer
                },
                _localZOrder: {
                    default: 0,
                    serializable: !1
                },
                _is3DNode: !1,
                _groupIndex: {
                    default: 0,
                    formerlySerializedAs: "groupIndex"
                },
                groupIndex: {
                    get: function() {
                        return this._groupIndex;
                    },
                    set: function(t) {
                        this._groupIndex = t, ot(this), this.emit(U.GROUP_CHANGED, this);
                    }
                },
                group: {
                    get: function() {
                        return cc.game.groupList[this.groupIndex] || "";
                    },
                    set: function(t) {
                        this.groupIndex = cc.game.groupList.indexOf(t);
                    }
                },
                x: {
                    get: function() {
                        return this._trs[0];
                    },
                    set: function(t) {
                        var e = this._trs;
                        t !== e[0] && (e[0] = t, this.setLocalDirty(z.ALL_POSITION), 1 & this._eventMask && this.emit(U.POSITION_CHANGED));
                    }
                },
                y: {
                    get: function() {
                        return this._trs[1];
                    },
                    set: function(t) {
                        var e = this._trs;
                        t !== e[1] && (e[1] = t, this.setLocalDirty(z.ALL_POSITION), 1 & this._eventMask && this.emit(U.POSITION_CHANGED));
                    }
                },
                z: {
                    get: function() {
                        return this._trs[2];
                    },
                    set: function(t) {
                        var e = this._trs;
                        t !== e[2] && (e[2] = t, this.setLocalDirty(z.ALL_POSITION), this._renderFlag |= h.FLAG_WORLD_TRANSFORM, 
                        1 & this._eventMask && this.emit(U.POSITION_CHANGED));
                    }
                },
                rotation: {
                    get: function() {
                        return -this.angle;
                    },
                    set: function(t) {
                        this.angle = -t;
                    }
                },
                angle: {
                    get: function() {
                        return this._eulerAngles.z;
                    },
                    set: function(t) {
                        i.Vec3.set(this._eulerAngles, 0, 0, t), i.Trs.fromAngleZ(this._trs, t), this.setLocalDirty(z.ALL_ROTATION), 
                        4 & this._eventMask && this.emit(U.ROTATION_CHANGED);
                    }
                },
                rotationX: {
                    get: function() {
                        return this._eulerAngles.x;
                    },
                    set: function(t) {
                        this._eulerAngles.x !== t && (this._eulerAngles.x = t, this._eulerAngles.x === this._eulerAngles.y ? i.Trs.fromAngleZ(this._trs, -t) : i.Trs.fromEulerNumber(this._trs, t, this._eulerAngles.y, 0), 
                        this.setLocalDirty(z.ALL_ROTATION), 4 & this._eventMask && this.emit(U.ROTATION_CHANGED));
                    }
                },
                rotationY: {
                    get: function() {
                        return this._eulerAngles.y;
                    },
                    set: function(t) {
                        this._eulerAngles.y !== t && (this._eulerAngles.y = t, this._eulerAngles.x === this._eulerAngles.y ? i.Trs.fromAngleZ(this._trs, -t) : i.Trs.fromEulerNumber(this._trs, this._eulerAngles.x, t, 0), 
                        this.setLocalDirty(z.ALL_ROTATION), 4 & this._eventMask && this.emit(U.ROTATION_CHANGED));
                    }
                },
                eulerAngles: {
                    get: function() {
                        return i.Trs.toEuler(this._eulerAngles, this._trs);
                    },
                    set: function(t) {
                        i.Trs.fromEuler(this._trs, t), this.setLocalDirty(z.ALL_ROTATION), this._renderFlag |= h.FLAG_TRANSFORM, 
                        4 & this._eventMask && this.emit(U.ROTATION_CHANGED);
                    }
                },
                quat: {
                    get: function() {
                        var t = this._trs;
                        return new i.Quat(t[3], t[4], t[5], t[6]);
                    },
                    set: function(t) {
                        this.setRotation(t);
                    }
                },
                scale: {
                    get: function() {
                        return this._trs[7];
                    },
                    set: function(t) {
                        this.setScale(t);
                    }
                },
                scaleX: {
                    get: function() {
                        return this._trs[7];
                    },
                    set: function(t) {
                        this._trs[7] !== t && (this._trs[7] = t, this.setLocalDirty(z.ALL_SCALE), 2 & this._eventMask && this.emit(U.SCALE_CHANGED));
                    }
                },
                scaleY: {
                    get: function() {
                        return this._trs[8];
                    },
                    set: function(t) {
                        this._trs[8] !== t && (this._trs[8] = t, this.setLocalDirty(z.ALL_SCALE), 2 & this._eventMask && this.emit(U.SCALE_CHANGED));
                    }
                },
                scaleZ: {
                    get: function() {
                        return this._trs[9];
                    },
                    set: function(t) {
                        this._trs[9] !== t && (this._trs[9] = t, this.setLocalDirty(z.ALL_SCALE), this._renderFlag |= h.FLAG_TRANSFORM, 
                        2 & this._eventMask && this.emit(U.SCALE_CHANGED));
                    }
                },
                skewX: {
                    get: function() {
                        return this._skewX;
                    },
                    set: function(t) {
                        q(t), this._skewX = t, this.setLocalDirty(z.SKEW);
                    }
                },
                skewY: {
                    get: function() {
                        return this._skewY;
                    },
                    set: function(t) {
                        q(t), this._skewY = t, this.setLocalDirty(z.SKEW);
                    }
                },
                opacity: {
                    get: function() {
                        return this._opacity;
                    },
                    set: function(t) {
                        t = cc.misc.clampf(t, 0, 255), this._opacity !== t && (this._opacity = t, this._renderFlag |= h.FLAG_OPACITY_COLOR);
                    },
                    range: [ 0, 255 ]
                },
                color: {
                    get: function() {
                        return this._color.clone();
                    },
                    set: function(t) {
                        this._color.equals(t) || (this._color.set(t), this._renderFlag |= h.FLAG_COLOR, 
                        32 & this._eventMask && this.emit(U.COLOR_CHANGED, t));
                    }
                },
                anchorX: {
                    get: function() {
                        return this._anchorPoint.x;
                    },
                    set: function(t) {
                        var e = this._anchorPoint;
                        e.x !== t && (e.x = t, 16 & this._eventMask && this.emit(U.ANCHOR_CHANGED));
                    }
                },
                anchorY: {
                    get: function() {
                        return this._anchorPoint.y;
                    },
                    set: function(t) {
                        var e = this._anchorPoint;
                        e.y !== t && (e.y = t, 16 & this._eventMask && this.emit(U.ANCHOR_CHANGED));
                    }
                },
                width: {
                    get: function() {
                        return this._contentSize.width;
                    },
                    set: function(t) {
                        t !== this._contentSize.width && (this._contentSize.width = t, 8 & this._eventMask && this.emit(U.SIZE_CHANGED));
                    }
                },
                height: {
                    get: function() {
                        return this._contentSize.height;
                    },
                    set: function(t) {
                        t !== this._contentSize.height && (this._contentSize.height = t, 8 & this._eventMask && this.emit(U.SIZE_CHANGED));
                    }
                },
                zIndex: {
                    get: function() {
                        return this._localZOrder >> 16;
                    },
                    set: function(t) {
                        t > c.MAX_ZINDEX ? (cc.warnID(1636), t = c.MAX_ZINDEX) : t < c.MIN_ZINDEX && (cc.warnID(1637), 
                        t = c.MIN_ZINDEX), this.zIndex !== t && (this._localZOrder = 65535 & this._localZOrder | t << 16, 
                        this.emit(U.SIBLING_ORDER_CHANGED), this._onSiblingIndexChanged());
                    }
                },
                is3DNode: {
                    get: function() {
                        return this._is3DNode;
                    },
                    set: function(t) {
                        this._is3DNode = t, this._update3DFunction();
                    }
                },
                up: {
                    get: function() {
                        return i.Vec3.transformQuat(P, i.Vec3.UP, this.getWorldRotation(I)).clone();
                    }
                },
                right: {
                    get: function() {
                        return i.Vec3.transformQuat(P, i.Vec3.RIGHT, this.getWorldRotation(I)).clone();
                    }
                },
                forward: {
                    get: function() {
                        return i.Vec3.transformQuat(P, i.Vec3.FORWARD, this.getWorldRotation(I)).clone();
                    }
                }
            },
            ctor: function() {
                this._reorderChildDirty = !1, this._widget = null, this._renderComponent = null, 
                this._capturingListeners = null, this._bubblingListeners = null, this._touchListener = null, 
                this._mouseListener = null, this._initDataFromPool(), this._eventMask = 0, this._cullingMask = 1, 
                this._childArrivalOrder = 1, this._renderFlag = h.FLAG_TRANSFORM | h.FLAG_OPACITY_COLOR;
            },
            statics: {
                EventType: U,
                _LocalDirtyFlag: z,
                isNode: function(t) {
                    return t instanceof dt && (t.constructor === dt || !(t instanceof cc.Scene));
                },
                BuiltinGroupIndex: k
            },
            _onSiblingIndexChanged: function() {
                this._parent && this._parent._delaySort();
            },
            _onPreDestroy: function() {
                this._onPreDestroyBase(), d && cc.director.getActionManager().removeAllActionsFromTarget(this), 
                X === this && (X = null), this._bubblingListeners && this._bubblingListeners.clear(), 
                this._capturingListeners && this._capturingListeners.clear(), (this._touchListener || this._mouseListener) && (a.removeListeners(this), 
                this._touchListener && (this._touchListener.owner = null, this._touchListener.mask = null, 
                this._touchListener = null), this._mouseListener && (this._mouseListener.owner = null, 
                this._mouseListener.mask = null, this._mouseListener = null)), this._backDataIntoPool(), 
                this._reorderChildDirty && cc.director.__fastOff(cc.Director.EVENT_AFTER_UPDATE, this.sortAllChildren, this);
            },
            _onPostActivated: function(t) {
                var e = d ? cc.director.getActionManager() : null;
                t ? (this._renderFlag |= h.FLAG_WORLD_TRANSFORM, e && e.resumeTarget(this), a.resumeTarget(this), 
                this._checkListenerMask()) : (e && e.pauseTarget(this), a.pauseTarget(this));
            },
            _onHierarchyChanged: function(t) {
                this._updateOrderOfArrival(), ot(this), this._parent && this._parent._delaySort(), 
                this._renderFlag |= h.FLAG_WORLD_TRANSFORM, this._onHierarchyChangedBase(t), cc._widgetManager && (cc._widgetManager._nodesOrderDirty = !0), 
                t && this._activeInHierarchy && this._checkListenerMask();
            },
            _update3DFunction: function() {
                this._is3DNode ? (this._updateLocalMatrix = at, this._calculWorldMatrix = lt, this._mulMat = _t) : (this._updateLocalMatrix = ct, 
                this._calculWorldMatrix = ut, this._mulMat = ht), this._renderComponent && this._renderComponent._on3DNodeChanged && this._renderComponent._on3DNodeChanged(), 
                this._renderFlag |= h.FLAG_TRANSFORM, this._localMatDirty = z.ALL;
            },
            _initDataFromPool: function() {
                this._spaceInfo || (this._spaceInfo = s.pop());
                var t = this._spaceInfo;
                this._matrix = cc.mat4(t.localMat), i.Mat4.identity(this._matrix), this._worldMatrix = cc.mat4(t.worldMat), 
                i.Mat4.identity(this._worldMatrix), this._localMatDirty = z.ALL, this._worldMatDirty = !0;
                var e = this._trs = t.trs;
                e[0] = 0, e[1] = 0, e[2] = 0, e[3] = 0, e[4] = 0, e[5] = 0, e[6] = 1, e[7] = 1, 
                e[8] = 1, e[9] = 1;
            },
            _backDataIntoPool: function() {
                s.push(this._spaceInfo), this._matrix = null, this._worldMatrix = null, this._trs = null, 
                this._spaceInfo = null;
            },
            _toEuler: function() {
                if (this.is3DNode) i.Trs.toEuler(this._eulerAngles, this._trs); else {
                    var t = Math.asin(this._trs[5]) / f * 2;
                    i.Vec3.set(this._eulerAngles, 0, 0, t);
                }
            },
            _fromEuler: function() {
                this.is3DNode ? i.Trs.fromEuler(this._trs, this._eulerAngles) : i.Trs.fromAngleZ(this._trs, this._eulerAngles.z);
            },
            _initProperties: function() {
                this._is3DNode && this._update3DFunction();
                var t = this._trs;
                if (t) {
                    var e = t;
                    t = this._trs = this._spaceInfo.trs, 11 === e.length ? t.set(e.subarray(1)) : t.set(e);
                } else t = this._trs = this._spaceInfo.trs;
                this._fromEuler();
            },
            _onBatchCreated: function(t) {
                this._initProperties(), this._cullingMask = 1 << st(this), this._activeInHierarchy || (d && cc.director.getActionManager().pauseTarget(this), 
                a.pauseTarget(this));
                for (var e = this._children, i = 0, n = e.length; i < n; i++) {
                    var s = e[i];
                    if (!t) {
                        var o = s._prefab;
                        o && o.sync && o.root === s && r.syncWithPrefab(s), s._updateOrderOfArrival();
                    }
                    s._onBatchCreated(t);
                }
                e.length > 0 && (this._renderFlag |= h.FLAG_CHILDREN);
            },
            _checkListenerMask: function() {
                if (this._touchListener) {
                    var t = this._touchListener.mask = it(this, cc.Mask);
                    this._mouseListener && (this._mouseListener.mask = t);
                } else this._mouseListener && (this._mouseListener.mask = it(this, cc.Mask));
            },
            _checknSetupSysEvent: function(t) {
                var e = !1, i = !1;
                return -1 !== H.indexOf(t) ? (this._touchListener || (this._touchListener = cc.EventListener.create({
                    event: cc.EventListener.TOUCH_ONE_BY_ONE,
                    swallowTouches: !0,
                    owner: this,
                    mask: it(this, cc.Mask),
                    onTouchBegan: Y,
                    onTouchMoved: J,
                    onTouchEnded: Z,
                    onTouchCancelled: K
                }), a.addListener(this._touchListener, this), e = !0), i = !0) : -1 !== W.indexOf(t) && (this._mouseListener || (this._mouseListener = cc.EventListener.create({
                    event: cc.EventListener.MOUSE,
                    _previousIn: !1,
                    owner: this,
                    mask: it(this, cc.Mask),
                    onMouseDown: Q,
                    onMouseMove: $,
                    onMouseUp: tt,
                    onMouseScroll: et
                }), a.addListener(this._mouseListener, this), e = !0), i = !0), e && !this._activeInHierarchy && cc.director.getScheduler().schedule(function() {
                    this._activeInHierarchy || a.pauseTarget(this);
                }, this, 0, 0, 0, !1), i;
            },
            on: function(t, e, i, n) {
                if (this._checknSetupSysEvent(t)) return this._onDispatch(t, e, i, n);
                switch (t) {
                  case U.POSITION_CHANGED:
                    this._eventMask |= 1;
                    break;

                  case U.SCALE_CHANGED:
                    this._eventMask |= 2;
                    break;

                  case U.ROTATION_CHANGED:
                    this._eventMask |= 4;
                    break;

                  case U.SIZE_CHANGED:
                    this._eventMask |= 8;
                    break;

                  case U.ANCHOR_CHANGED:
                    this._eventMask |= 16;
                    break;

                  case U.COLOR_CHANGED:
                    this._eventMask |= 32;
                }
                return this._bubblingListeners || (this._bubblingListeners = new u()), this._bubblingListeners.on(t, e, i);
            },
            once: function(t, e, i, n) {
                var r = this, s = null;
                (s = this._checknSetupSysEvent(t) && n ? this._capturingListeners = this._capturingListeners || new u() : this._bubblingListeners = this._bubblingListeners || new u()).once(t, e, i), 
                s.once(t, function() {
                    r.off(t, e, i);
                }, void 0);
            },
            _onDispatch: function(t, e, i, n) {
                if ("boolean" == typeof i ? (n = i, i = void 0) : n = !!n, e) {
                    var r = null;
                    return (r = n ? this._capturingListeners = this._capturingListeners || new u() : this._bubblingListeners = this._bubblingListeners || new u()).hasEventListener(t, e, i) || (r.on(t, e, i), 
                    i && i.__eventTargets && i.__eventTargets.push(this)), e;
                }
                cc.errorID(6800);
            },
            off: function(t, e, i, n) {
                var r = -1 !== H.indexOf(t), s = !r && -1 !== W.indexOf(t);
                if (r || s) this._offDispatch(t, e, i, n), r ? this._touchListener && !nt(this, H) && (a.removeListener(this._touchListener), 
                this._touchListener = null) : s && this._mouseListener && !nt(this, W) && (a.removeListener(this._mouseListener), 
                this._mouseListener = null); else if (this._bubblingListeners && (this._bubblingListeners.off(t, e, i), 
                !this._bubblingListeners.hasEventListener(t))) switch (t) {
                  case U.POSITION_CHANGED:
                    this._eventMask &= -2;
                    break;

                  case U.SCALE_CHANGED:
                    this._eventMask &= -3;
                    break;

                  case U.ROTATION_CHANGED:
                    this._eventMask &= -5;
                    break;

                  case U.SIZE_CHANGED:
                    this._eventMask &= -9;
                    break;

                  case U.ANCHOR_CHANGED:
                    this._eventMask &= -17;
                    break;

                  case U.COLOR_CHANGED:
                    this._eventMask &= -33;
                }
            },
            _offDispatch: function(t, e, i, n) {
                if ("boolean" == typeof i ? (n = i, i = void 0) : n = !!n, e) {
                    var r = n ? this._capturingListeners : this._bubblingListeners;
                    r && (r.off(t, e, i), i && i.__eventTargets && l.array.fastRemove(i.__eventTargets, this));
                } else this._capturingListeners && this._capturingListeners.removeAll(t), this._bubblingListeners && this._bubblingListeners.removeAll(t);
            },
            targetOff: function(t) {
                var e = this._bubblingListeners;
                e && (e.targetOff(t), 1 & this._eventMask && !e.hasEventListener(U.POSITION_CHANGED) && (this._eventMask &= -2), 
                2 & this._eventMask && !e.hasEventListener(U.SCALE_CHANGED) && (this._eventMask &= -3), 
                4 & this._eventMask && !e.hasEventListener(U.ROTATION_CHANGED) && (this._eventMask &= -5), 
                8 & this._eventMask && !e.hasEventListener(U.SIZE_CHANGED) && (this._eventMask &= -9), 
                16 & this._eventMask && !e.hasEventListener(U.ANCHOR_CHANGED) && (this._eventMask &= -17), 
                32 & this._eventMask && !e.hasEventListener(U.COLOR_CHANGED) && (this._eventMask &= -33)), 
                this._capturingListeners && this._capturingListeners.targetOff(t), t && t.__eventTargets && l.array.fastRemove(t.__eventTargets, this), 
                this._touchListener && !nt(this, H) && (a.removeListener(this._touchListener), this._touchListener = null), 
                this._mouseListener && !nt(this, W) && (a.removeListener(this._mouseListener), this._mouseListener = null);
            },
            hasEventListener: function(t) {
                var e = !1;
                return this._bubblingListeners && (e = this._bubblingListeners.hasEventListener(t)), 
                !e && this._capturingListeners && (e = this._capturingListeners.hasEventListener(t)), 
                e;
            },
            emit: function(t, e, i, n, r, s) {
                this._bubblingListeners && this._bubblingListeners.emit(t, e, i, n, r, s);
            },
            dispatchEvent: function(t) {
                rt(this, t), G.length = 0;
            },
            pauseSystemEvents: function(t) {
                a.pauseTarget(this, t);
            },
            resumeSystemEvents: function(t) {
                a.resumeTarget(this, t);
            },
            _hitTest: function(t, e) {
                var n = this._contentSize.width, r = this._contentSize.height, s = D, o = V, a = cc.Camera.findCamera(this);
                if (a ? a.getScreenToWorldPoint(t, s) : s.set(t), this._updateWorldMatrix(), !i.Mat4.invert(F, this._worldMatrix)) return !1;
                i.Vec2.transformMat4(o, s, F), o.x += this._anchorPoint.x * n, o.y += this._anchorPoint.y * r;
                var c = !1;
                if (o.x >= 0 && o.y >= 0 && o.x <= n && o.y <= r && (c = !0, e && e.mask)) for (var l = e.mask, u = this, h = l ? l.length : 0, _ = 0, f = 0; u && f < h; ++_, 
                u = u.parent) {
                    var d = l[f];
                    if (_ === d.index) {
                        if (u !== d.node) {
                            l.length = f;
                            break;
                        }
                        var p = u.getComponent(cc.Mask);
                        if (p && p._enabled && !p._hitTest(s)) {
                            c = !1;
                            break;
                        }
                        f++;
                    } else if (_ > d.index) {
                        l.length = f;
                        break;
                    }
                }
                return c;
            },
            _getCapturingTargets: function(t, e) {
                for (var i = this.parent; i; ) i._capturingListeners && i._capturingListeners.hasEventListener(t) && e.push(i), 
                i = i.parent;
            },
            _getBubblingTargets: function(t, e) {
                for (var i = this.parent; i; ) i._bubblingListeners && i._bubblingListeners.hasEventListener(t) && e.push(i), 
                i = i.parent;
            },
            runAction: d ? function(t) {
                if (this.active) {
                    cc.assertID(t, 1618);
                    var e = cc.director.getActionManager();
                    return e._suppressDeprecation || (e._suppressDeprecation = !0, cc.warnID(1639)), 
                    e.addAction(t, this, !1), t;
                }
            } : p,
            pauseAllActions: d ? function() {
                cc.director.getActionManager().pauseTarget(this);
            } : p,
            resumeAllActions: d ? function() {
                cc.director.getActionManager().resumeTarget(this);
            } : p,
            stopAllActions: d ? function() {
                cc.director.getActionManager().removeAllActionsFromTarget(this);
            } : p,
            stopAction: d ? function(t) {
                cc.director.getActionManager().removeAction(t);
            } : p,
            stopActionByTag: d ? function(t) {
                t !== cc.Action.TAG_INVALID ? cc.director.getActionManager().removeActionByTag(t, this) : cc.logID(1612);
            } : p,
            getActionByTag: d ? function(t) {
                return t === cc.Action.TAG_INVALID ? (cc.logID(1613), null) : cc.director.getActionManager().getActionByTag(t, this);
            } : function() {
                return null;
            },
            getNumberOfRunningActions: d ? function() {
                return cc.director.getActionManager().getNumberOfRunningActionsInTarget(this);
            } : function() {
                return 0;
            },
            getPosition: function(t) {
                return t = t || new i.Vec3(), i.Trs.toPosition(t, this._trs);
            },
            setPosition: function(t, e, i) {
                var n;
                void 0 === e ? (n = t.x, e = t.y, i = t.z) : n = t;
                var r = this._trs;
                void 0 === i && (i = r[2]), (r[0] !== n || r[1] !== e || r[2] !== i) && (r[0] = n, 
                r[1] = e, r[2] = i, this.setLocalDirty(z.ALL_POSITION), this._renderFlag |= h.FLAG_WORLD_TRANSFORM, 
                1 & this._eventMask && this.emit(U.POSITION_CHANGED));
            },
            getScale: function(t) {
                return void 0 !== t ? i.Trs.toScale(t, this._trs) : (cc.errorID(1400, "cc.Node.getScale", "cc.Node.scale or cc.Node.getScale(cc.Vec3)"), 
                this._trs[7]);
            },
            setScale: function(t, e, i) {
                var n;
                t && "number" != typeof t ? (n = t.x, e = t.y, i = t.z) : void 0 !== t && void 0 === e ? (n = t, 
                e = t, i = t) : n = t;
                var r = this._trs;
                void 0 === i && (i = r[9]), r[7] === n && r[8] === e && r[9] === i || (r[7] = n, 
                r[8] = e, r[9] = i, this.setLocalDirty(z.ALL_SCALE), this._renderFlag |= h.FLAG_TRANSFORM, 
                2 & this._eventMask && this.emit(U.SCALE_CHANGED));
            },
            getRotation: function(t) {
                return t instanceof i.Quat ? i.Trs.toRotation(t, this._trs) : -this.angle;
            },
            setRotation: function(t, e, i, n) {
                if ("number" == typeof t && void 0 === e) this.angle = -t; else {
                    var r = t;
                    void 0 === e && (r = t.x, e = t.y, i = t.z, n = t.w);
                    var s = this._trs;
                    s[3] === r && s[4] === e && s[5] === i && s[6] === n || (s[3] = r, s[4] = e, s[5] = i, 
                    s[6] = n, this.setLocalDirty(z.ALL_ROTATION), 4 & this._eventMask && this.emit(U.ROTATION_CHANGED));
                }
            },
            getContentSize: function() {
                return cc.size(this._contentSize.width, this._contentSize.height);
            },
            setContentSize: function(t, e) {
                var i = this._contentSize;
                if (void 0 === e) {
                    if (t.width === i.width && t.height === i.height) return;
                    i.width = t.width, i.height = t.height;
                } else {
                    if (t === i.width && e === i.height) return;
                    i.width = t, i.height = e;
                }
                8 & this._eventMask && this.emit(U.SIZE_CHANGED);
            },
            getAnchorPoint: function() {
                return cc.v2(this._anchorPoint);
            },
            setAnchorPoint: function(t, e) {
                var i = this._anchorPoint;
                if (void 0 === e) {
                    if (t.x === i.x && t.y === i.y) return;
                    i.x = t.x, i.y = t.y;
                } else {
                    if (t === i.x && e === i.y) return;
                    i.x = t, i.y = e;
                }
                this.setLocalDirty(z.ALL_POSITION), 16 & this._eventMask && this.emit(U.ANCHOR_CHANGED);
            },
            _invTransformPoint: function(t, e) {
                this._parent ? this._parent._invTransformPoint(t, e) : i.Vec3.copy(t, e);
                var n = this._trs;
                return i.Trs.toPosition(y, n), i.Vec3.sub(t, t, y), i.Trs.toRotation(x, n), i.Quat.conjugate(A, x), 
                i.Vec3.transformQuat(t, t, A), i.Trs.toScale(y, n), i.Vec3.inverseSafe(g, y), i.Vec3.mul(t, t, g), 
                t;
            },
            getWorldPosition: function(t) {
                i.Trs.toPosition(t, this._trs);
                for (var e, n = this._parent; n; ) e = n._trs, i.Trs.toScale(m, e), i.Vec3.mul(t, t, m), 
                i.Trs.toRotation(v, e), i.Vec3.transformQuat(t, t, v), i.Trs.toPosition(m, e), i.Vec3.add(t, t, m), 
                n = n._parent;
                return t;
            },
            setWorldPosition: function(t) {
                var e = this._trs;
                this._parent ? this._parent._invTransformPoint(C, t) : i.Vec3.copy(C, t), i.Trs.fromPosition(e, C), 
                this.setLocalDirty(z.ALL_POSITION), 1 & this._eventMask && this.emit(U.POSITION_CHANGED);
            },
            getWorldRotation: function(t) {
                i.Trs.toRotation(L, this._trs), i.Quat.copy(t, L);
                for (var e = this._parent; e; ) i.Trs.toRotation(L, e._trs), i.Quat.mul(t, L, t), 
                e = e._parent;
                return t;
            },
            setWorldRotation: function(t) {
                this._parent ? (this._parent.getWorldRotation(O), i.Quat.conjugate(O, O), i.Quat.mul(O, O, t)) : i.Quat.copy(O, t), 
                i.Trs.fromRotation(this._trs, O), this.setLocalDirty(z.ALL_ROTATION);
            },
            getWorldScale: function(t) {
                i.Trs.toScale(b, this._trs), i.Vec3.copy(t, b);
                for (var e = this._parent; e; ) i.Trs.toScale(b, e._trs), i.Vec3.mul(t, t, b), e = e._parent;
                return t;
            },
            setWorldScale: function(t) {
                this._parent ? (this._parent.getWorldScale(S), i.Vec3.div(S, t, S)) : i.Vec3.copy(S, t), 
                i.Trs.fromScale(this._trs, S), this.setLocalDirty(z.ALL_SCALE);
            },
            getWorldRT: function(t) {
                var e = T, n = E, r = this._trs;
                i.Trs.toPosition(e, r), i.Trs.toRotation(n, r);
                for (var s = this._parent; s; ) r = s._trs, i.Trs.toScale(w, r), i.Vec3.mul(e, e, w), 
                i.Trs.toRotation(B, r), i.Vec3.transformQuat(e, e, B), i.Trs.toPosition(w, r), i.Vec3.add(e, e, w), 
                i.Quat.mul(n, B, n), s = s._parent;
                return i.Mat4.fromRT(t, n, e), t;
            },
            lookAt: function(t, e) {
                this.getWorldPosition(M), i.Vec3.sub(M, M, t), i.Vec3.normalize(M, M), i.Quat.fromViewUp(R, M, e), 
                this.setWorldRotation(R);
            },
            _updateLocalMatrix: ct,
            _calculWorldMatrix: function() {
                this._localMatDirty & z.TRSS && this._updateLocalMatrix();
                var t = this._parent;
                t ? this._mulMat(this._worldMatrix, t._worldMatrix, this._matrix) : i.Mat4.copy(this._worldMatrix, this._matrix), 
                this._worldMatDirty = !1;
            },
            _mulMat: ht,
            _updateWorldMatrix: function() {
                if (this._parent && this._parent._updateWorldMatrix(), this._worldMatDirty) {
                    this._calculWorldMatrix();
                    for (var t = this._children, e = 0, i = t.length; e < i; e++) t[e]._worldMatDirty = !0;
                }
            },
            setLocalDirty: function(t) {
                this._localMatDirty |= t, this._worldMatDirty = !0, t === z.ALL_POSITION || t === z.POSITION ? this._renderFlag |= h.FLAG_WORLD_TRANSFORM : this._renderFlag |= h.FLAG_TRANSFORM;
            },
            setWorldDirty: function() {
                this._worldMatDirty = !0;
            },
            getLocalMatrix: function(t) {
                return this._updateLocalMatrix(), i.Mat4.copy(t, this._matrix);
            },
            getWorldMatrix: function(t) {
                return this._updateWorldMatrix(), i.Mat4.copy(t, this._worldMatrix);
            },
            convertToNodeSpaceAR: function(t, e) {
                return this._updateWorldMatrix(), i.Mat4.invert(F, this._worldMatrix), t instanceof cc.Vec2 ? (e = e || new cc.Vec2(), 
                i.Vec2.transformMat4(e, t, F)) : (e = e || new cc.Vec3(), i.Vec3.transformMat4(e, t, F));
            },
            convertToWorldSpaceAR: function(t, e) {
                return this._updateWorldMatrix(), t instanceof cc.Vec2 ? (e = e || new cc.Vec2(), 
                i.Vec2.transformMat4(e, t, this._worldMatrix)) : (e = e || new cc.Vec3(), i.Vec3.transformMat4(e, t, this._worldMatrix));
            },
            convertToNodeSpace: function(t) {
                this._updateWorldMatrix(), i.Mat4.invert(F, this._worldMatrix);
                var e = new cc.Vec2();
                return i.Vec2.transformMat4(e, t, F), e.x += this._anchorPoint.x * this._contentSize.width, 
                e.y += this._anchorPoint.y * this._contentSize.height, e;
            },
            convertToWorldSpace: function(t) {
                this._updateWorldMatrix();
                var e = new cc.Vec2(t.x - this._anchorPoint.x * this._contentSize.width, t.y - this._anchorPoint.y * this._contentSize.height);
                return i.Vec2.transformMat4(e, e, this._worldMatrix);
            },
            getNodeToParentTransform: function(t) {
                t || (t = o.identity()), this._updateLocalMatrix();
                var e = this._contentSize;
                return N.x = -this._anchorPoint.x * e.width, N.y = -this._anchorPoint.y * e.height, 
                i.Mat4.copy(F, this._matrix), i.Mat4.transform(F, F, N), o.fromMat4(t, F);
            },
            getNodeToParentTransformAR: function(t) {
                return t || (t = o.identity()), this._updateLocalMatrix(), o.fromMat4(t, this._matrix);
            },
            getNodeToWorldTransform: function(t) {
                t || (t = o.identity()), this._updateWorldMatrix();
                var e = this._contentSize;
                return N.x = -this._anchorPoint.x * e.width, N.y = -this._anchorPoint.y * e.height, 
                i.Mat4.copy(F, this._worldMatrix), i.Mat4.transform(F, F, N), o.fromMat4(t, F);
            },
            getNodeToWorldTransformAR: function(t) {
                return t || (t = o.identity()), this._updateWorldMatrix(), o.fromMat4(t, this._worldMatrix);
            },
            getParentToNodeTransform: function(t) {
                return t || (t = o.identity()), this._updateLocalMatrix(), i.Mat4.invert(F, this._matrix), 
                o.fromMat4(t, F);
            },
            getWorldToNodeTransform: function(t) {
                return t || (t = o.identity()), this._updateWorldMatrix(), i.Mat4.invert(F, this._worldMatrix), 
                o.fromMat4(t, F);
            },
            convertTouchToNodeSpace: function(t) {
                return this.convertToNodeSpace(t.getLocation());
            },
            convertTouchToNodeSpaceAR: function(t) {
                return this.convertToNodeSpaceAR(t.getLocation());
            },
            getBoundingBox: function() {
                this._updateLocalMatrix();
                var t = this._contentSize.width, e = this._contentSize.height, i = cc.rect(-this._anchorPoint.x * t, -this._anchorPoint.y * e, t, e);
                return i.transformMat4(i, this._matrix);
            },
            getBoundingBoxToWorld: function() {
                return this._parent ? (this._parent._updateWorldMatrix(), this._getBoundingBoxTo()) : this.getBoundingBox();
            },
            _getBoundingBoxTo: function() {
                var t = this._contentSize.width, e = this._contentSize.height, i = cc.rect(-this._anchorPoint.x * t, -this._anchorPoint.y * e, t, e);
                if (this._calculWorldMatrix(), i.transformMat4(i, this._worldMatrix), !this._children) return i;
                for (var n = this._children, r = 0; r < n.length; r++) {
                    var s = n[r];
                    if (s && s.active) {
                        var o = s._getBoundingBoxTo();
                        o && i.union(i, o);
                    }
                }
                return i;
            },
            _updateOrderOfArrival: function() {
                var t = this._parent ? ++this._parent._childArrivalOrder : 0;
                this._localZOrder = 4294901760 & this._localZOrder | t, this.emit(U.SIBLING_ORDER_CHANGED);
            },
            addChild: function(t, e, i) {
                cc.assertID(t, 1606), cc.assertID(null === t._parent, 1605), t.parent = this, void 0 !== e && (t.zIndex = e), 
                void 0 !== i && (t.name = i);
            },
            cleanup: function() {
                d && cc.director.getActionManager().removeAllActionsFromTarget(this), a.removeListeners(this);
                var t, e, i = this._children.length;
                for (t = 0; t < i; ++t) (e = this._children[t]) && e.cleanup();
            },
            sortAllChildren: function() {
                if (this._reorderChildDirty) {
                    this._reorderChildDirty = !1;
                    var t = this._children;
                    this._childArrivalOrder = 1;
                    for (var e = 0, i = t.length; e < i; e++) t[e]._updateOrderOfArrival();
                    if (a._setDirtyForNode(this), t.length > 1) {
                        for (var n, r, s = 1, o = t.length; s < o; s++) {
                            n = t[s];
                            for (var c = s; c > 0 && (r = t[c - 1])._localZOrder > n._localZOrder; c--) t[c] = r;
                            t[c] = n;
                        }
                        this.emit(U.CHILD_REORDER, this);
                    }
                    cc.director.__fastOff(cc.Director.EVENT_AFTER_UPDATE, this.sortAllChildren, this);
                }
            },
            _delaySort: function() {
                this._reorderChildDirty || (this._reorderChildDirty = !0, cc.director.__fastOn(cc.Director.EVENT_AFTER_UPDATE, this.sortAllChildren, this));
            },
            _restoreProperties: !1,
            onRestore: !1
        }, dt = cc.Class(ft), pt = dt.prototype;
        l.getset(pt, "position", pt.getPosition, pt.setPosition, !1, !0), cc.Node = e.exports = dt;
    }, {
        "./event-manager": 127,
        "./event/event": 130,
        "./event/event-target": 129,
        "./platform/CCMacro": 187,
        "./platform/js": 203,
        "./renderer/render-flow": 214,
        "./utils/affine-transform": 248,
        "./utils/base-node": 249,
        "./utils/prefab-helper": 259,
        "./utils/trans-pool": 265,
        "./value-types": 271
    } ],
    26: [ function(t, e) {
        "use strict";
        var i = t("./CCNode"), n = t("./renderer/render-flow"), r = (cc.Object.Flags.HideInHierarchy, 
        i._LocalDirtyFlag), s = cc.Class({
            name: "cc.PrivateNode",
            extends: i,
            properties: {
                x: {
                    get: function() {
                        return this._originPos.x;
                    },
                    set: function(t) {
                        var e = this._originPos;
                        t !== e.x && (e.x = t, this._posDirty(!0));
                    },
                    override: !0
                },
                y: {
                    get: function() {
                        return this._originPos.y;
                    },
                    set: function(t) {
                        var e = this._originPos;
                        t !== e.y && (e.y = t, this._posDirty(!0));
                    },
                    override: !0
                },
                zIndex: {
                    get: function() {
                        return cc.macro.MIN_ZINDEX;
                    },
                    set: function() {},
                    override: !0
                },
                showInEditor: {
                    default: !1,
                    editorOnly: !0,
                    override: !0
                }
            },
            ctor: function() {
                this._localZOrder = cc.macro.MIN_ZINDEX << 16, this._originPos = cc.v2();
            },
            _posDirty: function(t) {
                this.setLocalDirty(r.POSITION), this._renderFlag |= n.FLAG_TRANSFORM, !0 === t && 1 & this._eventMask && this.emit(i.EventType.POSITION_CHANGED);
            },
            _updateLocalMatrix: function() {
                if (this._localMatDirty) {
                    var t = this.parent;
                    t && (this._trs[0] = this._originPos.x - (t._anchorPoint.x - .5) * t._contentSize.width, 
                    this._trs[1] = this._originPos.y - (t._anchorPoint.y - .5) * t._contentSize.height), 
                    this._super();
                }
            },
            getPosition: function() {
                return new cc.Vec2(this._originPos);
            },
            setPosition: function(t, e) {
                void 0 === e && (e = (t = t.x).y);
                var i = this._originPos;
                i.x === t && i.y === e || (i.x = t, i.y = e, this._posDirty(!0));
            },
            setParent: function(t) {
                var e = this._parent;
                this._super(t), e !== t && (e && e.off(i.EventType.ANCHOR_CHANGED, this._posDirty, this), 
                t && t.on(i.EventType.ANCHOR_CHANGED, this._posDirty, this));
            },
            _updateOrderOfArrival: function() {}
        }), o = s.prototype;
        cc.js.getset(o, "parent", o.getParent, o.setParent), cc.js.getset(o, "position", o.getPosition, o.setPosition), 
        cc.PrivateNode = e.exports = s;
    }, {
        "./CCNode": 25,
        "./renderer/render-flow": 214
    } ],
    27: [ function(t, e) {
        "use strict";
        cc.Scene = cc.Class({
            name: "cc.Scene",
            extends: t("./CCNode"),
            properties: {
                _is3DNode: {
                    default: !0,
                    override: !0
                },
                autoReleaseAssets: !1
            },
            ctor: function() {
                this._anchorPoint.x = 0, this._anchorPoint.y = 0, this._activeInHierarchy = !1, 
                this._inited = !cc.game._isCloning, this.dependAssets = null;
            },
            destroy: function() {
                if (cc.Object.prototype.destroy.call(this)) for (var t = this._children, e = 0; e < t.length; ++e) t[e].active = !1;
                this._active = !1, this._activeInHierarchy = !1;
            },
            _onHierarchyChanged: function() {},
            _instantiate: null,
            _load: function() {
                this._inited || (this._onBatchCreated(!1), this._inited = !0);
            },
            _activate: function(t) {
                t = !1 !== t, cc.director._nodeActivator.activateNode(this, t);
            }
        }), e.exports = cc.Scene;
    }, {
        "./CCNode": 25
    } ],
    28: [ function(t, e) {
        "use strict";
        var i = t("./platform/js"), n = new (t("./platform/id-generater"))("Scheduler"), r = function(t, e, i, n) {
            this.target = t, this.priority = e, this.paused = i, this.markedForDeletion = n;
        }, s = [];
        r.get = function(t, e, i, n) {
            var o = s.pop();
            return o ? (o.target = t, o.priority = e, o.paused = i, o.markedForDeletion = n) : o = new r(t, e, i, n), 
            o;
        }, r.put = function(t) {
            s.length < 20 && (t.target = null, s.push(t));
        };
        var o = function(t, e, i, n) {
            this.list = t, this.entry = e, this.target = i, this.callback = n;
        }, a = [];
        o.get = function(t, e, i, n) {
            var r = a.pop();
            return r ? (r.list = t, r.entry = e, r.target = i, r.callback = n) : r = new o(t, e, i, n), 
            r;
        }, o.put = function(t) {
            a.length < 20 && (t.list = t.entry = t.target = t.callback = null, a.push(t));
        };
        var c = function(t, e, i, n, r, s) {
            var o = this;
            o.timers = t, o.target = e, o.timerIndex = i, o.currentTimer = n, o.currentTimerSalvaged = r, 
            o.paused = s;
        }, l = [];
        function u() {
            this._lock = !1, this._scheduler = null, this._elapsed = -1, this._runForever = !1, 
            this._useDelay = !1, this._timesExecuted = 0, this._repeat = 0, this._delay = 0, 
            this._interval = 0, this._target = null, this._callback = null;
        }
        c.get = function(t, e, i, n, r, s) {
            var o = l.pop();
            return o ? (o.timers = t, o.target = e, o.timerIndex = i, o.currentTimer = n, o.currentTimerSalvaged = r, 
            o.paused = s) : o = new c(t, e, i, n, r, s), o;
        }, c.put = function(t) {
            l.length < 20 && (t.timers = t.target = t.currentTimer = null, l.push(t));
        };
        var h = u.prototype;
        h.initWithCallback = function(t, e, i, n, r, s) {
            return this._lock = !1, this._scheduler = t, this._target = i, this._callback = e, 
            this._elapsed = -1, this._interval = n, this._delay = s, this._useDelay = this._delay > 0, 
            this._repeat = r, this._runForever = this._repeat === cc.macro.REPEAT_FOREVER, !0;
        }, h.getInterval = function() {
            return this._interval;
        }, h.setInterval = function(t) {
            this._interval = t;
        }, h.update = function(t) {
            -1 === this._elapsed ? (this._elapsed = 0, this._timesExecuted = 0) : (this._elapsed += t, 
            this._runForever && !this._useDelay ? this._elapsed >= this._interval && (this.trigger(), 
            this._elapsed = 0) : (this._useDelay ? this._elapsed >= this._delay && (this.trigger(), 
            this._elapsed -= this._delay, this._timesExecuted += 1, this._useDelay = !1) : this._elapsed >= this._interval && (this.trigger(), 
            this._elapsed = 0, this._timesExecuted += 1), this._callback && !this._runForever && this._timesExecuted > this._repeat && this.cancel()));
        }, h.getCallback = function() {
            return this._callback;
        }, h.trigger = function() {
            this._target && this._callback && (this._lock = !0, this._callback.call(this._target, this._elapsed), 
            this._lock = !1);
        }, h.cancel = function() {
            this._scheduler.unschedule(this._callback, this._target);
        };
        var _ = [];
        u.get = function() {
            return _.pop() || new u();
        }, u.put = function(t) {
            _.length < 20 && !t._lock && (t._scheduler = t._target = t._callback = null, _.push(t));
        }, cc.Scheduler = function() {
            this._timeScale = 1, this._updatesNegList = [], this._updates0List = [], this._updatesPosList = [], 
            this._hashForUpdates = i.createMap(!0), this._hashForTimers = i.createMap(!0), this._currentTarget = null, 
            this._currentTargetSalvaged = !1, this._updateHashLocked = !1, this._arrayForTimers = [];
        }, cc.Scheduler.prototype = {
            constructor: cc.Scheduler,
            _removeHashElement: function(t) {
                delete this._hashForTimers[t.target._id];
                for (var e = this._arrayForTimers, i = 0, n = e.length; i < n; i++) if (e[i] === t) {
                    e.splice(i, 1);
                    break;
                }
                c.put(t);
            },
            _removeUpdateFromHash: function(t) {
                var e = t.target._id, i = this._hashForUpdates[e];
                if (i) {
                    for (var n = i.list, s = i.entry, a = 0, c = n.length; a < c; a++) if (n[a] === s) {
                        n.splice(a, 1);
                        break;
                    }
                    delete this._hashForUpdates[e], r.put(s), o.put(i);
                }
            },
            _priorityIn: function(t, e, i) {
                for (var n = 0; n < t.length; n++) if (i < t[n].priority) return void t.splice(n, 0, e);
                t.push(e);
            },
            _appendIn: function(t, e) {
                t.push(e);
            },
            enableForTarget: function(t) {
                t._id || (t.__instanceId ? cc.warnID(1513) : t._id = n.getNewId());
            },
            setTimeScale: function(t) {
                this._timeScale = t;
            },
            getTimeScale: function() {
                return this._timeScale;
            },
            update: function(t) {
                var e, i, n, r;
                for (this._updateHashLocked = !0, 1 !== this._timeScale && (t *= this._timeScale), 
                e = 0, n = (i = this._updatesNegList).length; e < n; e++) (r = i[e]).paused || r.markedForDeletion || r.target.update(t);
                for (e = 0, n = (i = this._updates0List).length; e < n; e++) (r = i[e]).paused || r.markedForDeletion || r.target.update(t);
                for (e = 0, n = (i = this._updatesPosList).length; e < n; e++) (r = i[e]).paused || r.markedForDeletion || r.target.update(t);
                var s, o = this._arrayForTimers;
                for (e = 0; e < o.length; e++) {
                    if (s = o[e], this._currentTarget = s, this._currentTargetSalvaged = !1, !s.paused) for (s.timerIndex = 0; s.timerIndex < s.timers.length; ++s.timerIndex) s.currentTimer = s.timers[s.timerIndex], 
                    s.currentTimerSalvaged = !1, s.currentTimer.update(t), s.currentTimer = null;
                    this._currentTargetSalvaged && 0 === this._currentTarget.timers.length && (this._removeHashElement(this._currentTarget), 
                    --e);
                }
                for (e = 0, i = this._updatesNegList; e < i.length; ) (r = i[e]).markedForDeletion ? this._removeUpdateFromHash(r) : e++;
                for (e = 0, i = this._updates0List; e < i.length; ) (r = i[e]).markedForDeletion ? this._removeUpdateFromHash(r) : e++;
                for (e = 0, i = this._updatesPosList; e < i.length; ) (r = i[e]).markedForDeletion ? this._removeUpdateFromHash(r) : e++;
                this._updateHashLocked = !1, this._currentTarget = null;
            },
            schedule: function(t, e, i, n, r, s) {
                if ("function" != typeof t) {
                    var o = t;
                    t = e, e = o;
                }
                4 !== arguments.length && 5 !== arguments.length || (s = !!n, n = cc.macro.REPEAT_FOREVER, 
                r = 0), cc.assertID(e, 1502);
                var a = e._id;
                a || (e.__instanceId ? (cc.warnID(1513), a = e._id = e.__instanceId) : cc.errorID(1510));
                var l, h, _ = this._hashForTimers[a];
                if (_ ? _.paused !== s && cc.warnID(1511) : (_ = c.get(null, e, 0, null, null, s), 
                this._arrayForTimers.push(_), this._hashForTimers[a] = _), null == _.timers) _.timers = []; else for (h = 0; h < _.timers.length; ++h) if ((l = _.timers[h]) && t === l._callback) return cc.logID(1507, l.getInterval(), i), 
                void (l._interval = i);
                (l = u.get()).initWithCallback(this, t, e, i, n, r), _.timers.push(l), this._currentTarget === _ && this._currentTargetSalvaged && (this._currentTargetSalvaged = !1);
            },
            scheduleUpdate: function(t, e, i) {
                var n = t._id;
                n || (t.__instanceId ? (cc.warnID(1513), n = t._id = t.__instanceId) : cc.errorID(1510));
                var s = this._hashForUpdates[n];
                if (s && s.entry) {
                    if (s.entry.priority === e) return s.entry.markedForDeletion = !1, void (s.entry.paused = i);
                    if (this._updateHashLocked) return cc.logID(1506), s.entry.markedForDeletion = !1, 
                    void (s.entry.paused = i);
                    this.unscheduleUpdate(t);
                }
                var a, c = r.get(t, e, i, !1);
                0 === e ? (a = this._updates0List, this._appendIn(a, c)) : (a = e < 0 ? this._updatesNegList : this._updatesPosList, 
                this._priorityIn(a, c, e)), this._hashForUpdates[n] = o.get(a, c, t, null);
            },
            unschedule: function(t, e) {
                if (e && t) {
                    var i = e._id;
                    i || (e.__instanceId ? (cc.warnID(1513), i = e._id = e.__instanceId) : cc.errorID(1510));
                    var n = this._hashForTimers[i];
                    if (n) for (var r = n.timers, s = 0, o = r.length; s < o; s++) {
                        var a = r[s];
                        if (t === a._callback) return a !== n.currentTimer || n.currentTimerSalvaged || (n.currentTimerSalvaged = !0), 
                        r.splice(s, 1), u.put(a), n.timerIndex >= s && n.timerIndex--, void (0 === r.length && (this._currentTarget === n ? this._currentTargetSalvaged = !0 : this._removeHashElement(n)));
                    }
                }
            },
            unscheduleUpdate: function(t) {
                if (t) {
                    var e = t._id;
                    e || (t.__instanceId ? (cc.warnID(1513), e = t._id = t.__instanceId) : cc.errorID(1510));
                    var i = this._hashForUpdates[e];
                    i && (this._updateHashLocked ? i.entry.markedForDeletion = !0 : this._removeUpdateFromHash(i.entry));
                }
            },
            unscheduleAllForTarget: function(t) {
                if (t) {
                    var e = t._id;
                    e || (t.__instanceId ? (cc.warnID(1513), e = t._id = t.__instanceId) : cc.errorID(1510));
                    var i = this._hashForTimers[e];
                    if (i) {
                        var n = i.timers;
                        n.indexOf(i.currentTimer) > -1 && !i.currentTimerSalvaged && (i.currentTimerSalvaged = !0);
                        for (var r = 0, s = n.length; r < s; r++) u.put(n[r]);
                        n.length = 0, this._currentTarget === i ? this._currentTargetSalvaged = !0 : this._removeHashElement(i);
                    }
                    this.unscheduleUpdate(t);
                }
            },
            unscheduleAll: function() {
                this.unscheduleAllWithMinPriority(cc.Scheduler.PRIORITY_SYSTEM);
            },
            unscheduleAllWithMinPriority: function(t) {
                var e, i, n, r = this._arrayForTimers;
                for (e = r.length - 1; e >= 0; e--) i = r[e], this.unscheduleAllForTarget(i.target);
                var s = 0;
                if (t < 0) for (e = 0; e < this._updatesNegList.length; ) s = this._updatesNegList.length, 
                (n = this._updatesNegList[e]) && n.priority >= t && this.unscheduleUpdate(n.target), 
                s == this._updatesNegList.length && e++;
                if (t <= 0) for (e = 0; e < this._updates0List.length; ) s = this._updates0List.length, 
                (n = this._updates0List[e]) && this.unscheduleUpdate(n.target), s == this._updates0List.length && e++;
                for (e = 0; e < this._updatesPosList.length; ) s = this._updatesPosList.length, 
                (n = this._updatesPosList[e]) && n.priority >= t && this.unscheduleUpdate(n.target), 
                s == this._updatesPosList.length && e++;
            },
            isScheduled: function(t, e) {
                cc.assertID(t, 1508), cc.assertID(e, 1509);
                var i = e._id;
                i || (e.__instanceId ? (cc.warnID(1513), i = e._id = e.__instanceId) : cc.errorID(1510));
                var n = this._hashForTimers[i];
                if (!n) return !1;
                if (null == n.timers) return !1;
                for (var r = n.timers, s = 0; s < r.length; ++s) if (t === r[s]._callback) return !0;
                return !1;
            },
            pauseAllTargets: function() {
                return this.pauseAllTargetsWithMinPriority(cc.Scheduler.PRIORITY_SYSTEM);
            },
            pauseAllTargetsWithMinPriority: function(t) {
                var e, i, n, r, s = [], o = this._arrayForTimers;
                for (i = 0, n = o.length; i < n; i++) (e = o[i]) && (e.paused = !0, s.push(e.target));
                if (t < 0) for (i = 0; i < this._updatesNegList.length; i++) (r = this._updatesNegList[i]) && r.priority >= t && (r.paused = !0, 
                s.push(r.target));
                if (t <= 0) for (i = 0; i < this._updates0List.length; i++) (r = this._updates0List[i]) && (r.paused = !0, 
                s.push(r.target));
                for (i = 0; i < this._updatesPosList.length; i++) (r = this._updatesPosList[i]) && r.priority >= t && (r.paused = !0, 
                s.push(r.target));
                return s;
            },
            resumeTargets: function(t) {
                if (t) for (var e = 0; e < t.length; e++) this.resumeTarget(t[e]);
            },
            pauseTarget: function(t) {
                cc.assertID(t, 1503);
                var e = t._id;
                e || (t.__instanceId ? (cc.warnID(1513), e = t._id = t.__instanceId) : cc.errorID(1510));
                var i = this._hashForTimers[e];
                i && (i.paused = !0);
                var n = this._hashForUpdates[e];
                n && (n.entry.paused = !0);
            },
            resumeTarget: function(t) {
                cc.assertID(t, 1504);
                var e = t._id;
                e || (t.__instanceId ? (cc.warnID(1513), e = t._id = t.__instanceId) : cc.errorID(1510));
                var i = this._hashForTimers[e];
                i && (i.paused = !1);
                var n = this._hashForUpdates[e];
                n && (n.entry.paused = !1);
            },
            isTargetPaused: function(t) {
                cc.assertID(t, 1505);
                var e = t._id;
                e || (t.__instanceId ? (cc.warnID(1513), e = t._id = t.__instanceId) : cc.errorID(1510));
                var i = this._hashForTimers[e];
                if (i) return i.paused;
                var n = this._hashForUpdates[e];
                return !!n && n.entry.paused;
            }
        }, cc.Scheduler.PRIORITY_SYSTEM = 1 << 31, cc.Scheduler.PRIORITY_NON_SYSTEM = cc.Scheduler.PRIORITY_SYSTEM + 1, 
        e.exports = cc.Scheduler;
    }, {
        "./platform/id-generater": 199,
        "./platform/js": 203
    } ],
    29: [ function(t, e) {
        "use strict";
        var i = t("./preprocess"), n = t("./fetch"), r = t("./cache"), s = t("./helper"), o = t("./releaseManager"), a = t("./depend-util"), c = t("./load"), l = t("./pipeline"), u = t("./task"), h = t("./request-item"), _ = t("./downloader"), f = t("./parser"), d = t("./pack-manager"), p = t("./bundle"), m = t("./builtins"), v = t("./factory"), y = t("./urlTransformer"), g = y.parse, x = y.combine, A = t("./utilities"), C = A.parseParameters, b = A.asyncify, S = t("./shared"), T = S.assets, w = S.files, E = S.parsed, B = S.pipeline, M = S.transformPipeline, R = S.fetchPipeline, P = S.RequestType, I = S.bundles, D = S.BuiltinBundleName;
        function V() {
            this._preprocessPipe = i, this._fetchPipe = n, this._loadPipe = c, this.pipeline = B.append(i).append(c), 
            this.fetchPipeline = R.append(i).append(n), this.transformPipeline = M.append(g).append(x), 
            this.bundles = I, this.assets = T, this._files = w, this._parsed = E, this.generalImportBase = "", 
            this.generalNativeBase = "", this.dependUtil = a, this._releaseManager = o, this.cacheAsset = !0, 
            this.force = !1, this.utils = s, this.downloader = _, this.parser = f, this.builtins = m, 
            this.packManager = d, this.factory = v, this.cacheManager = null, this.presets = {
                default: {
                    priority: 0
                },
                preload: {
                    maxConcurrency: 2,
                    maxRequestsPerFrame: 2,
                    priority: -1
                },
                scene: {
                    maxConcurrency: 8,
                    maxRequestsPerFrame: 8,
                    priority: 1
                },
                bundle: {
                    maxConcurrency: 8,
                    maxRequestsPerFrame: 8,
                    priority: 2
                },
                remote: {
                    maxRetryCount: 4
                },
                script: {
                    maxConcurrency: 1024,
                    maxRequestsPerFrame: 1024,
                    priority: 2
                }
            };
        }
        V.Pipeline = l, V.Task = u, V.Cache = r, V.RequestItem = h, V.Bundle = p, V.BuiltinBundleName = D, 
        V.prototype = {
            constructor: V,
            get main() {
                return I.get(D.MAIN);
            },
            get resources() {
                return I.get(D.RESOURCES);
            },
            get internal() {
                return I.get(D.INTERNAL);
            },
            init: function(t) {
                t = t || Object.create(null), this._files.clear(), this._parsed.clear(), this._releaseManager.init(), 
                this.assets.clear(), this.bundles.clear(), this.packManager.init(), this.downloader.init(t.bundleVers, t.server), 
                this.parser.init(), this.dependUtil.init(), this.generalImportBase = t.importBase, 
                this.generalNativeBase = t.nativeBase;
            },
            getBundle: function(t) {
                return I.get(t);
            },
            removeBundle: function(t) {
                t._destroy(), I.remove(t.name);
            },
            loadAny: function(t, e, i, n) {
                var r = C(e, i, n);
                e = r.options, i = r.onProgress, n = r.onComplete, e.preset = e.preset || "default", 
                t = Array.isArray(t) ? t.concat() : t;
                var s = new u({
                    input: t,
                    onProgress: i,
                    onComplete: b(n),
                    options: e
                });
                B.async(s);
            },
            preloadAny: function(t, e, i, n) {
                var r = C(e, i, n);
                e = r.options, i = r.onProgress, n = r.onComplete, e.preset = e.preset || "preload", 
                t = Array.isArray(t) ? t.concat() : t;
                var s = new u({
                    input: t,
                    onProgress: i,
                    onComplete: b(n),
                    options: e
                });
                R.async(s);
            },
            postLoadNative: function(t, e, i) {
                if (!(t instanceof cc.Asset)) throw new Error("input is not asset");
                var n = C(e, void 0, i);
                if (e = n.options, i = n.onComplete, !t._native || t._nativeAsset) return b(i)(null);
                var r = a.getNativeDep(t._uuid);
                if (r) {
                    if (!I.has(r.bundle)) {
                        var s = I.find(function(e) {
                            return e.getAssetInfo(t._uuid);
                        });
                        s && (r.bundle = s.name);
                    }
                    this.loadAny(r, e, function(e, n) {
                        e ? cc.error(e.message, e.stack) : !t._nativeAsset && (t._nativeAsset = n), i && i(e);
                    });
                }
            },
            loadRemote: function(t, e, i) {
                var n = C(e, void 0, i);
                if (e = n.options, i = n.onComplete, this.assets.has(t)) return b(i)(null, this.assets.get(t));
                e.__isNative__ = !0, e.preset = e.preset || "remote", this.loadAny({
                    url: t
                }, e, null, function(n, r) {
                    n ? (cc.error(n.message, n.stack), i && i(n, null)) : v.create(t, r, e.ext || cc.path.extname(t), e, function(t, e) {
                        i && i(t, e);
                    });
                });
            },
            loadScript: function(t, e, i) {
                var n = C(e, void 0, i);
                e = n.options, i = n.onComplete, e.__requestType__ = P.URL, e.preset = e.preset || "script", 
                this.loadAny(t, e, i);
            },
            loadBundle: function(t, e, i) {
                var n = C(e, void 0, i), r = (e = n.options, i = n.onComplete, cc.path.basename(t));
                if (this.bundles.has(r)) return b(i)(null, this.getBundle(r));
                e.preset = e.preset || "bundle", e.ext = "bundle", this.loadRemote(t, e, i);
            },
            releaseAsset: function(t) {
                o.tryRelease(t, !0);
            },
            releaseUnusedAssets: function() {
                T.forEach(function(t) {
                    o.tryRelease(t);
                });
            },
            releaseAll: function() {
                T.forEach(function(t) {
                    o.tryRelease(t, !0);
                });
            },
            _transform: function(t, e) {
                var i = u.create({
                    input: t,
                    options: e
                }), n = [];
                try {
                    for (var r = M.sync(i), s = 0, o = r.length; s < o; s++) {
                        var a = r[s], c = a.url;
                        a.recycle(), n.push(c);
                    }
                } catch (l) {
                    for (s = 0, o = i.output.length; s < o; s++) i.output[s].recycle();
                    cc.error(l.message, l.stack);
                }
                return i.recycle(), n.length > 1 ? n : n[0];
            }
        }, cc.AssetManager = V, cc.assetManager = new V(), Object.defineProperty(cc, "resources", {
            get: function() {
                return I.get(D.RESOURCES);
            }
        }), e.exports = cc.assetManager;
    }, {
        "./builtins": 30,
        "./bundle": 31,
        "./cache": 32,
        "./depend-util": 34,
        "./downloader": 41,
        "./factory": 42,
        "./fetch": 43,
        "./helper": 45,
        "./load": 47,
        "./pack-manager": 48,
        "./parser": 49,
        "./pipeline": 50,
        "./preprocess": 51,
        "./releaseManager": 52,
        "./request-item": 53,
        "./shared": 54,
        "./task": 55,
        "./urlTransformer": 56,
        "./utilities": 57
    } ],
    30: [ function(t, e) {
        "use strict";
        var i = t("./cache"), n = t("./releaseManager"), r = t("./shared").BuiltinBundleName, s = {
            _assets: new i({
                material: new i(),
                effect: new i()
            }),
            _loadBuiltins: function(t, e) {
                var i = t + "s", n = this._assets.get(t);
                return cc.assetManager.internal.loadDir(i, null, null, function(t, i) {
                    if (t) cc.error(t.message, t.stack); else for (var r = 0; r < i.length; r++) {
                        var s = i[r];
                        n.add(s.name, s.addRef());
                    }
                    e();
                });
            },
            init: function(t) {
                var e = this;
                if (this.clear(), cc.game.renderType === cc.game.RENDER_TYPE_CANVAS || !cc.assetManager.bundles.has(r.INTERNAL)) return t && t();
                this._loadBuiltins("effect", function() {
                    e._loadBuiltins("material", t);
                });
            },
            getBuiltin: function(t, e) {
                return 0 === arguments.length ? this._assets : 1 === arguments.length ? this._assets.get(t) : this._assets.get(t).get(e);
            },
            clear: function() {
                this._assets.forEach(function(t) {
                    t.forEach(function(t) {
                        n.tryRelease(t, !0);
                    }), t.clear();
                });
            }
        };
        e.exports = s;
    }, {
        "./cache": 32,
        "./releaseManager": 52,
        "./shared": 54
    } ],
    31: [ function(t, e) {
        "use strict";
        var i = t("./config"), n = t("./releaseManager"), r = t("./utilities"), s = r.parseParameters, o = r.parseLoadResArgs, a = t("./shared"), c = a.RequestType, l = a.assets, u = a.bundles;
        function h() {
            this._config = new i();
        }
        h.prototype = {
            constructor: h,
            get name() {
                return this._config.name;
            },
            get deps() {
                return this._config.deps;
            },
            get base() {
                return this._config.base;
            },
            getInfoWithPath: function(t, e) {
                return this._config.getInfoWithPath(t, e);
            },
            getDirWithPath: function(t, e, i) {
                return this._config.getDirWithPath(t, e, i);
            },
            getAssetInfo: function(t) {
                return this._config.getAssetInfo(t);
            },
            getSceneInfo: function(t) {
                return this._config.getSceneInfo(t);
            },
            init: function(t) {
                this._config.init(t), u.add(t.name, this);
            },
            load: function(t, e, i, n) {
                var r = o(e, i, n);
                e = r.type, i = r.onProgress, n = r.onComplete, cc.assetManager.loadAny(t, {
                    __requestType__: c.PATH,
                    type: e,
                    bundle: this.name,
                    __outputAsArray__: Array.isArray(t)
                }, i, n);
            },
            preload: function(t, e, i, n) {
                var r = o(e, i, n);
                e = r.type, i = r.onProgress, n = r.onComplete, cc.assetManager.preloadAny(t, {
                    __requestType__: c.PATH,
                    type: e,
                    bundle: this.name
                }, i, n);
            },
            loadDir: function(t, e, i, n) {
                var r = o(e, i, n);
                e = r.type, i = r.onProgress, n = r.onComplete, cc.assetManager.loadAny(t, {
                    __requestType__: c.DIR,
                    type: e,
                    bundle: this.name,
                    __outputAsArray__: !0
                }, i, n);
            },
            preloadDir: function(t, e, i, n) {
                var r = o(e, i, n);
                e = r.type, i = r.onProgress, n = r.onComplete, cc.assetManager.preloadAny(t, {
                    __requestType__: c.DIR,
                    type: e,
                    bundle: this.name
                }, i, n);
            },
            loadScene: function(t, e, i, n) {
                var r = s(e, i, n);
                e = r.options, i = r.onProgress, n = r.onComplete, e.preset = e.preset || "scene", 
                e.bundle = this.name, cc.assetManager.loadAny({
                    scene: t
                }, e, i, function(t, e) {
                    if (t) cc.error(t.message, t.stack), n && n(t); else if (e instanceof cc.SceneAsset) {
                        var i = e.scene;
                        i._id = e._uuid, i._name = e._name, n && n(null, e);
                    } else n && n(new Error("The asset " + e._uuid + " is not a scene"));
                });
            },
            preloadScene: function(t, e, i, n) {
                var r = s(e, i, n);
                e = r.options, i = r.onProgress, n = r.onComplete, e.bundle = this.name, cc.assetManager.preloadAny({
                    scene: t
                }, e, i, function(e) {
                    e && cc.errorID(1210, t, e.message), n && n(e);
                });
            },
            get: function(t, e) {
                var i = this.getInfoWithPath(t, e);
                return l.get(i && i.uuid);
            },
            release: function(t, e) {
                n.tryRelease(this.get(t, e), !0);
            },
            releaseUnusedAssets: function() {
                var t = this;
                l.forEach(function(e) {
                    var i = t.getAssetInfo(e._uuid);
                    i && !i.redirect && n.tryRelease(e);
                });
            },
            releaseAll: function() {
                var t = this;
                l.forEach(function(e) {
                    var i = t.getAssetInfo(e._uuid);
                    i && !i.redirect && n.tryRelease(e, !0);
                });
            },
            _destroy: function() {
                this._config.destroy();
            }
        }, e.exports = h;
    }, {
        "./config": 33,
        "./releaseManager": 52,
        "./shared": 54,
        "./utilities": 57
    } ],
    32: [ function(t, e) {
        "use strict";
        var i = t("../platform/js");
        function n(t) {
            t ? (this._map = t, this._count = Object.keys(t).length) : (this._map = i.createMap(!0), 
            this._count = 0);
        }
        n.prototype = {
            constructor: n,
            add: function(t, e) {
                return t in this._map || this._count++, this._map[t] = e;
            },
            get: function(t) {
                return this._map[t];
            },
            has: function(t) {
                return t in this._map;
            },
            remove: function(t) {
                var e = this._map[t];
                return t in this._map && (delete this._map[t], this._count--), e;
            },
            clear: function() {
                0 !== this._count && (this._map = i.createMap(!0), this._count = 0);
            },
            forEach: function(t) {
                for (var e in this._map) t(this._map[e], e);
            },
            find: function(t) {
                for (var e in this._map) if (t(this._map[e], e)) return this._map[e];
                return null;
            },
            get count() {
                return this._count;
            },
            destroy: function() {
                this._map = null;
            }
        }, e.exports = n;
    }, {
        "../platform/js": 203
    } ],
    33: [ function(t, e) {
        "use strict";
        var i = t("../platform/js"), n = t("./cache"), r = t("./helper").normalize, s = t("./utilities").processOptions;
        function o() {
            this.name = "", this.base = "", this.importBase = "", this.nativeBase = "", this.deps = null, 
            this.assetInfos = new n(), this.scenes = new n(), this.paths = new n();
        }
        o.prototype = {
            constructor: o,
            init: function(t) {
                s(t), this.importBase = t.importBase || "", this.nativeBase = t.nativeBase || "", 
                this.base = t.base || "", this.name = t.name || "", this.deps = t.deps || [], this._initUuid(t.uuids), 
                this._initPath(t.paths), this._initScene(t.scenes), this._initPackage(t.packs), 
                this._initVersion(t.versions), this._initRedirect(t.redirect);
            },
            _initUuid: function(t) {
                if (t) {
                    this.assetInfos.clear();
                    for (var e = 0, i = t.length; e < i; e++) {
                        var n = t[e];
                        this.assetInfos.add(n, {
                            uuid: n
                        });
                    }
                }
            },
            _initPath: function(t) {
                if (t) {
                    var e = this.paths;
                    for (var n in e.clear(), t) {
                        var r = t[n], s = r[0], o = r[1], a = 3 === r.length, c = this.assetInfos.get(n);
                        c.path = s, c.ctor = i._getClassById(o), e.has(s) ? a ? e.get(s).push(c) : e.get(s).splice(0, 0, c) : e.add(s, [ c ]);
                    }
                }
            },
            _initScene: function(t) {
                if (t) {
                    var e = this.scenes;
                    e.clear();
                    var i = this.assetInfos;
                    for (var n in t) {
                        var r = t[n], s = i.get(r);
                        s.url = n, e.add(n, s);
                    }
                }
            },
            _initPackage: function(t) {
                if (t) {
                    var e = this.assetInfos;
                    for (var i in t) {
                        var n = t[i], r = {
                            uuid: i,
                            packs: n,
                            ext: ".json"
                        };
                        e.add(i, r);
                        for (var s = 0, o = n.length; s < o; s++) {
                            var a = n[s], c = e.get(a), l = c.packs;
                            l ? 1 === o ? l.splice(0, 0, r) : l.push(r) : c.packs = [ r ];
                        }
                    }
                }
            },
            _initVersion: function(t) {
                if (t) {
                    var e = this.assetInfos, i = t.import;
                    if (i) for (var n = 0, r = i.length; n < r; n += 2) {
                        var s = i[n];
                        e.get(s).ver = i[n + 1];
                    }
                    if (i = t.native) for (n = 0, r = i.length; n < r; n += 2) s = i[n], e.get(s).nativeVer = i[n + 1];
                }
            },
            _initRedirect: function(t) {
                if (t) for (var e = this.assetInfos, i = 0, n = t.length; i < n; i += 2) {
                    var r = t[i];
                    e.get(r).redirect = t[i + 1];
                }
            },
            getInfoWithPath: function(t, e) {
                if (!t) return null;
                t = r(t);
                var n = this.paths.get(t);
                if (n) {
                    if (!e) return n[0];
                    for (var s = 0, o = n.length; s < o; s++) {
                        var a = n[s];
                        if (i.isChildClassOf(a.ctor, e)) return a;
                    }
                }
                return null;
            },
            getDirWithPath: function(t, e, n) {
                "/" === (t = r(t))[t.length - 1] && (t = t.slice(0, -1));
                var s = n || [];
                function o(t, e) {
                    return !(t.length > e.length) || 47 === t.charCodeAt(e.length);
                }
                return this.paths.forEach(function(n, r) {
                    if (r.startsWith(t) && o(r, t) || !t) for (var a = 0, c = n.length; a < c; a++) {
                        var l = n[a];
                        e && !i.isChildClassOf(l.ctor, e) || s.push(l);
                    }
                }), s;
            },
            getAssetInfo: function(t) {
                return this.assetInfos.get(t);
            },
            getSceneInfo: function(t) {
                return t.endsWith(".fire") || (t += ".fire"), "/" === t[0] || t.startsWith("db://") || (t = "/" + t), 
                this.scenes.find(function(e, i) {
                    return i.endsWith(t);
                });
            },
            destroy: function() {
                this.paths.destroy(), this.scenes.destroy(), this.assetInfos.destroy();
            }
        }, e.exports = o;
    }, {
        "../platform/js": 203,
        "./cache": 32,
        "./helper": 45,
        "./utilities": 57
    } ],
    34: [ function(t, e) {
        "use strict";
        var i = function(t) {
            if (t && t.__esModule) return t;
            if (null === t || "object" != typeof t && "function" != typeof t) return {
                default: t
            };
            var e = n();
            if (e && e.has(t)) return e.get(t);
            var i = {}, r = Object.defineProperty && Object.getOwnPropertyDescriptor;
            for (var s in t) if (Object.prototype.hasOwnProperty.call(t, s)) {
                var o = r ? Object.getOwnPropertyDescriptor(t, s) : null;
                o && (o.get || o.set) ? Object.defineProperty(i, s, o) : i[s] = t[s];
            }
            return i.default = t, e && e.set(t, i), i;
        }(t("../platform/deserialize-compiled"));
        function n() {
            if ("function" != typeof WeakMap) return null;
            var t = new WeakMap();
            return n = function() {
                return t;
            }, t;
        }
        var r = t("./cache"), s = t("./deserialize"), o = t("./shared"), a = o.files, c = o.parsed, l = {
            _depends: new r(),
            init: function() {
                this._depends.clear();
            },
            getNativeDep: function(t) {
                var e = this._depends.get(t);
                return e ? e.nativeDep && Object.assign({}, e.nativeDep) : null;
            },
            getDeps: function(t) {
                return this._depends.has(t) ? this._depends.get(t).deps : [];
            },
            getDepsRecursively: function(t) {
                var e = Object.create(null), i = [];
                return this._descend(t, e, i), i;
            },
            _descend: function(t, e, i) {
                for (var n = this.getDeps(t), r = 0; r < n.length; r++) {
                    var s = n[r];
                    e[s] || (e[s] = !0, i.push(s), this._descend(s, e, i));
                }
            },
            remove: function(t) {
                this._depends.remove(t);
            },
            parse: function(t, e) {
                var n = null;
                if (Array.isArray(e) || e.__type__) {
                    if (n = this._depends.get(t)) return n;
                    if (Array.isArray(e) && !(0, i.hasNativeDep)(e)) n = {
                        deps: this._parseDepsFromJson(e)
                    }; else try {
                        var r = s(e);
                        (n = this._parseDepsFromAsset(r)).nativeDep && (n.nativeDep.uuid = t), c.add(t + "@import", r);
                    } catch (o) {
                        a.remove(t + "@import"), n = {
                            deps: []
                        };
                    }
                } else {
                    if ((n = this._depends.get(t)) && n.parsedFromExistAsset) return n;
                    n = this._parseDepsFromAsset(e);
                }
                return this._depends.add(t, n), n;
            },
            _parseDepsFromAsset: function(t) {
                for (var e = {
                    deps: [],
                    parsedFromExistAsset: !0,
                    preventPreloadNativeObject: t.constructor.preventPreloadNativeObject,
                    preventDeferredLoadDependents: t.constructor.preventDeferredLoadDependents
                }, i = t.__depends__, n = 0, r = i.length; n < r; n++) {
                    var s = i[n].uuid;
                    e.deps.push(s);
                }
                return t.__nativeDepend__ && (e.nativeDep = t._nativeDep), e;
            },
            _parseDepsFromJson: function(t) {
                var e = (0, i.getDependUuidList)(t);
                return e.forEach(function(t, i) {
                    return e[i] = cc.assetManager.utils.decodeUuid(t);
                }), e;
            }
        };
        e.exports = l;
    }, {
        "../platform/deserialize-compiled": 197,
        "./cache": 32,
        "./deserialize": 36,
        "./shared": 54
    } ],
    35: [ function(t) {
        "use strict";
        var e = t("../platform/js");
        t("../CCDirector");
        var i = t("./utilities"), n = t("./depend-util"), r = t("./releaseManager"), s = t("./downloader"), o = t("./factory"), a = [ ".png", ".jpg", ".bmp", ".jpeg", ".gif", ".ico", ".tiff", ".webp", ".image", ".pvr", ".pkm" ], c = [ ".mp3", ".ogg", ".wav", ".m4a" ];
        function l() {
            return !0;
        }
        var u = {
            transformURL: function(t) {
                return t = t.replace(/.*[\/\\][0-9a-fA-F]{2}[\/\\]([0-9a-fA-F-]{8,})/, function(e, i) {
                    var n = cc.assetManager.bundles.find(function(t) {
                        return t.getAssetInfo(i);
                    }), r = "";
                    if (n) {
                        var s = n.getAssetInfo(i);
                        r = t.startsWith(n.base + n._config.nativeBase) ? s.nativeVer : s.ver;
                    }
                    return r ? e + "." + r : e;
                });
            }
        }, h = {
            onProgress: null,
            _autoReleaseSetting: Object.create(null),
            get _cache() {
                return cc.assetManager.assets._map;
            },
            load: function(t, e, i) {
                void 0 === i && void 0 !== e && (i = e, e = null), t = Array.isArray(t) ? t : [ t ];
                for (var n = 0; n < t.length; n++) {
                    var r = t[n];
                    "string" == typeof r ? t[n] = {
                        url: r,
                        __isNative__: !0
                    } : (r.type && (r.ext = "." + r.type, r.type = void 0), r.url && (r.__isNative__ = !0));
                }
                var s = [], u = [];
                cc.assetManager.loadAny(t, null, function(t, i, n) {
                    n.content && (a.includes(n.ext) ? s.push(n.content) : c.includes(n.ext) && u.push(n.content)), 
                    e && e(t, i, n);
                }, function(e, n) {
                    var r = null;
                    if (!e) {
                        n = Array.isArray(n) ? n : [ n ];
                        for (var a = 0; a < n.length; a++) {
                            var c = n[a];
                            if (!(c instanceof cc.Asset)) {
                                var h = c, _ = t[a].url;
                                s.includes(h) ? o.create(_, c, ".png", null, function(t, e) {
                                    h = n[a] = e;
                                }) : u.includes(h) && o.create(_, c, ".mp3", null, function(t, e) {
                                    h = n[a] = e;
                                }), cc.assetManager.assets.add(_, h);
                            }
                        }
                        if (n.length > 1) {
                            var f = Object.create(null);
                            n.forEach(function(t) {
                                f[t._uuid] = t;
                            }), r = {
                                isCompleted: l,
                                _map: f
                            };
                        } else r = n[0];
                    }
                    i && i(e, r);
                });
            },
            getXMLHttpRequest: function() {
                return new XMLHttpRequest();
            },
            _parseLoadResArgs: i.parseLoadResArgs,
            getItem: function(t) {
                return cc.assetManager.assets.has(t) ? {
                    content: cc.assetManager.assets.get(t)
                } : null;
            },
            loadRes: function(t, e, i, n) {
                var r = this._parseLoadResArgs(e, i, n), s = (e = r.type, r.onProgress), o = r.onComplete, a = cc.path.extname(t);
                a && (t = t.slice(0, -a.length)), cc.resources.load(t, e, s, o);
            },
            loadResArray: function(t, e, i, n) {
                var r = this._parseLoadResArgs(e, i, n), s = (e = r.type, r.onProgress), o = r.onComplete;
                t.forEach(function(e, i) {
                    var n = cc.path.extname(e);
                    n && (t[i] = e.slice(0, -n.length));
                }), cc.resources.load(t, e, s, o);
            },
            loadResDir: function(t, e, i, n) {
                var r = this._parseLoadResArgs(e, i, n), s = (e = r.type, r.onProgress), o = r.onComplete;
                cc.resources.loadDir(t, e, s, function(i, n) {
                    var r = [];
                    i || (r = cc.resources.getDirWithPath(t, e).map(function(t) {
                        return t.path;
                    })), o && o(i, n, r);
                });
            },
            getRes: function(t, e) {
                return cc.assetManager.assets.has(t) ? cc.assetManager.assets.get(t) : cc.resources.get(t, e);
            },
            getResCount: function() {
                return cc.assetManager.assets.count;
            },
            getDependsRecursively: function(t) {
                return t ? n.getDepsRecursively("string" == typeof t ? t : t._uuid).concat([ t._uuid ]) : [];
            },
            get assetLoader() {},
            get md5Pipe() {
                return u;
            },
            get downloader() {
                return cc.assetManager.downloader;
            },
            get loader() {
                return cc.assetManager.parser;
            },
            addDownloadHandlers: function(t) {
                var e = Object.create(null);
                for (var i in t) {
                    var n = t[i];
                    e["." + i] = function(t, e, i) {
                        n({
                            url: t
                        }, i);
                    };
                }
                cc.assetManager.downloader.register(e);
            },
            addLoadHandlers: function(t) {
                var e = Object.create(null);
                for (var i in t) {
                    var n = t[i];
                    e["." + i] = function(t, e, i) {
                        n({
                            content: t
                        }, i);
                    };
                }
                cc.assetManager.parser.register(e);
            },
            flowInDeps: function() {},
            release: function(t) {
                if (Array.isArray(t)) for (var e = 0; e < t.length; e++) {
                    var i = t[e];
                    "string" == typeof i && (i = cc.assetManager.assets.get(i)), cc.assetManager.builtins._assets.find(function(t) {
                        return t.find(function(t) {
                            return t === i;
                        });
                    }) || cc.assetManager.releaseAsset(i);
                } else if (t) {
                    if ("string" == typeof t && (t = cc.assetManager.assets.get(t)), cc.assetManager.builtins._assets.find(function(e) {
                        return e.find(function(e) {
                            return e === t;
                        });
                    })) return;
                    cc.assetManager.releaseAsset(t);
                }
            },
            releaseAsset: function(t) {
                cc.assetManager.releaseAsset(t);
            },
            releaseRes: function(t, e) {
                cc.resources.release(t, e);
            },
            releaseResDir: function() {},
            releaseAll: function() {
                cc.assetManager.releaseAll(), cc.assetManager.assets.clear();
            },
            removeItem: function(t) {
                cc.assetManager.assets.remove(t);
            },
            setAutoRelease: function(t, e) {
                "object" == typeof t && (t = t._uuid), this._autoReleaseSetting[t] = !!e;
            },
            setAutoReleaseRecursively: function(t, e) {
                "object" == typeof t && (t = t._uuid), e = !!e, this._autoReleaseSetting[t] = e;
                for (var i = n.getDepsRecursively(t), r = 0; r < i.length; r++) {
                    var s = i[r];
                    this._autoReleaseSetting[s] = e;
                }
            },
            isAutoRelease: function(t) {
                return "object" == typeof t && (t = t._uuid), !!this._autoReleaseSetting[t];
            }
        };
        s.loadSubpackage = function(t, e) {
            cc.assetManager.loadBundle(t, null, e);
        };
        var _ = {
            init: function(t) {
                t.importBase = t.libraryPath, t.nativeBase = t.rawAssetsBase, cc.assetManager.init(t), 
                t.rawAssets && new cc.AssetManager.Bundle().init({
                    name: cc.AssetManager.BuiltinBundleName.RESOURCES,
                    importBase: t.importBase,
                    nativeBase: t.nativeBase,
                    paths: t.rawAssets.assets,
                    uuids: Object.keys(t.rawAssets.assets)
                });
            },
            loadAsset: function(t, e) {
                cc.assetManager.loadAny(t, e);
            },
            getLibUrlNoExt: function() {},
            queryAssetInfo: function() {}
        };
        cc.url = {
            normalize: function(t) {
                return cc.warnID(1400, "cc.url.normalize", "cc.assetManager.utils.normalize"), cc.assetManager.utils.normalize(t);
            },
            raw: function(t) {
                return cc.warnID(1400, "cc.url.raw", "cc.resources.load"), t.startsWith("resources/") ? cc.assetManager._transform({
                    path: cc.path.changeExtname(t.substr(10)),
                    bundle: cc.AssetManager.BuiltinBundleName.RESOURCES,
                    __isNative__: !0,
                    ext: cc.path.extname(t)
                }) : "";
            }
        }, Object.defineProperties(cc, {
            loader: {
                get: function() {
                    return h;
                }
            },
            AssetLibrary: {
                get: function() {
                    return _;
                }
            },
            LoadingItems: {
                get: function() {
                    return cc.warnID(1400, "cc.LoadingItems", "cc.AssetManager.Task"), cc.AssetManager.Task;
                }
            },
            Pipeline: {
                get: function() {
                    return cc.warnID(1400, "cc.Pipeline", "cc.AssetManager.Pipeline"), cc.AssetManager.Pipeline;
                }
            }
        }), e.obsolete(cc, "cc.RawAsset", "cc.Asset"), e.obsolete(cc.Asset.prototype, "cc.Asset.url", "nativeUrl"), 
        Object.defineProperties(cc.macro, {
            DOWNLOAD_MAX_CONCURRENT: {
                get: function() {
                    return cc.assetManager.downloader.maxConcurrency;
                },
                set: function(t) {
                    cc.assetManager.downloader.maxConcurrency = t;
                }
            }
        }), Object.assign(cc.director, {
            _getSceneUuid: function(t) {
                cc.assetManager.main.getSceneInfo(t);
            }
        }), Object.defineProperties(cc.game, {
            _sceneInfos: {
                get: function() {
                    var t = [];
                    return cc.assetManager.main._config.scenes.forEach(function(e) {
                        t.push(e);
                    }), t;
                }
            }
        });
        var f = i.parseParameters;
        i.parseParameters = function(t, e, i) {
            var n = f(t, e, i);
            return n.onProgress = n.onProgress || h.onProgress, n;
        };
        var d = r._autoRelease;
        r._autoRelease = function() {
            d.apply(this, arguments);
            for (var t = h._autoReleaseSetting, e = Object.keys(t), i = 0; i < e.length; i++) {
                var n = e[i];
                if (!0 === t[n]) {
                    var s = cc.assetManager.assets.get(n);
                    s && r.tryRelease(s);
                }
            }
        };
    }, {
        "../CCDirector": 23,
        "../platform/js": 203,
        "./depend-util": 34,
        "./downloader": 41,
        "./factory": 42,
        "./releaseManager": 52,
        "./utilities": 57
    } ],
    36: [ function(t, e) {
        "use strict";
        var i = t("./helper");
        t("../platform/deserialize"), e.exports = function(t, e) {
            var n;
            n = cc._MissingScript.safeFindClass;
            var r, s = null, o = (s = cc.deserialize.Details.pool).get();
            try {
                r = cc.deserialize(t, o, {
                    classFinder: n,
                    customEnv: e
                });
            } catch (f) {
                throw s.put(o), f;
            }
            for (var a = o.uuidList, c = o.uuidObjList, l = o.uuidPropList, u = [], h = 0; h < a.length; h++) {
                var _ = a[h];
                u[h] = {
                    uuid: i.decodeUuid(_),
                    owner: c[h],
                    prop: l[h]
                };
            }
            return r.__depends__ = u, r._native && (r.__nativeDepend__ = !0), s.put(o), r;
        };
    }, {
        "../platform/deserialize": 198,
        "../platform/deserialize-compiled": 197,
        "../platform/deserialize-editor": void 0,
        "./helper": 45
    } ],
    37: [ function(t, e) {
        "use strict";
        var i = cc.sys.__audioSupport, n = t("./utilities").parseParameters;
        e.exports = function(t, e, r) {
            var s = n(e, void 0, r), o = (e = s.options, r = s.onComplete, document.createElement("audio"));
            o.src = t;
            var a = function() {
                clearTimeout(c), o.removeEventListener("canplaythrough", l, !1), o.removeEventListener("error", u, !1), 
                i.USE_LOADER_EVENT && o.removeEventListener(i.USE_LOADER_EVENT, l, !1);
            }, c = setTimeout(function() {
                0 === o.readyState ? u() : l();
            }, 8e3), l = function() {
                a(), r && r(null, o);
            }, u = function() {
                a();
                var e = "load audio failure - " + t;
                cc.log(e), r && r(new Error(e));
            };
            return o.addEventListener("canplaythrough", l, !1), o.addEventListener("error", u, !1), 
            i.USE_LOADER_EVENT && o.addEventListener(i.USE_LOADER_EVENT, l, !1), o;
        };
    }, {
        "./utilities": 57
    } ],
    38: [ function(t, e) {
        "use strict";
        var i = t("./utilities").parseParameters;
        e.exports = function(t, e, n) {
            var r = i(e, void 0, n), s = (e = r.options, n = r.onComplete, new Image());
            function o() {
                s.removeEventListener("load", o), s.removeEventListener("error", a), n && n(null, s);
            }
            function a() {
                s.removeEventListener("load", o), s.removeEventListener("error", a), n && n(new Error(cc.debug.getError(4930, t)));
            }
            return "file:" !== window.location.protocol && (s.crossOrigin = "anonymous"), s.addEventListener("load", o), 
            s.addEventListener("error", a), s.src = t, s;
        };
    }, {
        "./utilities": 57
    } ],
    39: [ function(t, e) {
        "use strict";
        var i = t("./utilities").parseParameters;
        e.exports = function(t, e, n, r) {
            var s = i(e, n, r), o = (e = s.options, n = s.onProgress, r = s.onComplete, new XMLHttpRequest()), a = "download failed: " + t + ", status: ";
            if (o.open("GET", t, !0), void 0 !== e.responseType && (o.responseType = e.responseType), 
            void 0 !== e.withCredentials && (o.withCredentials = e.withCredentials), void 0 !== e.mimeType && o.overrideMimeType && o.overrideMimeType(e.mimeType), 
            void 0 !== e.timeout && (o.timeout = e.timeout), e.header) for (var c in e.header) o.setRequestHeader(c, e.header[c]);
            return o.onload = function() {
                200 === o.status || 0 === o.status ? r && r(null, o.response) : r && r(new Error(a + o.status + "(no response)"));
            }, n && (o.onprogress = function(t) {
                t.lengthComputable && n(t.loaded, t.total);
            }), o.onerror = function() {
                r && r(new Error(a + o.status + "(error)"));
            }, o.ontimeout = function() {
                r && r(new Error(a + o.status + "(time out)"));
            }, o.onabort = function() {
                r && r(new Error(a + o.status + "(abort)"));
            }, o.send(null), o;
        };
    }, {
        "./utilities": 57
    } ],
    40: [ function(t, e) {
        "use strict";
        var i = t("./utilities").parseParameters, n = {};
        e.exports = function(t, e, r) {
            var s = i(e, void 0, r);
            if (e = s.options, r = s.onComplete, n[t]) return r && r(null);
            var o = document, a = document.createElement("script");
            function c() {
                a.parentNode.removeChild(a), a.removeEventListener("load", c, !1), a.removeEventListener("error", l, !1), 
                n[t] = !0, r && r(null);
            }
            function l() {
                a.parentNode.removeChild(a), a.removeEventListener("load", c, !1), a.removeEventListener("error", l, !1), 
                r && r(new Error(cc.debug.getError(4928, t)));
            }
            "file:" !== window.location.protocol && (a.crossOrigin = "anonymous"), a.async = e.async, 
            a.src = t, a.addEventListener("load", c, !1), a.addEventListener("error", l, !1), 
            o.body.appendChild(a);
        };
    }, {
        "./utilities": 57
    } ],
    41: [ function(t, e) {
        "use strict";
        var i = t("../platform/js"), n = t("../CCDebug"), r = t("./font-loader").loadFont, s = t("../platform/utils").callInNextTick, o = t("./download-dom-image"), a = t("./download-dom-audio"), c = t("./download-file"), l = t("./download-script.js"), u = t("./cache"), h = t("./shared").files, _ = t("../platform/CCSys"), f = _.__audioSupport, d = _.capabilities, p = t("./utilities"), m = p.urlAppendTimestamp, v = p.retry, y = /^\w+:\/\/.*/, g = function(t, e, i) {
            e.audioLoadMode !== cc.AudioClip.LoadMode.DOM_AUDIO ? b(t, e, i) : a(t, e, i);
        }, x = (g = 0 === (f.format || []).length ? function(t, e, i) {
            i(new Error(n.getError(4927)));
        } : f.WEB_AUDIO ? g : a, function() {
            var t = d.imageBitmap && cc.macro.ALLOW_IMAGE_BITMAP ? A : o;
            t.apply(this, arguments);
        }), A = function(t, e, i) {
            e.responseType = "blob", c(t, e, e.onFileProgress, i);
        }, C = function(t, e, i) {
            e.responseType = "json", c(t, e, e.onFileProgress, function(t, e) {
                if (!t && "string" == typeof e) try {
                    e = JSON.parse(e);
                } catch (n) {
                    t = n;
                }
                i && i(t, e);
            });
        }, b = function(t, e, i) {
            e.responseType = "arraybuffer", c(t, e, e.onFileProgress, i);
        }, S = function(t, e, i) {
            e.responseType = "text", c(t, e, e.onFileProgress, i);
        }, T = function(t, e, i) {
            i(null, t);
        }, w = new u(), E = [], B = !1, M = 0, R = 0, P = -1, I = !1, D = function() {
            var t = Date.now();
            t - P > 1e3 * cc.director._deltaTime && (R = 0, P = t);
        }, V = function t(e, i) {
            for (I = !1, D(); E.length > 0 && M < e && R < i; ) {
                B && (E.sort(function(t, e) {
                    return t.priority - e.priority;
                }), B = !1);
                var n = E.pop();
                if (!n) break;
                M++, R++, n.invoke();
            }
            E.length > 0 && M < e && (s(t, e, i), I = !0);
        }, L = {
            _remoteServerAddress: "",
            get remoteServerAddress() {
                return this._remoteServerAddress;
            },
            maxConcurrency: 6,
            maxRequestsPerFrame: 6,
            maxRetryCount: 3,
            appendTimeStamp: !1,
            limited: !0,
            retryInterval: 2e3,
            bundleVers: null,
            downloadDomImage: o,
            downloadDomAudio: a,
            downloadFile: c,
            downloadScript: l,
            init: function(t, e) {
                w.clear(), E.length = 0, this._remoteServerAddress = e || "", this.bundleVers = t || Object.create(null);
            },
            register: function(t, e) {
                "object" == typeof t ? i.mixin(O, t) : O[t] = e;
            },
            download: function(t, e, i, n, r) {
                var o, a, c = O[i] || O.default, l = this;
                if (o = h.get(t)) r(null, o); else if (a = w.get(t)) {
                    a.push(r);
                    for (var u = 0, _ = E.length; u < _; u++) {
                        var f = E[u];
                        if (f.id === t) {
                            var d = n.priority || 0;
                            return void (f.priority < d && (f.priority = d, B = !0));
                        }
                    }
                } else {
                    var p = n.maxRetryCount || this.maxRetryCount, y = n.maxConcurrency || this.maxConcurrency, g = n.maxRequestsPerFrame || this.maxRequestsPerFrame;
                    v(function(i, o) {
                        if (0 === i && w.add(t, [ r ]), !l.limited) return c(m(e), n, o);
                        function a() {
                            c(m(e), n, function() {
                                M--, !I && E.length > 0 && (s(V, y, g), I = !0), o.apply(this, arguments);
                            });
                        }
                        D(), M < y && R < g ? (a(), M++, R++) : (E.push({
                            id: t,
                            priority: n.priority || 0,
                            invoke: a
                        }), B = !0, !I && M < y && (s(V, y, g), I = !0));
                    }, p, this.retryInterval, function(e, i) {
                        e || h.add(t, i);
                        for (var n = w.remove(t), r = 0, s = n.length; r < s; r++) n[r](e, i);
                    });
                }
            }
        }, O = {
            ".png": x,
            ".jpg": x,
            ".bmp": x,
            ".jpeg": x,
            ".gif": x,
            ".ico": x,
            ".tiff": x,
            ".webp": x,
            ".image": x,
            ".pvr": b,
            ".pkm": b,
            ".mp3": g,
            ".ogg": g,
            ".wav": g,
            ".m4a": g,
            ".txt": S,
            ".xml": S,
            ".vsh": S,
            ".fsh": S,
            ".atlas": S,
            ".tmx": S,
            ".tsx": S,
            ".json": C,
            ".ExportJson": C,
            ".plist": S,
            ".fnt": S,
            ".font": r,
            ".eot": r,
            ".ttf": r,
            ".woff": r,
            ".svg": r,
            ".ttc": r,
            ".mp4": T,
            ".avi": T,
            ".mov": T,
            ".mpg": T,
            ".mpeg": T,
            ".rm": T,
            ".rmvb": T,
            ".binary": b,
            ".bin": b,
            ".dbbin": b,
            ".skel": b,
            ".js": l,
            bundle: function(t, e, i) {
                var n = cc.path.basename(t), r = t;
                y.test(r) || (r = "assets/" + n);
                var s = e.version || L.bundleVers[n], o = 0, a = null, c = null;
                C(r + "/config." + (s ? s + "." : "") + "json", e, function(t, e) {
                    t && (c = t), (a = e) && (a.base = r + "/"), 2 == ++o && i(c, a);
                }), l(r + "/index." + (s ? s + "." : "") + "js", e, function(t) {
                    t && (c = t), 2 == ++o && i(c, a);
                });
            },
            default: S
        };
        e.exports = L;
    }, {
        "../CCDebug": 22,
        "../platform/CCSys": 191,
        "../platform/js": 203,
        "../platform/utils": 206,
        "./cache": 32,
        "./download-dom-audio": 37,
        "./download-dom-image": 38,
        "./download-file": 39,
        "./download-script.js": 40,
        "./font-loader": 44,
        "./shared": 54,
        "./utilities": 57
    } ],
    42: [ function(t, e) {
        "use strict";
        var i = t("./bundle"), n = t("./cache"), r = t("./shared"), s = r.assets, o = r.bundles, a = new n();
        function c(t, e, i, n) {
            var r = null, s = null;
            try {
                (r = new cc.Texture2D())._nativeUrl = t, r._nativeAsset = e;
            } catch (o) {
                s = o;
            }
            n && n(s, r);
        }
        function l(t, e, i, n) {
            var r = new cc.AudioClip();
            r._nativeUrl = t, r._nativeAsset = e, r.duration = e.duration, n && n(null, r);
        }
        function u(t, e, i, n) {
            var r = new cc.JsonAsset();
            r.json = e, n && n(null, r);
        }
        function h(t, e, i, n) {
            var r = new cc.TextAsset();
            r.text = e, n && n(null, r);
        }
        function _(t, e, i, n) {
            var r = new cc.TTFFont();
            r._nativeUrl = t, r._nativeAsset = e, n && n(null, r);
        }
        function f(t, e, i, n) {
            var r = new cc.BufferAsset();
            r._nativeUrl = t, r._nativeAsset = e, n && n(null, r);
        }
        var d = {
            register: function(t, e) {
                "object" == typeof t ? cc.js.mixin(p, t) : p[t] = e;
            },
            create: function(t, e, i, n, r) {
                var o, c, l = p[i] || p.default;
                (o = s.get(t)) ? r(null, o) : (c = a.get(t)) ? c.push(r) : (a.add(t, [ r ]), l(t, e, n, function(e, i) {
                    !e && i instanceof cc.Asset && (i._uuid = t, s.add(t, i));
                    for (var n = a.remove(t), r = 0, o = n.length; r < o; r++) n[r](e, i);
                }));
            }
        }, p = {
            ".png": c,
            ".jpg": c,
            ".bmp": c,
            ".jpeg": c,
            ".gif": c,
            ".ico": c,
            ".tiff": c,
            ".webp": c,
            ".image": c,
            ".pvr": c,
            ".pkm": c,
            ".mp3": l,
            ".ogg": l,
            ".wav": l,
            ".m4a": l,
            ".txt": h,
            ".xml": h,
            ".vsh": h,
            ".fsh": h,
            ".atlas": h,
            ".tmx": h,
            ".tsx": h,
            ".fnt": h,
            ".json": u,
            ".ExportJson": u,
            ".font": _,
            ".eot": _,
            ".ttf": _,
            ".woff": _,
            ".svg": _,
            ".ttc": _,
            ".binary": f,
            ".bin": f,
            ".dbbin": f,
            ".skel": f,
            bundle: function(t, e, n, r) {
                var s = o.get(e.name);
                s || (s = new i(), e.base = e.base || t + "/", s.init(e)), r && r(null, s);
            },
            default: function(t, e, i, n) {
                var r = new cc.Asset();
                r._nativeUrl = t, r._nativeAsset = e, n && n(null, r);
            }
        };
        e.exports = d;
    }, {
        "./bundle": 31,
        "./cache": 32,
        "./shared": 54
    } ],
    43: [ function(t, e) {
        "use strict";
        var i = t("./pack-manager"), n = t("./task"), r = t("./utilities"), s = r.getDepends, o = r.clear, a = r.forEach, c = t("./shared"), l = c.assets, u = c.fetchPipeline;
        function h(t) {
            for (var e = t.output, i = 0, n = e.length; i < n; i++) e[i].content && e[i].content.decRef(!1);
        }
        function _(t, e, i, n, r, o, a) {
            var c = e.options.__exclude__, l = e.progress;
            t.content = i, t.file = n, e.output.push(t), r && (c[t.uuid] = !0, s(t.uuid, n || i, c, o, !0, !1, t.config), 
            l.total = a + o.length), l.canInvoke && e.dispatch("progress", ++l.finish, l.total, t);
        }
        e.exports = function(t, e) {
            var r = !1;
            t.progress || (t.progress = {
                finish: 0,
                total: t.input.length,
                canInvoke: !0
            }, r = !0);
            var s = t.options, c = [], f = t.progress, d = f.total;
            s.__exclude__ = s.__exclude__ || Object.create(null), t.output = [], a(t.input, function(n, s) {
                if (!n.isNative && l.has(n.uuid)) {
                    var o = l.get(n.uuid);
                    return o.addRef(), _(n, t, o, null, o.__asyncLoadAssets__, c, d), s();
                }
                i.load(n, t.options, function(i, o) {
                    i ? t.isFinish || (!cc.assetManager.force || r ? (cc.error(i.message, i.stack), 
                    f.canInvoke = !1, e(i)) : _(n, t, null, null, !1, c, d)) : t.isFinish || _(n, t, null, o, !n.isNative, c, d), 
                    s();
                });
            }, function() {
                if (t.isFinish) return o(t, !0), t.dispatch("error");
                if (c.length > 0) {
                    var i = n.create({
                        name: t.name + " dependencies",
                        input: c,
                        progress: f,
                        options: s,
                        onProgress: t.onProgress,
                        onError: n.prototype.recycle,
                        onComplete: function(n) {
                            n || (t.output.push.apply(t.output, this.output), i.recycle()), r && h(t), e(n);
                        }
                    });
                    u.async(i);
                } else r && h(t), e();
            });
        };
    }, {
        "./pack-manager": 48,
        "./shared": 54,
        "./task": 55,
        "./utilities": 57
    } ],
    44: [ function(t, e) {
        "use strict";
        var i, n = t("../utils/text-utils"), r = null, s = "BES bswy:->@123", o = Object.create(null), a = -1, c = [], l = 3e3, u = (i = void 0, 
        function() {
            if (void 0 === i) if (window.FontFace) {
                var t = /Gecko.*Firefox\/(\d+)/.exec(window.navigator.userAgent), e = /OS X.*Version\/10\..*Safari/.exec(window.navigator.userAgent) && /Apple/.exec(window.navigator.vendor);
                i = t ? parseInt(t[1], 10) > 42 : !e;
            } else i = !1;
            return i;
        });
        function h() {
            for (var t = !0, e = Date.now(), i = c.length - 1; i >= 0; i--) {
                var o = c[i], u = o.fontFamilyName;
                if (e - o.startTime > l) cc.warnID(4933, u), o.onComplete(null, u), c.splice(i, 1); else {
                    var h = o.refWidth, _ = "40px " + u;
                    r.font = _, h !== n.safeMeasureText(r, s, _) ? (c.splice(i, 1), o.onComplete(null, u)) : t = !1;
                }
            }
            t && (clearInterval(a), a = -1);
        }
        var _ = {
            loadFont: function(t, e, i) {
                var f = _._getFontFamily(t);
                if (o[f]) return i(null, f);
                if (!r) {
                    var d = document.createElement("canvas");
                    d.width = 100, d.height = 100, r = d.getContext("2d");
                }
                var p = "40px " + f;
                r.font = p;
                var m = n.safeMeasureText(r, s, p), v = document.createElement("style");
                v.type = "text/css";
                var y = "";
                isNaN(f - 0) ? y += "@font-face { font-family:" + f + "; src:" : y += "@font-face { font-family:'" + f + "'; src:", 
                y += "url('" + t + "');", v.textContent = y + "}", document.body.appendChild(v);
                var g, x, A, C, b, S, T = document.createElement("div"), w = T.style;
                if (w.fontFamily = f, T.innerHTML = ".", w.position = "absolute", w.left = "-100px", 
                w.top = "-100px", document.body.appendChild(T), u()) g = Date.now(), x = f, A = i, 
                C = new Promise(function(t, e) {
                    (function i() {
                        Date.now() - g >= l ? e() : document.fonts.load("40px " + x).then(function(e) {
                            e.length >= 1 ? t() : setTimeout(i, 100);
                        }, function() {
                            e();
                        });
                    })();
                }), b = null, S = new Promise(function(t, e) {
                    b = setTimeout(e, l);
                }), Promise.race([ S, C ]).then(function() {
                    b && (clearTimeout(b), b = null), A(null, x);
                }, function() {
                    cc.warnID(4933, x), A(null, x);
                }); else {
                    var E = {
                        fontFamilyName: f,
                        refWidth: m,
                        onComplete: i,
                        startTime: Date.now()
                    };
                    c.push(E), -1 === a && (a = setInterval(h, 100));
                }
                o[f] = v;
            },
            _getFontFamily: function(t) {
                var e = t.lastIndexOf(".ttf");
                if (-1 === e) return t;
                var i, n = t.lastIndexOf("/");
                return -1 !== (i = -1 === n ? t.substring(0, e) + "_LABEL" : t.substring(n + 1, e) + "_LABEL").indexOf(" ") && (i = '"' + i + '"'), 
                i;
            }
        };
        e.exports = _;
    }, {
        "../utils/text-utils": 263
    } ],
    45: [ function(t, e) {
        "use strict";
        var i, n = t("./shared").bundles, r = {
            decodeUuid: t("../utils/decode-uuid"),
            getUuidFromURL: (i = /.*[\/\\][0-9a-fA-F]{2}[\/\\]([0-9a-fA-F-]{8,})/, function(t) {
                var e = t.match(i);
                return e ? e[1] : "";
            }),
            getUrlWithUuid: function(t, e) {
                (e = e || Object.create(null)).__isNative__ = e.isNative, e.ext = e.nativeExt;
                var i = n.find(function(e) {
                    return e.getAssetInfo(t);
                });
                return i && (e.bundle = i.name), cc.assetManager._transform(t, e);
            },
            isScene: function(t) {
                return t && (t.constructor === cc.SceneAsset || t instanceof cc.Scene);
            },
            normalize: function(t) {
                return t && (46 === t.charCodeAt(0) && 47 === t.charCodeAt(1) ? t = t.slice(2) : 47 === t.charCodeAt(0) && (t = t.slice(1))), 
                t;
            }
        };
        e.exports = r;
    }, {
        "../utils/decode-uuid": 252,
        "./shared": 54
    } ],
    46: [ function(t) {
        "use strict";
        t("./deprecated"), t("./CCAssetManager");
    }, {
        "./CCAssetManager": 29,
        "./deprecated": 35
    } ],
    47: [ function(t, e) {
        "use strict";
        var i = t("./pack-manager"), n = t("./pipeline"), r = t("./parser"), s = t("./utilities"), o = s.getDepends, a = s.cache, c = s.gatherAsset, l = s.setProperties, u = s.forEach, h = s.clear, _ = s.checkCircleReference, f = t("./shared"), d = f.assets, p = f.files, m = f.parsed, v = f.pipeline, y = t("./task"), g = new n("loadOneAsset", [ function(t, e) {
            var n = t.output = t.input, r = n.options, s = n.isNative, o = n.uuid, a = n.file, c = r.reload;
            if (a || !c && !s && d.has(o)) return e();
            i.load(n, t.options, function(t, i) {
                n.file = i, e(t);
            });
        }, function(t, e) {
            var i = t.output = t.input, n = t.progress, s = t.options.__exclude__, o = i.id, a = i.file, c = i.options;
            if (i.isNative) r.parse(o, a, i.ext, c, function(r, s) {
                if (r) return e(r);
                i.content = s, n.canInvoke && t.dispatch("progress", ++n.finish, n.total, i), p.remove(o), 
                m.remove(o), e();
            }); else {
                var l = i.uuid;
                if (l in s) {
                    var u = s[l], h = u.finish, f = u.content, v = u.err, y = u.callbacks;
                    n.canInvoke && t.dispatch("progress", ++n.finish, n.total, i), h || _(l, l, s) ? (f && f.addRef && f.addRef(), 
                    i.content = f, e(v)) : y.push({
                        done: e,
                        item: i
                    });
                } else if (!c.reload && d.has(l)) {
                    var g = d.get(l);
                    c.__asyncLoadAssets__ || !g.__asyncLoadAssets__ ? (i.content = g.addRef(), n.canInvoke && t.dispatch("progress", ++n.finish, n.total, i), 
                    e()) : x(t, g, e, !1);
                } else r.parse(o, a, "import", c, function(i, n) {
                    if (i) return e(i);
                    n._uuid = l, x(t, n, e, !0);
                });
            }
        } ]);
        function x(t, e, i, n) {
            var r = t.input, s = t.progress, c = r.uuid, u = r.id, h = r.options, _ = r.config, f = h.__asyncLoadAssets__, d = h.cacheAsset, g = [];
            e.addRef && e.addRef(), o(c, e, Object.create(null), g, !1, f, _), s.canInvoke && t.dispatch("progress", ++s.finish, s.total += g.length, r);
            var x = t.options.__exclude__[c] = {
                content: e,
                finish: !1,
                callbacks: [ {
                    done: i,
                    item: r
                } ]
            }, A = y.create({
                input: g,
                options: t.options,
                onProgress: t.onProgress,
                onError: y.prototype.recycle,
                progress: s,
                onComplete: function(t) {
                    if (e.decRef && e.decRef(!1), e.__asyncLoadAssets__ = f, x.finish = !0, x.err = t, 
                    !t) {
                        for (var i = Array.isArray(A.output) ? A.output : [ A.output ], r = Object.create(null), s = 0, o = i.length; s < o; s++) {
                            var h = i[s];
                            h && (r[h instanceof cc.Asset ? h._uuid + "@import" : c + "@native"] = h);
                        }
                        if (n) {
                            if (!l(c, e, r)) try {
                                e.onLoad && e.onLoad();
                            } catch (C) {
                                cc.error(C.message, C.stack);
                            }
                            p.remove(u), m.remove(u), a(c, e, void 0 !== d ? d : cc.assetManager.cacheAsset);
                        } else if (e.__nativeDepend__ && !e._nativeAsset && !l(c, e, r)) try {
                            e.onLoad && e.onLoad();
                        } catch (C) {
                            cc.error(C.message, C.stack);
                        }
                        A.recycle();
                    }
                    for (var _ = x.callbacks, v = 0, y = _.length; v < y; v++) {
                        var g = _[v];
                        e.addRef && e.addRef(), g.item.content = e, g.done(t);
                    }
                    _.length = 0;
                }
            });
            v.async(A);
        }
        e.exports = function(t, e) {
            var i = !1;
            t.progress || (t.progress = {
                finish: 0,
                total: t.input.length,
                canInvoke: !0
            }, i = !0);
            var n = t.options, r = t.progress;
            n.__exclude__ = n.__exclude__ || Object.create(null), t.output = [], u(t.input, function(s, o) {
                var a = y.create({
                    input: s,
                    onProgress: t.onProgress,
                    options: n,
                    progress: r,
                    onComplete: function(n, s) {
                        n && !t.isFinish && (!cc.assetManager.force || i ? (cc.error(n.message, n.stack), 
                        r.canInvoke = !1, e(n)) : r.canInvoke && t.dispatch("progress", ++r.finish, r.total, s)), 
                        t.output.push(s), a.recycle(), o();
                    }
                });
                g.async(a);
            }, function() {
                if (n.__exclude__ = null, t.isFinish) return h(t, !0), t.dispatch("error");
                c(t), h(t, !0), e();
            });
        };
    }, {
        "./pack-manager": 48,
        "./parser": 49,
        "./pipeline": 50,
        "./shared": 54,
        "./task": 55,
        "./utilities": 57
    } ],
    48: [ function(t, e) {
        "use strict";
        var i = t("../platform/deserialize-compiled"), n = t("./downloader"), r = t("./cache"), s = t("../platform/js"), o = t("./shared").files, a = new r();
        function c(t) {
            return a.has(t.uuid);
        }
        var l = {
            unpackJson: function(t, e, n, r) {
                var o = s.createMap(!0), a = null;
                if (Array.isArray(e)) {
                    (e = (0, i.unpackJSONs)(e, cc._MissingScript.safeFindClass)).length !== t.length && cc.errorID(4915);
                    for (var c = 0; c < t.length; c++) o[t[c] + "@import"] = e[c];
                } else {
                    var l = s._getClassId(cc.Texture2D);
                    if (e.type === l) {
                        if (e.data) {
                            var u = e.data.split("|");
                            u.length !== t.length && cc.errorID(4915);
                            for (var h = 0; h < t.length; h++) o[t[h] + "@import"] = (0, i.packCustomObjData)(l, u[h]);
                        }
                    } else a = new Error("unmatched type pack!"), o = null;
                }
                r && r(a, o);
            },
            init: function() {
                a.clear();
            },
            register: function(t, e) {
                "object" == typeof t ? s.mixin(u, t) : u[t] = e;
            },
            unpack: function(t, e, i, n, r) {
                e ? (0, u[i])(t, e, n, r) : r && r(new Error("package data is wrong!"));
            },
            load: function(t, e, i) {
                if (t.isNative || !t.info || !t.info.packs) return n.download(t.id, t.url, t.ext, t.options, i);
                if (o.has(t.id)) return i(null, o.get(t.id));
                var r = t.info.packs, s = r.find(c);
                if (s) return a.get(s.uuid).push({
                    onComplete: i,
                    id: t.id
                });
                s = r[0], a.add(s.uuid, [ {
                    onComplete: i,
                    id: t.id
                } ]);
                var u = cc.assetManager._transform(s.uuid, {
                    ext: s.ext,
                    bundle: t.config.name
                });
                n.download(s.uuid, u, s.ext, t.options, function(e, i) {
                    o.remove(s.uuid), e && cc.error(e.message, e.stack), l.unpack(s.packs, i, s.ext, t.options, function(t, e) {
                        if (!t) for (var i in e) o.add(i, e[i]);
                        for (var n = a.remove(s.uuid), r = 0, c = n.length; r < c; r++) {
                            var l = n[r];
                            if (t) l.onComplete(t); else {
                                var u = e[l.id];
                                u ? l.onComplete(null, u) : l.onComplete(new Error("can not retrieve data from package"));
                            }
                        }
                    });
                });
            }
        }, u = {
            ".json": l.unpackJson
        };
        e.exports = l;
    }, {
        "../platform/deserialize-compiled": 197,
        "../platform/js": 203,
        "./cache": 32,
        "./downloader": 41,
        "./shared": 54
    } ],
    49: [ function(t, e) {
        "use strict";
        var i = t("../platform/CCSAXParser").plistParser, n = t("../platform/js"), r = t("./deserialize"), s = t("./cache"), o = t("./helper").isScene, a = t("./shared"), c = a.parsed, l = a.files, u = t("../platform/CCSys"), h = u.__audioSupport, _ = u.capabilities, f = new s(), d = {
            parseImage: function(t, e, i) {
                if (_.imageBitmap && t instanceof Blob) {
                    var n = {};
                    n.imageOrientation = e.__flipY__ ? "flipY" : "none", n.premultiplyAlpha = e.__premultiplyAlpha__ ? "premultiply" : "none", 
                    createImageBitmap(t, n).then(function(t) {
                        t.flipY = !!e.__flipY__, t.premultiplyAlpha = !!e.__premultiplyAlpha__, i && i(null, t);
                    }, function(t) {
                        i && i(t, null);
                    });
                } else i && i(null, t);
            },
            parseAudio: function(t, e, i) {
                t instanceof ArrayBuffer ? h.context.decodeAudioData(t, function(t) {
                    i && i(null, t);
                }, function(t) {
                    i && i(t, null);
                }) : i && i(null, t);
            },
            parsePVRTex: function(t, e, i) {
                var n = null, r = null;
                try {
                    var s = t instanceof ArrayBuffer ? t : t.buffer, o = new Int32Array(s, 0, 13);
                    if (55727696 != o[0]) throw new Error("Invalid magic number in PVR header");
                    var a = o[7], c = o[6], l = o[12] + 52;
                    r = {
                        _data: new Uint8Array(s, l),
                        _compressed: !0,
                        width: a,
                        height: c
                    };
                } catch (u) {
                    n = u;
                }
                i && i(n, r);
            },
            parsePKMTex: function() {
                function t(t, e) {
                    return t[e] << 8 | t[e + 1];
                }
                return function(e, i, n) {
                    var r = null, s = null;
                    try {
                        var o = e instanceof ArrayBuffer ? e : e.buffer, a = new Uint8Array(o), c = t(a, 6);
                        if (0 !== c && 1 !== c && 3 !== c) return new Error("Invalid magic number in ETC header");
                        var l = t(a, 12), u = t(a, 14);
                        t(a, 8), t(a, 10), s = {
                            _data: new Uint8Array(o, 16),
                            _compressed: !0,
                            width: l,
                            height: u
                        };
                    } catch (h) {
                        r = h;
                    }
                    n && n(r, s);
                };
            }(),
            parsePlist: function(t, e, n) {
                var r = null, s = i.parse(t);
                s || (r = new Error("parse failed")), n && n(r, s);
            },
            parseImport: function(t, e, i) {
                if (!t) return i && i(new Error("Json is empty"));
                var n, s = null;
                try {
                    n = r(t, e);
                } catch (o) {
                    s = o;
                }
                i && i(s, n);
            },
            init: function() {
                f.clear();
            },
            register: function(t, e) {
                "object" == typeof t ? n.mixin(p, t) : p[t] = e;
            },
            parse: function(t, e, i, n, r) {
                var s, a, u;
                (s = c.get(t)) ? r(null, s) : (a = f.get(t)) ? a.push(r) : (u = p[i]) ? (f.add(t, [ r ]), 
                u(e, n, function(e, i) {
                    e ? l.remove(t) : o(i) || c.add(t, i);
                    for (var n = f.remove(t), r = 0, s = n.length; r < s; r++) n[r](e, i);
                })) : r(null, e);
            }
        }, p = {
            ".png": d.parseImage,
            ".jpg": d.parseImage,
            ".bmp": d.parseImage,
            ".jpeg": d.parseImage,
            ".gif": d.parseImage,
            ".ico": d.parseImage,
            ".tiff": d.parseImage,
            ".webp": d.parseImage,
            ".image": d.parseImage,
            ".pvr": d.parsePVRTex,
            ".pkm": d.parsePKMTex,
            ".mp3": d.parseAudio,
            ".ogg": d.parseAudio,
            ".wav": d.parseAudio,
            ".m4a": d.parseAudio,
            ".plist": d.parsePlist,
            import: d.parseImport
        };
        e.exports = d;
    }, {
        "../platform/CCSAXParser": 189,
        "../platform/CCSys": 191,
        "../platform/js": 203,
        "./cache": 32,
        "./deserialize": 36,
        "./helper": 45,
        "./shared": 54
    } ],
    50: [ function(t, e) {
        "use strict";
        var i = t("./task"), n = 0;
        function r(t, e) {
            if (Array.isArray(e)) {
                this.id = n++, this.name = t, this.pipes = [];
                for (var i = 0, r = e.length; i < r; i++) "function" == typeof e[i] && this.pipes.push(e[i]);
            } else cc.warn("funcs must be an array");
        }
        r.prototype = {
            constructor: r,
            insert: function(t, e) {
                if (!("function" != typeof t || e > this.pipes.length)) return this.pipes.splice(e, 0, t), 
                this;
                cc.warnID(4921);
            },
            append: function(t) {
                if ("function" == typeof t) return this.pipes.push(t), this;
            },
            remove: function(t) {
                if ("number" == typeof t) return this.pipes.splice(t, 1), this;
            },
            sync: function(t) {
                var e = this.pipes;
                if (t instanceof i && 0 !== e.length) {
                    null != t.output && (t.input = t.output, t.output = null), t._isFinish = !1;
                    for (var n = 0, r = e.length; n < r; ) {
                        var s = (0, e[n])(t);
                        if (s) return t._isFinish = !0, s;
                        ++n !== r && (t.input = t.output, t.output = null);
                    }
                    return t._isFinish = !0, t.output;
                }
            },
            async: function(t) {
                var e = this.pipes;
                t instanceof i && 0 !== e.length && (null != t.output && (t.input = t.output, t.output = null), 
                t._isFinish = !1, this._flow(0, t));
            },
            _flow: function(t, e) {
                var i = this;
                (0, this.pipes[t])(e, function(n) {
                    n ? (e._isFinish = !0, e.onComplete && e.onComplete(n)) : ++t < i.pipes.length ? (e.input = e.output, 
                    e.output = null, i._flow(t, e)) : (e._isFinish = !0, e.onComplete && e.onComplete(n, e.output));
                });
            }
        }, e.exports = r;
    }, {
        "./task": 55
    } ],
    51: [ function(t, e) {
        "use strict";
        var i = t("./task"), n = t("./shared"), r = n.transformPipeline, s = n.RequestType;
        e.exports = function(t, e) {
            var n = t.options, o = Object.create(null), a = Object.create(null);
            for (var c in n) switch (c) {
              case s.PATH:
              case s.UUID:
              case s.DIR:
              case s.SCENE:
              case s.URL:
                break;

              case "__requestType__":
              case "__isNative__":
              case "ext":
              case "type":
              case "__nativeName__":
              case "audioLoadMode":
              case "bundle":
                o[c] = n[c];
                break;

              case "__exclude__":
              case "__outputAsArray__":
                a[c] = n[c];
                break;

              default:
                o[c] = n[c], a[c] = n[c];
            }
            t.options = a;
            var l = i.create({
                input: t.input,
                options: o
            }), u = null;
            try {
                t.output = t.source = r.sync(l);
            } catch (f) {
                u = f;
                for (var h = 0, _ = l.output.length; h < _; h++) l.output[h].recycle();
            }
            l.recycle(), e(u);
        };
    }, {
        "./shared": 54,
        "./task": 55
    } ],
    52: [ function(t, e) {
        "use strict";
        var i = t("./depend-util"), n = t("./cache");
        t("../assets/CCAsset");
        var r = t("./shared").assets;
        function s(t, e) {
            t._uuid && e.push(t._uuid);
        }
        function o(t, e) {
            for (var i = Object.getOwnPropertyNames(t), n = 0; n < i.length; n++) {
                var r = i[n];
                if ("node" !== r && "__eventTargets" !== r) {
                    var o = t[r];
                    if ("object" == typeof o && o) if (Array.isArray(o)) for (var a = 0; a < o.length; a++) {
                        var c = o[a];
                        c instanceof cc.Asset && s(c, e);
                    } else if (o.constructor && o.constructor !== Object) o instanceof cc.Asset && s(o, e); else for (var l = Object.getOwnPropertyNames(o), u = 0; u < l.length; u++) {
                        var h = o[l[u]];
                        h instanceof cc.Asset && s(h, e);
                    }
                }
            }
        }
        var a = [];
        function c(t, e) {
            for (var i = 0; i < t._components.length; i++) o(t._components[i], e);
            for (var n = 0; n < t._children.length; n++) c(t._children[n], e);
        }
        function l(t, e, n, s) {
            n.push(t._uuid);
            for (var o = i.getDeps(t._uuid), a = 0, c = o.length; a < c; a++) {
                var u = r.get(o[a]);
                if (u) {
                    var h = u._uuid;
                    if (h in e ? e[h] += s : e[h] = u.refCount + s, n.includes(h)) continue;
                    l(u, e, n, s);
                }
            }
        }
        function u(t) {
            var e = Object.create(null);
            if (e[t._uuid] = t.refCount, l(t, e, a, -1), a.length = 0, 0 !== e[t._uuid]) return e[t._uuid];
            for (var i in e) 0 !== e[i] && l(r.get(i), e, a, 1);
            return a.length = 0, e[t._uuid];
        }
        var h = new n(), _ = new n(), f = !1;
        function d() {
            f = !1, _.forEach(function(t) {
                p._free(t);
            }), _.clear();
        }
        var p = {
            init: function() {
                h.clear(), _.clear();
            },
            _addPersistNodeRef: function(t) {
                var e = [];
                c(t, e);
                for (var i = 0, n = e.length; i < n; i++) {
                    var s = r.get(e[i]);
                    s && s.addRef();
                }
                h.add(t.uuid, e);
            },
            _removePersistNodeRef: function(t) {
                if (h.has(t.uuid)) {
                    for (var e = h.get(t.uuid), i = 0, n = e.length; i < n; i++) {
                        var s = r.get(e[i]);
                        s && s.decRef();
                    }
                    h.remove(t.uuid);
                }
            },
            _autoRelease: function(t, e, n) {
                for (var s = 0, o = n.length; s < o; s++) {
                    for (var a = n[s], c = i._depends.get(e._id), l = h.get(a.uuid), u = 0, _ = l.length; u < _; u++) {
                        var f = r.get(l[u]);
                        f && f.addRef();
                    }
                    c && (!c.persistDeps && (c.persistDeps = []), c.persistDeps.push.apply(c.persistDeps, l));
                }
                if (t) {
                    for (var d = i.getDeps(t._id), p = 0, m = d.length; p < m; p++) {
                        var v = r.get(d[p]);
                        v && v.decRef(t.autoReleaseAssets);
                    }
                    var y = i._depends.get(t._id);
                    if (y && y.persistDeps) for (var g = y.persistDeps, x = 0, A = g.length; x < A; x++) {
                        var C = r.get(g[x]);
                        C && C.decRef(t.autoReleaseAssets);
                    }
                    i.remove(t._id);
                }
            },
            _free: function(t, e) {
                if (_.remove(t._uuid), cc.isValid(t, !0) && !(!e && t.refCount > 0 && u(t) > 0)) {
                    r.remove(t._uuid);
                    for (var n = i.getDeps(t._uuid), s = 0, o = n.length; s < o; s++) {
                        var a = r.get(n[s]);
                        a && (a.decRef(!1), p._free(a, !1));
                    }
                    t.destroy(), i.remove(t._uuid);
                }
            },
            tryRelease: function(t, e) {
                t instanceof cc.Asset && (e ? p._free(t, e) : (_.add(t._uuid, t), f || (f = !0, 
                cc.director.once(cc.Director.EVENT_AFTER_DRAW, d))));
            }
        };
        e.exports = p;
    }, {
        "../assets/CCAsset": 58,
        "./cache": 32,
        "./depend-util": 34,
        "./shared": 54
    } ],
    53: [ function(t, e) {
        "use strict";
        var i = [];
        function n() {
            this._id = "", this.uuid = "", this.url = "", this.ext = ".json", this.content = null, 
            this.file = null, this.info = null, this.config = null, this.isNative = !1, this.options = Object.create(null);
        }
        n.prototype = {
            constructor: n,
            get id() {
                return this._id || (this._id = this.uuid + "@" + (this.isNative ? "native" : "import")), 
                this._id;
            },
            recycle: function() {
                500 !== i.length && (this._id = "", this.uuid = "", this.url = "", this.ext = ".json", 
                this.content = null, this.file = null, this.info = null, this.config = null, this.isNative = !1, 
                this.options = Object.create(null), i.push(this));
            }
        }, n.create = function() {
            return 0 !== i.length ? i.pop() : new n();
        }, e.exports = n;
    }, {} ],
    54: [ function(t, e) {
        "use strict";
        var i = t("./cache"), n = t("./pipeline"), r = new i(), s = new i(), o = new i(), a = new i(), c = new n("normal load", []), l = new n("fetch", []), u = new n("transform url", []);
        e.exports = {
            assets: r,
            files: s,
            parsed: o,
            pipeline: c,
            fetchPipeline: l,
            transformPipeline: u,
            RequestType: {
                UUID: "uuid",
                PATH: "path",
                DIR: "dir",
                URL: "url",
                SCENE: "scene"
            },
            bundles: a,
            BuiltinBundleName: {
                RESOURCES: "resources",
                INTERNAL: "internal",
                MAIN: "main",
                START_SCENE: "start-scene"
            }
        };
    }, {
        "./cache": 32,
        "./pipeline": 50
    } ],
    55: [ function(t, e) {
        "use strict";
        var i = 0, n = [];
        function r(t) {
            this.id = i++, this._isFinish = !0, this.onComplete = null, this.onProgress = null, 
            this.onError = null, this.source = null, this.output = null, this.input = null, 
            this.progress = null, this.options = null, this.set(t);
        }
        r.prototype = {
            constructor: r,
            set: function(t) {
                t = t || Object.create(null), this.onComplete = t.onComplete, this.onProgress = t.onProgress, 
                this.onError = t.onError, this.source = this.input = t.input, this.output = null, 
                this.progress = t.progress, this.options = t.options || Object.create(null);
            },
            dispatch: function(t, e, i, n, r) {
                switch (t) {
                  case "complete":
                    this.onComplete && this.onComplete(e, i, n, r);
                    break;

                  case "progress":
                    this.onProgress && this.onProgress(e, i, n, r);
                    break;

                  case "error":
                    this.onError && this.onError(e, i, n, r);
                    break;

                  default:
                    var s = "on" + t[0].toUpperCase() + t.substr(1);
                    "function" == typeof this[s] && this[s](e, i, n, r);
                }
            },
            recycle: function() {
                500 !== n.length && (this.onComplete = null, this.onProgress = null, this.onError = null, 
                this.source = this.output = this.input = null, this.progress = null, this.options = null, 
                n.push(this));
            },
            get isFinish() {
                return this._isFinish;
            }
        }, r.create = function(t) {
            var e = null;
            return 0 !== n.length ? (e = n.pop()).set(t) : e = new r(t), e;
        }, e.exports = r;
    }, {} ],
    56: [ function(t, e) {
        "use strict";
        var i = t("./helper").decodeUuid, n = t("./request-item"), r = t("./shared"), s = r.RequestType, o = r.bundles;
        e.exports = {
            parse: function(t) {
                var e = t.input, r = t.options;
                e = Array.isArray(e) ? e : [ e ], t.output = [];
                for (var a = 0; a < e.length; a++) {
                    var c = e[a], l = n.create();
                    if ("string" == typeof c && ((c = Object.create(null))[r.__requestType__ || s.UUID] = e[a]), 
                    "object" == typeof c) for (var u in cc.js.addon(c, r), c.preset && cc.js.addon(c, cc.assetManager.presets[c.preset]), 
                    c) {
                        switch (u) {
                          case s.UUID:
                            var h = l.uuid = i(c.uuid);
                            if (o.has(c.bundle)) {
                                if ((p = (m = o.get(c.bundle)._config).getAssetInfo(h)) && p.redirect) {
                                    if (!o.has(p.redirect)) throw new Error("Please load bundle " + p.redirect + " first");
                                    p = (m = o.get(p.redirect)._config).getAssetInfo(h);
                                }
                                l.config = m, l.info = p;
                            }
                            l.ext = c.ext || ".json";
                            break;

                          case "__requestType__":
                          case "ext":
                          case "bundle":
                          case "preset":
                          case "type":
                            break;

                          case s.DIR:
                            if (o.has(c.bundle)) {
                                var _ = [];
                                o.get(c.bundle)._config.getDirWithPath(c.dir, c.type, _);
                                for (var f = 0, d = _.length; f < d; f++) {
                                    var p = _[f];
                                    e.push({
                                        uuid: p.uuid,
                                        __isNative__: !1,
                                        ext: ".json",
                                        bundle: c.bundle
                                    });
                                }
                            }
                            l.recycle(), l = null;
                            break;

                          case s.PATH:
                            if (o.has(c.bundle)) {
                                if ((p = (m = o.get(c.bundle)._config).getInfoWithPath(c.path, c.type)) && p.redirect) {
                                    if (!o.has(p.redirect)) throw new Error("you need to load bundle " + p.redirect + " first");
                                    p = (m = o.get(p.redirect)._config).getAssetInfo(p.uuid);
                                }
                                if (!p) throw l.recycle(), new Error("Bundle " + c.bundle + " doesn't contain " + c.path);
                                l.config = m, l.uuid = p.uuid, l.info = p;
                            }
                            l.ext = c.ext || ".json";
                            break;

                          case s.SCENE:
                            if (o.has(c.bundle)) {
                                var m;
                                if ((p = (m = o.get(c.bundle)._config).getSceneInfo(c.scene)) && p.redirect) {
                                    if (!o.has(p.redirect)) throw new Error("you need to load bundle " + p.redirect + " first");
                                    p = (m = o.get(p.redirect)._config).getAssetInfo(p.uuid);
                                }
                                if (!p) throw l.recycle(), new Error("Bundle " + m.name + " doesn't contain scene " + c.scene);
                                l.config = m, l.uuid = p.uuid, l.info = p;
                            }
                            break;

                          case "__isNative__":
                            l.isNative = c.__isNative__;
                            break;

                          case s.URL:
                            l.url = c.url, l.uuid = c.uuid || c.url, l.ext = c.ext || cc.path.extname(c.url), 
                            l.isNative = void 0 === c.__isNative__ || c.__isNative__;
                            break;

                          default:
                            l.options[u] = c[u];
                        }
                        if (!l) break;
                    }
                    if (l && (t.output.push(l), !l.uuid && !l.url)) throw new Error("unknown input:" + c.toString());
                }
                return null;
            },
            combine: function(t) {
                for (var e = t.output = t.input, i = 0; i < e.length; i++) {
                    var n = e[i];
                    if (!n.url) {
                        var r, s, o = n.config;
                        s = n.isNative ? o && o.nativeBase ? o.base + o.nativeBase : cc.assetManager.generalNativeBase : o && o.importBase ? o.base + o.importBase : cc.assetManager.generalImportBase;
                        var a = n.uuid, c = "";
                        n.info && (c = n.isNative ? n.info.nativeVer ? "." + n.info.nativeVer : "" : n.info.ver ? "." + n.info.ver : ""), 
                        r = ".ttf" === n.ext ? s + "/" + a.slice(0, 2) + "/" + a + c + "/" + n.options.__nativeName__ : s + "/" + a.slice(0, 2) + "/" + a + c + n.ext, 
                        n.url = r;
                    }
                }
                return null;
            }
        };
    }, {
        "./helper": 45,
        "./request-item": 53,
        "./shared": 54
    } ],
    57: [ function(t, e) {
        "use strict";
        var i = t("./depend-util"), n = t("./helper"), r = n.isScene, s = n.decodeUuid, o = t("./shared").assets, a = t("../platform/utils").callInNextTick;
        t("../assets/CCAsset");
        var c = {
            processOptions: function(t) {
                var e = t.uuids, i = t.paths, n = t.types, r = t.deps, o = t.paths = Object.create(null);
                if (!1 === t.debug) {
                    for (var a = 0, c = e.length; a < c; a++) e[a] = s(e[a]);
                    for (var l in i) {
                        var u = i[l], h = u[1];
                        u[1] = n[h];
                    }
                } else {
                    for (var _ = Object.create(null), f = 0, d = e.length; f < d; f++) {
                        var p = e[f];
                        e[f] = _[p] = s(p);
                    }
                    e = _;
                }
                for (var m in i) {
                    var v = i[m];
                    o[e[m]] = v;
                }
                var y = t.scenes;
                for (var g in y) {
                    var x = y[g];
                    y[g] = e[x];
                }
                var A = t.packs;
                for (var C in A) for (var b = A[C], S = 0; S < b.length; ++S) b[S] = e[b[S]];
                var T = t.versions;
                if (T) for (var w in T) for (var E = T[w], B = 0; B < E.length; B += 2) {
                    var M = E[B];
                    E[B] = e[M] || M;
                }
                var R = t.redirect;
                if (R) for (var P = 0; P < R.length; P += 2) R[P] = e[R[P]], R[P + 1] = r[R[P + 1]];
            },
            clear: function(t, e) {
                for (var i = 0, n = t.input.length; i < n; i++) {
                    var r = t.input[i];
                    e && !r.isNative && r.content && r.content.decRef && r.content.decRef(!1), r.recycle();
                }
                t.input = null;
            },
            urlAppendTimestamp: function(t) {
                return cc.assetManager.downloader.appendTimeStamp && "string" == typeof t ? /\?/.test(t) ? t + "&_t=" + (new Date() - 0) : t + "?_t=" + (new Date() - 0) : t;
            },
            retry: function(t, e, i, n, r) {
                t(r = r || 0, function(s, o) {
                    r++, !s || r > e ? n && n(s, o) : setTimeout(function() {
                        c.retry(t, e, i, n, r);
                    }, i);
                });
            },
            getDepends: function(t, e, n, r, s, o, a) {
                try {
                    var c = i.parse(t, e), l = !0;
                    if (e instanceof cc.Asset && (!e.__nativeDepend__ || e._nativeAsset) && (l = !1), 
                    s) {
                        for (var u = 0, h = c.deps.length; u < h; u++) {
                            var _ = c.deps[u];
                            _ in n || (n[_] = !0, r.push({
                                uuid: _,
                                bundle: a && a.name
                            }));
                        }
                        l && c.nativeDep && (a && (c.nativeDep.bundle = a.name), r.push(Object.assign({}, c.nativeDep)));
                    } else {
                        o = !!e.asyncLoadAssets || o && !c.preventDeferredLoadDependents;
                        for (var f = 0, d = c.deps.length; f < d; f++) {
                            var p = c.deps[f];
                            p in n || (n[p] = !0, r.push({
                                uuid: p,
                                __asyncLoadAssets__: o,
                                bundle: a && a.name
                            }));
                        }
                        l && !o && !c.preventPreloadNativeObject && c.nativeDep && (a && (c.nativeDep.bundle = a.name), 
                        r.push(Object.assign({}, c.nativeDep)));
                    }
                } catch (m) {
                    cc.error(m.message, m.stack);
                }
            },
            cache: function(t, e, i) {
                e && (!r(e) && i && o.add(t, e));
            },
            setProperties: function(t, e, i) {
                var n = !1, r = e.__depends__;
                if (r) {
                    for (var s = 0, o = r.length; s < o; s++) {
                        var a = r[s], c = i[a.uuid + "@import"];
                        c ? a.owner[a.prop] = c.addRef() : (cc.error("The asset " + a.uuid + " is missing!"), 
                        n = !0);
                    }
                    e.__depends__ = void 0;
                }
                return e.__nativeDepend__ && (e._nativeAsset || (i[t + "@native"] ? e._nativeAsset = i[t + "@native"] : n = !0), 
                e.__nativeDepend__ = void 0), n;
            },
            gatherAsset: function(t) {
                var e = t.source;
                if (t.options.__outputAsArray__ || 1 !== e.length) for (var i = t.output = [], n = 0, r = e.length; n < r; n++) i.push(e[n].content); else t.output = e[0].content;
            },
            forEach: function(t, e, i) {
                var n = 0, r = [];
                0 === t.length && i && i(r);
                for (var s = 0, o = t.length; s < o; s++) e(t[s], function(t) {
                    t && r.push(t), ++n === o && i && i(r);
                });
            },
            parseParameters: function(t, e, i) {
                if (void 0 === i) {
                    var n = "function" == typeof t;
                    e ? (i = e, n || (e = null)) : void 0 === e && n && (i = t, t = null, e = null), 
                    void 0 !== e && n && (e = t, t = null);
                }
                return {
                    options: t = t || Object.create(null),
                    onProgress: e,
                    onComplete: i
                };
            },
            parseLoadResArgs: function(t, e, i) {
                if (void 0 === i) {
                    var n = cc.js.isChildClassOf(t, cc.Asset);
                    e ? (i = e, n && (e = null)) : void 0 !== e || n || (i = t, e = null, t = null), 
                    void 0 === e || n || (e = t, t = null);
                }
                return {
                    type: t,
                    onProgress: e,
                    onComplete: i
                };
            },
            checkCircleReference: function(t, e, n, r) {
                if (r || (r = Object.create(null)), !n[e] || r[e]) return !1;
                r[e] = !0;
                var s = !1, o = i.getDeps(e);
                if (o) for (var a = 0, l = o.length; a < l; a++) {
                    var u = o[a];
                    if (u === t || c.checkCircleReference(t, u, n, r)) {
                        s = !0;
                        break;
                    }
                }
                return s;
            },
            asyncify: function(t) {
                return function(e, i) {
                    t && a(t, e, i);
                };
            }
        };
        e.exports = c;
    }, {
        "../assets/CCAsset": 58,
        "../platform/utils": 206,
        "./depend-util": 34,
        "./helper": 45,
        "./shared": 54
    } ],
    58: [ function(t, e) {
        "use strict";
        var i = t("../platform/CCObject");
        cc.Asset = cc.Class({
            name: "cc.Asset",
            extends: i,
            ctor: function() {
                Object.defineProperty(this, "_uuid", {
                    value: "",
                    writable: !0
                }), this.loaded = !0, this._nativeUrl = "", this._ref = 0;
            },
            properties: {
                nativeUrl: {
                    get: function() {
                        if (!this._nativeUrl && this._native) {
                            var t = this._native;
                            if (47 === t.charCodeAt(0)) return t.slice(1);
                            46 === t.charCodeAt(0) ? this._nativeUrl = cc.assetManager.utils.getUrlWithUuid(this._uuid, {
                                nativeExt: t,
                                isNative: !0
                            }) : this._nativeUrl = cc.assetManager.utils.getUrlWithUuid(this._uuid, {
                                __nativeName__: t,
                                nativeExt: cc.path.extname(t),
                                isNative: !0
                            });
                        }
                        return this._nativeUrl;
                    },
                    visible: !1
                },
                refCount: {
                    get: function() {
                        return this._ref;
                    }
                },
                _native: "",
                _nativeAsset: {
                    get: function() {
                        return this._$nativeAsset;
                    },
                    set: function(t) {
                        this._$nativeAsset = t;
                    }
                },
                _nativeDep: {
                    get: function() {
                        if (this._native) return {
                            __isNative__: !0,
                            uuid: this._uuid,
                            ext: this._native
                        };
                    }
                }
            },
            statics: {
                deserialize: !1,
                preventDeferredLoadDependents: !1,
                preventPreloadNativeObject: !1
            },
            toString: function() {
                return this.nativeUrl;
            },
            serialize: !1,
            createNode: null,
            _setRawAsset: function(t, e) {
                this._native = !1 !== e ? t || void 0 : "/" + t;
            },
            addRef: function() {
                return this._ref++, this;
            },
            decRef: function(t) {
                return this._ref--, !1 !== t && cc.assetManager._releaseManager.tryRelease(this), 
                this;
            }
        }), e.exports = cc.Asset;
    }, {
        "../platform/CCObject": 188
    } ],
    59: [ function(t, e) {
        "use strict";
        var i = t("./CCAsset"), n = t("../event/event-target"), r = cc.Enum({
            WEB_AUDIO: 0,
            DOM_AUDIO: 1
        }), s = cc.Class({
            name: "cc.AudioClip",
            extends: i,
            mixins: [ n ],
            ctor: function() {
                this._loading = !1, this.loaded = !1, this._audio = null;
            },
            properties: {
                duration: 0,
                loadMode: {
                    default: r.WEB_AUDIO,
                    type: r
                },
                _nativeAsset: {
                    get: function() {
                        return this._audio;
                    },
                    set: function(t) {
                        t instanceof cc.AudioClip ? this._audio = t._nativeAsset : this._audio = t, this._audio && (this.loaded = !0, 
                        this.emit("load"));
                    },
                    override: !0
                },
                _nativeDep: {
                    get: function() {
                        return {
                            uuid: this._uuid,
                            audioLoadMode: this.loadMode,
                            ext: cc.path.extname(this._native),
                            __isNative__: !0
                        };
                    },
                    override: !0
                }
            },
            statics: {
                LoadMode: r,
                _loadByUrl: function(t, e) {
                    var i = cc.assetManager.assets.get(t);
                    i ? e(null, i) : cc.assetManager.loadRemote(t, function(t, i) {
                        if (t) return e(t);
                        e(null, i);
                    });
                }
            },
            _ensureLoaded: function(t) {
                if (this.loaded) return t && t();
                if (t && this.once("load", t), !this._loading) {
                    this._loading = !0;
                    var e = this;
                    cc.assetManager.postLoadNative(this, function() {
                        e._loading = !1;
                    });
                }
            },
            destroy: function() {
                cc.audioEngine.uncache(this), this._super();
            }
        });
        cc.AudioClip = s, e.exports = s;
    }, {
        "../event/event-target": 129,
        "./CCAsset": 58
    } ],
    60: [ function(t, e) {
        "use strict";
        var i = function() {
            this.u = 0, this.v = 0, this.w = 0, this.h = 0, this.offsetX = 0, this.offsetY = 0, 
            this.textureID = 0, this.valid = !1, this.xAdvance = 0;
        }, n = function(t) {
            this._letterDefinitions = {}, this._texture = t;
        };
        n.prototype = {
            constructor: n,
            addLetterDefinitions: function(t, e) {
                this._letterDefinitions[t] = e;
            },
            cloneLetterDefinition: function() {
                var t = {};
                for (var e in this._letterDefinitions) {
                    var n = new i();
                    cc.js.mixin(n, this._letterDefinitions[e]), t[e] = n;
                }
                return t;
            },
            getTexture: function() {
                return this._texture;
            },
            getLetter: function(t) {
                return this._letterDefinitions[t];
            },
            getLetterDefinitionForChar: function(t) {
                var e = t.charCodeAt(0);
                return this._letterDefinitions.hasOwnProperty(e) ? this._letterDefinitions[e] : null;
            },
            clear: function() {
                this._letterDefinitions = {};
            }
        };
        var r = cc.Class({
            name: "cc.BitmapFont",
            extends: cc.Font,
            properties: {
                fntDataStr: {
                    default: ""
                },
                spriteFrame: {
                    default: null,
                    type: cc.SpriteFrame
                },
                fontSize: {
                    default: -1
                },
                _fntConfig: null,
                _fontDefDictionary: null
            },
            onLoad: function() {
                var t = this.spriteFrame;
                !this._fontDefDictionary && t && (this._fontDefDictionary = new n(t._texture));
                var e = this._fntConfig;
                if (e) {
                    var r = e.fontDefDictionary;
                    for (var s in r) {
                        var o = new i(), a = r[s].rect;
                        o.offsetX = r[s].xOffset, o.offsetY = r[s].yOffset, o.w = a.width, o.h = a.height, 
                        o.u = a.x, o.v = a.y, o.textureID = 0, o.valid = !0, o.xAdvance = r[s].xAdvance, 
                        this._fontDefDictionary.addLetterDefinitions(s, o);
                    }
                }
            }
        });
        cc.BitmapFont = r, cc.BitmapFont.FontLetterDefinition = i, cc.BitmapFont.FontAtlas = n, 
        e.exports = r;
    }, {} ],
    61: [ function(t, e) {
        "use strict";
        var i = cc.Class({
            name: "cc.BufferAsset",
            extends: cc.Asset,
            ctor: function() {
                this._buffer = null;
            },
            properties: {
                _nativeAsset: {
                    get: function() {
                        return this._buffer;
                    },
                    set: function(t) {
                        this._buffer = t.buffer || t;
                    },
                    override: !0
                },
                buffer: function() {
                    return this._buffer;
                }
            }
        });
        cc.BufferAsset = e.exports = i;
    }, {} ],
    62: [ function(t, e) {
        "use strict";
        var i = cc.Class({
            name: "cc.Font",
            extends: cc.Asset
        });
        cc.Font = e.exports = i;
    }, {} ],
    63: [ function(t, e) {
        "use strict";
        var i = cc.Class({
            name: "cc.JsonAsset",
            extends: cc.Asset,
            properties: {
                json: null
            }
        });
        e.exports = cc.JsonAsset = i;
    }, {} ],
    64: [ function(t, e) {
        "use strict";
        var i = cc.Class({
            name: "cc.LabelAtlas",
            extends: cc.BitmapFont,
            onLoad: function() {
                this.spriteFrame ? this._fntConfig ? this._super() : cc.warnID(9101, this.name) : cc.warnID(9100, this.name);
            }
        });
        cc.LabelAtlas = i, e.exports = i;
    }, {} ],
    65: [ function(t, e) {
        "use strict";
        var i = cc.Enum({
            AUTO: 0,
            SINGLE_INSTANCE: 1,
            MULTI_INSTANCE: 2
        }), n = cc.Class({
            name: "cc.Prefab",
            extends: cc.Asset,
            ctor: function() {
                this._createFunction = null, this._instantiatedTimes = 0;
            },
            properties: {
                data: null,
                optimizationPolicy: i.AUTO,
                asyncLoadAssets: !1,
                readonly: {
                    default: !1,
                    editorOnly: !0
                }
            },
            statics: {
                OptimizationPolicy: i,
                OptimizationPolicyThreshold: 3
            },
            createNode: !1,
            compileCreateFunction: function() {
                var e = t("../platform/instantiate-jit");
                this._createFunction = e.compile(this.data);
            },
            _doInstantiate: function(t) {
                return this.data._prefab || cc.warnID(3700), this._createFunction || this.compileCreateFunction(), 
                this._createFunction(t);
            },
            _instantiate: function() {
                var t;
                return t = this.data._instantiate(), ++this._instantiatedTimes, t;
            },
            destroy: function() {
                this.data && this.data.destroy(), this._super();
            }
        });
        cc.Prefab = e.exports = n, cc.js.obsolete(cc, "cc._Prefab", "Prefab");
    }, {
        "../platform/instantiate-jit": 201
    } ],
    66: [ function(t, e) {
        "use strict";
        var i, n = (i = t("../../renderer/gfx")) && i.__esModule ? i : {
            default: i
        }, r = t("../renderer"), s = t("./CCTexture2D"), o = cc.Enum({
            RB_FMT_D24S8: n.default.RB_FMT_D24S8,
            RB_FMT_S8: n.default.RB_FMT_S8,
            RB_FMT_D16: n.default.RB_FMT_D16
        }), a = cc.Class({
            name: "cc.RenderTexture",
            extends: s,
            statics: {
                DepthStencilFormat: o
            },
            ctor: function() {
                this._framebuffer = null;
            },
            initWithSize: function(t, e, i) {
                this.width = Math.floor(t || cc.visibleRect.width), this.height = Math.floor(e || cc.visibleRect.height), 
                this._resetUnderlyingMipmaps();
                var s, o = {
                    colors: [ this._texture ]
                };
                this._depthStencilBuffer && this._depthStencilBuffer.destroy(), i && (s = new n.default.RenderBuffer(r.device, i, t, e), 
                i === n.default.RB_FMT_D24S8 ? o.depthStencil = s : i === n.default.RB_FMT_S8 ? o.stencil = s : i === n.default.RB_FMT_D16 && (o.depth = s)), 
                this._depthStencilBuffer = s, this._framebuffer && this._framebuffer.destroy(), 
                this._framebuffer = new n.default.FrameBuffer(r.device, t, e, o), this._packable = !1, 
                this.loaded = !0, this.emit("load");
            },
            updateSize: function(t, e) {
                this.width = Math.floor(t || cc.visibleRect.width), this.height = Math.floor(e || cc.visibleRect.height), 
                this._resetUnderlyingMipmaps();
                var i = this._depthStencilBuffer;
                i && i.update(this.width, this.height), this._framebuffer._width = t, this._framebuffer._height = e;
            },
            drawTextureAt: function(t, e, i) {
                t._image && 0 !== t._image.width && this._texture.updateSubImage({
                    x: e,
                    y: i,
                    image: t._image,
                    width: t.width,
                    height: t.height,
                    level: 0,
                    flipY: !1,
                    premultiplyAlpha: t._premultiplyAlpha
                });
            },
            readPixels: function(t, e, i, n, r) {
                if (!this._framebuffer || !this._texture) return t;
                e = e || 0, i = i || 0;
                var s = n || this.width, o = r || this.height;
                t = t || new Uint8Array(s * o * 4);
                var a = cc.game._renderContext, c = a.getParameter(a.FRAMEBUFFER_BINDING);
                return a.bindFramebuffer(a.FRAMEBUFFER, this._framebuffer.getHandle()), a.readPixels(e, i, s, o, a.RGBA, a.UNSIGNED_BYTE, t), 
                a.bindFramebuffer(a.FRAMEBUFFER, c), t;
            },
            destroy: function() {
                this._super(), this._framebuffer && (this._framebuffer.destroy(), this._framebuffer = null);
            }
        });
        cc.RenderTexture = e.exports = a;
    }, {
        "../../renderer/gfx": 298,
        "../renderer": 213,
        "./CCTexture2D": 73
    } ],
    67: [ function(t, e) {
        "use strict";
        var i = cc.Class({
            name: "cc.SceneAsset",
            extends: cc.Asset,
            properties: {
                scene: null,
                asyncLoadAssets: void 0
            }
        });
        cc.SceneAsset = i, e.exports = i;
    }, {} ],
    68: [ function() {
        "use strict";
        var t = cc.Class({
            name: "cc.Script",
            extends: cc.Asset
        });
        cc._Script = t;
        var e = cc.Class({
            name: "cc.JavaScript",
            extends: t
        });
        cc._JavaScript = e;
        var i = cc.Class({
            name: "cc.TypeScript",
            extends: t
        });
        cc._TypeScript = i;
    }, {} ],
    69: [ function(t, e) {
        "use strict";
        var i = cc.Class({
            name: "cc.SpriteAtlas",
            extends: cc.Asset,
            properties: {
                _spriteFrames: {
                    default: {}
                }
            },
            getTexture: function() {
                var t = Object.keys(this._spriteFrames);
                if (t.length > 0) {
                    var e = this._spriteFrames[t[0]];
                    return e ? e.getTexture() : null;
                }
                return null;
            },
            getSpriteFrame: function(t) {
                var e = this._spriteFrames[t];
                return e ? (e.name || (e.name = t), e) : null;
            },
            getSpriteFrames: function() {
                var t = [], e = this._spriteFrames;
                for (var i in e) t.push(this.getSpriteFrame(i));
                return t;
            }
        });
        cc.SpriteAtlas = i, e.exports = i;
    }, {} ],
    70: [ function(t, e) {
        "use strict";
        var i = t("../event/event-target"), n = [ {
            u: 0,
            v: 0
        }, {
            u: 0,
            v: 0
        }, {
            u: 0,
            v: 0
        }, {
            u: 0,
            v: 0
        } ], r = cc.Class({
            name: "cc.SpriteFrame",
            extends: t("../assets/CCAsset"),
            mixins: [ i ],
            properties: {
                _textureSetter: {
                    set: function(t) {
                        t && this._texture !== t && this._refreshTexture(t);
                    }
                },
                insetTop: {
                    get: function() {
                        return this._capInsets[1];
                    },
                    set: function(t) {
                        this._capInsets[1] = t, this._texture && this._calculateSlicedUV();
                    }
                },
                insetBottom: {
                    get: function() {
                        return this._capInsets[3];
                    },
                    set: function(t) {
                        this._capInsets[3] = t, this._texture && this._calculateSlicedUV();
                    }
                },
                insetLeft: {
                    get: function() {
                        return this._capInsets[0];
                    },
                    set: function(t) {
                        this._capInsets[0] = t, this._texture && this._calculateSlicedUV();
                    }
                },
                insetRight: {
                    get: function() {
                        return this._capInsets[2];
                    },
                    set: function(t) {
                        this._capInsets[2] = t, this._texture && this._calculateSlicedUV();
                    }
                }
            },
            ctor: function() {
                i.call(this);
                var t = arguments[0], e = arguments[1], n = arguments[2], r = arguments[3], s = arguments[4];
                this._rect = null, this.uv = [], this._texture = null, this._original = null, this._offset = null, 
                this._originalSize = null, this._rotated = !1, this._flipX = !1, this._flipY = !1, 
                this.vertices = null, this._capInsets = [ 0, 0, 0, 0 ], this.uvSliced = [], void 0 !== t && this.setTexture(t, e, n, r, s);
            },
            textureLoaded: function() {
                return this._texture && this._texture.loaded;
            },
            onTextureLoaded: function(t, e) {
                return this.textureLoaded() ? (t.call(e), !0) : (this.once("load", t, e), this.ensureLoadTexture(), 
                !1);
            },
            isRotated: function() {
                return this._rotated;
            },
            setRotated: function(t) {
                this._rotated = t, this._texture && this._calculateUV();
            },
            isFlipX: function() {
                return this._flipX;
            },
            isFlipY: function() {
                return this._flipY;
            },
            setFlipX: function(t) {
                this._flipX = t, this._texture && this._calculateUV();
            },
            setFlipY: function(t) {
                this._flipY = t, this._texture && this._calculateUV();
            },
            getRect: function() {
                return cc.rect(this._rect);
            },
            setRect: function(t) {
                this._rect = t, this._texture && this._calculateUV();
            },
            getOriginalSize: function() {
                return cc.size(this._originalSize);
            },
            setOriginalSize: function(t) {
                this._originalSize ? (this._originalSize.width = t.width, this._originalSize.height = t.height) : this._originalSize = cc.size(t);
            },
            getTexture: function() {
                return this._texture;
            },
            _textureLoadedCallback: function() {
                var t = this._texture;
                if (t) {
                    var e = t.width, i = t.height;
                    this._rect ? this._checkRect(this._texture) : this._rect = cc.rect(0, 0, e, i), 
                    this._originalSize || this.setOriginalSize(cc.size(e, i)), this._offset || this.setOffset(cc.v2(0, 0)), 
                    this._calculateUV(), this.emit("load");
                }
            },
            _refreshTexture: function(t) {
                this._texture = t, t.loaded ? this._textureLoadedCallback() : t.once("load", this._textureLoadedCallback, this);
            },
            getOffset: function() {
                return cc.v2(this._offset);
            },
            setOffset: function(t) {
                this._offset = cc.v2(t);
            },
            clone: function() {
                return new r(this._texture, this.getRect(), this._rotated, this.getOffset(), this.getOriginalSize());
            },
            setTexture: function(t, e, i, n, r) {
                if (1 !== arguments.length || t !== this._texture) {
                    if (this._rect = e || null, n ? this.setOffset(n) : this._offset = null, r ? this.setOriginalSize(r) : this._originalSize = null, 
                    this._rotated = i || !1, "string" != typeof t) return t instanceof cc.Texture2D && this._refreshTexture(t), 
                    !0;
                    cc.errorID(3401);
                }
            },
            ensureLoadTexture: function() {
                this._texture && (this._texture.loaded || (this._refreshTexture(this._texture), 
                cc.assetManager.postLoadNative(this._texture)));
            },
            _checkRect: function(t) {
                var e = this._rect, i = e.x, n = e.y;
                this._rotated ? (i += e.height, n += e.width) : (i += e.width, n += e.height), i > t.width && cc.errorID(3300, t.nativeUrl + "/" + this.name, i, t.width), 
                n > t.height && cc.errorID(3400, t.nativeUrl + "/" + this.name, n, t.height);
            },
            _flipXY: function(t) {
                if (this._flipX) {
                    var e = t[0];
                    t[0] = t[1], t[1] = e, e = t[2], t[2] = t[3], t[3] = e;
                }
                if (this._flipY) {
                    var i = t[0];
                    t[0] = t[2], t[2] = i, i = t[1], t[1] = t[3], t[3] = i;
                }
            },
            _calculateSlicedUV: function() {
                var t = this._rect, e = this._texture.width, i = this._texture.height, r = this._capInsets[0], s = this._capInsets[2], o = t.width - r - s, a = this._capInsets[1], c = this._capInsets[3], l = t.height - a - c, u = this.uvSliced;
                if (u.length = 0, this._rotated) {
                    n[0].u = t.x / e, n[1].u = (t.x + c) / e, n[2].u = (t.x + c + l) / e, n[3].u = (t.x + t.height) / e, 
                    n[3].v = t.y / i, n[2].v = (t.y + r) / i, n[1].v = (t.y + r + o) / i, n[0].v = (t.y + t.width) / i, 
                    this._flipXY(n);
                    for (var h = 0; h < 4; ++h) for (var _ = n[h], f = 0; f < 4; ++f) {
                        var d = n[3 - f];
                        u.push({
                            u: _.u,
                            v: d.v
                        });
                    }
                } else {
                    n[0].u = t.x / e, n[1].u = (t.x + r) / e, n[2].u = (t.x + r + o) / e, n[3].u = (t.x + t.width) / e, 
                    n[3].v = t.y / i, n[2].v = (t.y + a) / i, n[1].v = (t.y + a + l) / i, n[0].v = (t.y + t.height) / i, 
                    this._flipXY(n);
                    for (var p = 0; p < 4; ++p) for (var m = n[p], v = 0; v < 4; ++v) {
                        var y = n[v];
                        u.push({
                            u: y.u,
                            v: m.v
                        });
                    }
                }
            },
            _setDynamicAtlasFrame: function(t) {
                t && (this._original = {
                    _texture: this._texture,
                    _x: this._rect.x,
                    _y: this._rect.y
                }, this._texture = t.texture, this._rect.x = t.x, this._rect.y = t.y, this._calculateUV());
            },
            _resetDynamicAtlasFrame: function() {
                this._original && (this._rect.x = this._original._x, this._rect.y = this._original._y, 
                this._texture = this._original._texture, this._original = null, this._calculateUV());
            },
            _calculateUV: function() {
                var t = this._rect, e = this._texture, i = this.uv, n = e.width, r = e.height;
                if (this._rotated) {
                    var s = 0 === n ? 0 : t.x / n, o = 0 === n ? 0 : (t.x + t.height) / n, a = 0 === r ? 0 : (t.y + t.width) / r, c = 0 === r ? 0 : t.y / r;
                    i[0] = s, i[1] = c, i[2] = s, i[3] = a, i[4] = o, i[5] = c, i[6] = o, i[7] = a;
                } else {
                    var l = 0 === n ? 0 : t.x / n, u = 0 === n ? 0 : (t.x + t.width) / n, h = 0 === r ? 0 : (t.y + t.height) / r, _ = 0 === r ? 0 : t.y / r;
                    i[0] = l, i[1] = h, i[2] = u, i[3] = h, i[4] = l, i[5] = _, i[6] = u, i[7] = _;
                }
                if (this._flipX) {
                    var f = i[0];
                    i[0] = i[2], i[2] = f, f = i[1], i[1] = i[3], i[3] = f, f = i[4], i[4] = i[6], i[6] = f, 
                    f = i[5], i[5] = i[7], i[7] = f;
                }
                if (this._flipY) {
                    var d = i[0];
                    i[0] = i[4], i[4] = d, d = i[1], i[1] = i[5], i[5] = d, d = i[2], i[2] = i[6], i[6] = d, 
                    d = i[3], i[3] = i[7], i[7] = d;
                }
                var p = this.vertices;
                if (p) {
                    p.nu.length = 0, p.nv.length = 0;
                    for (var m = 0; m < p.u.length; m++) p.nu[m] = p.u[m] / n, p.nv[m] = p.v[m] / r;
                }
                this._calculateSlicedUV();
            },
            _serialize: !1,
            _deserialize: function(t) {
                var e = t.rect;
                e && (this._rect = new cc.Rect(e[0], e[1], e[2], e[3])), t.offset && this.setOffset(new cc.Vec2(t.offset[0], t.offset[1])), 
                t.originalSize && this.setOriginalSize(new cc.Size(t.originalSize[0], t.originalSize[1])), 
                this._rotated = 1 === t.rotated, this._name = t.name;
                var i = t.capInsets;
                i && (this._capInsets[0] = i[0], this._capInsets[1] = i[1], this._capInsets[2] = i[2], 
                this._capInsets[3] = i[3]), this.vertices = t.vertices, this.vertices && (this.vertices.nu = [], 
                this.vertices.nv = []);
            }
        }), s = r.prototype;
        s.copyWithZone = s.clone, s.copy = s.clone, s.initWithTexture = s.setTexture, cc.SpriteFrame = r, 
        e.exports = r;
    }, {
        "../assets/CCAsset": 58,
        "../event/event-target": 129
    } ],
    71: [ function(t, e) {
        "use strict";
        var i = t("./CCFont"), n = cc.Class({
            name: "cc.TTFFont",
            extends: i,
            properties: {
                _fontFamily: null,
                _nativeAsset: {
                    type: cc.String,
                    get: function() {
                        return this._fontFamily;
                    },
                    set: function(t) {
                        this._fontFamily = t || "Arial";
                    },
                    override: !0
                },
                _nativeDep: {
                    get: function() {
                        return {
                            uuid: this._uuid,
                            __nativeName__: this._native,
                            ext: cc.path.extname(this._native),
                            __isNative__: !0
                        };
                    },
                    override: !0
                }
            }
        });
        cc.TTFFont = e.exports = n;
    }, {
        "./CCFont": 62
    } ],
    72: [ function(t, e) {
        "use strict";
        var i = cc.Class({
            name: "cc.TextAsset",
            extends: cc.Asset,
            properties: {
                text: ""
            },
            toString: function() {
                return this.text;
            }
        });
        e.exports = cc.TextAsset = i;
    }, {} ],
    73: [ function(t, e) {
        "use strict";
        var i, n = (i = t("../../renderer/gfx")) && i.__esModule ? i : {
            default: i
        }, r = t("../event/event-target"), s = t("../renderer");
        t("../platform/CCClass");
        var o = new (t("../platform/id-generater"))("Tex"), a = 1024, c = cc.Enum({
            RGB565: n.default.TEXTURE_FMT_R5_G6_B5,
            RGB5A1: n.default.TEXTURE_FMT_R5_G5_B5_A1,
            RGBA4444: n.default.TEXTURE_FMT_R4_G4_B4_A4,
            RGB888: n.default.TEXTURE_FMT_RGB8,
            RGBA8888: n.default.TEXTURE_FMT_RGBA8,
            RGBA32F: n.default.TEXTURE_FMT_RGBA32F,
            A8: n.default.TEXTURE_FMT_A8,
            I8: n.default.TEXTURE_FMT_L8,
            AI8: n.default.TEXTURE_FMT_L8_A8,
            RGB_PVRTC_2BPPV1: n.default.TEXTURE_FMT_RGB_PVRTC_2BPPV1,
            RGBA_PVRTC_2BPPV1: n.default.TEXTURE_FMT_RGBA_PVRTC_2BPPV1,
            RGB_A_PVRTC_2BPPV1: a++,
            RGB_PVRTC_4BPPV1: n.default.TEXTURE_FMT_RGB_PVRTC_4BPPV1,
            RGBA_PVRTC_4BPPV1: n.default.TEXTURE_FMT_RGBA_PVRTC_4BPPV1,
            RGB_A_PVRTC_4BPPV1: a++,
            RGB_ETC1: n.default.TEXTURE_FMT_RGB_ETC1,
            RGBA_ETC1: a++,
            RGB_ETC2: n.default.TEXTURE_FMT_RGB_ETC2,
            RGBA_ETC2: n.default.TEXTURE_FMT_RGBA_ETC2
        }), l = cc.Enum({
            REPEAT: 10497,
            CLAMP_TO_EDGE: 33071,
            MIRRORED_REPEAT: 33648
        }), u = cc.Enum({
            LINEAR: 9729,
            NEAREST: 9728
        }), h = {
            9728: 0,
            9729: 1
        }, _ = [], f = {
            width: void 0,
            height: void 0,
            minFilter: void 0,
            magFilter: void 0,
            wrapS: void 0,
            wrapT: void 0,
            format: void 0,
            genMipmaps: void 0,
            images: void 0,
            image: void 0,
            flipY: void 0,
            premultiplyAlpha: void 0
        };
        function d() {
            for (var t in f) f[t] = void 0;
            return _.length = 0, f.images = _, f;
        }
        var p = cc.Class({
            name: "cc.Texture2D",
            extends: t("../assets/CCAsset"),
            mixins: [ r ],
            properties: {
                _nativeAsset: {
                    get: function() {
                        return this._image;
                    },
                    set: function(t) {
                        t._compressed && t._data ? this.initWithData(t._data, this._format, t.width, t.height) : this.initWithElement(t);
                    },
                    override: !0
                },
                _format: c.RGBA8888,
                _premultiplyAlpha: !1,
                _flipY: !1,
                _minFilter: u.LINEAR,
                _magFilter: u.LINEAR,
                _mipFilter: u.LINEAR,
                _wrapS: l.CLAMP_TO_EDGE,
                _wrapT: l.CLAMP_TO_EDGE,
                _isAlphaAtlas: !1,
                _genMipmaps: !1,
                genMipmaps: {
                    get: function() {
                        return this._genMipmaps;
                    },
                    set: function(t) {
                        if (this._genMipmaps !== t) {
                            var e = d();
                            e.genMipmaps = t, this.update(e);
                        }
                    }
                },
                _packable: !0,
                packable: {
                    get: function() {
                        return this._packable;
                    },
                    set: function(t) {
                        this._packable = t;
                    }
                },
                _nativeDep: {
                    get: function() {
                        return {
                            __isNative__: !0,
                            uuid: this._uuid,
                            ext: this._native,
                            __flipY__: this._flipY,
                            __premultiplyAlpha__: this._premultiplyAlpha
                        };
                    },
                    override: !0
                }
            },
            statics: {
                PixelFormat: c,
                WrapMode: l,
                Filter: u,
                _FilterIndex: h,
                extnames: [ ".png", ".jpg", ".jpeg", ".bmp", ".webp", ".pvr", ".pkm" ],
                _parseExt: function(t, e) {
                    for (var i = cc.renderer.device, n = t.split("_"), r = "", s = "", o = 999, a = e, l = cc.macro.SUPPORT_TEXTURE_FORMATS, u = 0; u < n.length; u++) {
                        var h = n[u].split("@"), _ = h[0];
                        _ = p.extnames[_.charCodeAt(0) - 48] || _;
                        var f = l.indexOf(_);
                        if (-1 !== f && f < o) {
                            var d = h[1] ? parseInt(h[1]) : e;
                            if (".pvr" === _ && !i.ext("WEBGL_compressed_texture_pvrtc")) continue;
                            if (!(d !== c.RGB_ETC1 && d !== c.RGBA_ETC1 || i.ext("WEBGL_compressed_texture_etc1"))) continue;
                            if (!(d !== c.RGB_ETC2 && d !== c.RGBA_ETC2 || i.ext("WEBGL_compressed_texture_etc"))) continue;
                            if (".webp" === _ && !cc.sys.capabilities.webp) continue;
                            o = f, s = _, a = d;
                        } else r || (r = _);
                    }
                    return {
                        bestExt: s,
                        bestFormat: a,
                        defaultExt: r
                    };
                }
            },
            ctor: function() {
                this._id = o.getNewId(), this.loaded = !1, this.width = 0, this.height = 0, this._hashDirty = !0, 
                this._hash = 0, this._texture = null;
            },
            getImpl: function() {
                return this._texture || (this._texture = new s.Texture2D(s.device, {})), this._texture;
            },
            getId: function() {
                return this._id;
            },
            toString: function() {
                return this.nativeUrl || "";
            },
            update: function(t) {
                if (t) {
                    var e = !1;
                    void 0 !== t.width && (this.width = t.width), void 0 !== t.height && (this.height = t.height), 
                    void 0 !== t.minFilter && (this._minFilter = t.minFilter, t.minFilter = h[t.minFilter]), 
                    void 0 !== t.magFilter && (this._magFilter = t.magFilter, t.magFilter = h[t.magFilter]), 
                    void 0 !== t.mipFilter && (this._mipFilter = t.mipFilter, t.mipFilter = h[t.mipFilter]), 
                    void 0 !== t.wrapS && (this._wrapS = t.wrapS), void 0 !== t.wrapT && (this._wrapT = t.wrapT), 
                    void 0 !== t.format && (this._format = t.format), void 0 !== t.flipY && (this._flipY = t.flipY, 
                    e = !0), void 0 !== t.premultiplyAlpha && (this._premultiplyAlpha = t.premultiplyAlpha, 
                    e = !0), void 0 !== t.genMipmaps && (this._genMipmaps = t.genMipmaps), cc.sys.capabilities.imageBitmap && this._image instanceof ImageBitmap ? this._checkImageBitmap(this._upload.bind(this, t, e)) : this._upload(t, e);
                }
            },
            _upload: function(t, e) {
                e && this._image && (t.image = this._image), t.images && t.images.length > 0 ? this._image = t.images[0] : void 0 !== t.image && (this._image = t.image, 
                t.images || (_.length = 0, t.images = _), t.images.push(t.image)), this._texture && this._texture.update(t), 
                this._hashDirty = !0;
            },
            initWithElement: function(t) {
                if (t) if (this._image = t, t.complete || t instanceof HTMLCanvasElement) this.handleLoadedTexture(); else if (cc.sys.capabilities.imageBitmap && t instanceof ImageBitmap) this._checkImageBitmap(this.handleLoadedTexture.bind(this)); else {
                    var e = this;
                    t.addEventListener("load", function() {
                        e.handleLoadedTexture();
                    }), t.addEventListener("error", function(t) {
                        cc.warnID(3119, t.message);
                    });
                }
            },
            initWithData: function(t, e, i, n) {
                var r = d();
                return r.image = t, r.images = [ r.image ], r.genMipmaps = this._genMipmaps, r.premultiplyAlpha = this._premultiplyAlpha, 
                r.flipY = this._flipY, r.minFilter = h[this._minFilter], r.magFilter = h[this._magFilter], 
                r.wrapS = this._wrapS, r.wrapT = this._wrapT, r.format = this._getGFXPixelFormat(e), 
                r.width = i, r.height = n, this._texture ? this._texture.update(r) : this._texture = new s.Texture2D(s.device, r), 
                this.width = i, this.height = n, this._updateFormat(), this._checkPackable(), this.loaded = !0, 
                this.emit("load"), !0;
            },
            getHtmlElementObj: function() {
                return this._image;
            },
            destroy: function() {
                cc.sys.capabilities.imageBitmap && this._image instanceof ImageBitmap && this._image.close && this._image.close(), 
                this._packable && cc.dynamicAtlasManager && cc.dynamicAtlasManager.deleteAtlasTexture(this), 
                this._image = null, this._texture && this._texture.destroy(), this._super();
            },
            getPixelFormat: function() {
                return this._format;
            },
            hasPremultipliedAlpha: function() {
                return this._premultiplyAlpha || !1;
            },
            isAlphaAtlas: function() {
                return this._isAlphaAtlas;
            },
            handleLoadedTexture: function() {
                if (this._image && this._image.width && this._image.height) {
                    this.width = this._image.width, this.height = this._image.height;
                    var t = d();
                    t.image = this._image, t.images = [ t.image ], t.width = this.width, t.height = this.height, 
                    t.genMipmaps = this._genMipmaps, t.format = this._getGFXPixelFormat(this._format), 
                    t.premultiplyAlpha = this._premultiplyAlpha, t.flipY = this._flipY, t.minFilter = h[this._minFilter], 
                    t.magFilter = h[this._magFilter], t.wrapS = this._wrapS, t.wrapT = this._wrapT, 
                    this._texture ? this._texture.update(t) : this._texture = new s.Texture2D(s.device, t), 
                    this._updateFormat(), this._checkPackable(), this.loaded = !0, this.emit("load"), 
                    cc.macro.CLEANUP_IMAGE_CACHE && (this._image instanceof HTMLImageElement ? this._clearImage() : cc.sys.capabilities.imageBitmap && this._image instanceof ImageBitmap && this._image.close && this._image.close());
                }
            },
            description: function() {
                return "<cc.Texture2D | Name = " + this.nativeUrl + " | Dimensions = " + this.width + " x " + this.height + ">";
            },
            releaseTexture: function() {
                this._image = null, this._texture && this._texture.destroy();
            },
            setWrapMode: function(t, e) {
                if (this._wrapS !== t || this._wrapT !== e) {
                    var i = d();
                    i.wrapS = t, i.wrapT = e, this.update(i);
                }
            },
            setFilters: function(t, e) {
                if (this._minFilter !== t || this._magFilter !== e) {
                    var i = d();
                    i.minFilter = t, i.magFilter = e, this.update(i);
                }
            },
            setFlipY: function(t) {
                if (this._flipY !== t) {
                    var e = d();
                    e.flipY = t, e.premultiplyAlpha = this._premultiplyAlpha, this.update(e);
                }
            },
            setPremultiplyAlpha: function(t) {
                if (this._premultiplyAlpha !== t) {
                    var e = d();
                    e.flipY = this._flipY, e.premultiplyAlpha = t, this.update(e);
                }
            },
            _updateFormat: function() {
                this._isAlphaAtlas = this._format === c.RGBA_ETC1 || this._format === c.RGB_A_PVRTC_4BPPV1 || this._format === c.RGB_A_PVRTC_2BPPV1;
            },
            _checkPackable: function() {
                var t = cc.dynamicAtlasManager;
                if (t) if (this._isCompressed()) this._packable = !1; else {
                    var e = this.width, i = this.height;
                    !this._image || e > t.maxFrameSize || i > t.maxFrameSize || this._getHash() !== t.Atlas.DEFAULT_HASH ? this._packable = !1 : this._image && this._image instanceof HTMLCanvasElement && (this._packable = !0);
                }
            },
            _getOpts: function() {
                var t = d();
                return t.width = this.width, t.height = this.height, t.genMipmaps = this._genMipmaps, 
                t.format = this._format, t.premultiplyAlpha = this._premultiplyAlpha, t.anisotropy = this._anisotropy, 
                t.flipY = this._flipY, t.minFilter = h[this._minFilter], t.magFilter = h[this._magFilter], 
                t.mipFilter = h[this._mipFilter], t.wrapS = this._wrapS, t.wrapT = this._wrapT, 
                t;
            },
            _getGFXPixelFormat: function(t) {
                return t === c.RGBA_ETC1 ? t = c.RGB_ETC1 : t === c.RGB_A_PVRTC_4BPPV1 ? t = c.RGB_PVRTC_4BPPV1 : t === c.RGB_A_PVRTC_2BPPV1 && (t = c.RGB_PVRTC_2BPPV1), 
                t;
            },
            _resetUnderlyingMipmaps: function(t) {
                var e = this._getOpts();
                e.images = t || [ null ], this._texture ? this._texture.update(e) : this._texture = new s.Texture2D(s.device, e);
            },
            _serialize: !1,
            _deserialize: function(t) {
                var e = t.split(","), i = e[0];
                if (i) {
                    var n = p._parseExt(i, this._format);
                    if (n.bestExt) this._setRawAsset(n.bestExt), this._format = n.bestFormat; else {
                        if (!n.defaultExt) throw new Error(cc.debug.getError(3121));
                        this._setRawAsset(n.defaultExt), cc.warnID(3120, n.defaultExt, n.defaultExt);
                    }
                }
                8 === e.length && (this._minFilter = parseInt(e[1]), this._magFilter = parseInt(e[2]), 
                this._wrapS = parseInt(e[3]), this._wrapT = parseInt(e[4]), this._premultiplyAlpha = 49 === e[5].charCodeAt(0), 
                this._genMipmaps = 49 === e[6].charCodeAt(0), this._packable = 49 === e[7].charCodeAt(0));
            },
            _getHash: function() {
                if (!this._hashDirty) return this._hash;
                var t = this._genMipmaps ? 1 : 0, e = this._premultiplyAlpha ? 1 : 0, i = this._flipY ? 1 : 0, n = this._minFilter === u.LINEAR ? 1 : 2, r = this._magFilter === u.LINEAR ? 1 : 2, s = this._wrapS === l.REPEAT ? 1 : this._wrapS === l.CLAMP_TO_EDGE ? 2 : 3, o = this._wrapT === l.REPEAT ? 1 : this._wrapT === l.CLAMP_TO_EDGE ? 2 : 3, a = this._format;
                return this._image, this._hash = Number("" + n + r + a + s + o + t + e + i), this._hashDirty = !1, 
                this._hash;
            },
            _isCompressed: function() {
                return this._format < c.A8 || this._format > c.RGBA32F;
            },
            _clearImage: function() {
                this._image.src = "";
            },
            _checkImageBitmap: function(t) {
                var e = this, i = this._image, n = this._flipY, r = this._premultiplyAlpha;
                this._flipY !== i.flipY || this._premultiplyAlpha !== i.premultiplyAlpha ? createImageBitmap(i, {
                    imageOrientation: n !== i.flipY ? "flipY" : "none",
                    premultiplyAlpha: r ? "premultiply" : "none"
                }).then(function(s) {
                    i.close && i.close(), s.flipY = n, s.premultiplyAlpha = r, e._image = s, t();
                }, function(t) {
                    cc.error(t.message);
                }) : t();
            }
        });
        cc.Texture2D = e.exports = p;
    }, {
        "../../renderer/gfx": 298,
        "../assets/CCAsset": 58,
        "../event/event-target": 129,
        "../platform/CCClass": 182,
        "../platform/id-generater": 199,
        "../renderer": 213
    } ],
    74: [ function(t) {
        "use strict";
        t("./CCAsset"), t("./CCFont"), t("./CCPrefab"), t("./CCAudioClip"), t("./CCScripts"), 
        t("./CCSceneAsset"), t("./CCSpriteFrame"), t("./CCTexture2D"), t("./CCRenderTexture"), 
        t("./CCTTFFont"), t("./CCSpriteAtlas"), t("./CCBitmapFont"), t("./CCLabelAtlas"), 
        t("./CCTextAsset"), t("./CCJsonAsset"), t("./CCBufferAsset"), t("./material");
    }, {
        "./CCAsset": 58,
        "./CCAudioClip": 59,
        "./CCBitmapFont": 60,
        "./CCBufferAsset": 61,
        "./CCFont": 62,
        "./CCJsonAsset": 63,
        "./CCLabelAtlas": 64,
        "./CCPrefab": 65,
        "./CCRenderTexture": 66,
        "./CCSceneAsset": 67,
        "./CCScripts": 68,
        "./CCSpriteAtlas": 69,
        "./CCSpriteFrame": 70,
        "./CCTTFFont": 71,
        "./CCTextAsset": 72,
        "./CCTexture2D": 73,
        "./material": 81
    } ],
    75: [ function(t, e) {
        "use strict";
        var i, n = (i = t("../CCAsset")) && i.__esModule ? i : {
            default: i
        }, r = t("./effect-parser"), s = cc.Class({
            name: "cc.EffectAsset",
            extends: n.default,
            ctor: function() {
                this._effect = null;
            },
            properties: {
                properties: Object,
                techniques: [],
                shaders: []
            },
            onLoad: function() {
                if (cc.game.renderType !== cc.game.RENDER_TYPE_CANVAS) {
                    for (var t = cc.renderer._forward._programLib, e = 0; e < this.shaders.length; e++) t.define(this.shaders[e]);
                    this._initEffect();
                }
            },
            _initEffect: function() {
                this._effect || (this._effect = (0, r.parseEffect)(this), Object.freeze(this._effect));
            },
            getInstantiatedEffect: function() {
                return this._initEffect(), this._effect.clone();
            },
            getEffect: function() {
                return this._initEffect(), this._effect;
            }
        });
        e.exports = cc.EffectAsset = s;
    }, {
        "../CCAsset": 58,
        "./effect-parser": 78
    } ],
    76: [ function(t, e, i) {
        "use strict";
        i.__esModule = !0, i.default = void 0;
        var n = t("../CCAsset"), r = t("../CCTexture2D"), s = (r.PixelFormat, t("./CCEffectAsset")), o = (t("../../utils/texture-util"), 
        cc.gfx), a = cc.Enum({
            SPRITE: "2d-sprite",
            GRAY_SPRITE: "2d-gray-sprite",
            UNLIT: "unlit"
        }), c = cc.Class({
            name: "cc.Material",
            extends: n,
            ctor: function() {
                this.loaded = !1, this._manualHash = !1, this._dirty = !0, this._effect = null;
            },
            properties: {
                _defines: {
                    default: void 0,
                    type: Object
                },
                _props: {
                    default: void 0,
                    type: Object
                },
                _effectAsset: {
                    type: s,
                    default: null
                },
                _techniqueIndex: 0,
                _techniqueData: Object,
                effectName: void 0,
                effectAsset: {
                    get: function() {
                        return this._effectAsset;
                    },
                    set: function(t) {
                        cc.game.renderType !== cc.game.RENDER_TYPE_CANVAS && (this._effectAsset = t, t ? this._effect = this._effectAsset.getInstantiatedEffect() : cc.error("Can not set an empty effect asset."));
                    }
                },
                effect: {
                    get: function() {
                        return this._effect;
                    }
                },
                techniqueIndex: {
                    get: function() {
                        return this._techniqueIndex;
                    },
                    set: function(t) {
                        this._techniqueIndex = t, this._effect.switchTechnique(t);
                    }
                }
            },
            statics: {
                getBuiltinMaterial: function(t) {
                    return cc.game.renderType === cc.game.RENDER_TYPE_CANVAS ? new cc.Material() : cc.assetManager.builtins.getBuiltin("material", "builtin-" + t);
                },
                BUILTIN_NAME: a,
                createWithBuiltin: function(t, e) {
                    void 0 === e && (e = 0);
                    var i = cc.assetManager.builtins.getBuiltin("effect", "builtin-" + t);
                    return c.create(i, e);
                },
                create: function(t, e) {
                    if (void 0 === e && (e = 0), !t) return null;
                    var i = new c();
                    return i.effectAsset = t, i.techniqueIndex = e, i;
                }
            },
            setProperty: function(t, e, i, n) {
                if (cc.game.renderType !== cc.game.RENDER_TYPE_CANVAS) {
                    if ("string" == typeof i && (i = parseInt(i)), e instanceof r) {
                        var s = e.isAlphaAtlas(), o = "CC_USE_ALPHA_ATLAS_" + t, a = this.getDefine(o, i);
                        (s || a) && this.define(o, s), e.loaded || cc.assetManager.postLoadNative(e);
                    }
                    this._effect.setProperty(t, e, i, n);
                }
            },
            getProperty: function(t, e) {
                return "string" == typeof e && (e = parseInt(e)), this._effect.getProperty(t, e);
            },
            define: function(t, e, i, n) {
                cc.game.renderType !== cc.game.RENDER_TYPE_CANVAS && ("string" == typeof i && (i = parseInt(i)), 
                this._effect.define(t, e, i, n));
            },
            getDefine: function(t, e) {
                return "string" == typeof e && (e = parseInt(e)), this._effect.getDefine(t, e);
            },
            setCullMode: function(t, e) {
                void 0 === t && (t = o.CULL_BACK), this._effect.setCullMode(t, e);
            },
            setDepth: function(t, e, i, n) {
                void 0 === t && (t = !1), void 0 === e && (e = !1), void 0 === i && (i = o.DS_FUNC_LESS), 
                this._effect.setDepth(t, e, i, n);
            },
            setBlend: function(t, e, i, n, r, s, a, c, l) {
                void 0 === t && (t = !1), void 0 === e && (e = o.BLEND_FUNC_ADD), void 0 === i && (i = o.BLEND_SRC_ALPHA), 
                void 0 === n && (n = o.BLEND_ONE_MINUS_SRC_ALPHA), void 0 === r && (r = o.BLEND_FUNC_ADD), 
                void 0 === s && (s = o.BLEND_SRC_ALPHA), void 0 === a && (a = o.BLEND_ONE_MINUS_SRC_ALPHA), 
                void 0 === c && (c = 4294967295), this._effect.setBlend(t, e, i, n, r, s, a, c, l);
            },
            setStencilEnabled: function(t, e) {
                void 0 === t && (t = o.STENCIL_INHERIT), this._effect.setStencilEnabled(t, e);
            },
            setStencil: function(t, e, i, n, r, s, a, c, l) {
                void 0 === t && (t = o.STENCIL_INHERIT), void 0 === e && (e = o.DS_FUNC_ALWAYS), 
                void 0 === i && (i = 0), void 0 === n && (n = 255), void 0 === r && (r = o.STENCIL_OP_KEEP), 
                void 0 === s && (s = o.STENCIL_OP_KEEP), void 0 === a && (a = o.STENCIL_OP_KEEP), 
                void 0 === c && (c = 255), this._effect.setStencil(t, e, i, n, r, s, a, c, l);
            },
            updateHash: function(t) {
                this._manualHash = t, this._effect && this._effect.updateHash(t);
            },
            getHash: function() {
                return this._manualHash || this._effect && this._effect.getHash();
            },
            onLoad: function() {
                if (this.effectAsset = this._effectAsset, this._effect) {
                    this._techniqueIndex && this._effect.switchTechnique(this._techniqueIndex), this._techniqueData = this._techniqueData || {};
                    var t = this._techniqueData;
                    for (var e in t) {
                        var i = t[e = parseInt(e)];
                        if (i) {
                            for (var n in i.defines) this.define(n, i.defines[n], e);
                            for (var r in i.props) this.setProperty(r, i.props[r], e);
                        }
                    }
                }
            }
        }), l = c;
        i.default = l, cc.Material = c, e.exports = i.default;
    }, {
        "../../utils/texture-util": 264,
        "../CCAsset": 58,
        "../CCTexture2D": 73,
        "./CCEffectAsset": 75
    } ],
    77: [ function(t, e, i) {
        "use strict";
        i.__esModule = !0, i.default = void 0;
        var n, r = (n = t("../../../renderer/core/pass")) && n.__esModule ? n : {
            default: n
        };
        function s(t, e) {
            for (var i = 0; i < e.length; i++) {
                var n = e[i];
                n.enumerable = n.enumerable || !1, n.configurable = !0, "value" in n && (n.writable = !0), 
                Object.defineProperty(t, n.key, n);
            }
        }
        var o = cc.gfx, a = function() {
            function t() {
                this._dirty = !0, this._name = "", this._technique = null;
            }
            var e, i, n = t.prototype;
            return n._createPassProp = function(t, e) {
                var i = e._properties[t];
                if (i) {
                    var n = Object.create(null);
                    return n.name = t, n.type = i.type, i.value instanceof Float32Array ? n.value = new Float32Array(i.value) : n.value = i.value, 
                    e._properties[t] = n, n;
                }
            }, n._setPassProperty = function(t, e, i, n) {
                var s = i._properties.hasOwnProperty(t);
                if (s) {
                    if (s.value === e) return;
                } else s = this._createPassProp(t, i);
                return this._dirty = !0, r.default.prototype.setProperty.call(i, t, e, n);
            }, n.setProperty = function(t, e, i, n) {
                var r = !1, s = this.passes, o = 0, a = s.length;
                void 0 !== i && (o = i, a = i + 1);
                for (var c = o; c < a; c++) this._setPassProperty(t, e, s[c], n) && (r = !0);
                r || cc.warnID(9103, this.name, t);
            }, n.getProperty = function(t, e) {
                var i = this.passes;
                if (!(e >= i.length)) {
                    var n = 0, r = i.length;
                    void 0 !== e && (n = e, r = e + 1);
                    for (var s = n; s < r; s++) {
                        var o = i[s].getProperty(t);
                        if (void 0 !== o) return o;
                    }
                }
            }, n.define = function(t, e, i, n) {
                var r = !1, s = this.passes, o = 0, a = s.length;
                void 0 !== i && (o = i, a = i + 1);
                for (var c = o; c < a; c++) s[c].define(t, e, n) && (r = !0);
                r || cc.warnID(9104, this.name, t);
            }, n.getDefine = function(t, e) {
                var i = this.passes;
                if (!(e >= i.length)) {
                    var n = 0, r = i.length;
                    void 0 !== e && (n = e, r = e + 1);
                    for (var s = n; s < r; s++) {
                        var o = i[s].getDefine(t);
                        if (void 0 !== o) return o;
                    }
                }
            }, n.setCullMode = function(t, e) {
                void 0 === t && (t = o.CULL_BACK);
                var i = this.passes, n = 0, r = i.length;
                void 0 !== e && (n = e, r = e + 1);
                for (var s = n; s < r; s++) i[s].setCullMode(t);
                this._dirty = !0;
            }, n.setDepth = function(t, e, i, n) {
                var r = this.passes, s = 0, o = r.length;
                void 0 !== n && (s = n, o = n + 1);
                for (var a = s; a < o; a++) r[a].setDepth(t, e, i);
                this._dirty = !0;
            }, n.setBlend = function(t, e, i, n, r, s, o, a, c) {
                var l = this.passes, u = 0, h = l.length;
                void 0 !== c && (u = c, h = c + 1);
                for (var _ = u; _ < h; _++) l[_].setBlend(t, e, i, n, r, s, o, a);
                this._dirty = !0;
            }, n.setStencilEnabled = function(t, e) {
                void 0 === t && (t = o.STENCIL_INHERIT);
                var i = this.passes, n = 0, r = i.length;
                void 0 !== e && (n = e, r = e + 1);
                for (var s = n; s < r; s++) i[s].setStencilEnabled(t);
                this._dirty = !0;
            }, n.setStencil = function(t, e, i, n, r, s, o, a, c) {
                var l = this.passes, u = 0, h = l.length;
                void 0 !== c && (u = c, h = c + 1);
                for (var _ = u; _ < h; _++) {
                    var f = l[_];
                    f.setStencilFront(t, e, i, n, r, s, o, a), f.setStencilBack(t, e, i, n, r, s, o, a);
                }
                this._dirty = !0;
            }, e = t, (i = [ {
                key: "name",
                get: function() {
                    return this._name;
                }
            }, {
                key: "technique",
                get: function() {
                    return this._technique;
                }
            }, {
                key: "passes",
                get: function() {
                    return [];
                }
            } ]) && s(e.prototype, i), t;
        }();
        i.default = a, cc.EffectBase = a, e.exports = i.default;
    }, {
        "../../../renderer/core/pass": 289
    } ],
    78: [ function(t, e, i) {
        "use strict";
        i.__esModule = !0, i.parseEffect = function(t) {
            var e = _(t);
            return new o.default(t.name, e, 0, t);
        };
        var n = c(t("../../../renderer/core/pass")), r = t("../../../renderer/types"), s = c(t("../../../renderer/enums")), o = c(t("./effect")), a = c(t("../../../renderer/core/technique"));
        function c(t) {
            return t && t.__esModule ? t : {
                default: t
            };
        }
        function l(t) {
            return cc.renderer._forward._programLib.getTemplate(t);
        }
        function u(t, e) {
            var i = e.properties || {}, n = l(e.program), o = function(e) {
                if (!n.uniforms.find(function(t) {
                    return t.name === e;
                })) return cc.warnID(9107, t.name, e), "continue";
            };
            for (var a in i) o(a);
            var c = {};
            return n.uniforms.forEach(function(t) {
                var e = t.name, n = c[e] = Object.assign({}, t), o = i[e], a = r.enums2default[t.type];
                a = o ? o.type === s.default.PARAM_TEXTURE_2D ? null : o.type === s.default.PARAM_INT || o.type === s.default.PARAM_FLOAT ? Array.isArray(o.value) ? o.value[0] : o.value : new Float32Array(o.value) : r.enums2default[t.type], 
                n.value = a;
            }), c;
        }
        function h(t) {
            var e = {};
            return l(t.program).defines.forEach(function(t) {
                e[t.name] = r.enums2default[t.type];
            }), e;
        }
        function _(t) {
            for (var e = t.techniques.length, i = new Array(e), r = 0; r < e; ++r) {
                for (var s = t.techniques[r], o = s.name || r, c = s.passes.length, l = new Array(c), _ = 0; _ < c; ++_) {
                    var f = s.passes[_], d = f.name || _, p = t.name + "-" + o + "-" + d, m = f.stage || "opaque", v = u(t, f), y = h(f), g = l[_] = new n.default(d, p, f.program, m, v, y);
                    f.rasterizerState && g.setCullMode(f.rasterizerState.cullMode);
                    var x = f.blendState && f.blendState.targets[0];
                    x && g.setBlend(x.blend, x.blendEq, x.blendSrc, x.blendDst, x.blendAlphaEq, x.blendSrcAlpha, x.blendDstAlpha, x.blendColor);
                    var A = f.depthStencilState;
                    A && (g.setDepth(A.depthTest, A.depthWrite, A.depthFunc), g.setStencilFront(A.stencilTest, A.stencilFuncFront, A.stencilRefFront, A.stencilMaskFront, A.stencilFailOpFront, A.stencilZFailOpFront, A.stencilZPassOpFront, A.stencilWriteMaskFront), 
                    g.setStencilBack(A.stencilTest, A.stencilFuncBack, A.stencilRefBack, A.stencilMaskBack, A.stencilFailOpBack, A.stencilZFailOpBack, A.stencilZPassOpBack, A.stencilWriteMaskBack));
                }
                i[r] = new a.default(o, l);
            }
            return i;
        }
    }, {
        "../../../renderer/core/pass": 289,
        "../../../renderer/core/technique": 291,
        "../../../renderer/enums": 293,
        "../../../renderer/types": 321,
        "./effect": 80
    } ],
    79: [ function(t, e, i) {
        "use strict";
        i.__esModule = !0, i.default = void 0;
        var n = o(t("../../../renderer/murmurhash2_gc")), r = o(t("./utils")), s = o(t("./effect-base"));
        function o(t) {
            return t && t.__esModule ? t : {
                default: t
            };
        }
        function a(t, e) {
            for (var i = 0; i < e.length; i++) {
                var n = e[i];
                n.enumerable = n.enumerable || !1, n.configurable = !0, "value" in n && (n.writable = !0), 
                Object.defineProperty(t, n.key, n);
            }
        }
        cc.gfx;
        var c = function(t) {
            var e, i, s, o;
            function c(e) {
                var i;
                return (i = t.call(this) || this)._effect = void 0, i._passes = [], i._stagePasses = {}, 
                i._hash = 0, i.init(e), i;
            }
            i = t, (e = c).prototype = Object.create(i.prototype), e.prototype.constructor = e, 
            e.__proto__ = i, s = c, (o = [ {
                key: "effect",
                get: function() {
                    return this._effect;
                }
            }, {
                key: "name",
                get: function() {
                    return this._effect && this._effect.name + " (variant)";
                }
            }, {
                key: "passes",
                get: function() {
                    return this._passes;
                }
            }, {
                key: "stagePasses",
                get: function() {
                    return this._stagePasses;
                }
            } ]) && a(s.prototype, o);
            var l = c.prototype;
            return l._onEffectChanged = function() {}, l.init = function(t) {
                if (t instanceof c && (t = t.effect), this._effect = t, this._dirty = !0, t) {
                    var e = t.passes, i = this._passes;
                    i.length = 0;
                    for (var n = this._stagePasses = {}, r = 0; r < e.length; r++) {
                        var s = i[r] = Object.setPrototypeOf({}, e[r]);
                        s._properties = Object.setPrototypeOf({}, e[r]._properties), s._defines = Object.setPrototypeOf({}, e[r]._defines), 
                        n[s._stage] || (n[s._stage] = []), n[s._stage].push(s);
                    }
                }
            }, l.updateHash = function() {}, l.getHash = function() {
                if (!this._dirty) return this._hash;
                this._dirty = !1;
                var t = "";
                t += r.default.serializePasses(this._passes);
                var e = this._effect;
                return e && (t += r.default.serializePasses(e.passes)), this._hash = (0, n.default)(t, 666), 
                this.updateHash(this._hash), this._hash;
            }, c;
        }(s.default);
        i.default = c, cc.EffectVariant = c, e.exports = i.default;
    }, {
        "../../../renderer/murmurhash2_gc": 316,
        "./effect-base": 77,
        "./utils": 84
    } ],
    80: [ function(t, e, i) {
        "use strict";
        var n;
        function r(t, e) {
            for (var i = 0; i < e.length; i++) {
                var n = e[i];
                n.enumerable = n.enumerable || !1, n.configurable = !0, "value" in n && (n.writable = !0), 
                Object.defineProperty(t, n.key, n);
            }
        }
        i.__esModule = !0, i.default = void 0;
        var s = function(t) {
            var e, i, n, s;
            function o(e, i, n, r) {
                var s;
                return (s = t.call(this) || this)._techniques = [], s._asset = null, s.init(e, i, n, r, !0), 
                s;
            }
            i = t, (e = o).prototype = Object.create(i.prototype), e.prototype.constructor = e, 
            e.__proto__ = i, n = o, (s = [ {
                key: "technique",
                get: function() {
                    return this._technique;
                }
            }, {
                key: "passes",
                get: function() {
                    return this._technique.passes;
                }
            } ]) && r(n.prototype, s);
            var a = o.prototype;
            return a.init = function(t, e, i, n) {
                this._name = t, this._techniques = e, this._technique = e[i], this._asset = n;
            }, a.switchTechnique = function(t) {
                t >= this._techniques.length ? cc.warn("Can not switch to technique with index [" + t + "]") : this._technique = this._techniques[t];
            }, a.clear = function() {
                this._techniques = [];
            }, a.clone = function() {
                for (var t = [], e = 0; e < this._techniques.length; e++) t.push(this._techniques[e].clone());
                var i = this._techniques.indexOf(this._technique);
                return new o(this._name, t, i, this._asset);
            }, o;
        }(((n = t("./effect-base")) && n.__esModule ? n : {
            default: n
        }).default);
        i.default = s, cc.Effect = s, e.exports = i.default;
    }, {
        "./effect-base": 77
    } ],
    81: [ function(t) {
        "use strict";
        t("./CCEffectAsset"), t("./CCMaterial"), t("./material-variant");
    }, {
        "./CCEffectAsset": 75,
        "./CCMaterial": 76,
        "./material-variant": 83
    } ],
    82: [ function(t, e, i) {
        "use strict";
        i.__esModule = !0, i.default = void 0;
        var n = s(t("./utils")), r = s(t("../../utils/pool"));
        function s(t) {
            return t && t.__esModule ? t : {
                default: t
            };
        }
        var o = new (function(t) {
            var e, i;
            function r() {
                for (var e, i = arguments.length, n = new Array(i), r = 0; r < i; r++) n[r] = arguments[r];
                return (e = t.call.apply(t, [ this ].concat(n)) || this).enabled = !1, e._pool = {}, 
                e;
            }
            i = t, (e = r).prototype = Object.create(i.prototype), e.prototype.constructor = e, 
            e.__proto__ = i;
            var s = r.prototype;
            return s.get = function(t, e) {
                var i, r = this._pool;
                if (t instanceof cc.MaterialVariant) {
                    if (!t._owner) return t._owner = e, t;
                    if (t._owner === e) return t;
                    t = t.material;
                }
                if (this.enabled) {
                    var s = t.effectAsset._uuid;
                    if (r[s]) {
                        var o = n.default.serializeDefines(t._effect._defines) + n.default.serializeTechniques(t._effect._techniques);
                        i = r[s][o] && r[s][o].pop();
                    }
                }
                return i ? this.count-- : ((i = new cc.MaterialVariant(t))._name = t._name + " (Instance)", 
                i._uuid = t._uuid), i._owner = e, i;
            }, s.put = function(t) {
                if (this.enabled && t._owner) {
                    var e = this._pool, i = t.effectAsset._uuid;
                    e[i] || (e[i] = {});
                    var r = n.default.serializeDefines(t._effect._defines) + n.default.serializeTechniques(t._effect._techniques);
                    e[i][r] || (e[i][r] = []), this.count > this.maxSize || (this._clean(t), e[i][r].push(t), 
                    this.count++);
                }
            }, s.clear = function() {
                this._pool = {}, this.count = 0;
            }, s._clean = function(t) {
                t._owner = null;
            }, r;
        }(r.default))();
        r.default.register("material", o);
        var a = o;
        i.default = a, e.exports = i.default;
    }, {
        "../../utils/pool": 258,
        "./utils": 84
    } ],
    83: [ function(t, e, i) {
        "use strict";
        i.__esModule = !0, i.default = void 0;
        var n, r = a(t("./CCMaterial")), s = a(t("./effect-variant")), o = a(t("./material-pool"));
        function a(t) {
            return t && t.__esModule ? t : {
                default: t
            };
        }
        function c(t, e) {
            for (var i = 0; i < e.length; i++) {
                var n = e[i];
                n.enumerable = n.enumerable || !1, n.configurable = !0, "value" in n && (n.writable = !0), 
                Object.defineProperty(t, n.key, n);
            }
        }
        var l = (0, cc._decorator.ccclass)("cc.MaterialVariant")(n = function(t) {
            var e, i, n, a;
            function l(e) {
                var i;
                return (i = t.call(this) || this)._owner = null, i._material = null, i.init(e), 
                i;
            }
            return i = t, (e = l).prototype = Object.create(i.prototype), e.prototype.constructor = e, 
            e.__proto__ = i, l.createWithBuiltin = function(t, e) {
                return l.create(r.default.getBuiltinMaterial(t), e);
            }, l.create = function(t, e) {
                return t ? o.default.get(t, e) : null;
            }, n = l, (a = [ {
                key: "uuid",
                get: function() {
                    return this._material.uuid;
                }
            }, {
                key: "owner",
                get: function() {
                    return this._owner;
                }
            }, {
                key: "material",
                get: function() {
                    return this._material;
                }
            } ]) && c(n.prototype, a), l.prototype.init = function(t) {
                this._effect = new s.default(t.effect), this._effectAsset = t._effectAsset, this._material = t;
            }, l;
        }(r.default)) || n;
        i.default = l, cc.MaterialVariant = l, e.exports = i.default;
    }, {
        "./CCMaterial": 76,
        "./effect-variant": 79,
        "./material-pool": 82
    } ],
    84: [ function(t, e, i) {
        "use strict";
        i.__esModule = !0, i.default = void 0;
        var n, r = (n = t("../../../renderer/enums")) && n.__esModule ? n : {
            default: n
        };
        function s(t) {
            var e = "";
            for (var i in t) e += i + t[i];
            return e;
        }
        function o(t) {
            var e = "";
            for (var i in t) {
                var n = t[i], s = n.value;
                s && (n.type === r.default.PARAM_TEXTURE_2D || n.type === r.default.PARAM_TEXTURE_CUBE ? e += s._id + ";" : e += s.toString() + ";");
            }
            return e;
        }
        var a = {
            serializeDefines: s,
            serializePasses: function(t) {
                for (var e, i, n = "", r = 0; r < t.length; r++) n += (void 0, i = void 0, i = (e = t[r])._programName + e._cullMode, 
                e._blend && (i += e._blendEq + e._blendAlphaEq + e._blendSrc + e._blendDst + e._blendSrcAlpha + e._blendDstAlpha + e._blendColor), 
                e._depthTest && (i += e._depthWrite + e._depthFunc), e._stencilTest && (i += e._stencilFuncFront + e._stencilRefFront + e._stencilMaskFront + e._stencilFailOpFront + e._stencilZFailOpFront + e._stencilZPassOpFront + e._stencilWriteMaskFront + e._stencilFuncBack + e._stencilRefBack + e._stencilMaskBack + e._stencilFailOpBack + e._stencilZFailOpBack + e._stencilZPassOpBack + e._stencilWriteMaskBack), 
                i += o(e._properties), i += s(e._defines));
                return n;
            },
            serializeUniforms: o
        };
        i.default = a, e.exports = i.default;
    }, {
        "../../../renderer/enums": 293
    } ],
    85: [ function(t, e) {
        "use strict";
        t("../CCNode").EventType;
        var i = 56, n = 7, r = cc.Enum({
            ONCE: 0,
            ON_WINDOW_RESIZE: 1,
            ALWAYS: 2
        });
        function s(t, e, i, n) {
            for (var r = t._parent.scaleX, s = t._parent.scaleY, o = 0, a = 0, c = t._parent; ;) {
                if (o += c.x, a += c.y, !(c = c._parent)) return i.x = i.y = 0, void (n.x = n.y = 1);
                if (c === e) break;
                var l = c.scaleX, u = c.scaleY;
                o *= l, a *= u, r *= l, s *= u;
            }
            n.x = 0 !== r ? 1 / r : 1, n.y = 0 !== s ? 1 / s : 1, i.x = -o, i.y = -a;
        }
        var o = cc.Vec2.ZERO, a = cc.Vec2.ONE;
        function c(t, e) {
            var r, c, l, u = e._target;
            u ? s(t, r = u, c = o, l = a) : r = t._parent;
            var h, _ = (h = r) instanceof cc.Scene ? cc.visibleRect : h._contentSize, f = r._anchorPoint, d = r instanceof cc.Scene, p = t.x, m = t.y, v = t._anchorPoint;
            if (e._alignFlags & i) {
                var y, g, x = _.width;
                d ? (y = cc.visibleRect.left.x, g = cc.visibleRect.right.x) : g = (y = -f.x * x) + x, 
                y += e._isAbsLeft ? e._left : e._left * x, g -= e._isAbsRight ? e._right : e._right * x, 
                u && (y += c.x, y *= l.x, g += c.x, g *= l.x);
                var A, C = v.x, b = t.scaleX;
                if (b < 0 && (C = 1 - C, b = -b), e.isStretchWidth) A = g - y, 0 !== b && (t.width = A / b), 
                p = y + C * A; else if (A = t.width * b, e.isAlignHorizontalCenter) {
                    var S = e._isAbsHorizontalCenter ? e._horizontalCenter : e._horizontalCenter * x, T = (.5 - f.x) * _.width;
                    u && (S *= l.x, T += c.x, T *= l.x), p = T + (C - .5) * A + S;
                } else p = e.isAlignLeft ? y + C * A : g + (C - 1) * A;
            }
            if (e._alignFlags & n) {
                var w, E, B = _.height;
                d ? (E = cc.visibleRect.bottom.y, w = cc.visibleRect.top.y) : w = (E = -f.y * B) + B, 
                E += e._isAbsBottom ? e._bottom : e._bottom * B, w -= e._isAbsTop ? e._top : e._top * B, 
                u && (E += c.y, E *= l.y, w += c.y, w *= l.y);
                var M, R = v.y, P = t.scaleY;
                if (P < 0 && (R = 1 - R, P = -P), e.isStretchHeight) M = w - E, 0 !== P && (t.height = M / P), 
                m = E + R * M; else if (M = t.height * P, e.isAlignVerticalCenter) {
                    var I = e._isAbsVerticalCenter ? e._verticalCenter : e._verticalCenter * B, D = (.5 - f.y) * _.height;
                    u && (I *= l.y, D += c.y, D *= l.y), m = D + (R - .5) * M + I;
                } else m = e.isAlignBottom ? E + R * M : w + (R - 1) * M;
            }
            t.setPosition(p, m);
        }
        function l(t) {
            var e = t._widget;
            e && (c(t, e), e.alignMode !== r.ALWAYS ? _.remove(e) : h.push(e));
            for (var i = t._children, n = 0; n < i.length; n++) {
                var s = i[n];
                s._active && l(s);
            }
        }
        function u() {
            var t = cc.director.getScene();
            if (t) {
                if (_.isAligning = !0, _._nodesOrderDirty) h.length = 0, l(t), _._nodesOrderDirty = !1; else {
                    var e, i = _._activeWidgetsIterator;
                    for (i.i = 0; i.i < h.length; ++i.i) c((e = h[i.i]).node, e);
                }
                _.isAligning = !1;
            }
        }
        var h = [], _ = cc._widgetManager = e.exports = {
            _AlignFlags: {
                TOP: 1,
                MID: 2,
                BOT: 4,
                LEFT: 8,
                CENTER: 16,
                RIGHT: 32
            },
            isAligning: !1,
            _nodesOrderDirty: !1,
            _activeWidgetsIterator: new cc.js.array.MutableForwardIterator(h),
            init: function(t) {
                t.on(cc.Director.EVENT_AFTER_UPDATE, u);
                var e = this.onResized.bind(this);
                cc.view.on("canvas-resize", e), window.addEventListener("orientationchange", e);
            },
            add: function(t) {
                t.node._widget = t, this._nodesOrderDirty = !0;
            },
            remove: function(t) {
                t.node._widget = null, this._activeWidgetsIterator.remove(t);
            },
            onResized: function() {
                var t = cc.director.getScene();
                t && this.refreshWidgetOnResized(t);
            },
            refreshWidgetOnResized: function(t) {
                var e = cc.Node.isNode(t) && t.getComponent(cc.Widget);
                e && e.enabled && e.alignMode === r.ON_WINDOW_RESIZE && this.add(e);
                for (var i = t._children, n = 0; n < i.length; n++) {
                    var s = i[n];
                    this.refreshWidgetOnResized(s);
                }
            },
            updateAlignment: function t(e) {
                var i = e._parent;
                cc.Node.isNode(i) && t(i);
                var n = e._widget || e.getComponent(cc.Widget);
                n && i && c(e, n);
            },
            AlignMode: r
        };
    }, {
        "../CCNode": 25
    } ],
    86: [ function(t, e) {
        "use strict";
        var i = t("../value-types"), n = t("../geom-utils"), r = t("../utils/affine-transform"), s = t("../renderer/index"), o = t("../renderer/render-flow"), a = t("../CCGame"), c = null;
        c = t("../../renderer/scene/camera");
        var l = cc.mat4(), u = cc.mat4(), h = cc.v3(), _ = cc.v3(), f = cc.v3(), d = [];
        function p() {
            for (var t = 0, e = Number.MAX_VALUE; t < d.length; t++) {
                var i = d[t];
                i._depth < e && (x.main = i, e = i._depth);
            }
        }
        var m = null;
        function v() {
            if (m) {
                var t = m.getNode(), e = cc.game.canvas;
                t.z = e.height / 1.1566, t.x = e.width / 2, t.y = e.height / 2;
            }
        }
        var y = cc.Enum({
            COLOR: 1,
            DEPTH: 2,
            STENCIL: 4
        }), g = cc.Enum({
            OPAQUE: 1,
            TRANSPARENT: 2
        }), x = cc.Class({
            name: "cc.Camera",
            extends: cc.Component,
            ctor: function() {
                if (a.renderType !== a.RENDER_TYPE_CANVAS) {
                    var t = new c();
                    t.setStages([ "opaque" ]), t.dirty = !0, this._inited = !1, this._camera = t;
                } else this._inited = !0;
            },
            editor: !1,
            properties: {
                _cullingMask: 4294967295,
                _clearFlags: y.DEPTH | y.STENCIL,
                _backgroundColor: cc.color(0, 0, 0, 255),
                _depth: 0,
                _zoomRatio: 1,
                _targetTexture: null,
                _fov: 60,
                _orthoSize: 10,
                _nearClip: 1,
                _farClip: 4096,
                _ortho: !0,
                _rect: cc.rect(0, 0, 1, 1),
                _renderStages: 1,
                _alignWithScreen: !0,
                zoomRatio: {
                    get: function() {
                        return this._zoomRatio;
                    },
                    set: function(t) {
                        this._zoomRatio = t;
                    },
                    tooltip: !1
                },
                fov: {
                    get: function() {
                        return this._fov;
                    },
                    set: function(t) {
                        this._fov = t;
                    },
                    tooltip: !1
                },
                orthoSize: {
                    get: function() {
                        return this._orthoSize;
                    },
                    set: function(t) {
                        this._orthoSize = t;
                    },
                    tooltip: !1
                },
                nearClip: {
                    get: function() {
                        return this._nearClip;
                    },
                    set: function(t) {
                        this._nearClip = t, this._updateClippingpPlanes();
                    },
                    tooltip: !1
                },
                farClip: {
                    get: function() {
                        return this._farClip;
                    },
                    set: function(t) {
                        this._farClip = t, this._updateClippingpPlanes();
                    },
                    tooltip: !1
                },
                ortho: {
                    get: function() {
                        return this._ortho;
                    },
                    set: function(t) {
                        this._ortho = t, this._updateProjection();
                    },
                    tooltip: !1
                },
                rect: {
                    get: function() {
                        return this._rect;
                    },
                    set: function(t) {
                        this._rect = t, this._updateRect();
                    },
                    tooltip: !1
                },
                cullingMask: {
                    get: function() {
                        return this._cullingMask;
                    },
                    set: function(t) {
                        this._cullingMask = t, this._updateCameraMask();
                    },
                    tooltip: !1
                },
                clearFlags: {
                    get: function() {
                        return this._clearFlags;
                    },
                    set: function(t) {
                        this._clearFlags = t, this._camera && this._camera.setClearFlags(t);
                    },
                    tooltip: !1
                },
                backgroundColor: {
                    get: function() {
                        return this._backgroundColor;
                    },
                    set: function(t) {
                        this._backgroundColor.equals(t) || (this._backgroundColor.set(t), this._updateBackgroundColor());
                    },
                    tooltip: !1
                },
                depth: {
                    get: function() {
                        return this._depth;
                    },
                    set: function(t) {
                        x.main === this ? this._depth < t && p() : x.main && t < x.main._depth && d.includes(this) && (x.main = this), 
                        this._depth = t, this._camera && this._camera.setPriority(t);
                    },
                    tooltip: !1
                },
                targetTexture: {
                    get: function() {
                        return this._targetTexture;
                    },
                    set: function(t) {
                        this._targetTexture = t, this._updateTargetTexture();
                    },
                    tooltip: !1
                },
                renderStages: {
                    get: function() {
                        return this._renderStages;
                    },
                    set: function(t) {
                        this._renderStages = t, this._updateStages();
                    },
                    tooltip: !1
                },
                alignWithScreen: {
                    get: function() {
                        return this._alignWithScreen;
                    },
                    set: function(t) {
                        this._alignWithScreen = t;
                    }
                },
                _is3D: {
                    get: function() {
                        return this.node && this.node._is3DNode;
                    }
                }
            },
            statics: {
                main: null,
                cameras: d,
                ClearFlags: y,
                findCamera: function(t) {
                    for (var e = 0, i = d.length; e < i; e++) {
                        var n = d[e];
                        if (n.containsNode(t)) return n;
                    }
                    return null;
                },
                _findRendererCamera: function(t) {
                    for (var e = s.scene._cameras, i = 0; i < e._count; i++) if (e._data[i]._cullingMask & t._cullingMask) return e._data[i];
                    return null;
                },
                _setupDebugCamera: function() {
                    if (!m && a.renderType !== a.RENDER_TYPE_CANVAS) {
                        var t = new c();
                        m = t, t.setStages([ "opaque" ]), t.setFov(60 * Math.PI / 180), t.setNear(.1), t.setFar(4096), 
                        t.dirty = !0, t.cullingMask = 1 << cc.Node.BuiltinGroupIndex.DEBUG, t.setPriority(cc.macro.MAX_ZINDEX), 
                        t.setClearFlags(0), t.setColor(0, 0, 0, 0);
                        var e = new cc.Node();
                        t.setNode(e), v(), cc.view.on("design-resolution-changed", v), s.scene.addCamera(t);
                    }
                }
            },
            _updateCameraMask: function() {
                if (this._camera) {
                    var t = this._cullingMask & ~(1 << cc.Node.BuiltinGroupIndex.DEBUG);
                    this._camera.cullingMask = t;
                }
            },
            _updateBackgroundColor: function() {
                if (this._camera) {
                    var t = this._backgroundColor;
                    this._camera.setColor(t.r / 255, t.g / 255, t.b / 255, t.a / 255);
                }
            },
            _updateTargetTexture: function() {
                if (this._camera) {
                    var t = this._targetTexture;
                    this._camera.setFrameBuffer(t ? t._framebuffer : null);
                }
            },
            _updateClippingpPlanes: function() {
                this._camera && (this._camera.setNear(this._nearClip), this._camera.setFar(this._farClip));
            },
            _updateProjection: function() {
                if (this._camera) {
                    var t = this._ortho ? 1 : 0;
                    this._camera.setType(t);
                }
            },
            _updateRect: function() {
                if (this._camera) {
                    var t = this._rect;
                    this._camera.setRect(t.x, t.y, t.width, t.height);
                }
            },
            _updateStages: function() {
                var t = this._renderStages, e = [];
                t & g.OPAQUE && e.push("opaque"), t & g.TRANSPARENT && e.push("transparent"), this._camera.setStages(e);
            },
            _init: function() {
                if (!this._inited) {
                    this._inited = !0;
                    var t = this._camera;
                    t && (t.setNode(this.node), t.setClearFlags(this._clearFlags), t.setPriority(this._depth), 
                    this._updateBackgroundColor(), this._updateCameraMask(), this._updateTargetTexture(), 
                    this._updateClippingpPlanes(), this._updateProjection(), this._updateStages(), this._updateRect(), 
                    this.beforeDraw());
                }
            },
            __preload: function() {
                this._init();
            },
            onEnable: function() {
                a.renderType !== a.RENDER_TYPE_CANVAS && (cc.director.on(cc.Director.EVENT_BEFORE_DRAW, this.beforeDraw, this), 
                s.scene.addCamera(this._camera)), d.push(this), (!x.main || this._depth < x.main._depth) && (x.main = this);
            },
            onDisable: function() {
                a.renderType !== a.RENDER_TYPE_CANVAS && (cc.director.off(cc.Director.EVENT_BEFORE_DRAW, this.beforeDraw, this), 
                s.scene.removeCamera(this._camera)), cc.js.array.fastRemove(d, this), x.main === this && (x.main = null, 
                p());
            },
            getScreenToWorldMatrix2D: function(t) {
                return this.getWorldToScreenMatrix2D(t), i.Mat4.invert(t, t), t;
            },
            getWorldToScreenMatrix2D: function(t) {
                this.node.getWorldRT(l);
                var e = this.zoomRatio, n = l.m;
                n[0] *= e, n[1] *= e, n[4] *= e, n[5] *= e;
                var r = n[12], s = n[13], o = cc.visibleRect.center;
                return n[12] = o.x - (n[0] * r + n[4] * s), n[13] = o.y - (n[1] * r + n[5] * s), 
                t !== l && i.Mat4.copy(t, l), t;
            },
            getScreenToWorldPoint: function(t, e) {
                return this.node.is3DNode ? (e = e || new cc.Vec3(), this._camera.screenToWorld(e, t, cc.visibleRect.width, cc.visibleRect.height)) : (e = e || new cc.Vec2(), 
                this.getScreenToWorldMatrix2D(l), i.Vec2.transformMat4(e, t, l)), e;
            },
            getWorldToScreenPoint: function(t, e) {
                return this.node.is3DNode ? (e = e || new cc.Vec3(), this._camera.worldToScreen(e, t, cc.visibleRect.width, cc.visibleRect.height)) : (e = e || new cc.Vec2(), 
                this.getWorldToScreenMatrix2D(l), i.Vec2.transformMat4(e, t, l)), e;
            },
            getRay: function(t) {
                return cc.geomUtils ? (i.Vec3.set(f, t.x, t.y, 1), this._camera.screenToWorld(_, f, cc.visibleRect.width, cc.visibleRect.height), 
                this.ortho ? (i.Vec3.set(f, t.x, t.y, -1), this._camera.screenToWorld(h, f, cc.visibleRect.width, cc.visibleRect.height)) : this.node.getWorldPosition(h), 
                n.Ray.fromPoints(new n.Ray(), h, _)) : t;
            },
            containsNode: function(t) {
                return (t._cullingMask & this.cullingMask) > 0;
            },
            render: function(t) {
                if (!(t = t || cc.director.getScene())) return null;
                this.node.getWorldMatrix(l), this.beforeDraw(), o.renderCamera(this._camera, t);
            },
            _onAlignWithScreen: function() {
                var t = cc.game.canvas.height / cc.view._scaleY;
                this._targetTexture && (t = cc.visibleRect.height);
                var e = this._fov * cc.macro.RAD;
                this.node.z = t / (2 * Math.tan(e / 2)), e = 2 * Math.atan(Math.tan(e / 2) / this.zoomRatio), 
                this._camera.setFov(e), this._camera.setOrthoHeight(t / 2 / this.zoomRatio), this.node.setRotation(0, 0, 0, 1);
            },
            beforeDraw: function() {
                if (this._camera) {
                    if (this._alignWithScreen) this._onAlignWithScreen(); else {
                        var t = this._fov * cc.macro.RAD;
                        t = 2 * Math.atan(Math.tan(t / 2) / this.zoomRatio), this._camera.setFov(t), this._camera.setOrthoHeight(this._orthoSize / this.zoomRatio);
                    }
                    this._camera.dirty = !0;
                }
            }
        });
        cc.js.mixin(x.prototype, {
            getNodeToCameraTransform: function(t) {
                var e = r.identity();
                return t.getWorldMatrix(u), this.containsNode(t) && (this.getWorldToCameraMatrix(l), 
                i.Mat4.mul(u, u, l)), r.fromMat4(e, u), e;
            },
            getCameraToWorldPoint: function(t, e) {
                return this.getScreenToWorldPoint(t, e);
            },
            getWorldToCameraPoint: function(t, e) {
                return this.getWorldToScreenPoint(t, e);
            },
            getCameraToWorldMatrix: function(t) {
                return this.getScreenToWorldMatrix2D(t);
            },
            getWorldToCameraMatrix: function(t) {
                return this.getWorldToScreenMatrix2D(t);
            }
        }), e.exports = cc.Camera = x;
    }, {
        "../../renderer/scene/camera": 318,
        "../CCGame": 24,
        "../geom-utils": 137,
        "../renderer/index": 213,
        "../renderer/render-flow": 214,
        "../utils/affine-transform": 248,
        "../value-types": 271
    } ],
    87: [ function(t, e) {
        "use strict";
        cc.Collider.Box = cc.Class({
            properties: {
                _offset: cc.v2(0, 0),
                _size: cc.size(100, 100),
                offset: {
                    tooltip: !1,
                    get: function() {
                        return this._offset;
                    },
                    set: function(t) {
                        this._offset = t;
                    },
                    type: cc.Vec2
                },
                size: {
                    tooltip: !1,
                    get: function() {
                        return this._size;
                    },
                    set: function(t) {
                        this._size.width = t.width < 0 ? 0 : t.width, this._size.height = t.height < 0 ? 0 : t.height;
                    },
                    type: cc.Size
                }
            },
            resetInEditor: !1
        });
        var i = cc.Class({
            name: "cc.BoxCollider",
            extends: cc.Collider,
            mixins: [ cc.Collider.Box ],
            editor: !1
        });
        cc.BoxCollider = e.exports = i;
    }, {} ],
    88: [ function(t, e) {
        "use strict";
        cc.Collider.Circle = cc.Class({
            properties: {
                _offset: cc.v2(0, 0),
                _radius: 50,
                offset: {
                    tooltip: !1,
                    get: function() {
                        return this._offset;
                    },
                    set: function(t) {
                        this._offset = t;
                    },
                    type: cc.Vec2
                },
                radius: {
                    tooltip: !1,
                    get: function() {
                        return this._radius;
                    },
                    set: function(t) {
                        this._radius = t < 0 ? 0 : t;
                    }
                }
            },
            resetInEditor: !1
        });
        var i = cc.Class({
            name: "cc.CircleCollider",
            extends: cc.Collider,
            mixins: [ cc.Collider.Circle ],
            editor: !1
        });
        cc.CircleCollider = e.exports = i;
    }, {} ],
    89: [ function(t, e) {
        "use strict";
        var i = cc.Class({
            name: "cc.Collider",
            extends: cc.Component,
            properties: {
                editing: {
                    default: !1,
                    serializable: !1,
                    tooltip: !1
                },
                tag: {
                    tooltip: !1,
                    default: 0,
                    range: [ 0, 1e7 ],
                    type: cc.Integer
                }
            },
            onDisable: function() {
                cc.director.getCollisionManager().removeCollider(this);
            },
            onEnable: function() {
                cc.director.getCollisionManager().addCollider(this);
            }
        });
        cc.Collider = e.exports = i;
    }, {} ],
    90: [ function(t, e) {
        "use strict";
        var i, n = (i = t("../value-types/vec2")) && i.__esModule ? i : {
            default: i
        }, r = t("./CCContact"), s = r.CollisionType, o = t("../CCNode").EventType, a = new n.default();
        function c(t, e, i, n, r, s) {
            var o = t.x, a = t.y, c = t.width, l = t.height, u = e.m, h = u[0], _ = u[1], f = u[4], d = u[5], p = h * o + f * a + u[12], m = _ * o + d * a + u[13], v = h * c, y = _ * c, g = f * l, x = d * l;
            n.x = p, n.y = m, r.x = v + p, r.y = y + m, i.x = g + p, i.y = x + m, s.x = v + g + p, 
            s.y = y + x + m;
        }
        var l = cc.Class({
            mixins: [ cc.EventTarget ],
            properties: {
                enabled: !1,
                enabledDrawBoundingBox: !1
            },
            ctor: function() {
                this._contacts = [], this._colliders = [], this._debugDrawer = null, this._enabledDebugDraw = !1, 
                cc.director._scheduler && cc.director._scheduler.enableForTarget(this);
            },
            update: function() {
                if (this.enabled) {
                    var t, e, i = this._colliders;
                    for (t = 0, e = i.length; t < e; t++) this.updateCollider(i[t]);
                    var n = this._contacts, r = [];
                    for (t = 0, e = n.length; t < e; t++) {
                        var o = n[t].updateState();
                        o !== s.None && r.push([ o, n[t] ]);
                    }
                    for (t = 0, e = r.length; t < e; t++) {
                        var a = r[t];
                        this._doCollide(a[0], a[1]);
                    }
                    this.drawColliders();
                }
            },
            _doCollide: function(t, e) {
                var i;
                switch (t) {
                  case s.CollisionEnter:
                    i = "onCollisionEnter";
                    break;

                  case s.CollisionStay:
                    i = "onCollisionStay";
                    break;

                  case s.CollisionExit:
                    i = "onCollisionExit";
                }
                var n, r, o, a = e.collider1, c = e.collider2, l = a.node._components, u = c.node._components;
                for (n = 0, r = l.length; n < r; n++) (o = l[n])[i] && o[i](c, a);
                for (n = 0, r = u.length; n < r; n++) (o = u[n])[i] && o[i](a, c);
            },
            shouldCollide: function(t, e) {
                var i = t.node, n = e.node, r = cc.game.collisionMatrix;
                return i !== n && r[i.groupIndex][n.groupIndex];
            },
            initCollider: function(t) {
                if (!t.world) {
                    var e = t.world = {};
                    e.aabb = cc.rect(), e.preAabb = cc.rect(), e.matrix = cc.mat4(), e.radius = 0, t instanceof cc.BoxCollider ? (e.position = null, 
                    e.points = [ cc.v2(), cc.v2(), cc.v2(), cc.v2() ]) : t instanceof cc.PolygonCollider ? (e.position = null, 
                    e.points = t.points.map(function(t) {
                        return cc.v2(t.x, t.y);
                    })) : t instanceof cc.CircleCollider && (e.position = cc.v2(), e.points = null);
                }
            },
            updateCollider: function(t) {
                var e = t.offset, i = t.world, r = i.aabb, s = i.matrix;
                t.node.getWorldMatrix(s);
                var o = i.preAabb;
                if (o.x = r.x, o.y = r.y, o.width = r.width, o.height = r.height, t instanceof cc.BoxCollider) {
                    var l = t.size;
                    r.x = e.x - l.width / 2, r.y = e.y - l.height / 2, r.width = l.width, r.height = l.height;
                    var u = i.points, h = u[0], _ = u[1], f = u[2], d = u[3];
                    c(r, s, h, _, f, d);
                    var p = Math.min(h.x, _.x, f.x, d.x), m = Math.min(h.y, _.y, f.y, d.y), v = Math.max(h.x, _.x, f.x, d.x), y = Math.max(h.y, _.y, f.y, d.y);
                    r.x = p, r.y = m, r.width = v - p, r.height = y - m;
                } else if (t instanceof cc.CircleCollider) {
                    n.default.transformMat4(a, t.offset, s), i.position.x = a.x, i.position.y = a.y;
                    var g = s.m, x = g[12], A = g[13];
                    g[12] = g[13] = 0, a.x = t.radius, a.y = 0, n.default.transformMat4(a, a, s);
                    var C = Math.sqrt(a.x * a.x + a.y * a.y);
                    i.radius = C, r.x = i.position.x - C, r.y = i.position.y - C, r.width = 2 * C, r.height = 2 * C, 
                    g[12] = x, g[13] = A;
                } else if (t instanceof cc.PolygonCollider) {
                    var b = t.points, S = i.points;
                    S.length = b.length;
                    for (var T = 1e6, w = 1e6, E = -1e6, B = -1e6, M = 0, R = b.length; M < R; M++) {
                        S[M] || (S[M] = cc.v2()), a.x = b[M].x + e.x, a.y = b[M].y + e.y, n.default.transformMat4(a, a, s);
                        var P = a.x, I = a.y;
                        S[M].x = P, S[M].y = I, P > E && (E = P), P < T && (T = P), I > B && (B = I), I < w && (w = I);
                    }
                    r.x = T, r.y = w, r.width = E - T, r.height = B - w;
                }
            },
            addCollider: function(t) {
                var e = this._colliders;
                if (-1 === e.indexOf(t)) {
                    for (var i = 0, n = e.length; i < n; i++) {
                        var s = e[i];
                        if (this.shouldCollide(t, s)) {
                            var a = new r(t, s);
                            this._contacts.push(a);
                        }
                    }
                    e.push(t), this.initCollider(t);
                }
                t.node.on(o.GROUP_CHANGED, this.onNodeGroupChanged, this);
            },
            removeCollider: function(t) {
                var e = this._colliders, i = e.indexOf(t);
                if (i >= 0) {
                    e.splice(i, 1);
                    for (var n = this._contacts, r = n.length - 1; r >= 0; r--) {
                        var a = n[r];
                        a.collider1 !== t && a.collider2 !== t || (a.touching && this._doCollide(s.CollisionExit, a), 
                        n.splice(r, 1));
                    }
                    t.node.off(o.GROUP_CHANGED, this.onNodeGroupChanged, this);
                } else cc.errorID(6600);
            },
            onNodeGroupChanged: function(t) {
                for (var e = t.getComponents(cc.Collider), i = 0, n = e.length; i < n; i++) {
                    var r = e[i];
                    cc.PhysicsCollider && r instanceof cc.PhysicsCollider || (this.removeCollider(r), 
                    this.addCollider(r));
                }
            },
            drawColliders: function() {
                if (this._enabledDebugDraw) {
                    this._checkDebugDrawValid();
                    var t = this._debugDrawer;
                    t.clear();
                    for (var e = this._colliders, i = 0, n = e.length; i < n; i++) {
                        var r = e[i];
                        if (t.strokeColor = cc.Color.WHITE, r instanceof cc.BoxCollider || r instanceof cc.PolygonCollider) {
                            var s = r.world.points;
                            if (s.length > 0) {
                                t.moveTo(s[0].x, s[0].y);
                                for (var o = 1; o < s.length; o++) t.lineTo(s[o].x, s[o].y);
                                t.close(), t.stroke();
                            }
                        } else r instanceof cc.CircleCollider && (t.circle(r.world.position.x, r.world.position.y, r.world.radius), 
                        t.stroke());
                        if (this.enabledDrawBoundingBox) {
                            var a = r.world.aabb;
                            t.strokeColor = cc.Color.BLUE, t.moveTo(a.xMin, a.yMin), t.lineTo(a.xMin, a.yMax), 
                            t.lineTo(a.xMax, a.yMax), t.lineTo(a.xMax, a.yMin), t.close(), t.stroke();
                        }
                    }
                }
            },
            _checkDebugDrawValid: function() {
                if (!this._debugDrawer || !this._debugDrawer.isValid) {
                    var t = new cc.Node("COLLISION_MANAGER_DEBUG_DRAW");
                    t.zIndex = cc.macro.MAX_ZINDEX, cc.game.addPersistRootNode(t), this._debugDrawer = t.addComponent(cc.Graphics);
                }
            }
        });
        cc.js.getset(l.prototype, "enabledDebugDraw", function() {
            return this._enabledDebugDraw;
        }, function(t) {
            t && !this._enabledDebugDraw ? (this._checkDebugDrawValid(), this._debugDrawer.node.active = !0) : !t && this._enabledDebugDraw && (this._debugDrawer.clear(!0), 
            this._debugDrawer.node.active = !1), this._enabledDebugDraw = t;
        }), cc.CollisionManager = e.exports = l;
    }, {
        "../CCNode": 25,
        "../value-types/vec2": 280,
        "./CCContact": 91
    } ],
    91: [ function(t, e) {
        "use strict";
        var i = t("./CCIntersection"), n = cc.Enum({
            None: 0,
            CollisionEnter: 1,
            CollisionStay: 2,
            CollisionExit: 3
        });
        function r(t, e) {
            this.collider1 = t, this.collider2 = e, this.touching = !1;
            var n = t instanceof cc.BoxCollider || t instanceof cc.PolygonCollider, r = e instanceof cc.BoxCollider || e instanceof cc.PolygonCollider, s = t instanceof cc.CircleCollider, o = e instanceof cc.CircleCollider;
            n && r ? this.testFunc = i.polygonPolygon : s && o ? this.testFunc = i.circleCircle : n && o ? this.testFunc = i.polygonCircle : s && r ? (this.testFunc = i.polygonCircle, 
            this.collider1 = e, this.collider2 = t) : cc.errorID(6601, cc.js.getClassName(t), cc.js.getClassName(e));
        }
        r.prototype.test = function() {
            var t = this.collider1.world, e = this.collider2.world;
            return !!t.aabb.intersects(e.aabb) && (this.testFunc === i.polygonPolygon ? this.testFunc(t.points, e.points) : this.testFunc === i.circleCircle ? this.testFunc(t, e) : this.testFunc === i.polygonCircle && this.testFunc(t.points, e));
        }, r.prototype.updateState = function() {
            var t = this.test(), e = n.None;
            return t && !this.touching ? (this.touching = !0, e = n.CollisionEnter) : t && this.touching ? e = n.CollisionStay : !t && this.touching && (this.touching = !1, 
            e = n.CollisionExit), e;
        }, r.CollisionType = n, e.exports = r;
    }, {
        "./CCIntersection": 92
    } ],
    92: [ function(t, e) {
        "use strict";
        var i = {};
        function n(t, e, i, n) {
            var r = (n.x - i.x) * (t.y - i.y) - (n.y - i.y) * (t.x - i.x), s = (e.x - t.x) * (t.y - i.y) - (e.y - t.y) * (t.x - i.x), o = (n.y - i.y) * (e.x - t.x) - (n.x - i.x) * (e.y - t.y);
            if (0 !== o) {
                var a = r / o, c = s / o;
                if (0 <= a && a <= 1 && 0 <= c && c <= 1) return !0;
            }
            return !1;
        }
        function r(t, e, i) {
            for (var r = i.length, s = 0; s < r; ++s) if (n(t, e, i[s], i[(s + 1) % r])) return !0;
            return !1;
        }
        function s(t, e) {
            for (var i = !1, n = t.x, r = t.y, s = e.length, o = 0, a = s - 1; o < s; a = o++) {
                var c = e[o].x, l = e[o].y, u = e[a].x, h = e[a].y;
                l > r != h > r && n < (u - c) * (r - l) / (h - l) + c && (i = !i);
            }
            return i;
        }
        function o(t, e, i, n) {
            var r, s = i.x - e.x, o = i.y - e.y, a = s * s + o * o, c = ((t.x - e.x) * s + (t.y - e.y) * o) / a;
            return r = n ? a ? c < 0 ? e : c > 1 ? i : cc.v2(e.x + c * s, e.y + c * o) : e : cc.v2(e.x + c * s, e.y + c * o), 
            s = t.x - r.x, o = t.y - r.y, Math.sqrt(s * s + o * o);
        }
        i.lineLine = n, i.lineRect = function(t, e, i) {
            var r = new cc.Vec2(i.x, i.y), s = new cc.Vec2(i.x, i.yMax), o = new cc.Vec2(i.xMax, i.yMax), a = new cc.Vec2(i.xMax, i.y);
            return !!(n(t, e, r, s) || n(t, e, s, o) || n(t, e, o, a) || n(t, e, a, r));
        }, i.linePolygon = r, i.rectRect = function(t, e) {
            var i = t.x, n = t.y, r = t.x + t.width, s = t.y + t.height, o = e.x, a = e.y, c = e.x + e.width, l = e.y + e.height;
            return i <= c && r >= o && n <= l && s >= a;
        }, i.rectPolygon = function(t, e) {
            var i, n, o = new cc.Vec2(t.x, t.y), a = new cc.Vec2(t.x, t.yMax), c = new cc.Vec2(t.xMax, t.yMax), l = new cc.Vec2(t.xMax, t.y);
            if (r(o, a, e)) return !0;
            if (r(a, c, e)) return !0;
            if (r(c, l, e)) return !0;
            if (r(l, o, e)) return !0;
            for (i = 0, n = e.length; i < n; ++i) if (s(e[i], t)) return !0;
            return !!(s(o, e) || s(a, e) || s(c, e) || s(l, e));
        }, i.polygonPolygon = function(t, e) {
            var i, n;
            for (i = 0, n = t.length; i < n; ++i) if (r(t[i], t[(i + 1) % n], e)) return !0;
            for (i = 0, n = e.length; i < n; ++i) if (s(e[i], t)) return !0;
            for (i = 0, n = t.length; i < n; ++i) if (s(t[i], e)) return !0;
            return !1;
        }, i.circleCircle = function(t, e) {
            return t.position.sub(e.position).mag() < t.radius + e.radius;
        }, i.polygonCircle = function(t, e) {
            var i = e.position;
            if (s(i, t)) return !0;
            for (var n = 0, r = t.length; n < r; n++) if (o(i, 0 === n ? t[t.length - 1] : t[n - 1], t[n], !0) < e.radius) return !0;
            return !1;
        }, i.pointInPolygon = s, i.pointLineDistance = o, cc.Intersection = e.exports = i;
    }, {} ],
    93: [ function(t, e) {
        "use strict";
        cc.Collider.Polygon = cc.Class({
            properties: {
                threshold: {
                    default: 1,
                    serializable: !1,
                    visible: !1
                },
                _offset: cc.v2(0, 0),
                offset: {
                    get: function() {
                        return this._offset;
                    },
                    set: function(t) {
                        this._offset = t;
                    },
                    type: cc.Vec2
                },
                points: {
                    tooltip: !1,
                    default: function() {
                        return [ cc.v2(-50, -50), cc.v2(50, -50), cc.v2(50, 50), cc.v2(-50, 50) ];
                    },
                    type: [ cc.Vec2 ]
                }
            },
            resetPointsByContour: !1
        });
        var i = cc.Class({
            name: "cc.PolygonCollider",
            extends: cc.Collider,
            mixins: [ cc.Collider.Polygon ],
            editor: !1
        });
        cc.PolygonCollider = e.exports = i;
    }, {} ],
    94: [ function(t) {
        "use strict";
        t("./CCCollisionManager"), t("./CCCollider"), t("./CCBoxCollider"), t("./CCCircleCollider"), 
        t("./CCPolygonCollider");
    }, {
        "./CCBoxCollider": 87,
        "./CCCircleCollider": 88,
        "./CCCollider": 89,
        "./CCCollisionManager": 90,
        "./CCPolygonCollider": 93
    } ],
    95: [ function(t, e) {
        "use strict";
        t("./platform/CCClass");
        var i = t("./platform/CCObject").Flags, n = t("./platform/js").array, r = i.IsStartCalled, s = i.IsOnEnableCalled;
        function o(t, e) {
            for (var i = e.constructor._executionOrder, n = e._id, r = 0, s = t.length - 1, o = s >>> 1; r <= s; o = r + s >>> 1) {
                var a = t[o], c = a.constructor._executionOrder;
                if (c > i) s = o - 1; else if (c < i) r = o + 1; else {
                    var l = a._id;
                    if (l > n) s = o - 1; else {
                        if (!(l < n)) return o;
                        r = o + 1;
                    }
                }
            }
            return ~r;
        }
        function a(t, e) {
            for (var i = t.array, n = t.i + 1; n < i.length; ) {
                var r = i[n];
                r._enabled && r.node._activeInHierarchy ? ++n : (t.removeAt(n), e && (r._objFlags &= ~e));
            }
        }
        i.IsEditorOnEnableCalled;
        var c = cc.Class({
            __ctor__: function(t) {
                var e = n.MutableForwardIterator;
                this._zero = new e([]), this._neg = new e([]), this._pos = new e([]), this._invoke = t;
            },
            statics: {
                stableRemoveInactive: a
            },
            add: null,
            remove: null,
            invoke: null
        });
        function l(t, e) {
            return t.constructor._executionOrder - e.constructor._executionOrder;
        }
        var u = cc.Class({
            extends: c,
            add: function(t) {
                var e = t.constructor._executionOrder;
                (0 === e ? this._zero : e < 0 ? this._neg : this._pos).array.push(t);
            },
            remove: function(t) {
                var e = t.constructor._executionOrder;
                (0 === e ? this._zero : e < 0 ? this._neg : this._pos).fastRemove(t);
            },
            cancelInactive: function(t) {
                a(this._zero, t), a(this._neg, t), a(this._pos, t);
            },
            invoke: function() {
                var t = this._neg;
                t.array.length > 0 && (t.array.sort(l), this._invoke(t), t.array.length = 0), this._invoke(this._zero), 
                this._zero.array.length = 0;
                var e = this._pos;
                e.array.length > 0 && (e.array.sort(l), this._invoke(e), e.array.length = 0);
            }
        }), h = cc.Class({
            extends: c,
            add: function(t) {
                var e = t.constructor._executionOrder;
                if (0 === e) this._zero.array.push(t); else {
                    var i = e < 0 ? this._neg.array : this._pos.array, n = o(i, t);
                    n < 0 && i.splice(~n, 0, t);
                }
            },
            remove: function(t) {
                var e = t.constructor._executionOrder;
                if (0 === e) this._zero.fastRemove(t); else {
                    var i = e < 0 ? this._neg : this._pos, n = o(i.array, t);
                    n >= 0 && i.removeAt(n);
                }
            },
            invoke: function(t) {
                this._neg.array.length > 0 && this._invoke(this._neg, t), this._invoke(this._zero, t), 
                this._pos.array.length > 0 && this._invoke(this._pos, t);
            }
        });
        function _(t, e, i, n) {
            return function(e, r) {
                try {
                    n(e, r);
                } catch (o) {
                    cc._throw(o);
                    var s = e.array;
                    for (i && (s[e.i]._objFlags |= i), ++e.i; e.i < s.length; ++e.i) try {
                        t(s[e.i], r);
                    } catch (o) {
                        cc._throw(o), i && (s[e.i]._objFlags |= i);
                    }
                }
            };
        }
        var f = _(function(t) {
            t.start(), t._objFlags |= r;
        }, 0, r, function(t) {
            var e = t.array;
            for (t.i = 0; t.i < e.length; ++t.i) {
                var i = e[t.i];
                i.start(), i._objFlags |= r;
            }
        }), d = _(function(t, e) {
            t.update(e);
        }, 0, void 0, function(t, e) {
            var i = t.array;
            for (t.i = 0; t.i < i.length; ++t.i) i[t.i].update(e);
        }), p = _(function(t, e) {
            t.lateUpdate(e);
        }, 0, void 0, function(t, e) {
            var i = t.array;
            for (t.i = 0; t.i < i.length; ++t.i) i[t.i].lateUpdate(e);
        });
        function m() {
            this.startInvoker = new u(f), this.updateInvoker = new h(d), this.lateUpdateInvoker = new h(p), 
            this._deferredComps = [], this._updating = !1;
        }
        var v = cc.Class({
            ctor: m,
            unscheduleAll: m,
            statics: {
                LifeCycleInvoker: c,
                OneOffInvoker: u,
                createInvokeImpl: _,
                invokeOnEnable: function(t) {
                    var e = cc.director._compScheduler, i = t.array;
                    for (t.i = 0; t.i < i.length; ++t.i) {
                        var n = i[t.i];
                        n._enabled && (n.onEnable(), !n.node._activeInHierarchy || e._onEnabled(n));
                    }
                }
            },
            _onEnabled: function(t) {
                cc.director.getScheduler().resumeTarget(t), t._objFlags |= s, this._updating ? this._deferredComps.push(t) : this._scheduleImmediate(t);
            },
            _onDisabled: function(t) {
                cc.director.getScheduler().pauseTarget(t), t._objFlags &= ~s;
                var e = this._deferredComps.indexOf(t);
                e >= 0 ? n.fastRemoveAt(this._deferredComps, e) : (!t.start || t._objFlags & r || this.startInvoker.remove(t), 
                t.update && this.updateInvoker.remove(t), t.lateUpdate && this.lateUpdateInvoker.remove(t));
            },
            enableComp: function(t, e) {
                if (!(t._objFlags & s)) {
                    if (t.onEnable) {
                        if (e) return void e.add(t);
                        if (t.onEnable(), !t.node._activeInHierarchy) return;
                    }
                    this._onEnabled(t);
                }
            },
            disableComp: function(t) {
                t._objFlags & s && (t.onDisable && t.onDisable(), this._onDisabled(t));
            },
            _scheduleImmediate: function(t) {
                "function" != typeof t.start || t._objFlags & r || this.startInvoker.add(t), "function" == typeof t.update && this.updateInvoker.add(t), 
                "function" == typeof t.lateUpdate && this.lateUpdateInvoker.add(t);
            },
            _deferredSchedule: function() {
                for (var t = this._deferredComps, e = 0, i = t.length; e < i; e++) this._scheduleImmediate(t[e]);
                t.length = 0;
            },
            _startForNewComps: function() {
                this._deferredComps.length > 0 && (this._deferredSchedule(), this.startInvoker.invoke());
            },
            startPhase: function() {
                this._updating = !0, this.startInvoker.invoke(), this._startForNewComps();
            },
            updatePhase: function(t) {
                this.updateInvoker.invoke(t);
            },
            lateUpdatePhase: function(t) {
                this.lateUpdateInvoker.invoke(t), this._updating = !1, this._startForNewComps();
            }
        });
        e.exports = v;
    }, {
        "./platform/CCClass": 182,
        "./platform/CCObject": 188,
        "./platform/js": 203,
        "./utils/misc": 256
    } ],
    96: [ function(t, e) {
        "use strict";
        var i = t("../../animation/animation-animator"), n = t("../../animation/animation-clip"), r = t("../event/event-target"), s = t("../platform/js"), o = function(t, e) {
            return t === e;
        }, a = cc.Enum({
            PLAY: "play",
            STOP: "stop",
            PAUSE: "pause",
            RESUME: "resume",
            LASTFRAME: "lastframe",
            FINISHED: "finished"
        }), c = cc.Class({
            name: "cc.Animation",
            extends: t("./CCComponent"),
            mixins: [ r ],
            editor: !1,
            statics: {
                EventType: a
            },
            ctor: function() {
                cc.EventTarget.call(this), this._animator = null, this._nameToState = s.createMap(!0), 
                this._didInit = !1, this._currentClip = null;
            },
            properties: {
                _defaultClip: {
                    default: null,
                    type: n
                },
                defaultClip: {
                    type: n,
                    get: function() {
                        return this._defaultClip;
                    },
                    set: function() {},
                    tooltip: !1
                },
                currentClip: {
                    get: function() {
                        return this._currentClip;
                    },
                    set: function(t) {
                        this._currentClip = t;
                    },
                    type: n,
                    visible: !1
                },
                _writableClips: {
                    get: function() {
                        return this._clips;
                    },
                    set: function(t) {
                        this._didInit = !1, this._clips = t, this._init();
                    },
                    type: [ n ]
                },
                _clips: {
                    default: [],
                    type: [ n ],
                    tooltip: !1,
                    visible: !0
                },
                playOnLoad: {
                    default: !1,
                    tooltip: !1
                }
            },
            start: function() {
                if (this.playOnLoad && this._defaultClip && (!this._animator || !this._animator.isPlaying)) {
                    var t = this.getAnimationState(this._defaultClip.name);
                    this._animator.playState(t);
                }
            },
            onEnable: function() {
                this._animator && this._animator.resume();
            },
            onDisable: function() {
                this._animator && this._animator.pause();
            },
            onDestroy: function() {
                this.stop();
            },
            getClips: function() {
                return this._clips;
            },
            play: function(t, e) {
                var i = this.playAdditive(t, e);
                return this._animator.stopStatesExcept(i), i;
            },
            playAdditive: function(t, e) {
                this._init();
                var i = this.getAnimationState(t || this._defaultClip && this._defaultClip.name);
                if (i) {
                    this.enabled = !0;
                    var n = this._animator;
                    n.isPlaying && i.isPlaying ? i.isPaused ? n.resumeState(i) : (n.stopState(i), n.playState(i, e)) : n.playState(i, e), 
                    this.enabledInHierarchy || n.pause(), this.currentClip = i.clip;
                }
                return i;
            },
            stop: function(t) {
                if (this._didInit) if (t) {
                    var e = this._nameToState[t];
                    e && this._animator.stopState(e);
                } else this._animator.stop();
            },
            pause: function(t) {
                if (this._didInit) if (t) {
                    var e = this._nameToState[t];
                    e && this._animator.pauseState(e);
                } else this.enabled = !1;
            },
            resume: function(t) {
                if (this._didInit) if (t) {
                    var e = this._nameToState[t];
                    e && this._animator.resumeState(e);
                } else this.enabled = !0;
            },
            setCurrentTime: function(t, e) {
                if (this._init(), e) {
                    var i = this._nameToState[e];
                    i && this._animator.setStateTime(i, t);
                } else this._animator.setStateTime(t);
            },
            getAnimationState: function(t) {
                this._init();
                var e = this._nameToState[t];
                return e && !e.curveLoaded && this._animator._reloadClip(e), e || null;
            },
            addClip: function(t, e) {
                if (t) {
                    this._init(), cc.js.array.contains(this._clips, t) || this._clips.push(t), e = e || t.name;
                    var i = this._nameToState[e];
                    if (i) {
                        if (i.clip === t) return i;
                        var n = this._clips.indexOf(i.clip);
                        -1 !== n && this._clips.splice(n, 1);
                    }
                    var r = new cc.AnimationState(t, e);
                    return this._nameToState[e] = r, r;
                }
                cc.warnID(3900);
            },
            removeClip: function(t, e) {
                if (t) {
                    var i;
                    for (var n in this._init(), this._nameToState) if (i = this._nameToState[n], o(i.clip, t)) break;
                    if (t === this._defaultClip) {
                        if (!e) return void cc.warnID(3902);
                        this._defaultClip = null;
                    }
                    if (i && i.isPlaying) {
                        if (!e) return void cc.warnID(3903);
                        this.stop(i.name);
                    }
                    this._clips = this._clips.filter(function(e) {
                        return !o(e, t);
                    }), i && delete this._nameToState[i.name];
                } else cc.warnID(3901);
            },
            sample: function(t) {
                if (this._init(), t) {
                    var e = this._nameToState[t];
                    e && e.sample();
                } else this._animator.sample();
            },
            on: function(t, e, i, n) {
                this._init();
                var r = this._EventTargetOn(t, e, i, n);
                if ("lastframe" === t) {
                    var s = this._nameToState;
                    for (var o in s) s[o]._lastframeEventOn = !0;
                }
                return r;
            },
            off: function(t, e, i, n) {
                if (this._init(), "lastframe" === t) {
                    var r = this._nameToState;
                    for (var s in r) r[s]._lastframeEventOn = !1;
                }
                this._EventTargetOff(t, e, i, n);
            },
            _init: function() {
                this._didInit || (this._didInit = !0, this._animator = new i(this.node, this), this._createStates());
            },
            _createStates: function() {
                this._nameToState = s.createMap(!0);
                for (var t = null, e = !1, i = 0; i < this._clips.length; ++i) {
                    var n = this._clips[i];
                    n && (t = new cc.AnimationState(n), this._nameToState[t.name] = t, o(this._defaultClip, n) && (e = t));
                }
                this._defaultClip && !e && (t = new cc.AnimationState(this._defaultClip), this._nameToState[t.name] = t);
            }
        });
        c.prototype._EventTargetOn = r.prototype.on, c.prototype._EventTargetOff = r.prototype.off, 
        cc.Animation = e.exports = c;
    }, {
        "../../animation/animation-animator": 9,
        "../../animation/animation-clip": 10,
        "../event/event-target": 129,
        "../platform/js": 203,
        "./CCComponent": 101
    } ],
    97: [ function(t, e) {
        "use strict";
        var i = t("../utils/misc"), n = t("./CCComponent"), r = t("../assets/CCAudioClip"), s = cc.Class({
            name: "cc.AudioSource",
            extends: n,
            editor: !1,
            ctor: function() {
                this.audio = new cc._Audio();
            },
            properties: {
                _clip: {
                    default: null,
                    type: r
                },
                _volume: 1,
                _mute: !1,
                _loop: !1,
                _pausedFlag: {
                    default: !1,
                    serializable: !1
                },
                _firstlyEnabled: !0,
                isPlaying: {
                    get: function() {
                        return this.audio.getState() === cc._Audio.State.PLAYING;
                    },
                    visible: !1
                },
                clip: {
                    get: function() {
                        return this._clip;
                    },
                    set: function(t) {
                        if (t !== this._clip) {
                            if (!(t instanceof r)) return cc.error("Wrong type of AudioClip.");
                            this._clip = t, this.audio.stop(), this.audio.src = this._clip, this.preload && this._clip._ensureLoaded();
                        }
                    },
                    type: r,
                    tooltip: !1,
                    animatable: !1
                },
                volume: {
                    get: function() {
                        return this._volume;
                    },
                    set: function(t) {
                        return t = i.clamp01(t), this._volume = t, this._mute || this.audio.setVolume(t), 
                        t;
                    },
                    tooltip: !1
                },
                mute: {
                    get: function() {
                        return this._mute;
                    },
                    set: function(t) {
                        return this._mute = t, this.audio.setVolume(t ? 0 : this._volume), t;
                    },
                    animatable: !1,
                    tooltip: !1
                },
                loop: {
                    get: function() {
                        return this._loop;
                    },
                    set: function(t) {
                        return this._loop = t, this.audio.setLoop(t), t;
                    },
                    animatable: !1,
                    tooltip: !1
                },
                playOnLoad: {
                    default: !1,
                    tooltip: !1,
                    animatable: !1
                },
                preload: {
                    default: !1,
                    animatable: !1
                }
            },
            _pausedCallback: function() {
                this.audio.getState() === cc._Audio.State.PLAYING && (this.audio.pause(), this._pausedFlag = !0);
            },
            _restoreCallback: function() {
                this._pausedFlag && this.audio.resume(), this._pausedFlag = !1;
            },
            onLoad: function() {
                this.audio.src || (this.audio.src = this._clip), this.preload && this._clip._ensureLoaded();
            },
            onEnable: function() {
                this.playOnLoad && this._firstlyEnabled && (this._firstlyEnabled = !1, this.play()), 
                cc.game.on(cc.game.EVENT_HIDE, this._pausedCallback, this), cc.game.on(cc.game.EVENT_SHOW, this._restoreCallback, this);
            },
            onDisable: function() {
                this.stop(), cc.game.off(cc.game.EVENT_HIDE, this._pausedCallback, this), cc.game.off(cc.game.EVENT_SHOW, this._restoreCallback, this);
            },
            onDestroy: function() {
                this.audio.destroy();
            },
            play: function() {
                if (this._clip) {
                    var t = this.audio;
                    t.setVolume(this._mute ? 0 : this._volume), t.setLoop(this._loop), t.setCurrentTime(0), 
                    t.play();
                }
            },
            stop: function() {
                this.audio.stop();
            },
            pause: function() {
                this.audio.pause();
            },
            resume: function() {
                this.audio.resume();
            },
            rewind: function() {
                this.audio.setCurrentTime(0);
            },
            getCurrentTime: function() {
                return this.audio.getCurrentTime();
            },
            setCurrentTime: function(t) {
                return this.audio.setCurrentTime(t), t;
            },
            getDuration: function() {
                return this.audio.getDuration();
            }
        });
        cc.AudioSource = e.exports = s;
    }, {
        "../assets/CCAudioClip": 59,
        "../utils/misc": 256,
        "./CCComponent": 101
    } ],
    98: [ function(t, e) {
        "use strict";
        var i = [ "touchstart", "touchmove", "touchend", "mousedown", "mousemove", "mouseup", "mouseenter", "mouseleave", "mousewheel" ];
        function n(t) {
            t.stopPropagation();
        }
        var r = cc.Class({
            name: "cc.BlockInputEvents",
            extends: t("./CCComponent"),
            editor: {
                menu: "i18n:MAIN_MENU.component.ui/Block Input Events",
                inspector: "packages://inspector/inspectors/comps/block-input-events.js",
                help: "i18n:COMPONENT.help_url.block_input_events"
            },
            onEnable: function() {
                for (var t = 0; t < i.length; t++) this.node.on(i[t], n, this);
            },
            onDisable: function() {
                for (var t = 0; t < i.length; t++) this.node.off(i[t], n, this);
            }
        });
        cc.BlockInputEvents = e.exports = r;
    }, {
        "./CCComponent": 101
    } ],
    99: [ function(t, e) {
        "use strict";
        var i = t("./CCComponent"), n = t("../utils/gray-sprite-state"), r = cc.Enum({
            NONE: 0,
            COLOR: 1,
            SPRITE: 2,
            SCALE: 3
        }), s = cc.Enum({
            NORMAL: 0,
            HOVER: 1,
            PRESSED: 2,
            DISABLED: 3
        }), o = cc.Class({
            name: "cc.Button",
            extends: i,
            mixins: [ n ],
            ctor: function() {
                this._pressed = !1, this._hovered = !1, this._fromColor = null, this._toColor = null, 
                this._time = 0, this._transitionFinished = !0, this._fromScale = cc.Vec2.ZERO, this._toScale = cc.Vec2.ZERO, 
                this._originalScale = null, this._graySpriteMaterial = null, this._spriteMaterial = null, 
                this._sprite = null;
            },
            editor: !1,
            properties: {
                interactable: {
                    default: !0,
                    tooltip: !1,
                    notify: function() {
                        this._updateState(), this.interactable || this._resetState();
                    },
                    animatable: !1
                },
                _resizeToTarget: {
                    animatable: !1,
                    set: function(t) {
                        t && this._resizeNodeToTargetNode();
                    }
                },
                enableAutoGrayEffect: {
                    default: !1,
                    tooltip: !1,
                    notify: function() {
                        this._updateDisabledState(!0);
                    }
                },
                transition: {
                    default: r.NONE,
                    tooltip: !1,
                    type: r,
                    animatable: !1,
                    notify: function(t) {
                        this._updateTransition(t);
                    },
                    formerlySerializedAs: "transition"
                },
                normalColor: {
                    default: cc.Color.WHITE,
                    displayName: "Normal",
                    tooltip: !1,
                    notify: function() {
                        this.transition === r.Color && this._getButtonState() === s.NORMAL && (this._getTarget().opacity = this.normalColor.a), 
                        this._updateState();
                    }
                },
                pressedColor: {
                    default: cc.color(211, 211, 211),
                    displayName: "Pressed",
                    tooltip: !1,
                    notify: function() {
                        this.transition === r.Color && this._getButtonState() === s.PRESSED && (this._getTarget().opacity = this.pressedColor.a), 
                        this._updateState();
                    },
                    formerlySerializedAs: "pressedColor"
                },
                hoverColor: {
                    default: cc.Color.WHITE,
                    displayName: "Hover",
                    tooltip: !1,
                    notify: function() {
                        this.transition === r.Color && this._getButtonState() === s.HOVER && (this._getTarget().opacity = this.hoverColor.a), 
                        this._updateState();
                    },
                    formerlySerializedAs: "hoverColor"
                },
                disabledColor: {
                    default: cc.color(124, 124, 124),
                    displayName: "Disabled",
                    tooltip: !1,
                    notify: function() {
                        this.transition === r.Color && this._getButtonState() === s.DISABLED && (this._getTarget().opacity = this.disabledColor.a), 
                        this._updateState();
                    }
                },
                duration: {
                    default: .1,
                    range: [ 0, 10 ],
                    tooltip: !1
                },
                zoomScale: {
                    default: 1.2,
                    tooltip: !1
                },
                normalSprite: {
                    default: null,
                    type: cc.SpriteFrame,
                    displayName: "Normal",
                    tooltip: !1,
                    notify: function() {
                        this._updateState();
                    }
                },
                pressedSprite: {
                    default: null,
                    type: cc.SpriteFrame,
                    displayName: "Pressed",
                    tooltip: !1,
                    formerlySerializedAs: "pressedSprite",
                    notify: function() {
                        this._updateState();
                    }
                },
                hoverSprite: {
                    default: null,
                    type: cc.SpriteFrame,
                    displayName: "Hover",
                    tooltip: !1,
                    formerlySerializedAs: "hoverSprite",
                    notify: function() {
                        this._updateState();
                    }
                },
                disabledSprite: {
                    default: null,
                    type: cc.SpriteFrame,
                    displayName: "Disabled",
                    tooltip: !1,
                    notify: function() {
                        this._updateState();
                    }
                },
                target: {
                    default: null,
                    type: cc.Node,
                    tooltip: !1,
                    notify: function(t) {
                        this._applyTarget(), t && this.target !== t && this._unregisterTargetEvent(t);
                    }
                },
                clickEvents: {
                    default: [],
                    type: cc.Component.EventHandler,
                    tooltip: !1
                }
            },
            statics: {
                Transition: r
            },
            __preload: function() {
                this._applyTarget(), this._resetState();
            },
            _resetState: function() {
                this._pressed = !1, this._hovered = !1;
                var t = this._getTarget(), e = this.transition, i = this._originalScale;
                e === r.COLOR && this.interactable ? this._setTargetColor(this.normalColor) : e === r.SCALE && i && t.setScale(i.x, i.y), 
                this._transitionFinished = !0;
            },
            onEnable: function() {
                this.normalSprite && this.normalSprite.ensureLoadTexture(), this.hoverSprite && this.hoverSprite.ensureLoadTexture(), 
                this.pressedSprite && this.pressedSprite.ensureLoadTexture(), this.disabledSprite && this.disabledSprite.ensureLoadTexture(), 
                this._registerNodeEvent(), this._updateState();
            },
            onDisable: function() {
                this._resetState(), this._unregisterNodeEvent();
            },
            _getTarget: function() {
                return this.target ? this.target : this.node;
            },
            _onTargetSpriteFrameChanged: function(t) {
                this.transition === r.SPRITE && this._setCurrentStateSprite(t.spriteFrame);
            },
            _onTargetColorChanged: function(t) {
                this.transition === r.COLOR && this._setCurrentStateColor(t);
            },
            _onTargetScaleChanged: function() {
                var t = this._getTarget();
                this._originalScale && (this.transition !== r.SCALE || this._transitionFinished) && (this._originalScale.x = t.scaleX, 
                this._originalScale.y = t.scaleY);
            },
            _setTargetColor: function(t) {
                var e = this._getTarget(), i = t.clone();
                e.opacity = i.a, i.a = 255, e.color = i;
            },
            _getStateColor: function(t) {
                switch (t) {
                  case s.NORMAL:
                    return this.normalColor;

                  case s.HOVER:
                    return this.hoverColor;

                  case s.PRESSED:
                    return this.pressedColor;

                  case s.DISABLED:
                    return this.disabledColor;
                }
            },
            _getStateSprite: function(t) {
                switch (t) {
                  case s.NORMAL:
                    return this.normalSprite;

                  case s.HOVER:
                    return this.hoverSprite;

                  case s.PRESSED:
                    return this.pressedSprite;

                  case s.DISABLED:
                    return this.disabledSprite;
                }
            },
            _setCurrentStateColor: function(t) {
                switch (this._getButtonState()) {
                  case s.NORMAL:
                    this.normalColor = t;
                    break;

                  case s.HOVER:
                    this.hoverColor = t;
                    break;

                  case s.PRESSED:
                    this.pressedColor = t;
                    break;

                  case s.DISABLED:
                    this.disabledColor = t;
                }
            },
            _setCurrentStateSprite: function(t) {
                switch (this._getButtonState()) {
                  case s.NORMAL:
                    this.normalSprite = t;
                    break;

                  case s.HOVER:
                    this.hoverSprite = t;
                    break;

                  case s.PRESSED:
                    this.pressedSprite = t;
                    break;

                  case s.DISABLED:
                    this.disabledSprite = t;
                }
            },
            update: function(t) {
                var e = this._getTarget();
                if (!this._transitionFinished && (this.transition === r.COLOR || this.transition === r.SCALE)) {
                    this.time += t;
                    var i = 1;
                    if (this.duration > 0 && (i = this.time / this.duration), i >= 1 && (i = 1), this.transition === r.COLOR) {
                        var n = this._fromColor.lerp(this._toColor, i);
                        this._setTargetColor(n);
                    } else this.transition === r.SCALE && this._originalScale && (e.scale = this._fromScale.lerp(this._toScale, i));
                    1 === i && (this._transitionFinished = !0);
                }
            },
            _registerNodeEvent: function() {
                this.node.on(cc.Node.EventType.TOUCH_START, this._onTouchBegan, this), this.node.on(cc.Node.EventType.TOUCH_MOVE, this._onTouchMove, this), 
                this.node.on(cc.Node.EventType.TOUCH_END, this._onTouchEnded, this), this.node.on(cc.Node.EventType.TOUCH_CANCEL, this._onTouchCancel, this), 
                this.node.on(cc.Node.EventType.MOUSE_ENTER, this._onMouseMoveIn, this), this.node.on(cc.Node.EventType.MOUSE_LEAVE, this._onMouseMoveOut, this);
            },
            _unregisterNodeEvent: function() {
                this.node.off(cc.Node.EventType.TOUCH_START, this._onTouchBegan, this), this.node.off(cc.Node.EventType.TOUCH_MOVE, this._onTouchMove, this), 
                this.node.off(cc.Node.EventType.TOUCH_END, this._onTouchEnded, this), this.node.off(cc.Node.EventType.TOUCH_CANCEL, this._onTouchCancel, this), 
                this.node.off(cc.Node.EventType.MOUSE_ENTER, this._onMouseMoveIn, this), this.node.off(cc.Node.EventType.MOUSE_LEAVE, this._onMouseMoveOut, this);
            },
            _registerTargetEvent: function(t) {
                t.on(cc.Node.EventType.SCALE_CHANGED, this._onTargetScaleChanged, this);
            },
            _unregisterTargetEvent: function(t) {
                t.off(cc.Node.EventType.SCALE_CHANGED, this._onTargetScaleChanged, this);
            },
            _getTargetSprite: function(t) {
                var e = null;
                return t && (e = t.getComponent(cc.Sprite)), e;
            },
            _applyTarget: function() {
                var t = this._getTarget();
                this._sprite = this._getTargetSprite(t), this._originalScale || (this._originalScale = cc.Vec2.ZERO), 
                this._originalScale.x = t.scaleX, this._originalScale.y = t.scaleY, this._registerTargetEvent(t);
            },
            _onTouchBegan: function(t) {
                this.interactable && this.enabledInHierarchy && (this._pressed = !0, this._updateState(), 
                t.stopPropagation());
            },
            _onTouchMove: function(t) {
                if (this.interactable && this.enabledInHierarchy && this._pressed) {
                    var e, i = t.touch, n = this.node._hitTest(i.getLocation()), o = this._getTarget(), a = this._originalScale;
                    this.transition === r.SCALE && a ? n ? (this._fromScale.x = a.x, this._fromScale.y = a.y, 
                    this._toScale.x = a.x * this.zoomScale, this._toScale.y = a.y * this.zoomScale, 
                    this._transitionFinished = !1) : (this.time = 0, this._transitionFinished = !0, 
                    o.setScale(a.x, a.y)) : (e = n ? s.PRESSED : s.NORMAL, this._applyTransition(e)), 
                    t.stopPropagation();
                }
            },
            _onTouchEnded: function(t) {
                this.interactable && this.enabledInHierarchy && (this._pressed && (cc.Component.EventHandler.emitEvents(this.clickEvents, t), 
                this.node.emit("click", this)), this._pressed = !1, this._updateState(), t.stopPropagation());
            },
            _onTouchCancel: function() {
                this.interactable && this.enabledInHierarchy && (this._pressed = !1, this._updateState());
            },
            _onMouseMoveIn: function() {
                !this._pressed && this.interactable && this.enabledInHierarchy && (this.transition !== r.SPRITE || this.hoverSprite) && (this._hovered || (this._hovered = !0, 
                this._updateState()));
            },
            _onMouseMoveOut: function() {
                this._hovered && (this._hovered = !1, this._updateState());
            },
            _updateState: function() {
                var t = this._getButtonState();
                this._applyTransition(t), this._updateDisabledState();
            },
            _getButtonState: function() {
                return this.interactable ? this._pressed ? s.PRESSED : this._hovered ? s.HOVER : s.NORMAL : s.DISABLED;
            },
            _updateColorTransitionImmediately: function(t) {
                var e = this._getStateColor(t);
                this._setTargetColor(e), this._fromColor = e.clone(), this._toColor = e;
            },
            _updateColorTransition: function(t) {
                if (t === s.DISABLED) this._updateColorTransitionImmediately(t); else {
                    var e = this._getTarget(), i = this._getStateColor(t);
                    this._fromColor = e.color.clone(), this._toColor = i, this.time = 0, this._transitionFinished = !1;
                }
            },
            _updateSpriteTransition: function(t) {
                var e = this._getStateSprite(t);
                this._sprite && e && (this._sprite.spriteFrame = e);
            },
            _updateScaleTransition: function(t) {
                t === s.PRESSED ? this._zoomUp() : this._zoomBack();
            },
            _zoomUp: function() {
                this._originalScale && (this._fromScale.x = this._originalScale.x, this._fromScale.y = this._originalScale.y, 
                this._toScale.x = this._originalScale.x * this.zoomScale, this._toScale.y = this._originalScale.y * this.zoomScale, 
                this.time = 0, this._transitionFinished = !1);
            },
            _zoomBack: function() {
                if (this._originalScale) {
                    var t = this._getTarget();
                    this._fromScale.x = t.scaleX, this._fromScale.y = t.scaleY, this._toScale.x = this._originalScale.x, 
                    this._toScale.y = this._originalScale.y, this.time = 0, this._transitionFinished = !1;
                }
            },
            _updateTransition: function(t) {
                t === r.COLOR ? this._updateColorTransitionImmediately(s.NORMAL) : t === r.SPRITE && this._updateSpriteTransition(s.NORMAL), 
                this._updateState();
            },
            _applyTransition: function(t) {
                var e = this.transition;
                e === r.COLOR ? this._updateColorTransition(t) : e === r.SPRITE ? this._updateSpriteTransition(t) : e === r.SCALE && this._updateScaleTransition(t);
            },
            _resizeNodeToTargetNode: !1,
            _updateDisabledState: function(t) {
                if (this._sprite && (this.enableAutoGrayEffect || t)) {
                    var e = !1;
                    this.transition === r.SPRITE && this.disabledSprite || (e = this.enableAutoGrayEffect && !this.interactable), 
                    this._switchGrayMaterial(e, this._sprite);
                }
            }
        });
        cc.Button = e.exports = o;
    }, {
        "../utils/gray-sprite-state": 254,
        "./CCComponent": 101
    } ],
    100: [ function(t, e) {
        "use strict";
        var i = t("../camera/CCCamera"), n = t("./CCComponent"), r = cc.Class({
            name: "cc.Canvas",
            extends: n,
            editor: !1,
            resetInEditor: !1,
            statics: {
                instance: null
            },
            properties: {
                _designResolution: cc.size(960, 640),
                designResolution: {
                    get: function() {
                        return cc.size(this._designResolution);
                    },
                    set: function(t) {
                        this._designResolution.width = t.width, this._designResolution.height = t.height, 
                        this.applySettings();
                    },
                    tooltip: !1
                },
                _fitWidth: !1,
                _fitHeight: !0,
                fitHeight: {
                    get: function() {
                        return this._fitHeight;
                    },
                    set: function(t) {
                        this._fitHeight !== t && (this._fitHeight = t, this.applySettings());
                    },
                    tooltip: !1
                },
                fitWidth: {
                    get: function() {
                        return this._fitWidth;
                    },
                    set: function(t) {
                        this._fitWidth !== t && (this._fitWidth = t, this.applySettings());
                    },
                    tooltip: !1
                }
            },
            _fitDesignResolution: !1,
            __preload: function() {
                if (r.instance) return cc.warnID(6700, this.node.name, r.instance.node.name);
                r.instance = this, this.applySettings();
                var t = this.getComponent(cc.Widget);
                t && t.updateAlignment();
            },
            start: function() {
                if (!i.main && cc.game.renderType !== cc.game.RENDER_TYPE_CANVAS) {
                    var t = new cc.Node("Main Camera");
                    t.parent = this.node, t.setSiblingIndex(0);
                    var e = t.addComponent(i), n = i.ClearFlags;
                    e.clearFlags = n.COLOR | n.DEPTH | n.STENCIL, e.depth = -1;
                }
            },
            onDestroy: function() {
                r.instance === this && (r.instance = null);
            },
            applySettings: function() {
                var t, e = cc.ResolutionPolicy;
                t = this.fitHeight && this.fitWidth ? e.SHOW_ALL : this.fitHeight || this.fitWidth ? this.fitWidth ? e.FIXED_WIDTH : e.FIXED_HEIGHT : e.NO_BORDER;
                var i = this._designResolution;
                cc.view.setDesignResolutionSize(i.width, i.height, t);
            }
        });
        cc.Canvas = e.exports = r;
    }, {
        "../camera/CCCamera": 86,
        "./CCComponent": 101
    } ],
    101: [ function(t, e) {
        "use strict";
        var i = t("../platform/CCObject"), n = t("../platform/js"), r = new (t("../platform/id-generater"))("Comp"), s = (i.Flags.IsOnEnableCalled, 
        i.Flags.IsOnLoadCalled), o = !!cc.ActionManager, a = cc.Class({
            name: "cc.Component",
            extends: i,
            ctor: function() {
                this._id = r.getNewId(), this.__eventTargets = [];
            },
            properties: {
                node: {
                    default: null,
                    visible: !1
                },
                name: {
                    get: function() {
                        if (this._name) return this._name;
                        var t = cc.js.getClassName(this), e = t.lastIndexOf(".");
                        return e >= 0 && (t = t.slice(e + 1)), this.node.name + "<" + t + ">";
                    },
                    set: function(t) {
                        this._name = t;
                    },
                    visible: !1
                },
                uuid: {
                    get: function() {
                        return this._id;
                    },
                    visible: !1
                },
                __scriptAsset: !1,
                _enabled: !0,
                enabled: {
                    get: function() {
                        return this._enabled;
                    },
                    set: function(t) {
                        if (this._enabled !== t && (this._enabled = t, this.node._activeInHierarchy)) {
                            var e = cc.director._compScheduler;
                            t ? e.enableComp(this) : e.disableComp(this);
                        }
                    },
                    visible: !1,
                    animatable: !0
                },
                enabledInHierarchy: {
                    get: function() {
                        return this._enabled && this.node._activeInHierarchy;
                    },
                    visible: !1
                },
                _isOnLoadCalled: {
                    get: function() {
                        return this._objFlags & s;
                    }
                }
            },
            update: null,
            lateUpdate: null,
            __preload: null,
            onLoad: null,
            start: null,
            onEnable: null,
            onDisable: null,
            onDestroy: null,
            onFocusInEditor: null,
            onLostFocusInEditor: null,
            resetInEditor: null,
            addComponent: function(t) {
                return this.node.addComponent(t);
            },
            getComponent: function(t) {
                return this.node.getComponent(t);
            },
            getComponents: function(t) {
                return this.node.getComponents(t);
            },
            getComponentInChildren: function(t) {
                return this.node.getComponentInChildren(t);
            },
            getComponentsInChildren: function(t) {
                return this.node.getComponentsInChildren(t);
            },
            _getLocalBounds: null,
            onRestore: null,
            destroy: function() {
                this._super() && this._enabled && this.node._activeInHierarchy && cc.director._compScheduler.disableComp(this);
            },
            _onPreDestroy: function() {
                o && cc.director.getActionManager().removeAllActionsFromTarget(this), this.unscheduleAllCallbacks();
                for (var t = this.__eventTargets, e = t.length - 1; e >= 0; --e) {
                    var i = t[e];
                    i && i.targetOff(this);
                }
                t.length = 0, cc.director._nodeActivator.destroyComp(this), this.node._removeComponent(this);
            },
            _instantiate: function(t) {
                return t || (t = cc.instantiate._clone(this, this)), t.node = null, t;
            },
            schedule: function(t, e, i, n) {
                cc.assertID(t, 1619), e = e || 0, cc.assertID(e >= 0, 1620), i = isNaN(i) ? cc.macro.REPEAT_FOREVER : i, 
                n = n || 0;
                var r = cc.director.getScheduler(), s = r.isTargetPaused(this);
                r.schedule(t, this, e, i, n, s);
            },
            scheduleOnce: function(t, e) {
                this.schedule(t, 0, 0, e);
            },
            unschedule: function(t) {
                t && cc.director.getScheduler().unschedule(t, this);
            },
            unscheduleAllCallbacks: function() {
                cc.director.getScheduler().unscheduleAllForTarget(this);
            }
        });
        a._requireComponent = null, a._executionOrder = 0, n.value(a, "_registerEditorProps", function(t, e) {
            var i = e.requireComponent;
            i && (t._requireComponent = i);
            var n = e.executionOrder;
            n && "number" == typeof n && (t._executionOrder = n);
        }), a.prototype.__scriptUuid = "", cc.Component = e.exports = a;
    }, {
        "../platform/CCObject": 188,
        "../platform/id-generater": 199,
        "../platform/js": 203
    } ],
    102: [ function() {
        "use strict";
        cc.Component.EventHandler = cc.Class({
            name: "cc.ClickEvent",
            properties: {
                target: {
                    default: null,
                    type: cc.Node
                },
                component: "",
                _componentId: "",
                _componentName: {
                    get: function() {
                        return this._genCompIdIfNeeded(), this._compId2Name(this._componentId);
                    },
                    set: function(t) {
                        this._componentId = this._compName2Id(t);
                    }
                },
                handler: {
                    default: ""
                },
                customEventData: {
                    default: ""
                }
            },
            statics: {
                emitEvents: function(t) {
                    var e;
                    if (arguments.length > 0) for (var i = 0, n = (e = new Array(arguments.length - 1)).length; i < n; i++) e[i] = arguments[i + 1];
                    for (var r = 0, s = t.length; r < s; r++) {
                        var o = t[r];
                        o instanceof cc.Component.EventHandler && o.emit(e);
                    }
                }
            },
            emit: function(t) {
                var e = this.target;
                if (cc.isValid(e)) {
                    this._genCompIdIfNeeded();
                    var i = cc.js._getClassById(this._componentId), n = e.getComponent(i);
                    if (cc.isValid(n)) {
                        var r = n[this.handler];
                        "function" == typeof r && (null != this.customEventData && "" !== this.customEventData && (t = t.slice()).push(this.customEventData), 
                        r.apply(n, t));
                    }
                }
            },
            _compName2Id: function(t) {
                var e = cc.js.getClassByName(t);
                return cc.js._getClassId(e);
            },
            _compId2Name: function(t) {
                var e = cc.js._getClassById(t);
                return cc.js.getClassName(e);
            },
            _genCompIdIfNeeded: function() {
                this._componentId || (this._componentName = this.component, this.component = "");
            }
        });
    }, {} ],
    103: [ function(t, e) {
        "use strict";
        var i = t("../platform/CCMacro"), n = t("./CCRenderComponent"), r = (t("../assets/material/CCMaterial"), 
        t("../renderer/utils/label/label-frame")), s = t("../utils/blend-func"), o = t("../renderer/utils/utils").deleteFromDynamicAtlas, a = i.TextAlignment, c = i.VerticalTextAlignment, l = cc.Enum({
            NONE: 0,
            CLAMP: 1,
            SHRINK: 2,
            RESIZE_HEIGHT: 3
        }), u = cc.Enum({
            NONE: 0,
            BITMAP: 1,
            CHAR: 2
        }), h = cc.Class({
            name: "cc.Label",
            extends: n,
            mixins: [ s ],
            ctor: function() {
                this._actualFontSize = 0, this._assemblerData = null, this._frame = null, this._ttfTexture = null, 
                this._letterTexture = null, cc.game.renderType === cc.game.RENDER_TYPE_CANVAS ? this._updateMaterial = this._updateMaterialCanvas : this._updateMaterial = this._updateMaterialWebgl;
            },
            editor: !1,
            properties: {
                _string: {
                    default: "",
                    formerlySerializedAs: "_N$string"
                },
                string: {
                    get: function() {
                        return this._string;
                    },
                    set: function(t) {
                        var e = this._string;
                        this._string = "" + t, this.string !== e && this.setVertsDirty(), this._checkStringEmpty();
                    },
                    multiline: !0,
                    tooltip: !1
                },
                horizontalAlign: {
                    default: a.LEFT,
                    type: a,
                    tooltip: !1,
                    notify: function(t) {
                        this.horizontalAlign !== t && this.setVertsDirty();
                    },
                    animatable: !1
                },
                verticalAlign: {
                    default: c.TOP,
                    type: c,
                    tooltip: !1,
                    notify: function(t) {
                        this.verticalAlign !== t && this.setVertsDirty();
                    },
                    animatable: !1
                },
                actualFontSize: {
                    displayName: "Actual Font Size",
                    animatable: !1,
                    readonly: !0,
                    get: function() {
                        return this._actualFontSize;
                    },
                    tooltip: !1
                },
                _fontSize: 40,
                fontSize: {
                    get: function() {
                        return this._fontSize;
                    },
                    set: function(t) {
                        this._fontSize !== t && (this._fontSize = t, this.setVertsDirty());
                    },
                    range: [ 0, 512 ],
                    tooltip: !1
                },
                fontFamily: {
                    default: "Arial",
                    tooltip: !1,
                    notify: function(t) {
                        this.fontFamily !== t && this.setVertsDirty();
                    },
                    animatable: !1
                },
                _lineHeight: 40,
                lineHeight: {
                    get: function() {
                        return this._lineHeight;
                    },
                    set: function(t) {
                        this._lineHeight !== t && (this._lineHeight = t, this.setVertsDirty());
                    },
                    tooltip: !1
                },
                overflow: {
                    default: l.NONE,
                    type: l,
                    tooltip: !1,
                    notify: function(t) {
                        this.overflow !== t && this.setVertsDirty();
                    },
                    animatable: !1
                },
                _enableWrapText: !0,
                enableWrapText: {
                    get: function() {
                        return this._enableWrapText;
                    },
                    set: function(t) {
                        this._enableWrapText !== t && (this._enableWrapText = t, this.setVertsDirty());
                    },
                    animatable: !1,
                    tooltip: !1
                },
                _N$file: null,
                font: {
                    get: function() {
                        return this._N$file;
                    },
                    set: function(t) {
                        this.font !== t && (t || (this._isSystemFontUsed = !0), this._N$file = t, t && this._isSystemFontUsed && (this._isSystemFontUsed = !1), 
                        this.enabledInHierarchy && this._forceUpdateRenderData());
                    },
                    type: cc.Font,
                    tooltip: !1,
                    animatable: !1
                },
                _isSystemFontUsed: !0,
                useSystemFont: {
                    get: function() {
                        return this._isSystemFontUsed;
                    },
                    set: function(t) {
                        if (this._isSystemFontUsed !== t) {
                            if (this._isSystemFontUsed = !!t, t) {
                                if (this.font = null, !this.enabledInHierarchy) return;
                                this._forceUpdateRenderData();
                            }
                            this.markForValidate();
                        }
                    },
                    animatable: !1,
                    tooltip: !1
                },
                _bmFontOriginalSize: {
                    displayName: "BMFont Original Size",
                    get: function() {
                        return this._N$file instanceof cc.BitmapFont ? this._N$file.fontSize : -1;
                    },
                    visible: !0,
                    animatable: !1
                },
                _spacingX: 0,
                spacingX: {
                    get: function() {
                        return this._spacingX;
                    },
                    set: function(t) {
                        this._spacingX = t, this.setVertsDirty();
                    },
                    tooltip: !1
                },
                _batchAsBitmap: !1,
                cacheMode: {
                    default: u.NONE,
                    type: u,
                    tooltip: !1,
                    notify: function(t) {
                        this.cacheMode !== t && (t !== u.BITMAP || this.font instanceof cc.BitmapFont || this._frame && this._frame._resetDynamicAtlasFrame(), 
                        t === u.CHAR && (this._ttfTexture = null), this.enabledInHierarchy && this._forceUpdateRenderData());
                    },
                    animatable: !1
                },
                _styleFlags: 0,
                enableBold: {
                    get: function() {
                        return !!(1 & this._styleFlags);
                    },
                    set: function(t) {
                        t ? this._styleFlags |= 1 : this._styleFlags &= -2, this.setVertsDirty();
                    },
                    animatable: !1,
                    tooltip: !1
                },
                enableItalic: {
                    get: function() {
                        return !!(2 & this._styleFlags);
                    },
                    set: function(t) {
                        t ? this._styleFlags |= 2 : this._styleFlags &= -3, this.setVertsDirty();
                    },
                    animatable: !1,
                    tooltip: !1
                },
                enableUnderline: {
                    get: function() {
                        return !!(4 & this._styleFlags);
                    },
                    set: function(t) {
                        t ? this._styleFlags |= 4 : this._styleFlags &= -5, this.setVertsDirty();
                    },
                    animatable: !1,
                    tooltip: !1
                },
                _underlineHeight: 0,
                underlineHeight: {
                    get: function() {
                        return this._underlineHeight;
                    },
                    set: function(t) {
                        this._underlineHeight !== t && (this._underlineHeight = t, this.setVertsDirty());
                    },
                    tooltip: !1
                }
            },
            statics: {
                HorizontalAlign: a,
                VerticalAlign: c,
                Overflow: l,
                CacheMode: u,
                _shareAtlas: null,
                clearCharCache: function() {
                    h._shareAtlas && h._shareAtlas.clearAllCache();
                }
            },
            onLoad: function() {
                this._batchAsBitmap && this.cacheMode === u.NONE && (this.cacheMode = u.BITMAP, 
                this._batchAsBitmap = !1), cc.game.renderType === cc.game.RENDER_TYPE_CANVAS && (this.cacheMode = u.NONE);
            },
            onEnable: function() {
                this._super(), this.node.on(cc.Node.EventType.SIZE_CHANGED, this._nodeSizeChanged, this), 
                this.node.on(cc.Node.EventType.ANCHOR_CHANGED, this.setVertsDirty, this), this.node.on(cc.Node.EventType.COLOR_CHANGED, this._nodeColorChanged, this), 
                this._forceUpdateRenderData();
            },
            onDisable: function() {
                this._super(), this.node.off(cc.Node.EventType.SIZE_CHANGED, this._nodeSizeChanged, this), 
                this.node.off(cc.Node.EventType.ANCHOR_CHANGED, this.setVertsDirty, this), this.node.off(cc.Node.EventType.COLOR_CHANGED, this._nodeColorChanged, this);
            },
            onDestroy: function() {
                this._assembler && this._assembler._resetAssemblerData && this._assembler._resetAssemblerData(this._assemblerData), 
                this._assemblerData = null, this._letterTexture = null, this._ttfTexture && (this._ttfTexture.destroy(), 
                this._ttfTexture = null), this._super();
            },
            _nodeSizeChanged: function() {
                this.overflow !== l.NONE && this.setVertsDirty();
            },
            _nodeColorChanged: function() {
                this.font instanceof cc.BitmapFont || this.setVertsDirty();
            },
            setVertsDirty: function() {
                this._super();
            },
            _updateColor: function() {
                this.font instanceof cc.BitmapFont || this._srcBlendFactor === cc.macro.BlendFactor.SRC_ALPHA && this.node._renderFlag & cc.RenderFlow.FLAG_OPACITY || this.setVertsDirty(), 
                n.prototype._updateColor.call(this);
            },
            _validateRender: function() {
                if (this.string) {
                    if (this._materials[0]) {
                        var t = this.font;
                        if (!(t instanceof cc.BitmapFont)) return;
                        var e = t.spriteFrame;
                        if (e && e.textureLoaded() && t._fntConfig) return;
                    }
                    this.disableRender();
                } else this.disableRender();
            },
            _resetAssembler: function() {
                this._resetFrame(), n.prototype._resetAssembler.call(this);
            },
            _resetFrame: function() {
                this._frame && (o(this, this._frame), this._frame = null);
            },
            _checkStringEmpty: function() {
                this.markForRender(!!this.string);
            },
            _on3DNodeChanged: function() {
                this._resetAssembler(), this._applyFontTexture();
            },
            _onBMFontTextureLoaded: function() {
                this._frame._texture = this.font.spriteFrame._texture, this.markForRender(!0), this._updateMaterial(), 
                this._assembler && this._assembler.updateRenderData(this);
            },
            _onBlendChanged: function() {
                this.useSystemFont && this.enabledInHierarchy && this._forceUpdateRenderData();
            },
            _applyFontTexture: function() {
                var t = this.font;
                if (t instanceof cc.BitmapFont) {
                    var e = t.spriteFrame;
                    this._frame = e, e && e.onTextureLoaded(this._onBMFontTextureLoaded, this);
                } else this._nativeTTF() || (this._frame || (this._frame = new r()), this.cacheMode === u.CHAR ? (this._letterTexture = this._assembler._getAssemblerData(), 
                this._frame._refreshTexture(this._letterTexture)) : this._ttfTexture || (this._ttfTexture = new cc.Texture2D(), 
                this._assemblerData = this._assembler._getAssemblerData(), this._ttfTexture.initWithElement(this._assemblerData.canvas)), 
                this.cacheMode !== u.CHAR && (this._frame._resetDynamicAtlasFrame(), this._frame._refreshTexture(this._ttfTexture), 
                this._srcBlendFactor === cc.macro.BlendFactor.ONE && this._ttfTexture.setPremultiplyAlpha(!0)), 
                this._updateMaterial()), this._assembler && this._assembler.updateRenderData(this);
                this.markForValidate();
            },
            _updateMaterialCanvas: function() {
                this._frame && (this._frame._texture._nativeUrl = this.uuid + "_texture");
            },
            _updateMaterialWebgl: function() {
                var t = this.getMaterial(0);
                this._nativeTTF() ? t && this._assembler._updateTTFMaterial(this) : this._frame && (t && t.setProperty("texture", this._frame._texture), 
                s.prototype._updateMaterial.call(this));
            },
            _forceUseCanvas: !1,
            _useNativeTTF: function() {
                return cc.macro.ENABLE_NATIVE_TTF_RENDERER && !this._forceUseCanvas;
            },
            _nativeTTF: function() {
                return this._useNativeTTF() && !!this._assembler && !!this._assembler._updateTTFMaterial;
            },
            _forceUpdateRenderData: function() {
                this.setVertsDirty(), this._resetAssembler(), this._applyFontTexture();
            },
            _enableBold: function(t) {
                this.enableBold = !!t;
            },
            _enableItalics: function(t) {
                this.enableItalic = !!t;
            },
            _enableUnderline: function(t) {
                this.enableUnderline = !!t;
            }
        });
        cc.Label = e.exports = h;
    }, {
        "../assets/material/CCMaterial": 76,
        "../platform/CCMacro": 187,
        "../renderer/utils/label/label-frame": 218,
        "../renderer/utils/utils": 221,
        "../utils/blend-func": 251,
        "./CCRenderComponent": 110
    } ],
    104: [ function(t, e) {
        "use strict";
        var i = cc.Class({
            name: "cc.LabelOutline",
            extends: t("./CCComponent"),
            editor: !1,
            properties: {
                _color: cc.Color.WHITE,
                _width: 1,
                color: {
                    tooltip: !1,
                    get: function() {
                        return this._color.clone();
                    },
                    set: function(t) {
                        this._color.equals(t) || this._color.set(t), this._updateRenderData();
                    }
                },
                width: {
                    tooltip: !1,
                    get: function() {
                        return this._width;
                    },
                    set: function(t) {
                        this._width !== t && (this._width = t, this._updateRenderData());
                    },
                    range: [ 0, 512 ]
                }
            },
            onEnable: function() {
                this._updateRenderData();
            },
            onDisable: function() {
                this._updateRenderData();
            },
            _updateRenderData: function() {
                var t = this.node.getComponent(cc.Label);
                t && t.setVertsDirty();
            }
        });
        cc.LabelOutline = e.exports = i;
    }, {
        "./CCComponent": 101
    } ],
    105: [ function(t, e) {
        "use strict";
        var i = cc.Class({
            name: "cc.LabelShadow",
            extends: t("./CCComponent"),
            editor: !1,
            properties: {
                _color: cc.Color.WHITE,
                _offset: cc.v2(2, 2),
                _blur: 2,
                color: {
                    tooltip: !1,
                    get: function() {
                        return this._color.clone();
                    },
                    set: function(t) {
                        this._color.equals(t) || this._color.set(t), this._updateRenderData();
                    }
                },
                offset: {
                    tooltip: !1,
                    get: function() {
                        return this._offset;
                    },
                    set: function(t) {
                        this._offset = t, this._updateRenderData();
                    }
                },
                blur: {
                    tooltip: !1,
                    get: function() {
                        return this._blur;
                    },
                    set: function(t) {
                        this._blur = t, this._updateRenderData();
                    },
                    range: [ 0, 1024 ]
                }
            },
            onEnable: function() {
                this._updateRenderData();
            },
            onDisable: function() {
                this._updateRenderData();
            },
            _updateRenderData: function() {
                var t = this.node.getComponent(cc.Label);
                t && t.markForRender(!0);
            }
        });
        cc.LabelShadow = e.exports = i;
    }, {
        "./CCComponent": 101
    } ],
    106: [ function(t, e) {
        "use strict";
        var i = t("../CCNode").EventType, n = cc.Enum({
            NONE: 0,
            HORIZONTAL: 1,
            VERTICAL: 2,
            GRID: 3
        }), r = cc.Enum({
            NONE: 0,
            CONTAINER: 1,
            CHILDREN: 2
        }), s = cc.Enum({
            HORIZONTAL: 0,
            VERTICAL: 1
        }), o = cc.Enum({
            BOTTOM_TO_TOP: 0,
            TOP_TO_BOTTOM: 1
        }), a = cc.Enum({
            LEFT_TO_RIGHT: 0,
            RIGHT_TO_LEFT: 1
        }), c = cc.Class({
            name: "cc.Layout",
            extends: t("./CCComponent"),
            editor: !1,
            properties: {
                _layoutSize: cc.size(300, 200),
                _layoutDirty: {
                    default: !0,
                    serializable: !1
                },
                _resize: r.NONE,
                _N$layoutType: n.NONE,
                type: {
                    type: n,
                    get: function() {
                        return this._N$layoutType;
                    },
                    set: function(t) {
                        this._N$layoutType = t, this._doLayoutDirty();
                    },
                    tooltip: !1,
                    animatable: !1
                },
                resizeMode: {
                    type: r,
                    tooltip: !1,
                    animatable: !1,
                    get: function() {
                        return this._resize;
                    },
                    set: function(t) {
                        this.type === n.NONE && t === r.CHILDREN || (this._resize = t, this._doLayoutDirty());
                    }
                },
                cellSize: {
                    default: cc.size(40, 40),
                    tooltip: !1,
                    type: cc.Size,
                    notify: function() {
                        this._doLayoutDirty();
                    }
                },
                startAxis: {
                    default: s.HORIZONTAL,
                    tooltip: !1,
                    type: s,
                    notify: function() {
                        this._doLayoutDirty();
                    },
                    animatable: !1
                },
                paddingLeft: {
                    default: 0,
                    tooltip: !1,
                    notify: function() {
                        this._doLayoutDirty();
                    }
                },
                paddingRight: {
                    default: 0,
                    tooltip: !1,
                    notify: function() {
                        this._doLayoutDirty();
                    }
                },
                paddingTop: {
                    default: 0,
                    tooltip: !1,
                    notify: function() {
                        this._doLayoutDirty();
                    }
                },
                paddingBottom: {
                    default: 0,
                    tooltip: !1,
                    notify: function() {
                        this._doLayoutDirty();
                    }
                },
                spacingX: {
                    default: 0,
                    notify: function() {
                        this._doLayoutDirty();
                    },
                    tooltip: !1
                },
                spacingY: {
                    default: 0,
                    notify: function() {
                        this._doLayoutDirty();
                    },
                    tooltip: !1
                },
                verticalDirection: {
                    default: o.TOP_TO_BOTTOM,
                    type: o,
                    notify: function() {
                        this._doLayoutDirty();
                    },
                    tooltip: !1,
                    animatable: !1
                },
                horizontalDirection: {
                    default: a.LEFT_TO_RIGHT,
                    type: a,
                    notify: function() {
                        this._doLayoutDirty();
                    },
                    tooltip: !1,
                    animatable: !1
                },
                affectedByScale: {
                    default: !1,
                    notify: function() {
                        this._doLayoutDirty();
                    },
                    animatable: !1,
                    tooltip: !1
                }
            },
            statics: {
                Type: n,
                VerticalDirection: o,
                HorizontalDirection: a,
                ResizeMode: r,
                AxisDirection: s
            },
            onEnable: function() {
                this._addEventListeners(), this.node.getContentSize().equals(cc.size(0, 0)) && this.node.setContentSize(this._layoutSize), 
                this._doLayoutDirty();
            },
            onDisable: function() {
                this._removeEventListeners();
            },
            _doLayoutDirty: function() {
                this._layoutDirty = !0;
            },
            _doScaleDirty: function() {
                this._layoutDirty = this._layoutDirty || this.affectedByScale;
            },
            _addEventListeners: function() {
                cc.director.on(cc.Director.EVENT_AFTER_UPDATE, this.updateLayout, this), this.node.on(i.SIZE_CHANGED, this._resized, this), 
                this.node.on(i.ANCHOR_CHANGED, this._doLayoutDirty, this), this.node.on(i.CHILD_ADDED, this._childAdded, this), 
                this.node.on(i.CHILD_REMOVED, this._childRemoved, this), this.node.on(i.CHILD_REORDER, this._doLayoutDirty, this), 
                this._addChildrenEventListeners();
            },
            _removeEventListeners: function() {
                cc.director.off(cc.Director.EVENT_AFTER_UPDATE, this.updateLayout, this), this.node.off(i.SIZE_CHANGED, this._resized, this), 
                this.node.off(i.ANCHOR_CHANGED, this._doLayoutDirty, this), this.node.off(i.CHILD_ADDED, this._childAdded, this), 
                this.node.off(i.CHILD_REMOVED, this._childRemoved, this), this.node.off(i.CHILD_REORDER, this._doLayoutDirty, this), 
                this._removeChildrenEventListeners();
            },
            _addChildrenEventListeners: function() {
                for (var t = this.node.children, e = 0; e < t.length; ++e) {
                    var n = t[e];
                    n.on(i.SCALE_CHANGED, this._doScaleDirty, this), n.on(i.SIZE_CHANGED, this._doLayoutDirty, this), 
                    n.on(i.POSITION_CHANGED, this._doLayoutDirty, this), n.on(i.ANCHOR_CHANGED, this._doLayoutDirty, this), 
                    n.on("active-in-hierarchy-changed", this._doLayoutDirty, this);
                }
            },
            _removeChildrenEventListeners: function() {
                for (var t = this.node.children, e = 0; e < t.length; ++e) {
                    var n = t[e];
                    n.off(i.SCALE_CHANGED, this._doScaleDirty, this), n.off(i.SIZE_CHANGED, this._doLayoutDirty, this), 
                    n.off(i.POSITION_CHANGED, this._doLayoutDirty, this), n.off(i.ANCHOR_CHANGED, this._doLayoutDirty, this), 
                    n.off("active-in-hierarchy-changed", this._doLayoutDirty, this);
                }
            },
            _childAdded: function(t) {
                t.on(i.SCALE_CHANGED, this._doScaleDirty, this), t.on(i.SIZE_CHANGED, this._doLayoutDirty, this), 
                t.on(i.POSITION_CHANGED, this._doLayoutDirty, this), t.on(i.ANCHOR_CHANGED, this._doLayoutDirty, this), 
                t.on("active-in-hierarchy-changed", this._doLayoutDirty, this), this._doLayoutDirty();
            },
            _childRemoved: function(t) {
                t.off(i.SCALE_CHANGED, this._doScaleDirty, this), t.off(i.SIZE_CHANGED, this._doLayoutDirty, this), 
                t.off(i.POSITION_CHANGED, this._doLayoutDirty, this), t.off(i.ANCHOR_CHANGED, this._doLayoutDirty, this), 
                t.off("active-in-hierarchy-changed", this._doLayoutDirty, this), this._doLayoutDirty();
            },
            _resized: function() {
                this._layoutSize = this.node.getContentSize(), this._doLayoutDirty();
            },
            _doLayoutHorizontally: function(t, e, i, s) {
                var c = this.node.getAnchorPoint(), l = this.node.children, u = 1, h = this.paddingLeft, _ = -c.x * t;
                this.horizontalDirection === a.RIGHT_TO_LEFT && (u = -1, _ = (1 - c.x) * t, h = this.paddingRight);
                for (var f = _ + u * h - u * this.spacingX, d = 0, p = 0, m = 0, v = 0, y = 0, g = 0, x = 0, A = 0; A < l.length; ++A) (b = l[A]).activeInHierarchy && x++;
                var C = this.cellSize.width;
                for (this.type !== n.GRID && this.resizeMode === r.CHILDREN && (C = (t - (this.paddingLeft + this.paddingRight) - (x - 1) * this.spacingX) / x), 
                A = 0; A < l.length; ++A) {
                    var b = l[A], S = this._getUsedScaleValue(b.scaleX), T = this._getUsedScaleValue(b.scaleY);
                    if (b.activeInHierarchy) {
                        this._resize === r.CHILDREN && (b.width = C / S, this.type === n.GRID && (b.height = this.cellSize.height / T));
                        var w = b.anchorX, E = b.width * S, B = b.height * T;
                        m > p && (p = m), B >= p && (m = p, p = B, g = b.getAnchorPoint().y), this.horizontalDirection === a.RIGHT_TO_LEFT && (w = 1 - b.anchorX), 
                        f = f + u * w * E + u * this.spacingX;
                        var M = u * (1 - w) * E;
                        if (e) {
                            var R = f + M + u * (u > 0 ? this.paddingRight : this.paddingLeft), P = this.horizontalDirection === a.LEFT_TO_RIGHT && R > (1 - c.x) * t, I = this.horizontalDirection === a.RIGHT_TO_LEFT && R < -c.x * t;
                            (P || I) && (B >= p ? (0 === m && (m = p), d += m, m = p) : (d += p, m = B, p = 0), 
                            f = _ + u * (h + w * E), v++);
                        }
                        var D = i(b, d, v);
                        t >= E + this.paddingLeft + this.paddingRight && s && b.setPosition(cc.v2(f, D));
                        var V, L = 1, O = 0 === p ? B : p;
                        this.verticalDirection === o.TOP_TO_BOTTOM ? (y = y || this.node._contentSize.height, 
                        (V = D + (L = -1) * (O * g + this.paddingBottom)) < y && (y = V)) : (y = y || -this.node._contentSize.height, 
                        (V = D + L * (O * g + this.paddingTop)) > y && (y = V)), f += M;
                    }
                }
                return y;
            },
            _getVerticalBaseHeight: function(t) {
                var e = 0, i = 0;
                if (this.resizeMode === r.CONTAINER) {
                    for (var n = 0; n < t.length; ++n) {
                        var s = t[n];
                        s.activeInHierarchy && (i++, e += s.height * this._getUsedScaleValue(s.scaleY));
                    }
                    e += (i - 1) * this.spacingY + this.paddingBottom + this.paddingTop;
                } else e = this.node.getContentSize().height;
                return e;
            },
            _doLayoutVertically: function(t, e, i, s) {
                var c = this.node.getAnchorPoint(), l = this.node.children, u = 1, h = this.paddingBottom, _ = -c.y * t;
                this.verticalDirection === o.TOP_TO_BOTTOM && (u = -1, _ = (1 - c.y) * t, h = this.paddingTop);
                for (var f = _ + u * h - u * this.spacingY, d = 0, p = 0, m = 0, v = 0, y = 0, g = 0, x = 0, A = 0; A < l.length; ++A) (b = l[A]).activeInHierarchy && x++;
                var C = this.cellSize.height;
                for (this.type !== n.GRID && this.resizeMode === r.CHILDREN && (C = (t - (this.paddingTop + this.paddingBottom) - (x - 1) * this.spacingY) / x), 
                A = 0; A < l.length; ++A) {
                    var b = l[A], S = this._getUsedScaleValue(b.scaleX), T = this._getUsedScaleValue(b.scaleY);
                    if (b.activeInHierarchy) {
                        this.resizeMode === r.CHILDREN && (b.height = C / T, this.type === n.GRID && (b.width = this.cellSize.width / S));
                        var w = b.anchorY, E = b.width * S, B = b.height * T;
                        m > p && (p = m), E >= p && (m = p, p = E, g = b.getAnchorPoint().x), this.verticalDirection === o.TOP_TO_BOTTOM && (w = 1 - b.anchorY), 
                        f = f + u * w * B + u * this.spacingY;
                        var M = u * (1 - w) * B;
                        if (e) {
                            var R = f + M + u * (u > 0 ? this.paddingTop : this.paddingBottom), P = this.verticalDirection === o.BOTTOM_TO_TOP && R > (1 - c.y) * t, I = this.verticalDirection === o.TOP_TO_BOTTOM && R < -c.y * t;
                            (P || I) && (E >= p ? (0 === m && (m = p), d += m, m = p) : (d += p, m = E, p = 0), 
                            f = _ + u * (h + w * B), v++);
                        }
                        var D = i(b, d, v);
                        t >= B + (this.paddingTop + this.paddingBottom) && s && b.setPosition(cc.v2(D, f));
                        var V, L = 1, O = 0 === p ? E : p;
                        this.horizontalDirection === a.RIGHT_TO_LEFT ? (L = -1, y = y || this.node._contentSize.width, 
                        (V = D + L * (O * g + this.paddingLeft)) < y && (y = V)) : (y = y || -this.node._contentSize.width, 
                        (V = D + L * (O * g + this.paddingRight)) > y && (y = V)), f += M;
                    }
                }
                return y;
            },
            _doLayoutBasic: function() {
                for (var t = this.node.children, e = null, i = 0; i < t.length; ++i) {
                    var n = t[i];
                    n.activeInHierarchy && (e ? e.union(e, n.getBoundingBoxToWorld()) : e = n.getBoundingBoxToWorld());
                }
                if (e) {
                    var r = this.node.convertToNodeSpaceAR(cc.v2(e.x, e.y));
                    r = cc.v2(r.x - this.paddingLeft, r.y - this.paddingBottom);
                    var s = this.node.convertToNodeSpaceAR(cc.v2(e.xMax, e.yMax)), o = (s = cc.v2(s.x + this.paddingRight, s.y + this.paddingTop)).sub(r);
                    if (0 !== (o = cc.size(parseFloat(o.x.toFixed(2)), parseFloat(o.y.toFixed(2)))).width) {
                        var a = -r.x / o.width;
                        this.node.anchorX = parseFloat(a.toFixed(2));
                    }
                    if (0 !== o.height) {
                        var c = -r.y / o.height;
                        this.node.anchorY = parseFloat(c.toFixed(2));
                    }
                    this.node.setContentSize(o);
                }
            },
            _doLayoutGridAxisHorizontal: function(t, e) {
                var i = e.width, n = 1, s = -t.y * e.height, a = this.paddingBottom;
                this.verticalDirection === o.TOP_TO_BOTTOM && (n = -1, s = (1 - t.y) * e.height, 
                a = this.paddingTop);
                var c = function(t, e, i) {
                    return s + n * (e + t.anchorY * t.height * this._getUsedScaleValue(t.scaleY) + a + i * this.spacingY);
                }.bind(this), l = 0;
                if (this.resizeMode === r.CONTAINER) {
                    var u = this._doLayoutHorizontally(i, !0, c, !1);
                    (l = s - u) < 0 && (l *= -1), s = -t.y * l, this.verticalDirection === o.TOP_TO_BOTTOM && (n = -1, 
                    s = (1 - t.y) * l);
                }
                this._doLayoutHorizontally(i, !0, c, !0), this.resizeMode === r.CONTAINER && this.node.setContentSize(i, l);
            },
            _doLayoutGridAxisVertical: function(t, e) {
                var i = e.height, n = 1, s = -t.x * e.width, o = this.paddingLeft;
                this.horizontalDirection === a.RIGHT_TO_LEFT && (n = -1, s = (1 - t.x) * e.width, 
                o = this.paddingRight);
                var c = function(t, e, i) {
                    return s + n * (e + t.anchorX * t.width * this._getUsedScaleValue(t.scaleX) + o + i * this.spacingX);
                }.bind(this), l = 0;
                if (this.resizeMode === r.CONTAINER) {
                    var u = this._doLayoutVertically(i, !0, c, !1);
                    (l = s - u) < 0 && (l *= -1), s = -t.x * l, this.horizontalDirection === a.RIGHT_TO_LEFT && (n = -1, 
                    s = (1 - t.x) * l);
                }
                this._doLayoutVertically(i, !0, c, !0), this.resizeMode === r.CONTAINER && this.node.setContentSize(l, i);
            },
            _doLayoutGrid: function() {
                var t = this.node.getAnchorPoint(), e = this.node.getContentSize();
                this.startAxis === s.HORIZONTAL ? this._doLayoutGridAxisHorizontal(t, e) : this.startAxis === s.VERTICAL && this._doLayoutGridAxisVertical(t, e);
            },
            _getHorizontalBaseWidth: function(t) {
                var e = 0, i = 0;
                if (this.resizeMode === r.CONTAINER) {
                    for (var n = 0; n < t.length; ++n) {
                        var s = t[n];
                        s.activeInHierarchy && (i++, e += s.width * this._getUsedScaleValue(s.scaleX));
                    }
                    e += (i - 1) * this.spacingX + this.paddingLeft + this.paddingRight;
                } else e = this.node.getContentSize().width;
                return e;
            },
            _doLayout: function() {
                if (this.type === n.HORIZONTAL) {
                    var t = this._getHorizontalBaseWidth(this.node.children);
                    this._doLayoutHorizontally(t, !1, function(t) {
                        return t.y;
                    }, !0), this.node.width = t;
                } else if (this.type === n.VERTICAL) {
                    var e = this._getVerticalBaseHeight(this.node.children);
                    this._doLayoutVertically(e, !1, function(t) {
                        return t.x;
                    }, !0), this.node.height = e;
                } else this.type === n.NONE ? this.resizeMode === r.CONTAINER && this._doLayoutBasic() : this.type === n.GRID && this._doLayoutGrid();
            },
            _getUsedScaleValue: function(t) {
                return this.affectedByScale ? Math.abs(t) : 1;
            },
            updateLayout: function() {
                this._layoutDirty && this.node.children.length > 0 && (this._doLayout(), this._layoutDirty = !1);
            }
        });
        cc.Layout = e.exports = c;
    }, {
        "../CCNode": 25,
        "./CCComponent": 101
    } ],
    107: [ function(t, e) {
        "use strict";
        var i = o(t("../../renderer/gfx")), n = o(t("../value-types/mat4")), r = o(t("../value-types/vec2")), s = o(t("../assets/material/material-variant"));
        function o(t) {
            return t && t.__esModule ? t : {
                default: t
            };
        }
        var a = t("../utils/misc"), c = t("./CCRenderComponent"), l = t("../renderer/render-flow"), u = t("../graphics/graphics"), h = new r.default(), _ = new n.default(), f = [];
        function d(t, e, i) {
            f.length = 0;
            for (var n = 2 * Math.PI / i, r = 0; r < i; ++r) f.push(cc.v2(e.x * Math.cos(n * r) + t.x, e.y * Math.sin(n * r) + t.y));
            return f;
        }
        var p = cc.Enum({
            RECT: 0,
            ELLIPSE: 1,
            IMAGE_STENCIL: 2
        }), m = cc.Class({
            name: "cc.Mask",
            extends: c,
            editor: !1,
            ctor: function() {
                this._graphics = null, this._enableMaterial = null, this._exitMaterial = null, this._clearMaterial = null;
            },
            properties: {
                _spriteFrame: {
                    default: null,
                    type: cc.SpriteFrame
                },
                _type: p.RECT,
                type: {
                    get: function() {
                        return this._type;
                    },
                    set: function(t) {
                        this._type !== t && this._resetAssembler(), this._type = t, this._type !== p.IMAGE_STENCIL && (this.spriteFrame = null, 
                        this.alphaThreshold = 0, this._updateGraphics()), this._activateMaterial();
                    },
                    type: p,
                    tooltip: !1
                },
                spriteFrame: {
                    type: cc.SpriteFrame,
                    tooltip: !1,
                    get: function() {
                        return this._spriteFrame;
                    },
                    set: function(t) {
                        this._spriteFrame !== t && (this._spriteFrame = t, this.setVertsDirty(), this._updateMaterial());
                    }
                },
                alphaThreshold: {
                    default: .1,
                    type: cc.Float,
                    range: [ 0, 1, .1 ],
                    slide: !0,
                    tooltip: !1,
                    notify: function() {
                        cc.game.renderType !== cc.game.RENDER_TYPE_CANVAS ? this._updateMaterial() : cc.warnID(4201);
                    }
                },
                inverted: {
                    default: !1,
                    type: cc.Boolean,
                    tooltip: !1,
                    notify: function() {
                        cc.game.renderType === cc.game.RENDER_TYPE_CANVAS && cc.warnID(4202);
                    }
                },
                _segments: 64,
                segements: {
                    get: function() {
                        return this._segments;
                    },
                    set: function(t) {
                        this._segments = a.clampf(t, 3, 1e4), this._updateGraphics();
                    },
                    type: cc.Integer,
                    tooltip: !1
                },
                _resizeToTarget: {
                    animatable: !1,
                    set: function(t) {
                        t && this._resizeNodeToTargetNode();
                    }
                }
            },
            statics: {
                Type: p
            },
            onRestore: function() {
                this._activateMaterial();
            },
            onEnable: function() {
                this._super(), this._type !== p.IMAGE_STENCIL && this._updateGraphics(), this.node.on(cc.Node.EventType.POSITION_CHANGED, this._updateGraphics, this), 
                this.node.on(cc.Node.EventType.ROTATION_CHANGED, this._updateGraphics, this), this.node.on(cc.Node.EventType.SCALE_CHANGED, this._updateGraphics, this), 
                this.node.on(cc.Node.EventType.SIZE_CHANGED, this._updateGraphics, this), this.node.on(cc.Node.EventType.ANCHOR_CHANGED, this._updateGraphics, this);
            },
            onDisable: function() {
                this._super(), this.node.off(cc.Node.EventType.POSITION_CHANGED, this._updateGraphics, this), 
                this.node.off(cc.Node.EventType.ROTATION_CHANGED, this._updateGraphics, this), this.node.off(cc.Node.EventType.SCALE_CHANGED, this._updateGraphics, this), 
                this.node.off(cc.Node.EventType.SIZE_CHANGED, this._updateGraphics, this), this.node.off(cc.Node.EventType.ANCHOR_CHANGED, this._updateGraphics, this), 
                this.node._renderFlag &= ~l.FLAG_POST_RENDER;
            },
            onDestroy: function() {
                this._super(), this._removeGraphics();
            },
            _resizeNodeToTargetNode: !1,
            _validateRender: function() {
                if (this._type === p.IMAGE_STENCIL) {
                    var t = this._spriteFrame;
                    t && t.textureLoaded() || this.disableRender();
                }
            },
            _activateMaterial: function() {
                this._createGraphics();
                var t = this._materials[0];
                (t = t ? s.default.create(t, this) : s.default.createWithBuiltin("2d-sprite", this)).define("USE_ALPHA_TEST", !0), 
                this._type === p.IMAGE_STENCIL ? (t.define("CC_USE_MODEL", !1), t.define("USE_TEXTURE", !0)) : (t.define("CC_USE_MODEL", !0), 
                t.define("USE_TEXTURE", !1)), this._enableMaterial || (this._enableMaterial = s.default.createWithBuiltin("2d-sprite", this)), 
                this._exitMaterial || (this._exitMaterial = s.default.createWithBuiltin("2d-sprite", this), 
                this._exitMaterial.setStencilEnabled(i.default.STENCIL_DISABLE)), this._clearMaterial || (this._clearMaterial = s.default.createWithBuiltin("clear-stencil", this)), 
                this.setMaterial(0, t), this._graphics._materials[0] = t, this._updateMaterial();
            },
            _updateMaterial: function() {
                var t = this._materials[0];
                if (t) {
                    if (this._type === p.IMAGE_STENCIL && this.spriteFrame) {
                        var e = this.spriteFrame.getTexture();
                        t.setProperty("texture", e);
                    }
                    t.setProperty("alphaThreshold", this.alphaThreshold);
                }
            },
            _createGraphics: function() {
                this._graphics || (this._graphics = new u(), cc.Assembler.init(this._graphics), 
                this._graphics.node = this.node, this._graphics.lineWidth = 0, this._graphics.strokeColor = cc.color(0, 0, 0, 0));
            },
            _updateGraphics: function() {
                var t = this.node, e = this._graphics;
                e.clear(!1);
                var i = t._contentSize.width, n = t._contentSize.height, r = -i * t._anchorPoint.x, s = -n * t._anchorPoint.y;
                if (this._type === p.RECT) e.rect(r, s, i, n); else if (this._type === p.ELLIPSE) {
                    for (var o = d(cc.v2(r + i / 2, s + n / 2), {
                        x: i / 2,
                        y: n / 2
                    }, this._segments), a = 0; a < o.length; ++a) {
                        var c = o[a];
                        0 === a ? e.moveTo(c.x, c.y) : e.lineTo(c.x, c.y);
                    }
                    e.close();
                }
                cc.game.renderType === cc.game.RENDER_TYPE_CANVAS ? e.stroke() : e.fill();
            },
            _removeGraphics: function() {
                this._graphics && (this._graphics.destroy(), this._graphics._destroyImmediate(), 
                this._graphics = null);
            },
            _hitTest: function(t) {
                var e = this.node, i = e.getContentSize(), s = i.width, o = i.height, a = h;
                if (e._updateWorldMatrix(), !n.default.invert(_, e._worldMatrix)) return !1;
                r.default.transformMat4(a, t, _), a.x += e._anchorPoint.x * s, a.y += e._anchorPoint.y * o;
                var c = !1;
                if (this.type === p.RECT || this.type === p.IMAGE_STENCIL) c = a.x >= 0 && a.y >= 0 && a.x <= s && a.y <= o; else if (this.type === p.ELLIPSE) {
                    var l = s / 2, u = o / 2, f = a.x - .5 * s, d = a.y - .5 * o;
                    c = f * f / (l * l) + d * d / (u * u) < 1;
                }
                return this.inverted && (c = !c), c;
            },
            markForRender: function(t) {
                var e = l.FLAG_RENDER | l.FLAG_UPDATE_RENDER_DATA | l.FLAG_POST_RENDER;
                t ? (this.node._renderFlag |= e, this.markForValidate()) : t || (this.node._renderFlag &= ~e);
            },
            disableRender: function() {
                this.node._renderFlag &= ~(l.FLAG_RENDER | l.FLAG_UPDATE_RENDER_DATA | l.FLAG_POST_RENDER);
            }
        });
        cc.Mask = e.exports = m;
    }, {
        "../../renderer/gfx": 298,
        "../assets/material/material-variant": 83,
        "../graphics/graphics": 145,
        "../renderer/render-flow": 214,
        "../utils/misc": 256,
        "../value-types/mat4": 273,
        "../value-types/vec2": 280,
        "./CCRenderComponent": 110
    } ],
    108: [ function(t, e) {
        "use strict";
        var i = t("../components/CCRenderComponent"), n = t("../../core/utils/blend-func"), r = cc.Class({
            name: "cc.MotionStreak",
            extends: i,
            mixins: [ n ],
            editor: !1,
            ctor: function() {
                this._points = [];
            },
            properties: {
                preview: {
                    default: !1,
                    editorOnly: !0,
                    notify: !1,
                    animatable: !1
                },
                _fadeTime: 1,
                fadeTime: {
                    get: function() {
                        return this._fadeTime;
                    },
                    set: function(t) {
                        this._fadeTime = t, this.reset();
                    },
                    animatable: !1,
                    tooltip: !1
                },
                _minSeg: 1,
                minSeg: {
                    get: function() {
                        return this._minSeg;
                    },
                    set: function(t) {
                        this._minSeg = t;
                    },
                    animatable: !1,
                    tooltip: !1
                },
                _stroke: 64,
                stroke: {
                    get: function() {
                        return this._stroke;
                    },
                    set: function(t) {
                        this._stroke = t;
                    },
                    animatable: !1,
                    tooltip: !1
                },
                _texture: {
                    default: null,
                    type: cc.Texture2D
                },
                texture: {
                    get: function() {
                        return this._texture;
                    },
                    set: function(t) {
                        this._texture !== t && (this._texture = t, this._updateMaterial());
                    },
                    type: cc.Texture2D,
                    animatable: !1,
                    tooltip: !1
                },
                _color: cc.Color.WHITE,
                color: {
                    get: function() {
                        return this._color.clone();
                    },
                    set: function(t) {
                        this._color.equals(t) || this._color.set(t);
                    },
                    type: cc.Color,
                    tooltip: !1
                },
                _fastMode: !1,
                fastMode: {
                    get: function() {
                        return this._fastMode;
                    },
                    set: function(t) {
                        this._fastMode = t;
                    },
                    animatable: !1,
                    tooltip: !1
                }
            },
            onEnable: function() {
                this._super(), this.reset();
            },
            _updateMaterial: function() {
                var t = this.getMaterial(0);
                t && t.setProperty("texture", this._texture), n.prototype._updateMaterial.call(this);
            },
            onFocusInEditor: !1,
            onLostFocusInEditor: !1,
            reset: function() {
                this._points.length = 0, this._assembler && this._assembler._renderData.clear();
            },
            lateUpdate: function(t) {
                this._assembler && this._assembler.update(this, t);
            }
        });
        cc.MotionStreak = e.exports = r;
    }, {
        "../../core/utils/blend-func": 251,
        "../components/CCRenderComponent": 110
    } ],
    109: [ function(t, e) {
        "use strict";
        var i = t("../utils/misc"), n = t("./CCComponent"), r = cc.Enum({
            HORIZONTAL: 0,
            VERTICAL: 1,
            FILLED: 2
        }), s = cc.Class({
            name: "cc.ProgressBar",
            extends: n,
            editor: !1,
            _initBarSprite: function() {
                if (this.barSprite) {
                    var t = this.barSprite.node;
                    if (!t) return;
                    var e = this.node.getContentSize(), i = this.node.getAnchorPoint(), n = t.getContentSize();
                    t.parent === this.node && this.node.setContentSize(n), this.barSprite.fillType === cc.Sprite.FillType.RADIAL && (this.mode = r.FILLED);
                    var s = t.getContentSize();
                    if (this.mode === r.HORIZONTAL ? this.totalLength = s.width : this.mode === r.VERTICAL ? this.totalLength = s.height : this.totalLength = this.barSprite.fillRange, 
                    t.parent === this.node) {
                        var o = -e.width * i.x;
                        t.setPosition(cc.v2(o, 0));
                    }
                }
            },
            _updateBarStatus: function() {
                if (this.barSprite) {
                    var t = this.barSprite.node;
                    if (!t) return;
                    var e, n, s, o = t.getAnchorPoint(), a = t.getContentSize(), c = t.getPosition(), l = cc.v2(0, .5), u = i.clamp01(this.progress), h = this.totalLength * u;
                    switch (this.mode) {
                      case r.HORIZONTAL:
                        this.reverse && (l = cc.v2(1, .5)), e = cc.size(h, a.height), n = this.totalLength, 
                        s = a.height;
                        break;

                      case r.VERTICAL:
                        l = this.reverse ? cc.v2(.5, 1) : cc.v2(.5, 0), e = cc.size(a.width, h), n = a.width, 
                        s = this.totalLength;
                    }
                    if (this.mode === r.FILLED) this.barSprite.type !== cc.Sprite.Type.FILLED ? cc.warn("ProgressBar FILLED mode only works when barSprite's Type is FILLED!") : (this.reverse && (h *= -1), 
                    this.barSprite.fillRange = h); else if (this.barSprite.type !== cc.Sprite.Type.FILLED) {
                        var _ = l.x - o.x, f = l.y - o.y, d = cc.v2(n * _, s * f);
                        t.setPosition(c.x + d.x, c.y + d.y), t.setAnchorPoint(l), t.setContentSize(e);
                    } else cc.warn("ProgressBar non-FILLED mode only works when barSprite's Type is non-FILLED!");
                }
            },
            properties: {
                barSprite: {
                    default: null,
                    type: cc.Sprite,
                    tooltip: !1,
                    notify: function() {
                        this._initBarSprite();
                    },
                    animatable: !1
                },
                mode: {
                    default: r.HORIZONTAL,
                    type: r,
                    tooltip: !1,
                    notify: function() {
                        if (this.barSprite) {
                            var t = this.barSprite.node;
                            if (!t) return;
                            var e = t.getContentSize();
                            this.mode === r.HORIZONTAL ? this.totalLength = e.width : this.mode === r.VERTICAL ? this.totalLength = e.height : this.mode === r.FILLED && (this.totalLength = this.barSprite.fillRange);
                        }
                    },
                    animatable: !1
                },
                _N$totalLength: 1,
                totalLength: {
                    range: [ 0, Number.MAX_VALUE ],
                    tooltip: !1,
                    get: function() {
                        return this._N$totalLength;
                    },
                    set: function(t) {
                        this.mode === r.FILLED && (t = i.clamp01(t)), this._N$totalLength = t, this._updateBarStatus();
                    }
                },
                progress: {
                    default: 1,
                    type: cc.Float,
                    range: [ 0, 1, .1 ],
                    slide: !0,
                    tooltip: !1,
                    notify: function() {
                        this._updateBarStatus();
                    }
                },
                reverse: {
                    default: !1,
                    tooltip: !1,
                    notify: function() {
                        this.barSprite && (this.barSprite.fillStart = 1 - this.barSprite.fillStart), this._updateBarStatus();
                    },
                    animatable: !1
                }
            },
            statics: {
                Mode: r
            }
        });
        cc.ProgressBar = e.exports = s;
    }, {
        "../utils/misc": 256,
        "./CCComponent": 101
    } ],
    110: [ function(t, e) {
        "use strict";
        var i = s(t("../renderer/assembler")), n = s(t("../assets/material/material-variant")), r = t("../value-types");
        function s(t) {
            return t && t.__esModule ? t : {
                default: t
            };
        }
        var o = t("./CCComponent"), a = t("../renderer/render-flow"), c = t("../assets/material/CCMaterial"), l = new r.Color(), u = cc.Class({
            name: "RenderComponent",
            extends: o,
            editor: !1,
            properties: {
                _materials: {
                    default: [],
                    type: c
                },
                materials: {
                    get: function() {
                        return this._materials;
                    },
                    set: function(t) {
                        this._materials = t, this._activateMaterial();
                    },
                    type: [ c ],
                    displayName: "Materials",
                    animatable: !1
                }
            },
            ctor: function() {
                this._vertsDirty = !0, this._assembler = null;
            },
            _resetAssembler: function() {
                i.default.init(this), this._updateColor(), this.setVertsDirty();
            },
            __preload: function() {
                this._resetAssembler(), this._activateMaterial();
            },
            onEnable: function() {
                this.node._renderComponent && (this.node._renderComponent.enabled = !1), this.node._renderComponent = this, 
                this.node._renderFlag |= a.FLAG_OPACITY_COLOR, this.setVertsDirty();
            },
            onDisable: function() {
                this.node._renderComponent = null, this.disableRender();
            },
            onDestroy: function() {
                for (var t = this._materials, e = 0; e < t.length; e++) cc.pool.material.put(t[e]);
                t.length = 0, cc.pool.assembler.put(this._assembler);
            },
            setVertsDirty: function() {
                this._vertsDirty = !0, this.markForRender(!0);
            },
            _on3DNodeChanged: function() {
                this._resetAssembler();
            },
            _validateRender: function() {},
            markForValidate: function() {
                cc.RenderFlow.registerValidate(this);
            },
            markForRender: function(t) {
                var e = a.FLAG_RENDER | a.FLAG_UPDATE_RENDER_DATA;
                t ? (this.node._renderFlag |= e, this.markForValidate()) : this.node._renderFlag &= ~e;
            },
            disableRender: function() {
                this.node._renderFlag &= ~(a.FLAG_RENDER | a.FLAG_UPDATE_RENDER_DATA);
            },
            getMaterial: function(t) {
                if (t < 0 || t >= this._materials.length) return null;
                var e = this._materials[t];
                if (!e) return null;
                var i = n.default.create(e, this);
                return i !== e && this.setMaterial(t, i), i;
            },
            getMaterials: function() {
                for (var t = this._materials, e = 0; e < t.length; e++) t[e] = n.default.create(t[e], this);
                return t;
            },
            setMaterial: function(t, e) {
                return e !== this._materials[t] && (e = n.default.create(e, this), this._materials[t] = e), 
                this._updateMaterial(), this.markForRender(!0), e;
            },
            _getDefaultMaterial: function() {
                return c.getBuiltinMaterial("2d-sprite");
            },
            _activateMaterial: function() {
                var t = this._materials;
                if (!t[0]) {
                    var e = this._getDefaultMaterial();
                    t[0] = e;
                }
                for (var i = 0; i < t.length; i++) t[i] = n.default.create(t[i], this);
                this._updateMaterial();
            },
            _updateMaterial: function() {},
            _updateColor: function() {
                if (this._assembler.updateColor) {
                    var t = this.srcBlendFactor === cc.macro.BlendFactor.ONE;
                    t && r.Color.premultiplyAlpha(l, this.node._color);
                    var e = t ? l._val : null;
                    this._assembler.updateColor(this, e);
                }
            },
            _checkBacth: function(t, e) {
                var i = this._materials[0];
                (i && i.getHash() !== t.material.getHash() || t.cullingMask !== e) && (t._flush(), 
                t.node = i.getDefine("CC_USE_MODEL") ? this.node : t._dummyNode, t.material = i, 
                t.cullingMask = e);
            }
        });
        cc.RenderComponent = e.exports = u;
    }, {
        "../assets/material/CCMaterial": 76,
        "../assets/material/material-variant": 83,
        "../renderer/assembler": 210,
        "../renderer/render-flow": 214,
        "../value-types": 271,
        "./CCComponent": 101
    } ],
    111: [ function(t, e) {
        "use strict";
        var i = t("../utils/misc"), n = (t("./CCComponent"), cc.Enum({
            HORIZONTAL: 0,
            VERTICAL: 1
        })), r = cc.Class({
            name: "cc.Scrollbar",
            extends: t("./CCComponent"),
            editor: !1,
            properties: {
                _scrollView: null,
                _touching: !1,
                _autoHideRemainingTime: {
                    default: 0,
                    serializable: !1
                },
                _opacity: 255,
                handle: {
                    default: null,
                    type: cc.Sprite,
                    tooltip: !1,
                    notify: function() {
                        this._onScroll(cc.v2(0, 0));
                    },
                    animatable: !1
                },
                direction: {
                    default: n.HORIZONTAL,
                    type: n,
                    tooltip: !1,
                    notify: function() {
                        this._onScroll(cc.v2(0, 0));
                    },
                    animatable: !1
                },
                enableAutoHide: {
                    default: !0,
                    animatable: !1,
                    tooltip: !1
                },
                autoHideTime: {
                    default: 1,
                    animatable: !1,
                    tooltip: !1
                }
            },
            statics: {
                Direction: n
            },
            setTargetScrollView: function(t) {
                this._scrollView = t;
            },
            _convertToScrollViewSpace: function(t) {
                var e = this._scrollView.node, i = t.convertToWorldSpaceAR(cc.v2(-t.anchorX * t.width, -t.anchorY * t.height)), n = e.convertToNodeSpaceAR(i);
                return n.x += e.anchorX * e.width, n.y += e.anchorY * e.height, n;
            },
            _setOpacity: function(t) {
                this.handle && (this.node.opacity = t, this.handle.node.opacity = t);
            },
            _onScroll: function(t) {
                if (this._scrollView) {
                    var e = this._scrollView.content;
                    if (e) {
                        var i = e.getContentSize(), r = this._scrollView.node.getContentSize(), s = this.node.getContentSize();
                        if (this._conditionalDisableScrollBar(i, r)) return;
                        this.enableAutoHide && (this._autoHideRemainingTime = this.autoHideTime, this._setOpacity(this._opacity));
                        var o = 0, a = 0, c = 0, l = 0, u = 0;
                        this.direction === n.HORIZONTAL ? (o = i.width, a = r.width, u = s.width, c = t.x, 
                        l = -this._convertToScrollViewSpace(e).x) : this.direction === n.VERTICAL && (o = i.height, 
                        a = r.height, u = s.height, c = t.y, l = -this._convertToScrollViewSpace(e).y);
                        var h = this._calculateLength(o, a, u, c), _ = this._calculatePosition(o, a, u, l, c, h);
                        this._updateLength(h), this._updateHanlderPosition(_);
                    }
                }
            },
            _updateHanlderPosition: function(t) {
                if (this.handle) {
                    var e = this._fixupHandlerPosition();
                    this.handle.node.setPosition(t.x + e.x, t.y + e.y);
                }
            },
            _fixupHandlerPosition: function() {
                var t = this.node.getContentSize(), e = this.node.getAnchorPoint(), i = this.handle.node.getContentSize(), r = this.handle.node.parent, s = this.node.convertToWorldSpaceAR(cc.v2(-t.width * e.x, -t.height * e.y)), o = r.convertToNodeSpaceAR(s);
                return this.direction === n.HORIZONTAL ? o = cc.v2(o.x, o.y + (t.height - i.height) / 2) : this.direction === n.VERTICAL && (o = cc.v2(o.x + (t.width - i.width) / 2, o.y)), 
                this.handle.node.setPosition(o), o;
            },
            _onTouchBegan: function() {
                this.enableAutoHide && (this._touching = !0);
            },
            _conditionalDisableScrollBar: function(t, e) {
                return t.width <= e.width && this.direction === n.HORIZONTAL || t.height <= e.height && this.direction === n.VERTICAL;
            },
            _onTouchEnded: function() {
                if (this.enableAutoHide && (this._touching = !1, !(this.autoHideTime <= 0))) {
                    if (this._scrollView) {
                        var t = this._scrollView.content;
                        if (t) {
                            var e = t.getContentSize(), i = this._scrollView.node.getContentSize();
                            if (this._conditionalDisableScrollBar(e, i)) return;
                        }
                    }
                    this._autoHideRemainingTime = this.autoHideTime;
                }
            },
            _calculateLength: function(t, e, i, n) {
                var r = t;
                return n && (r += 20 * (n > 0 ? n : -n)), i * (e / r);
            },
            _calculatePosition: function(t, e, r, s, o, a) {
                var c = t - e;
                o && (c += Math.abs(o));
                var l = 0;
                c && (l = s / c, l = i.clamp01(l));
                var u = (r - a) * l;
                return this.direction === n.VERTICAL ? cc.v2(0, u) : cc.v2(u, 0);
            },
            _updateLength: function(t) {
                if (this.handle) {
                    var e = this.handle.node, i = e.getContentSize();
                    e.setAnchorPoint(cc.v2(0, 0)), this.direction === n.HORIZONTAL ? e.setContentSize(t, i.height) : e.setContentSize(i.width, t);
                }
            },
            _processAutoHide: function(t) {
                if (this.enableAutoHide && !(this._autoHideRemainingTime <= 0) && !this._touching && (this._autoHideRemainingTime -= t, 
                this._autoHideRemainingTime <= this.autoHideTime)) {
                    this._autoHideRemainingTime = Math.max(0, this._autoHideRemainingTime);
                    var e = this._opacity * (this._autoHideRemainingTime / this.autoHideTime);
                    this._setOpacity(e);
                }
            },
            start: function() {
                this.enableAutoHide && this._setOpacity(0);
            },
            hide: function() {
                this._autoHideRemainingTime = 0, this._setOpacity(0);
            },
            show: function() {
                this._autoHideRemainingTime = this.autoHideTime, this._setOpacity(this._opacity);
            },
            update: function(t) {
                this._processAutoHide(t);
            }
        });
        cc.Scrollbar = e.exports = r;
    }, {
        "../utils/misc": 256,
        "./CCComponent": 101
    } ],
    112: [ function(t, e) {
        "use strict";
        var i = t("../CCNode").EventType, n = cc.v2(), r = cc.v2(), s = function() {
            return new Date().getMilliseconds();
        }, o = cc.Enum({
            SCROLL_TO_TOP: 0,
            SCROLL_TO_BOTTOM: 1,
            SCROLL_TO_LEFT: 2,
            SCROLL_TO_RIGHT: 3,
            SCROLLING: 4,
            BOUNCE_TOP: 5,
            BOUNCE_BOTTOM: 6,
            BOUNCE_LEFT: 7,
            BOUNCE_RIGHT: 8,
            SCROLL_ENDED: 9,
            TOUCH_UP: 10,
            AUTOSCROLL_ENDED_WITH_THRESHOLD: 11,
            SCROLL_BEGAN: 12
        }), a = {
            "scroll-to-top": o.SCROLL_TO_TOP,
            "scroll-to-bottom": o.SCROLL_TO_BOTTOM,
            "scroll-to-left": o.SCROLL_TO_LEFT,
            "scroll-to-right": o.SCROLL_TO_RIGHT,
            scrolling: o.SCROLLING,
            "bounce-bottom": o.BOUNCE_BOTTOM,
            "bounce-left": o.BOUNCE_LEFT,
            "bounce-right": o.BOUNCE_RIGHT,
            "bounce-top": o.BOUNCE_TOP,
            "scroll-ended": o.SCROLL_ENDED,
            "touch-up": o.TOUCH_UP,
            "scroll-ended-with-threshold": o.AUTOSCROLL_ENDED_WITH_THRESHOLD,
            "scroll-began": o.SCROLL_BEGAN
        }, c = cc.Class({
            name: "cc.ScrollView",
            extends: t("./CCViewGroup"),
            editor: !1,
            ctor: function() {
                this._topBoundary = 0, this._bottomBoundary = 0, this._leftBoundary = 0, this._rightBoundary = 0, 
                this._touchMoveDisplacements = [], this._touchMoveTimeDeltas = [], this._touchMovePreviousTimestamp = 0, 
                this._touchMoved = !1, this._autoScrolling = !1, this._autoScrollAttenuate = !1, 
                this._autoScrollStartPosition = cc.v2(0, 0), this._autoScrollTargetDelta = cc.v2(0, 0), 
                this._autoScrollTotalTime = 0, this._autoScrollAccumulatedTime = 0, this._autoScrollCurrentlyOutOfBoundary = !1, 
                this._autoScrollBraking = !1, this._autoScrollBrakingStartPosition = cc.v2(0, 0), 
                this._outOfBoundaryAmount = cc.v2(0, 0), this._outOfBoundaryAmountDirty = !0, this._stopMouseWheel = !1, 
                this._mouseWheelEventElapsedTime = 0, this._isScrollEndedWithThresholdEventFired = !1, 
                this._scrollEventEmitMask = 0, this._isBouncing = !1, this._scrolling = !1;
            },
            properties: {
                content: {
                    default: void 0,
                    type: cc.Node,
                    tooltip: !1,
                    formerlySerializedAs: "content",
                    notify: function() {
                        this._calculateBoundary();
                    }
                },
                horizontal: {
                    default: !0,
                    animatable: !1,
                    tooltip: !1
                },
                vertical: {
                    default: !0,
                    animatable: !1,
                    tooltip: !1
                },
                inertia: {
                    default: !0,
                    tooltip: !1
                },
                brake: {
                    default: .5,
                    type: cc.Float,
                    range: [ 0, 1, .1 ],
                    tooltip: !1
                },
                elastic: {
                    default: !0,
                    animatable: !1,
                    tooltip: !1
                },
                bounceDuration: {
                    default: 1,
                    range: [ 0, 10 ],
                    tooltip: !1
                },
                horizontalScrollBar: {
                    default: void 0,
                    type: cc.Scrollbar,
                    tooltip: !1,
                    notify: function() {
                        this.horizontalScrollBar && (this.horizontalScrollBar.setTargetScrollView(this), 
                        this._updateScrollBar(0));
                    },
                    animatable: !1
                },
                verticalScrollBar: {
                    default: void 0,
                    type: cc.Scrollbar,
                    tooltip: !1,
                    notify: function() {
                        this.verticalScrollBar && (this.verticalScrollBar.setTargetScrollView(this), this._updateScrollBar(0));
                    },
                    animatable: !1
                },
                scrollEvents: {
                    default: [],
                    type: cc.Component.EventHandler,
                    tooltip: !1
                },
                cancelInnerEvents: {
                    default: !0,
                    animatable: !1,
                    tooltip: !1
                },
                _view: {
                    get: function() {
                        if (this.content) return this.content.parent;
                    }
                }
            },
            statics: {
                EventType: o
            },
            scrollToBottom: function(t, e) {
                var i = this._calculateMovePercentDelta({
                    anchor: cc.v2(0, 0),
                    applyToHorizontal: !1,
                    applyToVertical: !0
                });
                t ? this._startAutoScroll(i, t, !1 !== e) : this._moveContent(i, !0);
            },
            scrollToTop: function(t, e) {
                var i = this._calculateMovePercentDelta({
                    anchor: cc.v2(0, 1),
                    applyToHorizontal: !1,
                    applyToVertical: !0
                });
                t ? this._startAutoScroll(i, t, !1 !== e) : this._moveContent(i);
            },
            scrollToLeft: function(t, e) {
                var i = this._calculateMovePercentDelta({
                    anchor: cc.v2(0, 0),
                    applyToHorizontal: !0,
                    applyToVertical: !1
                });
                t ? this._startAutoScroll(i, t, !1 !== e) : this._moveContent(i);
            },
            scrollToRight: function(t, e) {
                var i = this._calculateMovePercentDelta({
                    anchor: cc.v2(1, 0),
                    applyToHorizontal: !0,
                    applyToVertical: !1
                });
                t ? this._startAutoScroll(i, t, !1 !== e) : this._moveContent(i);
            },
            scrollToTopLeft: function(t, e) {
                var i = this._calculateMovePercentDelta({
                    anchor: cc.v2(0, 1),
                    applyToHorizontal: !0,
                    applyToVertical: !0
                });
                t ? this._startAutoScroll(i, t, !1 !== e) : this._moveContent(i);
            },
            scrollToTopRight: function(t, e) {
                var i = this._calculateMovePercentDelta({
                    anchor: cc.v2(1, 1),
                    applyToHorizontal: !0,
                    applyToVertical: !0
                });
                t ? this._startAutoScroll(i, t, !1 !== e) : this._moveContent(i);
            },
            scrollToBottomLeft: function(t, e) {
                var i = this._calculateMovePercentDelta({
                    anchor: cc.v2(0, 0),
                    applyToHorizontal: !0,
                    applyToVertical: !0
                });
                t ? this._startAutoScroll(i, t, !1 !== e) : this._moveContent(i);
            },
            scrollToBottomRight: function(t, e) {
                var i = this._calculateMovePercentDelta({
                    anchor: cc.v2(1, 0),
                    applyToHorizontal: !0,
                    applyToVertical: !0
                });
                t ? this._startAutoScroll(i, t, !1 !== e) : this._moveContent(i);
            },
            scrollToOffset: function(t, e, i) {
                var n = this.getMaxScrollOffset(), r = cc.v2(0, 0);
                0 === n.x ? r.x = 0 : r.x = t.x / n.x, 0 === n.y ? r.y = 1 : r.y = (n.y - t.y) / n.y, 
                this.scrollTo(r, e, i);
            },
            getScrollOffset: function() {
                var t = this._getContentTopBoundary() - this._topBoundary, e = this._getContentLeftBoundary() - this._leftBoundary;
                return cc.v2(e, t);
            },
            getMaxScrollOffset: function() {
                var t = this._view.getContentSize(), e = this.content.getContentSize(), i = e.width - t.width, n = e.height - t.height;
                return i = i >= 0 ? i : 0, n = n >= 0 ? n : 0, cc.v2(i, n);
            },
            scrollToPercentHorizontal: function(t, e, i) {
                var n = this._calculateMovePercentDelta({
                    anchor: cc.v2(t, 0),
                    applyToHorizontal: !0,
                    applyToVertical: !1
                });
                e ? this._startAutoScroll(n, e, !1 !== i) : this._moveContent(n);
            },
            scrollTo: function(t, e, i) {
                var n = this._calculateMovePercentDelta({
                    anchor: cc.v2(t),
                    applyToHorizontal: !0,
                    applyToVertical: !0
                });
                e ? this._startAutoScroll(n, e, !1 !== i) : this._moveContent(n);
            },
            scrollToPercentVertical: function(t, e, i) {
                var n = this._calculateMovePercentDelta({
                    anchor: cc.v2(0, t),
                    applyToHorizontal: !1,
                    applyToVertical: !0
                });
                e ? this._startAutoScroll(n, e, !1 !== i) : this._moveContent(n);
            },
            stopAutoScroll: function() {
                this._autoScrolling = !1, this._autoScrollAccumulatedTime = this._autoScrollTotalTime;
            },
            setContentPosition: function(t) {
                t.fuzzyEquals(this.getContentPosition(), 1e-4) || (this.content.setPosition(t), 
                this._outOfBoundaryAmountDirty = !0);
            },
            getContentPosition: function() {
                return this.content.getPosition();
            },
            isScrolling: function() {
                return this._scrolling;
            },
            isAutoScrolling: function() {
                return this._autoScrolling;
            },
            _registerEvent: function() {
                this.node.on(cc.Node.EventType.TOUCH_START, this._onTouchBegan, this, !0), this.node.on(cc.Node.EventType.TOUCH_MOVE, this._onTouchMoved, this, !0), 
                this.node.on(cc.Node.EventType.TOUCH_END, this._onTouchEnded, this, !0), this.node.on(cc.Node.EventType.TOUCH_CANCEL, this._onTouchCancelled, this, !0), 
                this.node.on(cc.Node.EventType.MOUSE_WHEEL, this._onMouseWheel, this, !0);
            },
            _unregisterEvent: function() {
                this.node.off(cc.Node.EventType.TOUCH_START, this._onTouchBegan, this, !0), this.node.off(cc.Node.EventType.TOUCH_MOVE, this._onTouchMoved, this, !0), 
                this.node.off(cc.Node.EventType.TOUCH_END, this._onTouchEnded, this, !0), this.node.off(cc.Node.EventType.TOUCH_CANCEL, this._onTouchCancelled, this, !0), 
                this.node.off(cc.Node.EventType.MOUSE_WHEEL, this._onMouseWheel, this, !0);
            },
            _onMouseWheel: function(t, e) {
                if (this.enabledInHierarchy && !this._hasNestedViewGroup(t, e)) {
                    var i = cc.v2(0, 0);
                    this.vertical ? i = cc.v2(0, -.1 * t.getScrollY()) : this.horizontal && (i = cc.v2(-.1 * t.getScrollY(), 0)), 
                    this._mouseWheelEventElapsedTime = 0, this._processDeltaMove(i), this._stopMouseWheel || (this._handlePressLogic(), 
                    this.schedule(this._checkMouseWheel, 1 / 60), this._stopMouseWheel = !0), this._stopPropagationIfTargetIsMe(t);
                }
            },
            _checkMouseWheel: function(t) {
                if (!this._getHowMuchOutOfBoundary().fuzzyEquals(cc.v2(0, 0), 1e-4)) return this._processInertiaScroll(), 
                this.unschedule(this._checkMouseWheel), this._dispatchEvent("scroll-ended"), void (this._stopMouseWheel = !1);
                this._mouseWheelEventElapsedTime += t, this._mouseWheelEventElapsedTime > .1 && (this._onScrollBarTouchEnded(), 
                this.unschedule(this._checkMouseWheel), this._dispatchEvent("scroll-ended"), this._stopMouseWheel = !1);
            },
            _calculateMovePercentDelta: function(t) {
                var e = t.anchor, i = t.applyToHorizontal, n = t.applyToVertical;
                this._calculateBoundary(), e = e.clampf(cc.v2(0, 0), cc.v2(1, 1));
                var r = this._view.getContentSize(), s = this.content.getContentSize(), o = this._getContentBottomBoundary() - this._bottomBoundary;
                o = -o;
                var a = this._getContentLeftBoundary() - this._leftBoundary;
                a = -a;
                var c = cc.v2(0, 0), l = 0;
                return i && (l = s.width - r.width, c.x = a - l * e.x), n && (l = s.height - r.height, 
                c.y = o - l * e.y), c;
            },
            _moveContentToTopLeft: function(t) {
                var e = this.content.getContentSize(), i = this._getContentBottomBoundary() - this._bottomBoundary;
                i = -i;
                var n = cc.v2(0, 0), r = 0, s = this._getContentLeftBoundary() - this._leftBoundary;
                s = -s, e.height < t.height && (r = e.height - t.height, n.y = i - r), e.width < t.width && (r = e.width - t.width, 
                n.x = s), this._updateScrollBarState(), this._moveContent(n), this._adjustContentOutOfBoundary();
            },
            _calculateBoundary: function() {
                if (this.content) {
                    var t = this.content.getComponent(cc.Layout);
                    t && t.enabledInHierarchy && t.updateLayout();
                    var e = this._view.getContentSize(), i = e.width * this._view.anchorX, n = e.height * this._view.anchorY;
                    this._leftBoundary = -i, this._bottomBoundary = -n, this._rightBoundary = this._leftBoundary + e.width, 
                    this._topBoundary = this._bottomBoundary + e.height, this._moveContentToTopLeft(e);
                }
            },
            _hasNestedViewGroup: function(t, e) {
                if (t.eventPhase === cc.Event.CAPTURING_PHASE) {
                    if (e) for (var i = 0; i < e.length; ++i) {
                        var n = e[i];
                        if (this.node === n) return !!t.target.getComponent(cc.ViewGroup);
                        if (n.getComponent(cc.ViewGroup)) return !0;
                    }
                    return !1;
                }
            },
            _stopPropagationIfTargetIsMe: function(t) {
                t.eventPhase === cc.Event.AT_TARGET && t.target === this.node && t.stopPropagation();
            },
            _onTouchBegan: function(t, e) {
                if (this.enabledInHierarchy && !this._hasNestedViewGroup(t, e)) {
                    var i = t.touch;
                    this.content && this._handlePressLogic(i), this._touchMoved = !1, this._stopPropagationIfTargetIsMe(t);
                }
            },
            _onTouchMoved: function(t, e) {
                if (this.enabledInHierarchy && !this._hasNestedViewGroup(t, e)) {
                    var i = t.touch;
                    if (this.content && this._handleMoveLogic(i), this.cancelInnerEvents) {
                        if (i.getLocation().sub(i.getStartLocation()).mag() > 7 && !this._touchMoved && t.target !== this.node) {
                            var n = new cc.Event.EventTouch(t.getTouches(), t.bubbles);
                            n.type = cc.Node.EventType.TOUCH_CANCEL, n.touch = t.touch, n.simulate = !0, t.target.dispatchEvent(n), 
                            this._touchMoved = !0;
                        }
                        this._stopPropagationIfTargetIsMe(t);
                    }
                }
            },
            _onTouchEnded: function(t, e) {
                if (this.enabledInHierarchy && !this._hasNestedViewGroup(t, e)) {
                    this._dispatchEvent("touch-up");
                    var i = t.touch;
                    this.content && this._handleReleaseLogic(i), this._touchMoved ? t.stopPropagation() : this._stopPropagationIfTargetIsMe(t);
                }
            },
            _onTouchCancelled: function(t, e) {
                if (this.enabledInHierarchy && !this._hasNestedViewGroup(t, e)) {
                    if (!t.simulate) {
                        var i = t.touch;
                        this.content && this._handleReleaseLogic(i);
                    }
                    this._stopPropagationIfTargetIsMe(t);
                }
            },
            _processDeltaMove: function(t) {
                this._scrollChildren(t), this._gatherTouchMove(t);
            },
            _getLocalAxisAlignDelta: function(t) {
                return this.node.convertToNodeSpaceAR(t.getLocation(), n), this.node.convertToNodeSpaceAR(t.getPreviousLocation(), r), 
                n.sub(r);
            },
            _handleMoveLogic: function(t) {
                var e = this._getLocalAxisAlignDelta(t);
                this._processDeltaMove(e);
            },
            _scrollChildren: function(t) {
                var e, i = t = this._clampDelta(t);
                this.elastic && (e = this._getHowMuchOutOfBoundary(), i.x *= 0 === e.x ? 1 : .5, 
                i.y *= 0 === e.y ? 1 : .5), this.elastic || (e = this._getHowMuchOutOfBoundary(i), 
                i = i.add(e));
                var n = -1;
                i.y > 0 ? this.content.y - this.content.anchorY * this.content.height + i.y >= this._bottomBoundary && (n = "scroll-to-bottom") : i.y < 0 && this.content.y - this.content.anchorY * this.content.height + this.content.height + i.y <= this._topBoundary && (n = "scroll-to-top"), 
                i.x < 0 ? this.content.x - this.content.anchorX * this.content.width + this.content.width + i.x <= this._rightBoundary && (n = "scroll-to-right") : i.x > 0 && this.content.x - this.content.anchorX * this.content.width + i.x >= this._leftBoundary && (n = "scroll-to-left"), 
                this._moveContent(i, !1), 0 === i.x && 0 === i.y || (this._scrolling || (this._scrolling = !0, 
                this._dispatchEvent("scroll-began")), this._dispatchEvent("scrolling")), -1 !== n && this._dispatchEvent(n);
            },
            _handlePressLogic: function() {
                this._autoScrolling && this._dispatchEvent("scroll-ended"), this._autoScrolling = !1, 
                this._isBouncing = !1, this._touchMovePreviousTimestamp = s(), this._touchMoveDisplacements.length = 0, 
                this._touchMoveTimeDeltas.length = 0, this._onScrollBarTouchBegan();
            },
            _clampDelta: function(t) {
                var e = this.content.getContentSize(), i = this._view.getContentSize();
                return e.width < i.width && (t.x = 0), e.height < i.height && (t.y = 0), t;
            },
            _gatherTouchMove: function(t) {
                for (t = this._clampDelta(t); this._touchMoveDisplacements.length >= 5; ) this._touchMoveDisplacements.shift(), 
                this._touchMoveTimeDeltas.shift();
                this._touchMoveDisplacements.push(t);
                var e = s();
                this._touchMoveTimeDeltas.push((e - this._touchMovePreviousTimestamp) / 1e3), this._touchMovePreviousTimestamp = e;
            },
            _startBounceBackIfNeeded: function() {
                if (!this.elastic) return !1;
                var t = this._getHowMuchOutOfBoundary();
                if ((t = this._clampDelta(t)).fuzzyEquals(cc.v2(0, 0), 1e-4)) return !1;
                var e = Math.max(this.bounceDuration, 0);
                return this._startAutoScroll(t, e, !0), this._isBouncing || (t.y > 0 && this._dispatchEvent("bounce-top"), 
                t.y < 0 && this._dispatchEvent("bounce-bottom"), t.x > 0 && this._dispatchEvent("bounce-right"), 
                t.x < 0 && this._dispatchEvent("bounce-left"), this._isBouncing = !0), !0;
            },
            _processInertiaScroll: function() {
                if (!this._startBounceBackIfNeeded() && this.inertia) {
                    var t = this._calculateTouchMoveVelocity();
                    !t.fuzzyEquals(cc.v2(0, 0), 1e-4) && this.brake < 1 && this._startInertiaScroll(t);
                }
                this._onScrollBarTouchEnded();
            },
            _handleReleaseLogic: function(t) {
                var e = this._getLocalAxisAlignDelta(t);
                this._gatherTouchMove(e), this._processInertiaScroll(), this._scrolling && (this._scrolling = !1, 
                this._autoScrolling || this._dispatchEvent("scroll-ended"));
            },
            _isOutOfBoundary: function() {
                return !this._getHowMuchOutOfBoundary().fuzzyEquals(cc.v2(0, 0), 1e-4);
            },
            _isNecessaryAutoScrollBrake: function() {
                if (this._autoScrollBraking) return !0;
                if (this._isOutOfBoundary()) {
                    if (!this._autoScrollCurrentlyOutOfBoundary) return this._autoScrollCurrentlyOutOfBoundary = !0, 
                    this._autoScrollBraking = !0, this._autoScrollBrakingStartPosition = this.getContentPosition(), 
                    !0;
                } else this._autoScrollCurrentlyOutOfBoundary = !1;
                return !1;
            },
            getScrollEndedEventTiming: function() {
                return 1e-4;
            },
            _processAutoScrolling: function(t) {
                var e = this._isNecessaryAutoScrollBrake(), i = e ? .05 : 1;
                this._autoScrollAccumulatedTime += t * (1 / i);
                var n, r = Math.min(1, this._autoScrollAccumulatedTime / this._autoScrollTotalTime);
                this._autoScrollAttenuate && (n = r, r = (n -= 1) * n * n * n * n + 1);
                var s = this._autoScrollStartPosition.add(this._autoScrollTargetDelta.mul(r)), o = Math.abs(r - 1) <= 1e-4;
                if (Math.abs(r - 1) <= this.getScrollEndedEventTiming() && !this._isScrollEndedWithThresholdEventFired && (this._dispatchEvent("scroll-ended-with-threshold"), 
                this._isScrollEndedWithThresholdEventFired = !0), this.elastic) {
                    var a = s.sub(this._autoScrollBrakingStartPosition);
                    e && (a = a.mul(i)), s = this._autoScrollBrakingStartPosition.add(a);
                } else {
                    var c = s.sub(this.getContentPosition()), l = this._getHowMuchOutOfBoundary(c);
                    l.fuzzyEquals(cc.v2(0, 0), 1e-4) || (s = s.add(l), o = !0);
                }
                o && (this._autoScrolling = !1);
                var u = s.sub(this.getContentPosition());
                this._moveContent(this._clampDelta(u), o), this._dispatchEvent("scrolling"), this._autoScrolling || (this._isBouncing = !1, 
                this._scrolling = !1, this._dispatchEvent("scroll-ended"));
            },
            _startInertiaScroll: function(t) {
                var e = t.mul(.7);
                this._startAttenuatingAutoScroll(e, t);
            },
            _calculateAttenuatedFactor: function(t) {
                return this.brake <= 0 ? 1 - this.brake : (1 - this.brake) * (1 / (1 + 14e-6 * t + t * t * 8e-9));
            },
            _startAttenuatingAutoScroll: function(t, e) {
                var i = this._calculateAutoScrollTimeByInitalSpeed(e.mag()), n = t.normalize(), r = this.content.getContentSize(), s = this._view.getContentSize(), o = r.width - s.width, a = r.height - s.height, c = this._calculateAttenuatedFactor(o), l = this._calculateAttenuatedFactor(a);
                n = cc.v2(n.x * o * (1 - this.brake) * c, n.y * a * l * (1 - this.brake));
                var u = t.mag(), h = n.mag() / u;
                n = n.add(t), this.brake > 0 && h > 7 && (h = Math.sqrt(h), n = t.mul(h).add(t)), 
                this.brake > 0 && h > 3 && (i *= h = 3), 0 === this.brake && h > 1 && (i *= h), 
                this._startAutoScroll(n, i, !0);
            },
            _calculateAutoScrollTimeByInitalSpeed: function(t) {
                return Math.sqrt(Math.sqrt(t / 5));
            },
            _startAutoScroll: function(t, e, i) {
                var n = this._flattenVectorByDirection(t);
                this._autoScrolling = !0, this._autoScrollTargetDelta = n, this._autoScrollAttenuate = i, 
                this._autoScrollStartPosition = this.getContentPosition(), this._autoScrollTotalTime = e, 
                this._autoScrollAccumulatedTime = 0, this._autoScrollBraking = !1, this._isScrollEndedWithThresholdEventFired = !1, 
                this._autoScrollBrakingStartPosition = cc.v2(0, 0), this._getHowMuchOutOfBoundary().fuzzyEquals(cc.v2(0, 0), 1e-4) || (this._autoScrollCurrentlyOutOfBoundary = !0);
            },
            _calculateTouchMoveVelocity: function() {
                var t = 0;
                if ((t = this._touchMoveTimeDeltas.reduce(function(t, e) {
                    return t + e;
                }, t)) <= 0 || t >= .5) return cc.v2(0, 0);
                var e = cc.v2(0, 0);
                return e = this._touchMoveDisplacements.reduce(function(t, e) {
                    return t.add(e);
                }, e), cc.v2(e.x * (1 - this.brake) / t, e.y * (1 - this.brake) / t);
            },
            _flattenVectorByDirection: function(t) {
                var e = t;
                return e.x = this.horizontal ? e.x : 0, e.y = this.vertical ? e.y : 0, e;
            },
            _moveContent: function(t, e) {
                var i = this._flattenVectorByDirection(t), n = this.getContentPosition().add(i);
                this.setContentPosition(n);
                var r = this._getHowMuchOutOfBoundary();
                this._updateScrollBar(r), this.elastic && e && this._startBounceBackIfNeeded();
            },
            _getContentLeftBoundary: function() {
                return this.getContentPosition().x - this.content.getAnchorPoint().x * this.content.getContentSize().width;
            },
            _getContentRightBoundary: function() {
                var t = this.content.getContentSize();
                return this._getContentLeftBoundary() + t.width;
            },
            _getContentTopBoundary: function() {
                var t = this.content.getContentSize();
                return this._getContentBottomBoundary() + t.height;
            },
            _getContentBottomBoundary: function() {
                return this.getContentPosition().y - this.content.getAnchorPoint().y * this.content.getContentSize().height;
            },
            _getHowMuchOutOfBoundary: function(t) {
                if ((t = t || cc.v2(0, 0)).fuzzyEquals(cc.v2(0, 0), 1e-4) && !this._outOfBoundaryAmountDirty) return this._outOfBoundaryAmount;
                var e = cc.v2(0, 0);
                return this._getContentLeftBoundary() + t.x > this._leftBoundary ? e.x = this._leftBoundary - (this._getContentLeftBoundary() + t.x) : this._getContentRightBoundary() + t.x < this._rightBoundary && (e.x = this._rightBoundary - (this._getContentRightBoundary() + t.x)), 
                this._getContentTopBoundary() + t.y < this._topBoundary ? e.y = this._topBoundary - (this._getContentTopBoundary() + t.y) : this._getContentBottomBoundary() + t.y > this._bottomBoundary && (e.y = this._bottomBoundary - (this._getContentBottomBoundary() + t.y)), 
                t.fuzzyEquals(cc.v2(0, 0), 1e-4) && (this._outOfBoundaryAmount = e, this._outOfBoundaryAmountDirty = !1), 
                this._clampDelta(e);
            },
            _updateScrollBarState: function() {
                if (this.content) {
                    var t = this.content.getContentSize(), e = this._view.getContentSize();
                    this.verticalScrollBar && (t.height < e.height ? this.verticalScrollBar.hide() : this.verticalScrollBar.show()), 
                    this.horizontalScrollBar && (t.width < e.width ? this.horizontalScrollBar.hide() : this.horizontalScrollBar.show());
                }
            },
            _updateScrollBar: function(t) {
                this.horizontalScrollBar && this.horizontalScrollBar._onScroll(t), this.verticalScrollBar && this.verticalScrollBar._onScroll(t);
            },
            _onScrollBarTouchBegan: function() {
                this.horizontalScrollBar && this.horizontalScrollBar._onTouchBegan(), this.verticalScrollBar && this.verticalScrollBar._onTouchBegan();
            },
            _onScrollBarTouchEnded: function() {
                this.horizontalScrollBar && this.horizontalScrollBar._onTouchEnded(), this.verticalScrollBar && this.verticalScrollBar._onTouchEnded();
            },
            _dispatchEvent: function(t) {
                if ("scroll-ended" === t) this._scrollEventEmitMask = 0; else if ("scroll-to-top" === t || "scroll-to-bottom" === t || "scroll-to-left" === t || "scroll-to-right" === t) {
                    var e = 1 << a[t];
                    if (this._scrollEventEmitMask & e) return;
                    this._scrollEventEmitMask |= e;
                }
                cc.Component.EventHandler.emitEvents(this.scrollEvents, this, a[t]), this.node.emit(t, this);
            },
            _adjustContentOutOfBoundary: function() {
                if (this._outOfBoundaryAmountDirty = !0, this._isOutOfBoundary()) {
                    var t = this._getHowMuchOutOfBoundary(cc.v2(0, 0)), e = this.getContentPosition().add(t);
                    this.content && (this.content.setPosition(e), this._updateScrollBar(0));
                }
            },
            start: function() {
                this._calculateBoundary(), this.content && cc.director.once(cc.Director.EVENT_BEFORE_DRAW, this._adjustContentOutOfBoundary, this);
            },
            _hideScrollbar: function() {
                this.horizontalScrollBar && this.horizontalScrollBar.hide(), this.verticalScrollBar && this.verticalScrollBar.hide();
            },
            onDisable: function() {
                this._unregisterEvent(), this.content && (this.content.off(i.SIZE_CHANGED, this._calculateBoundary, this), 
                this.content.off(i.SCALE_CHANGED, this._calculateBoundary, this), this._view && (this._view.off(i.POSITION_CHANGED, this._calculateBoundary, this), 
                this._view.off(i.SCALE_CHANGED, this._calculateBoundary, this), this._view.off(i.SIZE_CHANGED, this._calculateBoundary, this))), 
                this._hideScrollbar(), this.stopAutoScroll();
            },
            onEnable: function() {
                this._registerEvent(), this.content && (this.content.on(i.SIZE_CHANGED, this._calculateBoundary, this), 
                this.content.on(i.SCALE_CHANGED, this._calculateBoundary, this), this._view && (this._view.on(i.POSITION_CHANGED, this._calculateBoundary, this), 
                this._view.on(i.SCALE_CHANGED, this._calculateBoundary, this), this._view.on(i.SIZE_CHANGED, this._calculateBoundary, this))), 
                this._updateScrollBarState();
            },
            update: function(t) {
                this._autoScrolling && this._processAutoScrolling(t);
            }
        });
        cc.ScrollView = e.exports = c;
    }, {
        "../CCNode": 25,
        "./CCViewGroup": 118
    } ],
    113: [ function(t, e) {
        "use strict";
        var i = t("../utils/misc"), n = t("./CCComponent"), r = cc.Enum({
            Horizontal: 0,
            Vertical: 1
        }), s = cc.Class({
            name: "cc.Slider",
            extends: n,
            editor: !1,
            ctor: function() {
                this._offset = cc.v2(), this._touchHandle = !1, this._dragging = !1;
            },
            properties: {
                handle: {
                    default: null,
                    type: cc.Button,
                    tooltip: !1,
                    notify: function() {}
                },
                direction: {
                    default: r.Horizontal,
                    type: r,
                    tooltip: !1
                },
                progress: {
                    default: .5,
                    type: cc.Float,
                    range: [ 0, 1, .1 ],
                    slide: !0,
                    tooltip: !1,
                    notify: function() {
                        this._updateHandlePosition();
                    }
                },
                slideEvents: {
                    default: [],
                    type: cc.Component.EventHandler,
                    tooltip: !1
                }
            },
            statics: {
                Direction: r
            },
            __preload: function() {
                this._updateHandlePosition();
            },
            onEnable: function() {
                this.node.on(cc.Node.EventType.TOUCH_START, this._onTouchBegan, this), this.node.on(cc.Node.EventType.TOUCH_MOVE, this._onTouchMoved, this), 
                this.node.on(cc.Node.EventType.TOUCH_END, this._onTouchEnded, this), this.node.on(cc.Node.EventType.TOUCH_CANCEL, this._onTouchCancelled, this), 
                this.handle && this.handle.isValid && (this.handle.node.on(cc.Node.EventType.TOUCH_START, this._onHandleDragStart, this), 
                this.handle.node.on(cc.Node.EventType.TOUCH_MOVE, this._onTouchMoved, this), this.handle.node.on(cc.Node.EventType.TOUCH_END, this._onTouchEnded, this));
            },
            onDisable: function() {
                this.node.off(cc.Node.EventType.TOUCH_START, this._onTouchBegan, this), this.node.off(cc.Node.EventType.TOUCH_MOVE, this._onTouchMoved, this), 
                this.node.off(cc.Node.EventType.TOUCH_END, this._onTouchEnded, this), this.node.off(cc.Node.EventType.TOUCH_CANCEL, this._onTouchCancelled, this), 
                this.handle && this.handle.isValid && (this.handle.node.off(cc.Node.EventType.TOUCH_START, this._onHandleDragStart, this), 
                this.handle.node.off(cc.Node.EventType.TOUCH_MOVE, this._onTouchMoved, this), this.handle.node.off(cc.Node.EventType.TOUCH_END, this._onTouchEnded, this));
            },
            _onHandleDragStart: function(t) {
                this._dragging = !0, this._touchHandle = !0, this._offset = this.handle.node.convertToNodeSpaceAR(t.touch.getLocation()), 
                t.stopPropagation();
            },
            _onTouchBegan: function(t) {
                this.handle && (this._dragging = !0, this._touchHandle || this._handleSliderLogic(t.touch), 
                t.stopPropagation());
            },
            _onTouchMoved: function(t) {
                this._dragging && (this._handleSliderLogic(t.touch), t.stopPropagation());
            },
            _onTouchEnded: function(t) {
                this._dragging = !1, this._touchHandle = !1, this._offset = cc.v2(), t.stopPropagation();
            },
            _onTouchCancelled: function(t) {
                this._dragging = !1, t.stopPropagation();
            },
            _handleSliderLogic: function(t) {
                this._updateProgress(t), this._emitSlideEvent();
            },
            _emitSlideEvent: function() {
                cc.Component.EventHandler.emitEvents(this.slideEvents, this), this.node.emit("slide", this);
            },
            _updateProgress: function(t) {
                if (this.handle) {
                    var e = this.node, n = e.convertToNodeSpaceAR(t.getLocation());
                    this.direction === r.Horizontal ? this.progress = i.clamp01((n.x - this._offset.x + e.anchorX * e.width) / e.width) : this.progress = i.clamp01((n.y - this._offset.y + e.anchorY * e.height) / e.height);
                }
            },
            _updateHandlePosition: function() {
                if (this.handle) {
                    var t;
                    t = this.direction === r.Horizontal ? cc.v2(-this.node.width * this.node.anchorX + this.progress * this.node.width, 0) : cc.v2(0, -this.node.height * this.node.anchorY + this.progress * this.node.height);
                    var e = this.node.convertToWorldSpaceAR(t);
                    this.handle.node.position = this.handle.node.parent.convertToNodeSpaceAR(e);
                }
            }
        });
        cc.Slider = e.exports = s;
    }, {
        "../utils/misc": 256,
        "./CCComponent": 101
    } ],
    114: [ function(t, e) {
        "use strict";
        var i = t("../utils/misc"), n = (t("../CCNode").EventType, t("./CCRenderComponent")), r = t("../utils/blend-func"), s = cc.Enum({
            SIMPLE: 0,
            SLICED: 1,
            TILED: 2,
            FILLED: 3,
            MESH: 4
        }), o = cc.Enum({
            HORIZONTAL: 0,
            VERTICAL: 1,
            RADIAL: 2
        }), a = cc.Enum({
            CUSTOM: 0,
            TRIMMED: 1,
            RAW: 2
        }), c = cc.Enum({
            NORMAL: 0,
            GRAY: 1
        }), l = cc.Class({
            name: "cc.Sprite",
            extends: n,
            mixins: [ r ],
            editor: !1,
            properties: {
                _spriteFrame: {
                    default: null,
                    type: cc.SpriteFrame
                },
                _type: s.SIMPLE,
                _sizeMode: a.TRIMMED,
                _fillType: 0,
                _fillCenter: cc.v2(0, 0),
                _fillStart: 0,
                _fillRange: 0,
                _isTrimmedMode: !0,
                _atlas: {
                    default: null,
                    type: cc.SpriteAtlas,
                    tooltip: !1,
                    editorOnly: !0,
                    visible: !0,
                    animatable: !1
                },
                spriteFrame: {
                    get: function() {
                        return this._spriteFrame;
                    },
                    set: function(t) {
                        var e = this._spriteFrame;
                        e !== t && (this._spriteFrame = t, this._applySpriteFrame(e));
                    },
                    type: cc.SpriteFrame
                },
                type: {
                    get: function() {
                        return this._type;
                    },
                    set: function(t) {
                        this._type !== t && (this._type = t, this.setVertsDirty(), this._resetAssembler());
                    },
                    type: s,
                    animatable: !1,
                    tooltip: !1
                },
                fillType: {
                    get: function() {
                        return this._fillType;
                    },
                    set: function(t) {
                        t !== this._fillType && (this._fillType = t, this.setVertsDirty(), this._resetAssembler());
                    },
                    type: o,
                    tooltip: !1
                },
                fillCenter: {
                    get: function() {
                        return this._fillCenter;
                    },
                    set: function(t) {
                        this._fillCenter.x = t.x, this._fillCenter.y = t.y, this._type === s.FILLED && this.setVertsDirty();
                    },
                    tooltip: !1
                },
                fillStart: {
                    get: function() {
                        return this._fillStart;
                    },
                    set: function(t) {
                        this._fillStart = i.clampf(t, -1, 1), this._type === s.FILLED && this.setVertsDirty();
                    },
                    tooltip: !1
                },
                fillRange: {
                    get: function() {
                        return this._fillRange;
                    },
                    set: function(t) {
                        this._fillRange = i.clampf(t, -1, 1), this._type === s.FILLED && this.setVertsDirty();
                    },
                    tooltip: !1
                },
                trim: {
                    get: function() {
                        return this._isTrimmedMode;
                    },
                    set: function(t) {
                        this._isTrimmedMode !== t && (this._isTrimmedMode = t, this._type !== s.SIMPLE && this._type !== s.MESH || this.setVertsDirty());
                    },
                    animatable: !1,
                    tooltip: !1
                },
                sizeMode: {
                    get: function() {
                        return this._sizeMode;
                    },
                    set: function(t) {
                        this._sizeMode = t, t !== a.CUSTOM && this._applySpriteSize();
                    },
                    animatable: !1,
                    type: a,
                    tooltip: !1
                }
            },
            statics: {
                FillType: o,
                Type: s,
                SizeMode: a,
                State: c
            },
            setVisible: function(t) {
                this.enabled = t;
            },
            setState: function() {},
            getState: function() {},
            __preload: function() {
                this._super(), this._applySpriteFrame();
            },
            onEnable: function() {
                this._super(), this._spriteFrame && this._spriteFrame.ensureLoadTexture(), this.node.on(cc.Node.EventType.SIZE_CHANGED, this.setVertsDirty, this), 
                this.node.on(cc.Node.EventType.ANCHOR_CHANGED, this.setVertsDirty, this);
            },
            onDisable: function() {
                this._super(), this.node.off(cc.Node.EventType.SIZE_CHANGED, this.setVertsDirty, this), 
                this.node.off(cc.Node.EventType.ANCHOR_CHANGED, this.setVertsDirty, this);
            },
            _updateMaterial: function() {
                var t = this._spriteFrame && this._spriteFrame.getTexture(), e = this.getMaterial(0);
                e && (void 0 !== e.getDefine("USE_TEXTURE") && e.define("USE_TEXTURE", !0), e.setProperty("texture", t)), 
                r.prototype._updateMaterial.call(this);
            },
            _applyAtlas: !1,
            _validateRender: function() {
                var t = this._spriteFrame;
                this._materials[0] && t && t.textureLoaded() || this.disableRender();
            },
            _applySpriteSize: function() {
                if (this._spriteFrame && this.isValid) {
                    if (a.RAW === this._sizeMode) {
                        var t = this._spriteFrame._originalSize;
                        this.node.setContentSize(t);
                    } else if (a.TRIMMED === this._sizeMode) {
                        var e = this._spriteFrame._rect;
                        this.node.setContentSize(e.width, e.height);
                    }
                    this.setVertsDirty();
                }
            },
            _applySpriteFrame: function(t) {
                var e = t && t.getTexture();
                e && !e.loaded && t.off("load", this._applySpriteSize, this), this._updateMaterial();
                var i = this._spriteFrame;
                if (i) {
                    var n = i.getTexture();
                    n && n.loaded ? this._applySpriteSize() : (this.disableRender(), i.once("load", this._applySpriteSize, this));
                } else this.disableRender();
            }
        });
        cc.Sprite = e.exports = l;
    }, {
        "../CCNode": 25,
        "../utils/blend-func": 251,
        "../utils/misc": 256,
        "./CCRenderComponent": 110
    } ],
    115: [ function(t, e) {
        "use strict";
        var i = t("../utils/gray-sprite-state"), n = cc.Class({
            name: "cc.Toggle",
            extends: t("./CCButton"),
            mixins: [ i ],
            editor: !1,
            properties: {
                _N$isChecked: !0,
                isChecked: {
                    get: function() {
                        return this._N$isChecked;
                    },
                    set: function(t) {
                        if (t !== this._N$isChecked) {
                            var e = this.toggleGroup || this._toggleContainer;
                            e && e.enabled && this._N$isChecked && !e.allowSwitchOff || (this._N$isChecked = t, 
                            this._updateCheckMark(), e && e.enabled && e.updateToggles(this), cc.Toggle._triggerEventInScript_isChecked && this._emitToggleEvents());
                        }
                    },
                    tooltip: !1
                },
                toggleGroup: {
                    default: null,
                    tooltip: !1,
                    type: t("./CCToggleGroup")
                },
                checkMark: {
                    default: null,
                    type: cc.Sprite,
                    tooltip: !1
                },
                checkEvents: {
                    default: [],
                    type: cc.Component.EventHandler
                },
                _resizeToTarget: {
                    animatable: !1,
                    set: function(t) {
                        t && this._resizeNodeToTargetNode();
                    }
                }
            },
            statics: {
                _triggerEventInScript_check: !1,
                _triggerEventInScript_isChecked: !1
            },
            onEnable: function() {
                this._super(), this._registerToggleEvent(), this.toggleGroup && this.toggleGroup.enabledInHierarchy && this.toggleGroup.addToggle(this);
            },
            onDisable: function() {
                this._super(), this._unregisterToggleEvent(), this.toggleGroup && this.toggleGroup.enabledInHierarchy && this.toggleGroup.removeToggle(this);
            },
            _hideCheckMark: function() {
                this._N$isChecked = !1, this._updateCheckMark();
            },
            toggle: function(t) {
                this.isChecked = !this.isChecked, cc.Toggle._triggerEventInScript_isChecked || !cc.Toggle._triggerEventInScript_check && !t || this._emitToggleEvents();
            },
            check: function() {
                this.isChecked = !0, !cc.Toggle._triggerEventInScript_isChecked && cc.Toggle._triggerEventInScript_check && this._emitToggleEvents();
            },
            uncheck: function() {
                this.isChecked = !1, !cc.Toggle._triggerEventInScript_isChecked && cc.Toggle._triggerEventInScript_check && this._emitToggleEvents();
            },
            _updateCheckMark: function() {
                this.checkMark && (this.checkMark.node.active = !!this.isChecked);
            },
            _updateDisabledState: function() {
                if (this._super(), this.enableAutoGrayEffect && this.checkMark) {
                    var t = !this.interactable;
                    this._switchGrayMaterial(t, this.checkMark);
                }
            },
            _registerToggleEvent: function() {
                this.node.on("click", this.toggle, this);
            },
            _unregisterToggleEvent: function() {
                this.node.off("click", this.toggle, this);
            },
            _emitToggleEvents: function() {
                this.node.emit("toggle", this), this.checkEvents && cc.Component.EventHandler.emitEvents(this.checkEvents, this);
            }
        });
        cc.Toggle = e.exports = n, t("../platform/js").get(n.prototype, "_toggleContainer", function() {
            var t = this.node.parent;
            return cc.Node.isNode(t) ? t.getComponent(cc.ToggleContainer) : null;
        });
    }, {
        "../platform/js": 203,
        "../utils/gray-sprite-state": 254,
        "./CCButton": 99,
        "./CCToggleGroup": 117
    } ],
    116: [ function(t, e) {
        "use strict";
        var i = cc.Class({
            name: "cc.ToggleContainer",
            extends: cc.Component,
            editor: !1,
            properties: {
                allowSwitchOff: {
                    tooltip: !1,
                    default: !1
                },
                checkEvents: {
                    default: [],
                    type: cc.Component.EventHandler
                }
            },
            updateToggles: function(t) {
                this.enabledInHierarchy && t.isChecked && (this.toggleItems.forEach(function(e) {
                    e !== t && e.isChecked && e.enabled && e._hideCheckMark();
                }), this.checkEvents && cc.Component.EventHandler.emitEvents(this.checkEvents, t));
            },
            _allowOnlyOneToggleChecked: function() {
                var t = !1;
                return this.toggleItems.forEach(function(e) {
                    t ? e._hideCheckMark() : e.isChecked && (t = !0);
                }), t;
            },
            _makeAtLeastOneToggleChecked: function() {
                if (!this._allowOnlyOneToggleChecked() && !this.allowSwitchOff) {
                    var t = this.toggleItems;
                    t.length > 0 && t[0].check();
                }
            },
            onEnable: function() {
                this.node.on("child-added", this._allowOnlyOneToggleChecked, this), this.node.on("child-removed", this._makeAtLeastOneToggleChecked, this);
            },
            onDisable: function() {
                this.node.off("child-added", this._allowOnlyOneToggleChecked, this), this.node.off("child-removed", this._makeAtLeastOneToggleChecked, this);
            },
            start: function() {
                this._makeAtLeastOneToggleChecked();
            }
        });
        t("../platform/js").get(i.prototype, "toggleItems", function() {
            return this.node._children.map(function(t) {
                return t.getComponent(cc.Toggle);
            }).filter(Boolean);
        }), cc.ToggleContainer = e.exports = i;
    }, {
        "../platform/js": 203
    } ],
    117: [ function(t, e) {
        "use strict";
        var i = cc.Class({
            name: "cc.ToggleGroup",
            extends: cc.Component,
            ctor: function() {
                this._toggleItems = [];
            },
            editor: !1,
            properties: {
                allowSwitchOff: {
                    tooltip: !1,
                    default: !1
                },
                toggleItems: {
                    get: function() {
                        return this._toggleItems;
                    }
                }
            },
            updateToggles: function(t) {
                this.enabledInHierarchy && this._toggleItems.forEach(function(e) {
                    t.isChecked && e !== t && e.isChecked && e.enabled && e._hideCheckMark();
                });
            },
            addToggle: function(t) {
                -1 === this._toggleItems.indexOf(t) && this._toggleItems.push(t), this._allowOnlyOneToggleChecked();
            },
            removeToggle: function(t) {
                var e = this._toggleItems.indexOf(t);
                e > -1 && this._toggleItems.splice(e, 1), this._makeAtLeastOneToggleChecked();
            },
            _allowOnlyOneToggleChecked: function() {
                var t = !1;
                return this._toggleItems.forEach(function(e) {
                    t && e.enabled && e._hideCheckMark(), e.isChecked && e.enabled && (t = !0);
                }), t;
            },
            _makeAtLeastOneToggleChecked: function() {
                this._allowOnlyOneToggleChecked() || this.allowSwitchOff || this._toggleItems.length > 0 && (this._toggleItems[0].isChecked = !0);
            },
            start: function() {
                this._makeAtLeastOneToggleChecked();
            }
        }), n = t("../platform/js"), r = !1;
        n.get(cc, "ToggleGroup", function() {
            return r || (cc.errorID(1405, "cc.ToggleGroup", "cc.ToggleContainer"), r = !0), 
            i;
        }), e.exports = i;
    }, {
        "../platform/js": 203
    } ],
    118: [ function(t, e) {
        "use strict";
        var i = cc.Class({
            name: "cc.ViewGroup",
            extends: t("./CCComponent")
        });
        cc.ViewGroup = e.exports = i;
    }, {
        "./CCComponent": 101
    } ],
    119: [ function(t, e) {
        "use strict";
        var i = t("../base-ui/CCWidgetManager"), n = i.AlignMode, r = i._AlignFlags, s = r.TOP, o = r.MID, a = r.BOT, c = r.LEFT, l = r.CENTER, u = r.RIGHT, h = s | a, _ = c | u, f = cc.Class({
            name: "cc.Widget",
            extends: t("./CCComponent"),
            editor: !1,
            properties: {
                target: {
                    get: function() {
                        return this._target;
                    },
                    set: function(t) {
                        this._target = t;
                    },
                    type: cc.Node,
                    tooltip: !1
                },
                isAlignTop: {
                    get: function() {
                        return (this._alignFlags & s) > 0;
                    },
                    set: function(t) {
                        this._setAlign(s, t);
                    },
                    animatable: !1,
                    tooltip: !1
                },
                isAlignVerticalCenter: {
                    get: function() {
                        return (this._alignFlags & o) > 0;
                    },
                    set: function(t) {
                        t ? (this.isAlignTop = !1, this.isAlignBottom = !1, this._alignFlags |= o) : this._alignFlags &= ~o;
                    },
                    animatable: !1,
                    tooltip: !1
                },
                isAlignBottom: {
                    get: function() {
                        return (this._alignFlags & a) > 0;
                    },
                    set: function(t) {
                        this._setAlign(a, t);
                    },
                    animatable: !1,
                    tooltip: !1
                },
                isAlignLeft: {
                    get: function() {
                        return (this._alignFlags & c) > 0;
                    },
                    set: function(t) {
                        this._setAlign(c, t);
                    },
                    animatable: !1,
                    tooltip: !1
                },
                isAlignHorizontalCenter: {
                    get: function() {
                        return (this._alignFlags & l) > 0;
                    },
                    set: function(t) {
                        t ? (this.isAlignLeft = !1, this.isAlignRight = !1, this._alignFlags |= l) : this._alignFlags &= ~l;
                    },
                    animatable: !1,
                    tooltip: !1
                },
                isAlignRight: {
                    get: function() {
                        return (this._alignFlags & u) > 0;
                    },
                    set: function(t) {
                        this._setAlign(u, t);
                    },
                    animatable: !1,
                    tooltip: !1
                },
                isStretchWidth: {
                    get: function() {
                        return (this._alignFlags & _) === _;
                    },
                    visible: !1
                },
                isStretchHeight: {
                    get: function() {
                        return (this._alignFlags & h) === h;
                    },
                    visible: !1
                },
                top: {
                    get: function() {
                        return this._top;
                    },
                    set: function(t) {
                        this._top = t;
                    },
                    tooltip: !1
                },
                bottom: {
                    get: function() {
                        return this._bottom;
                    },
                    set: function(t) {
                        this._bottom = t;
                    },
                    tooltip: !1
                },
                left: {
                    get: function() {
                        return this._left;
                    },
                    set: function(t) {
                        this._left = t;
                    },
                    tooltip: !1
                },
                right: {
                    get: function() {
                        return this._right;
                    },
                    set: function(t) {
                        this._right = t;
                    },
                    tooltip: !1
                },
                horizontalCenter: {
                    get: function() {
                        return this._horizontalCenter;
                    },
                    set: function(t) {
                        this._horizontalCenter = t;
                    },
                    tooltip: !1
                },
                verticalCenter: {
                    get: function() {
                        return this._verticalCenter;
                    },
                    set: function(t) {
                        this._verticalCenter = t;
                    },
                    tooltip: !1
                },
                isAbsoluteHorizontalCenter: {
                    get: function() {
                        return this._isAbsHorizontalCenter;
                    },
                    set: function(t) {
                        this._isAbsHorizontalCenter = t;
                    },
                    animatable: !1
                },
                isAbsoluteVerticalCenter: {
                    get: function() {
                        return this._isAbsVerticalCenter;
                    },
                    set: function(t) {
                        this._isAbsVerticalCenter = t;
                    },
                    animatable: !1
                },
                isAbsoluteTop: {
                    get: function() {
                        return this._isAbsTop;
                    },
                    set: function(t) {
                        this._isAbsTop = t;
                    },
                    animatable: !1
                },
                isAbsoluteBottom: {
                    get: function() {
                        return this._isAbsBottom;
                    },
                    set: function(t) {
                        this._isAbsBottom = t;
                    },
                    animatable: !1
                },
                isAbsoluteLeft: {
                    get: function() {
                        return this._isAbsLeft;
                    },
                    set: function(t) {
                        this._isAbsLeft = t;
                    },
                    animatable: !1
                },
                isAbsoluteRight: {
                    get: function() {
                        return this._isAbsRight;
                    },
                    set: function(t) {
                        this._isAbsRight = t;
                    },
                    animatable: !1
                },
                alignMode: {
                    default: n.ON_WINDOW_RESIZE,
                    type: n,
                    tooltip: !1
                },
                _wasAlignOnce: {
                    default: void 0,
                    formerlySerializedAs: "isAlignOnce"
                },
                _target: null,
                _alignFlags: 0,
                _left: 0,
                _right: 0,
                _top: 0,
                _bottom: 0,
                _verticalCenter: 0,
                _horizontalCenter: 0,
                _isAbsLeft: !0,
                _isAbsRight: !0,
                _isAbsTop: !0,
                _isAbsBottom: !0,
                _isAbsHorizontalCenter: !0,
                _isAbsVerticalCenter: !0,
                _originalWidth: 0,
                _originalHeight: 0
            },
            statics: {
                AlignMode: n
            },
            onLoad: function() {
                void 0 !== this._wasAlignOnce && (this.alignMode = this._wasAlignOnce ? n.ONCE : n.ALWAYS, 
                this._wasAlignOnce = void 0);
            },
            onEnable: function() {
                i.add(this);
            },
            onDisable: function() {
                i.remove(this);
            },
            _validateTargetInDEV: !1,
            _setAlign: function(t, e) {
                if (e !== (this._alignFlags & t) > 0) {
                    var i = (t & _) > 0;
                    e ? (this._alignFlags |= t, i ? (this.isAlignHorizontalCenter = !1, this.isStretchWidth && (this._originalWidth = this.node.width)) : (this.isAlignVerticalCenter = !1, 
                    this.isStretchHeight && (this._originalHeight = this.node.height))) : (i ? this.isStretchWidth && (this.node.width = this._originalWidth) : this.isStretchHeight && (this.node.height = this._originalHeight), 
                    this._alignFlags &= ~t);
                }
            },
            updateAlignment: function() {
                i.updateAlignment(this.node);
            }
        });
        Object.defineProperty(f.prototype, "isAlignOnce", {
            get: function() {
                return this.alignMode === n.ONCE;
            },
            set: function(t) {
                this.alignMode = t ? n.ONCE : n.ALWAYS;
            }
        }), cc.Widget = e.exports = f;
    }, {
        "../base-ui/CCWidgetManager": 85,
        "./CCComponent": 101
    } ],
    120: [ function(t, e) {
        "use strict";
        var i = t("./CCComponent"), n = cc.Class({
            name: "cc.SubContextView",
            extends: i,
            editor: !1,
            properties: {
                _firstlyEnabled: !0,
                _fps: 60,
                fps: {
                    get: function() {
                        return this._fps;
                    },
                    set: function(t) {
                        this._fps !== t && (this._fps = t, this._updateInterval = 1 / t, this._updateSubContextFrameRate());
                    },
                    tooltip: !1
                }
            },
            ctor: function() {
                this._sprite = null, this._tex = new cc.Texture2D(), this._context = null, this._updatedTime = performance.now(), 
                this._updateInterval = 0;
            },
            onLoad: function() {
                if (window.__globalAdapter && __globalAdapter.getOpenDataContext) {
                    this._updateInterval = 1e3 / this._fps, this._context = __globalAdapter.getOpenDataContext(), 
                    this.reset();
                    var t = this._context.canvas;
                    this._tex.setPremultiplyAlpha(!0), this._tex.initWithElement(t), this._sprite = this.node.getComponent(cc.Sprite), 
                    this._sprite || (this._sprite = this.node.addComponent(cc.Sprite), this._sprite.srcBlendFactor = cc.macro.BlendFactor.ONE), 
                    this._sprite.spriteFrame = new cc.SpriteFrame(this._tex);
                } else this.enabled = !1;
            },
            reset: function() {
                if (this._context) {
                    this.updateSubContextViewport();
                    var t = this._context.canvas;
                    t && (t.width = this.node.width, t.height = this.node.height);
                }
            },
            onEnable: function() {
                this._firstlyEnabled && this._context ? (this._context.postMessage({
                    fromEngine: !0,
                    event: "boot"
                }), this._firstlyEnabled = !1) : this._runSubContextMainLoop(), this._registerNodeEvent(), 
                this._updateSubContextFrameRate(), this.updateSubContextViewport();
            },
            onDisable: function() {
                this._unregisterNodeEvent(), this._stopSubContextMainLoop();
            },
            update: function(t) {
                if (void 0 === t) return this._context && this._context.postMessage({
                    fromEngine: !0,
                    event: "step"
                }), void this._updateSubContextTexture();
                performance.now() - this._updatedTime >= this._updateInterval && (this._updatedTime += this._updateInterval, 
                this._updateSubContextTexture());
            },
            _updateSubContextTexture: function() {
                this._tex && this._context && (this._tex.initWithElement(this._context.canvas), 
                this._sprite._activateMaterial());
            },
            updateSubContextViewport: function() {
                if (this._context) {
                    var t = this.node.getBoundingBoxToWorld(), e = cc.view._scaleX, i = cc.view._scaleY;
                    this._context.postMessage({
                        fromEngine: !0,
                        event: "viewport",
                        x: t.x * e + cc.view._viewportRect.x,
                        y: t.y * i + cc.view._viewportRect.y,
                        width: t.width * e,
                        height: t.height * i
                    });
                }
            },
            _registerNodeEvent: function() {
                this.node.on("position-changed", this.updateSubContextViewport, this), this.node.on("scale-changed", this.updateSubContextViewport, this), 
                this.node.on("size-changed", this.updateSubContextViewport, this);
            },
            _unregisterNodeEvent: function() {
                this.node.off("position-changed", this.updateSubContextViewport, this), this.node.off("scale-changed", this.updateSubContextViewport, this), 
                this.node.off("size-changed", this.updateSubContextViewport, this);
            },
            _runSubContextMainLoop: function() {
                this._context && this._context.postMessage({
                    fromEngine: !0,
                    event: "mainLoop",
                    value: !0
                });
            },
            _stopSubContextMainLoop: function() {
                this._context && this._context.postMessage({
                    fromEngine: !0,
                    event: "mainLoop",
                    value: !1
                });
            },
            _updateSubContextFrameRate: function() {
                this._context && this._context.postMessage({
                    fromEngine: !0,
                    event: "frameRate",
                    value: this._fps
                });
            }
        });
        cc.SubContextView = e.exports = n, cc.WXSubContextView = n, cc.SwanSubContextView = n;
    }, {
        "./CCComponent": 101
    } ],
    121: [ function(t, e) {
        "use strict";
        t("./CCComponent"), t("./CCComponentEventHandler"), t("./missing-script");
        var i = t("./SubContextView");
        i || (i = cc.Class({
            name: "cc.SubContextView",
            extends: cc.Component
        }), cc.SubContextView = cc.WXSubContextView = cc.SwanSubContextView = i);
        var n = [ t("./CCSprite"), t("./CCWidget"), t("./CCCanvas"), t("./CCAudioSource"), t("./CCAnimation"), t("./CCButton"), t("./CCLabel"), t("./CCProgressBar"), t("./CCMask"), t("./CCScrollBar"), t("./CCScrollView"), t("./CCPageViewIndicator"), t("./CCPageView"), t("./CCSlider"), t("./CCLayout"), t("./editbox/CCEditBox"), t("./CCLabelOutline"), t("./CCLabelShadow"), t("./CCRichText"), t("./CCToggleContainer"), t("./CCToggleGroup"), t("./CCToggle"), t("./CCBlockInputEvents"), t("./CCMotionStreak"), t("./CCSafeArea"), i ];
        e.exports = n;
    }, {
        "./CCAnimation": 96,
        "./CCAudioSource": 97,
        "./CCBlockInputEvents": 98,
        "./CCButton": 99,
        "./CCCanvas": 100,
        "./CCComponent": 101,
        "./CCComponentEventHandler": 102,
        "./CCLabel": 103,
        "./CCLabelOutline": 104,
        "./CCLabelShadow": 105,
        "./CCLayout": 106,
        "./CCMask": 107,
        "./CCMotionStreak": 108,
        "./CCPageView": void 0,
        "./CCPageViewIndicator": void 0,
        "./CCProgressBar": 109,
        "./CCRichText": void 0,
        "./CCSafeArea": void 0,
        "./CCScrollBar": 111,
        "./CCScrollView": 112,
        "./CCSlider": 113,
        "./CCSprite": 114,
        "./CCToggle": 115,
        "./CCToggleContainer": 116,
        "./CCToggleGroup": 117,
        "./CCWidget": 119,
        "./SubContextView": 120,
        "./editbox/CCEditBox": void 0,
        "./missing-script": 122
    } ],
    122: [ function(t, e) {
        "use strict";
        var i = cc.js, n = cc.Class({
            name: "cc.MissingScript",
            extends: cc.Component,
            editor: {
                inspector: "packages://inspector/inspectors/comps/missing-script.js"
            },
            properties: {
                compiled: {
                    default: !1,
                    serializable: !1
                },
                _$erialized: {
                    default: null,
                    visible: !1,
                    editorOnly: !0
                }
            },
            ctor: !1,
            statics: {
                safeFindClass: function(t) {
                    return i._getClassById(t) || (cc.deserialize.reportMissingClass(t), n);
                }
            },
            onLoad: function() {
                cc.warnID(4600, this.node.name);
            }
        });
        cc._MissingScript = e.exports = n;
    }, {} ],
    123: [ function(t, e) {
        "use strict";
        var i = cc.js;
        t("../event/event");
        var n = function(t, e) {
            cc.Event.call(this, cc.Event.MOUSE, e), this._eventType = t, this._button = 0, this._x = 0, 
            this._y = 0, this._prevX = 0, this._prevY = 0, this._scrollX = 0, this._scrollY = 0;
        };
        i.extend(n, cc.Event);
        var r = n.prototype;
        r.setScrollData = function(t, e) {
            this._scrollX = t, this._scrollY = e;
        }, r.getScrollX = function() {
            return this._scrollX;
        }, r.getScrollY = function() {
            return this._scrollY;
        }, r.setLocation = function(t, e) {
            this._x = t, this._y = e;
        }, r.getLocation = function() {
            return cc.v2(this._x, this._y);
        }, r.getLocationInView = function() {
            return cc.v2(this._x, cc.view._designResolutionSize.height - this._y);
        }, r._setPrevCursor = function(t, e) {
            this._prevX = t, this._prevY = e;
        }, r.getPreviousLocation = function() {
            return cc.v2(this._prevX, this._prevY);
        }, r.getDelta = function() {
            return cc.v2(this._x - this._prevX, this._y - this._prevY);
        }, r.getDeltaX = function() {
            return this._x - this._prevX;
        }, r.getDeltaY = function() {
            return this._y - this._prevY;
        }, r.setButton = function(t) {
            this._button = t;
        }, r.getButton = function() {
            return this._button;
        }, r.getLocationX = function() {
            return this._x;
        }, r.getLocationY = function() {
            return this._y;
        }, n.NONE = 0, n.DOWN = 1, n.UP = 2, n.MOVE = 3, n.SCROLL = 4, n.BUTTON_LEFT = 0, 
        n.BUTTON_RIGHT = 2, n.BUTTON_MIDDLE = 1, n.BUTTON_4 = 3, n.BUTTON_5 = 4, n.BUTTON_6 = 5, 
        n.BUTTON_7 = 6, n.BUTTON_8 = 7;
        var s = function(t, e) {
            cc.Event.call(this, cc.Event.TOUCH, e), this._eventCode = 0, this._touches = t || [], 
            this.touch = null, this.currentTouch = null;
        };
        i.extend(s, cc.Event), (r = s.prototype).getEventCode = function() {
            return this._eventCode;
        }, r.getTouches = function() {
            return this._touches;
        }, r._setEventCode = function(t) {
            this._eventCode = t;
        }, r._setTouches = function(t) {
            this._touches = t;
        }, r.setLocation = function(t, e) {
            this.touch && this.touch.setTouchInfo(this.touch.getID(), t, e);
        }, r.getLocation = function() {
            return this.touch ? this.touch.getLocation() : cc.v2();
        }, r.getLocationInView = function() {
            return this.touch ? this.touch.getLocationInView() : cc.v2();
        }, r.getPreviousLocation = function() {
            return this.touch ? this.touch.getPreviousLocation() : cc.v2();
        }, r.getStartLocation = function() {
            return this.touch ? this.touch.getStartLocation() : cc.v2();
        }, r.getID = function() {
            return this.touch ? this.touch.getID() : null;
        }, r.getDelta = function() {
            return this.touch ? this.touch.getDelta() : cc.v2();
        }, r.getDeltaX = function() {
            return this.touch ? this.touch.getDelta().x : 0;
        }, r.getDeltaY = function() {
            return this.touch ? this.touch.getDelta().y : 0;
        }, r.getLocationX = function() {
            return this.touch ? this.touch.getLocationX() : 0;
        }, r.getLocationY = function() {
            return this.touch ? this.touch.getLocationY() : 0;
        }, s.MAX_TOUCHES = 5, s.BEGAN = 0, s.MOVED = 1, s.ENDED = 2, s.CANCELED = 3;
        var o = function(t, e) {
            cc.Event.call(this, cc.Event.ACCELERATION, e), this.acc = t;
        };
        i.extend(o, cc.Event);
        var a = function(t, e, i) {
            cc.Event.call(this, cc.Event.KEYBOARD, i), this.keyCode = t, this.isPressed = e;
        };
        i.extend(a, cc.Event), cc.Event.EventMouse = n, cc.Event.EventTouch = s, cc.Event.EventAcceleration = o, 
        cc.Event.EventKeyboard = a, e.exports = cc.Event;
    }, {
        "../event/event": 130
    } ],
    124: [ function(t, e) {
        "use strict";
        var i = t("../platform/js");
        cc.EventListener = function(t, e, i) {
            this._onEvent = i, this._type = t || 0, this._listenerID = e || "", this._registered = !1, 
            this._fixedPriority = 0, this._node = null, this._target = null, this._paused = !0, 
            this._isEnabled = !0;
        }, cc.EventListener.prototype = {
            constructor: cc.EventListener,
            _setPaused: function(t) {
                this._paused = t;
            },
            _isPaused: function() {
                return this._paused;
            },
            _setRegistered: function(t) {
                this._registered = t;
            },
            _isRegistered: function() {
                return this._registered;
            },
            _getType: function() {
                return this._type;
            },
            _getListenerID: function() {
                return this._listenerID;
            },
            _setFixedPriority: function(t) {
                this._fixedPriority = t;
            },
            _getFixedPriority: function() {
                return this._fixedPriority;
            },
            _setSceneGraphPriority: function(t) {
                this._target = t, this._node = t;
            },
            _getSceneGraphPriority: function() {
                return this._node;
            },
            checkAvailable: function() {
                return null !== this._onEvent;
            },
            clone: function() {
                return null;
            },
            setEnabled: function(t) {
                this._isEnabled = t;
            },
            isEnabled: function() {
                return this._isEnabled;
            },
            retain: function() {},
            release: function() {}
        }, cc.EventListener.UNKNOWN = 0, cc.EventListener.TOUCH_ONE_BY_ONE = 1, cc.EventListener.TOUCH_ALL_AT_ONCE = 2, 
        cc.EventListener.KEYBOARD = 3, cc.EventListener.MOUSE = 4, cc.EventListener.ACCELERATION = 6, 
        cc.EventListener.CUSTOM = 8;
        var n = cc.EventListener.ListenerID = {
            MOUSE: "__cc_mouse",
            TOUCH_ONE_BY_ONE: "__cc_touch_one_by_one",
            TOUCH_ALL_AT_ONCE: "__cc_touch_all_at_once",
            KEYBOARD: "__cc_keyboard",
            ACCELERATION: "__cc_acceleration"
        }, r = function(t, e) {
            this._onCustomEvent = e, cc.EventListener.call(this, cc.EventListener.CUSTOM, t, this._callback);
        };
        i.extend(r, cc.EventListener), i.mixin(r.prototype, {
            _onCustomEvent: null,
            _callback: function(t) {
                null !== this._onCustomEvent && this._onCustomEvent(t);
            },
            checkAvailable: function() {
                return cc.EventListener.prototype.checkAvailable.call(this) && null !== this._onCustomEvent;
            },
            clone: function() {
                return new r(this._listenerID, this._onCustomEvent);
            }
        });
        var s = function() {
            cc.EventListener.call(this, cc.EventListener.MOUSE, n.MOUSE, this._callback);
        };
        i.extend(s, cc.EventListener), i.mixin(s.prototype, {
            onMouseDown: null,
            onMouseUp: null,
            onMouseMove: null,
            onMouseScroll: null,
            _callback: function(t) {
                var e = cc.Event.EventMouse;
                switch (t._eventType) {
                  case e.DOWN:
                    this.onMouseDown && this.onMouseDown(t);
                    break;

                  case e.UP:
                    this.onMouseUp && this.onMouseUp(t);
                    break;

                  case e.MOVE:
                    this.onMouseMove && this.onMouseMove(t);
                    break;

                  case e.SCROLL:
                    this.onMouseScroll && this.onMouseScroll(t);
                }
            },
            clone: function() {
                var t = new s();
                return t.onMouseDown = this.onMouseDown, t.onMouseUp = this.onMouseUp, t.onMouseMove = this.onMouseMove, 
                t.onMouseScroll = this.onMouseScroll, t;
            },
            checkAvailable: function() {
                return !0;
            }
        });
        var o = function() {
            cc.EventListener.call(this, cc.EventListener.TOUCH_ONE_BY_ONE, n.TOUCH_ONE_BY_ONE, null), 
            this._claimedTouches = [];
        };
        i.extend(o, cc.EventListener), i.mixin(o.prototype, {
            constructor: o,
            _claimedTouches: null,
            swallowTouches: !1,
            onTouchBegan: null,
            onTouchMoved: null,
            onTouchEnded: null,
            onTouchCancelled: null,
            setSwallowTouches: function(t) {
                this.swallowTouches = t;
            },
            isSwallowTouches: function() {
                return this.swallowTouches;
            },
            clone: function() {
                var t = new o();
                return t.onTouchBegan = this.onTouchBegan, t.onTouchMoved = this.onTouchMoved, t.onTouchEnded = this.onTouchEnded, 
                t.onTouchCancelled = this.onTouchCancelled, t.swallowTouches = this.swallowTouches, 
                t;
            },
            checkAvailable: function() {
                return !!this.onTouchBegan || (cc.logID(1801), !1);
            }
        });
        var a = function() {
            cc.EventListener.call(this, cc.EventListener.TOUCH_ALL_AT_ONCE, n.TOUCH_ALL_AT_ONCE, null);
        };
        i.extend(a, cc.EventListener), i.mixin(a.prototype, {
            constructor: a,
            onTouchesBegan: null,
            onTouchesMoved: null,
            onTouchesEnded: null,
            onTouchesCancelled: null,
            clone: function() {
                var t = new a();
                return t.onTouchesBegan = this.onTouchesBegan, t.onTouchesMoved = this.onTouchesMoved, 
                t.onTouchesEnded = this.onTouchesEnded, t.onTouchesCancelled = this.onTouchesCancelled, 
                t;
            },
            checkAvailable: function() {
                return null !== this.onTouchesBegan || null !== this.onTouchesMoved || null !== this.onTouchesEnded || null !== this.onTouchesCancelled || (cc.logID(1802), 
                !1);
            }
        });
        var c = function(t) {
            this._onAccelerationEvent = t, cc.EventListener.call(this, cc.EventListener.ACCELERATION, n.ACCELERATION, this._callback);
        };
        i.extend(c, cc.EventListener), i.mixin(c.prototype, {
            constructor: c,
            _onAccelerationEvent: null,
            _callback: function(t) {
                this._onAccelerationEvent(t.acc, t);
            },
            checkAvailable: function() {
                return cc.assertID(this._onAccelerationEvent, 1803), !0;
            },
            clone: function() {
                return new c(this._onAccelerationEvent);
            }
        });
        var l = function() {
            cc.EventListener.call(this, cc.EventListener.KEYBOARD, n.KEYBOARD, this._callback);
        };
        i.extend(l, cc.EventListener), i.mixin(l.prototype, {
            constructor: l,
            onKeyPressed: null,
            onKeyReleased: null,
            _callback: function(t) {
                t.isPressed ? this.onKeyPressed && this.onKeyPressed(t.keyCode, t) : this.onKeyReleased && this.onKeyReleased(t.keyCode, t);
            },
            clone: function() {
                var t = new l();
                return t.onKeyPressed = this.onKeyPressed, t.onKeyReleased = this.onKeyReleased, 
                t;
            },
            checkAvailable: function() {
                return null !== this.onKeyPressed || null !== this.onKeyReleased || (cc.logID(1800), 
                !1);
            }
        }), cc.EventListener.create = function(t) {
            cc.assertID(t && t.event, 1900);
            var e = t.event;
            delete t.event;
            var i = null;
            for (var n in e === cc.EventListener.TOUCH_ONE_BY_ONE ? i = new o() : e === cc.EventListener.TOUCH_ALL_AT_ONCE ? i = new a() : e === cc.EventListener.MOUSE ? i = new s() : e === cc.EventListener.CUSTOM ? (i = new r(t.eventName, t.callback), 
            delete t.eventName, delete t.callback) : e === cc.EventListener.KEYBOARD ? i = new l() : e === cc.EventListener.ACCELERATION && (i = new c(t.callback), 
            delete t.callback), t) i[n] = t[n];
            return i;
        }, e.exports = cc.EventListener;
    }, {
        "../platform/js": 203
    } ],
    125: [ function(t, e) {
        "use strict";
        var i = t("../platform/js");
        t("./CCEventListener");
        var n = cc.EventListener.ListenerID, r = function() {
            this._fixedListeners = [], this._sceneGraphListeners = [], this.gt0Index = 0;
        };
        r.prototype = {
            constructor: r,
            size: function() {
                return this._fixedListeners.length + this._sceneGraphListeners.length;
            },
            empty: function() {
                return 0 === this._fixedListeners.length && 0 === this._sceneGraphListeners.length;
            },
            push: function(t) {
                0 === t._getFixedPriority() ? this._sceneGraphListeners.push(t) : this._fixedListeners.push(t);
            },
            clearSceneGraphListeners: function() {
                this._sceneGraphListeners.length = 0;
            },
            clearFixedListeners: function() {
                this._fixedListeners.length = 0;
            },
            clear: function() {
                this._sceneGraphListeners.length = 0, this._fixedListeners.length = 0;
            },
            getFixedPriorityListeners: function() {
                return this._fixedListeners;
            },
            getSceneGraphPriorityListeners: function() {
                return this._sceneGraphListeners;
            }
        };
        var s = function(t) {
            var e = cc.Event, i = t.type;
            return i === e.ACCELERATION ? n.ACCELERATION : i === e.KEYBOARD ? n.KEYBOARD : i.startsWith(e.MOUSE) ? n.MOUSE : (i.startsWith(e.TOUCH) && cc.logID(2e3), 
            "");
        }, o = {
            DIRTY_NONE: 0,
            DIRTY_FIXED_PRIORITY: 1,
            DIRTY_SCENE_GRAPH_PRIORITY: 2,
            DIRTY_ALL: 3,
            _listenersMap: {},
            _priorityDirtyFlagMap: {},
            _nodeListenersMap: {},
            _toAddedListeners: [],
            _toRemovedListeners: [],
            _dirtyListeners: {},
            _inDispatch: 0,
            _isEnabled: !1,
            _currentTouch: null,
            _currentTouchListener: null,
            _internalCustomListenerIDs: [],
            _setDirtyForNode: function(t) {
                var e = this._nodeListenersMap[t._id];
                if (void 0 !== e) for (var i = 0, n = e.length; i < n; i++) {
                    var r = e[i]._getListenerID();
                    null == this._dirtyListeners[r] && (this._dirtyListeners[r] = !0);
                }
                if (t.childrenCount > 0) for (var s = t._children, o = 0, a = s.length; o < a; o++) this._setDirtyForNode(s[o]);
            },
            pauseTarget: function(t, e) {
                if (t instanceof cc._BaseNode) {
                    var i, n, r = this._nodeListenersMap[t._id];
                    if (r) for (i = 0, n = r.length; i < n; i++) r[i]._setPaused(!0);
                    if (!0 === e) {
                        var s = t._children;
                        for (i = 0, n = s ? s.length : 0; i < n; i++) this.pauseTarget(s[i], !0);
                    }
                } else cc.warnID(3506);
            },
            resumeTarget: function(t, e) {
                if (t instanceof cc._BaseNode) {
                    var i, n, r = this._nodeListenersMap[t._id];
                    if (r) for (i = 0, n = r.length; i < n; i++) r[i]._setPaused(!1);
                    if (this._setDirtyForNode(t), !0 === e) {
                        var s = t._children;
                        for (i = 0, n = s ? s.length : 0; i < n; i++) this.resumeTarget(s[i], !0);
                    }
                } else cc.warnID(3506);
            },
            _addListener: function(t) {
                0 === this._inDispatch ? this._forceAddEventListener(t) : this._toAddedListeners.push(t);
            },
            _forceAddEventListener: function(t) {
                var e = t._getListenerID(), i = this._listenersMap[e];
                if (i || (i = new r(), this._listenersMap[e] = i), i.push(t), 0 === t._getFixedPriority()) {
                    this._setDirty(e, this.DIRTY_SCENE_GRAPH_PRIORITY);
                    var n = t._getSceneGraphPriority();
                    null === n && cc.logID(3507), this._associateNodeAndEventListener(n, t), n.activeInHierarchy && this.resumeTarget(n);
                } else this._setDirty(e, this.DIRTY_FIXED_PRIORITY);
            },
            _getListeners: function(t) {
                return this._listenersMap[t];
            },
            _updateDirtyFlagForSceneGraph: function() {
                var t = this._dirtyListeners;
                for (var e in t) this._setDirty(e, this.DIRTY_SCENE_GRAPH_PRIORITY);
                this._dirtyListeners = {};
            },
            _removeAllListenersInVector: function(t) {
                if (t) for (var e, i = t.length - 1; i >= 0; i--) (e = t[i])._setRegistered(!1), 
                null != e._getSceneGraphPriority() && (this._dissociateNodeAndEventListener(e._getSceneGraphPriority(), e), 
                e._setSceneGraphPriority(null)), 0 === this._inDispatch && cc.js.array.removeAt(t, i);
            },
            _removeListenersForListenerID: function(t) {
                var e, i = this._listenersMap[t];
                if (i) {
                    var n = i.getFixedPriorityListeners(), r = i.getSceneGraphPriorityListeners();
                    this._removeAllListenersInVector(r), this._removeAllListenersInVector(n), delete this._priorityDirtyFlagMap[t], 
                    this._inDispatch || (i.clear(), delete this._listenersMap[t]);
                }
                var s, o = this._toAddedListeners;
                for (e = o.length - 1; e >= 0; e--) (s = o[e]) && s._getListenerID() === t && cc.js.array.removeAt(o, e);
            },
            _sortEventListeners: function(t) {
                var e = this.DIRTY_NONE, i = this._priorityDirtyFlagMap;
                i[t] && (e = i[t]), e !== this.DIRTY_NONE && (i[t] = this.DIRTY_NONE, e & this.DIRTY_FIXED_PRIORITY && this._sortListenersOfFixedPriority(t), 
                e & this.DIRTY_SCENE_GRAPH_PRIORITY && cc.director.getScene() && this._sortListenersOfSceneGraphPriority(t));
            },
            _sortListenersOfSceneGraphPriority: function(t) {
                var e = this._getListeners(t);
                if (e) {
                    var i = e.getSceneGraphPriorityListeners();
                    i && 0 !== i.length && e.getSceneGraphPriorityListeners().sort(this._sortEventListenersOfSceneGraphPriorityDes);
                }
            },
            _sortEventListenersOfSceneGraphPriorityDes: function(t, e) {
                var i = t._getSceneGraphPriority(), n = e._getSceneGraphPriority();
                if (!(e && n && n._activeInHierarchy && null !== n._parent)) return -1;
                if (!t || !i || !i._activeInHierarchy || null === i._parent) return 1;
                for (var r = i, s = n, o = !1; r._parent._id !== s._parent._id; ) r = null === r._parent._parent ? (o = !0) && n : r._parent, 
                s = null === s._parent._parent ? (o = !0) && i : s._parent;
                if (r._id === s._id) {
                    if (r._id === n._id) return -1;
                    if (r._id === i._id) return 1;
                }
                return o ? r._localZOrder - s._localZOrder : s._localZOrder - r._localZOrder;
            },
            _sortListenersOfFixedPriority: function(t) {
                var e = this._listenersMap[t];
                if (e) {
                    var i = e.getFixedPriorityListeners();
                    if (i && 0 !== i.length) {
                        i.sort(this._sortListenersOfFixedPriorityAsc);
                        for (var n = 0, r = i.length; n < r && !(i[n]._getFixedPriority() >= 0); ) ++n;
                        e.gt0Index = n;
                    }
                }
            },
            _sortListenersOfFixedPriorityAsc: function(t, e) {
                return t._getFixedPriority() - e._getFixedPriority();
            },
            _onUpdateListeners: function(t) {
                var e, i, n, r = t.getFixedPriorityListeners(), s = t.getSceneGraphPriorityListeners(), o = this._toRemovedListeners;
                if (s) for (e = s.length - 1; e >= 0; e--) (i = s[e])._isRegistered() || (cc.js.array.removeAt(s, e), 
                -1 !== (n = o.indexOf(i)) && o.splice(n, 1));
                if (r) for (e = r.length - 1; e >= 0; e--) (i = r[e])._isRegistered() || (cc.js.array.removeAt(r, e), 
                -1 !== (n = o.indexOf(i)) && o.splice(n, 1));
                s && 0 === s.length && t.clearSceneGraphListeners(), r && 0 === r.length && t.clearFixedListeners();
            },
            frameUpdateListeners: function() {
                var t = this._listenersMap, e = this._priorityDirtyFlagMap;
                for (var i in t) t[i].empty() && (delete e[i], delete t[i]);
                var n = this._toAddedListeners;
                if (0 !== n.length) {
                    for (var r = 0, s = n.length; r < s; r++) this._forceAddEventListener(n[r]);
                    n.length = 0;
                }
                0 !== this._toRemovedListeners.length && this._cleanToRemovedListeners();
            },
            _updateTouchListeners: function() {
                var t = this._inDispatch;
                if (cc.assertID(t > 0, 3508), !(t > 1)) {
                    var e;
                    (e = this._listenersMap[n.TOUCH_ONE_BY_ONE]) && this._onUpdateListeners(e), (e = this._listenersMap[n.TOUCH_ALL_AT_ONCE]) && this._onUpdateListeners(e), 
                    cc.assertID(1 === t, 3509);
                    var i = this._toAddedListeners;
                    if (0 !== i.length) {
                        for (var r = 0, s = i.length; r < s; r++) this._forceAddEventListener(i[r]);
                        this._toAddedListeners.length = 0;
                    }
                    0 !== this._toRemovedListeners.length && this._cleanToRemovedListeners();
                }
            },
            _cleanToRemovedListeners: function() {
                for (var t = this._toRemovedListeners, e = 0; e < t.length; e++) {
                    var i = t[e], n = this._listenersMap[i._getListenerID()];
                    if (n) {
                        var r, s = n.getFixedPriorityListeners(), o = n.getSceneGraphPriorityListeners();
                        o && -1 !== (r = o.indexOf(i)) && o.splice(r, 1), s && -1 !== (r = s.indexOf(i)) && s.splice(r, 1);
                    }
                }
                t.length = 0;
            },
            _onTouchEventCallback: function(t, e) {
                if (!t._isRegistered()) return !1;
                var i = e.event, n = i.currentTouch;
                i.currentTarget = t._node;
                var r, s = !1, a = i.getEventCode(), c = cc.Event.EventTouch;
                if (a === c.BEGAN) {
                    if (!cc.macro.ENABLE_MULTI_TOUCH && o._currentTouch) {
                        var l = o._currentTouchListener._node;
                        if (l && l.activeInHierarchy) return !1;
                    }
                    t.onTouchBegan && (s = t.onTouchBegan(n, i)) && t._registered && (t._claimedTouches.push(n), 
                    o._currentTouchListener = t, o._currentTouch = n);
                } else if (t._claimedTouches.length > 0 && -1 !== (r = t._claimedTouches.indexOf(n))) {
                    if (s = !0, !cc.macro.ENABLE_MULTI_TOUCH && o._currentTouch && o._currentTouch !== n) return !1;
                    a === c.MOVED && t.onTouchMoved ? t.onTouchMoved(n, i) : a === c.ENDED ? (t.onTouchEnded && t.onTouchEnded(n, i), 
                    t._registered && t._claimedTouches.splice(r, 1), o._clearCurTouch()) : a === c.CANCELED && (t.onTouchCancelled && t.onTouchCancelled(n, i), 
                    t._registered && t._claimedTouches.splice(r, 1), o._clearCurTouch());
                }
                return i.isStopped() ? (o._updateTouchListeners(i), !0) : !(!s || !t.swallowTouches || (e.needsMutableSet && e.touches.splice(n, 1), 
                0));
            },
            _dispatchTouchEvent: function(t) {
                this._sortEventListeners(n.TOUCH_ONE_BY_ONE), this._sortEventListeners(n.TOUCH_ALL_AT_ONCE);
                var e = this._getListeners(n.TOUCH_ONE_BY_ONE), i = this._getListeners(n.TOUCH_ALL_AT_ONCE);
                if (null !== e || null !== i) {
                    var r = t.getTouches(), s = cc.js.array.copy(r), o = {
                        event: t,
                        needsMutableSet: e && i,
                        touches: s,
                        selTouch: null
                    };
                    if (e) for (var a = 0; a < r.length; a++) t.currentTouch = r[a], t._propagationStopped = t._propagationImmediateStopped = !1, 
                    this._dispatchEventToListeners(e, this._onTouchEventCallback, o);
                    i && s.length > 0 && (this._dispatchEventToListeners(i, this._onTouchesEventCallback, {
                        event: t,
                        touches: s
                    }), t.isStopped()) || this._updateTouchListeners(t);
                }
            },
            _onTouchesEventCallback: function(t, e) {
                if (!t._registered) return !1;
                var i = cc.Event.EventTouch, n = e.event, r = e.touches, s = n.getEventCode();
                return n.currentTarget = t._node, s === i.BEGAN && t.onTouchesBegan ? t.onTouchesBegan(r, n) : s === i.MOVED && t.onTouchesMoved ? t.onTouchesMoved(r, n) : s === i.ENDED && t.onTouchesEnded ? t.onTouchesEnded(r, n) : s === i.CANCELED && t.onTouchesCancelled && t.onTouchesCancelled(r, n), 
                !!n.isStopped() && (o._updateTouchListeners(n), !0);
            },
            _associateNodeAndEventListener: function(t, e) {
                var i = this._nodeListenersMap[t._id];
                i || (i = [], this._nodeListenersMap[t._id] = i), i.push(e);
            },
            _dissociateNodeAndEventListener: function(t, e) {
                var i = this._nodeListenersMap[t._id];
                i && (cc.js.array.remove(i, e), 0 === i.length && delete this._nodeListenersMap[t._id]);
            },
            _dispatchEventToListeners: function(t, e, i) {
                var n, r, s = !1, o = t.getFixedPriorityListeners(), a = t.getSceneGraphPriorityListeners(), c = 0;
                if (o && 0 !== o.length) for (;c < t.gt0Index; ++c) if ((r = o[c]).isEnabled() && !r._isPaused() && r._isRegistered() && e(r, i)) {
                    s = !0;
                    break;
                }
                if (a && !s) for (n = 0; n < a.length; n++) if ((r = a[n]).isEnabled() && !r._isPaused() && r._isRegistered() && e(r, i)) {
                    s = !0;
                    break;
                }
                if (o && !s) for (;c < o.length; ++c) if ((r = o[c]).isEnabled() && !r._isPaused() && r._isRegistered() && e(r, i)) {
                    s = !0;
                    break;
                }
            },
            _setDirty: function(t, e) {
                var i = this._priorityDirtyFlagMap;
                null == i[t] ? i[t] = e : i[t] = e | i[t];
            },
            _sortNumberAsc: function(t, e) {
                return t - e;
            },
            hasEventListener: function(t) {
                return !!this._getListeners(t);
            },
            addListener: function(t, e) {
                if (cc.assertID(t && e, 3503), cc.js.isNumber(e) || e instanceof cc._BaseNode) {
                    if (t instanceof cc.EventListener) {
                        if (t._isRegistered()) return void cc.logID(3505);
                    } else cc.assertID(!cc.js.isNumber(e), 3504), t = cc.EventListener.create(t);
                    if (t.checkAvailable()) {
                        if (cc.js.isNumber(e)) {
                            if (0 === e) return void cc.logID(3500);
                            t._setSceneGraphPriority(null), t._setFixedPriority(e), t._setRegistered(!0), t._setPaused(!1), 
                            this._addListener(t);
                        } else t._setSceneGraphPriority(e), t._setFixedPriority(0), t._setRegistered(!0), 
                        this._addListener(t);
                        return t;
                    }
                } else cc.warnID(3506);
            },
            addCustomListener: function(t, e) {
                var i = new cc.EventListener.create({
                    event: cc.EventListener.CUSTOM,
                    eventName: t,
                    callback: e
                });
                return this.addListener(i, 1), i;
            },
            removeListener: function(t) {
                if (null != t) {
                    var e, i = this._listenersMap;
                    for (var n in i) {
                        var r = i[n], s = r.getFixedPriorityListeners(), o = r.getSceneGraphPriorityListeners();
                        if ((e = this._removeListenerInVector(o, t)) ? this._setDirty(t._getListenerID(), this.DIRTY_SCENE_GRAPH_PRIORITY) : (e = this._removeListenerInVector(s, t)) && this._setDirty(t._getListenerID(), this.DIRTY_FIXED_PRIORITY), 
                        r.empty() && (delete this._priorityDirtyFlagMap[t._getListenerID()], delete i[n]), 
                        e) break;
                    }
                    if (!e) for (var a = this._toAddedListeners, c = a.length - 1; c >= 0; c--) {
                        var l = a[c];
                        if (l === t) {
                            cc.js.array.removeAt(a, c), l._setRegistered(!1);
                            break;
                        }
                    }
                    this._currentTouchListener === t && this._clearCurTouch();
                }
            },
            _clearCurTouch: function() {
                this._currentTouchListener = null, this._currentTouch = null;
            },
            _removeListenerInCallback: function(t, e) {
                if (null == t) return !1;
                for (var i = t.length - 1; i >= 0; i--) {
                    var n = t[i];
                    if (n._onCustomEvent === e || n._onEvent === e) return n._setRegistered(!1), null != n._getSceneGraphPriority() && (this._dissociateNodeAndEventListener(n._getSceneGraphPriority(), n), 
                    n._setSceneGraphPriority(null)), 0 === this._inDispatch ? cc.js.array.removeAt(t, i) : this._toRemovedListeners.push(n), 
                    !0;
                }
                return !1;
            },
            _removeListenerInVector: function(t, e) {
                if (null == t) return !1;
                for (var i = t.length - 1; i >= 0; i--) {
                    var n = t[i];
                    if (n === e) return n._setRegistered(!1), null != n._getSceneGraphPriority() && (this._dissociateNodeAndEventListener(n._getSceneGraphPriority(), n), 
                    n._setSceneGraphPriority(null)), 0 === this._inDispatch ? cc.js.array.removeAt(t, i) : this._toRemovedListeners.push(n), 
                    !0;
                }
                return !1;
            },
            removeListeners: function(t, e) {
                var i = this;
                if (cc.js.isNumber(t) || t instanceof cc._BaseNode) if (void 0 !== t._id) {
                    var r, s = i._nodeListenersMap[t._id];
                    if (s) {
                        var o = cc.js.array.copy(s);
                        for (r = 0; r < o.length; r++) i.removeListener(o[r]);
                        delete i._nodeListenersMap[t._id];
                    }
                    var a = i._toAddedListeners;
                    for (r = 0; r < a.length; ) {
                        var c = a[r];
                        c._getSceneGraphPriority() === t ? (c._setSceneGraphPriority(null), c._setRegistered(!1), 
                        a.splice(r, 1)) : ++r;
                    }
                    if (!0 === e) {
                        var l, u = t.children;
                        for (r = 0, l = u.length; r < l; r++) i.removeListeners(u[r], !0);
                    }
                } else t === cc.EventListener.TOUCH_ONE_BY_ONE ? i._removeListenersForListenerID(n.TOUCH_ONE_BY_ONE) : t === cc.EventListener.TOUCH_ALL_AT_ONCE ? i._removeListenersForListenerID(n.TOUCH_ALL_AT_ONCE) : t === cc.EventListener.MOUSE ? i._removeListenersForListenerID(n.MOUSE) : t === cc.EventListener.ACCELERATION ? i._removeListenersForListenerID(n.ACCELERATION) : t === cc.EventListener.KEYBOARD ? i._removeListenersForListenerID(n.KEYBOARD) : cc.logID(3501); else cc.warnID(3506);
            },
            removeCustomListeners: function(t) {
                this._removeListenersForListenerID(t);
            },
            removeAllListeners: function() {
                var t = this._listenersMap, e = this._internalCustomListenerIDs;
                for (var i in t) -1 === e.indexOf(i) && this._removeListenersForListenerID(i);
            },
            setPriority: function(t, e) {
                if (null != t) {
                    var i = this._listenersMap;
                    for (var n in i) {
                        var r = i[n].getFixedPriorityListeners();
                        if (r && -1 !== r.indexOf(t)) return null != t._getSceneGraphPriority() && cc.logID(3502), 
                        void (t._getFixedPriority() !== e && (t._setFixedPriority(e), this._setDirty(t._getListenerID(), this.DIRTY_FIXED_PRIORITY)));
                    }
                }
            },
            setEnabled: function(t) {
                this._isEnabled = t;
            },
            isEnabled: function() {
                return this._isEnabled;
            },
            dispatchEvent: function(t) {
                if (this._isEnabled) if (this._updateDirtyFlagForSceneGraph(), this._inDispatch++, 
                t && t.getType) {
                    if (t.getType().startsWith(cc.Event.TOUCH)) return this._dispatchTouchEvent(t), 
                    void this._inDispatch--;
                    var e = s(t);
                    this._sortEventListeners(e);
                    var i = this._listenersMap[e];
                    null != i && (this._dispatchEventToListeners(i, this._onListenerCallback, t), this._onUpdateListeners(i)), 
                    this._inDispatch--;
                } else cc.errorID(3511);
            },
            _onListenerCallback: function(t, e) {
                return e.currentTarget = t._target, t._onEvent(e), e.isStopped();
            },
            dispatchCustomEvent: function(t, e) {
                var i = new cc.Event.EventCustom(t);
                i.setUserData(e), this.dispatchEvent(i);
            }
        };
        i.get(cc, "eventManager", function() {
            return cc.errorID(1405, "cc.eventManager", "cc.EventTarget or cc.systemEvent"), 
            o;
        }), e.exports = cc.internal.eventManager = o;
    }, {
        "../platform/js": 203,
        "./CCEventListener": 124
    } ],
    126: [ function() {
        "use strict";
        cc.Touch = function(t, e, i) {
            this._lastModified = 0, this.setTouchInfo(i, t, e);
        }, cc.Touch.prototype = {
            constructor: cc.Touch,
            getLocation: function() {
                return cc.v2(this._point.x, this._point.y);
            },
            getLocationX: function() {
                return this._point.x;
            },
            getLocationY: function() {
                return this._point.y;
            },
            getPreviousLocation: function() {
                return cc.v2(this._prevPoint.x, this._prevPoint.y);
            },
            getStartLocation: function() {
                return cc.v2(this._startPoint.x, this._startPoint.y);
            },
            getDelta: function() {
                return this._point.sub(this._prevPoint);
            },
            getLocationInView: function() {
                return cc.v2(this._point.x, cc.view._designResolutionSize.height - this._point.y);
            },
            getPreviousLocationInView: function() {
                return cc.v2(this._prevPoint.x, cc.view._designResolutionSize.height - this._prevPoint.y);
            },
            getStartLocationInView: function() {
                return cc.v2(this._startPoint.x, cc.view._designResolutionSize.height - this._startPoint.y);
            },
            getID: function() {
                return this._id;
            },
            setTouchInfo: function(t, e, i) {
                this._prevPoint = this._point, this._point = cc.v2(e || 0, i || 0), this._id = t, 
                this._startPointCaptured || (this._startPoint = cc.v2(this._point), cc.view._convertPointWithScale(this._startPoint), 
                this._startPointCaptured = !0);
            },
            _setPoint: function(t, e) {
                void 0 === e ? (this._point.x = t.x, this._point.y = t.y) : (this._point.x = t, 
                this._point.y = e);
            },
            _setPrevPoint: function(t, e) {
                this._prevPoint = void 0 === e ? cc.v2(t.x, t.y) : cc.v2(t || 0, e || 0);
            }
        };
    }, {} ],
    127: [ function(t, e) {
        "use strict";
        t("./CCEvent"), t("./CCTouch"), t("./CCEventListener");
        var i = t("./CCEventManager");
        e.exports = i;
    }, {
        "./CCEvent": 123,
        "./CCEventListener": 124,
        "./CCEventManager": 125,
        "./CCTouch": 126
    } ],
    128: [ function(t, e) {
        "use strict";
        var i = cc.js, n = t("../platform/callbacks-invoker");
        function r() {
            n.call(this);
        }
        i.extend(r, n), r.prototype.emit = function(t, e) {
            var i = t.type, n = this._callbackTable[i];
            if (n) {
                var r = !n.isInvoking;
                n.isInvoking = !0;
                for (var s = n.callbackInfos, o = 0, a = s.length; o < a; ++o) {
                    var c = s[o];
                    if (c && c.callback && (c.callback.call(c.target, t, e), t._propagationImmediateStopped)) break;
                }
                r && (n.isInvoking = !1, n.containCanceled && n.purgeCanceled());
            }
        }, e.exports = r;
    }, {
        "../platform/callbacks-invoker": 195
    } ],
    129: [ function(t, e) {
        "use strict";
        var i = t("../platform/js"), n = t("../platform/callbacks-invoker"), r = i.array.fastRemove;
        function s() {
            n.call(this);
        }
        i.extend(s, n);
        var o = s.prototype;
        o.__on = o.on, o.on = function(t, e, i, n) {
            if (e) return this.hasEventListener(t, e, i) || (this.__on(t, e, i, n), i && i.__eventTargets && i.__eventTargets.push(this)), 
            e;
            cc.errorID(6800);
        }, o.__off = o.off, o.off = function(t, e, i) {
            if (e) this.__off(t, e, i), i && i.__eventTargets && r(i.__eventTargets, this); else {
                var n = this._callbackTable[t];
                if (!n) return;
                for (var s = n.callbackInfos, o = 0; o < s.length; ++o) {
                    var a = s[o] && s[o].target;
                    a && a.__eventTargets && r(a.__eventTargets, this);
                }
                this.removeAll(t);
            }
        }, o.targetOff = function(t) {
            this.removeAll(t), t && t.__eventTargets && r(t.__eventTargets, this);
        }, o.once = function(t, e, i) {
            this.on(t, e, i, !0);
        }, o.dispatchEvent = function(t) {
            this.emit(t.type, t);
        }, o.clear = function() {
            for (var t in this._callbackTable) for (var e = this._callbackTable[t].callbackInfos, i = e.length - 1; i >= 0; i--) {
                var n = e[i];
                n && this.off(t, n.callback, n.target);
            }
        }, cc.EventTarget = e.exports = s;
    }, {
        "../platform/callbacks-invoker": 195,
        "../platform/js": 203
    } ],
    130: [ function(t, e) {
        "use strict";
        var i = t("../platform/js");
        cc.Event = function(t, e) {
            this.type = t, this.bubbles = !!e, this.target = null, this.currentTarget = null, 
            this.eventPhase = 0, this._propagationStopped = !1, this._propagationImmediateStopped = !1;
        }, cc.Event.prototype = {
            constructor: cc.Event,
            unuse: function() {
                this.type = cc.Event.NO_TYPE, this.target = null, this.currentTarget = null, this.eventPhase = cc.Event.NONE, 
                this._propagationStopped = !1, this._propagationImmediateStopped = !1;
            },
            reuse: function(t, e) {
                this.type = t, this.bubbles = e || !1;
            },
            stopPropagation: function() {
                this._propagationStopped = !0;
            },
            stopPropagationImmediate: function() {
                this._propagationImmediateStopped = !0;
            },
            isStopped: function() {
                return this._propagationStopped || this._propagationImmediateStopped;
            },
            getCurrentTarget: function() {
                return this.currentTarget;
            },
            getType: function() {
                return this.type;
            }
        }, cc.Event.NO_TYPE = "no_type", cc.Event.TOUCH = "touch", cc.Event.MOUSE = "mouse", 
        cc.Event.KEYBOARD = "keyboard", cc.Event.ACCELERATION = "acceleration", cc.Event.NONE = 0, 
        cc.Event.CAPTURING_PHASE = 1, cc.Event.AT_TARGET = 2, cc.Event.BUBBLING_PHASE = 3;
        var n = function(t, e) {
            cc.Event.call(this, t, e), this.detail = null;
        };
        i.extend(n, cc.Event), n.prototype.reset = n, n.prototype.setUserData = function(t) {
            this.detail = t;
        }, n.prototype.getUserData = function() {
            return this.detail;
        }, n.prototype.getEventName = cc.Event.prototype.getType;
        var r = new i.Pool(10);
        n.put = function(t) {
            r.put(t);
        }, n.get = function(t, e) {
            var i = r._get();
            return i ? i.reset(t, e) : i = new n(t, e), i;
        }, cc.Event.EventCustom = n, e.exports = cc.Event;
    }, {
        "../platform/js": 203
    } ],
    131: [ function(t) {
        "use strict";
        t("./event"), t("./event-listeners"), t("./event-target"), t("./system-event");
    }, {
        "./event": 130,
        "./event-listeners": 128,
        "./event-target": 129,
        "./system-event": 132
    } ],
    132: [ function(t, e) {
        "use strict";
        var i = t("../event/event-target"), n = t("../event-manager"), r = t("../platform/CCInputManager"), s = cc.Enum({
            KEY_DOWN: "keydown",
            KEY_UP: "keyup",
            DEVICEMOTION: "devicemotion"
        }), o = null, a = null, c = cc.Class({
            name: "SystemEvent",
            extends: i,
            statics: {
                EventType: s
            },
            setAccelerometerEnabled: function(t) {
                t && window.DeviceMotionEvent && "function" == typeof DeviceMotionEvent.requestPermission ? DeviceMotionEvent.requestPermission().then(function(t) {
                    console.log("Device Motion Event request permission: " + t), r.setAccelerometerEnabled("granted" === t);
                }) : r.setAccelerometerEnabled(t);
            },
            setAccelerometerInterval: function(t) {
                r.setAccelerometerInterval(t);
            },
            on: function(t, e, i, r) {
                this._super(t, e, i, r), t !== s.KEY_DOWN && t !== s.KEY_UP || (o || (o = cc.EventListener.create({
                    event: cc.EventListener.KEYBOARD,
                    onKeyPressed: function(t, e) {
                        e.type = s.KEY_DOWN, cc.systemEvent.dispatchEvent(e);
                    },
                    onKeyReleased: function(t, e) {
                        e.type = s.KEY_UP, cc.systemEvent.dispatchEvent(e);
                    }
                })), n.hasEventListener(cc.EventListener.ListenerID.KEYBOARD) || n.addListener(o, 1)), 
                t === s.DEVICEMOTION && (a || (a = cc.EventListener.create({
                    event: cc.EventListener.ACCELERATION,
                    callback: function(t, e) {
                        e.type = s.DEVICEMOTION, cc.systemEvent.dispatchEvent(e);
                    }
                })), n.hasEventListener(cc.EventListener.ListenerID.ACCELERATION) || n.addListener(a, 1));
            },
            off: function(t, e, i) {
                if (this._super(t, e, i), o && (t === s.KEY_DOWN || t === s.KEY_UP)) {
                    var r = this.hasEventListener(s.KEY_DOWN), c = this.hasEventListener(s.KEY_UP);
                    r || c || n.removeListener(o);
                }
                a && t === s.DEVICEMOTION && n.removeListener(a);
            }
        });
        cc.SystemEvent = e.exports = c, cc.systemEvent = new cc.SystemEvent();
    }, {
        "../event-manager": 127,
        "../event/event-target": 129,
        "../platform/CCInputManager": 186
    } ],
    133: [ function(t, e, i) {
        "use strict";
        i.__esModule = !0, i.default = void 0;
        var n = o(t("../value-types/vec3")), r = o(t("../value-types/mat3")), s = o(t("./enums"));
        function o(t) {
            return t && t.__esModule ? t : {
                default: t
            };
        }
        var a = new n.default(), c = new n.default(), l = new r.default(), u = function(t, e, i) {
            var r = l.m, s = i.m;
            r[0] = Math.abs(s[0]), r[1] = Math.abs(s[1]), r[2] = Math.abs(s[2]), r[3] = Math.abs(s[4]), 
            r[4] = Math.abs(s[5]), r[5] = Math.abs(s[6]), r[6] = Math.abs(s[8]), r[7] = Math.abs(s[9]), 
            r[8] = Math.abs(s[10]), n.default.transformMat3(t, e, l);
        }, h = function() {
            function t(t, e, i, r, o, a) {
                this.center = void 0, this.halfExtents = void 0, this._type = void 0, this._type = s.default.SHAPE_AABB, 
                this.center = new n.default(t, e, i), this.halfExtents = new n.default(r, o, a);
            }
            t.create = function(e, i, n, r, s, o) {
                return new t(e, i, n, r, s, o);
            }, t.clone = function(e) {
                return new t(e.center.x, e.center.y, e.center.z, e.halfExtents.x, e.halfExtents.y, e.halfExtents.z);
            }, t.copy = function(t, e) {
                return n.default.copy(t.center, e.center), n.default.copy(t.halfExtents, e.halfExtents), 
                t;
            }, t.fromPoints = function(t, e, i) {
                return n.default.scale(t.center, n.default.add(a, e, i), .5), n.default.scale(t.halfExtents, n.default.sub(c, i, e), .5), 
                t;
            }, t.set = function(t, e, i, r, s, o, a) {
                return n.default.set(t.center, e, i, r), n.default.set(t.halfExtents, s, o, a), 
                t;
            };
            var e = t.prototype;
            return e.getBoundary = function(t, e) {
                n.default.sub(t, this.center, this.halfExtents), n.default.add(e, this.center, this.halfExtents);
            }, e.transform = function(t, e, i, r, s) {
                s || (s = this), n.default.transformMat4(s.center, this.center, t), u(s.halfExtents, this.halfExtents, t);
            }, t;
        }();
        i.default = h, e.exports = i.default;
    }, {
        "../value-types/mat3": 272,
        "../value-types/vec3": 281,
        "./enums": 135
    } ],
    134: [ function(t, e, i) {
        "use strict";
        i.__esModule = !0, i.point_plane = _, i.pt_point_plane = function(t, e, i) {
            var r = _(e, i);
            return n.Vec3.subtract(t, e, n.Vec3.multiplyScalar(t, i.n, r));
        }, i.pt_point_aabb = function(t, e, i) {
            return n.Vec3.copy(t, e), n.Vec3.subtract(c, i.center, i.halfExtents), n.Vec3.add(l, i.center, i.halfExtents), 
            t.x = t.x < c.x ? c.x : t.x, t.y = t.y < c.x ? c.y : t.y, t.z = t.z < c.x ? c.z : t.z, 
            t.x = t.x > l.x ? l.x : t.x, t.y = t.y > l.x ? l.y : t.y, t.z = t.z > l.x ? l.z : t.z, 
            t;
        }, i.pt_point_obb = function(t, e, i) {
            var c = i.orientation.m;
            n.Vec3.set(r, c[0], c[1], c[2]), n.Vec3.set(s, c[3], c[4], c[5]), n.Vec3.set(o, c[6], c[7], c[8]), 
            u[0] = r, u[1] = s, u[2] = o, h[0] = i.halfExtents.x, h[1] = i.halfExtents.y, h[2] = i.halfExtents.z, 
            n.Vec3.subtract(a, e, i.center), n.Vec3.set(t, i.center.x, i.center.y, i.center.z);
            for (var l = 0; l < 3; l++) {
                var _ = n.Vec3.dot(a, u[l]);
                _ > h[l] && (_ = h[l]), _ < -h[l] && (_ = -h[l]), t.x += _ * u[l].x, t.y += _ * u[l].y, 
                t.z += _ * u[l].z;
            }
            return t;
        };
        var n = t("../value-types"), r = new n.Vec3(), s = new n.Vec3(), o = new n.Vec3(), a = new n.Vec3(), c = new n.Vec3(), l = new n.Vec3(), u = new Array(3), h = new Array(3);
        function _(t, e) {
            return n.Vec3.dot(e.n, t) - e.d;
        }
    }, {
        "../value-types": 271
    } ],
    135: [ function(t, e, i) {
        "use strict";
        i.__esModule = !0, i.default = void 0, i.default = {
            SHAPE_RAY: 1,
            SHAPE_LINE: 2,
            SHAPE_SPHERE: 4,
            SHAPE_AABB: 8,
            SHAPE_OBB: 16,
            SHAPE_PLANE: 32,
            SHAPE_TRIANGLE: 64,
            SHAPE_FRUSTUM: 128,
            SHAPE_FRUSTUM_ACCURATE: 256
        }, e.exports = i.default;
    }, {} ],
    136: [ function(t, e, i) {
        "use strict";
        i.__esModule = !0, i.default = void 0;
        var n = t("../value-types"), r = o(t("./enums")), s = o(t("./plane"));
        function o(t) {
            return t && t.__esModule ? t : {
                default: t
            };
        }
        function a(t, e) {
            for (var i = 0; i < e.length; i++) {
                var n = e[i];
                n.enumerable = n.enumerable || !1, n.configurable = !0, "value" in n && (n.writable = !0), 
                Object.defineProperty(t, n.key, n);
            }
        }
        var c = new Array(8);
        c[0] = new n.Vec3(1, 1, 1), c[1] = new n.Vec3(-1, 1, 1), c[2] = new n.Vec3(-1, -1, 1), 
        c[3] = new n.Vec3(1, -1, 1), c[4] = new n.Vec3(1, 1, -1), c[5] = new n.Vec3(-1, 1, -1), 
        c[6] = new n.Vec3(-1, -1, -1), c[7] = new n.Vec3(1, -1, -1);
        var l, u = function() {
            var t, e;
            function i() {
                this.planes = void 0, this.vertices = void 0, this._type = void 0, this._type = r.default.SHAPE_FRUSTUM, 
                this.planes = new Array(6);
                for (var t = 0; t < 6; ++t) this.planes[t] = s.default.create(0, 0, 0, 0);
                this.vertices = new Array(8);
                for (var e = 0; e < 8; ++e) this.vertices[e] = new n.Vec3();
            }
            i.create = function() {
                return new i();
            }, i.clone = function(t) {
                return i.copy(new i(), t);
            }, i.copy = function(t, e) {
                t._type = e._type;
                for (var i = 0; i < 6; ++i) s.default.copy(t.planes[i], e.planes[i]);
                for (var r = 0; r < 8; ++r) n.Vec3.copy(t.vertices[r], e.vertices[r]);
                return t;
            }, t = i, (e = [ {
                key: "accurate",
                set: function(t) {
                    this._type = t ? r.default.SHAPE_FRUSTUM_ACCURATE : r.default.SHAPE_FRUSTUM;
                }
            } ]) && a(t.prototype, e);
            var o = i.prototype;
            return o.update = function(t, e) {
                var i = t.m;
                if (n.Vec3.set(this.planes[0].n, i[3] + i[0], i[7] + i[4], i[11] + i[8]), this.planes[0].d = -(i[15] + i[12]), 
                n.Vec3.set(this.planes[1].n, i[3] - i[0], i[7] - i[4], i[11] - i[8]), this.planes[1].d = -(i[15] - i[12]), 
                n.Vec3.set(this.planes[2].n, i[3] + i[1], i[7] + i[5], i[11] + i[9]), this.planes[2].d = -(i[15] + i[13]), 
                n.Vec3.set(this.planes[3].n, i[3] - i[1], i[7] - i[5], i[11] - i[9]), this.planes[3].d = -(i[15] - i[13]), 
                n.Vec3.set(this.planes[4].n, i[3] + i[2], i[7] + i[6], i[11] + i[10]), this.planes[4].d = -(i[15] + i[14]), 
                n.Vec3.set(this.planes[5].n, i[3] - i[2], i[7] - i[6], i[11] - i[10]), this.planes[5].d = -(i[15] - i[14]), 
                this._type === r.default.SHAPE_FRUSTUM_ACCURATE) {
                    for (var s = 0; s < 6; s++) {
                        var o = this.planes[s], a = 1 / o.n.length();
                        n.Vec3.multiplyScalar(o.n, o.n, a), o.d *= a;
                    }
                    for (var l = 0; l < 8; l++) n.Vec3.transformMat4(this.vertices[l], c[l], e);
                }
            }, o.transform = function(t) {
                if (this._type === r.default.SHAPE_FRUSTUM_ACCURATE) {
                    for (var e = 0; e < 8; e++) n.Vec3.transformMat4(this.vertices[e], this.vertices[e], t);
                    s.default.fromPoints(this.planes[0], this.vertices[1], this.vertices[5], this.vertices[6]), 
                    s.default.fromPoints(this.planes[1], this.vertices[3], this.vertices[7], this.vertices[4]), 
                    s.default.fromPoints(this.planes[2], this.vertices[6], this.vertices[7], this.vertices[3]), 
                    s.default.fromPoints(this.planes[3], this.vertices[0], this.vertices[4], this.vertices[5]), 
                    s.default.fromPoints(this.planes[4], this.vertices[2], this.vertices[3], this.vertices[0]), 
                    s.default.fromPoints(this.planes[0], this.vertices[7], this.vertices[6], this.vertices[5]);
                }
            }, i;
        }();
        i.default = u, u.createOrtho = (l = new n.Vec3(), function(t, e, i, r, o, a) {
            var c = e / 2, u = i / 2;
            n.Vec3.set(l, c, u, r), n.Vec3.transformMat4(t.vertices[0], l, a), n.Vec3.set(l, -c, u, r), 
            n.Vec3.transformMat4(t.vertices[1], l, a), n.Vec3.set(l, -c, -u, r), n.Vec3.transformMat4(t.vertices[2], l, a), 
            n.Vec3.set(l, c, -u, r), n.Vec3.transformMat4(t.vertices[3], l, a), n.Vec3.set(l, c, u, o), 
            n.Vec3.transformMat4(t.vertices[4], l, a), n.Vec3.set(l, -c, u, o), n.Vec3.transformMat4(t.vertices[5], l, a), 
            n.Vec3.set(l, -c, -u, o), n.Vec3.transformMat4(t.vertices[6], l, a), n.Vec3.set(l, c, -u, o), 
            n.Vec3.transformMat4(t.vertices[7], l, a), s.default.fromPoints(t.planes[0], t.vertices[1], t.vertices[6], t.vertices[5]), 
            s.default.fromPoints(t.planes[1], t.vertices[3], t.vertices[4], t.vertices[7]), 
            s.default.fromPoints(t.planes[2], t.vertices[6], t.vertices[3], t.vertices[7]), 
            s.default.fromPoints(t.planes[3], t.vertices[0], t.vertices[5], t.vertices[4]), 
            s.default.fromPoints(t.planes[4], t.vertices[2], t.vertices[0], t.vertices[3]), 
            s.default.fromPoints(t.planes[0], t.vertices[7], t.vertices[5], t.vertices[6]);
        }), e.exports = i.default;
    }, {
        "../value-types": 271,
        "./enums": 135,
        "./plane": 141
    } ],
    137: [ function(t, e, i) {
        "use strict";
        i.__esModule = !0;
        var n = {
            enums: !0,
            Triangle: !0,
            Aabb: !0,
            Ray: !0,
            intersect: !0,
            Sphere: !0,
            Obb: !0,
            Frustum: !0,
            Line: !0,
            Plane: !0
        };
        i.Plane = i.Line = i.Frustum = i.Obb = i.Sphere = i.intersect = i.Ray = i.Aabb = i.Triangle = i.enums = void 0;
        var r = p(t("./enums"));
        i.enums = r.default;
        var s = p(t("./triangle"));
        i.Triangle = s.default;
        var o = p(t("./aabb"));
        i.Aabb = o.default;
        var a = p(t("./ray"));
        i.Ray = a.default;
        var c = p(t("./intersect"));
        i.intersect = c.default;
        var l = p(t("./sphere"));
        i.Sphere = l.default;
        var u = p(t("./obb"));
        i.Obb = u.default;
        var h = p(t("./frustum"));
        i.Frustum = h.default;
        var _ = p(t("./line"));
        i.Line = _.default;
        var f = p(t("./plane"));
        i.Plane = f.default;
        var d = t("./distance");
        function p(t) {
            return t && t.__esModule ? t : {
                default: t
            };
        }
        Object.keys(d).forEach(function(t) {
            "default" !== t && "__esModule" !== t && (Object.prototype.hasOwnProperty.call(n, t) || (i[t] = d[t]));
        }), cc.geomUtils = e.exports;
    }, {
        "./aabb": 133,
        "./distance": 134,
        "./enums": 135,
        "./frustum": 136,
        "./intersect": 138,
        "./line": 139,
        "./obb": 140,
        "./plane": 141,
        "./ray": 142,
        "./sphere": 143,
        "./triangle": 144
    } ],
    138: [ function(t, e, i) {
        "use strict";
        i.__esModule = !0, i.default = void 0;
        var n = _(t("../../renderer/gfx")), r = _(t("../../renderer/memop/recycle-pool")), s = t("../value-types"), o = _(t("./aabb")), a = function(t) {
            if (t && t.__esModule) return t;
            if (null === t || "object" != typeof t && "function" != typeof t) return {
                default: t
            };
            var e = h();
            if (e && e.has(t)) return e.get(t);
            var i = {}, n = Object.defineProperty && Object.getOwnPropertyDescriptor;
            for (var r in t) if (Object.prototype.hasOwnProperty.call(t, r)) {
                var s = n ? Object.getOwnPropertyDescriptor(t, r) : null;
                s && (s.get || s.set) ? Object.defineProperty(i, r, s) : i[r] = t[r];
            }
            return i.default = t, e && e.set(t, i), i;
        }(t("./distance")), c = _(t("./enums")), l = _(t("./ray")), u = _(t("./triangle"));
        function h() {
            if ("function" != typeof WeakMap) return null;
            var t = new WeakMap();
            return h = function() {
                return t;
            }, t;
        }
        function _(t) {
            return t && t.__esModule ? t : {
                default: t
            };
        }
        var f, d, p, m, v, y, g, x, A, C, b, S, T, w, E, B = function() {
            var t = u.default.create(), e = 1 / 0;
            function i(t, e, i, n) {
                s.Vec3.set(t, e[i * n], e[i * n + 1], e[i * n + 2]);
            }
            return function(r, s) {
                e = 1 / 0;
                for (var o = s._subMeshes, a = 0; a < o.length; a++) if (o[a]._primitiveType === n.default.PT_TRIANGLES) for (var c = s._subDatas[a] || s._subDatas[0], l = s._getAttrMeshData(a, n.default.ATTR_POSITION), u = c.getIData(Uint16Array), h = c.vfm.element(n.default.ATTR_POSITION).num, _ = 0; _ < u.length; _ += 3) {
                    i(t.a, l, u[_], h), i(t.b, l, u[_ + 1], h), i(t.c, l, u[_ + 2], h);
                    var f = I(r, t);
                    f > 0 && f < e && (e = f);
                }
                return e;
            };
        }(), M = function() {
            function t(e, i) {
                for (var n = e.children, r = n.length - 1; r >= 0; r--) t(n[r], i);
                i(e);
            }
            function e(t, e) {
                return t.distance - e.distance;
            }
            function i(t, e, i) {
                var n = i.m, r = e.x, s = e.y, o = e.z, a = n[3] * r + n[7] * s + n[11] * o;
                return a = a ? 1 / a : 1, t.x = (n[0] * r + n[4] * s + n[8] * o) * a, t.y = (n[1] * r + n[5] * s + n[9] * o) * a, 
                t.z = (n[2] * r + n[6] * s + n[10] * o) * a, t;
            }
            var n = new r.default(function() {
                return {
                    distance: 0,
                    node: null
                };
            }, 1), a = [], c = o.default.create(), u = new s.Vec3(), h = new s.Vec3(), _ = new l.default(), f = cc.mat4(), d = cc.mat4(), p = new s.Vec3();
            function m(t) {
                return t > 0 && t < 1 / 0;
            }
            return function(r, l, v, y) {
                return n.reset(), a.length = 0, t(r = r || cc.director.getScene(), function(t) {
                    if (!y || y(t)) {
                        s.Mat4.invert(d, t.getWorldMatrix(f)), s.Vec3.transformMat4(_.o, l.o, d), s.Vec3.normalize(_.d, i(_.d, l.d, d));
                        var e = 1 / 0, r = t._renderComponent;
                        if (r instanceof cc.MeshRenderer ? e = F(_, r._boundingBox) : t.width && t.height && (s.Vec3.set(u, -t.width * t.anchorX, -t.height * t.anchorY, t.z), 
                        s.Vec3.set(h, t.width * (1 - t.anchorX), t.height * (1 - t.anchorY), t.z), o.default.fromPoints(c, u, h), 
                        e = F(_, c)), m(e) && (v && (e = v(_, t, e)), m(e))) {
                            s.Vec3.scale(p, _.d, e), i(p, p, f);
                            var g = n.add();
                            g.node = t, g.distance = s.Vec3.mag(p), a.push(g);
                        }
                    }
                }), a.sort(e), a;
            };
        }(), R = (f = new s.Vec3(0, 0, 0), function(t, e) {
            var i = s.Vec3.dot(t.d, e.n);
            if (Math.abs(i) < Number.EPSILON) return 0;
            s.Vec3.multiplyScalar(f, e.n, e.d);
            var n = s.Vec3.dot(s.Vec3.subtract(f, f, t.o), e.n) / i;
            return n < 0 ? 0 : n;
        }), P = (d = new s.Vec3(0, 0, 0), function(t, e) {
            s.Vec3.subtract(d, t.e, t.s);
            var i = (e.d - s.Vec3.dot(t.s, e.n)) / s.Vec3.dot(d, e.n);
            return i < 0 || i > 1 ? 0 : i;
        }), I = function() {
            var t = new s.Vec3(0, 0, 0), e = new s.Vec3(0, 0, 0), i = new s.Vec3(0, 0, 0), n = new s.Vec3(0, 0, 0), r = new s.Vec3(0, 0, 0);
            return function(o, a, c) {
                s.Vec3.subtract(t, a.b, a.a), s.Vec3.subtract(e, a.c, a.a), s.Vec3.cross(i, o.d, e);
                var l = s.Vec3.dot(t, i);
                if (l < Number.EPSILON && (!c || l > -Number.EPSILON)) return 0;
                var u = 1 / l;
                s.Vec3.subtract(n, o.o, a.a);
                var h = s.Vec3.dot(n, i) * u;
                if (h < 0 || h > 1) return 0;
                s.Vec3.cross(r, n, t);
                var _ = s.Vec3.dot(o.d, r) * u;
                if (_ < 0 || h + _ > 1) return 0;
                var f = s.Vec3.dot(e, r) * u;
                return f < 0 ? 0 : f;
            };
        }(), D = I, V = function() {
            var t = new s.Vec3(0, 0, 0), e = new s.Vec3(0, 0, 0), i = new s.Vec3(0, 0, 0), n = new s.Vec3(0, 0, 0), r = new s.Vec3(0, 0, 0), o = new s.Vec3(0, 0, 0);
            return function(a, c, l) {
                s.Vec3.subtract(t, c.b, c.a), s.Vec3.subtract(e, c.c, c.a), s.Vec3.subtract(i, a.s, a.e), 
                s.Vec3.cross(r, t, e);
                var u = s.Vec3.dot(i, r);
                if (u <= 0) return 0;
                s.Vec3.subtract(n, a.s, c.a);
                var h = s.Vec3.dot(n, r);
                if (h < 0 || h > u) return 0;
                s.Vec3.cross(o, i, n);
                var _ = s.Vec3.dot(e, o);
                if (_ < 0 || _ > u) return 0;
                var f = -s.Vec3.dot(t, o);
                if (f < 0 || _ + f > u) return 0;
                if (l) {
                    var d = 1 / u, p = 1 - (_ *= d) - (f *= d);
                    s.Vec3.set(l, c.a.x * p + c.b.x * _ + c.c.x * f, c.a.y * p + c.b.y * _ + c.c.y * f, c.a.z * p + c.b.z * _ + c.c.z * f);
                }
                return 1;
            };
        }(), L = (p = new s.Vec3(0, 0, 0), m = new s.Vec3(0, 0, 0), v = new s.Vec3(0, 0, 0), 
        y = new s.Vec3(0, 0, 0), g = new s.Vec3(0, 0, 0), x = new s.Vec3(0, 0, 0), A = new s.Vec3(0, 0, 0), 
        function(t, e, i, n, r, o, a) {
            s.Vec3.subtract(p, e, t), s.Vec3.subtract(m, i, t), s.Vec3.subtract(v, n, t), s.Vec3.subtract(y, r, t), 
            s.Vec3.cross(x, y, p);
            var c = s.Vec3.dot(m, x);
            if (c >= 0) {
                var l = -s.Vec3.dot(v, x);
                if (l < 0) return 0;
                var u = s.Vec3.dot(s.Vec3.cross(A, p, v), m);
                if (u < 0) return 0;
                if (a) {
                    var h = 1 / (l + c + u);
                    l *= h, c *= h, u *= h, s.Vec3.set(a, i.x * l + n.x * c + r.x * u, i.y * l + n.y * c + r.y * u, i.z * l + n.z * c + r.z * u);
                }
            } else {
                s.Vec3.subtract(g, o, t);
                var _ = s.Vec3.dot(g, x);
                if (_ < 0) return 0;
                var f = s.Vec3.dot(s.Vec3.cross(A, p, m), g);
                if (f < 0) return 0;
                if (a) {
                    var d = 1 / (_ + (c = -c) + f);
                    _ *= d, c *= d, f *= d, s.Vec3.set(a, i.x * _ + o.x * c + r.x * f, i.y * _ + o.y * c + r.y * f, i.z * _ + o.z * c + r.z * f);
                }
            }
            return 1;
        }), O = function() {
            var t = new s.Vec3(0, 0, 0);
            return function(e, i) {
                var n = i.radius, r = i.center, o = e.o, a = e.d, c = n * n;
                s.Vec3.subtract(t, r, o);
                var l = t.lengthSqr(), u = s.Vec3.dot(t, a), h = c - (l - u * u);
                if (h < 0) return 0;
                var _ = Math.sqrt(h), f = l < c ? u + _ : u - _;
                return f < 0 ? 0 : f;
            };
        }(), F = (C = new s.Vec3(), b = new s.Vec3(), function(t, e) {
            var i = t.o, n = t.d, r = 1 / n.x, o = 1 / n.y, a = 1 / n.z;
            s.Vec3.subtract(C, e.center, e.halfExtents), s.Vec3.add(b, e.center, e.halfExtents);
            var c = (C.x - i.x) * r, l = (b.x - i.x) * r, u = (C.y - i.y) * o, h = (b.y - i.y) * o, _ = (C.z - i.z) * a, f = (b.z - i.z) * a, d = Math.max(Math.max(Math.min(c, l), Math.min(u, h)), Math.min(_, f)), p = Math.min(Math.min(Math.max(c, l), Math.max(u, h)), Math.max(_, f));
            return p < 0 || d > p ? 0 : d;
        }), N = F, G = function() {
            var t = new s.Vec3(), e = new s.Vec3(), i = new s.Vec3(), n = new s.Vec3(), r = new s.Vec3(), o = new s.Vec3(), a = new s.Vec3(), c = new Array(3), l = new Array(3), u = new Array(3), h = new Array(6);
            return function(_, f) {
                c[0] = f.halfExtents.x, c[1] = f.halfExtents.y, c[2] = f.halfExtents.z, t = f.center, 
                e = _.o, i = _.d;
                var d = f.orientation.m;
                s.Vec3.set(n, d[0], d[1], d[2]), s.Vec3.set(r, d[3], d[4], d[5]), s.Vec3.set(o, d[6], d[7], d[8]), 
                s.Vec3.subtract(a, t, e), l[0] = s.Vec3.dot(n, i), l[1] = s.Vec3.dot(r, i), l[2] = s.Vec3.dot(o, i), 
                u[0] = s.Vec3.dot(n, a), u[1] = s.Vec3.dot(r, a), u[2] = s.Vec3.dot(o, a);
                for (var p = 0; p < 3; ++p) {
                    if (0 === l[p]) {
                        if (-u[p] - c[p] > 0 || -u[p] + c[p] < 0) return 0;
                        l[p] = 1e-7;
                    }
                    h[2 * p + 0] = (u[p] + c[p]) / l[p], h[2 * p + 1] = (u[p] - c[p]) / l[p];
                }
                var m = Math.max(Math.max(Math.min(h[0], h[1]), Math.min(h[2], h[3])), Math.min(h[4], h[5])), v = Math.min(Math.min(Math.max(h[0], h[1]), Math.max(h[2], h[3])), Math.max(h[4], h[5]));
                return v < 0 || m > v || m < 0 ? 0 : m;
            };
        }(), k = (S = new s.Vec3(), T = new s.Vec3(), w = new s.Vec3(), E = new s.Vec3(), 
        function(t, e) {
            return s.Vec3.subtract(S, t.center, t.halfExtents), s.Vec3.add(T, t.center, t.halfExtents), 
            s.Vec3.subtract(w, e.center, e.halfExtents), s.Vec3.add(E, e.center, e.halfExtents), 
            S.x <= E.x && T.x >= w.x && S.y <= E.y && T.y >= w.y && S.z <= E.z && T.z >= w.z;
        });
        function z(t, e, i) {
            s.Vec3.set(i[0], t.x, e.y, e.z), s.Vec3.set(i[1], t.x, e.y, t.z), s.Vec3.set(i[2], t.x, t.y, e.z), 
            s.Vec3.set(i[3], t.x, t.y, t.z), s.Vec3.set(i[4], e.x, e.y, e.z), s.Vec3.set(i[5], e.x, e.y, t.z), 
            s.Vec3.set(i[6], e.x, t.y, e.z), s.Vec3.set(i[7], e.x, t.y, t.z);
        }
        function U(t, e, i, n, r, o) {
            s.Vec3.set(o[0], t.x + i.x * e.x + n.x * e.y + r.x * e.z, t.y + i.y * e.x + n.y * e.y + r.y * e.z, t.z + i.z * e.x + n.z * e.y + r.z * e.z), 
            s.Vec3.set(o[1], t.x - i.x * e.x + n.x * e.y + r.x * e.z, t.y - i.y * e.x + n.y * e.y + r.y * e.z, t.z - i.z * e.x + n.z * e.y + r.z * e.z), 
            s.Vec3.set(o[2], t.x + i.x * e.x - n.x * e.y + r.x * e.z, t.y + i.y * e.x - n.y * e.y + r.y * e.z, t.z + i.z * e.x - n.z * e.y + r.z * e.z), 
            s.Vec3.set(o[3], t.x + i.x * e.x + n.x * e.y - r.x * e.z, t.y + i.y * e.x + n.y * e.y - r.y * e.z, t.z + i.z * e.x + n.z * e.y - r.z * e.z), 
            s.Vec3.set(o[4], t.x - i.x * e.x - n.x * e.y - r.x * e.z, t.y - i.y * e.x - n.y * e.y - r.y * e.z, t.z - i.z * e.x - n.z * e.y - r.z * e.z), 
            s.Vec3.set(o[5], t.x + i.x * e.x - n.x * e.y - r.x * e.z, t.y + i.y * e.x - n.y * e.y - r.y * e.z, t.z + i.z * e.x - n.z * e.y - r.z * e.z), 
            s.Vec3.set(o[6], t.x - i.x * e.x + n.x * e.y - r.x * e.z, t.y - i.y * e.x + n.y * e.y - r.y * e.z, t.z - i.z * e.x + n.z * e.y - r.z * e.z), 
            s.Vec3.set(o[7], t.x - i.x * e.x - n.x * e.y + r.x * e.z, t.y - i.y * e.x - n.y * e.y + r.y * e.z, t.z - i.z * e.x - n.z * e.y + r.z * e.z);
        }
        function H(t, e) {
            for (var i = s.Vec3.dot(e, t[0]), n = i, r = 1; r < 8; ++r) {
                var o = s.Vec3.dot(e, t[r]);
                i = o < i ? o : i, n = o > n ? o : n;
            }
            return [ i, n ];
        }
        var W, j = function() {
            for (var t = new Array(15), e = 0; e < 15; e++) t[e] = new s.Vec3(0, 0, 0);
            for (var i = new Array(8), n = new Array(8), r = 0; r < 8; r++) i[r] = new s.Vec3(0, 0, 0), 
            n[r] = new s.Vec3(0, 0, 0);
            var o = new s.Vec3(), a = new s.Vec3();
            return function(e, r) {
                var c = r.orientation.m;
                s.Vec3.set(t[0], 1, 0, 0), s.Vec3.set(t[1], 0, 1, 0), s.Vec3.set(t[2], 0, 0, 1), 
                s.Vec3.set(t[3], c[0], c[1], c[2]), s.Vec3.set(t[4], c[3], c[4], c[5]), s.Vec3.set(t[5], c[6], c[7], c[8]);
                for (var l = 0; l < 3; ++l) s.Vec3.cross(t[6 + 3 * l], t[l], t[0]), s.Vec3.cross(t[7 + 3 * l], t[l], t[1]), 
                s.Vec3.cross(t[7 + 3 * l], t[l], t[2]);
                s.Vec3.subtract(o, e.center, e.halfExtents), s.Vec3.add(a, e.center, e.halfExtents), 
                z(o, a, i), U(r.center, r.halfExtents, t[3], t[4], t[5], n);
                for (var u = 0; u < 15; ++u) {
                    var h = H(i, t[u]), _ = H(n, t[u]);
                    if (_[0] > h[1] || h[0] > _[1]) return 0;
                }
                return 1;
            };
        }(), q = function(t, e) {
            var i = t.halfExtents.x * Math.abs(e.n.x) + t.halfExtents.y * Math.abs(e.n.y) + t.halfExtents.z * Math.abs(e.n.z), n = s.Vec3.dot(e.n, t.center);
            return n + i < e.d ? -1 : n - i > e.d ? 0 : 1;
        }, X = function(t, e) {
            for (var i = 0; i < e.planes.length; i++) if (-1 === q(t, e.planes[i])) return 0;
            return 1;
        }, Y = function() {
            for (var t = new Array(8), e = 0, i = 0, n = 0; n < t.length; n++) t[n] = new s.Vec3(0, 0, 0);
            return function(n, r) {
                for (var o = 0, a = !1, c = 0; c < r.planes.length; c++) {
                    if (-1 === (o = q(n, r.planes[c]))) return 0;
                    1 === o && (a = !0);
                }
                if (!a) return 1;
                for (var l = 0; l < r.vertices.length; l++) s.Vec3.subtract(t[l], r.vertices[l], n.center);
                e = 0, i = 0;
                for (var u = 0; u < r.vertices.length; u++) t[u].x > n.halfExtents.x ? e++ : t[u].x < -n.halfExtents.x && i++;
                if (e === r.vertices.length || i === r.vertices.length) return 0;
                e = 0, i = 0;
                for (var h = 0; h < r.vertices.length; h++) t[h].y > n.halfExtents.y ? e++ : t[h].y < -n.halfExtents.y && i++;
                if (e === r.vertices.length || i === r.vertices.length) return 0;
                e = 0, i = 0;
                for (var _ = 0; _ < r.vertices.length; _++) t[_].z > n.halfExtents.z ? e++ : t[_].z < -n.halfExtents.z && i++;
                return e === r.vertices.length || i === r.vertices.length ? 0 : 1;
            };
        }(), J = function() {
            var t = new s.Vec3(0, 0, 0), e = new s.Mat3();
            return function(i, n) {
                return s.Vec3.subtract(t, n, i.center), s.Vec3.transformMat3(t, t, s.Mat3.transpose(e, i.orientation)), 
                r = t, o = i.halfExtents, Math.abs(r.x) < o.x && Math.abs(r.y) < o.y && Math.abs(r.z) < o.z;
                var r, o;
            };
        }(), Z = (W = function(t, e, i, n) {
            return Math.abs(t.x * e + t.y * i + t.z * n);
        }, function(t, e) {
            var i = t.orientation.m, n = t.halfExtents.x * W(e.n, i[0], i[1], i[2]) + t.halfExtents.y * W(e.n, i[3], i[4], i[5]) + t.halfExtents.z * W(e.n, i[6], i[7], i[8]), r = s.Vec3.dot(e.n, t.center);
            return r + n < e.d ? -1 : r - n > e.d ? 0 : 1;
        }), K = function(t, e) {
            for (var i = 0; i < e.planes.length; i++) if (-1 === Z(t, e.planes[i])) return 0;
            return 1;
        }, Q = function() {
            for (var t = new Array(8), e = 0, i = 0, n = 0, r = 0; r < t.length; r++) t[r] = new s.Vec3(0, 0, 0);
            var o = function(t, e, i, n) {
                return t.x * e + t.y * i + t.z * n;
            };
            return function(r, a) {
                for (var c = 0, l = !1, u = 0; u < a.planes.length; u++) {
                    if (-1 === (c = Z(r, a.planes[u]))) return 0;
                    1 === c && (l = !0);
                }
                if (!l) return 1;
                for (var h = 0; h < a.vertices.length; h++) s.Vec3.subtract(t[h], a.vertices[h], r.center);
                i = 0, n = 0;
                for (var _ = r.orientation.m, f = 0; f < a.vertices.length; f++) (e = o(t[f], _[0], _[1], _[2])) > r.halfExtents.x ? i++ : e < -r.halfExtents.x && n++;
                if (i === a.vertices.length || n === a.vertices.length) return 0;
                i = 0, n = 0;
                for (var d = 0; d < a.vertices.length; d++) (e = o(t[d], _[3], _[4], _[5])) > r.halfExtents.y ? i++ : e < -r.halfExtents.y && n++;
                if (i === a.vertices.length || n === a.vertices.length) return 0;
                i = 0, n = 0;
                for (var p = 0; p < a.vertices.length; p++) (e = o(t[p], _[6], _[7], _[8])) > r.halfExtents.z ? i++ : e < -r.halfExtents.z && n++;
                return i === a.vertices.length || n === a.vertices.length ? 0 : 1;
            };
        }(), $ = function() {
            for (var t = new Array(15), e = 0; e < 15; e++) t[e] = new s.Vec3(0, 0, 0);
            for (var i = new Array(8), n = new Array(8), r = 0; r < 8; r++) i[r] = new s.Vec3(0, 0, 0), 
            n[r] = new s.Vec3(0, 0, 0);
            return function(e, r) {
                var o = e.orientation.m, a = r.orientation.m;
                s.Vec3.set(t[0], o[0], o[1], o[2]), s.Vec3.set(t[1], o[3], o[4], o[5]), s.Vec3.set(t[2], o[6], o[7], o[8]), 
                s.Vec3.set(t[3], a[0], a[1], a[2]), s.Vec3.set(t[4], a[3], a[4], a[5]), s.Vec3.set(t[5], a[6], a[7], a[8]);
                for (var c = 0; c < 3; ++c) s.Vec3.cross(t[6 + 3 * c], t[c], t[0]), s.Vec3.cross(t[7 + 3 * c], t[c], t[1]), 
                s.Vec3.cross(t[7 + 3 * c], t[c], t[2]);
                U(e.center, e.halfExtents, t[0], t[1], t[2], i), U(r.center, r.halfExtents, t[3], t[4], t[5], n);
                for (var l = 0; l < 15; ++l) {
                    var u = H(i, t[l]), h = H(n, t[l]);
                    if (h[0] > u[1] || u[0] > h[1]) return 0;
                }
                return 1;
            };
        }(), tt = function(t, e) {
            var i = s.Vec3.dot(e.n, t.center), n = t.radius * e.n.length();
            return i + n < e.d ? -1 : i - n > e.d ? 0 : 1;
        }, et = function(t, e) {
            for (var i = 0; i < e.planes.length; i++) if (-1 === tt(t, e.planes[i])) return 0;
            return 1;
        }, it = function() {
            var t = new s.Vec3(0, 0, 0), e = [ 1, -1, 1, -1, 1, -1 ];
            return function(i, n) {
                for (var r = 0; r < 6; r++) {
                    var o = n.planes[r], a = i.radius, c = i.center, l = o.n, u = o.d, h = s.Vec3.dot(l, c);
                    if (h + a < u) return 0;
                    if (!(h - a > u)) {
                        s.Vec3.add(t, c, s.Vec3.multiplyScalar(t, l, a));
                        for (var _ = 0; _ < 6; _++) if (_ !== r && _ !== r + e[r]) {
                            var f = n.planes[_];
                            if (s.Vec3.dot(f.n, t) < f.d) return 0;
                        }
                    }
                }
                return 1;
            };
        }(), nt = function(t, e) {
            var i = t.radius + e.radius;
            return s.Vec3.squaredDistance(t.center, e.center) < i * i;
        }, rt = function() {
            var t = new s.Vec3();
            return function(e, i) {
                return a.pt_point_aabb(t, e.center, i), s.Vec3.squaredDistance(e.center, t) < e.radius * e.radius;
            };
        }(), st = function() {
            var t = new s.Vec3();
            return function(e, i) {
                return a.pt_point_obb(t, e.center, i), s.Vec3.squaredDistance(e.center, t) < e.radius * e.radius;
            };
        }(), ot = {
            rayAabb: N,
            rayMesh: B,
            raycast: M,
            rayTriangle: D,
            ray_sphere: O,
            ray_aabb: F,
            ray_obb: G,
            ray_plane: R,
            ray_triangle: I,
            line_plane: P,
            line_triangle: V,
            line_quad: L,
            sphere_sphere: nt,
            sphere_aabb: rt,
            sphere_obb: st,
            sphere_plane: tt,
            sphere_frustum: et,
            sphere_frustum_accurate: it,
            aabb_aabb: k,
            aabb_obb: j,
            aabb_plane: q,
            aabb_frustum: X,
            aabb_frustum_accurate: Y,
            obb_obb: $,
            obb_plane: Z,
            obb_frustum: K,
            obb_frustum_accurate: Q,
            obb_point: J,
            resolve: function(t, e, i) {
                void 0 === i && (i = null);
                var n = t._type, r = e._type, s = this[n | r];
                return n < r ? s(t, e, i) : s(e, t, i);
            }
        };
        ot[c.default.SHAPE_RAY | c.default.SHAPE_SPHERE] = O, ot[c.default.SHAPE_RAY | c.default.SHAPE_AABB] = F, 
        ot[c.default.SHAPE_RAY | c.default.SHAPE_OBB] = G, ot[c.default.SHAPE_RAY | c.default.SHAPE_PLANE] = R, 
        ot[c.default.SHAPE_RAY | c.default.SHAPE_TRIANGLE] = I, ot[c.default.SHAPE_LINE | c.default.SHAPE_PLANE] = P, 
        ot[c.default.SHAPE_LINE | c.default.SHAPE_TRIANGLE] = V, ot[c.default.SHAPE_SPHERE] = nt, 
        ot[c.default.SHAPE_SPHERE | c.default.SHAPE_AABB] = rt, ot[c.default.SHAPE_SPHERE | c.default.SHAPE_OBB] = st, 
        ot[c.default.SHAPE_SPHERE | c.default.SHAPE_PLANE] = tt, ot[c.default.SHAPE_SPHERE | c.default.SHAPE_FRUSTUM] = et, 
        ot[c.default.SHAPE_SPHERE | c.default.SHAPE_FRUSTUM_ACCURATE] = it, ot[c.default.SHAPE_AABB] = k, 
        ot[c.default.SHAPE_AABB | c.default.SHAPE_OBB] = j, ot[c.default.SHAPE_AABB | c.default.SHAPE_PLANE] = q, 
        ot[c.default.SHAPE_AABB | c.default.SHAPE_FRUSTUM] = X, ot[c.default.SHAPE_AABB | c.default.SHAPE_FRUSTUM_ACCURATE] = Y, 
        ot[c.default.SHAPE_OBB] = $, ot[c.default.SHAPE_OBB | c.default.SHAPE_PLANE] = Z, 
        ot[c.default.SHAPE_OBB | c.default.SHAPE_FRUSTUM] = K, ot[c.default.SHAPE_OBB | c.default.SHAPE_FRUSTUM_ACCURATE] = Q;
        var at = ot;
        i.default = at, e.exports = i.default;
    }, {
        "../../renderer/gfx": 298,
        "../../renderer/memop/recycle-pool": 313,
        "../value-types": 271,
        "./aabb": 133,
        "./distance": 134,
        "./enums": 135,
        "./ray": 142,
        "./triangle": 144
    } ],
    139: [ function(t, e, i) {
        "use strict";
        i.__esModule = !0, i.default = void 0;
        var n, r = t("../value-types"), s = (n = t("./enums")) && n.__esModule ? n : {
            default: n
        }, o = function() {
            function t(t, e, i, n, o, a) {
                void 0 === t && (t = 0), void 0 === e && (e = 0), void 0 === i && (i = 0), void 0 === n && (n = 0), 
                void 0 === o && (o = 0), void 0 === a && (a = -1), this.s = void 0, this.e = void 0, 
                this._type = void 0, this._type = s.default.SHAPE_LINE, this.s = new r.Vec3(t, e, i), 
                this.e = new r.Vec3(n, o, a);
            }
            return t.create = function(e, i, n, r, s, o) {
                return new t(e, i, n, r, s, o);
            }, t.clone = function(e) {
                return new t(e.s.x, e.s.y, e.s.z, e.e.x, e.e.y, e.e.z);
            }, t.copy = function(t, e) {
                return r.Vec3.copy(t.s, e.s), r.Vec3.copy(t.e, e.e), t;
            }, t.fromPoints = function(t, e, i) {
                return r.Vec3.copy(t.s, e), r.Vec3.copy(t.e, i), t;
            }, t.set = function(t, e, i, n, r, s, o) {
                return t.s.x = e, t.s.y = i, t.s.z = n, t.e.x = r, t.e.y = s, t.e.z = o, t;
            }, t.len = function(t) {
                return r.Vec3.distance(t.s, t.e);
            }, t.prototype.length = function() {
                return r.Vec3.distance(this.s, this.e);
            }, t;
        }();
        i.default = o, e.exports = i.default;
    }, {
        "../value-types": 271,
        "./enums": 135
    } ],
    140: [ function(t, e, i) {
        "use strict";
        i.__esModule = !0, i.default = void 0;
        var n, r = t("../value-types"), s = (n = t("./enums")) && n.__esModule ? n : {
            default: n
        };
        function o(t, e) {
            for (var i = 0; i < e.length; i++) {
                var n = e[i];
                n.enumerable = n.enumerable || !1, n.configurable = !0, "value" in n && (n.writable = !0), 
                Object.defineProperty(t, n.key, n);
            }
        }
        var a = new r.Vec3(), c = new r.Vec3(), l = new r.Mat3(), u = function() {
            var t, e;
            function i(t, e, i, n, o, a, c, l, u, h, _, f, d, p, m) {
                void 0 === t && (t = 0), void 0 === e && (e = 0), void 0 === i && (i = 0), void 0 === n && (n = 1), 
                void 0 === o && (o = 1), void 0 === a && (a = 1), void 0 === c && (c = 1), void 0 === l && (l = 0), 
                void 0 === u && (u = 0), void 0 === h && (h = 0), void 0 === _ && (_ = 1), void 0 === f && (f = 0), 
                void 0 === d && (d = 0), void 0 === p && (p = 0), void 0 === m && (m = 1), this.center = void 0, 
                this.halfExtents = void 0, this.orientation = void 0, this._type = void 0, this._type = s.default.SHAPE_OBB, 
                this.center = new r.Vec3(t, e, i), this.halfExtents = new r.Vec3(n, o, a), this.orientation = new r.Mat3(c, l, u, h, _, f, d, p, m);
            }
            i.create = function(t, e, n, r, s, o, a, c, l, u, h, _, f, d, p) {
                return new i(t, e, n, r, s, o, a, c, l, u, h, _, f, d, p);
            }, i.clone = function(t) {
                var e = t.orientation.m;
                return new i(t.center.x, t.center.y, t.center.z, t.halfExtents.x, t.halfExtents.y, t.halfExtents.z, e[0], e[1], e[2], e[3], e[4], e[5], e[6], e[7], e[8]);
            }, i.copy = function(t, e) {
                return r.Vec3.copy(t.center, e.center), r.Vec3.copy(t.halfExtents, e.halfExtents), 
                r.Mat3.copy(t.orientation, e.orientation), t;
            }, i.fromPoints = function(t, e, i) {
                return r.Vec3.multiplyScalar(t.center, r.Vec3.add(a, e, i), .5), r.Vec3.multiplyScalar(t.halfExtents, r.Vec3.subtract(c, i, e), .5), 
                r.Mat3.identity(t.orientation), t;
            }, i.set = function(t, e, i, n, s, o, a, c, l, u, h, _, f, d, p, m) {
                return r.Vec3.set(t.center, e, i, n), r.Vec3.set(t.halfExtents, s, o, a), r.Mat3.set(t.orientation, c, l, u, h, _, f, d, p, m), 
                t;
            }, t = i, (e = [ {
                key: "type",
                get: function() {
                    return this._type;
                }
            } ]) && o(t.prototype, e);
            var n = i.prototype;
            return n.getBoundary = function(t, e) {
                var i, n, s, o, c;
                i = a, n = this.halfExtents, s = this.orientation, o = l.m, c = s.m, o[0] = Math.abs(c[0]), 
                o[1] = Math.abs(c[1]), o[2] = Math.abs(c[2]), o[3] = Math.abs(c[3]), o[4] = Math.abs(c[4]), 
                o[5] = Math.abs(c[5]), o[6] = Math.abs(c[6]), o[7] = Math.abs(c[7]), o[8] = Math.abs(c[8]), 
                r.Vec3.transformMat3(i, n, l), r.Vec3.subtract(t, this.center, a), r.Vec3.add(e, this.center, a);
            }, n.transform = function(t, e, i, n, s) {
                r.Vec3.transformMat4(s.center, this.center, t), r.Mat3.fromQuat(s.orientation, i), 
                r.Vec3.multiply(s.halfExtents, this.halfExtents, n);
            }, n.translateAndRotate = function(t, e, i) {
                r.Vec3.transformMat4(i.center, this.center, t), r.Mat3.fromQuat(i.orientation, e);
            }, n.setScale = function(t, e) {
                r.Vec3.multiply(e.halfExtents, this.halfExtents, t);
            }, i;
        }();
        i.default = u, e.exports = i.default;
    }, {
        "../value-types": 271,
        "./enums": 135
    } ],
    141: [ function(t, e, i) {
        "use strict";
        i.__esModule = !0, i.default = void 0;
        var n, r = t("../value-types"), s = (n = t("./enums")) && n.__esModule ? n : {
            default: n
        }, o = new r.Vec3(0, 0, 0), a = new r.Vec3(0, 0, 0), c = cc.mat4(), l = cc.v4(), u = function() {
            function t(t, e, i, n) {
                void 0 === t && (t = 0), void 0 === e && (e = 1), void 0 === i && (i = 0), void 0 === n && (n = 0), 
                this.n = void 0, this.d = void 0, this._type = void 0, this._type = s.default.SHAPE_PLANE, 
                this.n = new r.Vec3(t, e, i), this.d = n;
            }
            return t.create = function(e, i, n, r) {
                return new t(e, i, n, r);
            }, t.clone = function(e) {
                return new t(e.n.x, e.n.y, e.n.z, e.d);
            }, t.copy = function(t, e) {
                return r.Vec3.copy(t.n, e.n), t.d = e.d, t;
            }, t.fromPoints = function(t, e, i, n) {
                return r.Vec3.subtract(o, i, e), r.Vec3.subtract(a, n, e), r.Vec3.normalize(t.n, r.Vec3.cross(t.n, o, a)), 
                t.d = r.Vec3.dot(t.n, e), t;
            }, t.set = function(t, e, i, n, r) {
                return t.n.x = e, t.n.y = i, t.n.z = n, t.d = r, t;
            }, t.fromNormalAndPoint = function(t, e, i) {
                return r.Vec3.copy(t.n, e), t.d = r.Vec3.dot(e, i), t;
            }, t.normalize = function(t, e) {
                var i = e.n.len();
                return r.Vec3.normalize(t.n, e.n), i > 0 && (t.d = e.d / i), t;
            }, t.prototype.transform = function(t) {
                r.Mat4.invert(c, t), r.Mat4.transpose(c, c), r.Vec4.set(l, this.n.x, this.n.y, this.n.z, this.d), 
                r.Vec4.transformMat4(l, l, c), r.Vec3.set(this.n, l.x, l.y, l.z), this.d = l.w;
            }, t;
        }();
        i.default = u, e.exports = i.default;
    }, {
        "../value-types": 271,
        "./enums": 135
    } ],
    142: [ function(t, e, i) {
        "use strict";
        i.__esModule = !0, i.default = void 0;
        var n, r = t("../value-types"), s = (n = t("./enums")) && n.__esModule ? n : {
            default: n
        }, o = function() {
            function t(t, e, i, n, o, a) {
                void 0 === t && (t = 0), void 0 === e && (e = 0), void 0 === i && (i = 0), void 0 === n && (n = 0), 
                void 0 === o && (o = 0), void 0 === a && (a = -1), this.o = void 0, this.d = void 0, 
                this._type = void 0, this._type = s.default.SHAPE_RAY, this.o = new r.Vec3(t, e, i), 
                this.d = new r.Vec3(n, o, a);
            }
            return t.create = function(e, i, n, r, s, o) {
                return void 0 === e && (e = 0), void 0 === i && (i = 0), void 0 === n && (n = 0), 
                void 0 === r && (r = 0), void 0 === s && (s = 0), void 0 === o && (o = 1), new t(e, i, n, r, s, o);
            }, t.clone = function(e) {
                return new t(e.o.x, e.o.y, e.o.z, e.d.x, e.d.y, e.d.z);
            }, t.copy = function(t, e) {
                return r.Vec3.copy(t.o, e.o), r.Vec3.copy(t.d, e.d), t;
            }, t.fromPoints = function(t, e, i) {
                return r.Vec3.copy(t.o, e), r.Vec3.normalize(t.d, r.Vec3.subtract(t.d, i, e)), t;
            }, t.set = function(t, e, i, n, r, s, o) {
                return t.o.x = e, t.o.y = i, t.o.z = n, t.d.x = r, t.d.y = s, t.d.z = o, t;
            }, t.prototype.computeHit = function(t, e) {
                r.Vec3.normalize(t, this.d), r.Vec3.scaleAndAdd(t, this.o, t, e);
            }, t;
        }();
        i.default = o, e.exports = i.default;
    }, {
        "../value-types": 271,
        "./enums": 135
    } ],
    143: [ function(t, e, i) {
        "use strict";
        i.__esModule = !0, i.default = void 0;
        var n, r = t("../value-types"), s = (n = t("./enums")) && n.__esModule ? n : {
            default: n
        }, o = new r.Vec3(), a = function() {
            function t(t, e, i, n) {
                void 0 === t && (t = 0), void 0 === e && (e = 0), void 0 === i && (i = 0), void 0 === n && (n = 1), 
                this.center = void 0, this.radius = void 0, this._type = void 0, this._type = s.default.SHAPE_SPHERE, 
                this.center = new r.Vec3(t, e, i), this.radius = n;
            }
            t.create = function(e, i, n, r) {
                return new t(e, i, n, r);
            }, t.clone = function(e) {
                return new t(e.center.x, e.center.y, e.center.z, e.radius);
            }, t.copy = function(t, e) {
                return r.Vec3.copy(t.center, e.center), t.radius = e.radius, t;
            }, t.fromPoints = function(t, e, i) {
                return r.Vec3.multiplyScalar(t.center, r.Vec3.add(o, e, i), .5), t.radius = .5 * r.Vec3.subtract(o, i, e).len(), 
                t;
            }, t.set = function(t, e, i, n, r) {
                return t.center.x = e, t.center.y = i, t.center.z = n, t.radius = r, t;
            };
            var e = t.prototype;
            return e.clone = function() {
                return t.clone(this);
            }, e.copy = function(e) {
                return t.copy(this, e);
            }, e.getBoundary = function(t, e) {
                r.Vec3.set(t, this.center.x - this.radius, this.center.y - this.radius, this.center.z - this.radius), 
                r.Vec3.set(e, this.center.x + this.radius, this.center.y + this.radius, this.center.z + this.radius);
            }, e.transform = function(t, e, i, n, s) {
                r.Vec3.transformMat4(s.center, this.center, t), s.radius = this.radius * n.maxAxis();
            }, e.translateAndRotate = function(t, e, i) {
                r.Vec3.transformMat4(i.center, this.center, t);
            }, e.setScale = function(t, e) {
                e.radius = this.radius * t.maxAxis();
            }, t;
        }();
        i.default = a, e.exports = i.default;
    }, {
        "../value-types": 271,
        "./enums": 135
    } ],
    144: [ function(t, e, i) {
        "use strict";
        i.__esModule = !0, i.default = void 0;
        var n = s(t("../value-types/vec3")), r = s(t("./enums"));
        function s(t) {
            return t && t.__esModule ? t : {
                default: t
            };
        }
        var o = function() {
            function t(t, e, i, s, o, a, c, l, u) {
                this.a = void 0, this.b = void 0, this.c = void 0, this._type = void 0, this.a = new n.default(t, e, i), 
                this.b = new n.default(s, o, a), this.c = new n.default(c, l, u), this._type = r.default.SHAPE_TRIANGLE;
            }
            return t.create = function(e, i, n, r, s, o, a, c, l) {
                return new t(e, i, n, r, s, o, a, c, l);
            }, t.clone = function(e) {
                return new t(e.a.x, e.a.y, e.a.z, e.b.x, e.b.y, e.b.z, e.c.x, e.c.y, e.c.z);
            }, t.copy = function(t, e) {
                return n.default.copy(t.a, e.a), n.default.copy(t.b, e.b), n.default.copy(t.c, e.c), 
                t;
            }, t.fromPoints = function(t, e, i, r) {
                return n.default.copy(t.a, e), n.default.copy(t.b, i), n.default.copy(t.c, r), t;
            }, t.set = function(t, e, i, n, r, s, o, a, c, l) {
                return t.a.x = e, t.a.y = i, t.a.z = n, t.b.x = r, t.b.y = s, t.b.z = o, t.c.x = a, 
                t.c.y = c, t.c.z = l, t;
            }, t;
        }();
        i.default = o, e.exports = i.default;
    }, {
        "../value-types/vec3": 281,
        "./enums": 135
    } ],
    145: [ function(t, e) {
        "use strict";
        var i = t("../components/CCRenderComponent"), n = t("../assets/material/CCMaterial"), r = t("./types"), s = r.LineCap, o = r.LineJoin, a = cc.Class({
            name: "cc.Graphics",
            extends: i,
            editor: !1,
            ctor: function() {
                this._impl = new a._Impl(this);
            },
            properties: {
                _lineWidth: 2,
                _strokeColor: cc.Color.BLACK,
                _lineJoin: o.MITER,
                _lineCap: s.BUTT,
                _fillColor: cc.Color.WHITE,
                _miterLimit: 10,
                lineWidth: {
                    get: function() {
                        return this._lineWidth;
                    },
                    set: function(t) {
                        this._lineWidth = t, this._impl.lineWidth = t;
                    }
                },
                lineJoin: {
                    get: function() {
                        return this._lineJoin;
                    },
                    set: function(t) {
                        this._lineJoin = t, this._impl.lineJoin = t;
                    },
                    type: o
                },
                lineCap: {
                    get: function() {
                        return this._lineCap;
                    },
                    set: function(t) {
                        this._lineCap = t, this._impl.lineCap = t;
                    },
                    type: s
                },
                strokeColor: {
                    get: function() {
                        return this._strokeColor;
                    },
                    set: function(t) {
                        this._impl.strokeColor = this._strokeColor = cc.color(t);
                    }
                },
                fillColor: {
                    get: function() {
                        return this._fillColor;
                    },
                    set: function(t) {
                        this._impl.fillColor = this._fillColor = cc.color(t);
                    }
                },
                miterLimit: {
                    get: function() {
                        return this._miterLimit;
                    },
                    set: function(t) {
                        this._miterLimit = t, this._impl.miterLimit = t;
                    }
                }
            },
            statics: {
                LineJoin: o,
                LineCap: s
            },
            onRestore: function() {
                this._impl || (this._impl = new a._Impl(this));
            },
            onDestroy: function() {
                this.clear(!0), this._super(), this._impl = null;
            },
            _getDefaultMaterial: function() {
                return n.getBuiltinMaterial("2d-graphics");
            },
            _updateMaterial: function() {
                var t = this._materials[0];
                t && (void 0 !== t.getDefine("CC_USE_MODEL") && t.define("CC_USE_MODEL", !0), void 0 !== t.getDefine("CC_SUPPORT_standard_derivatives") && cc.sys.glExtension("OES_standard_derivatives") && t.define("CC_SUPPORT_standard_derivatives", !0));
            },
            moveTo: function(t, e) {
                this._impl.moveTo(t, e);
            },
            lineTo: function(t, e) {
                this._impl.lineTo(t, e);
            },
            bezierCurveTo: function(t, e, i, n, r, s) {
                this._impl.bezierCurveTo(t, e, i, n, r, s);
            },
            quadraticCurveTo: function(t, e, i, n) {
                this._impl.quadraticCurveTo(t, e, i, n);
            },
            arc: function(t, e, i, n, r, s) {
                this._impl.arc(t, e, i, n, r, s);
            },
            ellipse: function(t, e, i, n) {
                this._impl.ellipse(t, e, i, n);
            },
            circle: function(t, e, i) {
                this._impl.circle(t, e, i);
            },
            rect: function(t, e, i, n) {
                this._impl.rect(t, e, i, n);
            },
            roundRect: function(t, e, i, n, r) {
                this._impl.roundRect(t, e, i, n, r);
            },
            fillRect: function(t, e, i, n) {
                this.rect(t, e, i, n), this.fill();
            },
            clear: function(t) {
                this._impl.clear(t), this._assembler && this._assembler.clear(t);
            },
            close: function() {
                this._impl.close();
            },
            stroke: function() {
                this._assembler || this._resetAssembler(), this._assembler.stroke(this);
            },
            fill: function() {
                this._assembler || this._resetAssembler(), this._assembler.fill(this);
            }
        });
        cc.Graphics = e.exports = a, cc.Graphics.Types = r, cc.Graphics.Helper = t("./helper");
    }, {
        "../assets/material/CCMaterial": 76,
        "../components/CCRenderComponent": 110,
        "./helper": 146,
        "./types": 148
    } ],
    146: [ function(t, e) {
        "use strict";
        var i = t("./types").PointFlags, n = Math.PI, r = Math.min, s = Math.max, o = Math.cos, a = Math.sin, c = Math.abs, l = Math.sign, u = .5522847493;
        e.exports = {
            arc: function(t, e, i, l, u, h, _) {
                var f, d, p, m = 0, v = 0, y = 0, g = 0, x = 0, A = 0, C = 0, b = 0, S = 0, T = 0, w = 0, E = 0, B = 0;
                if (v = h - u, _ = _ || !1) if (c(v) >= 2 * n) v = 2 * n; else for (;v < 0; ) v += 2 * n; else if (c(v) >= 2 * n) v = 2 * -n; else for (;v > 0; ) v -= 2 * n;
                for (p = 0 | s(1, r(c(v) / (.5 * n) + .5, 5)), y = c(4 / 3 * (1 - o(f = v / p / 2)) / a(f)), 
                _ || (y = -y), d = 0; d <= p; d++) A = e + (g = o(m = u + v * (d / p))) * l, C = i + (x = a(m)) * l, 
                b = -x * l * y, S = g * l * y, 0 === d ? t.moveTo(A, C) : t.bezierCurveTo(T + E, w + B, A - b, C - S, A, C), 
                T = A, w = C, E = b, B = S;
            },
            ellipse: function(t, e, i, n, r) {
                t.moveTo(e - n, i), t.bezierCurveTo(e - n, i + r * u, e - n * u, i + r, e, i + r), 
                t.bezierCurveTo(e + n * u, i + r, e + n, i + r * u, e + n, i), t.bezierCurveTo(e + n, i - r * u, e + n * u, i - r, e, i - r), 
                t.bezierCurveTo(e - n * u, i - r, e - n, i - r * u, e - n, i), t.close();
            },
            roundRect: function(t, e, i, n, s, o) {
                if (o < .1) t.rect(e, i, n, s); else {
                    var a = r(o, .5 * c(n)) * l(n), h = r(o, .5 * c(s)) * l(s);
                    t.moveTo(e, i + h), t.lineTo(e, i + s - h), t.bezierCurveTo(e, i + s - h * (1 - u), e + a * (1 - u), i + s, e + a, i + s), 
                    t.lineTo(e + n - a, i + s), t.bezierCurveTo(e + n - a * (1 - u), i + s, e + n, i + s - h * (1 - u), e + n, i + s - h), 
                    t.lineTo(e + n, i + h), t.bezierCurveTo(e + n, i + h * (1 - u), e + n - a * (1 - u), i, e + n - a, i), 
                    t.lineTo(e + a, i), t.bezierCurveTo(e + a * (1 - u), i, e, i + h * (1 - u), e, i + h), 
                    t.close();
                }
            },
            tesselateBezier: function t(e, n, r, s, o, a, l, u, h, _, f) {
                var d, p, m, v, y, g, x, A, C, b, S, T, w, E, B, M;
                _ > 10 || (y = .5 * (a + u), g = .5 * (l + h), x = .5 * ((d = .5 * (n + s)) + (m = .5 * (s + a))), 
                A = .5 * ((p = .5 * (r + o)) + (v = .5 * (o + l))), ((B = c((s - u) * (E = h - r) - (o - h) * (w = u - n))) + (M = c((a - u) * E - (l - h) * w))) * (B + M) < e._tessTol * (w * w + E * E) ? e._addPoint(u, h, 0 === f ? f | i.PT_BEVEL : f) : (t(e, n, r, d, p, x, A, S = .5 * (x + (C = .5 * (m + y))), T = .5 * (A + (b = .5 * (v + g))), _ + 1, 0), 
                t(e, S, T, C, b, y, g, u, h, _ + 1, f)));
            }
        };
    }, {
        "./types": 148
    } ],
    147: [ function(t) {
        "use strict";
        t("./graphics");
    }, {
        "./graphics": 145
    } ],
    148: [ function(t, e) {
        "use strict";
        var i = cc.Enum({
            BUTT: 0,
            ROUND: 1,
            SQUARE: 2
        }), n = cc.Enum({
            BEVEL: 0,
            ROUND: 1,
            MITER: 2
        }), r = cc.Enum({
            PT_CORNER: 1,
            PT_LEFT: 2,
            PT_BEVEL: 4,
            PT_INNERBEVEL: 8
        });
        e.exports = {
            LineCap: i,
            LineJoin: n,
            PointFlags: r
        };
    }, {} ],
    149: [ function(t) {
        "use strict";
        t("./platform"), t("./assets"), t("./CCNode"), t("./CCPrivateNode"), t("./CCScene"), 
        t("./components"), t("./graphics"), t("./collider"), t("./collider/CCIntersection"), 
        t("./physics"), t("./camera/CCCamera"), t("./geom-utils"), t("./mesh"), t("./3d"), 
        t("./base-ui/CCWidgetManager");
    }, {
        "./3d": void 0,
        "./CCNode": 25,
        "./CCPrivateNode": 26,
        "./CCScene": 27,
        "./assets": 74,
        "./base-ui/CCWidgetManager": 85,
        "./camera/CCCamera": 86,
        "./collider": 94,
        "./collider/CCIntersection": 92,
        "./components": 121,
        "./geom-utils": 137,
        "./graphics": 147,
        "./mesh": 152,
        "./physics": 167,
        "./platform": 200
    } ],
    150: [ function(t, e) {
        "use strict";
        var i = s(t("../../renderer/core/input-assembler")), n = s(t("../../renderer/gfx")), r = t("./mesh-data");
        function s(t) {
            return t && t.__esModule ? t : {
                default: t
            };
        }
        var o = t("../renderer"), a = t("../event/event-target");
        function c(t, e, i) {
            t[e] = i._val;
        }
        function l(t, e, i) {
            t[e] = i.x, t[e + 1] = i.y;
        }
        function u(t, e, i) {
            t[e] = i.x, t[e + 1] = i.y, t[e + 2] = i.z;
        }
        var h, _ = {
            5120: "getInt8",
            5121: "getUint8",
            5122: "getInt16",
            5123: "getUint16",
            5124: "getInt32",
            5125: "getUint32",
            5126: "getFloat32"
        }, f = {
            5120: "setInt8",
            5121: "setUint8",
            5122: "setInt16",
            5123: "setUint16",
            5124: "setInt32",
            5125: "setUint32",
            5126: "setFloat32"
        }, d = (h = new ArrayBuffer(2), new DataView(h).setInt16(0, 256, !0), 256 === new Int16Array(h)[0]), p = cc.Class({
            name: "cc.Mesh",
            extends: cc.Asset,
            mixins: [ a ],
            properties: {
                _nativeAsset: {
                    override: !0,
                    get: function() {
                        return this._buffer;
                    },
                    set: function(t) {
                        this._buffer = ArrayBuffer.isView(t) ? t.buffer : t, this.initWithBuffer();
                    }
                },
                _vertexBundles: {
                    default: null,
                    type: r.VertexBundle
                },
                _primitives: {
                    default: null,
                    Primitive: r.Primitive
                },
                _minPos: cc.v3(),
                _maxPos: cc.v3(),
                subMeshes: {
                    get: function() {
                        return this._subMeshes;
                    },
                    set: function(t) {
                        this._subMeshes = t;
                    }
                },
                subDatas: {
                    get: function() {
                        return this._subDatas;
                    }
                }
            },
            ctor: function() {
                this._subMeshes = [], this._subDatas = [], this.loaded = !1;
            },
            initWithBuffer: function() {
                this._subMeshes.length = 0;
                for (var t = this._primitives, e = 0; e < t.length; e++) {
                    var s = t[e], a = s.data, c = new Uint8Array(this._buffer, a.offset, a.length), l = this._vertexBundles[s.vertexBundleIndices[0]], u = l.data, h = new n.default.VertexFormat(l.formats), _ = new Uint8Array(this._buffer, u.offset, u.length), f = this._canVertexFormatBatch(h), d = new r.MeshData();
                    d.vData = _, d.iData = c, d.vfm = h, d.offset = u.offset, d.canBatch = f, this._subDatas.push(d);
                    var p = new n.default.VertexBuffer(o.device, h, n.default.USAGE_STATIC, _), m = new n.default.IndexBuffer(o.device, s.indexUnit, n.default.USAGE_STATIC, c);
                    this._subMeshes.push(new i.default(p, m));
                }
                this.loaded = !0, this.emit("load");
            },
            _canVertexFormatBatch: function(t) {
                var e = t._attr2el[n.default.ATTR_POSITION];
                return !e || e.type === n.default.ATTR_TYPE_FLOAT32 && t._bytes % 4 == 0;
            },
            init: function(t, e, s, a) {
                void 0 === s && (s = !1), void 0 === a && (a = 0);
                var c = new Uint8Array(t._bytes * e), l = new r.MeshData();
                l.vData = c, l.vfm = t, l.vDirty = !0, l.canBatch = this._canVertexFormatBatch(t);
                var u = new n.default.VertexBuffer(o.device, t, s ? n.default.USAGE_DYNAMIC : n.default.USAGE_STATIC, c);
                l.vb = u, this._subMeshes[a] = new i.default(l.vb);
                var h = this._subDatas[a];
                h && (h.vb && h.vb.destroy(), h.ib && h.ib.destroy()), this._subDatas[a] = l, this.loaded = !0, 
                this.emit("load"), this.emit("init-format");
            },
            setVertices: function(t, e, i) {
                i = i || 0;
                var r = this._subDatas[i], s = r.vfm.element(t);
                if (!s) return cc.warn("Cannot find " + t + " attribute in vertex defines.");
                var o, a = "number" == typeof e[0], h = s.num, _ = a ? e.length / h | 0 : e.length;
                r.vData.byteLength < _ * s.stride && r.setVData(new Uint8Array(_ * r.vfm._bytes));
                var f = 4;
                t === n.default.ATTR_COLOR ? a ? (o = r.getVData(), f = 1) : o = r.getVData(Uint32Array) : o = r.getVData(Float32Array);
                var d = s.stride / f, p = s.offset / f;
                if (a) for (var m = 0, v = e.length / h; m < v; m++) for (var y = m * h, g = m * d + p, x = 0; x < h; x++) o[g + x] = e[y + x]; else {
                    var A;
                    A = t === n.default.ATTR_COLOR ? c : 2 === h ? l : u;
                    for (var C = 0, b = e.length; C < b; C++) A(o, C * d + p, e[C]);
                }
                r.vDirty = !0;
            },
            setIndices: function(t, e, i) {
                e = e || 0;
                var r = t;
                t instanceof Uint16Array ? r = new Uint8Array(t.buffer, t.byteOffset, t.byteLength) : Array.isArray(t) && (r = new Uint16Array(t), 
                r = new Uint8Array(r.buffer, r.byteOffset, r.byteLength));
                var s = i ? n.default.USAGE_DYNAMIC : n.default.USAGE_STATIC, a = this._subDatas[e];
                if (a.ib) a.iData = r, a.iDirty = !0; else {
                    a.iData = r;
                    var c = new n.default.IndexBuffer(o.device, n.default.INDEX_FMT_UINT16, s, r, r.byteLength / n.default.IndexBuffer.BYTES_PER_INDEX[n.default.INDEX_FMT_UINT16]);
                    a.ib = c, this._subMeshes[e]._indexBuffer = a.ib;
                }
            },
            setPrimitiveType: function(t, e) {
                e = e || 0, this._subMeshes[e] ? this._subMeshes[e]._primitiveType = t : cc.warn("Do not have sub mesh at index " + e);
            },
            clear: function() {
                this._subMeshes.length = 0;
                for (var t = this._subDatas, e = 0, i = t.length; e < i; e++) {
                    var n = t[e].vb;
                    n && n.destroy();
                    var r = t[e].ib;
                    r && r.destroy();
                }
                t.length = 0;
            },
            setBoundingBox: function(t, e) {
                this._minPos = t, this._maxPos = e;
            },
            destroy: function() {
                this.clear();
            },
            _uploadData: function() {
                for (var t = this._subDatas, e = 0, i = t.length; e < i; e++) {
                    var n = t[e];
                    if (n.vDirty) {
                        var r = n.vb, s = n.vData;
                        r.update(0, s), n.vDirty = !1;
                    }
                    if (n.iDirty) {
                        var o = n.ib, a = n.iData;
                        o.update(0, a), n.iDirty = !1;
                    }
                }
            },
            _getAttrMeshData: function(t, e) {
                var i = this._subDatas[t];
                if (!i) return [];
                var n = i.vfm, r = n.element(e);
                if (!r) return [];
                i.attrDatas || (i.attrDatas = {});
                var s = i.attrDatas, o = s[e];
                if (o) return o;
                o = s[e] = [];
                for (var a = i.vData, c = new DataView(a.buffer, a.byteOffset, a.byteLength), l = r.stride, u = r.offset, h = r.num, f = r.bytes / h, p = _[r.type], m = a.byteLength / n._bytes, v = 0; v < m; v++) for (var y = v * l + u, g = 0; g < h; g++) {
                    var x = c[p](y + g * f, d);
                    o.push(x);
                }
                return o;
            },
            copyAttribute: function(t, e, i, n, r) {
                var s = !1, o = this._subDatas[t];
                if (!o) return s;
                var a = o.vfm, c = a.element(e);
                if (!c) return s;
                var l = f[c.type];
                if (!l) return s;
                var u = this._getAttrMeshData(t, e), h = o.vData.byteLength / a._bytes, _ = c.bytes / c.num;
                if (u.length > 0) {
                    for (var p = new DataView(i, r), m = n, v = c.num, y = 0; y < h; ++y) for (var g = y * v, x = 0; x < v; ++x) {
                        var A = g + x, C = m * y + _ * x;
                        p[l](C, u[A], d);
                    }
                    s = !0;
                }
                return s;
            },
            copyIndices: function(t, e) {
                var i = this._subDatas[t];
                if (!i) return !1;
                for (var r = i.iData, s = r.length / 2, o = new DataView(r.buffer, r.byteOffset, r.byteLength), a = _[n.default.INDEX_FMT_UINT8], c = 0; c < s; ++c) e[c] = o[a](2 * c);
                return !0;
            }
        });
        cc.Mesh = e.exports = p;
    }, {
        "../../renderer/core/input-assembler": 288,
        "../../renderer/gfx": 298,
        "../event/event-target": 129,
        "../renderer": 213,
        "./mesh-data": 153
    } ],
    151: [ function(t, e) {
        "use strict";
        var i = s(t("../../renderer/gfx")), n = (s(t("../../renderer/core/input-assembler")), 
        s(t("../geom-utils/aabb"))), r = (s(t("../value-types/vec3")), s(t("../value-types/mat4")), 
        s(t("../assets/material/material-variant")));
        function s(t) {
            return t && t.__esModule ? t : {
                default: t
            };
        }
        var o = t("../components/CCRenderComponent"), a = t("./CCMesh"), c = t("../renderer/render-flow"), l = (t("../renderer"), 
        t("../assets/material/CCMaterial")), u = cc.Enum({
            OFF: 0,
            ON: 1
        }), h = cc.Class({
            name: "cc.MeshRenderer",
            extends: o,
            editor: !1,
            properties: {
                _mesh: {
                    default: null,
                    type: a
                },
                _receiveShadows: !1,
                _shadowCastingMode: u.OFF,
                _enableAutoBatch: !1,
                mesh: {
                    get: function() {
                        return this._mesh;
                    },
                    set: function(t) {
                        this._mesh !== t && (this._setMesh(t), t ? (this.markForRender(!0), this.node._renderFlag |= c.FLAG_TRANSFORM) : this.disableRender());
                    },
                    type: a,
                    animatable: !1
                },
                textures: {
                    default: [],
                    type: cc.Texture2D,
                    visible: !1
                },
                receiveShadows: {
                    get: function() {
                        return this._receiveShadows;
                    },
                    set: function(t) {
                        this._receiveShadows = t, this._updateReceiveShadow();
                    },
                    animatable: !1
                },
                shadowCastingMode: {
                    get: function() {
                        return this._shadowCastingMode;
                    },
                    set: function(t) {
                        this._shadowCastingMode = t, this._updateCastShadow();
                    },
                    type: u,
                    animatable: !1
                },
                enableAutoBatch: {
                    get: function() {
                        return this._enableAutoBatch;
                    },
                    set: function(t) {
                        this._enableAutoBatch = t;
                    }
                }
            },
            statics: {
                ShadowCastingMode: u
            },
            ctor: function() {
                this._boundingBox = cc.geomUtils && new n.default();
            },
            onEnable: function() {
                var t = this;
                this._super(), this._mesh && !this._mesh.loaded ? (this.disableRender(), this._mesh.once("load", function() {
                    t.isValid && (t._setMesh(t._mesh), t.markForRender(!0));
                }), cc.assetManager.postLoadNative(this._mesh)) : this._setMesh(this._mesh), this._updateRenderNode(), 
                this._updateMaterial();
            },
            onDestroy: function() {
                this._setMesh(null), cc.pool.assembler.put(this._assembler);
            },
            _updateRenderNode: function() {
                this._assembler.setRenderNode(this.node);
            },
            _setMesh: function(t) {
                cc.geomUtils && t && n.default.fromPoints(this._boundingBox, t._minPos, t._maxPos), 
                this._mesh && this._mesh.off("init-format", this._updateMeshAttribute, this), t && t.on("init-format", this._updateMeshAttribute, this), 
                this._mesh = t, this._assembler && (this._assembler._worldDatas = {}), this._updateMeshAttribute();
            },
            _getDefaultMaterial: function() {
                return l.getBuiltinMaterial("unlit");
            },
            _validateRender: function() {
                var t = this._mesh;
                t && t._subDatas.length > 0 || this.disableRender();
            },
            _updateMaterial: function() {
                var t = this.textures;
                if (t && t.length > 0) for (var e = this._getDefaultMaterial(), i = 0; i < t.length; i++) {
                    var n = this._materials[i];
                    n && n._uuid !== e._uuid || (n || (n = r.default.create(e, this), this.setMaterial(i, n)), 
                    n.setProperty("diffuseTexture", t[i]));
                }
                this._updateReceiveShadow(), this._updateCastShadow(), this._updateMeshAttribute();
            },
            _updateReceiveShadow: function() {
                for (var t = this.getMaterials(), e = 0; e < t.length; e++) t[e].define("CC_USE_SHADOW_MAP", this._receiveShadows, void 0, !0);
            },
            _updateCastShadow: function() {
                for (var t = this.getMaterials(), e = 0; e < t.length; e++) t[e].define("CC_CASTING_SHADOW", this._shadowCastingMode === u.ON, void 0, !0);
            },
            _updateMeshAttribute: function() {
                var t = this._mesh && this._mesh.subDatas;
                if (t) for (var e = this.getMaterials(), n = 0; n < e.length && t[n]; n++) {
                    var r = t[n].vfm, s = e[n];
                    s.define("CC_USE_ATTRIBUTE_COLOR", !!r.element(i.default.ATTR_COLOR), void 0, !0), 
                    s.define("CC_USE_ATTRIBUTE_UV0", !!r.element(i.default.ATTR_UV0), void 0, !0), s.define("CC_USE_ATTRIBUTE_NORMAL", !!r.element(i.default.ATTR_NORMAL), void 0, !0), 
                    s.define("CC_USE_ATTRIBUTE_TANGENT", !!r.element(i.default.ATTR_TANGENT), void 0, !0);
                }
            },
            _checkBacth: function() {}
        });
        cc.MeshRenderer = e.exports = h;
    }, {
        "../../renderer/core/input-assembler": 288,
        "../../renderer/gfx": 298,
        "../assets/material/CCMaterial": 76,
        "../assets/material/material-variant": 83,
        "../components/CCRenderComponent": 110,
        "../geom-utils/aabb": 133,
        "../renderer": 213,
        "../renderer/render-flow": 214,
        "../value-types/mat4": 273,
        "../value-types/vec3": 281,
        "./CCMesh": 150
    } ],
    152: [ function(t) {
        "use strict";
        t("./CCMesh"), t("./CCMeshRenderer"), t("./mesh-renderer");
    }, {
        "./CCMesh": 150,
        "./CCMeshRenderer": 151,
        "./mesh-renderer": 154
    } ],
    153: [ function(t, e, i) {
        "use strict";
        i.__esModule = !0, i.MeshData = l, i.Primitive = i.VertexBundle = i.VertexFormat = i.BufferRange = void 0;
        var n, r = (n = t("../../renderer/gfx")) && n.__esModule ? n : {
            default: n
        }, s = cc.Class({
            name: "cc.BufferRange",
            properties: {
                offset: 0,
                length: 0
            }
        });
        i.BufferRange = s;
        var o = cc.Class({
            name: "cc.mesh.VertexFormat",
            properties: {
                name: "",
                type: -1,
                num: -1,
                normalize: !1
            }
        });
        i.VertexFormat = o;
        var a = cc.Class({
            name: "cc.mesh.VertexBundle",
            properties: {
                data: {
                    default: null,
                    type: s
                },
                formats: {
                    default: [],
                    type: o
                },
                verticesCount: 0
            }
        });
        i.VertexBundle = a;
        var c = cc.Class({
            name: "cc.mesh.Primitive",
            properties: {
                vertexBundleIndices: {
                    default: [],
                    type: cc.Float
                },
                data: {
                    default: null,
                    type: s
                },
                indexUnit: r.default.INDEX_FMT_UINT16,
                topology: r.default.PT_TRIANGLES
            }
        });
        function l() {
            this.vData = null, this.float32VData = null, this.uint32VData = null, this.iData = null, 
            this.uint16IData = null, this.vfm = null, this.offset = 0, this.vb = null, this.ib = null, 
            this.vDirty = !1, this.iDirty = !1, this.enable = !0;
        }
        i.Primitive = c, l.prototype.setVData = function(t) {
            this.vData = t, this.float32VData = null, this.uint32VData = null;
        }, l.prototype.getVData = function(t) {
            return t === Float32Array ? (this.float32VData || (this.float32VData = new Float32Array(this.vData.buffer, this.vData.byteOffset, this.vData.byteLength / 4)), 
            this.float32VData) : t === Uint32Array ? (this.uint32VData || (this.uint32VData = new Uint32Array(this.vData.buffer, this.vData.byteOffset, this.vData.byteLength / 4)), 
            this.uint32VData) : this.vData;
        }, l.prototype.getIData = function(t) {
            return t === Uint16Array ? (this.uint16IData || (this.uint16IData = new Uint16Array(this.iData.buffer, this.iData.byteOffset, this.iData.byteLength / 2)), 
            this.uint16IData) : this.iData;
        };
    }, {
        "../../renderer/gfx": 298
    } ],
    154: [ function(t, e, i) {
        "use strict";
        i.__esModule = !0, i.default = void 0;
        var n = o(t("../renderer/assembler")), r = o(t("../../renderer/gfx")), s = o(t("../value-types/vec3"));
        function o(t) {
            return t && t.__esModule ? t : {
                default: t
            };
        }
        var a = t("./CCMeshRenderer"), c = new s.default(), l = function(t) {
            var e, i;
            function n() {
                return t.apply(this, arguments) || this;
            }
            i = t, (e = n).prototype = Object.create(i.prototype), e.prototype.constructor = e, 
            e.__proto__ = i;
            var o = n.prototype;
            return o.init = function(e) {
                t.prototype.init.call(this, e), this._worldDatas = {}, this._renderNode = null;
            }, o.setRenderNode = function(t) {
                this._renderNode = t;
            }, o.fillBuffers = function(t, e) {
                if (t.mesh) {
                    t.mesh._uploadData();
                    for (var i = e.cullingMask === t.node._cullingMask, n = t.enableAutoBatch, s = t._materials, o = t.mesh._subMeshes, a = t.mesh.subDatas, c = 0; c < o.length; c++) {
                        var l = o[c], u = a[c], h = s[c] || s[0];
                        n && u.canBatch && l._primitiveType === r.default.PT_TRIANGLES ? (i && h.getHash() === e.material.getHash() || e._flush(), 
                        e.material = h, e.cullingMask = t.node._cullingMask, e.node = e._dummyNode, this._fillBuffer(t, u, e, c)) : (e._flush(), 
                        e.material = h, e.cullingMask = t.node._cullingMask, e.node = this._renderNode, 
                        e._flushIA(l));
                    }
                }
            }, o._fillBuffer = function(t, e, i, n) {
                var r = e.getVData(Float32Array), s = e.vfm, o = r.byteLength / s._bytes | 0, a = e.getIData(Uint16Array), c = a.length, l = i.getBuffer("mesh", s), u = l.request(o, c), h = u.indiceOffset, _ = u.byteOffset >> 2, f = u.vertexOffset, d = l._vData, p = l._iData;
                !i.worldMatDirty && this._worldDatas[n] || this._updateWorldVertices(n, o, r, s, t.node._worldMatrix), 
                d.set(this._worldDatas[n], _);
                for (var m = 0; m < c; m++) p[h + m] = f + a[m];
            }, o._updateWorldVertices = function(t, e, i, n, o) {
                var a = this._worldDatas[t];
                a || (a = this._worldDatas[t] = new Float32Array(i.length)).set(i);
                for (var l = n._bytes / 4, u = n._elements, h = 0, _ = u.length; h < _; h++) {
                    var f = u[h], d = f.offset / 4;
                    if (f.name === r.default.ATTR_POSITION || f.name === r.default.ATTR_NORMAL) for (var p = f.name === r.default.ATTR_NORMAL ? s.default.transformMat4Normal : s.default.transformMat4, m = 0; m < e; m++) {
                        var v = m * l + d;
                        c.x = i[v], c.y = i[v + 1], c.z = i[v + 2], p(c, c, o), a[v] = c.x, a[v + 1] = c.y, 
                        a[v + 2] = c.z;
                    }
                }
            }, o._drawDebugDatas = function(t, e, i) {
                var n = t._debugDatas[i];
                if (n) for (var r = 0; r < n.length; r++) {
                    var s = n[r];
                    if (s) {
                        var o = s.material;
                        e.material = o, e._flushIA(s.ia);
                    }
                }
            }, n;
        }(n.default);
        i.default = l, n.default.register(a, l), e.exports = i.default;
    }, {
        "../../renderer/gfx": 298,
        "../renderer/assembler": 210,
        "../value-types/vec3": 281,
        "./CCMeshRenderer": 151
    } ],
    155: [ function(t, e) {
        "use strict";
        var i = t("./component-scheduler"), n = t("./platform/CCObject").Flags, r = t("./platform/js"), s = n.IsPreloadStarted, o = n.IsOnLoadStarted, a = n.IsOnLoadCalled, c = n.Deactivating, l = cc.Class({
            extends: i.LifeCycleInvoker,
            add: function(t) {
                this._zero.array.push(t);
            },
            remove: function(t) {
                this._zero.fastRemove(t);
            },
            cancelInactive: function(t) {
                i.LifeCycleInvoker.stableRemoveInactive(this._zero, t);
            },
            invoke: function() {
                this._invoke(this._zero), this._zero.array.length = 0;
            }
        }), u = i.createInvokeImpl(function(t) {
            t.__preload();
        }, !1, void 0, function(t) {
            var e = t.array;
            for (t.i = 0; t.i < e.length; ++t.i) e[t.i].__preload();
        }), h = i.createInvokeImpl(function(t) {
            t.onLoad(), t._objFlags |= a;
        }, !1, a, function(t) {
            var e = t.array;
            for (t.i = 0; t.i < e.length; ++t.i) {
                var i = e[t.i];
                i.onLoad(), i._objFlags |= a;
            }
        }), _ = new r.Pool(4);
        function f(t, e, i) {
            e ? t._removeComponent(e) : r.array.removeAt(t._components, i);
        }
        function d() {
            this._activatingStack = [];
        }
        _.get = function() {
            var t = this._get() || {
                preload: new l(u),
                onLoad: new i.OneOffInvoker(h),
                onEnable: new i.OneOffInvoker(i.invokeOnEnable)
            };
            t.preload._zero.i = -1;
            var e = t.onLoad;
            return e._zero.i = -1, e._neg.i = -1, e._pos.i = -1, (e = t.onEnable)._zero.i = -1, 
            e._neg.i = -1, e._pos.i = -1, t;
        };
        var p = cc.Class({
            ctor: d,
            reset: d,
            _activateNodeRecursively: function(t, e, i, n) {
                if (t._objFlags & c) cc.errorID(3816, t.name); else {
                    t._activeInHierarchy = !0;
                    for (var r = t._components.length, s = 0; s < r; ++s) {
                        var o = t._components[s];
                        o instanceof cc.Component ? this.activateComp(o, e, i, n) : (f(t, o, s), --s, --r);
                    }
                    t._childArrivalOrder = t._children.length;
                    for (var a = 0, l = t._children.length; a < l; ++a) {
                        var u = t._children[a];
                        u._localZOrder = 4294901760 & u._localZOrder | a + 1, u._active && this._activateNodeRecursively(u, e, i, n);
                    }
                    t._onPostActivated(!0);
                }
            },
            _deactivateNodeRecursively: function(t) {
                t._objFlags |= c, t._activeInHierarchy = !1;
                for (var e = t._components.length, i = 0; i < e; ++i) {
                    var n = t._components[i];
                    if (n._enabled && (cc.director._compScheduler.disableComp(n), t._activeInHierarchy)) return void (t._objFlags &= ~c);
                }
                for (var r = 0, s = t._children.length; r < s; ++r) {
                    var o = t._children[r];
                    if (o._activeInHierarchy && (this._deactivateNodeRecursively(o), t._activeInHierarchy)) return void (t._objFlags &= ~c);
                }
                t._onPostActivated(!1), t._objFlags &= ~c;
            },
            activateNode: function(t, e) {
                if (e) {
                    var i = _.get();
                    this._activatingStack.push(i), this._activateNodeRecursively(t, i.preload, i.onLoad, i.onEnable), 
                    i.preload.invoke(), i.onLoad.invoke(), i.onEnable.invoke(), this._activatingStack.pop(), 
                    _.put(i);
                } else {
                    this._deactivateNodeRecursively(t);
                    for (var n = this._activatingStack, r = 0; r < n.length; r++) {
                        var a = n[r];
                        a.preload.cancelInactive(s), a.onLoad.cancelInactive(o), a.onEnable.cancelInactive();
                    }
                }
                t.emit("active-in-hierarchy-changed", t);
            },
            activateComp: function(t, e, i, n) {
                if (cc.isValid(t, !0) && (t._objFlags & s || (t._objFlags |= s, t.__preload && (e ? e.add(t) : t.__preload())), 
                t._objFlags & o || (t._objFlags |= o, t.onLoad ? i ? i.add(t) : (t.onLoad(), t._objFlags |= a) : t._objFlags |= a), 
                t._enabled)) {
                    if (!t.node._activeInHierarchy) return;
                    cc.director._compScheduler.enableComp(t, n);
                }
            },
            destroyComp: function(t) {
                cc.director._compScheduler.disableComp(t), t.onDestroy && t._objFlags & a && t.onDestroy();
            },
            resetComp: !1
        });
        e.exports = p;
    }, {
        "./component-scheduler": 95,
        "./platform/CCObject": 188,
        "./platform/js": 203,
        "./utils/misc": 256
    } ],
    156: [ function(t, e) {
        "use strict";
        var i = t("./CCPhysicsTypes").PTM_RATIO, n = t("./CCPhysicsTypes").ContactType, r = [], s = [ cc.v2(), cc.v2() ], o = new b2.WorldManifold(), a = {
            points: [],
            separations: [],
            normal: cc.v2()
        };
        function c() {
            this.localPoint = cc.v2(), this.normalImpulse = 0, this.tangentImpulse = 0;
        }
        var l = [ new c(), new c() ], u = (new b2.Manifold(), {
            type: 0,
            localPoint: cc.v2(),
            localNormal: cc.v2(),
            points: []
        }), h = {
            normalImpulses: [],
            tangentImpulses: []
        };
        function _() {}
        _.prototype.init = function(t) {
            this.colliderA = t.GetFixtureA().collider, this.colliderB = t.GetFixtureB().collider, 
            this.disabled = !1, this.disabledOnce = !1, this._impulse = null, this._inverted = !1, 
            this._b2contact = t, t._contact = this;
        }, _.prototype.reset = function() {
            this.setTangentSpeed(0), this.resetFriction(), this.resetRestitution(), this.colliderA = null, 
            this.colliderB = null, this.disabled = !1, this._impulse = null, this._b2contact._contact = null, 
            this._b2contact = null;
        }, _.prototype.getWorldManifold = function() {
            var t = a.points, e = a.separations, n = a.normal;
            this._b2contact.GetWorldManifold(o);
            var r = o.points, c = o.separations, l = this._b2contact.GetManifold().pointCount;
            t.length = e.length = l;
            for (var u = 0; u < l; u++) {
                var h = s[u];
                h.x = r[u].x * i, h.y = r[u].y * i, t[u] = h, e[u] = c[u] * i;
            }
            return n.x = o.normal.x, n.y = o.normal.y, this._inverted && (n.x *= -1, n.y *= -1), 
            a;
        }, _.prototype.getManifold = function() {
            for (var t = u.points, e = u.localNormal, n = u.localPoint, r = this._b2contact.GetManifold(), s = r.points, o = t.length = r.pointCount, a = 0; a < o; a++) {
                var c = l[a], h = s[a];
                c.localPoint.x = h.localPoint.x * i, c.localPoint.Y = h.localPoint.Y * i, c.normalImpulse = h.normalImpulse * i, 
                c.tangentImpulse = h.tangentImpulse, t[a] = c;
            }
            return n.x = r.localPoint.x * i, n.y = r.localPoint.y * i, e.x = r.localNormal.x, 
            e.y = r.localNormal.y, u.type = r.type, this._inverted && (e.x *= -1, e.y *= -1), 
            u;
        }, _.prototype.getImpulse = function() {
            var t = this._impulse;
            if (!t) return null;
            for (var e = h.normalImpulses, n = h.tangentImpulses, r = t.count, s = 0; s < r; s++) e[s] = t.normalImpulses[s] * i, 
            n[s] = t.tangentImpulses[s];
            return n.length = e.length = r, h;
        }, _.prototype.emit = function(t) {
            var e;
            switch (t) {
              case n.BEGIN_CONTACT:
                e = "onBeginContact";
                break;

              case n.END_CONTACT:
                e = "onEndContact";
                break;

              case n.PRE_SOLVE:
                e = "onPreSolve";
                break;

              case n.POST_SOLVE:
                e = "onPostSolve";
            }
            var i, r, s, o, a = this.colliderA, c = this.colliderB, l = a.body, u = c.body;
            if (l.enabledContactListener) for (i = l.node._components, this._inverted = !1, 
            r = 0, s = i.length; r < s; r++) (o = i[r])[e] && o[e](this, a, c);
            if (u.enabledContactListener) for (i = u.node._components, this._inverted = !0, 
            r = 0, s = i.length; r < s; r++) (o = i[r])[e] && o[e](this, c, a);
            (this.disabled || this.disabledOnce) && (this.setEnabled(!1), this.disabledOnce = !1);
        }, _.get = function(t) {
            var e;
            return (e = 0 === r.length ? new cc.PhysicsContact() : r.pop()).init(t), e;
        }, _.put = function(t) {
            var e = t._contact;
            e && (r.push(e), e.reset());
        };
        var f = _.prototype;
        f.setEnabled = function(t) {
            this._b2contact.SetEnabled(t);
        }, f.isTouching = function() {
            return this._b2contact.IsTouching();
        }, f.setTangentSpeed = function(t) {
            this._b2contact.SetTangentSpeed(t / i);
        }, f.getTangentSpeed = function() {
            return this._b2contact.GetTangentSpeed() * i;
        }, f.setFriction = function(t) {
            this._b2contact.SetFriction(t);
        }, f.getFriction = function() {
            return this._b2contact.GetFriction();
        }, f.resetFriction = function() {
            return this._b2contact.ResetFriction();
        }, f.setRestitution = function(t) {
            this._b2contact.SetRestitution(t);
        }, f.getRestitution = function() {
            return this._b2contact.GetRestitution();
        }, f.resetRestitution = function() {
            return this._b2contact.ResetRestitution();
        }, _.ContactType = n, cc.PhysicsContact = e.exports = _;
    }, {
        "./CCPhysicsTypes": 158
    } ],
    157: [ function(t, e) {
        "use strict";
        var i = t("./CCPhysicsTypes"), n = i.ContactType, r = i.BodyType, s = i.RayCastType, o = i.DrawBits, a = i.PTM_RATIO, c = (i.ANGLE_TO_PHYSICS_ANGLE, 
        i.PHYSICS_ANGLE_TO_ANGLE), l = t("./utils").convertToNodeRotation, u = t("./platform/CCPhysicsDebugDraw"), h = new b2.AABB(), _ = new b2.Vec2(), f = new b2.Vec2(), d = cc.v2(), p = cc.Class({
            mixins: [ cc.EventTarget ],
            statics: {
                DrawBits: o,
                PTM_RATIO: a,
                VELOCITY_ITERATIONS: 10,
                POSITION_ITERATIONS: 10,
                FIXED_TIME_STEP: 1 / 60,
                MAX_ACCUMULATOR: .2
            },
            ctor: function() {
                this._debugDrawFlags = 0, this._debugDrawer = null, this._world = null, this._bodies = [], 
                this._joints = [], this._contactMap = {}, this._contactID = 0, this._delayEvents = [], 
                this._accumulator = 0, cc.director._scheduler && cc.director._scheduler.enableForTarget(this), 
                this.enabledAccumulator = !1;
            },
            pushDelayEvent: function(t, e, i) {
                this._steping ? this._delayEvents.push({
                    target: t,
                    func: e,
                    args: i
                }) : t[e].apply(t, i);
            },
            update: function(t) {
                var e = this._world;
                if (e && this.enabled) {
                    this.emit("before-step"), this._steping = !0;
                    var i = p.VELOCITY_ITERATIONS, n = p.POSITION_ITERATIONS;
                    if (this.enabledAccumulator) {
                        this._accumulator += t;
                        var r = p.FIXED_TIME_STEP, s = p.MAX_ACCUMULATOR;
                        for (this._accumulator > s && (this._accumulator = s); this._accumulator > r; ) e.Step(r, i, n), 
                        this._accumulator -= r;
                    } else {
                        var o = 1 / cc.game.config.frameRate;
                        e.Step(o, i, n);
                    }
                    this.debugDrawFlags && (this._checkDebugDrawValid(), this._debugDrawer.clear(), 
                    e.DrawDebugData()), this._steping = !1;
                    for (var a = this._delayEvents, c = 0, l = a.length; c < l; c++) {
                        var u = a[c];
                        u.target[u.func].apply(u.target, u.args);
                    }
                    a.length = 0, this._syncNode();
                }
            },
            testPoint: function(t) {
                var e = _.x = t.x / a, i = _.y = t.y / a, n = .2 / a;
                h.lowerBound.x = e - n, h.lowerBound.y = i - n, h.upperBound.x = e + n, h.upperBound.y = i + n;
                var r = this._aabbQueryCallback;
                r.init(_), this._world.QueryAABB(r, h);
                var s = r.getFixture();
                return s ? s.collider : null;
            },
            testAABB: function(t) {
                h.lowerBound.x = t.xMin / a, h.lowerBound.y = t.yMin / a, h.upperBound.x = t.xMax / a, 
                h.upperBound.y = t.yMax / a;
                var e = this._aabbQueryCallback;
                return e.init(), this._world.QueryAABB(e, h), e.getFixtures().map(function(t) {
                    return t.collider;
                });
            },
            rayCast: function(t, e, i) {
                if (t.equals(e)) return [];
                i = i || s.Closest, _.x = t.x / a, _.y = t.y / a, f.x = e.x / a, f.y = e.y / a;
                var n = this._raycastQueryCallback;
                n.init(i), this._world.RayCast(n, _, f);
                var r = n.getFixtures();
                if (r.length > 0) {
                    for (var o = n.getPoints(), c = n.getNormals(), l = n.getFractions(), u = [], h = 0, d = r.length; h < d; h++) {
                        var p = r[h], m = p.collider;
                        if (i === s.AllClosest) {
                            var v = u.find(function(t) {
                                return t.collider === m;
                            });
                            if (v) {
                                l[h] < v.fraction && (v.fixtureIndex = m._getFixtureIndex(p), v.point.x = o[h].x * a, 
                                v.point.y = o[h].y * a, v.normal.x = c[h].x, v.normal.y = c[h].y, v.fraction = l[h]);
                                continue;
                            }
                        }
                        u.push({
                            collider: m,
                            fixtureIndex: m._getFixtureIndex(p),
                            point: cc.v2(o[h].x * a, o[h].y * a),
                            normal: cc.v2(c[h]),
                            fraction: l[h]
                        });
                    }
                    return u;
                }
                return [];
            },
            syncPosition: function() {
                for (var t = this._bodies, e = 0; e < t.length; e++) t[e].syncPosition();
            },
            syncRotation: function() {
                for (var t = this._bodies, e = 0; e < t.length; e++) t[e].syncRotation();
            },
            _registerContactFixture: function(t) {
                this._contactListener.registerContactFixture(t);
            },
            _unregisterContactFixture: function(t) {
                this._contactListener.unregisterContactFixture(t);
            },
            _addBody: function(t, e) {
                var i = this._world, n = t.node;
                i && n && (t._b2Body = i.CreateBody(e), t._b2Body.body = t, this._bodies.push(t));
            },
            _removeBody: function(t) {
                var e = this._world;
                e && (t._b2Body.body = null, e.DestroyBody(t._b2Body), t._b2Body = null, cc.js.array.remove(this._bodies, t));
            },
            _addJoint: function(t, e) {
                var i = this._world.CreateJoint(e);
                i && (i._joint = t, t._joint = i, this._joints.push(t));
            },
            _removeJoint: function(t) {
                t._isValid() && this._world.DestroyJoint(t._joint), t._joint && (t._joint._joint = null), 
                cc.js.array.remove(this._joints, t);
            },
            _initCallback: function() {
                if (this._world) {
                    if (!this._contactListener) {
                        var t = new cc.PhysicsContactListener();
                        t.setBeginContact(this._onBeginContact), t.setEndContact(this._onEndContact), t.setPreSolve(this._onPreSolve), 
                        t.setPostSolve(this._onPostSolve), this._world.SetContactListener(t), this._contactListener = t, 
                        this._aabbQueryCallback = new cc.PhysicsAABBQueryCallback(), this._raycastQueryCallback = new cc.PhysicsRayCastCallback();
                    }
                } else cc.warn("Please init PhysicsManager first");
            },
            _init: function() {
                this.enabled = !0, this.debugDrawFlags = o.e_shapeBit;
            },
            _getWorld: function() {
                return this._world;
            },
            _syncNode: function() {
                for (var t = this._bodies, e = 0, i = t.length; e < i; e++) {
                    var n = t[e], s = n.node, o = n._b2Body, u = o.GetPosition();
                    d.x = u.x * a, d.y = u.y * a;
                    var h = o.GetAngle() * c;
                    null !== s.parent.parent && (d = s.parent.convertToNodeSpaceAR(d), h = l(s.parent, h));
                    var _ = s._eventMask;
                    s._eventMask = 0, s.position = d, s.angle = -h, s._eventMask = _, n.type === r.Animated && n.resetVelocity();
                }
            },
            _onBeginContact: function(t) {
                cc.PhysicsContact.get(t).emit(n.BEGIN_CONTACT);
            },
            _onEndContact: function(t) {
                var e = t._contact;
                e && (e.emit(n.END_CONTACT), cc.PhysicsContact.put(t));
            },
            _onPreSolve: function(t) {
                var e = t._contact;
                e && e.emit(n.PRE_SOLVE);
            },
            _onPostSolve: function(t, e) {
                var i = t._contact;
                i && (i._impulse = e, i.emit(n.POST_SOLVE), i._impulse = null);
            },
            _checkDebugDrawValid: function() {
                if (!this._debugDrawer || !this._debugDrawer.isValid) {
                    var t = new cc.Node("PHYSICS_MANAGER_DEBUG_DRAW");
                    t.zIndex = cc.macro.MAX_ZINDEX, cc.game.addPersistRootNode(t), this._debugDrawer = t.addComponent(cc.Graphics);
                    var e = new u(this._debugDrawer);
                    e.SetFlags(this.debugDrawFlags), this._world.SetDebugDraw(e);
                }
            }
        });
        cc.js.getset(p.prototype, "enabled", function() {
            return this._enabled;
        }, function(t) {
            if (t && !this._world) {
                var e = new b2.World(new b2.Vec2(0, -10));
                e.SetAllowSleeping(!0), this._world = e, this._initCallback();
            }
            this._enabled = t;
        }), cc.js.getset(p.prototype, "debugDrawFlags", function() {
            return this._debugDrawFlags;
        }, function(t) {
            t && !this._debugDrawFlags ? this._debugDrawer && this._debugDrawer.node && (this._debugDrawer.node.active = !0) : !t && this._debugDrawFlags && this._debugDrawer && this._debugDrawer.node && (this._debugDrawer.node.active = !1), 
            t && (this._checkDebugDrawValid(), this._world.m_debugDraw.SetFlags(t)), this._debugDrawFlags = t, 
            t && (this._checkDebugDrawValid(), this._world.m_debugDraw.SetFlags(t));
        }), cc.js.getset(p.prototype, "gravity", function() {
            if (this._world) {
                var t = this._world.GetGravity();
                return cc.v2(t.x * a, t.y * a);
            }
            return cc.v2();
        }, function(t) {
            this._world && this._world.SetGravity(new b2.Vec2(t.x / a, t.y / a));
        }), cc.PhysicsManager = e.exports = p;
    }, {
        "./CCPhysicsTypes": 158,
        "./platform/CCPhysicsDebugDraw": 179,
        "./utils": 181
    } ],
    158: [ function(t, e) {
        "use strict";
        var i = cc.Enum({
            Static: 0,
            Kinematic: 1,
            Dynamic: 2,
            Animated: 3
        });
        cc.RigidBodyType = i;
        var n = cc.Enum({
            Closest: 0,
            Any: 1,
            AllClosest: 2,
            All: 3
        });
        cc.RayCastType = n, e.exports = {
            BodyType: i,
            ContactType: {
                BEGIN_CONTACT: "begin-contact",
                END_CONTACT: "end-contact",
                PRE_SOLVE: "pre-solve",
                POST_SOLVE: "post-solve"
            },
            RayCastType: n,
            DrawBits: b2.DrawFlags,
            PTM_RATIO: 32,
            ANGLE_TO_PHYSICS_ANGLE: -Math.PI / 180,
            PHYSICS_ANGLE_TO_ANGLE: -180 / Math.PI
        };
    }, {} ],
    159: [ function(t, e) {
        "use strict";
        function i(t, e) {
            var i = e.length;
            return e[t < 0 ? i - -t % i : t % i];
        }
        function n(t, e, n) {
            for (var r = []; e < t; ) e += n.length;
            for (;t <= e; ++t) r.push(i(t, n));
            return r;
        }
        function r(t, e, n) {
            if (s(t, n)) {
                if (c(i(t, n), i(t - 1, n), i(e, n)) && l(i(t, n), i(t + 1, n), i(e, n))) return !1;
            } else if (l(i(t, n), i(t + 1, n), i(e, n)) || c(i(t, n), i(t - 1, n), i(e, n))) return !1;
            if (s(e, n)) {
                if (c(i(e, n), i(e - 1, n), i(t, n)) && l(i(e, n), i(e + 1, n), i(t, n))) return !1;
            } else if (l(i(e, n), i(e + 1, n), i(t, n)) || c(i(e, n), i(e - 1, n), i(t, n))) return !1;
            for (var r = 0; r < n.length; ++r) if ((r + 1) % n.length != t && r != t && (r + 1) % n.length != e && r != e) {
                var o = cc.v2();
                if (p(i(t, n), i(e, n), i(r, n), i(r + 1, n), o)) return !1;
            }
            return !0;
        }
        function s(t, e) {
            return o(t, e);
        }
        function o(t, e, n) {
            if (void 0 === n) {
                var r = t, s = e;
                t = i(r - 1, s), e = i(r, s), n = i(r + 1, s);
            }
            return m(t, e, n) < 0;
        }
        function a(t, e, i) {
            return m(t, e, i) > 0;
        }
        function c(t, e, i) {
            return m(t, e, i) >= 0;
        }
        function l(t, e, i) {
            return m(t, e, i) <= 0;
        }
        function u(t, e) {
            var i = e.x - t.x, n = e.y - t.y;
            return i * i + n * n;
        }
        function h(t) {
            _(t) || t.reverse();
        }
        function _(t) {
            return t.length < 3 || f(t) > 0;
        }
        function f(t) {
            var e, i = 0;
            for (e = 0; e < t.length; e++) {
                var n = (e + 1) % t.length;
                i += t[e].x * t[n].y, i -= t[e].y * t[n].x;
            }
            return i / 2;
        }
        function d(t, e, i, n) {
            var r, s = cc.v2(), o = e.y - t.y, a = t.x - e.x, c = o * t.x + a * t.y, l = n.y - i.y, u = i.x - n.x, h = l * i.x + u * i.y, _ = o * u - l * a;
            return r = _, 0, Math.abs(r - 0) <= 1e-6 || (s.x = (u * c - a * h) / _, s.y = (o * h - l * c) / _), 
            s;
        }
        function p(t, e, i, n, r) {
            if (t == i || t == n || e == i || e == n) return !1;
            var s = t.x, o = t.y, a = e.x, c = e.y, l = i.x, u = i.y, h = n.x, _ = n.y;
            if (Math.max(s, a) < Math.min(l, h) || Math.max(l, h) < Math.min(s, a)) return !1;
            if (Math.max(o, c) < Math.min(u, _) || Math.max(u, _) < Math.min(o, c)) return !1;
            var f = (h - l) * (o - u) - (_ - u) * (s - l), d = (a - s) * (o - u) - (c - o) * (s - l), p = (_ - u) * (a - s) - (h - l) * (c - o);
            return !(Math.abs(p) < 1e-6) && (d /= p, 0 < (f /= p) && f < 1 && 0 < d && d < 1 && (r.x = s + f * (a - s), 
            r.y = o + f * (c - o), !0));
        }
        function m(t, e, i) {
            return t.x * (e.y - i.y) + e.x * (i.y - t.y) + i.x * (t.y - e.y);
        }
        e.exports = {
            ConvexPartition: function t(e) {
                h(e);
                for (var _, f, p, m, v, y, g = [], x = cc.v2(), A = cc.v2(), C = 0, b = 0, S = 0; S < e.length; ++S) if (s(S, e)) {
                    f = p = 1e8;
                    for (var T = 0; T < e.length; ++T) a(i(S - 1, e), i(S, e), i(T, e)) && l(i(S - 1, e), i(S, e), i(T - 1, e)) && (m = d(i(S - 1, e), i(S, e), i(T, e), i(T - 1, e)), 
                    o(i(S + 1, e), i(S, e), m) && (_ = u(i(S, e), m)) < f && (f = _, x = m, C = T)), 
                    a(i(S + 1, e), i(S, e), i(T + 1, e)) && l(i(S + 1, e), i(S, e), i(T, e)) && (m = d(i(S + 1, e), i(S, e), i(T, e), i(T + 1, e)), 
                    a(i(S - 1, e), i(S, e), m) && (_ = u(i(S, e), m)) < p && (p = _, b = T, A = m));
                    if (C == (b + 1) % e.length) {
                        var w = x.add(A).div(2);
                        (v = n(S, b, e)).push(w), (y = n(C, S, e)).push(w);
                    } else {
                        for (var E = 0, B = C; b < C; ) b += e.length;
                        for (T = C; T <= b; ++T) if (r(S, T, e)) {
                            var M = 1 / (u(i(S, e), i(T, e)) + 1);
                            s(T, e) ? l(i(T - 1, e), i(T, e), i(S, e)) && c(i(T + 1, e), i(T, e), i(S, e)) ? M += 3 : M += 2 : M += 1, 
                            M > E && (B = T, E = M);
                        }
                        v = n(S, B, e), y = n(B, S, e);
                    }
                    return (g = g.concat(t(v))).concat(t(y));
                }
                for (g.push(e), S = g.length - 1; S >= 0; S--) 0 == g[S].length && g.splice(S, 0);
                return g;
            },
            ForceCounterClockWise: h,
            IsCounterClockWise: _
        };
    }, {} ],
    160: [ function(t, e) {
        "use strict";
        var i = t("../CCNode").EventType, n = t("./CCPhysicsTypes").PTM_RATIO, r = t("./CCPhysicsTypes").ANGLE_TO_PHYSICS_ANGLE, s = t("./CCPhysicsTypes").PHYSICS_ANGLE_TO_ANGLE, o = t("./utils").getWorldRotation, a = t("./CCPhysicsTypes").BodyType, c = new b2.Vec2(), l = new b2.Vec2(), u = cc.Vec2.ZERO, h = cc.Class({
            name: "cc.RigidBody",
            extends: cc.Component,
            editor: !1,
            properties: {
                _type: a.Dynamic,
                _allowSleep: !0,
                _gravityScale: 1,
                _linearDamping: 0,
                _angularDamping: 0,
                _linearVelocity: cc.v2(0, 0),
                _angularVelocity: 0,
                _fixedRotation: !1,
                enabled: {
                    get: function() {
                        return this._enabled;
                    },
                    set: function() {
                        cc.warnID(8200);
                    },
                    visible: !1,
                    override: !0
                },
                enabledContactListener: {
                    default: !1,
                    tooltip: !1
                },
                bullet: {
                    default: !1,
                    tooltip: !1
                },
                type: {
                    type: a,
                    tooltip: !1,
                    get: function() {
                        return this._type;
                    },
                    set: function(t) {
                        this._type = t, this._b2Body && (t === a.Animated ? this._b2Body.SetType(a.Kinematic) : this._b2Body.SetType(t));
                    }
                },
                allowSleep: {
                    tooltip: !1,
                    get: function() {
                        return this._b2Body ? this._b2Body.IsSleepingAllowed() : this._allowSleep;
                    },
                    set: function(t) {
                        this._allowSleep = t, this._b2Body && this._b2Body.SetSleepingAllowed(t);
                    }
                },
                gravityScale: {
                    tooltip: !1,
                    get: function() {
                        return this._gravityScale;
                    },
                    set: function(t) {
                        this._gravityScale = t, this._b2Body && this._b2Body.SetGravityScale(t);
                    }
                },
                linearDamping: {
                    tooltip: !1,
                    get: function() {
                        return this._linearDamping;
                    },
                    set: function(t) {
                        this._linearDamping = t, this._b2Body && this._b2Body.SetLinearDamping(this._linearDamping);
                    }
                },
                angularDamping: {
                    tooltip: !1,
                    get: function() {
                        return this._angularDamping;
                    },
                    set: function(t) {
                        this._angularDamping = t, this._b2Body && this._b2Body.SetAngularDamping(t);
                    }
                },
                linearVelocity: {
                    tooltip: !1,
                    type: cc.Vec2,
                    get: function() {
                        var t = this._linearVelocity;
                        if (this._b2Body) {
                            var e = this._b2Body.GetLinearVelocity();
                            t.x = e.x * n, t.y = e.y * n;
                        }
                        return t;
                    },
                    set: function(t) {
                        this._linearVelocity = t;
                        var e = this._b2Body;
                        if (e) {
                            var i = e.m_linearVelocity;
                            i.Set(t.x / n, t.y / n), e.SetLinearVelocity(i);
                        }
                    }
                },
                angularVelocity: {
                    tooltip: !1,
                    get: function() {
                        return this._b2Body ? this._b2Body.GetAngularVelocity() * s : this._angularVelocity;
                    },
                    set: function(t) {
                        this._angularVelocity = t, this._b2Body && this._b2Body.SetAngularVelocity(t * r);
                    }
                },
                fixedRotation: {
                    tooltip: !1,
                    get: function() {
                        return this._fixedRotation;
                    },
                    set: function(t) {
                        this._fixedRotation = t, this._b2Body && this._b2Body.SetFixedRotation(t);
                    }
                },
                awake: {
                    visible: !1,
                    tooltip: !1,
                    get: function() {
                        return !!this._b2Body && this._b2Body.IsAwake();
                    },
                    set: function(t) {
                        this._b2Body && this._b2Body.SetAwake(t);
                    }
                },
                awakeOnLoad: {
                    default: !0,
                    tooltip: !1,
                    animatable: !1
                },
                active: {
                    visible: !1,
                    get: function() {
                        return !!this._b2Body && this._b2Body.IsActive();
                    },
                    set: function(t) {
                        this._b2Body && this._b2Body.SetActive(t);
                    }
                }
            },
            getLocalPoint: function(t, e) {
                if (e = e || cc.v2(), this._b2Body) {
                    c.Set(t.x / n, t.y / n);
                    var i = this._b2Body.GetLocalPoint(c, e);
                    e.x = i.x * n, e.y = i.y * n;
                }
                return e;
            },
            getWorldPoint: function(t, e) {
                if (e = e || cc.v2(), this._b2Body) {
                    c.Set(t.x / n, t.y / n);
                    var i = this._b2Body.GetWorldPoint(c, e);
                    e.x = i.x * n, e.y = i.y * n;
                }
                return e;
            },
            getWorldVector: function(t, e) {
                if (e = e || cc.v2(), this._b2Body) {
                    c.Set(t.x / n, t.y / n);
                    var i = this._b2Body.GetWorldVector(c, e);
                    e.x = i.x * n, e.y = i.y * n;
                }
                return e;
            },
            getLocalVector: function(t, e) {
                if (e = e || cc.v2(), this._b2Body) {
                    c.Set(t.x / n, t.y / n);
                    var i = this._b2Body.GetLocalVector(c, e);
                    e.x = i.x * n, e.y = i.y * n;
                }
                return e;
            },
            getWorldPosition: function(t) {
                if (t = t || cc.v2(), this._b2Body) {
                    var e = this._b2Body.GetPosition();
                    t.x = e.x * n, t.y = e.y * n;
                }
                return t;
            },
            getWorldRotation: function() {
                return this._b2Body ? this._b2Body.GetAngle() * s : 0;
            },
            getLocalCenter: function(t) {
                if (t = t || cc.v2(), this._b2Body) {
                    var e = this._b2Body.GetLocalCenter();
                    t.x = e.x * n, t.y = e.y * n;
                }
                return t;
            },
            getWorldCenter: function(t) {
                if (t = t || cc.v2(), this._b2Body) {
                    var e = this._b2Body.GetWorldCenter();
                    t.x = e.x * n, t.y = e.y * n;
                }
                return t;
            },
            getLinearVelocityFromWorldPoint: function(t, e) {
                if (e = e || cc.v2(), this._b2Body) {
                    c.Set(t.x / n, t.y / n);
                    var i = this._b2Body.GetLinearVelocityFromWorldPoint(c, e);
                    e.x = i.x * n, e.y = i.y * n;
                }
                return e;
            },
            getMass: function() {
                return this._b2Body ? this._b2Body.GetMass() : 0;
            },
            getInertia: function() {
                return this._b2Body ? this._b2Body.GetInertia() * n * n : 0;
            },
            getJointList: function() {
                if (!this._b2Body) return [];
                var t = [], e = this._b2Body.GetJointList();
                if (!e) return [];
                t.push(e.joint._joint);
                for (var i = e.prev; i; ) t.push(i.joint._joint), i = i.prev;
                for (var n = e.next; n; ) t.push(n.joint._joint), n = n.next;
                return t;
            },
            applyForce: function(t, e, i) {
                this._b2Body && (c.Set(t.x / n, t.y / n), l.Set(e.x / n, e.y / n), this._b2Body.ApplyForce(c, l, i));
            },
            applyForceToCenter: function(t, e) {
                this._b2Body && (c.Set(t.x / n, t.y / n), this._b2Body.ApplyForceToCenter(c, e));
            },
            applyTorque: function(t, e) {
                this._b2Body && this._b2Body.ApplyTorque(t / n, e);
            },
            applyLinearImpulse: function(t, e, i) {
                this._b2Body && (c.Set(t.x / n, t.y / n), l.Set(e.x / n, e.y / n), this._b2Body.ApplyLinearImpulse(c, l, i));
            },
            applyAngularImpulse: function(t, e) {
                this._b2Body && this._b2Body.ApplyAngularImpulse(t / n / n, e);
            },
            syncPosition: function(t) {
                var e = this._b2Body;
                if (e) {
                    var i, r = this.node.convertToWorldSpaceAR(u);
                    if ((i = this.type === a.Animated ? e.GetLinearVelocity() : e.GetPosition()).x = r.x / n, 
                    i.y = r.y / n, this.type === a.Animated && t) {
                        var s = e.GetPosition(), o = cc.game.config.frameRate;
                        i.x = (i.x - s.x) * o, i.y = (i.y - s.y) * o, e.SetAwake(!0), e.SetLinearVelocity(i);
                    } else e.SetTransformVec(i, e.GetAngle());
                }
            },
            syncRotation: function(t) {
                var e = this._b2Body;
                if (e) {
                    var i = r * o(this.node);
                    if (this.type === a.Animated && t) {
                        var n = e.GetAngle(), s = cc.game.config.frameRate;
                        e.SetAwake(!0), e.SetAngularVelocity((i - n) * s);
                    } else e.SetTransformVec(e.GetPosition(), i);
                }
            },
            resetVelocity: function() {
                var t = this._b2Body;
                if (t) {
                    var e = t.m_linearVelocity;
                    e.Set(0, 0), t.SetLinearVelocity(e), t.SetAngularVelocity(0);
                }
            },
            onEnable: function() {
                this._init();
            },
            onDisable: function() {
                this._destroy();
            },
            _registerNodeEvents: function() {
                var t = this.node;
                t.on(i.POSITION_CHANGED, this._onNodePositionChanged, this), t.on(i.ROTATION_CHANGED, this._onNodeRotationChanged, this), 
                t.on(i.SCALE_CHANGED, this._onNodeScaleChanged, this);
            },
            _unregisterNodeEvents: function() {
                var t = this.node;
                t.off(i.POSITION_CHANGED, this._onNodePositionChanged, this), t.off(i.ROTATION_CHANGED, this._onNodeRotationChanged, this), 
                t.off(i.SCALE_CHANGED, this._onNodeScaleChanged, this);
            },
            _onNodePositionChanged: function() {
                this.syncPosition(!0);
            },
            _onNodeRotationChanged: function() {
                this.syncRotation(!0);
            },
            _onNodeScaleChanged: function() {
                if (this._b2Body) for (var t = this.getComponents(cc.PhysicsCollider), e = 0; e < t.length; e++) t[e].apply();
            },
            _init: function() {
                cc.director.getPhysicsManager().pushDelayEvent(this, "__init", []);
            },
            _destroy: function() {
                cc.director.getPhysicsManager().pushDelayEvent(this, "__destroy", []);
            },
            __init: function() {
                if (!this._inited) {
                    this._registerNodeEvents();
                    var t = new b2.BodyDef();
                    this.type === a.Animated ? t.type = a.Kinematic : t.type = this.type, t.allowSleep = this.allowSleep, 
                    t.gravityScale = this.gravityScale, t.linearDamping = this.linearDamping, t.angularDamping = this.angularDamping;
                    var e = this.linearVelocity;
                    t.linearVelocity = new b2.Vec2(e.x / n, e.y / n), t.angularVelocity = this.angularVelocity * r, 
                    t.fixedRotation = this.fixedRotation, t.bullet = this.bullet;
                    var i = this.node, s = i.convertToWorldSpaceAR(u);
                    t.position = new b2.Vec2(s.x / n, s.y / n), t.angle = -Math.PI / 180 * o(i), t.awake = this.awakeOnLoad, 
                    cc.director.getPhysicsManager()._addBody(this, t), this._inited = !0;
                }
            },
            __destroy: function() {
                this._inited && (cc.director.getPhysicsManager()._removeBody(this), this._unregisterNodeEvents(), 
                this._inited = !1);
            },
            _getBody: function() {
                return this._b2Body;
            }
        });
        cc.RigidBody = e.exports = h;
    }, {
        "../CCNode": 25,
        "./CCPhysicsTypes": 158,
        "./utils": 181
    } ],
    161: [ function(t) {
        "use strict";
        var e = t("../../../external/box2d/box2d");
        for (var i in window.b2 = {}, e) if (-1 === i.indexOf("b2_")) {
            var n = i.replace("b2", "");
            b2[n] = e[i];
        }
        b2.maxPolygonVertices = 8;
    }, {
        "../../../external/box2d/box2d": 327
    } ],
    162: [ function(t, e) {
        "use strict";
        var i = t("../CCPhysicsTypes").PTM_RATIO, n = cc.Class({
            name: "cc.PhysicsBoxCollider",
            extends: cc.PhysicsCollider,
            mixins: [ cc.Collider.Box ],
            editor: {
                menu: !1,
                requireComponent: cc.RigidBody
            },
            _createShape: function(t) {
                var e = Math.abs(t.x), n = Math.abs(t.y), r = this.size.width / 2 / i * e, s = this.size.height / 2 / i * n, o = this.offset.x / i * e, a = this.offset.y / i * n, c = new b2.PolygonShape();
                return c.SetAsBox(r, s, new b2.Vec2(o, a), 0), c;
            }
        });
        cc.PhysicsBoxCollider = e.exports = n;
    }, {
        "../CCPhysicsTypes": 158
    } ],
    163: [ function(t, e) {
        "use strict";
        var i = t("../CCPhysicsTypes").PTM_RATIO, n = cc.Class({
            name: "cc.PhysicsChainCollider",
            extends: cc.PhysicsCollider,
            editor: {
                menu: !1,
                inspector: !1,
                requireComponent: cc.RigidBody
            },
            properties: {
                loop: !1,
                points: {
                    default: function() {
                        return [ cc.v2(-50, 0), cc.v2(50, 0) ];
                    },
                    type: [ cc.Vec2 ]
                },
                threshold: {
                    default: 1,
                    serializable: !1,
                    visible: !1
                }
            },
            _createShape: function(t) {
                for (var e = new b2.ChainShape(), n = this.points, r = [], s = 0; s < n.length; s++) {
                    var o = n[s];
                    r.push(new b2.Vec2(o.x / i * t.x, o.y / i * t.y));
                }
                return this.loop ? e.CreateLoop(r, r.length) : e.CreateChain(r, r.length), e;
            },
            resetInEditor: !1,
            resetPointsByContour: !1
        });
        cc.PhysicsChainCollider = e.exports = n;
    }, {
        "../CCPhysicsTypes": 158
    } ],
    164: [ function(t, e) {
        "use strict";
        var i = t("../CCPhysicsTypes").PTM_RATIO, n = cc.Class({
            name: "cc.PhysicsCircleCollider",
            extends: cc.PhysicsCollider,
            mixins: [ cc.Collider.Circle ],
            editor: {
                menu: !1,
                requireComponent: cc.RigidBody
            },
            _createShape: function(t) {
                var e = Math.abs(t.x), n = Math.abs(t.y), r = this.offset.x / i * e, s = this.offset.y / i * n, o = new b2.CircleShape();
                return o.m_radius = this.radius / i * e, o.m_p = new b2.Vec2(r, s), o;
            }
        });
        cc.PhysicsCircleCollider = e.exports = n;
    }, {
        "../CCPhysicsTypes": 158
    } ],
    165: [ function(t, e) {
        "use strict";
        var i = t("../CCPhysicsTypes").PTM_RATIO, n = t("../utils").getWorldScale, r = cc.Class({
            name: "cc.PhysicsCollider",
            extends: cc.Collider,
            ctor: function() {
                this._fixtures = [], this._shapes = [], this._inited = !1, this._rect = cc.rect();
            },
            properties: {
                _density: 1,
                _sensor: !1,
                _friction: .2,
                _restitution: 0,
                density: {
                    tooltip: !1,
                    get: function() {
                        return this._density;
                    },
                    set: function(t) {
                        this._density = t;
                    }
                },
                sensor: {
                    tooltip: !1,
                    get: function() {
                        return this._sensor;
                    },
                    set: function(t) {
                        this._sensor = t;
                    }
                },
                friction: {
                    tooltip: !1,
                    get: function() {
                        return this._friction;
                    },
                    set: function(t) {
                        this._friction = t;
                    }
                },
                restitution: {
                    tooltip: !1,
                    get: function() {
                        return this._restitution;
                    },
                    set: function(t) {
                        this._restitution = t;
                    }
                },
                body: {
                    default: null,
                    type: cc.RigidBody,
                    visible: !1
                }
            },
            onDisable: function() {
                this._destroy();
            },
            onEnable: function() {
                this._init();
            },
            start: function() {
                this._init();
            },
            _getFixtureIndex: function(t) {
                return this._fixtures.indexOf(t);
            },
            _init: function() {
                cc.director.getPhysicsManager().pushDelayEvent(this, "__init", []);
            },
            _destroy: function() {
                cc.director.getPhysicsManager().pushDelayEvent(this, "__destroy", []);
            },
            __init: function() {
                if (!this._inited) {
                    var t = this.body || this.getComponent(cc.RigidBody);
                    if (t) {
                        var e = t._getBody();
                        if (e) {
                            var i = t.node, r = n(i);
                            this._scale = r;
                            var s = 0 === r.x && 0 === r.y ? [] : this._createShape(r);
                            s instanceof Array || (s = [ s ]);
                            for (var o = 1 << i.groupIndex, a = 0, c = cc.game.collisionMatrix[i.groupIndex], l = 0; l < c.length; l++) c[l] && (a |= 1 << l);
                            for (var u = {
                                categoryBits: o,
                                maskBits: a,
                                groupIndex: 0
                            }, h = cc.director.getPhysicsManager(), _ = 0; _ < s.length; _++) {
                                var f = s[_], d = new b2.FixtureDef();
                                d.density = this.density, d.isSensor = this.sensor, d.friction = this.friction, 
                                d.restitution = this.restitution, d.shape = f, d.filter = u;
                                var p = e.CreateFixture(d);
                                p.collider = this, t.enabledContactListener && h._registerContactFixture(p), this._shapes.push(f), 
                                this._fixtures.push(p);
                            }
                            this.body = t, this._inited = !0;
                        }
                    }
                }
            },
            __destroy: function() {
                if (this._inited) {
                    for (var t = this._fixtures, e = this.body._getBody(), i = cc.director.getPhysicsManager(), n = t.length - 1; n >= 0; n--) {
                        var r = t[n];
                        r.collider = null, i._unregisterContactFixture(r), e && e.DestroyFixture(r);
                    }
                    this.body = null, this._fixtures.length = 0, this._shapes.length = 0, this._inited = !1;
                }
            },
            _createShape: function() {},
            apply: function() {
                this._destroy(), this._init();
            },
            getAABB: function() {
                for (var t = 1e7, e = 1e7, n = -1e7, r = -1e7, s = this._fixtures, o = 0; o < s.length; o++) for (var a = s[o], c = a.GetShape().GetChildCount(), l = 0; l < c; l++) {
                    var u = a.GetAABB(l);
                    u.lowerBound.x < t && (t = u.lowerBound.x), u.lowerBound.y < e && (e = u.lowerBound.y), 
                    u.upperBound.x > n && (n = u.upperBound.x), u.upperBound.y > r && (r = u.upperBound.y);
                }
                t *= i, e *= i, n *= i, r *= i;
                var h = this._rect;
                return h.x = t, h.y = e, h.width = n - t, h.height = r - e, h;
            }
        });
        cc.PhysicsCollider = e.exports = r;
    }, {
        "../CCPhysicsTypes": 158,
        "../utils": 181
    } ],
    166: [ function(t, e) {
        "use strict";
        var i = t("../CCPhysicsTypes").PTM_RATIO, n = t("../CCPolygonSeparator"), r = cc.Class({
            name: "cc.PhysicsPolygonCollider",
            extends: cc.PhysicsCollider,
            mixins: [ cc.Collider.Polygon ],
            editor: {
                menu: !1,
                inspector: !1,
                requireComponent: cc.RigidBody
            },
            _createShape: function(t) {
                var e = [], r = this.points;
                r.length > 0 && r[0].equals(r[r.length - 1]) && (r.length -= 1);
                for (var s = n.ConvexPartition(r), o = this.offset, a = 0; a < s.length; a++) {
                    for (var c = s[a], l = null, u = [], h = null, _ = 0, f = c.length; _ < f; _++) {
                        l || (l = new b2.PolygonShape());
                        var d = c[_], p = (d.x + o.x) / i * t.x, m = (d.y + o.y) / i * t.y, v = new b2.Vec2(p, m);
                        u.push(v), h || (h = v), u.length === b2.maxPolygonVertices && (l.Set(u, u.length), 
                        e.push(l), l = null, _ < f - 1 && (u = [ h, u[u.length - 1] ]));
                    }
                    l && (l.Set(u, u.length), e.push(l));
                }
                return e;
            }
        });
        cc.PhysicsPolygonCollider = e.exports = r;
    }, {
        "../CCPhysicsTypes": 158,
        "../CCPolygonSeparator": 159
    } ],
    167: [ function(t) {
        "use strict";
        t("./box2d-adapter"), t("./CCPhysicsManager"), t("./CCRigidBody"), t("./CCPhysicsContact"), 
        t("./collider/CCPhysicsCollider"), t("./collider/CCPhysicsChainCollider"), t("./collider/CCPhysicsCircleCollider"), 
        t("./collider/CCPhysicsBoxCollider"), t("./collider/CCPhysicsPolygonCollider"), 
        t("./joint/CCJoint"), t("./joint/CCDistanceJoint"), t("./joint/CCRevoluteJoint"), 
        t("./joint/CCMouseJoint"), t("./joint/CCMotorJoint"), t("./joint/CCPrismaticJoint"), 
        t("./joint/CCWeldJoint"), t("./joint/CCWheelJoint"), t("./joint/CCRopeJoint"), t("./platform/CCPhysicsContactListner"), 
        t("./platform/CCPhysicsAABBQueryCallback"), t("./platform/CCPhysicsRayCastCallback");
    }, {
        "./CCPhysicsContact": 156,
        "./CCPhysicsManager": 157,
        "./CCRigidBody": 160,
        "./box2d-adapter": 161,
        "./collider/CCPhysicsBoxCollider": 162,
        "./collider/CCPhysicsChainCollider": 163,
        "./collider/CCPhysicsCircleCollider": 164,
        "./collider/CCPhysicsCollider": 165,
        "./collider/CCPhysicsPolygonCollider": 166,
        "./joint/CCDistanceJoint": 168,
        "./joint/CCJoint": 169,
        "./joint/CCMotorJoint": 170,
        "./joint/CCMouseJoint": 171,
        "./joint/CCPrismaticJoint": 172,
        "./joint/CCRevoluteJoint": 173,
        "./joint/CCRopeJoint": 174,
        "./joint/CCWeldJoint": 175,
        "./joint/CCWheelJoint": 176,
        "./platform/CCPhysicsAABBQueryCallback": 177,
        "./platform/CCPhysicsContactListner": 178,
        "./platform/CCPhysicsRayCastCallback": 180
    } ],
    168: [ function(t, e) {
        "use strict";
        var i = t("../CCPhysicsTypes").PTM_RATIO, n = cc.Class({
            name: "cc.DistanceJoint",
            extends: cc.Joint,
            editor: !1,
            properties: {
                _distance: 1,
                _frequency: 0,
                _dampingRatio: 0,
                distance: {
                    tooltip: !1,
                    get: function() {
                        return this._distance;
                    },
                    set: function(t) {
                        this._distance = t, this._joint && this._joint.SetLength(t);
                    }
                },
                frequency: {
                    tooltip: !1,
                    get: function() {
                        return this._frequency;
                    },
                    set: function(t) {
                        this._frequency = t, this._joint && this._joint.SetFrequency(t);
                    }
                },
                dampingRatio: {
                    tooltip: !1,
                    get: function() {
                        return this._dampingRatio;
                    },
                    set: function(t) {
                        this._dampingRatio = t, this._joint && this._joint.SetDampingRatio(t);
                    }
                }
            },
            _createJointDef: function() {
                var t = new b2.DistanceJointDef();
                return t.localAnchorA = new b2.Vec2(this.anchor.x / i, this.anchor.y / i), t.localAnchorB = new b2.Vec2(this.connectedAnchor.x / i, this.connectedAnchor.y / i), 
                t.length = this.distance / i, t.dampingRatio = this.dampingRatio, t.frequencyHz = this.frequency, 
                t;
            }
        });
        cc.DistanceJoint = e.exports = n;
    }, {
        "../CCPhysicsTypes": 158
    } ],
    169: [ function(t, e) {
        "use strict";
        var i = t("../CCPhysicsTypes").PTM_RATIO, n = cc.Class({
            name: "cc.Joint",
            extends: cc.Component,
            editor: {
                requireComponent: cc.RigidBody
            },
            properties: {
                anchor: {
                    default: cc.v2(0, 0),
                    tooltip: !1
                },
                connectedAnchor: {
                    default: cc.v2(0, 0),
                    tooltip: !1
                },
                connectedBody: {
                    default: null,
                    type: cc.RigidBody,
                    tooltip: !1
                },
                collideConnected: {
                    default: !1,
                    tooltip: !1
                }
            },
            onDisable: function() {
                this._destroy();
            },
            onEnable: function() {
                this._init();
            },
            start: function() {
                this._init();
            },
            apply: function() {
                this._destroy(), this._init();
            },
            getWorldAnchor: function() {
                if (this._joint) {
                    var t = this._joint.GetAnchorA();
                    return cc.v2(t.x * i, t.y * i);
                }
                return cc.Vec2.ZERO;
            },
            getWorldConnectedAnchor: function() {
                if (this._joint) {
                    var t = this._joint.GetAnchorB();
                    return cc.v2(t.x * i, t.y * i);
                }
                return cc.Vec2.ZERO;
            },
            getReactionForce: function(t) {
                var e = cc.v2();
                return this._joint ? this._joint.GetReactionForce(t, e) : e;
            },
            getReactionTorque: function(t) {
                return this._joint ? this._joint.GetReactionTorque(t) : 0;
            },
            _init: function() {
                cc.director.getPhysicsManager().pushDelayEvent(this, "__init", []);
            },
            _destroy: function() {
                cc.director.getPhysicsManager().pushDelayEvent(this, "__destroy", []);
            },
            __init: function() {
                if (!this._inited && (this.body = this.getComponent(cc.RigidBody), this._isValid())) {
                    var t = this._createJointDef();
                    if (!t) return;
                    t.bodyA = this.body._getBody(), t.bodyB = this.connectedBody._getBody(), t.collideConnected = this.collideConnected, 
                    cc.director.getPhysicsManager()._addJoint(this, t), this._inited = !0;
                }
            },
            __destroy: function() {
                this._inited && (cc.director.getPhysicsManager()._removeJoint(this), this._joint = null, 
                this._inited = !1);
            },
            _createJointDef: function() {
                return null;
            },
            _isValid: function() {
                return this.body && this.body._getBody() && this.connectedBody && this.connectedBody._getBody();
            }
        });
        cc.Joint = e.exports = n;
    }, {
        "../CCPhysicsTypes": 158
    } ],
    170: [ function(t, e) {
        "use strict";
        var i = t("../CCPhysicsTypes").PTM_RATIO, n = t("../CCPhysicsTypes").ANGLE_TO_PHYSICS_ANGLE, r = cc.Class({
            name: "cc.MotorJoint",
            extends: cc.Joint,
            editor: !1,
            properties: {
                _linearOffset: cc.v2(0, 0),
                _angularOffset: 0,
                _maxForce: 1,
                _maxTorque: 1,
                _correctionFactor: .3,
                anchor: {
                    tooltip: !1,
                    default: cc.v2(0, 0),
                    override: !0,
                    visible: !1
                },
                connectedAnchor: {
                    tooltip: !1,
                    default: cc.v2(0, 0),
                    override: !0,
                    visible: !1
                },
                linearOffset: {
                    tooltip: !1,
                    get: function() {
                        return this._linearOffset;
                    },
                    set: function(t) {
                        this._linearOffset = t, this._joint && this._joint.SetLinearOffset(new b2.Vec2(t.x / i, t.y / i));
                    }
                },
                angularOffset: {
                    tooltip: !1,
                    get: function() {
                        return this._angularOffset;
                    },
                    set: function(t) {
                        this._angularOffset = t, this._joint && this._joint.SetAngularOffset(t);
                    }
                },
                maxForce: {
                    tooltip: !1,
                    get: function() {
                        return this._maxForce;
                    },
                    set: function(t) {
                        this._maxForce = t, this._joint && this._joint.SetMaxForce(t);
                    }
                },
                maxTorque: {
                    tooltip: !1,
                    get: function() {
                        return this._maxTorque;
                    },
                    set: function(t) {
                        this._maxTorque = t, this._joint && this._joint.SetMaxTorque(t);
                    }
                },
                correctionFactor: {
                    tooltip: !1,
                    get: function() {
                        return this._correctionFactor;
                    },
                    set: function(t) {
                        this._correctionFactor = t, this._joint && this._joint.SetCorrectionFactor(t);
                    }
                }
            },
            _createJointDef: function() {
                var t = new b2.MotorJointDef();
                return t.linearOffset = new b2.Vec2(this.linearOffset.x / i, this.linearOffset.y / i), 
                t.angularOffset = this.angularOffset * n, t.maxForce = this.maxForce, t.maxTorque = this.maxTorque, 
                t.correctionFactor = this.correctionFactor, t;
            }
        });
        cc.MotorJoint = e.exports = r;
    }, {
        "../CCPhysicsTypes": 158
    } ],
    171: [ function(t, e) {
        "use strict";
        var i = t("../CCPhysicsTypes").PTM_RATIO, n = new b2.Vec2(), r = cc.Class({
            name: "cc.MouseJoint",
            extends: cc.Joint,
            editor: !1,
            properties: {
                _target: 1,
                _frequency: 5,
                _dampingRatio: .7,
                _maxForce: 0,
                connectedBody: {
                    default: null,
                    type: cc.RigidBody,
                    visible: !1,
                    override: !0
                },
                collideConnected: {
                    default: !0,
                    visible: !1,
                    override: !0
                },
                anchor: {
                    tooltip: !1,
                    default: cc.v2(0, 0),
                    override: !0,
                    visible: !1
                },
                connectedAnchor: {
                    tooltip: !1,
                    default: cc.v2(0, 0),
                    override: !0,
                    visible: !1
                },
                mouseRegion: {
                    tooltip: !1,
                    default: null,
                    type: cc.Node
                },
                target: {
                    tooltip: !1,
                    visible: !1,
                    get: function() {
                        return this._target;
                    },
                    set: function(t) {
                        this._target = t, this._joint && (n.x = t.x / i, n.y = t.y / i, this._joint.SetTarget(n));
                    }
                },
                frequency: {
                    tooltip: !1,
                    get: function() {
                        return this._frequency;
                    },
                    set: function(t) {
                        this._frequency = t, this._joint && this._joint.SetFrequency(t);
                    }
                },
                dampingRatio: {
                    tooltip: !1,
                    get: function() {
                        return this._dampingRatio;
                    },
                    set: function(t) {
                        this._dampingRatio = t, this._joint && this._joint.SetDampingRatio(t);
                    }
                },
                maxForce: {
                    tooltip: !1,
                    visible: !1,
                    get: function() {
                        return this._maxForce;
                    },
                    set: function(t) {
                        this._maxForce = t, this._joint && this._joint.SetMaxForce(t);
                    }
                }
            },
            onLoad: function() {
                var t = this.mouseRegion || this.node;
                t.on(cc.Node.EventType.TOUCH_START, this.onTouchBegan, this), t.on(cc.Node.EventType.TOUCH_MOVE, this.onTouchMove, this), 
                t.on(cc.Node.EventType.TOUCH_END, this.onTouchEnd, this), t.on(cc.Node.EventType.TOUCH_CANCEL, this.onTouchEnd, this);
            },
            onEnable: function() {},
            start: function() {},
            onTouchBegan: function(t) {
                var e = cc.director.getPhysicsManager(), i = this._pressPoint = t.touch.getLocation();
                cc.Camera && cc.Camera.main && (i = cc.Camera.main.getScreenToWorldPoint(i));
                var n = e.testPoint(i);
                n && ((this.connectedBody = n.body).awake = !0, this.maxForce = 1e3 * this.connectedBody.getMass(), 
                this.target = i, this._init());
            },
            onTouchMove: function(t) {
                this._pressPoint = t.touch.getLocation();
            },
            onTouchEnd: function() {
                this._destroy(), this._pressPoint = null;
            },
            _createJointDef: function() {
                var t = new b2.MouseJointDef();
                return n.x = this.target.x / i, n.y = this.target.y / i, t.target = n, t.maxForce = this.maxForce, 
                t.dampingRatio = this.dampingRatio, t.frequencyHz = this.frequency, t;
            },
            update: function() {
                if (this._pressPoint && this._isValid()) {
                    var t = cc.Camera.findCamera(this.node);
                    this.target = t ? t.getScreenToWorldPoint(this._pressPoint) : this._pressPoint;
                }
            }
        });
        cc.MouseJoint = e.exports = r;
    }, {
        "../CCPhysicsTypes": 158
    } ],
    172: [ function(t, e) {
        "use strict";
        var i = t("../CCPhysicsTypes").PTM_RATIO, n = t("../CCPhysicsTypes").ANGLE_TO_PHYSICS_ANGLE, r = cc.Class({
            name: "cc.PrismaticJoint",
            extends: cc.Joint,
            editor: !1,
            properties: {
                localAxisA: {
                    default: cc.v2(1, 0),
                    tooltip: !1
                },
                referenceAngle: {
                    default: 0,
                    tooltip: !1
                },
                enableLimit: {
                    default: !1,
                    tooltip: !1
                },
                enableMotor: {
                    default: !1,
                    tooltip: !1
                },
                lowerLimit: {
                    default: 0,
                    tooltip: !1
                },
                upperLimit: {
                    default: 0,
                    tooltip: !1
                },
                _maxMotorForce: 0,
                _motorSpeed: 0,
                maxMotorForce: {
                    tooltip: !1,
                    get: function() {
                        return this._maxMotorForce;
                    },
                    set: function(t) {
                        this._maxMotorForce = t, this._joint && this._joint.SetMaxMotorForce(t);
                    }
                },
                motorSpeed: {
                    tooltip: !1,
                    get: function() {
                        return this._motorSpeed;
                    },
                    set: function(t) {
                        this._motorSpeed = t, this._joint && this._joint.SetMotorSpeed(t);
                    }
                }
            },
            _createJointDef: function() {
                var t = new b2.PrismaticJointDef();
                return t.localAnchorA = new b2.Vec2(this.anchor.x / i, this.anchor.y / i), t.localAnchorB = new b2.Vec2(this.connectedAnchor.x / i, this.connectedAnchor.y / i), 
                t.localAxisA = new b2.Vec2(this.localAxisA.x, this.localAxisA.y), t.referenceAngle = this.referenceAngle * n, 
                t.enableLimit = this.enableLimit, t.lowerTranslation = this.lowerLimit / i, t.upperTranslation = this.upperLimit / i, 
                t.enableMotor = this.enableMotor, t.maxMotorForce = this.maxMotorForce, t.motorSpeed = this.motorSpeed, 
                t;
            }
        });
        cc.PrismaticJoint = e.exports = r;
    }, {
        "../CCPhysicsTypes": 158
    } ],
    173: [ function(t, e) {
        "use strict";
        var i = t("../CCPhysicsTypes").PTM_RATIO, n = t("../CCPhysicsTypes").ANGLE_TO_PHYSICS_ANGLE, r = t("../CCPhysicsTypes").PHYSICS_ANGLE_TO_ANGLE, s = cc.Class({
            name: "cc.RevoluteJoint",
            extends: cc.Joint,
            editor: !1,
            properties: {
                _maxMotorTorque: 0,
                _motorSpeed: 0,
                _enableLimit: !1,
                _enableMotor: !1,
                referenceAngle: {
                    default: 0,
                    tooltip: !1
                },
                lowerAngle: {
                    default: 0,
                    tooltip: !1
                },
                upperAngle: {
                    default: 0,
                    tooltip: !1
                },
                maxMotorTorque: {
                    tooltip: !1,
                    get: function() {
                        return this._maxMotorTorque;
                    },
                    set: function(t) {
                        this._maxMotorTorque = t, this._joint && this._joint.SetMaxMotorTorque(t);
                    }
                },
                motorSpeed: {
                    tooltip: !1,
                    get: function() {
                        return this._motorSpeed;
                    },
                    set: function(t) {
                        this._motorSpeed = t, this._joint && this._joint.SetMotorSpeed(t * n);
                    }
                },
                enableLimit: {
                    tooltip: !1,
                    get: function() {
                        return this._enableLimit;
                    },
                    set: function(t) {
                        this._enableLimit = t, this._joint && this._joint.EnableLimit(t);
                    }
                },
                enableMotor: {
                    tooltip: !1,
                    get: function() {
                        return this._enableMotor;
                    },
                    set: function(t) {
                        this._enableMotor = t, this._joint && this._joint.EnableMotor(t);
                    }
                }
            },
            getJointAngle: function() {
                return this._joint ? this._joint.GetJointAngle() * r : 0;
            },
            setLimits: function(t, e) {
                if (this._joint) return this._joint.SetLimits(t * n, e * n);
            },
            _createJointDef: function() {
                var t = new b2.RevoluteJointDef();
                return t.localAnchorA = new b2.Vec2(this.anchor.x / i, this.anchor.y / i), t.localAnchorB = new b2.Vec2(this.connectedAnchor.x / i, this.connectedAnchor.y / i), 
                t.lowerAngle = this.upperAngle * n, t.upperAngle = this.lowerAngle * n, t.maxMotorTorque = this.maxMotorTorque, 
                t.motorSpeed = this.motorSpeed * n, t.enableLimit = this.enableLimit, t.enableMotor = this.enableMotor, 
                t.referenceAngle = this.referenceAngle * n, t;
            }
        });
        cc.RevoluteJoint = e.exports = s;
    }, {
        "../CCPhysicsTypes": 158
    } ],
    174: [ function(t, e) {
        "use strict";
        var i = t("../CCPhysicsTypes").PTM_RATIO, n = cc.Class({
            name: "cc.RopeJoint",
            extends: cc.Joint,
            editor: !1,
            properties: {
                _maxLength: 1,
                maxLength: {
                    tooltip: !1,
                    get: function() {
                        return this._maxLength;
                    },
                    set: function(t) {
                        this._maxLength = t, this._joint && this._joint.SetMaxLength(t);
                    }
                }
            },
            _createJointDef: function() {
                var t = new b2.RopeJointDef();
                return t.localAnchorA = new b2.Vec2(this.anchor.x / i, this.anchor.y / i), t.localAnchorB = new b2.Vec2(this.connectedAnchor.x / i, this.connectedAnchor.y / i), 
                t.maxLength = this.maxLength / i, t;
            }
        });
        cc.RopeJoint = e.exports = n;
    }, {
        "../CCPhysicsTypes": 158
    } ],
    175: [ function(t, e) {
        "use strict";
        var i = t("../CCPhysicsTypes").PTM_RATIO, n = t("../CCPhysicsTypes").ANGLE_TO_PHYSICS_ANGLE, r = cc.Class({
            name: "cc.WeldJoint",
            extends: cc.Joint,
            editor: !1,
            properties: {
                referenceAngle: {
                    default: 0,
                    tooltip: !1
                },
                _frequency: 0,
                _dampingRatio: 0,
                frequency: {
                    tooltip: !1,
                    get: function() {
                        return this._frequency;
                    },
                    set: function(t) {
                        this._frequency = t, this._joint && this._joint.SetFrequency(t);
                    }
                },
                dampingRatio: {
                    tooltip: !1,
                    get: function() {
                        return this._dampingRatio;
                    },
                    set: function(t) {
                        this._dampingRatio = t, this._joint && this._joint.SetDampingRatio(t);
                    }
                }
            },
            _createJointDef: function() {
                var t = new b2.WeldJointDef();
                return t.localAnchorA = new b2.Vec2(this.anchor.x / i, this.anchor.y / i), t.localAnchorB = new b2.Vec2(this.connectedAnchor.x / i, this.connectedAnchor.y / i), 
                t.referenceAngle = this.referenceAngle * n, t.frequencyHz = this.frequency, t.dampingRatio = this.dampingRatio, 
                t;
            }
        });
        cc.WeldJoint = e.exports = r;
    }, {
        "../CCPhysicsTypes": 158
    } ],
    176: [ function(t, e) {
        "use strict";
        var i = t("../CCPhysicsTypes").PTM_RATIO, n = t("../CCPhysicsTypes").ANGLE_TO_PHYSICS_ANGLE, r = cc.Class({
            name: "cc.WheelJoint",
            extends: cc.Joint,
            editor: !1,
            properties: {
                _maxMotorTorque: 0,
                _motorSpeed: 0,
                _enableMotor: !1,
                _frequency: 2,
                _dampingRatio: .7,
                localAxisA: {
                    default: cc.v2(1, 0),
                    tooltip: !1
                },
                maxMotorTorque: {
                    tooltip: !1,
                    get: function() {
                        return this._maxMotorTorque;
                    },
                    set: function(t) {
                        this._maxMotorTorque = t, this._joint && this._joint.SetMaxMotorTorque(t);
                    }
                },
                motorSpeed: {
                    tooltip: !1,
                    get: function() {
                        return this._motorSpeed;
                    },
                    set: function(t) {
                        this._motorSpeed = t, this._joint && this._joint.SetMotorSpeed(t * n);
                    }
                },
                enableMotor: {
                    tooltip: !1,
                    get: function() {
                        return this._enableMotor;
                    },
                    set: function(t) {
                        this._enableMotor = t, this._joint && this._joint.EnableMotor(t);
                    }
                },
                frequency: {
                    tooltip: !1,
                    get: function() {
                        return this._frequency;
                    },
                    set: function(t) {
                        this._frequency = t, this._joint && this._joint.SetSpringFrequencyHz(t);
                    }
                },
                dampingRatio: {
                    tooltip: !1,
                    get: function() {
                        return this._dampingRatio;
                    },
                    set: function(t) {
                        this._dampingRatio = t, this._joint && this._joint.SetDampingRatio(t);
                    }
                }
            },
            _createJointDef: function() {
                var t = new b2.WheelJointDef();
                return t.localAnchorA = new b2.Vec2(this.anchor.x / i, this.anchor.y / i), t.localAnchorB = new b2.Vec2(this.connectedAnchor.x / i, this.connectedAnchor.y / i), 
                t.localAxisA = new b2.Vec2(this.localAxisA.x, this.localAxisA.y), t.maxMotorTorque = this.maxMotorTorque, 
                t.motorSpeed = this.motorSpeed * n, t.enableMotor = this.enableMotor, t.dampingRatio = this.dampingRatio, 
                t.frequencyHz = this.frequency, t;
            }
        });
        cc.WheelJoint = e.exports = r;
    }, {
        "../CCPhysicsTypes": 158
    } ],
    177: [ function(t, e) {
        "use strict";
        var i = t("../CCPhysicsTypes").BodyType;
        function n() {
            this._point = new b2.Vec2(), this._isPoint = !1, this._fixtures = [];
        }
        n.prototype.init = function(t) {
            t ? (this._isPoint = !0, this._point.x = t.x, this._point.y = t.y) : this._isPoint = !1, 
            this._fixtures.length = 0;
        }, n.prototype.ReportFixture = function(t) {
            if (t.GetBody().GetType() === i.Dynamic) if (this._isPoint) {
                if (t.TestPoint(this._point)) return this._fixtures.push(t), !1;
            } else this._fixtures.push(t);
            return !0;
        }, n.prototype.getFixture = function() {
            return this._fixtures[0];
        }, n.prototype.getFixtures = function() {
            return this._fixtures;
        }, cc.PhysicsAABBQueryCallback = e.exports = n;
    }, {
        "../CCPhysicsTypes": 158
    } ],
    178: [ function(t, e) {
        "use strict";
        function i() {
            this._contactFixtures = [];
        }
        i.prototype.setBeginContact = function(t) {
            this._BeginContact = t;
        }, i.prototype.setEndContact = function(t) {
            this._EndContact = t;
        }, i.prototype.setPreSolve = function(t) {
            this._PreSolve = t;
        }, i.prototype.setPostSolve = function(t) {
            this._PostSolve = t;
        }, i.prototype.BeginContact = function(t) {
            if (this._BeginContact) {
                var e = t.GetFixtureA(), i = t.GetFixtureB(), n = this._contactFixtures;
                t._shouldReport = !1, -1 === n.indexOf(e) && -1 === n.indexOf(i) || (t._shouldReport = !0, 
                this._BeginContact(t));
            }
        }, i.prototype.EndContact = function(t) {
            this._EndContact && t._shouldReport && (t._shouldReport = !1, this._EndContact(t));
        }, i.prototype.PreSolve = function(t, e) {
            this._PreSolve && t._shouldReport && this._PreSolve(t, e);
        }, i.prototype.PostSolve = function(t, e) {
            this._PostSolve && t._shouldReport && this._PostSolve(t, e);
        }, i.prototype.registerContactFixture = function(t) {
            this._contactFixtures.push(t);
        }, i.prototype.unregisterContactFixture = function(t) {
            cc.js.array.remove(this._contactFixtures, t);
        }, cc.PhysicsContactListener = e.exports = i;
    }, {} ],
    179: [ function(t, e) {
        "use strict";
        var i = t("../CCPhysicsTypes").PTM_RATIO, n = cc.v2(), r = cc.Color.GREEN, s = cc.Color.RED;
        function o(t) {
            b2.Draw.call(this), this._drawer = t, this._xf = this._dxf = new b2.Transform();
        }
        cc.js.extend(o, b2.Draw), cc.js.mixin(o.prototype, {
            _DrawPolygon: function(t, e) {
                for (var r = this._drawer, s = 0; s < e; s++) {
                    b2.Transform.MulXV(this._xf, t[s], n);
                    var o = n.x * i, a = n.y * i;
                    0 === s ? r.moveTo(o, a) : r.lineTo(o, a);
                }
                r.close();
            },
            DrawPolygon: function(t, e, i) {
                this._applyStrokeColor(i), this._DrawPolygon(t, e), this._drawer.stroke();
            },
            DrawSolidPolygon: function(t, e, i) {
                this._applyFillColor(i), this._DrawPolygon(t, e), this._drawer.fill(), this._drawer.stroke();
            },
            _DrawCircle: function(t, e) {
                var n = this._xf.p;
                this._drawer.circle((t.x + n.x) * i, (t.y + n.y) * i, e * i);
            },
            DrawCircle: function(t, e, i) {
                this._applyStrokeColor(i), this._DrawCircle(t, e), this._drawer.stroke();
            },
            DrawSolidCircle: function(t, e, i, n) {
                this._applyFillColor(n), this._DrawCircle(t, e), this._drawer.fill();
            },
            DrawSegment: function(t, e, r) {
                var s = this._drawer;
                if (t.x === e.x && t.y === e.y) return this._applyFillColor(r), this._DrawCircle(t, 2 / i), 
                void s.fill();
                this._applyStrokeColor(r), b2.Transform.MulXV(this._xf, t, n), s.moveTo(n.x * i, n.y * i), 
                b2.Transform.MulXV(this._xf, e, n), s.lineTo(n.x * i, n.y * i), s.stroke();
            },
            DrawTransform: function(t) {
                var e = this._drawer;
                e.strokeColor = s, n.x = n.y = 0, b2.Transform.MulXV(t, n, n), e.moveTo(n.x * i, n.y * i), 
                n.x = 1, n.y = 0, b2.Transform.MulXV(t, n, n), e.lineTo(n.x * i, n.y * i), e.stroke(), 
                e.strokeColor = r, n.x = n.y = 0, b2.Transform.MulXV(t, n, n), e.moveTo(n.x * i, n.y * i), 
                n.x = 0, n.y = 1, b2.Transform.MulXV(t, n, n), e.lineTo(n.x * i, n.y * i), e.stroke();
            },
            DrawPoint: function() {},
            _applyStrokeColor: function(t) {
                var e = this._drawer.strokeColor;
                e.r = 255 * t.r, e.g = 255 * t.g, e.b = 255 * t.b, e.a = 150, this._drawer.strokeColor = e;
            },
            _applyFillColor: function(t) {
                var e = this._drawer.fillColor;
                e.r = 255 * t.r, e.g = 255 * t.g, e.b = 255 * t.b, e.a = 150, this._drawer.fillColor = e;
            },
            PushTransform: function(t) {
                this._xf = t;
            },
            PopTransform: function() {
                this._xf = this._dxf;
            }
        }), e.exports = o;
    }, {
        "../CCPhysicsTypes": 158
    } ],
    180: [ function(t, e) {
        "use strict";
        function i() {
            this._type = 0, this._fixtures = [], this._points = [], this._normals = [], this._fractions = [];
        }
        i.prototype.init = function(t) {
            this._type = t, this._fixtures.length = 0, this._points.length = 0, this._normals.length = 0, 
            this._fractions.length = 0;
        }, i.prototype.ReportFixture = function(t, e, i, n) {
            return 0 === this._type ? (this._fixtures[0] = t, this._points[0] = e, this._normals[0] = i, 
            this._fractions[0] = n, n) : (this._fixtures.push(t), this._points.push(cc.v2(e)), 
            this._normals.push(cc.v2(i)), this._fractions.push(n), 1 === this._type ? 0 : this._type >= 2 ? 1 : n);
        }, i.prototype.getFixtures = function() {
            return this._fixtures;
        }, i.prototype.getPoints = function() {
            return this._points;
        }, i.prototype.getNormals = function() {
            return this._normals;
        }, i.prototype.getFractions = function() {
            return this._fractions;
        }, cc.PhysicsRayCastCallback = e.exports = i;
    }, {} ],
    181: [ function(t, e) {
        "use strict";
        e.exports = {
            getWorldRotation: function(t) {
                for (var e = t.angle, i = t.parent; i.parent; ) e += i.angle, i = i.parent;
                return -e;
            },
            getWorldScale: function(t) {
                for (var e = t.scaleX, i = t.scaleY, n = t.parent; n.parent; ) e *= n.scaleX, i *= n.scaleY, 
                n = n.parent;
                return cc.v2(e, i);
            },
            convertToNodeRotation: function(t, e) {
                e -= -t.angle;
                for (var i = t.parent; i.parent; ) e -= -i.angle, i = i.parent;
                return e;
            }
        };
    }, {} ],
    182: [ function(t, e) {
        "use strict";
        var i = t("./js"), n = t("./CCEnum"), r = t("./utils"), s = (r.isPlainEmptyObj_DEV, 
        r.cloneable_DEV, t("./attribute")), o = s.DELIMETER, a = t("./preprocess-class");
        t("./requiring-frame");
        var c = [ "name", "extends", "mixins", "ctor", "__ctor__", "properties", "statics", "editor", "__ES6__" ];
        function l(t, e) {
            t.indexOf(e) < 0 && t.push(e);
        }
        var u = {
            datas: null,
            push: function(t) {
                if (this.datas) this.datas.push(t); else {
                    this.datas = [ t ];
                    var e = this;
                    setTimeout(function() {
                        e.init();
                    }, 0);
                }
            },
            init: function() {
                var t = this.datas;
                if (t) {
                    for (var e = 0; e < t.length; ++e) {
                        var n = t[e], r = n.cls, s = n.props;
                        "function" == typeof s && (s = s());
                        var o = i.getClassName(r);
                        s ? S(r, o, s, r.$super, n.mixins) : cc.errorID(3633, o);
                    }
                    this.datas = null;
                }
            }
        };
        function h(t, e) {
            l(t.__props__, e);
        }
        function _(t, e, i, n) {
            var r = n.default;
            s.setClassAttr(t, i, "default", r), h(t, i), E(t, n, 0, i);
        }
        function f(t, e, n, r, o) {
            var a = r.get, c = r.set, l = t.prototype, u = !Object.getOwnPropertyDescriptor(l, n);
            a && (E(t, r, 0, n), s.setClassAttr(t, n, "serializable", !1), o || i.get(l, n, a, u, u)), 
            c && (o || i.set(l, n, c, u, u));
        }
        function d(t) {
            return "function" == typeof t ? t() : t;
        }
        function p(t, e, n) {
            for (var r in e) t.hasOwnProperty(r) || n && !n(r) || Object.defineProperty(t, r, i.getPropertyDescriptor(e, r));
        }
        function m(t, e, n, r) {
            var o, a, c = r.__ctor__, l = r.ctor, u = r.__ES6__;
            u ? (o = [ l ], a = l) : (o = c ? [ c ] : A(e, n, r), a = x(o, e, t, r), i.value(a, "extend", function(t) {
                return t.extends = this, T(t);
            }, !0)), i.value(a, "__ctors__", o.length > 0 ? o : null, !0);
            var h = a.prototype;
            if (e && (u || (i.extend(a, e), h = a.prototype), a.$super = e), n) {
                for (var _ = n.length - 1; _ >= 0; _--) {
                    var f = n[_];
                    p(h, f.prototype), p(a, f, function(t) {
                        return f.hasOwnProperty(t) && !0;
                    }), T._isCCClass(f) && p(s.getClassAttrs(a), s.getClassAttrs(f));
                }
                h.constructor = a;
            }
            return u || (h.__initProps__ = g), i.setClassName(t, a), a;
        }
        function v(t, e, n, r) {
            var s = cc.Component, o = cc._RF.peek();
            if (o && i.isChildClassOf(e, s)) {
                if (i.isChildClassOf(o.cls, s)) return cc.errorID(3615), null;
                t = t || o.script;
            }
            var a = m(t, e, n, r);
            if (o) if (i.isChildClassOf(e, s)) {
                var c = o.uuid;
                c && i._setClassId(c, a), o.cls = a;
            } else i.isChildClassOf(o.cls, s) || (o.cls = a);
            return a;
        }
        function y(t, e) {
            var i = null, n = 0, r = 0;
            return function() {
                for (var s = null, a = null, c = null, l = 0; l < e.length; ++l) {
                    var u = e[l], h = u + o + "default";
                    if (h in t) {
                        var _ = t[h];
                        "object" == typeof _ && _ || "function" == typeof _ ? _ instanceof cc.ValueType ? (a || (a = []), 
                        a.push(u, _)) : (c || (c = []), c.push(u, _)) : (s || (s = []), s.push(u, _));
                    }
                }
                n = s ? s.length : 0;
                var f = (r = n + (a ? a.length : 0)) + (c ? c.length : 0);
                i = new Array(f);
                for (var d = 0; d < n; ++d) i[d] = s[d];
                for (var p = n; p < r; ++p) i[p] = a[p - n];
                for (var m = r; m < f; ++m) i[m] = c[m - r];
            }(), function() {
                for (var t = 0; t < n; t += 2) this[i[t]] = i[t + 1];
                for (;t < r; t += 2) this[i[t]] = i[t + 1].clone();
                for (;t < i.length; t += 2) {
                    var e, s = i[t + 1];
                    Array.isArray(s) ? this[i[t]] = [] : (e = "object" == typeof s ? {} : s(), this[i[t]] = e);
                }
            };
        }
        function g(t) {
            var e = s.getClassAttrs(t), i = t.__props__;
            null === i && (u.init(), i = t.__props__);
            var n = y(e, i);
            t.prototype.__initProps__ = n, n.call(this);
        }
        var x = function(t, e, i, n) {
            var r, s = e && b(e, n), o = t.length;
            return r = o > 0 ? s ? 2 === o ? function() {
                this._super = null, this.__initProps__(r), t[0].apply(this, arguments), t[1].apply(this, arguments);
            } : function() {
                this._super = null, this.__initProps__(r);
                for (var e = 0; e < t.length; ++e) t[e].apply(this, arguments);
            } : 3 === o ? function() {
                this.__initProps__(r), t[0].apply(this, arguments), t[1].apply(this, arguments), 
                t[2].apply(this, arguments);
            } : function() {
                this.__initProps__(r);
                for (var t = r.__ctors__, e = 0; e < t.length; ++e) t[e].apply(this, arguments);
            } : function() {
                s && (this._super = null), this.__initProps__(r);
            };
        };
        function A(t, e, i) {
            for (var n, r = [], s = [ t ].concat(e), o = 0; o < s.length; o++) {
                var a = s[o];
                if (a) for (var c = (n = a, T._isCCClass(n) ? n.__ctors__ || [] : [ n ]), u = 0; u < c.length; u++) l(r, c[u]);
            }
            var h = i.ctor;
            return h && r.push(h), r;
        }
        var C = /xyz/.test(function() {
            xyz;
        }) ? /\b\._super\b/ : /.*/;
        function b(t, e) {
            var n = !1;
            for (var r in e) if (!(c.indexOf(r) >= 0)) {
                var s = e[r];
                if ("function" == typeof s) {
                    var o = i.getPropertyDescriptor(t.prototype, r);
                    if (o) {
                        var a = o.value;
                        if ("function" == typeof a) {
                            C.test(s) && (n = !0, e[r] = function(t, e) {
                                return function() {
                                    var i = this._super;
                                    this._super = t;
                                    var n = e.apply(this, arguments);
                                    return this._super = i, n;
                                };
                            }(a, s));
                            continue;
                        }
                    }
                }
            }
            return n;
        }
        function S(t, e, i, n, r, c) {
            if (t.__props__ = [], n && n.__props__ && (t.__props__ = n.__props__.slice()), r) for (var l = 0; l < r.length; ++l) {
                var u = r[l];
                u.__props__ && (t.__props__ = t.__props__.concat(u.__props__.filter(function(e) {
                    return t.__props__.indexOf(e) < 0;
                })));
            }
            if (i) for (var h in a.preprocessAttrs(i, e, t, c), i) {
                var d = i[h];
                "default" in d ? _(t, 0, h, d) : f(t, 0, h, d, c);
            }
            var p = s.getClassAttrs(t);
            t.__values__ = t.__props__.filter(function(t) {
                return !1 !== p[t + o + "serializable"];
            });
        }
        function T(t) {
            var e = (t = t || {}).name, n = t.extends, r = t.mixins, s = v(e, n, r, t);
            e || (e = cc.js.getClassName(s)), s._sealed = !0, n && (n._sealed = !1);
            var o = t.properties;
            "function" == typeof o || n && null === n.__props__ || r && r.some(function(t) {
                return null === t.__props__;
            }) ? (u.push({
                cls: s,
                props: o,
                mixins: r
            }), s.__props__ = s.__values__ = null) : S(s, e, o, n, t.mixins, t.__ES6__);
            var l, h = t.statics;
            if (h) for (l in h) s[l] = h[l];
            for (var _ in t) if (!(c.indexOf(_) >= 0)) {
                var f = t[_];
                a.validateMethodWithProps(f, _, e, s, n) && i.value(s.prototype, _, f, !0, !0);
            }
            var d = t.editor;
            return d && i.isChildClassOf(n, cc.Component) && cc.Component._registerEditorProps(s, d), 
            s;
        }
        /xyz/.test(function() {
            xyz;
        }), T._isCCClass = function(t) {
            return t && t.hasOwnProperty("__ctors__");
        }, T._fastDefine = function(t, e, n) {
            i.setClassName(t, e);
            for (var r = e.__props__ = e.__values__ = Object.keys(n), a = s.getClassAttrs(e), c = 0; c < r.length; c++) {
                var l = r[c];
                a[l + o + "visible"] = !1, a[l + o + "default"] = n[l];
            }
        }, T.Attr = s, T.attr = s.attr, T.getInheritanceChain = function(t) {
            for (var e = []; t = i.getSuper(t); ) t !== Object && e.push(t);
            return e;
        };
        var w = {
            Integer: "Number",
            Float: "Number",
            Boolean: "Boolean",
            String: "String"
        };
        function E(t, e, i, r) {
            var a = null, c = "";
            function l() {
                return c = r + o, a = s.getClassAttrs(t);
            }
            var u = e.type;
            u && (w[u] ? (a || l())[c + "type"] = u : "Object" === u || (u === s.ScriptUuid ? ((a || l())[c + "type"] = "Script", 
            a[c + "ctor"] = cc.ScriptAsset) : "object" == typeof u ? n.isEnum(u) && ((a || l())[c + "type"] = "Enum", 
            a[c + "enumList"] = n.getList(u)) : "function" == typeof u && ((a || l())[c + "type"] = "Object", 
            a[c + "ctor"] = u)));
            function h(t, i) {
                if (t in e) {
                    var n = e[t];
                    typeof n === i && ((a || l())[c + t] = n);
                }
            }
            e.editorOnly && ((a || l())[c + "editorOnly"] = !0), !1 === e.serializable && ((a || l())[c + "serializable"] = !1), 
            h("formerlySerializedAs", "string");
            var _ = e.range;
            _ && Array.isArray(_) && _.length >= 2 && ((a || l())[c + "min"] = _[0], a[c + "max"] = _[1], 
            _.length > 2 && (a[c + "step"] = _[2])), h("min", "number"), h("max", "number"), 
            h("step", "number");
        }
        cc.Class = T, e.exports = {
            isArray: function(t) {
                return t = d(t), Array.isArray(t);
            },
            fastDefine: T._fastDefine,
            getNewValueTypeCode: !1,
            IDENTIFIER_RE: /^[A-Za-z_$][0-9A-Za-z_$]*$/,
            escapeForJS: function(t) {
                return JSON.stringify(t).replace(/\u2028/g, "\\u2028").replace(/\u2029/g, "\\u2029");
            },
            getDefault: d
        };
    }, {
        "./CCEnum": 184,
        "./attribute": 194,
        "./js": 203,
        "./preprocess-class": 204,
        "./requiring-frame": 205,
        "./utils": 206
    } ],
    183: [ function(t, e) {
        "use strict";
        t("./CCClass");
        var i = t("./preprocess-class"), n = t("./js"), r = "__ccclassCache__";
        function s(t) {
            return t;
        }
        function o(t, e) {
            return t[e] || (t[e] = {});
        }
        function a(t) {
            return function(e) {
                return "function" == typeof e ? t(e) : function(i) {
                    return t(i, e);
                };
            };
        }
        function c(t, e) {
            return function(t) {
                return function(i) {
                    return e(i, t);
                };
            };
        }
        var l = c.bind(null, !1);
        function u() {
            return c.bind(null, !1);
        }
        var h = u(), _ = u();
        function f(t) {
            return o(t, r);
        }
        function d(t) {
            var e;
            try {
                e = t();
            } catch (i) {
                return t;
            }
            return "object" != typeof e || null === e ? e : t;
        }
        function p(t) {
            var e;
            try {
                e = new t();
            } catch (i) {
                return {};
            }
            return e;
        }
        function m(t, e, r, s, o, a) {
            var c, l = o && (o.get || o.set);
            s && (c = i.getFullFormOfProperty(s, l));
            var u = e[r], h = n.mixin(u || {}, c || s || {});
            if (l) o.get && (h.get = o.get), o.set && (h.set = o.set); else {
                var _ = void 0;
                if (o) o.initializer && (_ = d(o.initializer)); else {
                    var f = a.default || (a.default = p(t));
                    f.hasOwnProperty(r) && (_ = f[r]);
                }
                h.default = _;
            }
            e[r] = h;
        }
        var v = a(function(t, e) {
            var i = n.getSuper(t);
            i === Object && (i = null);
            var s = {
                name: e,
                extends: i,
                ctor: t,
                __ES6__: !0
            }, o = t[r];
            if (o) {
                var a = o.proto;
                a && n.mixin(s, a), t[r] = void 0;
            }
            return cc.Class(s);
        });
        function y(t, e, i) {
            return t(function(t, n) {
                var r = f(t);
                if (r) {
                    var s = void 0 !== i ? i : n, a = o(r, "proto");
                    o(a, "editor")[e] = s;
                }
            }, e);
        }
        function g(t) {
            return t(s);
        }
        var x = g(a), A = y(l, "requireComponent"), C = g(h), b = y(_, "executionOrder"), S = g(a), T = g(a), w = g(h), E = g(h), B = g(h);
        cc._decorator = e.exports = {
            ccclass: v,
            property: function(t, e, i) {
                var n = null;
                function r(t, e, i) {
                    var r = f(t.constructor);
                    if (r) {
                        var s = o(r, "proto"), a = o(s, "properties");
                        m(t.constructor, a, e, n, i, r);
                    }
                }
                if (void 0 === e) return n = t, r;
                r(t, e, i);
            },
            executeInEditMode: x,
            requireComponent: A,
            menu: C,
            executionOrder: b,
            disallowMultiple: S,
            playOnFocus: T,
            inspector: w,
            icon: E,
            help: B,
            mixins: function() {
                for (var t = [], e = 0; e < arguments.length; e++) t[e] = arguments[e];
                return function(e) {
                    var i = f(e);
                    i && (o(i, "proto").mixins = t);
                };
            }
        };
    }, {
        "./CCClass": 182,
        "./js": 203,
        "./preprocess-class": 204,
        "./utils": 206
    } ],
    184: [ function(t, e) {
        "use strict";
        var i = t("./js");
        function n(t) {
            if ("__enums__" in t) return t;
            i.value(t, "__enums__", null, !0);
            for (var e = -1, n = Object.keys(t), r = 0; r < n.length; r++) {
                var s = n[r], o = t[s];
                if (-1 === o) o = ++e, t[s] = o; else if ("number" == typeof o) e = o; else if ("string" == typeof o && Number.isInteger(parseFloat(s))) continue;
                var a = "" + o;
                s !== a && i.value(t, a, s);
            }
            return t;
        }
        n.isEnum = function(t) {
            return t && t.hasOwnProperty("__enums__");
        }, n.getList = function(t) {
            if (t.__enums__) return t.__enums__;
            var e = t.__enums__ = [];
            for (var i in t) {
                var n = t[i];
                Number.isInteger(n) && e.push({
                    name: i,
                    value: n
                });
            }
            return e.sort(function(t, e) {
                return t.value - e.value;
            }), e;
        }, e.exports = cc.Enum = n;
    }, {
        "./js": 203
    } ],
    185: [ function(t) {
        "use strict";
        var e, i = t("../event-manager"), n = t("./CCInputManager");
        cc.Acceleration = function(t, e, i, n) {
            this.x = t || 0, this.y = e || 0, this.z = i || 0, this.timestamp = n || 0;
        }, n.setAccelerometerEnabled = function(t) {
            var e = this;
            if (e._accelEnabled !== t) {
                e._accelEnabled = t;
                var i = cc.director.getScheduler();
                i.enableForTarget(e), e._accelEnabled ? (e._registerAccelerometerEvent(), e._accelCurTime = 0, 
                i.scheduleUpdate(e)) : (e._unregisterAccelerometerEvent(), e._accelCurTime = 0, 
                i.unscheduleUpdate(e));
            }
        }, n.setAccelerometerInterval = function(t) {
            this._accelInterval !== t && (this._accelInterval = t);
        }, n._registerKeyboardEvent = function() {
            cc.game.canvas.addEventListener("keydown", function(t) {
                i.dispatchEvent(new cc.Event.EventKeyboard(t.keyCode, !0)), t.stopPropagation(), 
                t.preventDefault();
            }, !1), cc.game.canvas.addEventListener("keyup", function(t) {
                i.dispatchEvent(new cc.Event.EventKeyboard(t.keyCode, !1)), t.stopPropagation(), 
                t.preventDefault();
            }, !1);
        }, n._registerAccelerometerEvent = function() {
            var t = window, i = this;
            i._acceleration = new cc.Acceleration(), i._accelDeviceEvent = t.DeviceMotionEvent || t.DeviceOrientationEvent, 
            cc.sys.browserType === cc.sys.BROWSER_TYPE_MOBILE_QQ && (i._accelDeviceEvent = window.DeviceOrientationEvent);
            var n = i._accelDeviceEvent === t.DeviceMotionEvent ? "devicemotion" : "deviceorientation", r = navigator.userAgent;
            (/Android/.test(r) || /Adr/.test(r) && cc.sys.browserType === cc.BROWSER_TYPE_UC) && (i._minus = -1), 
            e = i.didAccelerate.bind(i), t.addEventListener(n, e, !1);
        }, n._unregisterAccelerometerEvent = function() {
            var t = window, i = this._accelDeviceEvent === t.DeviceMotionEvent ? "devicemotion" : "deviceorientation";
            e && t.removeEventListener(i, e, !1);
        }, n.didAccelerate = function(t) {
            var e = this, i = window;
            if (e._accelEnabled) {
                var n, r, s, o = e._acceleration;
                if (e._accelDeviceEvent === window.DeviceMotionEvent) {
                    var a = t.accelerationIncludingGravity;
                    n = e._accelMinus * a.x * .1, r = e._accelMinus * a.y * .1, s = .1 * a.z;
                } else n = t.gamma / 90 * .981, r = -t.beta / 90 * .981, s = t.alpha / 90 * .981;
                if (cc.view._isRotated) {
                    var c = n;
                    n = -r, r = c;
                }
                o.x = n, o.y = r, o.z = s, o.timestamp = t.timeStamp || Date.now();
                var l = o.x;
                90 === i.orientation ? (o.x = -o.y, o.y = l) : -90 === i.orientation ? (o.x = o.y, 
                o.y = -l) : 180 === i.orientation && (o.x = -o.x, o.y = -o.y), cc.sys.os === cc.sys.OS_ANDROID && cc.sys.browserType !== cc.sys.BROWSER_TYPE_MOBILE_QQ && (o.x = -o.x, 
                o.y = -o.y);
            }
        };
    }, {
        "../event-manager": 127,
        "./CCInputManager": 186
    } ],
    186: [ function(t, e) {
        "use strict";
        var i = t("./CCMacro"), n = t("./CCSys"), r = t("../event-manager"), s = i.TOUCH_TIMEOUT, o = cc.v2(), a = {
            _mousePressed: !1,
            _isRegisterEvent: !1,
            _preTouchPoint: cc.v2(0, 0),
            _prevMousePoint: cc.v2(0, 0),
            _preTouchPool: [],
            _preTouchPoolPointer: 0,
            _touches: [],
            _touchesIntegerDict: {},
            _indexBitsUsed: 0,
            _maxTouches: 8,
            _accelEnabled: !1,
            _accelInterval: .2,
            _accelMinus: 1,
            _accelCurTime: 0,
            _acceleration: null,
            _accelDeviceEvent: null,
            _canvasBoundingRect: {
                left: 0,
                top: 0,
                adjustedLeft: 0,
                adjustedTop: 0,
                width: 0,
                height: 0
            },
            _getUnUsedIndex: function() {
                for (var t = this._indexBitsUsed, e = cc.sys.now(), i = 0; i < this._maxTouches; i++) {
                    if (!(1 & t)) return this._indexBitsUsed |= 1 << i, i;
                    var n = this._touches[i];
                    if (e - n._lastModified > s) return this._removeUsedIndexBit(i), delete this._touchesIntegerDict[n.getID()], 
                    i;
                    t >>= 1;
                }
                return -1;
            },
            _removeUsedIndexBit: function(t) {
                if (!(t < 0 || t >= this._maxTouches)) {
                    var e = 1 << t;
                    e = ~e, this._indexBitsUsed &= e;
                }
            },
            _glView: null,
            _updateCanvasBoundingRect: function() {
                var t = cc.game.canvas, e = this._canvasBoundingRect, i = document.documentElement, n = window.pageXOffset - i.clientLeft, r = window.pageYOffset - i.clientTop;
                if (t.getBoundingClientRect) {
                    var s = t.getBoundingClientRect();
                    e.left = s.left + n, e.top = s.top + r, e.width = s.width, e.height = s.height;
                } else t instanceof HTMLCanvasElement ? (e.left = n, e.top = r, e.width = t.width, 
                e.height = t.height) : (e.left = n, e.top = r, e.width = parseInt(t.style.width), 
                e.height = parseInt(t.style.height));
            },
            handleTouchesBegin: function(t) {
                for (var e, i, s, o = [], a = this._touchesIntegerDict, c = n.now(), l = 0, u = t.length; l < u; l++) if (null == a[s = (e = t[l]).getID()]) {
                    var h = this._getUnUsedIndex();
                    if (-1 === h) {
                        cc.logID(2300, h);
                        continue;
                    }
                    (i = this._touches[h] = new cc.Touch(e._point.x, e._point.y, e.getID()))._lastModified = c, 
                    i._setPrevPoint(e._prevPoint), a[s] = h, o.push(i);
                }
                if (o.length > 0) {
                    this._glView._convertTouchesWithScale(o);
                    var _ = new cc.Event.EventTouch(o);
                    _._eventCode = cc.Event.EventTouch.BEGAN, r.dispatchEvent(_);
                }
            },
            handleTouchesMove: function(t) {
                for (var e, i, s, o = [], a = this._touches, c = n.now(), l = 0, u = t.length; l < u; l++) s = (e = t[l]).getID(), 
                null != (i = this._touchesIntegerDict[s]) && a[i] && (a[i]._setPoint(e._point), 
                a[i]._setPrevPoint(e._prevPoint), a[i]._lastModified = c, o.push(a[i]));
                if (o.length > 0) {
                    this._glView._convertTouchesWithScale(o);
                    var h = new cc.Event.EventTouch(o);
                    h._eventCode = cc.Event.EventTouch.MOVED, r.dispatchEvent(h);
                }
            },
            handleTouchesEnd: function(t) {
                var e = this.getSetOfTouchesEndOrCancel(t);
                if (e.length > 0) {
                    this._glView._convertTouchesWithScale(e);
                    var i = new cc.Event.EventTouch(e);
                    i._eventCode = cc.Event.EventTouch.ENDED, r.dispatchEvent(i);
                }
                this._preTouchPool.length = 0;
            },
            handleTouchesCancel: function(t) {
                var e = this.getSetOfTouchesEndOrCancel(t);
                if (e.length > 0) {
                    this._glView._convertTouchesWithScale(e);
                    var i = new cc.Event.EventTouch(e);
                    i._eventCode = cc.Event.EventTouch.CANCELED, r.dispatchEvent(i);
                }
                this._preTouchPool.length = 0;
            },
            getSetOfTouchesEndOrCancel: function(t) {
                for (var e, i, n, r = [], s = this._touches, o = this._touchesIntegerDict, a = 0, c = t.length; a < c; a++) null != (i = o[n = (e = t[a]).getID()]) && s[i] && (s[i]._setPoint(e._point), 
                s[i]._setPrevPoint(e._prevPoint), r.push(s[i]), this._removeUsedIndexBit(i), delete o[n]);
                return r;
            },
            getPreTouch: function(t) {
                for (var e = null, i = this._preTouchPool, n = t.getID(), r = i.length - 1; r >= 0; r--) if (i[r].getID() === n) {
                    e = i[r];
                    break;
                }
                return e || (e = t), e;
            },
            setPreTouch: function(t) {
                for (var e = !1, i = this._preTouchPool, n = t.getID(), r = i.length - 1; r >= 0; r--) if (i[r].getID() === n) {
                    i[r] = t, e = !0;
                    break;
                }
                e || (i.length <= 50 ? i.push(t) : (i[this._preTouchPoolPointer] = t, this._preTouchPoolPointer = (this._preTouchPoolPointer + 1) % 50));
            },
            getTouchByXY: function(t, e, i) {
                var n = this._preTouchPoint, r = this._glView.convertToLocationInView(t, e, i), s = new cc.Touch(r.x, r.y, 0);
                return s._setPrevPoint(n.x, n.y), n.x = r.x, n.y = r.y, s;
            },
            getMouseEvent: function(t, e, i) {
                var n = this._prevMousePoint, r = new cc.Event.EventMouse(i);
                return r._setPrevCursor(n.x, n.y), n.x = t.x, n.y = t.y, this._glView._convertMouseToLocationInView(n, e), 
                r.setLocation(n.x, n.y), r;
            },
            getPointByEvent: function(t, e) {
                return cc.sys.browserType !== cc.sys.BROWSER_TYPE_QQ && cc.sys.browserType !== cc.sys.BROWSER_TYPE_UC && cc.sys.browserType !== cc.sys.BROWSER_TYPE_SAFARI || this._updateCanvasBoundingRect(), 
                null != t.pageX ? {
                    x: t.pageX,
                    y: t.pageY
                } : (e.left -= document.body.scrollLeft, e.top -= document.body.scrollTop, {
                    x: t.clientX,
                    y: t.clientY
                });
            },
            getTouchesByEvent: function(t, e) {
                for (var i, r, s, a = [], c = this._glView, l = this._preTouchPoint, u = t.changedTouches.length, h = 0; h < u; h++) if (i = t.changedTouches[h]) {
                    var _;
                    _ = n.BROWSER_TYPE_FIREFOX === n.browserType ? c.convertToLocationInView(i.pageX, i.pageY, e, o) : c.convertToLocationInView(i.clientX, i.clientY, e, o), 
                    null != i.identifier ? (r = new cc.Touch(_.x, _.y, i.identifier), s = this.getPreTouch(r).getLocation(), 
                    r._setPrevPoint(s.x, s.y), this.setPreTouch(r)) : (r = new cc.Touch(_.x, _.y))._setPrevPoint(l.x, l.y), 
                    l.x = _.x, l.y = _.y, a.push(r);
                }
                return a;
            },
            registerSystemEvent: function(t) {
                if (!this._isRegisterEvent) {
                    this._glView = cc.view;
                    var e = this, i = this._canvasBoundingRect;
                    window.addEventListener("resize", this._updateCanvasBoundingRect.bind(this));
                    var s = n.isMobile, o = "mouse" in n.capabilities, a = "touches" in n.capabilities;
                    if (o) {
                        s || (window.addEventListener("mousedown", function() {
                            e._mousePressed = !0;
                        }, !1), window.addEventListener("mouseup", function(t) {
                            if (e._mousePressed) {
                                e._mousePressed = !1;
                                var n = e.getPointByEvent(t, i);
                                if (!cc.rect(i.left, i.top, i.width, i.height).contains(n)) {
                                    e.handleTouchesEnd([ e.getTouchByXY(n.x, n.y, i) ]);
                                    var s = e.getMouseEvent(n, i, cc.Event.EventMouse.UP);
                                    s.setButton(t.button), r.dispatchEvent(s);
                                }
                            }
                        }, !1));
                        for (var c = cc.Event.EventMouse, l = [ !s && [ "mousedown", c.DOWN, function(i, n, r, s) {
                            e._mousePressed = !0, e.handleTouchesBegin([ e.getTouchByXY(r.x, r.y, s) ]), t.focus();
                        } ], !s && [ "mouseup", c.UP, function(t, i, n, r) {
                            e._mousePressed = !1, e.handleTouchesEnd([ e.getTouchByXY(n.x, n.y, r) ]);
                        } ], !s && [ "mousemove", c.MOVE, function(t, i, n, r) {
                            e.handleTouchesMove([ e.getTouchByXY(n.x, n.y, r) ]), e._mousePressed || i.setButton(null);
                        } ], [ "mousewheel", c.SCROLL, function(t, e) {
                            e.setScrollData(0, t.wheelDelta);
                        } ], [ "DOMMouseScroll", c.SCROLL, function(t, e) {
                            e.setScrollData(0, -120 * t.detail);
                        } ] ], u = 0; u < l.length; ++u) {
                            var h = l[u];
                            h && function() {
                                var n = h[0], s = h[1], o = h[2];
                                t.addEventListener(n, function(t) {
                                    var n = e.getPointByEvent(t, i), a = e.getMouseEvent(n, i, s);
                                    a.setButton(t.button), o(t, a, n, i), r.dispatchEvent(a), t.stopPropagation(), t.preventDefault();
                                }, !1);
                            }();
                        }
                    }
                    if (window.navigator.msPointerEnabled) {
                        var _ = {
                            MSPointerDown: e.handleTouchesBegin,
                            MSPointerMove: e.handleTouchesMove,
                            MSPointerUp: e.handleTouchesEnd,
                            MSPointerCancel: e.handleTouchesCancel
                        }, f = function(n) {
                            var r = _[n];
                            t.addEventListener(n, function(t) {
                                var n = document.documentElement;
                                i.adjustedLeft = i.left - n.scrollLeft, i.adjustedTop = i.top - n.scrollTop, r.call(e, [ e.getTouchByXY(t.clientX, t.clientY, i) ]), 
                                t.stopPropagation();
                            }, !1);
                        };
                        for (var d in _) f(d);
                    }
                    if (a) {
                        var p = {
                            touchstart: function(i) {
                                e.handleTouchesBegin(i), t.focus();
                            },
                            touchmove: function(t) {
                                e.handleTouchesMove(t);
                            },
                            touchend: function(t) {
                                e.handleTouchesEnd(t);
                            },
                            touchcancel: function(t) {
                                e.handleTouchesCancel(t);
                            }
                        }, m = function(n) {
                            var r = p[n];
                            t.addEventListener(n, function(t) {
                                if (t.changedTouches) {
                                    var n = document.body;
                                    i.adjustedLeft = i.left - (n.scrollLeft || window.scrollX || 0), i.adjustedTop = i.top - (n.scrollTop || window.scrollY || 0), 
                                    r(e.getTouchesByEvent(t, i)), t.stopPropagation(), t.preventDefault();
                                }
                            }, !1);
                        };
                        for (var v in p) m(v);
                    }
                    this._registerKeyboardEvent(), this._isRegisterEvent = !0;
                }
            },
            _registerKeyboardEvent: function() {},
            _registerAccelerometerEvent: function() {},
            update: function(t) {
                this._accelCurTime > this._accelInterval && (this._accelCurTime -= this._accelInterval, 
                r.dispatchEvent(new cc.Event.EventAcceleration(this._acceleration))), this._accelCurTime += t;
            }
        };
        e.exports = cc.internal.inputManager = a;
    }, {
        "../event-manager": 127,
        "./CCMacro": 187,
        "./CCSys": 191
    } ],
    187: [ function(t, e) {
        "use strict";
        cc.macro = {
            RAD: Math.PI / 180,
            DEG: 180 / Math.PI,
            REPEAT_FOREVER: Number.MAX_VALUE - 1,
            FLT_EPSILON: 1.192092896e-7,
            MIN_ZINDEX: -Math.pow(2, 15),
            MAX_ZINDEX: Math.pow(2, 15) - 1,
            ONE: 1,
            ZERO: 0,
            SRC_ALPHA: 770,
            SRC_ALPHA_SATURATE: 776,
            SRC_COLOR: 768,
            DST_ALPHA: 772,
            DST_COLOR: 774,
            ONE_MINUS_SRC_ALPHA: 771,
            ONE_MINUS_SRC_COLOR: 769,
            ONE_MINUS_DST_ALPHA: 773,
            ONE_MINUS_DST_COLOR: 775,
            ONE_MINUS_CONSTANT_ALPHA: 32772,
            ONE_MINUS_CONSTANT_COLOR: 32770,
            ORIENTATION_PORTRAIT: 1,
            ORIENTATION_LANDSCAPE: 2,
            ORIENTATION_AUTO: 3,
            DENSITYDPI_DEVICE: "device-dpi",
            DENSITYDPI_HIGH: "high-dpi",
            DENSITYDPI_MEDIUM: "medium-dpi",
            DENSITYDPI_LOW: "low-dpi",
            FIX_ARTIFACTS_BY_STRECHING_TEXEL_TMX: !0,
            DIRECTOR_STATS_POSITION: cc.v2(0, 0),
            ENABLE_STACKABLE_ACTIONS: !0,
            TOUCH_TIMEOUT: 5e3,
            BATCH_VERTEX_COUNT: 2e4,
            ENABLE_TILEDMAP_CULLING: !0,
            ENABLE_TRANSPARENT_CANVAS: !1,
            ENABLE_WEBGL_ANTIALIAS: !1,
            ENABLE_CULLING: !1,
            CLEANUP_IMAGE_CACHE: !1,
            SHOW_MESH_WIREFRAME: !1,
            SHOW_MESH_NORMAL: !1,
            ENABLE_MULTI_TOUCH: !0,
            ALLOW_IMAGE_BITMAP: !cc.sys.isMobile,
            ENABLE_NATIVE_TTF_RENDERER: !0
        }, Object.defineProperty(cc.macro, "ROTATE_ACTION_CCW", {
            set: function(t) {
                cc.RotateTo && cc.RotateBy && (cc.RotateTo._reverse = cc.RotateBy._reverse = t);
            }
        }), cc.macro.SUPPORT_TEXTURE_FORMATS = [ ".pkm", ".pvr", ".webp", ".jpg", ".jpeg", ".bmp", ".png" ], 
        cc.macro.KEY = {
            none: 0,
            back: 6,
            menu: 18,
            backspace: 8,
            tab: 9,
            enter: 13,
            shift: 16,
            ctrl: 17,
            alt: 18,
            pause: 19,
            capslock: 20,
            escape: 27,
            space: 32,
            pageup: 33,
            pagedown: 34,
            end: 35,
            home: 36,
            left: 37,
            up: 38,
            right: 39,
            down: 40,
            select: 41,
            insert: 45,
            Delete: 46,
            0: 48,
            1: 49,
            2: 50,
            3: 51,
            4: 52,
            5: 53,
            6: 54,
            7: 55,
            8: 56,
            9: 57,
            a: 65,
            b: 66,
            c: 67,
            d: 68,
            e: 69,
            f: 70,
            g: 71,
            h: 72,
            i: 73,
            j: 74,
            k: 75,
            l: 76,
            m: 77,
            n: 78,
            o: 79,
            p: 80,
            q: 81,
            r: 82,
            s: 83,
            t: 84,
            u: 85,
            v: 86,
            w: 87,
            x: 88,
            y: 89,
            z: 90,
            num0: 96,
            num1: 97,
            num2: 98,
            num3: 99,
            num4: 100,
            num5: 101,
            num6: 102,
            num7: 103,
            num8: 104,
            num9: 105,
            "*": 106,
            "+": 107,
            "-": 109,
            numdel: 110,
            "/": 111,
            f1: 112,
            f2: 113,
            f3: 114,
            f4: 115,
            f5: 116,
            f6: 117,
            f7: 118,
            f8: 119,
            f9: 120,
            f10: 121,
            f11: 122,
            f12: 123,
            numlock: 144,
            scrolllock: 145,
            ";": 186,
            semicolon: 186,
            equal: 187,
            "=": 187,
            ",": 188,
            comma: 188,
            dash: 189,
            ".": 190,
            period: 190,
            forwardslash: 191,
            grave: 192,
            "[": 219,
            openbracket: 219,
            backslash: 220,
            "]": 221,
            closebracket: 221,
            quote: 222,
            dpadLeft: 1e3,
            dpadRight: 1001,
            dpadUp: 1003,
            dpadDown: 1004,
            dpadCenter: 1005
        }, cc.macro.ImageFormat = cc.Enum({
            JPG: 0,
            PNG: 1,
            TIFF: 2,
            WEBP: 3,
            PVR: 4,
            ETC: 5,
            S3TC: 6,
            ATITC: 7,
            TGA: 8,
            RAWDATA: 9,
            UNKNOWN: 10
        }), cc.macro.BlendFactor = cc.Enum({
            ONE: 1,
            ZERO: 0,
            SRC_ALPHA: 770,
            SRC_COLOR: 768,
            DST_ALPHA: 772,
            DST_COLOR: 774,
            ONE_MINUS_SRC_ALPHA: 771,
            ONE_MINUS_SRC_COLOR: 769,
            ONE_MINUS_DST_ALPHA: 773,
            ONE_MINUS_DST_COLOR: 775
        }), cc.macro.TextAlignment = cc.Enum({
            LEFT: 0,
            CENTER: 1,
            RIGHT: 2
        }), cc.macro.VerticalTextAlignment = cc.Enum({
            TOP: 0,
            CENTER: 1,
            BOTTOM: 2
        }), e.exports = cc.macro;
    }, {} ],
    188: [ function(t, e) {
        "use strict";
        var i = t("./js"), n = t("./CCClass"), r = 1;
        function s() {
            this._name = "", this._objFlags = 0;
        }
        n.fastDefine("cc.Object", s, {
            _name: "",
            _objFlags: 0
        }), i.value(s, "Flags", {
            Destroyed: r,
            DontSave: 8,
            EditorOnly: 16,
            Dirty: 32,
            DontDestroy: 64,
            PersistentMask: -4192741,
            Destroying: 128,
            Deactivating: 256,
            LockedInEditor: 512,
            HideInHierarchy: 1024,
            IsPreloadStarted: 8192,
            IsOnLoadStarted: 32768,
            IsOnLoadCalled: 16384,
            IsOnEnableCalled: 2048,
            IsStartCalled: 65536,
            IsEditorOnEnableCalled: 4096,
            IsPositionLocked: 1 << 21,
            IsRotationLocked: 1 << 17,
            IsScaleLocked: 1 << 18,
            IsAnchorLocked: 1 << 19,
            IsSizeLocked: 1 << 20
        });
        var o = [];
        i.value(s, "_deferredDestroy", function() {
            for (var t = o.length, e = 0; e < t; ++e) {
                var i = o[e];
                i._objFlags & r || i._destroyImmediate();
            }
            t === o.length ? o.length = 0 : o.splice(0, t);
        });
        var a = s.prototype;
        function c(t, e) {
            var i, n = t instanceof cc._BaseNode || t instanceof cc.Component, r = n ? "_id" : null, s = {};
            for (i in t) if (t.hasOwnProperty(i)) {
                if (i === r) continue;
                switch (typeof t[i]) {
                  case "string":
                    s[i] = "";
                    break;

                  case "object":
                  case "function":
                    s[i] = null;
                }
            }
            if (cc.Class._isCCClass(e)) for (var o = cc.Class.Attr.getClassAttrs(e), a = e.__props__, c = 0; c < a.length; c++) {
                var l = (i = a[c]) + cc.Class.Attr.DELIMETER + "default";
                if (l in o) {
                    if (n && "_id" === i) continue;
                    switch (typeof o[l]) {
                      case "string":
                        s[i] = "";
                        break;

                      case "object":
                      case "function":
                        s[i] = null;
                        break;

                      case "undefined":
                        s[i] = void 0;
                    }
                }
            }
            return function(t) {
                for (var e in s) t[e] = s[e];
            };
        }
        i.getset(a, "name", function() {
            return this._name;
        }, function(t) {
            this._name = t;
        }, !0), i.get(a, "isValid", function() {
            return !(this._objFlags & r);
        }, !0), a.destroy = function() {
            return this._objFlags & r ? (cc.warnID(5e3), !1) : !(4 & this._objFlags || (this._objFlags |= 4, 
            o.push(this), 0));
        }, a._destruct = function() {
            var t = this.constructor, e = t.__destruct__;
            e || (e = c(this, t), i.value(t, "__destruct__", e, !0)), e(this);
        }, a._onPreDestroy = null, a._destroyImmediate = function() {
            this._objFlags & r ? cc.errorID(5e3) : (this._onPreDestroy && this._onPreDestroy(), 
            this._destruct(), this._objFlags |= r);
        }, a._deserialize = null, cc.isValid = function(t, e) {
            return "object" == typeof t ? !(!t || t._objFlags & (e ? 4 | r : r)) : void 0 !== t;
        }, cc.Object = e.exports = s;
    }, {
        "./CCClass": 182,
        "./js": 203
    } ],
    189: [ function(t, e) {
        "use strict";
        var i = t("../platform/js");
        cc.SAXParser = function() {
            window.DOMParser ? (this._isSupportDOMParser = !0, this._parser = new DOMParser()) : (this._isSupportDOMParser = !1, 
            this._parser = null);
        }, cc.SAXParser.prototype = {
            constructor: cc.SAXParser,
            parse: function(t) {
                return this._parseXML(t);
            },
            _parseXML: function(t) {
                var e;
                return this._isSupportDOMParser ? e = this._parser.parseFromString(t, "text/xml") : ((e = new ActiveXObject("Microsoft.XMLDOM")).async = "false", 
                e.loadXML(t)), e;
            }
        }, cc.PlistParser = function() {
            cc.SAXParser.call(this);
        }, i.extend(cc.PlistParser, cc.SAXParser), i.mixin(cc.PlistParser.prototype, {
            parse: function(t) {
                var e = this._parseXML(t), i = e.documentElement;
                if ("plist" !== i.tagName) return cc.warnID(5100), {};
                for (var n = null, r = 0, s = i.childNodes.length; r < s && 1 !== (n = i.childNodes[r]).nodeType; r++) ;
                return e = null, this._parseNode(n);
            },
            _parseNode: function(t) {
                var e = null, i = t.tagName;
                if ("dict" === i) e = this._parseDict(t); else if ("array" === i) e = this._parseArray(t); else if ("string" === i) if (1 === t.childNodes.length) e = t.firstChild.nodeValue; else {
                    e = "";
                    for (var n = 0; n < t.childNodes.length; n++) e += t.childNodes[n].nodeValue;
                } else "false" === i ? e = !1 : "true" === i ? e = !0 : "real" === i ? e = parseFloat(t.firstChild.nodeValue) : "integer" === i && (e = parseInt(t.firstChild.nodeValue, 10));
                return e;
            },
            _parseArray: function(t) {
                for (var e = [], i = 0, n = t.childNodes.length; i < n; i++) {
                    var r = t.childNodes[i];
                    1 === r.nodeType && e.push(this._parseNode(r));
                }
                return e;
            },
            _parseDict: function(t) {
                for (var e = {}, i = null, n = 0, r = t.childNodes.length; n < r; n++) {
                    var s = t.childNodes[n];
                    1 === s.nodeType && ("key" === s.tagName ? i = s.firstChild.nodeValue : e[i] = this._parseNode(s));
                }
                return e;
            }
        }), cc.saxParser = new cc.SAXParser(), cc.plistParser = new cc.PlistParser(), e.exports = {
            saxParser: cc.saxParser,
            plistParser: cc.plistParser
        };
    }, {
        "../platform/js": 203
    } ],
    190: [ function() {
        "use strict";
        cc.screen = {
            _supportsFullScreen: !1,
            _onfullscreenchange: null,
            _onfullscreenerror: null,
            _preOnFullScreenChange: null,
            _preOnFullScreenError: null,
            _preOnTouch: null,
            _touchEvent: "",
            _fn: null,
            _fnMap: [ [ "requestFullscreen", "exitFullscreen", "fullscreenchange", "fullscreenEnabled", "fullscreenElement", "fullscreenerror" ], [ "requestFullScreen", "exitFullScreen", "fullScreenchange", "fullScreenEnabled", "fullScreenElement", "fullscreenerror" ], [ "webkitRequestFullScreen", "webkitCancelFullScreen", "webkitfullscreenchange", "webkitIsFullScreen", "webkitCurrentFullScreenElement", "webkitfullscreenerror" ], [ "mozRequestFullScreen", "mozCancelFullScreen", "mozfullscreenchange", "mozFullScreen", "mozFullScreenElement", "mozfullscreenerror" ], [ "msRequestFullscreen", "msExitFullscreen", "MSFullscreenChange", "msFullscreenEnabled", "msFullscreenElement", "msfullscreenerror" ] ],
            init: function() {
                this._fn = {};
                var t, e, i, n, r = this._fnMap;
                for (t = 0, e = r.length; t < e; t++) if ((i = r[t]) && void 0 !== document[i[1]]) {
                    for (t = 0, n = i.length; t < n; t++) this._fn[r[0][t]] = i[t];
                    break;
                }
                this._supportsFullScreen = void 0 !== this._fn.requestFullscreen, this._touchEvent = "ontouchend" in window ? "touchend" : "mousedown";
            },
            fullScreen: function() {
                return !!this._supportsFullScreen && !!(document[this._fn.fullscreenElement] || document[this._fn.webkitFullscreenElement] || document[this._fn.mozFullScreenElement]);
            },
            requestFullScreen: function(t, e, i) {
                if (t && "video" === t.tagName.toLowerCase()) {
                    if (cc.sys.os === cc.sys.OS_IOS && cc.sys.isBrowser && t.readyState > 0) return void (t.webkitEnterFullscreen && t.webkitEnterFullscreen());
                    t.setAttribute("x5-video-player-fullscreen", "true");
                }
                if (this._supportsFullScreen) {
                    if (t = t || document.documentElement, e) {
                        var n = this._fn.fullscreenchange;
                        this._onfullscreenchange && document.removeEventListener(n, this._onfullscreenchange), 
                        this._onfullscreenchange = e, document.addEventListener(n, e, !1);
                    }
                    if (i) {
                        var r = this._fn.fullscreenerror;
                        this._onfullscreenerror && document.removeEventListener(r, this._onfullscreenerror), 
                        this._onfullscreenerror = i, document.addEventListener(r, i, {
                            once: !0
                        });
                    }
                    var s = t[this._fn.requestFullscreen]();
                    void 0 === document[this._fn.fullscreenerror] && window.Promise && s instanceof Promise && s.catch(function() {});
                }
            },
            exitFullScreen: function(t) {
                if (t && "video" === t.tagName.toLowerCase()) {
                    if (cc.sys.os === cc.sys.OS_IOS && cc.sys.isBrowser) return void (t.webkitExitFullscreen && t.webkitExitFullscreen());
                    t.setAttribute("x5-video-player-fullscreen", "false");
                }
                return !this._supportsFullScreen || document[this._fn.exitFullscreen]();
            },
            autoFullScreen: function(t, e) {
                t = t || document.body, this._ensureFullScreen(t, e), this.requestFullScreen(t, e);
            },
            disableAutoFullScreen: function(t) {
                var e = cc.game.canvas || t, i = this._touchEvent;
                this._preOnTouch && (e.removeEventListener(i, this._preOnTouch), this._preOnTouch = null);
            },
            _ensureFullScreen: function(t, e) {
                var i = this, n = cc.game.canvas || t, r = this._fn.fullscreenerror, s = this._touchEvent;
                function o() {
                    i._preOnFullScreenError = null, i._preOnTouch && n.removeEventListener(s, i._preOnTouch), 
                    i._preOnTouch = function() {
                        i._preOnTouch = null, i.requestFullScreen(t, e);
                    }, n.addEventListener(s, i._preOnTouch, {
                        once: !0
                    });
                }
                this._preOnFullScreenError && t.removeEventListener(r, this._preOnFullScreenError), 
                this._preOnFullScreenError = o, t.addEventListener(r, o, {
                    once: !0
                });
            }
        }, cc.screen.init();
    }, {} ],
    191: [ function(t, e) {
        "use strict";
        window._CCSettings && _CCSettings.platform;
        var i = "undefined" == typeof window ? global : window, n = cc && cc.sys ? cc.sys : function() {
            cc.sys = {};
            var t, e, n = cc.sys;
            if (n.LANGUAGE_ENGLISH = "en", n.LANGUAGE_CHINESE = "zh", n.LANGUAGE_FRENCH = "fr", 
            n.LANGUAGE_ITALIAN = "it", n.LANGUAGE_GERMAN = "de", n.LANGUAGE_SPANISH = "es", 
            n.LANGUAGE_DUTCH = "du", n.LANGUAGE_RUSSIAN = "ru", n.LANGUAGE_KOREAN = "ko", n.LANGUAGE_JAPANESE = "ja", 
            n.LANGUAGE_HUNGARIAN = "hu", n.LANGUAGE_PORTUGUESE = "pt", n.LANGUAGE_ARABIC = "ar", 
            n.LANGUAGE_NORWEGIAN = "no", n.LANGUAGE_POLISH = "pl", n.LANGUAGE_TURKISH = "tr", 
            n.LANGUAGE_UKRAINIAN = "uk", n.LANGUAGE_ROMANIAN = "ro", n.LANGUAGE_BULGARIAN = "bg", 
            n.LANGUAGE_UNKNOWN = "unknown", n.OS_IOS = "iOS", n.OS_ANDROID = "Android", n.OS_WINDOWS = "Windows", 
            n.OS_MARMALADE = "Marmalade", n.OS_LINUX = "Linux", n.OS_BADA = "Bada", n.OS_BLACKBERRY = "Blackberry", 
            n.OS_OSX = "OS X", n.OS_WP8 = "WP8", n.OS_WINRT = "WINRT", n.OS_UNKNOWN = "Unknown", 
            n.UNKNOWN = -1, n.WIN32 = 0, n.LINUX = 1, n.MACOS = 2, n.ANDROID = 3, n.IPHONE = 4, 
            n.IPAD = 5, n.BLACKBERRY = 6, n.NACL = 7, n.EMSCRIPTEN = 8, n.TIZEN = 9, n.WINRT = 10, 
            n.WP8 = 11, n.MOBILE_BROWSER = 100, n.DESKTOP_BROWSER = 101, n.EDITOR_PAGE = 102, 
            n.EDITOR_CORE = 103, n.WECHAT_GAME = 104, n.QQ_PLAY = 105, n.FB_PLAYABLE_ADS = 106, 
            n.BAIDU_GAME = 107, n.VIVO_GAME = 108, n.OPPO_GAME = 109, n.HUAWEI_GAME = 110, n.XIAOMI_GAME = 111, 
            n.JKW_GAME = 112, n.ALIPAY_GAME = 113, n.WECHAT_GAME_SUB = 114, n.BAIDU_GAME_SUB = 115, 
            n.QTT_GAME = 116, n.BYTEDANCE_GAME = 117, n.BYTEDANCE_GAME_SUB = 118, n.LINKSURE = 119, 
            n.BROWSER_TYPE_WECHAT = "wechat", n.BROWSER_TYPE_ANDROID = "androidbrowser", n.BROWSER_TYPE_IE = "ie", 
            n.BROWSER_TYPE_EDGE = "edge", n.BROWSER_TYPE_QQ = "qqbrowser", n.BROWSER_TYPE_MOBILE_QQ = "mqqbrowser", 
            n.BROWSER_TYPE_UC = "ucbrowser", n.BROWSER_TYPE_UCBS = "ucbs", n.BROWSER_TYPE_360 = "360browser", 
            n.BROWSER_TYPE_BAIDU_APP = "baiduboxapp", n.BROWSER_TYPE_BAIDU = "baidubrowser", 
            n.BROWSER_TYPE_MAXTHON = "maxthon", n.BROWSER_TYPE_OPERA = "opera", n.BROWSER_TYPE_OUPENG = "oupeng", 
            n.BROWSER_TYPE_MIUI = "miuibrowser", n.BROWSER_TYPE_FIREFOX = "firefox", n.BROWSER_TYPE_SAFARI = "safari", 
            n.BROWSER_TYPE_CHROME = "chrome", n.BROWSER_TYPE_LIEBAO = "liebao", n.BROWSER_TYPE_QZONE = "qzone", 
            n.BROWSER_TYPE_SOUGOU = "sogou", n.BROWSER_TYPE_HUAWEI = "huawei", n.BROWSER_TYPE_UNKNOWN = "unknown", 
            n.isNative = !1, n.isBrowser = "object" == typeof window && "object" == typeof document && !0, 
            n.glExtension = function(t) {
                return !!cc.renderer.device.ext(t);
            }, n.getMaxJointMatrixSize = function() {
                if (!n._maxJointMatrixSize) {
                    var t = cc.game._renderContext, e = Math.floor(t.getParameter(t.MAX_VERTEX_UNIFORM_VECTORS) / 4) - 10;
                    n._maxJointMatrixSize = e < 50 ? 0 : 50;
                }
                return n._maxJointMatrixSize;
            }, n.getSafeAreaRect = function() {
                var t = cc.view.getVisibleSize();
                return cc.rect(0, 0, t.width, t.height);
            }, i.__globalAdapter && i.__globalAdapter.adaptSys) i.__globalAdapter.adaptSys(n); else {
                var r = window, s = r.navigator, o = document, a = o.documentElement, c = s.userAgent.toLowerCase();
                n.isMobile = /mobile|android|iphone|ipad/.test(c), "undefined" != typeof FbPlayableAd ? n.platform = n.FB_PLAYABLE_ADS : n.platform = n.isMobile ? n.MOBILE_BROWSER : n.DESKTOP_BROWSER;
                var l = s.language;
                l = l || s.browserLanguage, n.languageCode = l.toLowerCase(), l = l ? l.split("-")[0] : n.LANGUAGE_ENGLISH, 
                n.language = l;
                var u = !1, h = !1, _ = "", f = 0, d = /android\s*(\d+(?:\.\d+)*)/i.exec(c) || /android\s*(\d+(?:\.\d+)*)/i.exec(s.platform);
                d && (u = !0, _ = d[1] || "", f = parseInt(_) || 0), (d = /(iPad|iPhone|iPod).*OS ((\d+_?){2,3})/i.exec(c)) ? (h = !0, 
                _ = d[2] || "", f = parseInt(_) || 0) : (/(iPhone|iPad|iPod)/.exec(s.platform) || "MacIntel" === s.platform && s.maxTouchPoints && s.maxTouchPoints > 1) && (h = !0, 
                _ = "", f = 0);
                var p = n.OS_UNKNOWN;
                -1 !== s.appVersion.indexOf("Win") ? p = n.OS_WINDOWS : h ? p = n.OS_IOS : -1 !== s.appVersion.indexOf("Mac") ? p = n.OS_OSX : -1 !== s.appVersion.indexOf("X11") && -1 === s.appVersion.indexOf("Linux") ? p = n.OS_UNIX : u ? p = n.OS_ANDROID : -1 === s.appVersion.indexOf("Linux") && -1 === c.indexOf("ubuntu") || (p = n.OS_LINUX), 
                n.os = p, n.osVersion = _, n.osMainVersion = f, n.browserType = n.BROWSER_TYPE_UNKNOWN, 
                function() {
                    var t = /mqqbrowser|micromessenger|qqbrowser|sogou|qzone|liebao|maxthon|ucbs|360 aphone|360browser|baiduboxapp|baidubrowser|maxthon|mxbrowser|miuibrowser/i.exec(c) || /qq|ucbrowser|ubrowser|edge|HuaweiBrowser/i.exec(c) || /chrome|safari|firefox|trident|opera|opr\/|oupeng/i.exec(c), e = t ? t[0].toLowerCase() : n.BROWSER_TYPE_UNKNOWN;
                    "safari" === e && u ? e = n.BROWSER_TYPE_ANDROID : "qq" === e && c.match(/android.*applewebkit/i) && (e = n.BROWSER_TYPE_ANDROID);
                    var i = {
                        micromessenger: n.BROWSER_TYPE_WECHAT,
                        trident: n.BROWSER_TYPE_IE,
                        edge: n.BROWSER_TYPE_EDGE,
                        "360 aphone": n.BROWSER_TYPE_360,
                        mxbrowser: n.BROWSER_TYPE_MAXTHON,
                        "opr/": n.BROWSER_TYPE_OPERA,
                        ubrowser: n.BROWSER_TYPE_UC,
                        huaweibrowser: n.BROWSER_TYPE_HUAWEI
                    };
                    n.browserType = i[e] || e;
                }(), n.browserVersion = "", (e = c.match(/(mqqbrowser|micromessenger|qqbrowser|sogou|qzone|liebao|maxthon|uc|ucbs|360 aphone|360|baiduboxapp|baidu|maxthon|mxbrowser|miui(?:.hybrid)?)(mobile)?(browser)?\/?([\d.]+)/i)) || (e = c.match(/(qq|chrome|safari|firefox|trident|opera|opr\/|oupeng)(mobile)?(browser)?\/?([\d.]+)/i)), 
                n.browserVersion = e ? e[4] : "";
                var m = window.innerWidth || document.documentElement.clientWidth, v = window.innerHeight || document.documentElement.clientHeight, y = window.devicePixelRatio || 1;
                n.windowPixelResolution = {
                    width: y * m,
                    height: y * v
                }, n._checkWebGLRenderMode = function() {
                    if (cc.game.renderType !== cc.game.RENDER_TYPE_WEBGL) throw new Error("This feature supports WebGL render mode only.");
                };
                var g = document.createElement("canvas");
                try {
                    var x = n.localStorage = r.localStorage;
                    x.setItem("storage", ""), x.removeItem("storage"), x = null;
                } catch (B) {
                    var A = function() {
                        cc.warnID(5200);
                    };
                    n.localStorage = {
                        getItem: A,
                        setItem: A,
                        removeItem: A,
                        clear: A
                    };
                }
                var C = g.toDataURL("image/webp").startsWith("data:image/webp"), b = !!g.getContext("2d"), S = !1;
                r.WebGLRenderingContext && (S = !0);
                var T, w = n.capabilities = {
                    canvas: b,
                    opengl: S,
                    webp: C,
                    imageBitmap: !1
                };
                "undefined" != typeof createImageBitmap && "undefined" != typeof Blob && (g.width = g.height = 2, 
                createImageBitmap(g, {}).then(function(t) {
                    w.imageBitmap = !0, t.close && t.close();
                }).catch(function() {})), (void 0 !== a.ontouchstart || void 0 !== o.ontouchstart || s.msPointerEnabled) && (w.touches = !0), 
                void 0 !== a.onmouseup && (w.mouse = !0), void 0 !== a.onkeyup && (w.keyboard = !0), 
                (r.DeviceMotionEvent || r.DeviceOrientationEvent) && (w.accelerometer = !0), function() {
                    n.browserVersion;
                    var t = !!(window.AudioContext || window.webkitAudioContext || window.mozAudioContext);
                    T = {
                        ONLY_ONE: !1,
                        WEB_AUDIO: t,
                        DELAY_CREATE_CTX: !1
                    }, n.os === n.OS_IOS && (T.USE_LOADER_EVENT = "loadedmetadata"), n.browserType === n.BROWSER_TYPE_FIREFOX && (T.DELAY_CREATE_CTX = !0, 
                    T.USE_LOADER_EVENT = "canplay"), n.os === n.OS_ANDROID && n.browserType === n.BROWSER_TYPE_UC && (T.ONE_SOURCE = !0);
                }();
                try {
                    T.WEB_AUDIO && (T.context = new (window.AudioContext || window.webkitAudioContext || window.mozAudioContext)(), 
                    T.DELAY_CREATE_CTX && setTimeout(function() {
                        T.context = new (window.AudioContext || window.webkitAudioContext || window.mozAudioContext)();
                    }, 0));
                } catch (M) {
                    T.WEB_AUDIO = !1, cc.logID(5201);
                }
                var E = [];
                (t = document.createElement("audio")).canPlayType && (t.canPlayType('audio/ogg; codecs="vorbis"') && E.push(".ogg"), 
                t.canPlayType("audio/mpeg") && E.push(".mp3"), t.canPlayType('audio/wav; codecs="1"') && E.push(".wav"), 
                t.canPlayType("audio/mp4") && E.push(".mp4"), t.canPlayType("audio/x-m4a") && E.push(".m4a")), 
                T.format = E, n.__audioSupport = T;
            }
            return n.NetworkType = {
                NONE: 0,
                LAN: 1,
                WWAN: 2
            }, n.getNetworkType = function() {
                return n.NetworkType.LAN;
            }, n.getBatteryLevel = function() {
                return 1;
            }, n.garbageCollect = function() {}, n.restartVM = function() {}, n.isObjectValid = function(t) {
                return !!t;
            }, n.dump = function() {
                var t = "";
                t += "isMobile : " + this.isMobile + "\r\n", t += "language : " + this.language + "\r\n", 
                t += "browserType : " + this.browserType + "\r\n", t += "browserVersion : " + this.browserVersion + "\r\n", 
                t += "capabilities : " + JSON.stringify(this.capabilities) + "\r\n", t += "os : " + this.os + "\r\n", 
                t += "osVersion : " + this.osVersion + "\r\n", t += "platform : " + this.platform + "\r\n", 
                t += "Using " + (cc.game.renderType === cc.game.RENDER_TYPE_WEBGL ? "WEBGL" : "CANVAS") + " renderer.\r\n", 
                cc.log(t);
            }, n.openURL = function(t) {
                window.open(t);
            }, n.now = function() {
                return Date.now ? Date.now() : +new Date();
            }, n;
        }();
        e.exports = n;
    }, {} ],
    192: [ function(t, e) {
        "use strict";
        var i = t("../event/event-target"), n = t("../platform/js"), r = t("../renderer");
        t("../platform/CCClass");
        var s = {
            init: function() {
                this.html = document.getElementsByTagName("html")[0];
            },
            availWidth: function(t) {
                return t && t !== this.html ? t.clientWidth : window.innerWidth;
            },
            availHeight: function(t) {
                return t && t !== this.html ? t.clientHeight : window.innerHeight;
            },
            meta: {
                width: "device-width"
            },
            adaptationType: cc.sys.browserType
        };
        switch (cc.sys.os === cc.sys.OS_IOS && (s.adaptationType = cc.sys.BROWSER_TYPE_SAFARI), 
        s.adaptationType) {
          case cc.sys.BROWSER_TYPE_SAFARI:
          case cc.sys.BROWSER_TYPE_SOUGOU:
          case cc.sys.BROWSER_TYPE_UC:
            s.meta["minimal-ui"] = "true", s.availWidth = function(t) {
                return t.clientWidth;
            }, s.availHeight = function(t) {
                return t.clientHeight;
            };
        }
        var o = null, a = function() {
            i.call(this);
            var t = this, e = cc.ContainerStrategy, n = cc.ContentStrategy;
            s.init(this), t._frameSize = cc.size(0, 0), t._designResolutionSize = cc.size(0, 0), 
            t._originalDesignResolutionSize = cc.size(0, 0), t._scaleX = 1, t._scaleY = 1, t._viewportRect = cc.rect(0, 0, 0, 0), 
            t._visibleRect = cc.rect(0, 0, 0, 0), t._autoFullScreen = !1, t._devicePixelRatio = 1, 
            t._maxPixelRatio = 2, t._retinaEnabled = !1, t._resizeCallback = null, t._resizing = !1, 
            t._resizeWithBrowserSize = !1, t._orientationChanging = !0, t._isRotated = !1, t._orientation = cc.macro.ORIENTATION_AUTO, 
            t._isAdjustViewport = !0, t._antiAliasEnabled = !1, t._resolutionPolicy = null, 
            t._rpExactFit = new cc.ResolutionPolicy(e.EQUAL_TO_FRAME, n.EXACT_FIT), t._rpShowAll = new cc.ResolutionPolicy(e.EQUAL_TO_FRAME, n.SHOW_ALL), 
            t._rpNoBorder = new cc.ResolutionPolicy(e.EQUAL_TO_FRAME, n.NO_BORDER), t._rpFixedHeight = new cc.ResolutionPolicy(e.EQUAL_TO_FRAME, n.FIXED_HEIGHT), 
            t._rpFixedWidth = new cc.ResolutionPolicy(e.EQUAL_TO_FRAME, n.FIXED_WIDTH), cc.game.once(cc.game.EVENT_ENGINE_INITED, this.init, this);
        };
        cc.js.extend(a, i), cc.js.mixin(a.prototype, {
            init: function() {
                this._initFrameSize();
                var t = cc.game.canvas.width, e = cc.game.canvas.height;
                this._designResolutionSize.width = t, this._designResolutionSize.height = e, this._originalDesignResolutionSize.width = t, 
                this._originalDesignResolutionSize.height = e, this._viewportRect.width = t, this._viewportRect.height = e, 
                this._visibleRect.width = t, this._visibleRect.height = e, cc.winSize.width = this._visibleRect.width, 
                cc.winSize.height = this._visibleRect.height, cc.visibleRect && cc.visibleRect.init(this._visibleRect);
            },
            _resizeEvent: function(t) {
                var e;
                e = this.setDesignResolutionSize ? this : cc.view;
                var i = cc.sys;
                if (i.browserType !== i.BROWSER_TYPE_UC || i.os !== i.OS_IOS) {
                    var n = e._frameSize.width, r = e._frameSize.height, s = e._isRotated;
                    if (cc.sys.isMobile) {
                        var o = cc.game.container.style, a = o.margin;
                        o.margin = "0", o.display = "none", e._initFrameSize(), o.margin = a, o.display = "block";
                    } else e._initFrameSize();
                    if (!0 === t || e._isRotated !== s || e._frameSize.width !== n || e._frameSize.height !== r) {
                        var c = e._originalDesignResolutionSize.width, l = e._originalDesignResolutionSize.height;
                        e._resizing = !0, c > 0 && e.setDesignResolutionSize(c, l, e._resolutionPolicy), 
                        e._resizing = !1, e.emit("canvas-resize"), e._resizeCallback && e._resizeCallback.call();
                    }
                } else setTimeout(function() {
                    e._resizeEvent(t);
                }, 0);
            },
            _orientationChange: function() {
                cc.view._orientationChanging = !0, cc.view._resizeEvent(), cc.sys.browserType === cc.sys.BROWSER_TYPE_SAFARI && cc.sys.isMobile && setTimeout(function() {
                    window.innerHeight > window.innerWidth && window.scrollTo(0, 1);
                }, 500);
            },
            _resize: function() {
                cc.view._resizeEvent(!1);
            },
            resizeWithBrowserSize: function(t) {
                t ? this._resizeWithBrowserSize || (this._resizeWithBrowserSize = !0, window.addEventListener("resize", this._resize), 
                window.addEventListener("orientationchange", this._orientationChange)) : this._resizeWithBrowserSize && (this._resizeWithBrowserSize = !1, 
                window.removeEventListener("resize", this._resize), window.removeEventListener("orientationchange", this._orientationChange));
            },
            setResizeCallback: function(t) {
                "function" != typeof t && null != t || (this._resizeCallback = t);
            },
            setOrientation: function(t) {
                if ((t &= cc.macro.ORIENTATION_AUTO) && this._orientation !== t) {
                    this._orientation = t;
                    var e = this._originalDesignResolutionSize.width, i = this._originalDesignResolutionSize.height;
                    this.setDesignResolutionSize(e, i, this._resolutionPolicy);
                }
            },
            _initFrameSize: function() {
                var t = this._frameSize, e = s.availWidth(cc.game.frame), i = s.availHeight(cc.game.frame), n = e >= i;
                !cc.sys.isMobile || n && this._orientation & cc.macro.ORIENTATION_LANDSCAPE || !n && this._orientation & cc.macro.ORIENTATION_PORTRAIT ? (t.width = e, 
                t.height = i, cc.game.container.style["-webkit-transform"] = "rotate(0deg)", cc.game.container.style.transform = "rotate(0deg)", 
                this._isRotated = !1) : (t.width = i, t.height = e, cc.game.container.style["-webkit-transform"] = "rotate(90deg)", 
                cc.game.container.style.transform = "rotate(90deg)", cc.game.container.style["-webkit-transform-origin"] = "0px 0px 0px", 
                cc.game.container.style.transformOrigin = "0px 0px 0px", this._isRotated = !0), 
                this._orientationChanging && setTimeout(function() {
                    cc.view._orientationChanging = !1;
                }, 1e3);
            },
            _setViewportMeta: function(t, e) {
                var i = document.getElementById("cocosMetaElement");
                i && e && document.head.removeChild(i);
                var n, r, s, o = document.getElementsByName("viewport"), a = o ? o[0] : null;
                for (r in n = a ? a.content : "", (i = i || document.createElement("meta")).id = "cocosMetaElement", 
                i.name = "viewport", i.content = "", t) -1 == n.indexOf(r) ? n += "," + r + "=" + t[r] : e && (s = new RegExp(r + "s*=s*[^,]+"), 
                n = n.replace(s, r + "=" + t[r]));
                /^,/.test(n) && (n = n.substr(1)), i.content = n, a && (a.content = n), document.head.appendChild(i);
            },
            _adjustViewportMeta: function() {
                this._isAdjustViewport && (this._setViewportMeta(s.meta, !1), this._isAdjustViewport = !1);
            },
            adjustViewportMeta: function(t) {
                this._isAdjustViewport = t;
            },
            enableRetina: function(t) {
                this._retinaEnabled = !!t;
            },
            isRetinaEnabled: function() {
                return this._retinaEnabled;
            },
            enableAntiAlias: function(t) {
                if (cc.warnID(9200), this._antiAliasEnabled !== t) if (this._antiAliasEnabled = t, 
                cc.game.renderType === cc.game.RENDER_TYPE_WEBGL) cc.assetManager.assets.forEach(function(e) {
                    if (e instanceof cc.Texture2D) {
                        var i = cc.Texture2D.Filter;
                        t ? e.setFilters(i.LINEAR, i.LINEAR) : e.setFilters(i.NEAREST, i.NEAREST);
                    }
                }); else if (cc.game.renderType === cc.game.RENDER_TYPE_CANVAS) {
                    var e = cc.game.canvas.getContext("2d");
                    e.imageSmoothingEnabled = t, e.mozImageSmoothingEnabled = t;
                }
            },
            isAntiAliasEnabled: function() {
                return this._antiAliasEnabled;
            },
            enableAutoFullScreen: function(t) {
                t && t !== this._autoFullScreen && cc.sys.isMobile ? (this._autoFullScreen = !0, 
                cc.screen.autoFullScreen(cc.game.frame)) : (this._autoFullScreen = !1, cc.screen.disableAutoFullScreen(cc.game.frame));
            },
            isAutoFullScreenEnabled: function() {
                return this._autoFullScreen;
            },
            setCanvasSize: function(t, e) {
                var i = cc.game.canvas, n = cc.game.container;
                i.width = t * this._devicePixelRatio, i.height = e * this._devicePixelRatio, i.style.width = t + "px", 
                i.style.height = e + "px", n.style.width = t + "px", n.style.height = e + "px", 
                this._resizeEvent();
            },
            getCanvasSize: function() {
                return cc.size(cc.game.canvas.width, cc.game.canvas.height);
            },
            getFrameSize: function() {
                return cc.size(this._frameSize.width, this._frameSize.height);
            },
            setFrameSize: function(t, e) {
                this._frameSize.width = t, this._frameSize.height = e, cc.game.frame.style.width = t + "px", 
                cc.game.frame.style.height = e + "px", this._resizeEvent(!0);
            },
            getVisibleSize: function() {
                return cc.size(this._visibleRect.width, this._visibleRect.height);
            },
            getVisibleSizeInPixel: function() {
                return cc.size(this._visibleRect.width * this._scaleX, this._visibleRect.height * this._scaleY);
            },
            getVisibleOrigin: function() {
                return cc.v2(this._visibleRect.x, this._visibleRect.y);
            },
            getVisibleOriginInPixel: function() {
                return cc.v2(this._visibleRect.x * this._scaleX, this._visibleRect.y * this._scaleY);
            },
            getResolutionPolicy: function() {
                return this._resolutionPolicy;
            },
            setResolutionPolicy: function(t) {
                var e = this;
                if (t instanceof cc.ResolutionPolicy) e._resolutionPolicy = t; else {
                    var i = cc.ResolutionPolicy;
                    t === i.EXACT_FIT && (e._resolutionPolicy = e._rpExactFit), t === i.SHOW_ALL && (e._resolutionPolicy = e._rpShowAll), 
                    t === i.NO_BORDER && (e._resolutionPolicy = e._rpNoBorder), t === i.FIXED_HEIGHT && (e._resolutionPolicy = e._rpFixedHeight), 
                    t === i.FIXED_WIDTH && (e._resolutionPolicy = e._rpFixedWidth);
                }
            },
            setDesignResolutionSize: function(t, e, i) {
                if (t > 0 && e > 0) {
                    this.setResolutionPolicy(i);
                    var n = this._resolutionPolicy;
                    if (n && n.preApply(this), cc.sys.isMobile && this._adjustViewportMeta(), this._orientationChanging = !0, 
                    this._resizing || this._initFrameSize(), n) {
                        this._originalDesignResolutionSize.width = this._designResolutionSize.width = t, 
                        this._originalDesignResolutionSize.height = this._designResolutionSize.height = e;
                        var s = n.apply(this, this._designResolutionSize);
                        if (s.scale && 2 === s.scale.length && (this._scaleX = s.scale[0], this._scaleY = s.scale[1]), 
                        s.viewport) {
                            var o = this._viewportRect, a = this._visibleRect, c = s.viewport;
                            o.x = c.x, o.y = c.y, o.width = c.width, o.height = c.height, a.x = 0, a.y = 0, 
                            a.width = c.width / this._scaleX, a.height = c.height / this._scaleY;
                        }
                        n.postApply(this), cc.winSize.width = this._visibleRect.width, cc.winSize.height = this._visibleRect.height, 
                        cc.visibleRect && cc.visibleRect.init(this._visibleRect), r.updateCameraViewport(), 
                        cc.internal.inputManager._updateCanvasBoundingRect(), this.emit("design-resolution-changed");
                    } else cc.logID(2201);
                } else cc.errorID(2200);
            },
            getDesignResolutionSize: function() {
                return cc.size(this._designResolutionSize.width, this._designResolutionSize.height);
            },
            setRealPixelResolution: function(t, e, i) {
                this._setViewportMeta({
                    width: t
                }, !0), document.documentElement.style.width = t + "px", document.body.style.width = t + "px", 
                document.body.style.left = "0px", document.body.style.top = "0px", this.setDesignResolutionSize(t, e, i);
            },
            setViewportInPoints: function(t, e, i, n) {
                var r = this._scaleX, s = this._scaleY;
                cc.game._renderContext.viewport(t * r + this._viewportRect.x, e * s + this._viewportRect.y, i * r, n * s);
            },
            setScissorInPoints: function(t, e, i, n) {
                var r = this._scaleX, s = this._scaleY, a = Math.ceil(t * r + this._viewportRect.x), c = Math.ceil(e * s + this._viewportRect.y), l = Math.ceil(i * r), u = Math.ceil(n * s), h = cc.game._renderContext;
                if (!o) {
                    var _ = h.getParameter(h.SCISSOR_BOX);
                    o = cc.rect(_[0], _[1], _[2], _[3]);
                }
                o.x === a && o.y === c && o.width === l && o.height === u || (o.x = a, o.y = c, 
                o.width = l, o.height = u, h.scissor(a, c, l, u));
            },
            isScissorEnabled: function() {
                return cc.game._renderContext.isEnabled(gl.SCISSOR_TEST);
            },
            getScissorRect: function() {
                if (!o) {
                    var t = gl.getParameter(gl.SCISSOR_BOX);
                    o = cc.rect(t[0], t[1], t[2], t[3]);
                }
                var e = 1 / this._scaleX, i = 1 / this._scaleY;
                return cc.rect((o.x - this._viewportRect.x) * e, (o.y - this._viewportRect.y) * i, o.width * e, o.height * i);
            },
            getViewportRect: function() {
                return this._viewportRect;
            },
            getScaleX: function() {
                return this._scaleX;
            },
            getScaleY: function() {
                return this._scaleY;
            },
            getDevicePixelRatio: function() {
                return this._devicePixelRatio;
            },
            convertToLocationInView: function(t, e, i, n) {
                var r = n || cc.v2(), s = i.adjustedLeft ? i.adjustedLeft : i.left, o = i.adjustedTop ? i.adjustedTop : i.top, a = this._devicePixelRatio * (t - s), c = this._devicePixelRatio * (o + i.height - e);
                return this._isRotated ? (r.x = cc.game.canvas.width - c, r.y = a) : (r.x = a, r.y = c), 
                r;
            },
            _convertMouseToLocationInView: function(t, e) {
                var i = this._viewportRect;
                t.x = (this._devicePixelRatio * (t.x - e.left) - i.x) / this._scaleX, t.y = (this._devicePixelRatio * (e.top + e.height - t.y) - i.y) / this._scaleY;
            },
            _convertPointWithScale: function(t) {
                var e = this._viewportRect;
                t.x = (t.x - e.x) / this._scaleX, t.y = (t.y - e.y) / this._scaleY;
            },
            _convertTouchesWithScale: function(t) {
                for (var e, i, n, r = this._viewportRect, s = this._scaleX, o = this._scaleY, a = 0; a < t.length; a++) i = (e = t[a])._point, 
                n = e._prevPoint, i.x = (i.x - r.x) / s, i.y = (i.y - r.y) / o, n.x = (n.x - r.x) / s, 
                n.y = (n.y - r.y) / o;
            }
        }), cc.ContainerStrategy = cc.Class({
            name: "ContainerStrategy",
            preApply: function() {},
            apply: function() {},
            postApply: function() {},
            _setupContainer: function(t, e, i) {
                var n = cc.game.canvas;
                this._setupStyle(t, e, i);
                var r = t._devicePixelRatio = 1;
                t.isRetinaEnabled() && (r = t._devicePixelRatio = Math.min(t._maxPixelRatio, window.devicePixelRatio || 1)), 
                n.width = e * r, n.height = i * r;
            },
            _setupStyle: function(t, e, i) {
                var n = cc.game.canvas, r = cc.game.container;
                cc.sys.os === cc.sys.OS_ANDROID && (document.body.style.width = (t._isRotated ? i : e) + "px", 
                document.body.style.height = (t._isRotated ? e : i) + "px"), r.style.width = n.style.width = e + "px", 
                r.style.height = n.style.height = i + "px";
            },
            _fixContainer: function() {
                document.body.insertBefore(cc.game.container, document.body.firstChild);
                var t = document.body.style;
                t.width = window.innerWidth + "px", t.height = window.innerHeight + "px", t.overflow = "hidden";
                var e = cc.game.container.style;
                e.position = "fixed", e.left = e.top = "0px", document.body.scrollTop = 0;
            }
        }), cc.ContentStrategy = cc.Class({
            name: "ContentStrategy",
            ctor: function() {
                this._result = {
                    scale: [ 1, 1 ],
                    viewport: null
                };
            },
            _buildResult: function(t, e, i, n, r, s) {
                Math.abs(t - i) < 2 && (i = t), Math.abs(e - n) < 2 && (n = e);
                var o = cc.rect((t - i) / 2, (e - n) / 2, i, n);
                return cc.game.renderType, cc.game.RENDER_TYPE_CANVAS, this._result.scale = [ r, s ], 
                this._result.viewport = o, this._result;
            },
            preApply: function() {},
            apply: function() {
                return {
                    scale: [ 1, 1 ]
                };
            },
            postApply: function() {}
        }), function() {
            var t = cc.Class({
                name: "EqualToFrame",
                extends: cc.ContainerStrategy,
                apply: function(t) {
                    var e = t._frameSize.height, i = cc.game.container.style;
                    this._setupContainer(t, t._frameSize.width, t._frameSize.height), t._isRotated ? i.margin = "0 0 0 " + e + "px" : i.margin = "0px", 
                    i.padding = "0px";
                }
            }), e = cc.Class({
                name: "ProportionalToFrame",
                extends: cc.ContainerStrategy,
                apply: function(t, e) {
                    var i, n, r = t._frameSize.width, s = t._frameSize.height, o = cc.game.container.style, a = e.width, c = e.height, l = r / a, u = s / c;
                    l < u ? (i = r, n = c * l) : (i = a * u, n = s);
                    var h = Math.round((r - i) / 2), _ = Math.round((s - n) / 2);
                    i = r - 2 * h, n = s - 2 * _, this._setupContainer(t, i, n), t._isRotated ? o.margin = "0 0 0 " + s + "px" : o.margin = "0px", 
                    o.paddingLeft = h + "px", o.paddingRight = h + "px", o.paddingTop = _ + "px", o.paddingBottom = _ + "px";
                }
            }), i = (cc.Class({
                name: "EqualToWindow",
                extends: t,
                preApply: function(t) {
                    this._super(t), cc.game.frame = document.documentElement;
                },
                apply: function(t) {
                    this._super(t), this._fixContainer();
                }
            }), cc.Class({
                name: "ProportionalToWindow",
                extends: e,
                preApply: function(t) {
                    this._super(t), cc.game.frame = document.documentElement;
                },
                apply: function(t, e) {
                    this._super(t, e), this._fixContainer();
                }
            }), cc.Class({
                name: "OriginalContainer",
                extends: cc.ContainerStrategy,
                apply: function(t) {
                    this._setupContainer(t, cc.game.canvas.width, cc.game.canvas.height);
                }
            })), n = ("undefined" == typeof window ? global : window).__globalAdapter;
            n && (n.adaptContainerStrategy && n.adaptContainerStrategy(cc.ContainerStrategy.prototype), 
            n.adaptView && n.adaptView(a.prototype)), cc.ContainerStrategy.EQUAL_TO_FRAME = new t(), 
            cc.ContainerStrategy.PROPORTION_TO_FRAME = new e(), cc.ContainerStrategy.ORIGINAL_CONTAINER = new i();
            var r = cc.Class({
                name: "ExactFit",
                extends: cc.ContentStrategy,
                apply: function(t, e) {
                    var i = cc.game.canvas.width, n = cc.game.canvas.height, r = i / e.width, s = n / e.height;
                    return this._buildResult(i, n, i, n, r, s);
                }
            }), s = cc.Class({
                name: "ShowAll",
                extends: cc.ContentStrategy,
                apply: function(t, e) {
                    var i, n, r = cc.game.canvas.width, s = cc.game.canvas.height, o = e.width, a = e.height, c = r / o, l = s / a, u = 0;
                    return c < l ? (i = r, n = a * (u = c)) : (i = o * (u = l), n = s), this._buildResult(r, s, i, n, u, u);
                }
            }), o = cc.Class({
                name: "NoBorder",
                extends: cc.ContentStrategy,
                apply: function(t, e) {
                    var i, n, r, s = cc.game.canvas.width, o = cc.game.canvas.height, a = e.width, c = e.height, l = s / a, u = o / c;
                    return l < u ? (n = a * (i = u), r = o) : (n = s, r = c * (i = l)), this._buildResult(s, o, n, r, i, i);
                }
            }), c = cc.Class({
                name: "FixedHeight",
                extends: cc.ContentStrategy,
                apply: function(t, e) {
                    var i = cc.game.canvas.width, n = cc.game.canvas.height, r = n / e.height, s = i, o = n;
                    return this._buildResult(i, n, s, o, r, r);
                }
            }), l = cc.Class({
                name: "FixedWidth",
                extends: cc.ContentStrategy,
                apply: function(t, e) {
                    var i = cc.game.canvas.width, n = cc.game.canvas.height, r = i / e.width, s = i, o = n;
                    return this._buildResult(i, n, s, o, r, r);
                }
            });
            cc.ContentStrategy.EXACT_FIT = new r(), cc.ContentStrategy.SHOW_ALL = new s(), cc.ContentStrategy.NO_BORDER = new o(), 
            cc.ContentStrategy.FIXED_HEIGHT = new c(), cc.ContentStrategy.FIXED_WIDTH = new l();
        }(), cc.ResolutionPolicy = cc.Class({
            name: "cc.ResolutionPolicy",
            ctor: function(t, e) {
                this._containerStrategy = null, this._contentStrategy = null, this.setContainerStrategy(t), 
                this.setContentStrategy(e);
            },
            preApply: function(t) {
                this._containerStrategy.preApply(t), this._contentStrategy.preApply(t);
            },
            apply: function(t, e) {
                return this._containerStrategy.apply(t, e), this._contentStrategy.apply(t, e);
            },
            postApply: function(t) {
                this._containerStrategy.postApply(t), this._contentStrategy.postApply(t);
            },
            setContainerStrategy: function(t) {
                t instanceof cc.ContainerStrategy && (this._containerStrategy = t);
            },
            setContentStrategy: function(t) {
                t instanceof cc.ContentStrategy && (this._contentStrategy = t);
            }
        }), n.get(cc.ResolutionPolicy.prototype, "canvasSize", function() {
            return cc.v2(cc.game.canvas.width, cc.game.canvas.height);
        }), cc.ResolutionPolicy.EXACT_FIT = 0, cc.ResolutionPolicy.NO_BORDER = 1, cc.ResolutionPolicy.SHOW_ALL = 2, 
        cc.ResolutionPolicy.FIXED_HEIGHT = 3, cc.ResolutionPolicy.FIXED_WIDTH = 4, cc.ResolutionPolicy.UNKNOWN = 5, 
        cc.view = new a(), cc.winSize = cc.size(), e.exports = cc.view;
    }, {
        "../event/event-target": 129,
        "../platform/CCClass": 182,
        "../platform/js": 203,
        "../renderer": 213
    } ],
    193: [ function() {
        "use strict";
        cc.visibleRect = {
            topLeft: cc.v2(0, 0),
            topRight: cc.v2(0, 0),
            top: cc.v2(0, 0),
            bottomLeft: cc.v2(0, 0),
            bottomRight: cc.v2(0, 0),
            bottom: cc.v2(0, 0),
            center: cc.v2(0, 0),
            left: cc.v2(0, 0),
            right: cc.v2(0, 0),
            width: 0,
            height: 0,
            init: function(t) {
                var e = this.width = t.width, i = this.height = t.height, n = t.x, r = t.y, s = r + i, o = n + e;
                this.topLeft.x = n, this.topLeft.y = s, this.topRight.x = o, this.topRight.y = s, 
                this.top.x = n + e / 2, this.top.y = s, this.bottomLeft.x = n, this.bottomLeft.y = r, 
                this.bottomRight.x = o, this.bottomRight.y = r, this.bottom.x = n + e / 2, this.bottom.y = r, 
                this.center.x = n + e / 2, this.center.y = r + i / 2, this.left.x = n, this.left.y = r + i / 2, 
                this.right.x = o, this.right.y = r + i / 2;
            }
        };
    }, {} ],
    194: [ function(t, e) {
        "use strict";
        var i = t("./js"), n = (t("./utils").isPlainEmptyObj_DEV, "$_$");
        function r(t, e) {
            var n = e ? Object.create(e) : {};
            return i.value(t, "__attrs__", n), n;
        }
        function s(t) {
            if ("function" != typeof t) return r(t, o(t.constructor));
            for (var e, i = cc.Class.getInheritanceChain(t), n = i.length - 1; n >= 0; n--) {
                var s = i[n];
                s.hasOwnProperty("__attrs__") && s.__attrs__ || r(s, (e = i[n + 1]) && e.__attrs__);
            }
            return r(t, (e = i[0]) && e.__attrs__), t.__attrs__;
        }
        function o(t) {
            return t.hasOwnProperty("__attrs__") && t.__attrs__ || s(t);
        }
        function a(t, e) {
            this.name = t, this.default = e;
        }
        a.prototype.toString = function() {
            return this.name;
        }, cc.Integer = new a("Integer", 0), cc.Float = new a("Float", 0), cc.Boolean = new a("Boolean", !1), 
        cc.String = new a("String", ""), e.exports = {
            PrimitiveType: a,
            attr: function(t, e) {
                var i = o(t), r = e + n, s = {};
                for (var a in i) a.startsWith(r) && (s[a.slice(r.length)] = i[a]);
                return s;
            },
            getClassAttrs: o,
            setClassAttr: function(t, e, i, r) {
                o(t)[e + n + i] = r;
            },
            DELIMETER: n,
            getTypeChecker_ET: !1,
            getObjTypeChecker_ET: !1,
            ScriptUuid: {}
        };
    }, {
        "./CCClass": 182,
        "./js": 203,
        "./utils": 206
    } ],
    195: [ function(t, e) {
        "use strict";
        var i = t("./js"), n = i.array.fastRemoveAt;
        function r() {}
        function s() {
            this.callback = r, this.target = void 0, this.once = !1;
        }
        s.prototype.set = function(t, e, i) {
            this.callback = t, this.target = e, this.once = !!i;
        };
        var o = new i.Pool(function(t) {
            return t.callback = r, t.target = void 0, t.once = !1, !0;
        }, 32);
        function a() {
            this.callbackInfos = [], this.isInvoking = !1, this.containCanceled = !1;
        }
        o.get = function() {
            return this._get() || new s();
        };
        var c = a.prototype;
        c.removeByCallback = function(t) {
            for (var e = 0; e < this.callbackInfos.length; ++e) {
                var i = this.callbackInfos[e];
                i && i.callback === t && (o.put(i), n(this.callbackInfos, e), --e);
            }
        }, c.removeByTarget = function(t) {
            for (var e = 0; e < this.callbackInfos.length; ++e) {
                var i = this.callbackInfos[e];
                i && i.target === t && (o.put(i), n(this.callbackInfos, e), --e);
            }
        }, c.cancel = function(t) {
            var e = this.callbackInfos[t];
            e && (o.put(e), this.callbackInfos[t] = null), this.containCanceled = !0;
        }, c.cancelAll = function() {
            for (var t = 0; t < this.callbackInfos.length; t++) {
                var e = this.callbackInfos[t];
                e && (o.put(e), this.callbackInfos[t] = null);
            }
            this.containCanceled = !0;
        }, c.purgeCanceled = function() {
            for (var t = this.callbackInfos.length - 1; t >= 0; --t) this.callbackInfos[t] || n(this.callbackInfos, t);
            this.containCanceled = !1;
        }, c.clear = function() {
            this.cancelAll(), this.callbackInfos.length = 0, this.isInvoking = !1, this.containCanceled = !1;
        };
        var l = new i.Pool(function(t) {
            return t.callbackInfos = [], t.isInvoking = !1, t.containCanceled = !1, !0;
        }, 16);
        function u() {
            this._callbackTable = i.createMap(!0);
        }
        l.get = function() {
            return this._get() || new a();
        }, (c = u.prototype).on = function(t, e, i, n) {
            var r = this._callbackTable[t];
            r || (r = this._callbackTable[t] = l.get());
            var s = o.get();
            s.set(e, i, n), r.callbackInfos.push(s);
        }, c.hasEventListener = function(t, e, i) {
            var n = this._callbackTable[t];
            if (!n) return !1;
            var r = n.callbackInfos;
            if (!e) {
                if (n.isInvoking) {
                    for (var s = 0; s < r.length; ++s) if (r[s]) return !0;
                    return !1;
                }
                return r.length > 0;
            }
            for (var o = 0; o < r.length; ++o) {
                var a = r[o];
                if (a && a.callback === e && a.target === i) return !0;
            }
            return !1;
        }, c.removeAll = function(t) {
            if ("string" == typeof t) {
                var e = this._callbackTable[t];
                e && (e.isInvoking ? e.cancelAll() : (e.clear(), l.put(e), delete this._callbackTable[t]));
            } else if (t) for (var i in this._callbackTable) {
                var n = this._callbackTable[i];
                if (n.isInvoking) for (var r = n.callbackInfos, s = 0; s < r.length; ++s) {
                    var o = r[s];
                    o && o.target === t && n.cancel(s);
                } else n.removeByTarget(t);
            }
        }, c.off = function(t, e, i) {
            var r = this._callbackTable[t];
            if (r) for (var s = r.callbackInfos, a = 0; a < s.length; ++a) {
                var c = s[a];
                if (c && c.callback === e && c.target === i) {
                    r.isInvoking ? r.cancel(a) : (n(s, a), o.put(c));
                    break;
                }
            }
        }, c.emit = function(t, e, i, n, r, s) {
            var o = this._callbackTable[t];
            if (o) {
                var a = !o.isInvoking;
                o.isInvoking = !0;
                for (var c = o.callbackInfos, l = 0, u = c.length; l < u; ++l) {
                    var h = c[l];
                    if (h) {
                        var _ = h.target, f = h.callback;
                        h.once && this.off(t, f, _), _ ? f.call(_, e, i, n, r, s) : f(e, i, n, r, s);
                    }
                }
                a && (o.isInvoking = !1, o.containCanceled && o.purgeCanceled());
            }
        }, e.exports = u;
    }, {
        "./js": 203
    } ],
    196: [ function(t, e) {
        "use strict";
        function i(t, e) {
            for (var n = 0; n < e.length; n++) {
                var r = e[n];
                Array.isArray(r) ? i(t, r) : t.push(r);
            }
        }
        e.exports = {
            flattenCodeArray: function(t) {
                var e = [];
                return i(e, t), e.join("");
            }
        };
    }, {} ],
    197: [ function(t, e, i) {
        "use strict";
        i.__esModule = !0, i.default = V, i.unpackJSONs = function(t, e) {
            if (t[0] < 1) throw new Error(cc.debug.getError(5304, t[0]));
            P(t, !0, e), I(t);
            for (var i = new L(t[0]), n = t[1], r = t[2], s = t[3], o = t[4], a = t[y], c = 0; c < a.length; ++c) a[c].unshift(i, n, r, s, o);
            return a;
        }, i.packCustomObjData = function(t, e) {
            return [ 1, f, f, [ t ], f, [ e ], [ 0 ], f, [], [], [] ];
        }, i.hasNativeDep = function(t) {
            var e = t[5], i = e[e.length - 1];
            return "number" == typeof i && i < 0;
        }, i.getDependUuidList = function(t) {
            var e = t[1];
            return t[10].map(function(t) {
                return e[t];
            });
        };
        var n = _(t("./js")), r = _(t("../value-types/vec2")), s = _(t("../value-types/vec3")), o = _(t("../value-types/vec4")), a = _(t("../value-types/color")), c = _(t("../value-types/size")), l = _(t("../value-types/rect")), u = _(t("../value-types/quat")), h = _(t("../value-types/mat4"));
        function _(t) {
            return t && t.__esModule ? t : {
                default: t
            };
        }
        var f = 0, d = [ r.default, s.default, o.default, u.default, a.default, c.default, l.default, h.default ];
        function p(t, e) {
            t.x = e[1], t.y = e[2], t.z = e[3], t.w = e[4];
        }
        var m = [ function(t, e) {
            t.x = e[1], t.y = e[2];
        }, function(t, e) {
            t.x = e[1], t.y = e[2], t.z = e[3];
        }, p, p, function(t, e) {
            t._val = e[1];
        }, function(t, e) {
            t.width = e[1], t.height = e[2];
        }, function(t, e) {
            t.x = e[1], t.y = e[2], t.width = e[3], t.height = e[4];
        }, function(t, e) {
            h.default.fromArray(t, e, 1);
        } ], v = 0, y = 5, g = function() {
            function t() {
                this.uuidObjList = null, this.uuidPropList = null, this.uuidList = null;
            }
            var e = t.prototype;
            return e.init = function(t) {
                this.uuidObjList = t[8], this.uuidPropList = t[9], this.uuidList = t[10];
            }, e.reset = function() {
                this.uuidList = null, this.uuidObjList = null, this.uuidPropList = null;
            }, e.push = function(t, e, i) {
                this.uuidObjList.push(t), this.uuidPropList.push(e), this.uuidList.push(i);
            }, t;
        }();
        function x(t, e, i) {
            for (var n = t.length - 1, r = 0, s = 3 * t[n]; r < s; r += 3) {
                var o = t[r], a = e[t[r + 2]], c = t[r + 1];
                c >= 0 ? o[i[c]] = a : o[~c] = a;
            }
            for (;r < n; r += 3) {
                var l = e[t[r]], u = e[t[r + 2]], h = t[r + 1];
                h >= 0 ? l[i[h]] = u : l[~h] = u;
            }
        }
        function A(t, e) {
            for (var i = t[4][e[0]], n = i[0], r = new (0, n[0])(), s = n[1], o = n[2], a = i[i.length - 1], c = 1; c < a; ++c) r[s[i[c]]] = e[c];
            for (;c < e.length; ++c) {
                var l = s[i[c]], u = n[i[c] + o];
                (0, E[u])(t, r, l, e[c]);
            }
            return r;
        }
        function C(t, e, i) {
            var r = new e();
            return r._deserialize ? r._deserialize(i, t[0]) : cc.errorID(5303, n.default.getClassName(e)), 
            r;
        }
        function b(t, e, i, n) {
            n >= 0 ? e[i] = t[5][n] : t[7][3 * ~n] = e;
        }
        function S(t) {
            return function(e, i, n, r) {
                i[n] = r;
                for (var s = 0; s < r.length; ++s) t(e, r, s, r[s]);
            };
        }
        function T(t, e, i, n) {
            e[i] = null, t[8][n] = e;
        }
        function w(t, e, i, n) {
            e[i] = A(t, n);
        }
        g.pool = new n.default.Pool(function(t) {
            t.reset();
        }, 5), g.pool.get = function() {
            return this._get() || new g();
        };
        var E = new Array(13);
        function B(t) {
            var e = t[5], i = t[6], n = 0 === i ? 0 : i.length, r = e[e.length - 1], s = e.length - n;
            "number" != typeof r ? r = 0 : (r < 0 && (r = ~r), --s);
            for (var o = 0; o < s; ++o) e[o] = A(t, e[o]);
            for (var a = t[3], c = 0; c < n; ++c, ++o) {
                var l = i[c], u = e[o];
                if (l >= 0) {
                    var h = a[l];
                    e[o] = C(t, h, u);
                } else (0, E[l = ~l])(t, e, o, u);
            }
            return r;
        }
        function M(t, e) {
            return t || V.reportMissingClass(e), Object;
        }
        function R(t, e, i, n, r, s) {
            var o = t(e);
            if (!o) {
                if (r) return void (i[n] = function(e, i, n) {
                    return function() {
                        var r = t(n) || M(s, n);
                        return e[i] = r, new r();
                    };
                }(i, n, e));
                o = M(s, e);
            }
            i[n] = o;
        }
        function P(t, e, i) {
            for (var r = i || n.default._getClassById, s = t[3], o = 0; o < s.length; ++o) {
                var a = s[o];
                "string" != typeof a ? R(r, a[0], a, v, e, i) : R(r, a, s, o, e, i);
            }
        }
        function I(t) {
            var e = t[4];
            if (e) for (var i = t[3], n = 0; n < e.length; ++n) {
                var r = e[n];
                r[0] = i[r[0]];
            }
        }
        function D(t) {
            for (var e = t[5], i = t[2], n = t[1], r = t[8], s = t[9], o = t[10], a = 0; a < r.length; ++a) {
                var c = r[a];
                "number" == typeof c && (r[a] = e[c]);
                var l = s[a];
                "number" == typeof l && (l = l >= 0 ? i[l] : ~l, s[a] = l);
                var u = o[a];
                "number" == typeof u && (o[a] = n[u]);
            }
        }
        function V(t, e, i) {
            "string" == typeof t && (t = JSON.parse(t));
            var n = !e;
            (e = e || g.pool.get()).init(t), i = i || {};
            var r = t[0], s = !1;
            if ("object" == typeof r && (s = r.preprocessed, r = r.version), r < 1) throw new Error(cc.debug.getError(5304, r));
            i._version = r, i.result = e, t[0] = i, s || (P(t, !1, i.classFinder), I(t)), cc.game._isCloning = !0;
            var o = t[5], a = B(t);
            return cc.game._isCloning = !1, t[7] && x(t[7], o, t[2]), D(t), n && g.pool.put(e), 
            o[a];
        }
        E[0] = function(t, e, i, n) {
            e[i] = n;
        }, E[1] = b, E[2] = S(b), E[3] = S(T), E[4] = w, E[5] = function(t, e, i, n) {
            m[n[0]](e[i], n);
        }, E[6] = T, E[7] = function(t, e, i, n) {
            e[i].set(n);
        }, E[8] = function(t, e, i, n) {
            var r = new d[n[0]]();
            m[n[0]](r, n), e[i] = r;
        }, E[9] = S(w), E[10] = function(t, e, i, n) {
            var r = t[3][n[0]];
            e[i] = C(t, r, n[1]);
        }, E[11] = function(t, e, i, n) {
            var r = n[0];
            e[i] = r;
            for (var s = 1; s < n.length; s += 3) {
                var o = n[s], a = n[s + 1], c = n[s + 2];
                (0, E[a])(t, r, o, c);
            }
        }, E[12] = function(t, e, i, n) {
            var r = n[0];
            e[i] = r;
            for (var s = 0; s < r.length; ++s) {
                var o = r[s], a = n[s + 1];
                0 !== a && (0, E[a])(t, r, s, o);
            }
        }, V.Details = g;
        var L = function(t) {
            this.preprocessed = !0, this.version = t;
        };
    }, {
        "../value-types/color": 270,
        "../value-types/mat4": 273,
        "../value-types/quat": 274,
        "../value-types/rect": 275,
        "../value-types/size": 276,
        "../value-types/vec2": 280,
        "../value-types/vec3": 281,
        "../value-types/vec4": 282,
        "./js": 203
    } ],
    198: [ function(t) {
        "use strict";
        var e, i = (e = t("./deserialize-compiled")) && e.__esModule ? e : {
            default: e
        };
        i.default.reportMissingClass = function(t) {
            cc.warnID(5302, t);
        }, cc.deserialize = i.default;
    }, {
        "./deserialize-compiled": 197,
        "./deserialize-editor": void 0
    } ],
    199: [ function(t, e) {
        "use strict";
        var i = ".";
        function n(t) {
            this.id = 0 | 998 * Math.random(), this.prefix = t ? t + i : "";
        }
        n.prototype.getNewId = function() {
            return this.prefix + ++this.id;
        }, n.global = new n("global"), e.exports = n;
    }, {} ],
    200: [ function(t) {
        "use strict";
        t("./js"), t("./CCClass"), t("./CCClassDecorator"), t("./CCEnum"), t("./CCObject"), 
        t("./callbacks-invoker"), t("./deserialize"), t("./instantiate"), t("./instantiate-jit"), 
        t("./requiring-frame"), t("./CCSys"), t("./CCMacro"), t("./CCVisibleRect");
    }, {
        "./CCClass": 182,
        "./CCClassDecorator": 183,
        "./CCEnum": 184,
        "./CCMacro": 187,
        "./CCObject": 188,
        "./CCSys": 191,
        "./CCVisibleRect": 193,
        "./callbacks-invoker": 195,
        "./deserialize": 198,
        "./instantiate": 202,
        "./instantiate-jit": 201,
        "./js": 203,
        "./requiring-frame": 205
    } ],
    201: [ function(t, e) {
        "use strict";
        var i = t("./CCObject"), n = i.Flags.Destroyed, r = i.Flags.PersistentMask, s = t("./attribute"), o = t("./js"), a = t("./CCClass"), c = t("./compiler"), l = s.DELIMETER + "default", u = a.IDENTIFIER_RE, h = a.escapeForJS, _ = "var ", f = "o", d = "t", p = {
            "cc.Node": "cc.Node",
            "cc.Sprite": "cc.Sprite",
            "cc.Label": "cc.Label",
            "cc.Button": "cc.Button",
            "cc.Widget": "cc.Widget",
            "cc.Animation": "cc.Animation",
            "cc.ClickEvent": !1,
            "cc.PrefabInfo": !1
        };
        try {
            !Float32Array.name && (Float32Array.name = "Float32Array"), !Float64Array.name && (Float64Array.name = "Float64Array"), 
            !Int8Array.name && (Int8Array.name = "Int8Array"), !Int16Array.name && (Int16Array.name = "Int16Array"), 
            !Int32Array.name && (Int32Array.name = "Int32Array"), !Uint8Array.name && (Uint8Array.name = "Uint8Array"), 
            !Uint16Array.name && (Uint16Array.name = "Uint16Array"), !Uint32Array.name && (Uint32Array.name = "Uint32Array"), 
            !Uint8ClampedArray.name && (Uint8ClampedArray.name = "Uint8ClampedArray");
        } catch (T) {}
        function m(t) {
            if (t === Float32Array) return "Float32Array";
            if (t === Float64Array) return "Float64Array";
            if (t === Int8Array) return "Int8Array";
            if (t === Int16Array) return "Int16Array";
            if (t === Int32Array) return "Int32Array";
            if (t === Uint8Array) return "Uint8Array";
            if (t === Uint16Array) return "Uint16Array";
            if (t === Uint32Array) return "Uint32Array";
            if (t === Uint8ClampedArray) return "Uint8ClampedArray";
            throw new Error("Unknown TypedArray to instantiate: " + t);
        }
        function v(t, e) {
            this.varName = t, this.expression = e;
        }
        function y(t, e) {
            return e instanceof v ? new v(e.varName, t + e.expression) : t + e;
        }
        function g(t, e, i) {
            Array.isArray(i) ? (i[0] = y(e, i[0]), t.push(i)) : t.push(y(e, i) + ";");
        }
        function x(t) {
            this._exps = [], this._targetExp = t;
        }
        function A(t, e) {
            if ("function" == typeof t) try {
                t = t();
            } catch (T) {
                return !1;
            }
            if (t === e) return !0;
            if (t && e && "object" == typeof t && "object" == typeof e && t.constructor === e.constructor) if (t instanceof cc.ValueType) {
                if (t.equals(e)) return !0;
            } else {
                if (Array.isArray(t)) return 0 === t.length && 0 === e.length;
                if (t.constructor === Object) return o.isEmptyObject(t) && o.isEmptyObject(e);
            }
            return !1;
        }
        function C(t) {
            return u.test(t) ? "." + t : "[" + h(t) + "]";
        }
        function b(t, e) {
            var i;
            this.parent = e, this.objsToClear_iN$t = [], this.codeArray = [], this.objs = [], 
            this.funcs = [], this.funcModuleCache = o.createMap(), o.mixin(this.funcModuleCache, p), 
            this.globalVariables = [], this.globalVariableId = 0, this.localVariableId = 0, 
            this.codeArray.push(_ + f + "," + d + ";", "if(R){", f + "=R;", "}else{", f + "=R=new " + this.getFuncModule(t.constructor, !0) + "();", "}"), 
            o.value(t, "_iN$t", {
                globalVar: "R"
            }, !0), this.objsToClear_iN$t.push(t), this.enumerateObject(this.codeArray, t), 
            this.globalVariables.length > 0 && (i = _ + this.globalVariables.join(",") + ";");
            var n = c.flattenCodeArray([ "return (function(R){", i || [], this.codeArray, "return o;", "})" ]);
            this.result = Function("O", "F", n)(this.objs, this.funcs);
            for (var r = 0, s = this.objsToClear_iN$t.length; r < s; ++r) this.objsToClear_iN$t[r]._iN$t = null;
            this.objsToClear_iN$t.length = 0;
        }
        v.prototype.toString = function() {
            return _ + this.varName + "=" + this.expression + ";";
        }, x.prototype.append = function(t, e) {
            this._exps.push([ t, e ]);
        }, x.prototype.writeCode = function(t) {
            var e;
            if (this._exps.length > 1) t.push(d + "=" + this._targetExp + ";"), e = d; else {
                if (1 !== this._exps.length) return;
                e = this._targetExp;
            }
            for (var i = 0; i < this._exps.length; i++) {
                var n = this._exps[i];
                g(t, e + C(n[0]) + "=", n[1]);
            }
        }, x.pool = new o.Pool(function(t) {
            t._exps.length = 0, t._targetExp = null;
        }, 1), x.pool.get = function(t) {
            var e = this._get() || new x();
            return e._targetExp = t, e;
        };
        var S = b.prototype;
        S.getFuncModule = function(t, e) {
            var i = o.getClassName(t);
            if (i) {
                var n = this.funcModuleCache[i];
                if (n) return n;
                if (void 0 === n) {
                    var r = -1 !== i.indexOf(".");
                    if (r) try {
                        if (r = t === Function("return " + i)()) return this.funcModuleCache[i] = i, i;
                    } catch (T) {}
                }
            }
            var s = this.funcs.indexOf(t);
            s < 0 && (s = this.funcs.length, this.funcs.push(t));
            var a = "F[" + s + "]";
            return e && (a = "(" + a + ")"), this.funcModuleCache[i] = a, a;
        }, S.getObjRef = function(t) {
            var e = this.objs.indexOf(t);
            return e < 0 && (e = this.objs.length, this.objs.push(t)), "O[" + e + "]";
        }, S.setValueType = function(t, e, i, n) {
            var r = x.pool.get(n), s = e.constructor.__props__;
            s || (s = Object.keys(e));
            for (var o = 0; o < s.length; o++) {
                var a = s[o], c = i[a];
                if (e[a] !== c) {
                    var l = this.enumerateField(i, a, c);
                    r.append(a, l);
                }
            }
            r.writeCode(t), x.pool.put(r);
        }, S.enumerateCCClass = function(t, e, i) {
            for (var n = i.__values__, r = s.getClassAttrs(i), o = 0; o < n.length; o++) {
                var c = n[o], u = e[c], h = r[c + l];
                if (!A(h, u)) if ("object" == typeof u && u instanceof cc.ValueType && (h = a.getDefault(h)) && h.constructor === u.constructor) {
                    var _ = f + C(c);
                    this.setValueType(t, h, u, _);
                } else this.setObjProp(t, e, c, u);
            }
        }, S.instantiateArray = function(t) {
            if (0 === t.length) return "[]";
            var e = "a" + ++this.localVariableId, i = [ new v(e, "new Array(" + t.length + ")") ];
            o.value(t, "_iN$t", {
                globalVar: "",
                source: i
            }, !0), this.objsToClear_iN$t.push(t);
            for (var n = 0; n < t.length; ++n) g(i, e + "[" + n + "]=", this.enumerateField(t, n, t[n]));
            return i;
        }, S.instantiateTypedArray = function(t) {
            var e = t.constructor.name || m(t.constructor);
            if (0 === t.length) return "new " + e;
            var i = "a" + ++this.localVariableId, n = [ new v(i, "new " + e + "(" + t.length + ")") ];
            t._iN$t = {
                globalVar: "",
                source: n
            }, this.objsToClear_iN$t.push(t);
            for (var r = 0; r < t.length; ++r) 0 !== t[r] && g(n, i + "[" + r + "]=", t[r]);
            return n;
        }, S.enumerateField = function(t, e, n) {
            if ("object" == typeof n && n) {
                var s = n._iN$t;
                if (s) {
                    var o = s.globalVar;
                    if (!o) {
                        o = s.globalVar = "v" + ++this.globalVariableId, this.globalVariables.push(o);
                        var a = s.source[0];
                        s.source[0] = y(o + "=", a);
                    }
                    return o;
                }
                return ArrayBuffer.isView(n) ? this.instantiateTypedArray(n) : Array.isArray(n) ? this.instantiateArray(n) : this.instantiateObj(n);
            }
            return "function" == typeof n ? this.getFuncModule(n) : "string" == typeof n ? h(n) : ("_objFlags" === e && t instanceof i && (n &= r), 
            n);
        }, S.setObjProp = function(t, e, i, n) {
            g(t, f + C(i) + "=", this.enumerateField(e, i, n));
        }, S.enumerateObject = function(t, e) {
            var i = e.constructor;
            if (cc.Class._isCCClass(i)) this.enumerateCCClass(t, e, i); else for (var n in e) if (e.hasOwnProperty(n) && (95 !== n.charCodeAt(0) || 95 !== n.charCodeAt(1) || "__type__" === n)) {
                var r = e[n];
                "object" == typeof r && r && r === e._iN$t || this.setObjProp(t, e, n, r);
            }
        }, S.instantiateObj = function(t) {
            if (t instanceof cc.ValueType) return a.getNewValueTypeCode(t);
            if (t instanceof cc.Asset) return this.getObjRef(t);
            if (t._objFlags & n) return null;
            var e, i = t.constructor;
            if (cc.Class._isCCClass(i)) {
                if (this.parent) if (this.parent instanceof cc.Component) {
                    if (t instanceof cc._BaseNode || t instanceof cc.Component) return this.getObjRef(t);
                } else if (this.parent instanceof cc._BaseNode) if (t instanceof cc._BaseNode) {
                    if (!t.isChildOf(this.parent)) return this.getObjRef(t);
                } else if (t instanceof cc.Component && !t.node.isChildOf(this.parent)) return this.getObjRef(t);
                e = new v(f, "new " + this.getFuncModule(i, !0) + "()");
            } else if (i === Object) e = new v(f, "{}"); else {
                if (i) return this.getObjRef(t);
                e = new v(f, "Object.create(null)");
            }
            var r = [ e ];
            return o.value(t, "_iN$t", {
                globalVar: "",
                source: r
            }, !0), this.objsToClear_iN$t.push(t), this.enumerateObject(r, t), [ "(function(){", r, "return o;})();" ];
        }, e.exports = {
            compile: function(t) {
                return new b(t, t instanceof cc._BaseNode && t).result;
            },
            equalsToDefault: A
        };
    }, {
        "./CCClass": 182,
        "./CCObject": 188,
        "./attribute": 194,
        "./compiler": 196,
        "./js": 203
    } ],
    202: [ function(t, e) {
        "use strict";
        var i = t("./CCObject"), n = t("../value-types/value-type"), r = i.Flags.Destroyed, s = i.Flags.PersistentMask, o = t("./utils").isDomNode, a = t("./js");
        function c(t, e) {
            if (!e) {
                if ("object" != typeof t || Array.isArray(t)) return null;
                if (!t) return null;
                if (!cc.isValid(t)) return null;
            }
            var n;
            if (t instanceof i) {
                if (t._instantiate) return cc.game._isCloning = !0, n = t._instantiate(null, !0), 
                cc.game._isCloning = !1, n;
                if (t instanceof cc.Asset) return null;
            }
            return cc.game._isCloning = !0, n = u(t), cc.game._isCloning = !1, n;
        }
        var l = [];
        function u(t, e) {
            if (Array.isArray(t)) return null;
            if (o && o(t)) return null;
            var i;
            _(t, i = t._iN$t ? t._iN$t : t.constructor ? new (0, t.constructor)() : Object.create(null), e);
            for (var n = 0, r = l.length; n < r; ++n) l[n]._iN$t = null;
            return l.length = 0, i;
        }
        function h(t, e, i, r) {
            for (var s = t.__values__, o = 0; o < s.length; o++) {
                var a = s[o], c = e[a];
                if ("object" == typeof c && c) {
                    var l = i[a];
                    l instanceof n && l.constructor === c.constructor ? l.set(c) : i[a] = c._iN$t || f(c, r);
                } else i[a] = c;
            }
        }
        function _(t, e, n) {
            a.value(t, "_iN$t", e, !0), l.push(t);
            var r = t.constructor;
            if (cc.Class._isCCClass(r)) h(r, t, e, n); else for (var o in t) if (t.hasOwnProperty(o) && (95 !== o.charCodeAt(0) || 95 !== o.charCodeAt(1) || "__type__" === o)) {
                var c = t[o];
                if ("object" == typeof c && c) {
                    if (c === e) continue;
                    e[o] = c._iN$t || f(c, n);
                } else e[o] = c;
            }
            t instanceof i && (e._objFlags &= s);
        }
        function f(t, e) {
            if (t instanceof n) return t.clone();
            if (t instanceof cc.Asset) return t;
            var i;
            if (ArrayBuffer.isView(t)) {
                var s = t.length;
                i = new t.constructor(s), t._iN$t = i, l.push(t);
                for (var o = 0; o < s; ++o) i[o] = t[o];
                return i;
            }
            if (Array.isArray(t)) {
                var c = t.length;
                i = new Array(c), a.value(t, "_iN$t", i, !0), l.push(t);
                for (var u = 0; u < c; ++u) {
                    var h = t[u];
                    i[u] = "object" == typeof h && h ? h._iN$t || f(h, e) : h;
                }
                return i;
            }
            if (t._objFlags & r) return null;
            var d = t.constructor;
            if (cc.Class._isCCClass(d)) {
                if (e) if (e instanceof cc.Component) {
                    if (t instanceof cc._BaseNode || t instanceof cc.Component) return t;
                } else if (e instanceof cc._BaseNode) if (t instanceof cc._BaseNode) {
                    if (!t.isChildOf(e)) return t;
                } else if (t instanceof cc.Component && !t.node.isChildOf(e)) return t;
                i = new d();
            } else if (d === Object) i = {}; else {
                if (d) return t;
                i = Object.create(null);
            }
            return _(t, i, e), i;
        }
        c._clone = u, cc.instantiate = c, e.exports = c;
    }, {
        "../value-types/value-type": 279,
        "./CCObject": 188,
        "./js": 203,
        "./utils": 206
    } ],
    203: [ function(t, e) {
        "use strict";
        var i = new (t("./id-generater"))("TmpCId.");
        function n(t, e) {
            for (;t; ) {
                var i = Object.getOwnPropertyDescriptor(t, e);
                if (i) return i;
                t = Object.getPrototypeOf(t);
            }
            return null;
        }
        function r(t, e, i) {
            var r = n(e, t);
            Object.defineProperty(i, t, r);
        }
        var s = {
            isNumber: function(t) {
                return "number" == typeof t || t instanceof Number;
            },
            isString: function(t) {
                return "string" == typeof t || t instanceof String;
            },
            addon: function(t) {
                t = t || {};
                for (var e = 1, i = arguments.length; e < i; e++) {
                    var n = arguments[e];
                    if (n) {
                        if ("object" != typeof n) {
                            cc.errorID(5402, n);
                            continue;
                        }
                        for (var s in n) s in t || r(s, n, t);
                    }
                }
                return t;
            },
            mixin: function(t) {
                t = t || {};
                for (var e = 1, i = arguments.length; e < i; e++) {
                    var n = arguments[e];
                    if (n) {
                        if ("object" != typeof n) {
                            cc.errorID(5403, n);
                            continue;
                        }
                        for (var s in n) r(s, n, t);
                    }
                }
                return t;
            },
            extend: function(t, e) {
                for (var i in e) e.hasOwnProperty(i) && (t[i] = e[i]);
                return t.prototype = Object.create(e.prototype, {
                    constructor: {
                        value: t,
                        writable: !0,
                        configurable: !0
                    }
                }), t;
            },
            getSuper: function(t) {
                var e = t.prototype, i = e && Object.getPrototypeOf(e);
                return i && i.constructor;
            },
            isChildClassOf: function(t, e) {
                if (t && e) {
                    if ("function" != typeof t) return !1;
                    if ("function" != typeof e) return !1;
                    if (t === e) return !0;
                    for (;;) {
                        if (!(t = s.getSuper(t))) return !1;
                        if (t === e) return !0;
                    }
                }
                return !1;
            },
            clear: function(t) {
                for (var e = Object.keys(t), i = 0; i < e.length; i++) delete t[e[i]];
            },
            isEmptyObject: function(t) {
                for (var e in t) return !1;
                return !0;
            },
            getPropertyDescriptor: n
        }, o = {
            value: void 0,
            enumerable: !1,
            writable: !1,
            configurable: !0
        };
        s.value = function(t, e, i, n, r) {
            o.value = i, o.writable = n, o.enumerable = r, Object.defineProperty(t, e, o), o.value = void 0;
        };
        var a = {
            get: null,
            set: null,
            enumerable: !1
        };
        s.getset = function(t, e, i, n, r, s) {
            "function" != typeof n && (r = n, n = void 0), a.get = i, a.set = n, a.enumerable = r, 
            a.configurable = s, Object.defineProperty(t, e, a), a.get = null, a.set = null;
        };
        var c = {
            get: null,
            enumerable: !1,
            configurable: !1
        };
        s.get = function(t, e, i, n, r) {
            c.get = i, c.enumerable = n, c.configurable = r, Object.defineProperty(t, e, c), 
            c.get = null;
        };
        var l = {
            set: null,
            enumerable: !1,
            configurable: !1
        };
        s.set = function(t, e, i, n, r) {
            l.set = i, l.enumerable = n, l.configurable = r, Object.defineProperty(t, e, l), 
            l.set = null;
        }, s.getClassName = function(t) {
            if ("function" == typeof t) {
                var e = t.prototype;
                if (e && e.hasOwnProperty("__classname__") && e.__classname__) return e.__classname__;
                var i = "";
                if (t.name && (i = t.name), t.toString) {
                    var n, r = t.toString();
                    (n = "[" === r.charAt(0) ? r.match(/\[\w+\s*(\w+)\]/) : r.match(/function\s*(\w+)/)) && 2 === n.length && (i = n[1]);
                }
                return "Object" !== i ? i : "";
            }
            return t && t.constructor ? s.getClassName(t.constructor) : "";
        }, function() {
            var t = {}, e = {};
            function n(t, e, i) {
                return s.getset(s, e, function() {
                    return Object.assign({}, i);
                }, function(t) {
                    s.clear(i), Object.assign(i, t);
                }), function(e, n) {
                    if (n.prototype.hasOwnProperty(t) && delete i[n.prototype[t]], s.value(n.prototype, t, e), 
                    e) {
                        var r = i[e];
                        if (r && r !== n) {
                            var o = "A Class already exists with the same " + t + ' : "' + e + '".';
                            cc.error(o);
                        } else i[e] = n;
                    }
                };
            }
            s._setClassId = n("__cid__", "_registeredClassIds", t);
            var r = n("__classname__", "_registeredClassNames", e);
            s.setClassName = function(t, e) {
                if (r(t, e), !e.prototype.hasOwnProperty("__cid__")) {
                    var n = t || i.getNewId();
                    n && s._setClassId(n, e);
                }
            }, s.unregisterClass = function() {
                for (var i = 0; i < arguments.length; i++) {
                    var n = arguments[i].prototype, r = n.__cid__;
                    r && delete t[r];
                    var s = n.__classname__;
                    s && delete e[s];
                }
            }, s._getClassById = function(e) {
                return t[e];
            }, s.getClassByName = function(t) {
                return e[t];
            }, s._getClassId = function(t, e) {
                if (e = void 0 === e || e, "function" == typeof t && t.prototype.hasOwnProperty("__cid__")) return t.prototype.__cid__;
                if (t && t.constructor) {
                    var i = t.constructor.prototype;
                    if (i && i.hasOwnProperty("__cid__")) return t.__cid__;
                }
                return "";
            };
        }(), s.obsolete = function(t, e, i, n) {
            var r = /([^.]+)$/, o = r.exec(e)[0], a = r.exec(i)[0];
            function c() {
                return this[a];
            }
            n ? s.getset(t, o, c, function(t) {
                this[a] = t;
            }) : s.get(t, o, c);
        }, s.obsoletes = function(t, e, i, n) {
            for (var r in i) {
                var o = i[r];
                s.obsolete(t, e + "." + r, o, n);
            }
        };
        var u = /(%d)|(%s)/, h = /%s/;
        function _(t, e) {
            t.splice(e, 1);
        }
        function f(t, e) {
            var i = t.indexOf(e);
            return i >= 0 && (_(t, i), !0);
        }
        function d(t, e) {
            void 0 === e && (e = t, t = null), this.get = null, this.count = 0, this._pool = new Array(e), 
            this._cleanup = t;
        }
        s.formatStr = function() {
            var t = arguments.length;
            if (0 === t) return "";
            var e = arguments[0];
            if (1 === t) return "" + e;
            var i = "string" == typeof e && u.test(e);
            if (i) for (var n = 1; n < t; ++n) {
                var r = arguments[n], s = "number" == typeof r ? u : h;
                if (s.test(e)) {
                    var o = "" + r;
                    e = e.replace(s, o);
                } else e += " " + r;
            } else for (var a = 1; a < t; ++a) e += " " + arguments[a];
            return e;
        }, s.shiftArguments = function() {
            for (var t = arguments.length - 1, e = new Array(t), i = 0; i < t; ++i) e[i] = arguments[i + 1];
            return e;
        }, s.createMap = function(t) {
            var e = Object.create(null);
            return t && (e["."] = !0, e["/"] = !0, delete e["."], delete e["/"]), e;
        }, s.array = {
            remove: f,
            fastRemove: function(t, e) {
                var i = t.indexOf(e);
                i >= 0 && (t[i] = t[t.length - 1], --t.length);
            },
            removeAt: _,
            fastRemoveAt: function(t, e) {
                var i = t.length;
                e < 0 || e >= i || (t[e] = t[i - 1], t.length = i - 1);
            },
            contains: function(t, e) {
                return t.indexOf(e) >= 0;
            },
            verifyType: function(t, e) {
                if (t && t.length > 0) for (var i = 0; i < t.length; i++) if (!(t[i] instanceof e)) return cc.logID(1300), 
                !1;
                return !0;
            },
            removeArray: function(t, e) {
                for (var i = 0, n = e.length; i < n; i++) f(t, e[i]);
            },
            appendObjectsAt: function(t, e, i) {
                return t.splice.apply(t, [ i, 0 ].concat(e)), t;
            },
            copy: function(t) {
                var e, i = t.length, n = new Array(i);
                for (e = 0; e < i; e += 1) n[e] = t[e];
                return n;
            },
            MutableForwardIterator: t("../utils/mutable-forward-iterator")
        }, d.prototype._get = function() {
            if (this.count > 0) {
                --this.count;
                var t = this._pool[this.count];
                return this._pool[this.count] = null, t;
            }
            return null;
        }, d.prototype.put = function(t) {
            var e = this._pool;
            if (this.count < e.length) {
                if (this._cleanup && !1 === this._cleanup(t)) return;
                e[this.count] = t, ++this.count;
            }
        }, d.prototype.resize = function(t) {
            t >= 0 && (this._pool.length = t, this.count > t && (this.count = t));
        }, s.Pool = d, cc.js = s, e.exports = s;
    }, {
        "../utils/mutable-forward-iterator": 257,
        "./id-generater": 199
    } ],
    204: [ function(t, e, i) {
        "use strict";
        var n = t("./js"), r = t("./attribute"), s = {
            default: {},
            serializable: {},
            editorOnly: {},
            formerlySerializedAs: {}
        };
        function o(t, e, i, n) {
            if (!t.get && !t.set && t.hasOwnProperty("default")) {
                var r = "_N$" + e;
                t.get = function() {
                    return this[r];
                }, t.set = function(t) {
                    var e = this[r];
                    this[r] = t, i.call(this, e);
                };
                var o = {};
                for (var a in n[r] = o, s) {
                    var c = s[a];
                    t.hasOwnProperty(a) && (o[a] = t[a], c.canUsedInGet || delete t[a]);
                }
            }
        }
        function a(t, e, i, n) {
            if (Array.isArray(e)) {
                if (!(e.length > 0)) return cc.errorID(5508, i, n);
                t.type = e = e[0];
            }
            "function" == typeof e && (e === String ? t.type = cc.String : e === Boolean ? t.type = cc.Boolean : e === Number && (t.type = cc.Float));
        }
        function c(t, e, i) {
            var n = t ? {
                _short: !0
            } : {
                _short: !0,
                default: e
            };
            return i && (n.type = i), n;
        }
        i.getFullFormOfProperty = function(t, e) {
            return t && t.constructor === Object ? null : Array.isArray(t) && t.length > 0 ? c(e, [], t) : "function" == typeof t ? c(e, n.isChildClassOf(t, cc.ValueType) ? new t() : null, t) : t instanceof r.PrimitiveType ? c(e, t.default) : c(e, t);
        }, i.preprocessAttrs = function(t, e) {
            for (var n in t) {
                var r = t[n], s = i.getFullFormOfProperty(r, !1);
                if (s && (r = t[n] = s), r) {
                    var c = r.notify;
                    c && o(r, n, c, t), "type" in r && a(r, r.type, e, n);
                }
            }
        }, i.validateMethodWithProps = function(t) {
            return "function" == typeof t || null === t;
        };
    }, {
        "./CCClass": 182,
        "./attribute": 194,
        "./js": 203
    } ],
    205: [ function() {
        "use strict";
        var t = [];
        cc._RF = {
            push: function(e, i, n) {
                void 0 === n && (n = i, i = ""), t.push({
                    uuid: i,
                    script: n,
                    module: e,
                    exports: e.exports,
                    beh: null
                });
            },
            pop: function() {
                var e = t.pop(), i = e.module, n = i.exports;
                if (n === e.exports) {
                    for (var r in n) return;
                    i.exports = n = e.cls;
                }
            },
            peek: function() {
                return t[t.length - 1];
            }
        };
    }, {} ],
    206: [ function(t, e) {
        "use strict";
        t("./js"), e.exports = {
            contains: function(t, e) {
                if ("function" == typeof t.contains) return t.contains(e);
                if ("function" == typeof t.compareDocumentPosition) return !!(16 & t.compareDocumentPosition(e));
                var i = e.parentNode;
                if (i) do {
                    if (i === t) return !0;
                    i = i.parentNode;
                } while (null !== i);
                return !1;
            },
            isDomNode: "object" == typeof window && ("function" == typeof Node ? function(t) {
                return t instanceof Node;
            } : function(t) {
                return t && "object" == typeof t && "number" == typeof t.nodeType && "string" == typeof t.nodeName;
            }),
            callInNextTick: function(t, e, i) {
                t && setTimeout(function() {
                    t(e, i);
                }, 0);
            }
        };
    }, {
        "./js": 203
    } ],
    207: [ function(t) {
        "use strict";
        t("./platform/js"), t("./value-types"), t("./utils"), t("./platform/CCInputManager"), 
        t("./platform/CCInputExtension"), t("./event"), t("./platform/CCSys"), t("./platform/CCMacro"), 
        t("./asset-manager"), t("./CCDirector"), t("./renderer"), t("./platform/CCView"), 
        t("./platform/CCScreen"), t("./CCScheduler"), t("./event-manager");
    }, {
        "./CCDirector": 23,
        "./CCScheduler": 28,
        "./asset-manager": 46,
        "./event": 131,
        "./event-manager": 127,
        "./platform/CCInputExtension": 185,
        "./platform/CCInputManager": 186,
        "./platform/CCMacro": 187,
        "./platform/CCScreen": 190,
        "./platform/CCSys": 191,
        "./platform/CCView": 192,
        "./platform/js": 203,
        "./renderer": 213,
        "./utils": 255,
        "./value-types": 271
    } ],
    208: [ function(t, e, i) {
        "use strict";
        i.__esModule = !0, i.default = void 0;
        var n = o(t("./assembler")), r = o(t("./utils/dynamic-atlas/manager")), s = o(t("./webgl/render-data"));
        function o(t) {
            return t && t.__esModule ? t : {
                default: t
            };
        }
        function a(t, e) {
            for (var i = 0; i < e.length; i++) {
                var n = e[i];
                n.enumerable = n.enumerable || !1, n.configurable = !0, "value" in n && (n.writable = !0), 
                Object.defineProperty(t, n.key, n);
            }
        }
        function c(t) {
            if (void 0 === t) throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
            return t;
        }
        t("../value-types");
        var l = function(t) {
            var e, i;
            function n() {
                var e;
                return (e = t.call(this) || this)._renderData = new s.default(), e._renderData.init(c(e)), 
                e.initData(), e.initLocal(), e;
            }
            i = t, (e = n).prototype = Object.create(i.prototype), e.prototype.constructor = e, 
            e.__proto__ = i;
            var o, l, u = n.prototype;
            return u.initData = function() {
                this._renderData.createQuadData(0, this.verticesFloats, this.indicesCount);
            }, u.initLocal = function() {
                this._local = [], this._local.length = 4;
            }, u.updateColor = function(t, e) {
                var i = this._renderData.uintVDatas[0];
                if (i) {
                    e = null != e ? e : t.node.color._val;
                    for (var n = this.floatsPerVert, r = this.colorOffset, s = i.length; r < s; r += n) i[r] = e;
                }
            }, u.getBuffer = function() {
                return cc.renderer._handle._meshBuffer;
            }, u.updateWorldVerts = function(t) {
                var e = this._local, i = this._renderData.vDatas[0], n = t.node._worldMatrix.m, r = n[0], s = n[1], o = n[4], a = n[5], c = n[12], l = n[13], u = e[0], h = e[2], _ = e[1], f = e[3], d = this.floatsPerVert, p = 0;
                if (1 === r && 0 === s && 0 === o && 1 === a) i[p] = u + c, i[p + 1] = _ + l, i[p += d] = h + c, 
                i[p + 1] = _ + l, i[p += d] = u + c, i[p + 1] = f + l, i[p += d] = h + c, i[p + 1] = f + l; else {
                    var m = r * u, v = r * h, y = s * u, g = s * h, x = o * _, A = o * f, C = a * _, b = a * f;
                    i[p] = m + x + c, i[p + 1] = y + C + l, i[p += d] = v + x + c, i[p + 1] = g + C + l, 
                    i[p += d] = m + A + c, i[p + 1] = y + b + l, i[p += d] = v + A + c, i[p + 1] = g + b + l;
                }
            }, u.fillBuffers = function(t, e) {
                e.worldMatDirty && this.updateWorldVerts(t);
                var i = this._renderData, n = i.vDatas[0], r = i.iDatas[0], s = this.getBuffer(e), o = s.request(this.verticesCount, this.indicesCount), a = o.byteOffset >> 2, c = s._vData;
                n.length + a > c.length ? c.set(n.subarray(0, c.length - a), a) : c.set(n, a);
                for (var l = s._iData, u = o.indiceOffset, h = o.vertexOffset, _ = 0, f = r.length; _ < f; _++) l[u++] = h + r[_];
            }, u.packToDynamicAtlas = function(t, e) {
                if (!e._original && r.default && e._texture.packable) {
                    var i = r.default.insertSpriteFrame(e);
                    i && e._setDynamicAtlasFrame(i);
                }
                var n = t._materials[0];
                n && n.getProperty("texture") !== e._texture && (t._vertsDirty = !0, t._updateMaterial());
            }, o = n, (l = [ {
                key: "verticesFloats",
                get: function() {
                    return this.verticesCount * this.floatsPerVert;
                }
            } ]) && a(o.prototype, l), n;
        }(n.default);
        i.default = l, cc.js.addon(l.prototype, {
            floatsPerVert: 5,
            verticesCount: 4,
            indicesCount: 6,
            uvOffset: 2,
            colorOffset: 4
        }), cc.Assembler2D = l, e.exports = i.default;
    }, {
        "../value-types": 271,
        "./assembler": 210,
        "./utils/dynamic-atlas/manager": 216,
        "./webgl/render-data": 244
    } ],
    209: [ function(t, e, i) {
        "use strict";
        i.__esModule = !0, i.default = void 0;
        var n, r = (n = t("../utils/pool")) && n.__esModule ? n : {
            default: n
        }, s = 0;
        function o(t) {
            return Object.getOwnPropertyDescriptor(t, "__assemblerId__") || (t.__assemblerId__ = ++s), 
            t.__assemblerId__;
        }
        var a = new (function(t) {
            var e, i;
            function n() {
                for (var e, i = arguments.length, n = new Array(i), r = 0; r < i; r++) n[r] = arguments[r];
                return (e = t.call.apply(t, [ this ].concat(n)) || this)._pool = {}, e;
            }
            i = t, (e = n).prototype = Object.create(i.prototype), e.prototype.constructor = e, 
            e.__proto__ = i;
            var r = n.prototype;
            return r.put = function(t) {
                if (t && this.enabled) {
                    var e = o(t.constructor), i = this._pool;
                    i[e] || (i[e] = []), this.count > this.maxSize || (this._clean(t), i[e].push(t), 
                    this.count++);
                }
            }, r.get = function(t) {
                var e;
                if (this.enabled) {
                    var i = this._pool, n = o(t);
                    e = i[n] && i[n].pop();
                }
                return e ? this.count-- : e = new t(), e;
            }, r.clear = function() {
                this._pool = {}, this.count = 0;
            }, r._clean = function(t) {
                t._renderComp = null;
            }, n;
        }(r.default))();
        r.default.register("assembler", a);
        var c = a;
        i.default = c, e.exports = i.default;
    }, {
        "../utils/pool": 258
    } ],
    210: [ function(t, e, i) {
        "use strict";
        i.__esModule = !0, i.default = void 0;
        var n, r = t("./webgl/vertex-format"), s = (n = t("./assembler-pool")) && n.__esModule ? n : {
            default: n
        }, o = function() {
            function t() {
                this._extendNative && this._extendNative();
            }
            var e = t.prototype;
            return e.init = function(t) {
                this._renderComp = t;
            }, e.updateRenderData = function() {}, e.fillBuffers = function() {}, e.getVfmt = function() {
                return r.vfmtPosUvColor;
            }, t;
        }();
        i.default = o, o.register = function(t, e) {
            t.__assembler__ = e;
        }, o.init = function(t) {
            for (var e = t.constructor, i = e.__assembler__; !i; ) {
                if (!(e = e.$super)) return void cc.warn("Can not find assembler for render component : [" + cc.js.getClassName(t) + "]");
                i = e.__assembler__;
            }
            if (i.getConstructor && (i = i.getConstructor(t)), !t._assembler || t._assembler.constructor !== i) {
                var n = s.default.get(i);
                n.init(t), t._assembler = n;
            }
        }, cc.Assembler = o, e.exports = i.default;
    }, {
        "./assembler-pool": 209,
        "./webgl/vertex-format": 246
    } ],
    211: [ function(t, e) {
        "use strict";
        var i = function(t) {
            var e;
            try {
                e = t.getContext("2d");
            } catch (i) {
                return void console.error(i);
            }
            this._canvas = t, this._ctx = e, this._caps = {}, this._stats = {
                drawcalls: 0
            }, this._vx = this._vy = this._vw = this._vh = 0, this._sx = this._sy = this._sw = this._sh = 0;
        };
        i.prototype._restoreTexture = function() {}, i.prototype.setViewport = function(t, e, i, n) {
            this._vx === t && this._vy === e && this._vw === i && this._vh === n || (this._vx = t, 
            this._vy = e, this._vw = i, this._vh = n);
        }, i.prototype.setScissor = function(t, e, i, n) {
            this._sx === t && this._sy === e && this._sw === i && this._sh === n || (this._sx = t, 
            this._sy = e, this._sw = i, this._sh = n);
        }, i.prototype.clear = function(t) {
            var e = this._ctx;
            e.clearRect(this._vx, this._vy, this._vw, this._vh), !t || 0 === t[0] && 0 === t[1] && 0 === t[2] || (e.fillStyle = "rgb(" + t[0] + "," + t[1] + "," + t[2] + ")", 
            e.globalAlpha = t[3], e.fillRect(this._vx, this._vy, this._vw, this._vh));
        }, i.prototype.resetDrawCalls = function() {
            this._stats.drawcalls = 0;
        }, i.prototype.getDrawCalls = function() {
            return this._stats.drawcalls;
        }, e.exports = i;
    }, {} ],
    212: [ function(t, e) {
        "use strict";
        var i = function(t, e) {
            this._device = t, this._width = 4, this._height = 4, this._image = null, e && (void 0 !== e.width && (this._width = e.width), 
            void 0 !== e.height && (this._height = e.height), this.updateImage(e));
        };
        i.prototype.update = function(t) {
            this.updateImage(t);
        }, i.prototype.updateImage = function(t) {
            if (t.images && t.images[0]) {
                var e = t.images[0];
                e && e !== this._image && (this._image = e);
            }
        }, i.prototype.destroy = function() {
            this._image = null;
        }, e.exports = i;
    }, {} ],
    213: [ function(t, e, i) {
        "use strict";
        i.__esModule = !0, i.default = void 0;
        var n = o(t("../../renderer/gfx")), r = o(t("../../renderer/core/input-assembler")), s = o(t("../../renderer/core/pass"));
        function o(t) {
            return t && t.__esModule ? t : {
                default: t
            };
        }
        var a = cc.renderer = {
            Texture2D: null,
            InputAssembler: r.default,
            Pass: s.default,
            renderEngine: null,
            canvas: null,
            device: null,
            scene: null,
            drawCalls: 0,
            _handle: null,
            _cameraNode: null,
            _camera: null,
            _forward: null,
            _flow: null,
            initWebGL: function(e, i) {
                t("./webgl/assemblers");
                var r = t("./webgl/model-batcher");
                this.Texture2D = n.default.Texture2D, this.canvas = e, this._flow = cc.RenderFlow;
                var s = t("../../renderer/scene/scene"), o = t("../../renderer/renderers/forward-renderer");
                this.device = new n.default.Device(e, i), this.scene = new s();
                var a, c = (a = this.device, {
                    defaultTexture: new n.default.Texture2D(a, {
                        images: [],
                        width: 128,
                        height: 128,
                        wrapS: n.default.WRAP_REPEAT,
                        wrapT: n.default.WRAP_REPEAT,
                        format: n.default.TEXTURE_FMT_RGB8,
                        genMipmaps: !1
                    }),
                    programTemplates: [],
                    programChunks: {}
                });
                this._forward = new o(this.device, c), this._handle = new r(this.device, this.scene), 
                this._flow.init(this._handle, this._forward);
            },
            initCanvas: function(e) {
                var i = t("./canvas"), n = t("./canvas/Texture2D"), r = t("./canvas/Device");
                this.Device = r, this.Texture2D = n, this.canvas = e, this.device = new r(e), this._camera = {
                    a: 1,
                    b: 0,
                    c: 0,
                    d: 1,
                    tx: 0,
                    ty: 0
                }, this._handle = new i.RenderComponentHandle(this.device, this._camera), this._forward = new i.ForwardRenderer(), 
                this._flow = cc.RenderFlow, this._flow.init(this._handle, this._forward);
            },
            updateCameraViewport: function() {
                if (cc.director) {
                    var t = cc.director.getScene();
                    t && t.setScale(1, 1, 1);
                }
                if (cc.game.renderType === cc.game.RENDER_TYPE_CANVAS) {
                    var e = cc.view.getViewportRect();
                    this.device.setViewport(e.x, e.y, e.width, e.height), this._camera.a = cc.view.getScaleX(), 
                    this._camera.d = cc.view.getScaleY(), this._camera.tx = e.x, this._camera.ty = e.y + e.height;
                }
            },
            render: function(t, e) {
                this.device.resetDrawCalls(), t && (this._flow.render(t, e), this.drawCalls = this.device.getDrawCalls());
            },
            clear: function() {
                this._handle.reset(), this._forward.clear();
            }
        };
        i.default = a, e.exports = i.default;
    }, {
        "../../renderer/core/input-assembler": 288,
        "../../renderer/core/pass": 289,
        "../../renderer/gfx": 298,
        "../../renderer/renderers/forward-renderer": 317,
        "../../renderer/scene/scene": 320,
        "./canvas": void 0,
        "./canvas/Device": 211,
        "./canvas/Texture2D": 212,
        "./webgl/assemblers": 225,
        "./webgl/model-batcher": 242
    } ],
    214: [ function(t, e) {
        "use strict";
        var i, n, r = 0, s = 1 << r++, o = 1 << r++, a = 1 << r++, c = 1 << r++, l = a | c, u = 1 << r++, h = 1 << r++, _ = 1 << r++, f = h | _, d = 1 << r++, p = 1 << r++, m = 1 << r++, v = 1 << r++, y = 0;
        function g() {
            this._func = T, this._next = null;
        }
        var x = g.prototype;
        x._doNothing = function() {}, x._localTransform = function(t) {
            t._updateLocalMatrix(), t._renderFlag &= ~a, this._next._func(t);
        }, x._worldTransform = function(t) {
            i.worldMatDirty++;
            var e = t._matrix, n = t._trs, r = e.m;
            r[12] = n[0], r[13] = n[1], r[14] = n[2], t._mulMat(t._worldMatrix, t._parent._worldMatrix, e), 
            t._renderFlag &= ~c, this._next._func(t), i.worldMatDirty--;
        }, x._opacity = function(t) {
            i.parentOpacityDirty++, this._next._func(t), t._renderFlag &= ~h, i.parentOpacityDirty--;
        }, x._color = function(t) {
            var e = t._renderComponent;
            e && e._updateColor(), t._renderFlag &= ~_, this._next._func(t);
        }, x._updateRenderData = function(t) {
            var e = t._renderComponent;
            e._assembler.updateRenderData(e), t._renderFlag &= ~u, this._next._func(t);
        }, x._render = function(t) {
            var e = t._renderComponent;
            e._checkBacth(i, t._cullingMask), e._assembler.fillBuffers(e, i), this._next._func(t);
        }, x._children = function(t) {
            for (var e = y, n = i, r = n.parentOpacity, s = n.parentOpacity *= t._opacity / 255, o = (n.worldMatDirty ? c : 0) | (n.parentOpacityDirty ? f : 0), a = t._children, l = 0, u = a.length; l < u; l++) {
                var h = a[l];
                if (h._renderFlag |= o, h._activeInHierarchy && 0 !== h._opacity) {
                    y = h._cullingMask = 0 === h.groupIndex ? e : 1 << h.groupIndex;
                    var _ = h._color._val;
                    h._color._fastSetA(h._opacity * s), C[h._renderFlag]._func(h), h._color._val = _;
                }
            }
            n.parentOpacity = r, this._next._func(t);
        }, x._postRender = function(t) {
            var e = t._renderComponent;
            e._checkBacth(i, t._cullingMask), e._assembler.postFillBuffers(e, i), this._next._func(t);
        };
        var A = new g();
        A._func = A._doNothing, A._next = A;
        var C = {};
        function b(t, e) {
            var i = new g();
            switch (i._next = e || A, t) {
              case s:
              case o:
                i._func = i._doNothing;
                break;

              case a:
                i._func = i._localTransform;
                break;

              case c:
                i._func = i._worldTransform;
                break;

              case h:
                i._func = i._opacity;
                break;

              case _:
                i._func = i._color;
                break;

              case u:
                i._func = i._updateRenderData;
                break;

              case d:
                i._func = i._render;
                break;

              case p:
                i._func = i._children;
                break;

              case m:
                i._func = i._postRender;
            }
            return i;
        }
        function S(t) {
            for (var e = null, i = v; i > 0; ) i & t && (e = b(i, e)), i >>= 1;
            return e;
        }
        function T(t) {
            var e = t._renderFlag;
            (C[e] = S(e))._func(t);
        }
        g.flows = C, g.createFlow = b;
        var w = [];
        g.registerValidate = function(t) {
            t._inValidateList || (w.push(t), t._inValidateList = !0);
        }, g.validateRenderers = function() {
            for (var t = 0, e = w.length; t < e; t++) {
                var i = w[t];
                i.isValid && (i.enabledInHierarchy ? i._validateRender() : i.disableRender(), i._inValidateList = !1);
            }
            w.length = 0;
        }, g.visitRootNode = function(t) {
            g.validateRenderers();
            var e = y;
            y = t._cullingMask, t._renderFlag & c ? (i.worldMatDirty++, t._calculWorldMatrix(), 
            t._renderFlag &= ~c, C[t._renderFlag]._func(t), i.worldMatDirty--) : C[t._renderFlag]._func(t), 
            y = e;
        }, g.render = function(t, e) {
            i.reset(), i.walking = !0, g.visitRootNode(t), i.terminate(), i.walking = !1, n.render(i._renderScene, e);
        }, g.renderCamera = function(t, e) {
            i.reset(), i.walking = !0, g.visitRootNode(e), i.terminate(), i.walking = !1, n.renderCamera(t, i._renderScene);
        }, g.init = function(t, e) {
            i = t, n = e, C[0] = A;
            for (var r = 1; r < v; r++) C[r] = new g();
        }, g.getBachther = function() {
            return i;
        }, g.FLAG_DONOTHING = s, g.FLAG_BREAK_FLOW = o, g.FLAG_LOCAL_TRANSFORM = a, g.FLAG_WORLD_TRANSFORM = c, 
        g.FLAG_TRANSFORM = l, g.FLAG_OPACITY = h, g.FLAG_COLOR = _, g.FLAG_OPACITY_COLOR = f, 
        g.FLAG_UPDATE_RENDER_DATA = u, g.FLAG_RENDER = d, g.FLAG_CHILDREN = p, g.FLAG_POST_RENDER = m, 
        g.FLAG_FINAL = v, e.exports = cc.RenderFlow = g;
    }, {} ],
    215: [ function(t, e) {
        "use strict";
        var i = t("../../../assets/CCRenderTexture"), n = 2;
        function r(t, e) {
            var r = new i();
            r.initWithSize(t, e), r.update(), this._texture = r, this._x = n, this._y = n, this._nexty = n, 
            this._width = t, this._height = e, this._innerTextureInfos = {}, this._innerSpriteFrames = [], 
            this._count = 0;
        }
        r.DEFAULT_HASH = new i()._getHash(), cc.js.mixin(r.prototype, {
            insertSpriteFrame: function(t) {
                var e = t._rect, i = t._texture, r = this._innerTextureInfos[i._id], s = e.x, o = e.y;
                if (r) s += r.x, o += r.y; else {
                    var a = i.width, c = i.height;
                    if (this._x + a + n > this._width && (this._x = n, this._y = this._nexty), this._y + c + n > this._nexty && (this._nexty = this._y + c + n), 
                    this._nexty > this._height) return null;
                    cc.dynamicAtlasManager.textureBleeding && ((a <= 8 || c <= 8) && (this._texture.drawTextureAt(i, this._x - 1, this._y - 1), 
                    this._texture.drawTextureAt(i, this._x - 1, this._y + 1), this._texture.drawTextureAt(i, this._x + 1, this._y - 1), 
                    this._texture.drawTextureAt(i, this._x + 1, this._y + 1)), this._texture.drawTextureAt(i, this._x - 1, this._y), 
                    this._texture.drawTextureAt(i, this._x + 1, this._y), this._texture.drawTextureAt(i, this._x, this._y - 1), 
                    this._texture.drawTextureAt(i, this._x, this._y + 1)), this._texture.drawTextureAt(i, this._x, this._y), 
                    this._innerTextureInfos[i._id] = {
                        x: this._x,
                        y: this._y,
                        texture: i
                    }, this._count++, s += this._x, o += this._y, this._x += a + n, this._dirty = !0;
                }
                var l = {
                    x: s,
                    y: o,
                    texture: this._texture
                };
                return this._innerSpriteFrames.push(t), l;
            },
            update: function() {
                this._dirty && (this._texture.update(), this._dirty = !1);
            },
            deleteInnerTexture: function(t) {
                t && this._innerTextureInfos[t._id] && (delete this._innerTextureInfos[t._id], this._count--);
            },
            isEmpty: function() {
                return this._count <= 0;
            },
            reset: function() {
                this._x = n, this._y = n, this._nexty = n;
                for (var t = this._innerSpriteFrames, e = 0, i = t.length; e < i; e++) {
                    var r = t[e];
                    r.isValid && r._resetDynamicAtlasFrame();
                }
                this._innerSpriteFrames.length = 0, this._innerTextureInfos = {};
            },
            destroy: function() {
                this.reset(), this._texture.destroy();
            }
        }), e.exports = r;
    }, {
        "../../../assets/CCRenderTexture": 66
    } ],
    216: [ function(t, e) {
        "use strict";
        var i = t("./atlas"), n = [], r = -1, s = 5, o = 2048, a = 512, c = !0;
        function l() {
            var t = n[++r];
            return t || (t = new i(o, o), n.push(t)), t;
        }
        function u() {
            _.reset();
        }
        var h = !1, _ = {
            Atlas: i,
            get enabled() {
                return h;
            },
            set enabled(t) {
                h !== t && (t ? (this.reset(), cc.director.on(cc.Director.EVENT_BEFORE_SCENE_LAUNCH, u)) : cc.director.off(cc.Director.EVENT_BEFORE_SCENE_LAUNCH, u), 
                h = t);
            },
            get maxAtlasCount() {
                return s;
            },
            set maxAtlasCount(t) {
                s = t;
            },
            get textureBleeding() {
                return c;
            },
            set textureBleeding(t) {
                c = t;
            },
            get textureSize() {
                return o;
            },
            set textureSize(t) {
                o = t;
            },
            get maxFrameSize() {
                return a;
            },
            set maxFrameSize(t) {
                a = t;
            },
            insertSpriteFrame: function(t) {
                if (!h || r === s || !t || t._original) return null;
                if (!t._texture.packable) return null;
                var e = n[r];
                e || (e = l());
                var i = e.insertSpriteFrame(t);
                return i || r === s ? i : (e = l()).insertSpriteFrame(t);
            },
            reset: function() {
                for (var t = 0, e = n.length; t < e; t++) n[t].destroy();
                n.length = 0, r = -1;
            },
            deleteAtlasSpriteFrame: function(t) {
                if (t._original) {
                    var e = t._original._texture;
                    this.deleteAtlasTexture(e);
                }
            },
            deleteAtlasTexture: function(t) {
                if (t) for (var e = n.length - 1; e >= 0; e--) n[e].deleteInnerTexture(t), n[e].isEmpty() && (n[e].destroy(), 
                n.splice(e, 1), r--);
            },
            showDebug: !1,
            update: function() {
                if (this.enabled) for (var t = 0; t <= r; t++) n[t].update();
            }
        };
        e.exports = cc.dynamicAtlasManager = _;
    }, {
        "./atlas": 215
    } ],
    217: [ function(t, e, i) {
        "use strict";
        i.__esModule = !0, i.default = void 0;
        var n, r = (n = t("../../assembler-2d")) && n.__esModule ? n : {
            default: n
        }, s = t("../../../utils/text-utils"), o = t("../../../platform/CCMacro"), a = t("../../../components/CCLabel").Overflow, c = t("../utils").shareLabelInfo, l = function() {
            this.char = "", this.valid = !0, this.x = 0, this.y = 0, this.line = 0, this.hash = "";
        }, u = cc.rect(), h = null, _ = [], f = [], d = [], p = [], m = null, v = 0, y = 0, g = 0, x = 0, A = 0, C = 1, b = null, S = cc.size(), T = "", w = 0, E = 0, B = 0, M = 0, R = 0, P = 0, I = 0, D = !1, V = 0, L = 0, O = 0, F = function(t) {
            var e, i;
            function n() {
                return t.apply(this, arguments) || this;
            }
            i = t, (e = n).prototype = Object.create(i.prototype), e.prototype.constructor = e, 
            e.__proto__ = i;
            var r = n.prototype;
            return r.updateRenderData = function(t) {
                t._vertsDirty && h !== t && (h = t, this._reserveQuads(t, t.string.toString().length), 
                this._updateFontFamily(t), this._updateProperties(t), this._updateLabelInfo(t), 
                this._updateContent(), this.updateWorldVerts(t), h._actualFontSize = w, h.node.setContentSize(S), 
                h._vertsDirty = !1, h = null, this._resetProperties());
            }, r._updateFontScale = function() {
                C = w / E;
            }, r._updateFontFamily = function(t) {
                var e = t.font;
                b = e.spriteFrame, m = e._fntConfig, c.fontAtlas = e._fontDefDictionary, this.packToDynamicAtlas(t, b);
            }, r._updateLabelInfo = function() {
                c.hash = "", c.margin = 0;
            }, r._updateProperties = function(t) {
                T = t.string.toString(), w = t.fontSize, E = m ? m.fontSize : t.fontSize, B = t.horizontalAlign, 
                M = t.verticalAlign, R = t.spacingX, I = t.overflow, P = t._lineHeight, S.width = t.node.width, 
                S.height = t.node.height, I === a.NONE ? (D = !1, S.width += 2 * c.margin, S.height += 2 * c.margin) : I === a.RESIZE_HEIGHT ? (D = !0, 
                S.height += 2 * c.margin) : D = t.enableWrapText, c.lineHeight = P, c.fontSize = w, 
                this._setupBMFontOverflowMetrics();
            }, r._resetProperties = function() {
                m = null, b = null, c.hash = "", c.margin = 0;
            }, r._updateContent = function() {
                this._updateFontScale(), this._computeHorizontalKerningForText(), this._alignText();
            }, r._computeHorizontalKerningForText = function() {
                var t, e = T, i = e.length, n = _;
                if (m && (t = m.kerningDict), t && !cc.js.isEmptyObject(t)) for (var r = -1, s = 0; s < i; ++s) {
                    var o = e.charCodeAt(s), a = t[r << 16 | 65535 & o] || 0;
                    n[s] = s < i - 1 ? a : 0, r = o;
                } else n.length = 0;
            }, r._multilineTextWrap = function(t) {
                for (var e = T.length, i = 0, n = 0, r = 0, o = 0, l = 0, u = 0, h = 0, f = null, p = cc.v2(0, 0), g = 0; g < e; ) {
                    var b = T.charAt(g);
                    if ("\n" !== b) {
                        for (var w = t(T, g, e), E = u, B = h, M = l, F = n, N = !1, G = 0; G < w; ++G) {
                            var k = g + G;
                            if ("\r" !== (b = T.charAt(k))) if (f = c.fontAtlas.getLetterDefinitionForChar(b, c)) {
                                var z = F + f.offsetX * C - c.margin;
                                if (D && O > 0 && n > 0 && z + f.w * C > O && !s.isUnicodeSpace(b)) {
                                    d.push(l), l = 0, i++, n = 0, r -= P * this._getFontScale() + 0, N = !0;
                                    break;
                                }
                                p.x = z, p.y = r - f.offsetY * C + c.margin, this._recordLetterInfo(p, b, k, i), 
                                k + 1 < _.length && k < e - 1 && (F += _[k + 1]), F += f.xAdvance * C + R - 2 * c.margin, 
                                M = p.x + f.w * C - c.margin, E < p.y && (E = p.y), B > p.y - f.h * C && (B = p.y - f.h * C);
                            } else {
                                this._recordPlaceholderInfo(k, b);
                                var U = "";
                                m && (U = m.atlasName), console.log("Can't find letter definition in texture atlas " + U + " for letter:" + b);
                            } else this._recordPlaceholderInfo(k, b);
                        }
                        N || (n = F, u < E && (u = E), h > B && (h = B), o < (l = M) && (o = l), g += w);
                    } else d.push(l), l = 0, i++, n = 0, r -= P * this._getFontScale() + 0, this._recordPlaceholderInfo(g, b), 
                    g++;
                }
                return d.push(l), y = (v = i + 1) * P * this._getFontScale(), v > 1 && (y += 0 * (v - 1)), 
                S.width = V, S.height = L, V <= 0 && (S.width = parseFloat(o.toFixed(2)) + 2 * c.margin), 
                L <= 0 && (S.height = parseFloat(y.toFixed(2)) + 2 * c.margin), x = S.height, A = 0, 
                I !== a.CLAMP && (u > 0 && (x = S.height + u), h < -y && (A = y + h)), !0;
            }, r._getFirstCharLen = function() {
                return 1;
            }, r._getFontScale = function() {
                return I === a.SHRINK ? C : 1;
            }, r._getFirstWordLen = function(t, e, i) {
                var n = t.charAt(e);
                if (s.isUnicodeCJK(n) || "\n" === n || s.isUnicodeSpace(n)) return 1;
                var r = 1, o = c.fontAtlas.getLetterDefinitionForChar(n, c);
                if (!o) return r;
                for (var a = o.xAdvance * C + R, l = e + 1; l < i && (n = t.charAt(l), o = c.fontAtlas.getLetterDefinitionForChar(n, c)); ++l) {
                    if (a + o.offsetX * C + o.w * C > O && !s.isUnicodeSpace(n) && O > 0) return r;
                    if (a += o.xAdvance * C + R, "\n" === n || s.isUnicodeSpace(n) || s.isUnicodeCJK(n)) break;
                    r++;
                }
                return r;
            }, r._multilineTextWrapByWord = function() {
                return this._multilineTextWrap(this._getFirstWordLen);
            }, r._multilineTextWrapByChar = function() {
                return this._multilineTextWrap(this._getFirstCharLen);
            }, r._recordPlaceholderInfo = function(t, e) {
                if (t >= f.length) {
                    var i = new l();
                    f.push(i);
                }
                f[t].char = e, f[t].hash = e.charCodeAt(0) + c.hash, f[t].valid = !1;
            }, r._recordLetterInfo = function(t, e, i, n) {
                if (i >= f.length) {
                    var r = new l();
                    f.push(r);
                }
                var s = e.charCodeAt(0) + c.hash;
                f[i].line = n, f[i].char = e, f[i].hash = s, f[i].valid = c.fontAtlas.getLetter(s).valid, 
                f[i].x = t.x, f[i].y = t.y;
            }, r._alignText = function() {
                y = 0, d.length = 0, this._multilineTextWrapByWord(), this._computeAlignmentOffset(), 
                I === a.SHRINK && w > 0 && this._isVerticalClamp() && this._shrinkLabelToContentSize(this._isVerticalClamp), 
                this._updateQuads() || I === a.SHRINK && this._shrinkLabelToContentSize(this._isHorizontalClamp);
            }, r._scaleFontSizeDown = function(t) {
                var e = !0;
                t || (t = .1, e = !1), w = t, e && this._updateContent();
            }, r._shrinkLabelToContentSize = function(t) {
                for (var e = 0, i = 0 | w, n = 0; e < i; ) {
                    var r = n = e + i + 1 >> 1;
                    if (r <= 0) break;
                    C = r / E, this._multilineTextWrapByWord(), this._computeAlignmentOffset(), t() ? i = n - 1 : e = n;
                }
                var s = e;
                s >= 0 && this._scaleFontSizeDown(s);
            }, r._isVerticalClamp = function() {
                return y > S.height;
            }, r._isHorizontalClamp = function() {
                for (var t = !1, e = 0, i = T.length; e < i; ++e) {
                    var n = f[e];
                    if (n.valid) {
                        var r = c.fontAtlas.getLetter(n.hash), s = n.x + r.w * C, o = n.line;
                        if (V > 0) if (D) {
                            if (d[o] > S.width && (s > S.width || s < 0)) {
                                t = !0;
                                break;
                            }
                        } else if (s > S.width) {
                            t = !0;
                            break;
                        }
                    }
                }
                return t;
            }, r._isHorizontalClamped = function(t, e) {
                var i = d[e], n = t > S.width || t < 0;
                return D ? i > S.width && n : n;
            }, r._updateQuads = function() {
                var t = b ? b._texture : c.fontAtlas.getTexture(), e = h.node;
                this.verticesCount = this.indicesCount = 0, this._renderData && (this._renderData.dataLength = 0);
                for (var i = S, n = e._anchorPoint.x * i.width, r = e._anchorPoint.y * i.height, s = !0, o = 0, l = T.length; o < l; ++o) {
                    var _ = f[o];
                    if (_.valid) {
                        var d = c.fontAtlas.getLetter(_.hash);
                        u.height = d.h, u.width = d.w, u.x = d.u, u.y = d.v;
                        var m = _.y + g;
                        if (L > 0) {
                            if (m > x) {
                                var v = m - x;
                                u.y += v, u.height -= v, m -= v;
                            }
                            m - d.h * C < A && I === a.CLAMP && (u.height = m < A ? 0 : (m - A) / C);
                        }
                        var y = _.line, w = _.x + d.w / 2 * C + p[y];
                        if (V > 0 && this._isHorizontalClamped(w, y)) if (I === a.CLAMP) u.width = 0; else if (I === a.SHRINK) {
                            if (S.width > d.w) {
                                s = !1;
                                break;
                            }
                            u.width = 0;
                        }
                        if (u.height > 0 && u.width > 0) {
                            var E = this._determineRect(u), B = _.x + p[_.line];
                            this.appendQuad(h, t, u, E, B - n, m - r, C);
                        }
                    }
                }
                return this._quadsUpdated(h), s;
            }, r._determineRect = function(t) {
                var e = b.isRotated(), i = b._originalSize, n = b._rect, r = b._offset, s = r.x + (i.width - n.width) / 2, o = r.y - (i.height - n.height) / 2;
                if (e) {
                    var a = t.x;
                    t.x = n.x + n.height - t.y - t.height - o, t.y = a + n.y - s, t.y < 0 && (t.height = t.height + o);
                } else t.x += n.x - s, t.y += n.y + o;
                return e;
            }, r._computeAlignmentOffset = function() {
                switch (p.length = 0, B) {
                  case o.TextAlignment.LEFT:
                    for (var t = 0; t < v; ++t) p.push(0);
                    break;

                  case o.TextAlignment.CENTER:
                    for (var e = 0, i = d.length; e < i; e++) p.push((S.width - d[e]) / 2);
                    break;

                  case o.TextAlignment.RIGHT:
                    for (var n = 0, r = d.length; n < r; n++) p.push(S.width - d[n]);
                }
                if (g = S.height, M !== o.VerticalTextAlignment.TOP) {
                    var s = S.height - y + P * this._getFontScale() - E * C;
                    M === o.VerticalTextAlignment.BOTTOM ? g -= s : g -= s / 2;
                }
            }, r._setupBMFontOverflowMetrics = function() {
                var t = S.width, e = S.height;
                I === a.RESIZE_HEIGHT && (e = 0), I === a.NONE && (t = 0, e = 0), V = t, L = e, 
                O = t;
            }, r.updateWorldVerts = function() {}, r.appendQuad = function() {}, r._quadsUpdated = function() {}, 
            r._reserveQuads = function() {}, n;
        }(r.default);
        i.default = F, e.exports = i.default;
    }, {
        "../../../components/CCLabel": 103,
        "../../../platform/CCMacro": 187,
        "../../../utils/text-utils": 263,
        "../../assembler-2d": 208,
        "../utils": 221
    } ],
    218: [ function(t, e) {
        "use strict";
        function i() {
            this._rect = null, this.uv = [], this._texture = null, this._original = null;
        }
        i.prototype = {
            constructor: i,
            getRect: function() {
                return cc.rect(this._rect);
            },
            setRect: function(t) {
                this._rect = t, this._texture && this._calculateUV();
            },
            _setDynamicAtlasFrame: function(t) {
                t && (this._original = {
                    _texture: this._texture,
                    _x: this._rect.x,
                    _y: this._rect.y
                }, this._texture = t.texture, this._rect.x = t.x, this._rect.y = t.y, this._calculateUV());
            },
            _resetDynamicAtlasFrame: function() {
                this._original && (this._rect.x = this._original._x, this._rect.y = this._original._y, 
                this._texture = this._original._texture, this._original = null, this._calculateUV());
            },
            _refreshTexture: function(t) {
                this._texture = t, this._rect = cc.rect(0, 0, t.width, t.height), this._calculateUV();
            },
            _calculateUV: function() {
                var t = this._rect, e = this._texture, i = this.uv, n = e.width, r = e.height, s = 0 === n ? 0 : t.x / n, o = 0 === n ? 0 : (t.x + t.width) / n, a = 0 === r ? 0 : (t.y + t.height) / r, c = 0 === r ? 0 : t.y / r;
                i[0] = s, i[1] = a, i[2] = o, i[3] = a, i[4] = s, i[5] = c, i[6] = o, i[7] = c;
            }
        }, e.exports = i;
    }, {} ],
    219: [ function(t, e, i) {
        "use strict";
        i.__esModule = !0, i.default = void 0;
        var n, r = (n = t("../../webgl/assemblers/label/2d/bmfont")) && n.__esModule ? n : {
            default: n
        }, s = t("../../../components/CCLabel"), o = t("../../../components/CCLabelOutline"), a = t("../../../utils/text-utils"), c = t("../../../components/CCComponent"), l = t("../../../assets/CCRenderTexture"), u = cc.js.isChildClassOf(o, c), h = t("../utils").getFontFamily, _ = t("../utils").shareLabelInfo, f = cc.BitmapFont.FontLetterDefinition, d = cc.BitmapFont.FontAtlas, p = cc.Color.WHITE, m = 0, v = (1 / 255).toFixed(3);
        function y(t, e) {
            this._texture = null, this._labelInfo = e, this._char = t, this._hash = null, this._data = null, 
            this._canvas = null, this._context = null, this._width = 0, this._height = 0, this._offsetY = 0, 
            this._hash = t.charCodeAt(0) + e.hash;
        }
        function g(t, e) {
            var i = new l();
            i.initWithSize(t, e), i.update(), this._fontDefDictionary = new d(i), this._x = m, 
            this._y = m, this._nexty = m, this._width = t, this._height = e, cc.director.on(cc.Director.EVENT_BEFORE_SCENE_LAUNCH, this.beforeSceneLoad, this);
        }
        y.prototype = {
            constructor: y,
            updateRenderData: function() {
                this._updateProperties(), this._updateTexture();
            },
            _updateProperties: function() {
                this._texture = new cc.Texture2D(), this._data = s._canvasPool.get(), this._canvas = this._data.canvas, 
                this._context = this._data.context, this._context.font = this._labelInfo.fontDesc;
                var t = a.safeMeasureText(this._context, this._char, this._labelInfo.fontDesc), e = 2 * this._labelInfo.margin + 2;
                this._width = parseFloat(t.toFixed(2)) + e, this._height = (1 + a.BASELINE_RATIO) * this._labelInfo.fontSize + e, 
                this._offsetY = -this._labelInfo.fontSize * a.BASELINE_RATIO / 2, this._canvas.width !== this._width && (this._canvas.width = this._width), 
                this._canvas.height !== this._height && (this._canvas.height = this._height), this._texture.initWithElement(this._canvas);
            },
            _updateTexture: function() {
                var t = this._context, e = this._labelInfo, i = this._canvas.width, n = this._canvas.height, r = this._labelInfo.fontSize, s = i / 2, o = n / 2 + r * a.MIDDLE_RATIO + r * a.BASELINE_OFFSET, c = e.color;
                if (t.lineJoin = "round", t.textAlign = "center", t.clearRect(0, 0, i, n), t.fillStyle = "rgba(" + c.r + ", " + c.g + ", " + c.b + ", " + v + ")", 
                t.fillRect(0, 0, i, n), t.font = e.fontDesc, t.fillStyle = "rgba(" + c.r + ", " + c.g + ", " + c.b + ", 1)", 
                e.isOutlined && e.margin > 0) {
                    var l = e.out || p;
                    t.strokeStyle = "rgba(" + l.r + ", " + l.g + ", " + l.b + ", " + l.a / 255 + ")", 
                    t.lineWidth = 2 * e.margin, t.strokeText(this._char, s, o);
                }
                t.fillText(this._char, s, o), this._texture.handleLoadedTexture();
            },
            destroy: function() {
                this._texture.destroy(), this._texture = null, s._canvasPool.put(this._data);
            }
        }, cc.js.mixin(g.prototype, {
            insertLetterTexture: function(t) {
                var e = t._texture, i = e.width, n = e.height;
                if (this._x + i + m > this._width && (this._x = m, this._y = this._nexty), this._y + n > this._nexty && (this._nexty = this._y + n + m), 
                this._nexty > this._height) return null;
                this._fontDefDictionary._texture.drawTextureAt(e, this._x, this._y), this._dirty = !0;
                var r = new f();
                return r.u = this._x + 1, r.v = this._y + 1, r.texture = this._fontDefDictionary._texture, 
                r.valid = !0, r.w = t._width - 2, r.h = t._height - 2, r.xAdvance = r.w, r.offsetY = t._offsetY, 
                this._x += i + m, this._fontDefDictionary.addLetterDefinitions(t._hash, r), r;
            },
            update: function() {
                this._dirty && (this._fontDefDictionary._texture.update(), this._dirty = !1);
            },
            reset: function() {
                this._x = m, this._y = m, this._nexty = m;
                for (var t = this._fontDefDictionary._letterDefinitions, e = 0, i = t.length; e < i; e++) {
                    var n = t[e];
                    n.isValid && n.destroy();
                }
                this._fontDefDictionary.clear();
            },
            destroy: function() {
                this.reset(), this._fontDefDictionary._texture.destroy(), this._fontDefDictionary._texture = null;
            },
            beforeSceneLoad: function() {
                this.clearAllCache();
            },
            clearAllCache: function() {
                this.destroy();
                var t = new l();
                t.initWithSize(this._width, this._height), t.update(), this._fontDefDictionary._texture = t;
            },
            getLetter: function(t) {
                return this._fontDefDictionary._letterDefinitions[t];
            },
            getTexture: function() {
                return this._fontDefDictionary.getTexture();
            },
            getLetterDefinitionForChar: function(t, e) {
                var i = t.charCodeAt(0) + e.hash, n = this._fontDefDictionary._letterDefinitions[i];
                if (!n) {
                    var r = new y(t, e);
                    r.updateRenderData(), n = this.insertLetterTexture(r), r.destroy();
                }
                return n;
            }
        });
        var x = null, A = function(t) {
            var e, i;
            function n() {
                return t.apply(this, arguments) || this;
            }
            i = t, (e = n).prototype = Object.create(i.prototype), e.prototype.constructor = e, 
            e.__proto__ = i;
            var r = n.prototype;
            return r._getAssemblerData = function() {
                return x || (x = new g(2048, 2048), cc.Label._shareAtlas = x), x.getTexture();
            }, r._updateFontFamily = function(t) {
                _.fontAtlas = x, _.fontFamily = h(t);
                var e = u && t.getComponent(o);
                e && e.enabled ? (_.isOutlined = !0, _.margin = e.width, _.out = e.color.clone(), 
                _.out.a = e.color.a * t.node.color.a / 255) : (_.isOutlined = !1, _.margin = 0);
            }, r._updateLabelInfo = function(t) {
                var e, i, n;
                _.fontDesc = this._getFontDesc(), _.color = t.node.color, _.hash = (i = (e = _).color.toHEX(), 
                n = "", e.isOutlined && e.margin > 0 && (n = n + e.margin + e.out.toHEX()), "" + e.fontSize + e.fontFamily + i + n);
            }, r._getFontDesc = function() {
                return _.fontSize.toString() + "px " + _.fontFamily;
            }, r._computeHorizontalKerningForText = function() {}, r._determineRect = function() {
                return !1;
            }, n;
        }(r.default);
        i.default = A, e.exports = i.default;
    }, {
        "../../../assets/CCRenderTexture": 66,
        "../../../components/CCComponent": 101,
        "../../../components/CCLabel": 103,
        "../../../components/CCLabelOutline": 104,
        "../../../utils/text-utils": 263,
        "../../webgl/assemblers/label/2d/bmfont": 226,
        "../utils": 221
    } ],
    220: [ function(t, e, i) {
        "use strict";
        i.__esModule = !0, i.default = void 0;
        var n, r, s = (n = t("../../assembler-2d")) && n.__esModule ? n : {
            default: n
        }, o = t("../../../utils/text-utils"), a = t("../../../platform/CCMacro"), c = t("../../../components/CCLabel"), l = t("../../../components/CCLabelOutline"), u = t("../../../components/CCLabelShadow"), h = c.Overflow, _ = t("../utils").deleteFromDynamicAtlas, f = t("../utils").getFontFamily, d = (1 / 255).toFixed(3), p = null, m = null, v = null, y = "", g = "", x = 0, A = 0, C = [], b = cc.Size.ZERO, S = 0, T = 0, w = 0, E = null, B = "", M = h.NONE, R = !1, P = !1, I = null, D = cc.Color.WHITE, V = null, L = cc.Color.BLACK, O = cc.rect(), F = cc.Size.ZERO, N = cc.Size.ZERO, G = !1, k = !1, z = !1, U = 0, H = cc.Vec2.ZERO, W = 0, j = [ "left", "center", "right" ], q = function(t) {
            var e, i;
            function n() {
                return t.apply(this, arguments) || this;
            }
            i = t, (e = n).prototype = Object.create(i.prototype), e.prototype.constructor = e, 
            e.__proto__ = i;
            var s = n.prototype;
            return s._getAssemblerData = function() {
                return (r = c._canvasPool.get()).canvas.width = r.canvas.height = 1, r;
            }, s._resetAssemblerData = function(t) {
                t && c._canvasPool.put(t);
            }, s.updateRenderData = function(e) {
                t.prototype.updateRenderData.call(this, e), e._vertsDirty && (this._updateProperties(e), 
                this._calculateLabelFont(), this._updateLabelDimensions(), this._updateTexture(e), 
                this._calDynamicAtlas(e), e._actualFontSize = x, e.node.setContentSize(N), this.updateVerts(e), 
                e._vertsDirty = !1, p = null, m = null, v = null);
            }, s.updateVerts = function() {}, s._updatePaddingRect = function() {
                var t = 0, e = 0, i = 0, n = 0, r = 0;
                if (F.width = F.height = 0, I && (t = e = i = n = r = I.width, F.width = F.height = 2 * r), 
                V) {
                    var s = V.blur + r;
                    i = Math.max(i, -V._offset.x + s), n = Math.max(n, V._offset.x + s), t = Math.max(t, V._offset.y + s), 
                    e = Math.max(e, -V._offset.y + s);
                }
                if (k) {
                    var o = A * Math.tan(.20943951);
                    n += o, F.width += o;
                }
                O.x = i, O.y = t, O.width = i + n, O.height = t + e;
            }, s._updateProperties = function(t) {
                var e = t._assemblerData;
                p = e.context, m = e.canvas, v = t._frame._original ? t._frame._original._texture : t._frame._texture, 
                g = t.string.toString(), x = t._fontSize, A = x, U = t.underlineHeight || A / 8, 
                M = t.overflow, b.width = t.node.width, b.height = t.node.height, N = t.node.getContentSize(), 
                S = t._lineHeight, T = t.horizontalAlign, w = t.verticalAlign, E = t.node.color, 
                G = t.enableBold, k = t.enableItalic, z = t.enableUnderline, B = f(t), P = t.srcBlendFactor === cc.macro.BlendFactor.ONE, 
                R = M !== h.NONE && (M === h.RESIZE_HEIGHT || t.enableWrapText), (I = (I = l && t.getComponent(l)) && I.enabled && I.width > 0 ? I : null) && D.set(I.color), 
                (V = (V = u && t.getComponent(u)) && V.enabled ? V : null) && (L.set(V.color), L.a = L.a * t.node.color.a / 255), 
                this._updatePaddingRect();
            }, s._calculateFillTextStartPosition = function() {
                var t = 0;
                T === a.TextAlignment.RIGHT ? t = b.width - O.width : T === a.TextAlignment.CENTER && (t = (b.width - O.width) / 2);
                var e = this._getLineHeight() * (C.length - 1), i = x * (1 - o.BASELINE_RATIO / 2);
                if (w !== a.VerticalTextAlignment.TOP) {
                    var n = e + O.height + x - b.height;
                    w === a.VerticalTextAlignment.BOTTOM ? i -= n += o.BASELINE_RATIO / 2 * x : i -= n / 2;
                }
                return i += o.BASELINE_OFFSET * x, cc.v2(t + O.x, i + O.y);
            }, s._setupOutline = function() {
                p.strokeStyle = "rgba(" + D.r + ", " + D.g + ", " + D.b + ", " + D.a / 255 + ")", 
                p.lineWidth = 2 * I.width;
            }, s._setupShadow = function() {
                p.shadowColor = "rgba(" + L.r + ", " + L.g + ", " + L.b + ", " + L.a / 255 + ")", 
                p.shadowBlur = V.blur, p.shadowOffsetX = V.offset.x, p.shadowOffsetY = -V.offset.y;
            }, s._drawTextEffect = function(t, e) {
                if (V || I || z) {
                    var i = C.length > 1 && V, n = this._measureText(p, y), r = 0, s = 0;
                    V && this._setupShadow(), I && this._setupOutline();
                    for (var o = 0; o < C.length; ++o) r = t.x, s = t.y + o * e, i && (I && p.strokeText(C[o], r, s), 
                    p.fillText(C[o], r, s)), z && (W = n(C[o]), T === a.TextAlignment.RIGHT ? H.x = t.x - W : T === a.TextAlignment.CENTER ? H.x = t.x - W / 2 : H.x = t.x, 
                    H.y = s + A / 8, p.fillRect(H.x, H.y, W, U));
                    i && (p.shadowColor = "transparent");
                }
            }, s._updateTexture = function() {
                if (p.clearRect(0, 0, m.width, m.height), p.lineJoin = "round", P) p.fillStyle = "rgba(" + E.r + ", " + E.g + ", " + E.b + ", " + E.a / 255 + ")"; else {
                    var t = I ? D : E;
                    p.fillStyle = "rgba(" + t.r + ", " + t.g + ", " + t.b + ", " + d + ")", p.fillRect(0, 0, m.width, m.height), 
                    p.fillStyle = "rgba(" + E.r + ", " + E.g + ", " + E.b + ", 1)";
                }
                var e = this._calculateFillTextStartPosition(), i = this._getLineHeight(), n = e.x, r = 0;
                this._drawTextEffect(e, i);
                for (var s = 0; s < C.length; ++s) r = e.y + s * i, I && p.strokeText(C[s], n, r), 
                p.fillText(C[s], n, r);
                V && (p.shadowColor = "transparent"), v.handleLoadedTexture();
            }, s._calDynamicAtlas = function(t) {
                if (t.cacheMode === c.CacheMode.BITMAP) {
                    var e = t._frame;
                    _(t, e), e._original || e.setRect(cc.rect(0, 0, m.width, m.height)), this.packToDynamicAtlas(t, e);
                }
            }, s._updateLabelDimensions = function() {
                b.width = Math.min(b.width, 2048), b.height = Math.min(b.height, 2048);
                var t = !1;
                m.width !== b.width && (m.width = b.width, t = !0), m.height !== b.height && (m.height = b.height, 
                t = !0), t && (p.font = y), p.textAlign = j[T];
            }, s._getFontDesc = function() {
                var t = x.toString() + "px ";
                return t += B, G && (t = "bold " + t), k && (t = "italic " + t), t;
            }, s._getLineHeight = function() {
                return 0 | (0 === S ? x : S * x / A);
            }, s._calculateParagraphLength = function(t, e) {
                for (var i = [], n = 0; n < t.length; ++n) {
                    var r = o.safeMeasureText(e, t[n], y);
                    i.push(r);
                }
                return i;
            }, s._measureText = function(t, e) {
                return function(i) {
                    return o.safeMeasureText(t, i, e);
                };
            }, s._calculateShrinkFont = function(t) {
                var e = this._calculateParagraphLength(t, p), i = 0, n = 0, r = 0;
                if (R) {
                    var s = N.width, a = N.height;
                    if (s < 0 || a < 0) return;
                    n = a + 1;
                    for (var c = 0, l = 0 | x + 1, u = 0; c < l; ) {
                        if ((u = c + l + 1 >> 1) <= 0) {
                            cc.logID(4003);
                            break;
                        }
                        x = u, y = this._getFontDesc(), p.font = y;
                        var h = this._getLineHeight();
                        for (n = 0, i = 0; i < t.length; ++i) {
                            var _ = o.safeMeasureText(p, t[i], y);
                            n += o.fragmentText(t[i], _, s, this._measureText(p, y)).length * h;
                        }
                        n > a ? l = u - 1 : c = u;
                    }
                    0 === c ? cc.logID(4003) : (x = c, y = this._getFontDesc(), p.font = y);
                } else {
                    for (n = t.length * this._getLineHeight(), i = 0; i < t.length; ++i) r < e[i] && (r = e[i]);
                    var f = (b.width - O.width) / r, d = b.height / n;
                    x = A * Math.min(1, f, d) | 0, y = this._getFontDesc(), p.font = y;
                }
            }, s._calculateWrapText = function(t) {
                if (R) {
                    C = [];
                    for (var e = N.width, i = 0; i < t.length; ++i) {
                        var n = o.safeMeasureText(p, t[i], y), r = o.fragmentText(t[i], n, e, this._measureText(p, y));
                        C = C.concat(r);
                    }
                }
            }, s._calculateLabelFont = function() {
                var t = g.split("\n");
                switch (C = t, y = this._getFontDesc(), p.font = y, M) {
                  case h.NONE:
                    for (var e = 0, i = 0, n = 0; n < t.length; ++n) {
                        var r = o.safeMeasureText(p, t[n], y);
                        e = e > r ? e : r;
                    }
                    i = (C.length + o.BASELINE_RATIO) * this._getLineHeight();
                    var s = parseFloat(e.toFixed(2)), a = parseFloat(i.toFixed(2));
                    b.width = s + O.width, b.height = a + O.height, N.width = s + F.width, N.height = a + F.height;
                    break;

                  case h.SHRINK:
                    this._calculateShrinkFont(t), this._calculateWrapText(t);
                    break;

                  case h.CLAMP:
                    this._calculateWrapText(t);
                    break;

                  case h.RESIZE_HEIGHT:
                    this._calculateWrapText(t);
                    var c = (C.length + o.BASELINE_RATIO) * this._getLineHeight();
                    b.height = c + O.height, N.height = c + F.height;
                }
            }, n;
        }(s.default);
        i.default = q, e.exports = i.default;
    }, {
        "../../../components/CCLabel": 103,
        "../../../components/CCLabelOutline": 104,
        "../../../components/CCLabelShadow": 105,
        "../../../platform/CCMacro": 187,
        "../../../utils/text-utils": 263,
        "../../assembler-2d": 208,
        "../utils": 221
    } ],
    221: [ function(t, e) {
        "use strict";
        var i = t("./dynamic-atlas/manager"), n = cc.Color.WHITE, r = {
            fontAtlas: null,
            fontSize: 0,
            lineHeight: 0,
            hAlign: 0,
            vAlign: 0,
            hash: "",
            fontFamily: "",
            fontDesc: "Arial",
            color: n,
            isOutlined: !1,
            out: n,
            margin: 0
        };
        e.exports = {
            deleteFromDynamicAtlas: function(t, e) {
                e && e._original && i && (i.deleteAtlasSpriteFrame(e), e._resetDynamicAtlasFrame());
            },
            getFontFamily: function(t) {
                return t.useSystemFont ? t.fontFamily || "Arial" : t.font ? t.font._nativeAsset ? t.font._nativeAsset : (cc.assetManager.postLoadNative(t.font, function() {
                    t.setVertsDirty();
                }), "Arial") : "Arial";
            },
            shareLabelInfo: r
        };
    }, {
        "./dynamic-atlas/manager": 216
    } ],
    222: [ function(t, e) {
        "use strict";
        function i(t, e, i) {
            i = i || 2;
            var r, o, a, c, l, h, _, f = e && e.length, d = f ? e[0] * i : t.length, p = n(t, 0, d, i, !0), m = [];
            if (!p) return m;
            if (f && (p = u(t, e, p, i)), t.length > 80 * i) {
                r = a = t[0], o = c = t[1];
                for (var v = i; v < d; v += i) (l = t[v]) < r && (r = l), (h = t[v + 1]) < o && (o = h), 
                l > a && (a = l), h > c && (c = h);
                _ = Math.max(a - r, c - o);
            }
            return s(p, m, i, r, o, _), m;
        }
        function n(t, e, i, n, r) {
            var s, o;
            if (r === R(t, e, i, n) > 0) for (s = e; s < i; s += n) o = E(s, t[s], t[s + 1], o); else for (s = i - n; s >= e; s -= n) o = E(s, t[s], t[s + 1], o);
            return o && A(o, o.next) && (B(o), o = o.next), o;
        }
        function r(t, e) {
            if (!t) return t;
            e || (e = t);
            var i, n = t;
            do {
                if (i = !1, n.steiner || !A(n, n.next) && 0 !== x(n.prev, n, n.next)) n = n.next; else {
                    if (B(n), (n = e = n.prev) === n.next) return null;
                    i = !0;
                }
            } while (i || n !== e);
            return e;
        }
        function s(t, e, i, n, u, h, _) {
            if (t) {
                !_ && h && d(t, n, u, h);
                for (var f, p, m = t; t.prev !== t.next; ) if (f = t.prev, p = t.next, h ? a(t, n, u, h) : o(t)) e.push(f.i / i), 
                e.push(t.i / i), e.push(p.i / i), B(t), t = p.next, m = p.next; else if ((t = p) === m) {
                    _ ? 1 === _ ? s(t = c(t, e, i), e, i, n, u, h, 2) : 2 === _ && l(t, e, i, n, u, h) : s(r(t), e, i, n, u, h, 1);
                    break;
                }
            }
        }
        function o(t) {
            var e = t.prev, i = t, n = t.next;
            if (x(e, i, n) >= 0) return !1;
            for (var r = t.next.next; r !== t.prev; ) {
                if (y(e.x, e.y, i.x, i.y, n.x, n.y, r.x, r.y) && x(r.prev, r, r.next) >= 0) return !1;
                r = r.next;
            }
            return !0;
        }
        function a(t, e, i, n) {
            var r = t.prev, s = t, o = t.next;
            if (x(r, s, o) >= 0) return !1;
            for (var a = r.x < s.x ? r.x < o.x ? r.x : o.x : s.x < o.x ? s.x : o.x, c = r.y < s.y ? r.y < o.y ? r.y : o.y : s.y < o.y ? s.y : o.y, l = r.x > s.x ? r.x > o.x ? r.x : o.x : s.x > o.x ? s.x : o.x, u = r.y > s.y ? r.y > o.y ? r.y : o.y : s.y > o.y ? s.y : o.y, h = m(a, c, e, i, n), _ = m(l, u, e, i, n), f = t.nextZ; f && f.z <= _; ) {
                if (f !== t.prev && f !== t.next && y(r.x, r.y, s.x, s.y, o.x, o.y, f.x, f.y) && x(f.prev, f, f.next) >= 0) return !1;
                f = f.nextZ;
            }
            for (f = t.prevZ; f && f.z >= h; ) {
                if (f !== t.prev && f !== t.next && y(r.x, r.y, s.x, s.y, o.x, o.y, f.x, f.y) && x(f.prev, f, f.next) >= 0) return !1;
                f = f.prevZ;
            }
            return !0;
        }
        function c(t, e, i) {
            var n = t;
            do {
                var r = n.prev, s = n.next.next;
                !A(r, s) && C(r, n, n.next, s) && S(r, s) && S(s, r) && (e.push(r.i / i), e.push(n.i / i), 
                e.push(s.i / i), B(n), B(n.next), n = t = s), n = n.next;
            } while (n !== t);
            return n;
        }
        function l(t, e, i, n, o, a) {
            var c = t;
            do {
                for (var l = c.next.next; l !== c.prev; ) {
                    if (c.i !== l.i && g(c, l)) {
                        var u = w(c, l);
                        return c = r(c, c.next), u = r(u, u.next), s(c, e, i, n, o, a), void s(u, e, i, n, o, a);
                    }
                    l = l.next;
                }
                c = c.next;
            } while (c !== t);
        }
        function u(t, e, i, s) {
            var o, a, c, l = [];
            for (o = 0, a = e.length; o < a; o++) (c = n(t, e[o] * s, o < a - 1 ? e[o + 1] * s : t.length, s, !1)) === c.next && (c.steiner = !0), 
            l.push(v(c));
            for (l.sort(h), o = 0; o < l.length; o++) _(l[o], i), i = r(i, i.next);
            return i;
        }
        function h(t, e) {
            return t.x - e.x;
        }
        function _(t, e) {
            if (e = f(t, e)) {
                var i = w(e, t);
                r(i, i.next);
            }
        }
        function f(t, e) {
            var i, n = e, r = t.x, s = t.y, o = -1 / 0;
            do {
                if (s <= n.y && s >= n.next.y) {
                    var a = n.x + (s - n.y) * (n.next.x - n.x) / (n.next.y - n.y);
                    if (a <= r && a > o) {
                        if (o = a, a === r) {
                            if (s === n.y) return n;
                            if (s === n.next.y) return n.next;
                        }
                        i = n.x < n.next.x ? n : n.next;
                    }
                }
                n = n.next;
            } while (n !== e);
            if (!i) return null;
            if (r === o) return i.prev;
            var c, l = i, u = i.x, h = i.y, _ = 1 / 0;
            for (n = i.next; n !== l; ) r >= n.x && n.x >= u && y(s < h ? r : o, s, u, h, s < h ? o : r, s, n.x, n.y) && ((c = Math.abs(s - n.y) / (r - n.x)) < _ || c === _ && n.x > i.x) && S(n, t) && (i = n, 
            _ = c), n = n.next;
            return i;
        }
        function d(t, e, i, n) {
            var r = t;
            do {
                null === r.z && (r.z = m(r.x, r.y, e, i, n)), r.prevZ = r.prev, r.nextZ = r.next, 
                r = r.next;
            } while (r !== t);
            r.prevZ.nextZ = null, r.prevZ = null, p(r);
        }
        function p(t) {
            var e, i, n, r, s, o, a, c, l = 1;
            do {
                for (i = t, t = null, s = null, o = 0; i; ) {
                    for (o++, n = i, a = 0, e = 0; e < l && (a++, n = n.nextZ); e++) ;
                    for (c = l; a > 0 || c > 0 && n; ) 0 === a ? (r = n, n = n.nextZ, c--) : 0 !== c && n ? i.z <= n.z ? (r = i, 
                    i = i.nextZ, a--) : (r = n, n = n.nextZ, c--) : (r = i, i = i.nextZ, a--), s ? s.nextZ = r : t = r, 
                    r.prevZ = s, s = r;
                    i = n;
                }
                s.nextZ = null, l *= 2;
            } while (o > 1);
            return t;
        }
        function m(t, e, i, n, r) {
            return (t = 1431655765 & ((t = 858993459 & ((t = 252645135 & ((t = 16711935 & ((t = 32767 * (t - i) / r) | t << 8)) | t << 4)) | t << 2)) | t << 1)) | (e = 1431655765 & ((e = 858993459 & ((e = 252645135 & ((e = 16711935 & ((e = 32767 * (e - n) / r) | e << 8)) | e << 4)) | e << 2)) | e << 1)) << 1;
        }
        function v(t) {
            var e = t, i = t;
            do {
                e.x < i.x && (i = e), e = e.next;
            } while (e !== t);
            return i;
        }
        function y(t, e, i, n, r, s, o, a) {
            return (r - o) * (e - a) - (t - o) * (s - a) >= 0 && (t - o) * (n - a) - (i - o) * (e - a) >= 0 && (i - o) * (s - a) - (r - o) * (n - a) >= 0;
        }
        function g(t, e) {
            return t.next.i !== e.i && t.prev.i !== e.i && !b(t, e) && S(t, e) && S(e, t) && T(t, e);
        }
        function x(t, e, i) {
            return (e.y - t.y) * (i.x - e.x) - (e.x - t.x) * (i.y - e.y);
        }
        function A(t, e) {
            return t.x === e.x && t.y === e.y;
        }
        function C(t, e, i, n) {
            return !!(A(t, e) && A(i, n) || A(t, n) && A(i, e)) || x(t, e, i) > 0 != x(t, e, n) > 0 && x(i, n, t) > 0 != x(i, n, e) > 0;
        }
        function b(t, e) {
            var i = t;
            do {
                if (i.i !== t.i && i.next.i !== t.i && i.i !== e.i && i.next.i !== e.i && C(i, i.next, t, e)) return !0;
                i = i.next;
            } while (i !== t);
            return !1;
        }
        function S(t, e) {
            return x(t.prev, t, t.next) < 0 ? x(t, e, t.next) >= 0 && x(t, t.prev, e) >= 0 : x(t, e, t.prev) < 0 || x(t, t.next, e) < 0;
        }
        function T(t, e) {
            var i = t, n = !1, r = (t.x + e.x) / 2, s = (t.y + e.y) / 2;
            do {
                i.y > s != i.next.y > s && r < (i.next.x - i.x) * (s - i.y) / (i.next.y - i.y) + i.x && (n = !n), 
                i = i.next;
            } while (i !== t);
            return n;
        }
        function w(t, e) {
            var i = new M(t.i, t.x, t.y), n = new M(e.i, e.x, e.y), r = t.next, s = e.prev;
            return t.next = e, e.prev = t, i.next = r, r.prev = i, n.next = i, i.prev = n, s.next = n, 
            n.prev = s, n;
        }
        function E(t, e, i, n) {
            var r = new M(t, e, i);
            return n ? (r.next = n.next, r.prev = n, n.next.prev = r, n.next = r) : (r.prev = r, 
            r.next = r), r;
        }
        function B(t) {
            t.next.prev = t.prev, t.prev.next = t.next, t.prevZ && (t.prevZ.nextZ = t.nextZ), 
            t.nextZ && (t.nextZ.prevZ = t.prevZ);
        }
        function M(t, e, i) {
            this.i = t, this.x = e, this.y = i, this.prev = null, this.next = null, this.z = null, 
            this.prevZ = null, this.nextZ = null, this.steiner = !1;
        }
        function R(t, e, i, n) {
            for (var r = 0, s = e, o = i - n; s < i; s += n) r += (t[o] - t[s]) * (t[s + 1] + t[o + 1]), 
            o = s;
            return r;
        }
        cc.Graphics.earcut = e.exports = i, i.deviation = function(t, e, i, n) {
            var r = e && e.length, s = r ? e[0] * i : t.length, o = Math.abs(R(t, 0, s, i));
            if (r) for (var a = 0, c = e.length; a < c; a++) {
                var l = e[a] * i, u = a < c - 1 ? e[a + 1] * i : t.length;
                o -= Math.abs(R(t, l, u, i));
            }
            var h = 0;
            for (a = 0; a < n.length; a += 3) {
                var _ = n[a] * i, f = n[a + 1] * i, d = n[a + 2] * i;
                h += Math.abs((t[_] - t[d]) * (t[f + 1] - t[_ + 1]) - (t[_] - t[f]) * (t[d + 1] - t[_ + 1]));
            }
            return 0 === o && 0 === h ? 0 : Math.abs((h - o) / o);
        }, i.flatten = function(t) {
            for (var e = t[0][0].length, i = {
                vertices: [],
                holes: [],
                dimensions: e
            }, n = 0, r = 0; r < t.length; r++) {
                for (var s = 0; s < t[r].length; s++) for (var o = 0; o < e; o++) i.vertices.push(t[r][s][o]);
                r > 0 && (n += t[r - 1].length, i.holes.push(n));
            }
            return i;
        };
    }, {} ],
    223: [ function(t, e) {
        "use strict";
        var i = t("../../../../graphics/helper"), n = t("../../../../graphics/types").PointFlags, r = cc.Graphics.Point = cc.Class({
            name: "cc.GraphicsPoint",
            extends: cc.Vec2,
            ctor: function() {
                this.reset();
            },
            reset: function() {
                this.dx = 0, this.dy = 0, this.dmx = 0, this.dmy = 0, this.flags = 0, this.len = 0;
            }
        });
        function s() {
            this.reset();
        }
        function o() {
            this._tessTol = .25, this._distTol = .01, this._updatePathOffset = !1, this._paths = null, 
            this._pathLength = 0, this._pathOffset = 0, this._points = null, this._pointsOffset = 0, 
            this._commandx = 0, this._commandy = 0, this._paths = [], this._points = [];
        }
        cc.js.mixin(s.prototype, {
            reset: function() {
                this.closed = !1, this.nbevel = 0, this.complex = !0, this.points ? this.points.length = 0 : this.points = [];
            }
        }), cc.js.mixin(o.prototype, {
            moveTo: function(t, e) {
                this._updatePathOffset && (this._pathOffset = this._pathLength, this._updatePathOffset = !1), 
                this._addPath(), this._addPoint(t, e, n.PT_CORNER), this._commandx = t, this._commandy = e;
            },
            lineTo: function(t, e) {
                this._addPoint(t, e, n.PT_CORNER), this._commandx = t, this._commandy = e;
            },
            bezierCurveTo: function(t, e, r, s, o, a) {
                var c = this._curPath, l = c.points[c.points.length - 1];
                l.x !== t || l.y !== e || r !== o || s !== a ? (i.tesselateBezier(this, l.x, l.y, t, e, r, s, o, a, 0, n.PT_CORNER), 
                this._commandx = o, this._commandy = a) : this.lineTo(o, a);
            },
            quadraticCurveTo: function(t, e, i, n) {
                var r = this._commandx, s = this._commandy;
                this.bezierCurveTo(r + 2 / 3 * (t - r), s + 2 / 3 * (e - s), i + 2 / 3 * (t - i), n + 2 / 3 * (e - n), i, n);
            },
            arc: function(t, e, n, r, s, o) {
                i.arc(this, t, e, n, r, s, o);
            },
            ellipse: function(t, e, n, r) {
                i.ellipse(this, t, e, n, r), this._curPath.complex = !1;
            },
            circle: function(t, e, n) {
                i.ellipse(this, t, e, n, n), this._curPath.complex = !1;
            },
            rect: function(t, e, i, n) {
                this.moveTo(t, e), this.lineTo(t, e + n), this.lineTo(t + i, e + n), this.lineTo(t + i, e), 
                this.close(), this._curPath.complex = !1;
            },
            roundRect: function(t, e, n, r, s) {
                i.roundRect(this, t, e, n, r, s), this._curPath.complex = !1;
            },
            clear: function(t) {
                this._pathLength = 0, this._pathOffset = 0, this._pointsOffset = 0, this._curPath = null, 
                t && (this._paths.length = 0, this._points.length = 0);
            },
            close: function() {
                this._curPath.closed = !0;
            },
            _addPath: function() {
                var t = this._pathLength, e = this._paths[t];
                return e ? e.reset() : (e = new s(), this._paths.push(e)), this._pathLength++, this._curPath = e, 
                e;
            },
            _addPoint: function(t, e, i) {
                var n = this._curPath;
                if (n) {
                    var s, o = this._points, a = n.points;
                    (s = o[this._pointsOffset++]) ? (s.x = t, s.y = e) : (s = new r(t, e), o.push(s)), 
                    s.flags = i, a.push(s);
                }
            }
        }), cc.Graphics._Impl = o, e.exports = o;
    }, {
        "../../../../graphics/helper": 146,
        "../../../../graphics/types": 148
    } ],
    224: [ function(t, e, i) {
        "use strict";
        i.__esModule = !0, i.default = void 0;
        var n = s(t("../../../assembler")), r = s(t("../../../../../renderer/core/input-assembler"));
        function s(t) {
            return t && t.__esModule ? t : {
                default: t
            };
        }
        var o = t("../../mesh-buffer"), a = t("../../../index"), c = t("../../../../graphics/graphics"), l = t("../../../../graphics/types").PointFlags, u = c.LineJoin, h = c.LineCap, _ = t("./earcut");
        t("./impl");
        var f = Math.PI, d = Math.min, p = Math.max, m = Math.ceil, v = Math.acos, y = Math.cos, g = Math.sin, x = Math.atan2;
        function A(t, e, i) {
            return t < e ? e : t > i ? i : t;
        }
        var C = cc.gfx, b = new C.VertexFormat([ {
            name: C.ATTR_POSITION,
            type: C.ATTR_TYPE_FLOAT32,
            num: 2
        }, {
            name: C.ATTR_COLOR,
            type: C.ATTR_TYPE_UINT8,
            num: 4,
            normalize: !0
        }, {
            name: "a_dist",
            type: C.ATTR_TYPE_FLOAT32,
            num: 1
        } ]);
        b.name = "vfmtPosColorSdf";
        var S = function(t) {
            var e, i;
            function n(e) {
                var i;
                return (i = t.call(this, e) || this)._buffer = null, i._buffers = [], i._bufferOffset = 0, 
                i;
            }
            i = t, (e = n).prototype = Object.create(i.prototype), e.prototype.constructor = e, 
            e.__proto__ = i;
            var s = n.prototype;
            return s.getVfmt = function() {
                return b;
            }, s.getVfmtFloatCount = function() {
                return 4;
            }, s.requestBuffer = function() {
                var t = {
                    indiceStart: 0,
                    vertexStart: 0
                }, e = new o(a._handle, this.getVfmt());
                t.meshbuffer = e;
                var i = new r.default(e._vb, e._ib);
                return t.ia = i, this._buffers.push(t), t;
            }, s.getBuffers = function() {
                return 0 === this._buffers.length && this.requestBuffer(), this._buffers;
            }, s.clear = function(t) {
                this._bufferOffset = 0;
                var e = this._buffers;
                if (t) {
                    for (var i = 0, n = e.length; i < n; i++) {
                        var r = e[i];
                        r.meshbuffer.destroy(), r.meshbuffer = null;
                    }
                    e.length = 0;
                } else for (var s = 0, o = e.length; s < o; s++) {
                    var a = e[s];
                    a.indiceStart = 0, a.vertexStart = 0, a.meshbuffer.reset();
                }
            }, s.fillBuffers = function(t, e) {
                e._flush(), e.node = t.node, e.material = t._materials[0];
                for (var i = this.getBuffers(), n = 0, r = i.length; n < r; n++) {
                    var s = i[n], o = s.meshbuffer;
                    s.ia._count = s.indiceStart, e._flushIA(s.ia), o.uploadData();
                }
            }, s.genBuffer = function(t, e) {
                var i = this.getBuffers(), n = i[this._bufferOffset], r = n.meshbuffer, s = n.vertexStart + e;
                return (s > 65535 || 3 * s > 131070) && (++this._bufferOffset, s = e, this._bufferOffset < i.length ? n = i[this._bufferOffset] : (n = this.requestBuffer(t), 
                i[this._bufferOffset] = n), r = n.meshbuffer), s > r.vertexOffset && r.requestStatic(e, 3 * e), 
                this._buffer = n, n;
            }, s.stroke = function(t) {
                this._curColor = t._strokeColor._val, this._flattenPaths(t._impl), this._expandStroke(t), 
                t._impl._updatePathOffset = !0;
            }, s.fill = function(t) {
                this._curColor = t._fillColor._val, this._expandFill(t), t._impl._updatePathOffset = !0;
            }, s._expandStroke = function(t) {
                var e, i, n, r, s = .5 * t.lineWidth, o = t.lineCap, a = t.lineJoin, c = t.miterLimit, _ = t._impl, d = (e = s, 
                i = f, n = _._tessTol, r = 2 * v(e / (e + n)), p(2, m(i / r)));
                this._calculateJoins(_, s, a, c);
                for (var y = _._paths, g = 0, x = _._pathOffset, A = _._pathLength; x < A; x++) {
                    var C = y[x], b = C.points.length;
                    a === u.ROUND ? g += 2 * (b + C.nbevel * (d + 2) + 1) : g += 2 * (b + 5 * C.nbevel + 1), 
                    C.closed || (o === h.ROUND ? g += 2 * (2 * d + 2) : g += 12);
                }
                for (var S = this.genBuffer(t, g), T = S.meshbuffer, w = T._vData, E = T._iData, B = _._pathOffset, M = _._pathLength; B < M; B++) {
                    var R, P = y[B], I = P.points, D = I.length, V = S.vertexStart, L = void 0, O = void 0, F = void 0, N = void 0;
                    if ((R = P.closed) ? (L = I[D - 1], O = I[0], F = 0, N = D) : (L = I[0], O = I[1], 
                    F = 1, N = D - 1), O = O || L, !R) {
                        var G = O.sub(L);
                        G.normalizeSelf();
                        var k = G.x, z = G.y;
                        o === h.BUTT ? this._buttCapStart(L, k, z, s, 0) : o === h.SQUARE ? this._buttCapStart(L, k, z, s, s) : o === h.ROUND && this._roundCapStart(L, k, z, s, d);
                    }
                    for (var U = F; U < N; ++U) a === u.ROUND ? this._roundJoin(L, O, s, s, d) : 0 != (O.flags & (l.PT_BEVEL | l.PT_INNERBEVEL)) ? this._bevelJoin(L, O, s, s) : (this._vset(O.x + O.dmx * s, O.y + O.dmy * s, 1), 
                    this._vset(O.x - O.dmx * s, O.y - O.dmy * s, -1)), L = O, O = I[U + 1];
                    if (R) {
                        var H = this.getVfmtFloatCount(), W = V * H;
                        this._vset(w[W], w[W + 1], 1), this._vset(w[W + H], w[W + H + 1], -1);
                    } else {
                        var j = O.sub(L);
                        j.normalizeSelf();
                        var q = j.x, X = j.y;
                        o === h.BUTT ? this._buttCapEnd(O, q, X, s, 0) : o === h.SQUARE ? this._buttCapEnd(O, q, X, s, s) : o === h.ROUND && this._roundCapEnd(O, q, X, s, d);
                    }
                    for (var Y = S.indiceStart, J = V + 2, Z = S.vertexStart; J < Z; J++) E[Y++] = J - 2, 
                    E[Y++] = J - 1, E[Y++] = J;
                    S.indiceStart = Y;
                }
            }, s._expandFill = function(t) {
                for (var e = t._impl, i = e._paths, n = 0, r = e._pathOffset, s = e._pathLength; r < s; r++) n += i[r].points.length;
                for (var o = this.genBuffer(t, n), a = o.meshbuffer, c = a._vData, l = a._iData, u = e._pathOffset, h = e._pathLength; u < h; u++) {
                    var f = i[u], d = f.points, p = d.length;
                    if (0 !== p) {
                        for (var m = o.vertexStart, v = 0; v < p; ++v) this._vset(d[v].x, d[v].y);
                        var y = o.indiceStart;
                        if (f.complex) {
                            for (var g = [], x = this.getVfmtFloatCount(), A = m, C = o.vertexStart; A < C; A++) {
                                var b = A * x;
                                g.push(c[b]), g.push(c[b + 1]);
                            }
                            var S = _(g, null, 2);
                            if (!S || 0 === S.length) continue;
                            for (var T = 0, w = S.length; T < w; T++) l[y++] = S[T] + m;
                        } else for (var E = m, B = m + 2, M = o.vertexStart; B < M; B++) l[y++] = E, l[y++] = B - 1, 
                        l[y++] = B;
                        o.indiceStart = y;
                    }
                }
            }, s._calculateJoins = function(t, e, i, n) {
                var r = 0;
                e > 0 && (r = 1 / e);
                for (var s = t._paths, o = t._pathOffset, a = t._pathLength; o < a; o++) {
                    var c = s[o], h = c.points, _ = h.length, f = h[_ - 1], m = h[0];
                    c.nbevel = 0;
                    for (var v = 0; v < _; v++) {
                        var y, g, x = f.dy, A = -f.dx, C = m.dy, b = -m.dx;
                        if (m.dmx = .5 * (x + C), m.dmy = .5 * (A + b), (y = m.dmx * m.dmx + m.dmy * m.dmy) > 1e-6) {
                            var S = 1 / y;
                            S > 600 && (S = 600), m.dmx *= S, m.dmy *= S;
                        }
                        m.dx * f.dy - f.dx * m.dy > 0 && (m.flags |= l.PT_LEFT), y * (g = p(11, d(f.len, m.len) * r)) * g < 1 && (m.flags |= l.PT_INNERBEVEL), 
                        m.flags & l.PT_CORNER && (y * n * n < 1 || i === u.BEVEL || i === u.ROUND) && (m.flags |= l.PT_BEVEL), 
                        0 != (m.flags & (l.PT_BEVEL | l.PT_INNERBEVEL)) && c.nbevel++, f = m, m = h[v + 1];
                    }
                }
            }, s._flattenPaths = function(t) {
                for (var e = t._paths, i = t._pathOffset, n = t._pathLength; i < n; i++) {
                    var r = e[i], s = r.points, o = s[s.length - 1], a = s[0];
                    s.length > 2 && o.equals(a) && (r.closed = !0, s.pop(), o = s[s.length - 1]);
                    for (var c = 0, l = s.length; c < l; c++) {
                        var u = a.sub(o);
                        o.len = u.mag(), (u.x || u.y) && u.normalizeSelf(), o.dx = u.x, o.dy = u.y, o = a, 
                        a = s[c + 1];
                    }
                }
            }, s._chooseBevel = function(t, e, i, n) {
                var r, s, o, a, c = i.x, l = i.y;
                return 0 !== t ? (r = c + e.dy * n, s = l - e.dx * n, o = c + i.dy * n, a = l - i.dx * n) : (r = o = c + i.dmx * n, 
                s = a = l + i.dmy * n), [ r, s, o, a ];
            }, s._buttCapStart = function(t, e, i, n, r) {
                var s = t.x - e * r, o = t.y - i * r, a = i, c = -e;
                this._vset(s + a * n, o + c * n, 1), this._vset(s - a * n, o - c * n, -1);
            }, s._buttCapEnd = function(t, e, i, n, r) {
                var s = t.x + e * r, o = t.y + i * r, a = i, c = -e;
                this._vset(s + a * n, o + c * n, 1), this._vset(s - a * n, o - c * n, -1);
            }, s._roundCapStart = function(t, e, i, n, r) {
                for (var s = t.x, o = t.y, a = i, c = -e, l = 0; l < r; l++) {
                    var u = l / (r - 1) * f, h = y(u) * n, _ = g(u) * n;
                    this._vset(s - a * h - e * _, o - c * h - i * _, 1), this._vset(s, o, 0);
                }
                this._vset(s + a * n, o + c * n, 1), this._vset(s - a * n, o - c * n, -1);
            }, s._roundCapEnd = function(t, e, i, n, r) {
                var s = t.x, o = t.y, a = i, c = -e;
                this._vset(s + a * n, o + c * n, 1), this._vset(s - a * n, o - c * n, -1);
                for (var l = 0; l < r; l++) {
                    var u = l / (r - 1) * f, h = y(u) * n, _ = g(u) * n;
                    this._vset(s, o, 0), this._vset(s - a * h + e * _, o - c * h + i * _, 1);
                }
            }, s._roundJoin = function(t, e, i, n, r) {
                var s = t.dy, o = -t.dx, a = e.dy, c = -e.dx, u = e.x, h = e.y;
                if (0 != (e.flags & l.PT_LEFT)) {
                    var _ = this._chooseBevel(e.flags & l.PT_INNERBEVEL, t, e, i), d = _[0], p = _[1], v = _[2], C = _[3], b = x(-o, -s), S = x(-c, -a);
                    S > b && (S -= 2 * f), this._vset(d, p, 1), this._vset(u - s * n, e.y - o * n, -1);
                    for (var T = A(m((b - S) / f) * r, 2, r), w = 0; w < T; w++) {
                        var E = b + w / (T - 1) * (S - b), B = u + y(E) * n, M = h + g(E) * n;
                        this._vset(u, h, 0), this._vset(B, M, -1);
                    }
                    this._vset(v, C, 1), this._vset(u - a * n, h - c * n, -1);
                } else {
                    var R = this._chooseBevel(e.flags & l.PT_INNERBEVEL, t, e, -n), P = R[0], I = R[1], D = R[2], V = R[3], L = x(o, s), O = x(c, a);
                    O < L && (O += 2 * f), this._vset(u + s * n, h + o * n, 1), this._vset(P, I, -1);
                    for (var F = A(m((O - L) / f) * r, 2, r), N = 0; N < F; N++) {
                        var G = L + N / (F - 1) * (O - L), k = u + y(G) * i, z = h + g(G) * i;
                        this._vset(k, z, 1), this._vset(u, h, 0);
                    }
                    this._vset(u + a * n, h + c * n, 1), this._vset(D, V, -1);
                }
            }, s._bevelJoin = function(t, e, i, n) {
                var r, s, o, a, c, u, h, _, f = t.dy, d = -t.dx, p = e.dy, m = -e.dx;
                if (e.flags & l.PT_LEFT) {
                    var v = this._chooseBevel(e.flags & l.PT_INNERBEVEL, t, e, i);
                    c = v[0], u = v[1], h = v[2], _ = v[3], this._vset(c, u, 1), this._vset(e.x - f * n, e.y - d * n, -1), 
                    this._vset(h, _, 1), this._vset(e.x - p * n, e.y - m * n, -1);
                } else {
                    var y = this._chooseBevel(e.flags & l.PT_INNERBEVEL, t, e, -n);
                    r = y[0], s = y[1], o = y[2], a = y[3], this._vset(e.x + f * i, e.y + d * i, 1), 
                    this._vset(r, s, -1), this._vset(e.x + p * i, e.y + m * i, 1), this._vset(o, a, -1);
                }
            }, s._vset = function(t, e, i) {
                void 0 === i && (i = 0);
                var n = this._buffer, r = n.meshbuffer, s = n.vertexStart * this.getVfmtFloatCount(), o = r._vData, a = r._uintVData;
                o[s] = t, o[s + 1] = e, a[s + 2] = this._curColor, o[s + 3] = i, n.vertexStart++, 
                r._dirty = !0;
            }, n;
        }(n.default);
        i.default = S, n.default.register(cc.Graphics, S), e.exports = i.default;
    }, {
        "../../../../../renderer/core/input-assembler": 288,
        "../../../../graphics/graphics": 145,
        "../../../../graphics/types": 148,
        "../../../assembler": 210,
        "../../../index": 213,
        "../../mesh-buffer": 241,
        "./earcut": 222,
        "./impl": 223
    } ],
    225: [ function(t) {
        "use strict";
        cc.assemblers = {}, t("./sprite"), t("./mask-assembler"), t("./graphics"), t("./label"), 
        t("./motion-streak");
    }, {
        "./graphics": 224,
        "./label": 230,
        "./mask-assembler": 231,
        "./motion-streak": 232,
        "./sprite": 239
    } ],
    226: [ function(t, e, i) {
        "use strict";
        i.__esModule = !0, i.default = void 0;
        var n, r = (n = t("../../../../utils/label/bmfont")) && n.__esModule ? n : {
            default: n
        }, s = 0, o = function(t) {
            var e, i;
            function n() {
                return t.apply(this, arguments) || this;
            }
            i = t, (e = n).prototype = Object.create(i.prototype), e.prototype.constructor = e, 
            e.__proto__ = i;
            var r = n.prototype;
            return r.initData = function() {
                this._renderData.createFlexData(0, 4, 6, this.getVfmt());
            }, r._reserveQuads = function(t, e) {
                var i = 4 * e, n = 6 * e, r = this._renderData._flexBuffer;
                r.reserve(i, n), r.used(i, n);
                for (var o = this._renderData.iDatas[0], a = 0, c = 0, l = n; a < l; a += 6, c += 4) o[a] = c, 
                o[a + 1] = c + 1, o[a + 2] = c + 2, o[a + 3] = c + 1, o[a + 4] = c + 3, o[a + 5] = c + 2;
                s = 0;
            }, r._quadsUpdated = function() {
                s = 0, this._renderData._flexBuffer.used(this.verticesCount, this.indicesCount);
            }, r._getColor = function(t) {
                return t.node._color._val;
            }, r.appendQuad = function(t, e, i, n, r, o, a) {
                var c = this._renderData, l = c.vDatas[0], u = c.uintVDatas[0];
                this.verticesCount += 4, this.indicesCount = this.verticesCount / 2 * 3;
                var h, _, f, d, p = e.width, m = e.height, v = i.width, y = i.height, g = this._getColor(t), x = this.floatsPerVert, A = s + this.uvOffset;
                n ? (h = i.x / p, f = (i.x + y) / p, _ = (i.y + v) / m, d = i.y / m, l[A] = h, l[A + 1] = d, 
                l[A += x] = h, l[A + 1] = _, l[A += x] = f, l[A + 1] = d, l[A += x] = f, l[A + 1] = _) : (h = i.x / p, 
                f = (i.x + v) / p, _ = (i.y + y) / m, d = i.y / m, l[A] = h, l[A + 1] = _, l[A += x] = f, 
                l[A + 1] = _, l[A += x] = h, l[A + 1] = d, l[A += x] = f, l[A + 1] = d), h = r, 
                f = r + v * a, _ = o - y * a, d = o, this.appendVerts(t, s, h, f, _, d);
                for (var C = s + this.colorOffset, b = 0; b < 4; b++) u[C] = g, C += x;
                s += 4 * this.floatsPerVert;
            }, r.appendVerts = function(t, e, i, n, r, s) {
                var o = this._local, a = this.floatsPerVert;
                o[e] = i, o[e + 1] = r, o[e += a] = n, o[e + 1] = r, o[e += a] = i, o[e + 1] = s, 
                o[e += a] = n, o[e + 1] = s;
            }, r.updateWorldVerts = function(t) {
                for (var e = t.node._worldMatrix.m, i = e[0], n = e[1], r = e[4], s = e[5], o = e[12], a = e[13], c = this._local, l = this._renderData.vDatas[0], u = this.floatsPerVert, h = 0; h < c.length; h += u) {
                    var _ = c[h], f = c[h + 1];
                    l[h] = _ * i + f * r + o, l[h + 1] = _ * n + f * s + a;
                }
            }, n;
        }(r.default);
        i.default = o, e.exports = i.default;
    }, {
        "../../../../utils/label/bmfont": 217
    } ],
    227: [ function(t, e, i) {
        "use strict";
        i.__esModule = !0, i.default = void 0, t("../../../../../platform/js"), t("./bmfont");
        var n = t("../../../../utils/label/letter-font"), r = cc.color(255, 255, 255, 255), s = function(t) {
            var e, i;
            function n() {
                return t.apply(this, arguments) || this;
            }
            i = t, (e = n).prototype = Object.create(i.prototype), e.prototype.constructor = e, 
            e.__proto__ = i;
            var s = n.prototype;
            return s.createData = function(t) {
                return t.requestRenderData();
            }, s._getColor = function(t) {
                return r._fastSetA(t.node._color.a), r._val;
            }, s.updateColor = function(e) {
                var i = this._getColor(e);
                t.prototype.updateColor.call(this, e, i);
            }, n;
        }(n);
        i.default = s, e.exports = i.default;
    }, {
        "../../../../../platform/js": 203,
        "../../../../utils/label/letter-font": 219,
        "./bmfont": 226
    } ],
    228: [ function(t, e, i) {
        "use strict";
        i.__esModule = !0, i.default = void 0;
        var n, r = (n = t("../../../../../assets/material/material-variant")) && n.__esModule ? n : {
            default: n
        };
        t("../../../../../components/CCLabel"), t("../../../../../components/CCLabelShadow"), 
        t("../../../../../components/CCLabelOutline"), t("../../../../../assets/material/CCMaterial");
        var s = function() {
            function t() {}
            var e = t.prototype;
            return e.init = function(t) {
                this.labelMaterial = null, this._label = this._renderComp = t, renderer.CustomAssembler.prototype.ctor.call(this), 
                t.node._proxy.setAssembler(this), this._layout = new jsb.LabelRenderer(), this._layout.init(), 
                this._cfg = new DataView(this._layout._cfg), this._layoutInfo = new DataView(this._layout._layout), 
                this._cfgFields = jsb.LabelRenderer._cfgFields, this._layoutFields = jsb.LabelRenderer._layoutFields, 
                this._layout.bindNodeProxy(t.node._proxy), this._bindMaterial(t);
            }, e._setBufferFlag = function(t, e, i, n, r) {
                if ("int8" == n && 1 == i) {
                    var s = t.getInt8(e);
                    t.setInt8(e, r | s);
                } else if ("int32" == n && 4 == i) {
                    var o = t.getInt32(e, jsb.__isLittleEndian__);
                    t.setInt32(e, r | o, jsb.__isLittleEndian__);
                } else cc.warn("flag storage type should be int8/int32 only, type/size -> " + n + "/" + i + ".");
            }, e._updateCfgFlag = function(t) {
                var e = this._cfgFields.updateFlags;
                this._setBufferFlag(this._cfg, e.offset, e.size, e.type, t);
            }, e._setBufferValue = function(t, e, i, n, r) {
                "float" == n && 4 == i ? t.setFloat32(e, r, jsb.__isLittleEndian__) : "int32" == n && 4 == i ? t.setInt32(e, r, jsb.__isLittleEndian__) : "bool" == n && 1 == i ? t.setInt8(e, r ? 1 : 0, jsb.__isLittleEndian__) : "Color4B" == n && 4 == i ? (t.setUint8(e, r.r), 
                t.setUint8(e + 1, r.g), t.setUint8(e + 2, r.b), t.setUint8(e + 3, r.a)) : "int8" == n && 1 == i ? t.setUint8(e, r) : cc.warn("dont know how to set value to buffer, type/size -> " + n + "/" + i + ".");
            }, e._setFieldValue = function(t, e, i, n) {
                var r = e[i];
                this._setBufferValue(t, r.offset, r.size, r.type, n);
            }, e._getBufferValue = function(t, e, i, n) {
                return "float" == n && 4 == i ? t.getFloat32(e, jsb.__isLittleEndian__) : "int32" == n && 4 == i ? t.getInt32(e, jsb.__isLittleEndian__) : "bool" == n && 1 == i ? 0 != t.getInt8(e, jsb.__isLittleEndian__) : "Color4B" == n && 4 == i ? {
                    r: t.getUint8(e),
                    g: t.getUint8(e + 1),
                    b: t.getUint8(e + 2),
                    a: t.getUint8(e + 3)
                } : "int8" == n && 1 == i ? t.getUint8(e) : void cc.warn("dont know how to get value from buffer, type/size -> " + n + "/" + i + ".");
            }, e._getFieldValue = function(t, e, i) {
                var n = e[i];
                return this._getBufferValue(t, n.offset, n.size, n.type);
            }, e._getLayoutValue = function(t) {
                return this._getFieldValue(this._layoutInfo, this._layoutFields, t);
            }, e._setLayoutValue = function(t, e) {
                return this._setFieldValue(this._layoutInfo, this._layoutFields, t, e);
            }, e._updateCfgFlag_Content = function() {
                this._updateCfgFlag(1);
            }, e._updateCfgFlag_Font = function() {
                this._updateCfgFlag(2);
            }, e._colorEqual = function(t, e) {
                return t.r == e.r && t.g == e.g && t.b == e.b && t.a == e.a;
            }, e._colorToObj = function(t, e, i, n) {
                return {
                    r: t,
                    g: e,
                    b: i,
                    a: n
                };
            }, e.setString = function(t) {
                t != this._layout.string && (this._layout.string = t, this._updateCfgFlag_Content());
            }, e.setFontPath = function(t) {
                t != this._layout.fontPath && (this._layout.fontPath = t, this._updateCfgFlag_Font());
            }, e.setFontSize = function(t, e) {
                this._getFieldValue(this._cfg, this._cfgFields, "fontSize") != t && (this._setFieldValue(this._cfg, this._cfgFields, "fontSize", t), 
                this._setFieldValue(this._cfg, this._cfgFields, "fontSizeRetina", e), this._updateCfgFlag_Font());
            }, e.setOutline = function(t) {
                var e = this._getLayoutValue("outlineSize");
                e > 0 != t > 0 && this._updateCfgFlag_Font(), e != t && (this._updateCfgFlag_Content(), 
                this._setLayoutValue("outlineSize", t));
            }, e.setOutlineColor = function(t) {
                var e = this._getLayoutValue("outlineColor");
                this._colorEqual(e, t) || (this._setLayoutValue("outlineColor", t), this._updateCfgFlag_Content());
            }, e.setLineHeight = function(t) {
                this._getLayoutValue("lineHeight") != t && (this._setLayoutValue("lineHeight", t), 
                this._updateCfgFlag_Content());
            }, e.setOverFlow = function(t) {
                this._getLayoutValue("overflow") != t && (this._setLayoutValue("overflow", t), this._updateCfgFlag_Content());
            }, e.setEnableWrap = function(t) {
                this._getLayoutValue("wrap") != t && (this._setLayoutValue("wrap", t), this._updateCfgFlag_Content());
            }, e.setVerticalAlign = function(t) {
                this._getLayoutValue("valign") != t && (this._setLayoutValue("valign", t), this._updateCfgFlag_Content());
            }, e.setHorizontalAlign = function(t) {
                this._getLayoutValue("halign") != t && (this._setLayoutValue("halign", t), this._updateCfgFlag_Content());
            }, e.setContentSize = function(t, e) {
                var i = this._getLayoutValue("width"), n = this._getLayoutValue("height");
                i == t && n == e || (this._setLayoutValue("height", e), this._setLayoutValue("width", t), 
                this._updateCfgFlag_Content());
            }, e.setAnchorPoint = function(t, e) {
                var i = this._getLayoutValue("anchorX"), n = this._getLayoutValue("anchorY");
                i == t && n == e || (this._setLayoutValue("anchorX", t), this._setLayoutValue("anchorY", e), 
                this._updateCfgFlag_Content());
            }, e.setColor = function(t) {
                var e = this._getLayoutValue("color");
                this._colorEqual(e, t) || (this._setLayoutValue("color", t), this._updateCfgFlag_Content());
            }, e.setShadow = function(t, e, i) {
                var n = this._getLayoutValue("shadowBlur"), r = this._getLayoutValue("shadowX"), s = this._getLayoutValue("shadowY");
                n > 0 != i > 0 && this._updateCfgFlag_Font();
                var o = !1;
                n != i && (this._setLayoutValue("shadowBlur", i), o = !0), r != t && (this._setLayoutValue("shadowX", t), 
                o = !0), s != e && (this._setLayoutValue("shadowY", e), o = !0), o && this._updateCfgFlag_Content();
            }, e.setShadowColor = function(t) {
                var e = this._getLayoutValue("shadowColor");
                this._colorEqual(e, t) || (this._setLayoutValue("shadowColor", t), this._updateCfgFlag_Content());
            }, e.setItalic = function(t) {
                this._getLayoutValue("italic") != t && (this._setLayoutValue("italic", t), this._updateCfgFlag_Content());
            }, e.setBold = function(t) {
                this._getLayoutValue("bold") != t && (this._setLayoutValue("bold", t), this._updateCfgFlag_Content(), 
                this._updateCfgFlag_Font());
            }, e.setUnderline = function(t) {
                this._getLayoutValue("underline") != t && (this._setLayoutValue("underline", t), 
                this._updateCfgFlag_Content());
            }, e.setSpacingX = function(t) {
                this._getLayoutValue("spaceX") == t || "number" != typeof t || isNaN(t) || (this._setLayoutValue("spaceX", t), 
                this._updateCfgFlag_Content());
            }, e.updateRenderData = function(t) {
                if (t._vertsDirty) {
                    t.font && t.font.nativeUrl && this.setFontPath(cc.assetManager.cacheManager.getCache(t.font.nativeUrl) || t.font.nativeUrl);
                    var e = this._layout, i = t.node.color, n = t.node, r = t.fontSize;
                    this.setString(t.string), this.setFontSize(t.fontSize, r / 72 * t.fontSize), this.setLineHeight(t.lineHeight), 
                    this.setEnableWrap(t.enableWrapText), this.setItalic(t.enableItalic), this.setUnderline(t.enableUnderline), 
                    this.setBold(t.enableBold), this.setOverFlow(t.overflow), this.setVerticalAlign(t.verticalAlign), 
                    this.setHorizontalAlign(t.horizontalAlign), this.setSpacingX(t.spacingX), this.setContentSize(n.getContentSize().width, n.getContentSize().height), 
                    this.setAnchorPoint(n.anchorX, n.anchorY), this.setColor(this._colorToObj(i.getR(), i.getG(), i.getB(), Math.ceil(i.getA() * n.opacity / 255)));
                    var s = n.getComponent(cc.LabelShadow);
                    if (s && s.enabled) {
                        var o = s.color;
                        this.setShadow(s.offset.x, s.offset.y, s.blur), this.setShadowColor(this._colorToObj(o.getR(), o.getG(), o.getB(), Math.ceil(o.getA() * n.opacity / 255)));
                    } else this.setShadow(0, 0, -1);
                    this._updateTTFMaterial(t), e.render();
                }
            }, e._bindMaterial = function(t) {
                var e = this.labelMaterial;
                return e || (e = r.default.createWithBuiltin("2d-label", t), this.labelMaterial = e), 
                e;
            }, e._updateTTFMaterial = function(t) {
                var e = this._bindMaterial(t), i = this._label.node, n = this._layout, r = i.getComponent(cc.LabelOutline), s = 0;
                if (r && r.enabled && r.width > 0) {
                    s = Math.max(Math.min(r.width / 10, .4), .1);
                    var o = r.color;
                    this.setOutlineColor(this._colorToObj(o.getR(), o.getG(), o.getB(), Math.ceil(o.getA() * i.opacity / 255)));
                }
                this.setOutline(s), e.define("CC_USE_MODEL", !0), e.define("USE_TEXTURE_ALPHAONLY", !0), 
                e.define("USE_SDF", s > 0 || t.enableBold), e.define("USE_SDF_EXTEND", t.enableBold ? 1 : 0), 
                void 0 !== e.getDefine("CC_SUPPORT_standard_derivatives") && cc.sys.glExtension("OES_standard_derivatives") && e.define("CC_SUPPORT_standard_derivatives", !0), 
                n.setEffect(e.effect._nativeObj);
            }, e.fillBuffers = function() {
                this._layout.render();
            }, e.getVfmt = function() {}, t;
        }();
        i.default = s, e.exports = i.default;
    }, {
        "../../../../../assets/material/CCMaterial": 76,
        "../../../../../assets/material/material-variant": 83,
        "../../../../../components/CCLabel": 103,
        "../../../../../components/CCLabelOutline": 104,
        "../../../../../components/CCLabelShadow": 105
    } ],
    229: [ function(t, e, i) {
        "use strict";
        i.__esModule = !0, i.default = void 0;
        var n, r = (n = t("../../../../utils/label/ttf")) && n.__esModule ? n : {
            default: n
        }, s = t("../../../../../components/CCLabelShadow"), o = cc.color(255, 255, 255, 255), a = function(t) {
            var e, i;
            function n() {
                return t.apply(this, arguments) || this;
            }
            i = t, (e = n).prototype = Object.create(i.prototype), e.prototype.constructor = e, 
            e.__proto__ = i;
            var r = n.prototype;
            return r.updateUVs = function(t) {
                for (var e = this._renderData.vDatas[0], i = t._frame.uv, n = this.uvOffset, r = this.floatsPerVert, s = 0; s < 4; s++) {
                    var o = 2 * s, a = r * s + n;
                    e[a] = i[o], e[a + 1] = i[o + 1];
                }
            }, r.updateColor = function(e) {
                o._fastSetA(e.node._color.a);
                var i = o._val;
                t.prototype.updateColor.call(this, e, i);
            }, r.updateVerts = function(t) {
                var e = t.node, i = t._ttfTexture.width, n = t._ttfTexture.height, r = e.anchorX * e.width, o = e.anchorY * e.height, a = s && t.getComponent(s);
                if (a && a._enabled) {
                    var c = (i - e.width) / 2, l = (n - e.height) / 2, u = a.offset;
                    -u.x > c ? r += i - e.width : c > u.x && (r += c - u.x), -u.y > l ? o += n - e.height : l > u.y && (o += l - u.y);
                }
                var h = this._local;
                h[0] = -r, h[1] = -o, h[2] = i - r, h[3] = n - o, this.updateUVs(t), this.updateWorldVerts(t);
            }, n;
        }(r.default);
        i.default = a, e.exports = i.default;
    }, {
        "../../../../../components/CCLabelShadow": 105,
        "../../../../utils/label/ttf": 220
    } ],
    230: [ function(t) {
        "use strict";
        var e = l(t("../../../assembler")), i = l(t("../../../../components/CCLabel")), n = l(t("./2d/ttf")), r = l(t("./2d/bmfont")), s = l(t("./2d/letter")), o = l(t("./3d/ttf")), a = l(t("./3d/bmfont")), c = l(t("./3d/letter"));
        function l(t) {
            return t && t.__esModule ? t : {
                default: t
            };
        }
        i.default._canvasPool = {
            pool: [],
            get: function() {
                var t = this.pool.pop();
                if (!t) {
                    var e = document.createElement("canvas"), i = e.getContext("2d");
                    t = {
                        canvas: e,
                        context: i
                    }, i.textBaseline = "alphabetic";
                }
                return t;
            },
            put: function(t) {
                this.pool.length >= 32 || this.pool.push(t);
            }
        }, e.default.register(cc.Label, {
            getConstructor: function(t) {
                var e = t.node.is3DNode, l = e ? o.default : n.default;
                return t.font instanceof cc.BitmapFont ? l = e ? a.default : r.default : t.cacheMode === i.default.CacheMode.CHAR && (cc.sys.platform === cc.sys.WECHAT_GAME_SUB ? cc.warn("sorry, subdomain does not support CHAR mode currently!") : l = e ? c.default : s.default), 
                l;
            },
            TTF: n.default,
            Bmfont: r.default,
            Letter: s.default,
            TTF3D: o.default,
            Bmfont3D: a.default,
            Letter3D: c.default,
            NativeTTF: void 0
        });
    }, {
        "../../../../components/CCLabel": 103,
        "../../../assembler": 210,
        "./2d/bmfont": 226,
        "./2d/letter": 227,
        "./2d/nativeTTF": 228,
        "./2d/ttf": 229,
        "./3d/bmfont": void 0,
        "./3d/letter": void 0,
        "./3d/ttf": void 0
    } ],
    231: [ function(t, e, i) {
        "use strict";
        i.__esModule = !0, i.MaskAssembler = void 0;
        var n, r = (n = t("../../assembler")) && n.__esModule ? n : {
            default: n
        }, s = t("../../../components/CCMask"), o = t("../../render-flow"), a = t("./sprite/2d/simple"), c = t("./graphics"), l = t("../../../../renderer/gfx"), u = t("../vertex-format").vfmtPos, h = 8, _ = [];
        function f() {
            return 1 << _.length - 1;
        }
        function d() {
            for (var t = 0, e = 0; e < _.length; ++e) t += 1 << e;
            return t;
        }
        function p(t, e, i, n, r, s) {
            var o = t.effect, a = l.STENCIL_OP_KEEP, c = l.STENCIL_OP_KEEP;
            o.setStencil(l.STENCIL_ENABLE, e, n, r, i, a, c, s);
        }
        function m(t) {
            _.length + 1 > h && cc.errorID(9e3, h), _.push(t);
        }
        function v(t, e) {
            0 === _.length && cc.errorID(9001), _.pop(), 0 === _.length ? e._flushMaterial(t._exitMaterial) : x(e);
        }
        function y(t, e) {
            var i = l.DS_FUNC_NEVER, n = f(), r = n, s = n, o = t.inverted ? l.STENCIL_OP_REPLACE : l.STENCIL_OP_ZERO;
            p(t._clearMaterial, i, o, n, r, s);
            var a = e.getBuffer("mesh", u), c = a.request(4, 6), h = c.indiceOffset, _ = c.byteOffset >> 2, d = c.vertexOffset, m = a._vData, v = a._iData;
            m[_++] = -1, m[_++] = -1, m[_++] = -1, m[_++] = 1, m[_++] = 1, m[_++] = 1, m[_++] = 1, 
            m[_++] = -1, v[h++] = d, v[h++] = d + 3, v[h++] = d + 1, v[h++] = d + 1, v[h++] = d + 3, 
            v[h++] = d + 2, e.node = e._dummyNode, e.material = t._clearMaterial, e._flush();
        }
        function g(t, e) {
            var i = l.DS_FUNC_NEVER, n = f(), r = n, o = n, u = t.inverted ? l.STENCIL_OP_ZERO : l.STENCIL_OP_REPLACE;
            p(t._materials[0], i, u, n, r, o), e.material = t._materials[0], t._type === s.Type.IMAGE_STENCIL ? (e.node = e._dummyNode, 
            a.prototype.fillBuffers.call(t._assembler, t, e), e._flush()) : (e.node = t.node, 
            c.prototype.fillBuffers.call(t._graphics._assembler, t._graphics, e));
        }
        function x(t) {
            var e = l.DS_FUNC_EQUAL, i = l.STENCIL_OP_KEEP, n = d(), r = n, s = f(), o = _[_.length - 1];
            p(o._enableMaterial, e, i, n, r, s), t._flushMaterial(o._enableMaterial);
        }
        var A = function(t) {
            var e, i;
            function n() {
                return t.apply(this, arguments) || this;
            }
            i = t, (e = n).prototype = Object.create(i.prototype), e.prototype.constructor = e, 
            e.__proto__ = i;
            var r = n.prototype;
            return r.updateRenderData = function(t) {
                t._type === s.Type.IMAGE_STENCIL ? t.spriteFrame ? a.prototype.updateRenderData.call(this, t) : t.setMaterial(0, null) : (t._graphics.setMaterial(0, t._materials[0]), 
                c.prototype.updateRenderData.call(t._graphics._assembler, t._graphics, t._graphics));
            }, r.fillBuffers = function(t, e) {
                (t._type !== s.Type.IMAGE_STENCIL || t.spriteFrame) && (m(t), y(t, e), g(t, e), 
                x(e)), t.node._renderFlag |= o.FLAG_UPDATE_RENDER_DATA;
            }, r.postFillBuffers = function(t, e) {
                (t._type !== s.Type.IMAGE_STENCIL || t.spriteFrame) && v(t, e), t.node._renderFlag |= o.FLAG_UPDATE_RENDER_DATA;
            }, n;
        }(a);
        i.MaskAssembler = A, r.default.register(s, A);
    }, {
        "../../../../renderer/gfx": 298,
        "../../../components/CCMask": 107,
        "../../assembler": 210,
        "../../render-flow": 214,
        "../vertex-format": 246,
        "./graphics": 224,
        "./sprite/2d/simple": 236
    } ],
    232: [ function(t, e, i) {
        "use strict";
        i.__esModule = !0, i.default = void 0;
        var n, r = (n = t("../../assembler-2d")) && n.__esModule ? n : {
            default: n
        }, s = t("../../../components/CCMotionStreak"), o = t("../../render-flow");
        function a(t, e) {
            this.point = t || cc.v2(), this.dir = e || cc.v2(), this.distance = 0, this.time = 0;
        }
        a.prototype.setPoint = function(t, e) {
            this.point.x = t, this.point.y = e;
        }, a.prototype.setDir = function(t, e) {
            this.dir.x = t, this.dir.y = e;
        }, cc.v2(), cc.v2();
        var c = cc.v2(), l = cc.v2();
        function u(t, e) {
            return t.x = -e.y, t.y = e.x, t;
        }
        var h = function(t) {
            var e, i;
            function n() {
                return t.apply(this, arguments) || this;
            }
            i = t, (e = n).prototype = Object.create(i.prototype), e.prototype.constructor = e, 
            e.__proto__ = i;
            var r = n.prototype;
            return r.initData = function() {
                this._renderData.createFlexData(0, 16, 42);
            }, r.update = function(t, e) {
                var i, n = t._stroke / 2, r = t.node._worldMatrix.m, s = r[12], o = r[13], h = t._points;
                if (h.length > 1) {
                    var _ = h[0].point.x - s, f = h[0].point.y - o;
                    _ * _ + f * f < t.minSeg && (i = h[0]);
                }
                i || (i = new a(), h.splice(0, 0, i)), i.setPoint(s, o), i.time = t._fadeTime + e;
                var d, p = 0;
                if (!(h.length < 2)) {
                    var m = t._color, v = m.r, y = m.g, g = m.b, x = m.a, A = h[1];
                    A.distance = i.point.sub(A.point, l).mag(), l.normalizeSelf(), A.setDir(l.x, l.y), 
                    i.setDir(l.x, l.y);
                    var C = this._renderData._flexBuffer;
                    C.reserve(2 * h.length, 6 * (h.length - 1));
                    for (var b = C.vData, S = C.uintVData, T = t._fadeTime, w = !1, E = h.length - 1; E >= 0; E--) {
                        var B = h[E], M = B.point, R = B.dir;
                        if (B.time -= e, B.time < 0) h.splice(E, 1); else {
                            var P = B.time / T, I = h[E - 1];
                            if (!w) {
                                if (!I) {
                                    h.splice(E, 1);
                                    continue;
                                }
                                M.x = I.point.x - R.x * P, M.y = I.point.y - R.y * P;
                            }
                            w = !0, u(c, R);
                            var D = (P * x << 24 >>> 0) + (g << 16) + (y << 8) + v, V = 5 * p;
                            b[V] = M.x + c.x * n, b[V + 1] = M.y + c.y * n, b[V + 2] = 1, b[V + 3] = P, S[V + 4] = D, 
                            b[V += 5] = M.x - c.x * n, b[V + 1] = M.y - c.y * n, b[V + 2] = 0, b[V + 3] = P, 
                            S[V + 4] = D, p += 2;
                        }
                    }
                    d = p <= 2 ? 0 : 3 * (p - 2), C.used(p, d);
                }
            }, r.fillBuffers = function(t, e) {
                var i = this._renderData._flexBuffer, n = i.vData, r = i.usedVertices, s = i.usedIndices, a = i.usedVerticesFloats, c = e._meshBuffer, l = c.request(r, s), u = l.byteOffset >> 2, h = c._vData;
                n.length + u > h.length ? h.set(n.subarray(0, a), u) : h.set(n, u);
                for (var _ = c._iData, f = l.indiceOffset, d = l.vertexOffset, p = 0, m = r; p < m; p += 2) {
                    var v = d + p;
                    _[f++] = v, _[f++] = v + 2, _[f++] = v + 1, _[f++] = v + 1, _[f++] = v + 2, _[f++] = v + 3;
                }
                t.node._renderFlag |= o.FLAG_UPDATE_RENDER_DATA;
            }, n;
        }(r.default);
        i.default = h, h.register(s, h), e.exports = i.default;
    }, {
        "../../../components/CCMotionStreak": 108,
        "../../assembler-2d": 208,
        "../../render-flow": 214
    } ],
    233: [ function(t, e, i) {
        "use strict";
        i.__esModule = !0, i.default = void 0;
        var n, r = (n = t("../../../../assembler-2d")) && n.__esModule ? n : {
            default: n
        }, s = t("../../../../../components/CCSprite").FillType, o = function(t) {
            var e, i;
            function n() {
                return t.apply(this, arguments) || this;
            }
            i = t, (e = n).prototype = Object.create(i.prototype), e.prototype.constructor = e, 
            e.__proto__ = i;
            var r = n.prototype;
            return r.updateRenderData = function(t) {
                var e = t._spriteFrame;
                if (this.packToDynamicAtlas(t, e), t._vertsDirty) {
                    var i = t._fillStart, n = t._fillRange;
                    n < 0 && (i += n, n = -n), n = (n = (n = i + n) > 1 ? 1 : n) < 0 ? 0 : n;
                    var r = (i = (i = i > 1 ? 1 : i) < 0 ? 0 : i) + (n = (n -= i) < 0 ? 0 : n);
                    r = r > 1 ? 1 : r, this.updateUVs(t, i, r), this.updateVerts(t, i, r), t._vertsDirty = !1;
                }
            }, r.updateUVs = function(t, e, i) {
                var n, r, o, a, c, l, u, h, _, f, d = t._spriteFrame, p = d._texture.width, m = d._texture.height, v = d._rect;
                d._rotated ? (n = v.x / p, r = (v.y + v.width) / m, o = c = n, u = _ = (v.x + v.height) / p, 
                l = f = r, a = h = v.y / m) : (n = v.x / p, r = (v.y + v.height) / m, o = u = n, 
                c = _ = (v.x + v.width) / p, a = l = r, h = f = v.y / m);
                var y = this._renderData.vDatas[0], g = this.uvOffset, x = this.floatsPerVert;
                switch (t._fillType) {
                  case s.HORIZONTAL:
                    y[g] = o + (c - o) * e, y[g + 1] = a + (l - a) * e, y[g + x] = o + (c - o) * i, 
                    y[g + x + 1] = a + (l - a) * i, y[g + 2 * x] = u + (_ - u) * e, y[g + 2 * x + 1] = h + (f - h) * e, 
                    y[g + 3 * x] = u + (_ - u) * i, y[g + 3 * x + 1] = h + (f - h) * i;
                    break;

                  case s.VERTICAL:
                    y[g] = o + (u - o) * e, y[g + 1] = a + (h - a) * e, y[g + x] = c + (_ - c) * e, 
                    y[g + x + 1] = l + (f - l) * e, y[g + 2 * x] = o + (u - o) * i, y[g + 2 * x + 1] = a + (h - a) * i, 
                    y[g + 3 * x] = c + (_ - c) * i, y[g + 3 * x + 1] = l + (f - l) * i;
                    break;

                  default:
                    cc.errorID(2626);
                }
            }, r.updateVerts = function(t, e, i) {
                var n, r = t.node, o = r.width, a = r.height, c = r.anchorX * o, l = r.anchorY * a, u = -c, h = -l, _ = o - c, f = a - l;
                switch (t._fillType) {
                  case s.HORIZONTAL:
                    n = u + (_ - u) * i, u += (_ - u) * e, _ = n;
                    break;

                  case s.VERTICAL:
                    n = h + (f - h) * i, h += (f - h) * e, f = n;
                    break;

                  default:
                    cc.errorID(2626);
                }
                var d = this._local;
                d[0] = u, d[1] = h, d[2] = _, d[3] = f, this.updateWorldVerts(t);
            }, n;
        }(r.default);
        i.default = o, e.exports = i.default;
    }, {
        "../../../../../components/CCSprite": 114,
        "../../../../assembler-2d": 208
    } ],
    234: [ function(t, e, i) {
        "use strict";
        var n;
        i.__esModule = !0, i.default = void 0;
        var r = function(t) {
            var e, i;
            function n() {
                return t.apply(this, arguments) || this;
            }
            i = t, (e = n).prototype = Object.create(i.prototype), e.prototype.constructor = e, 
            e.__proto__ = i;
            var r = n.prototype;
            return r.initData = function() {
                this._renderData.createFlexData(0, 4, 6, this.getVfmt());
            }, r.updateRenderData = function(t) {
                this.packToDynamicAtlas(t, t._spriteFrame);
                var e = t.spriteFrame;
                if (e) {
                    var i = e.vertices;
                    if (i) {
                        this.verticesCount = i.x.length, this.indicesCount = i.triangles.length;
                        var n = this._renderData._flexBuffer;
                        n.reserve(this.verticesCount, this.indicesCount) && (this.updateColor(t), t._vertsDirty = !0), 
                        n.used(this.verticesCount, this.indicesCount), this.updateIndices(i.triangles), 
                        t._vertsDirty && (this.updateUVs(t), this.updateVerts(t), this.updateWorldVerts(t), 
                        t._vertsDirty = !1);
                    }
                }
            }, r.updateIndices = function(t) {
                this._renderData.iDatas[0].set(t);
            }, r.updateUVs = function(t) {
                for (var e = t.spriteFrame.vertices, i = e.nu, n = e.nv, r = this.uvOffset, s = this.floatsPerVert, o = this._renderData.vDatas[0], a = 0; a < i.length; a++) {
                    var c = s * a + r;
                    o[c] = i[a], o[c + 1] = n[a];
                }
            }, r.updateVerts = function(t) {
                var e = t.node, i = Math.abs(e.width), n = Math.abs(e.height), r = e.anchorX * i, s = e.anchorY * n, o = t.spriteFrame, a = o.vertices, c = a.x, l = a.y, u = o._originalSize.width, h = o._originalSize.height, _ = o._rect.width, f = o._rect.height, d = o._offset.x + (u - _) / 2, p = o._offset.y + (h - f) / 2, m = i / (t.trim ? _ : u), v = n / (t.trim ? f : h), y = this._local;
                if (t.trim) for (var g = 0, x = c.length; g < x; g++) {
                    var A = 2 * g;
                    y[A] = (c[g] - d) * m - r, y[A + 1] = (h - l[g] - p) * v - s;
                } else for (var C = 0, b = c.length; C < b; C++) {
                    var S = 2 * C;
                    y[S] = c[C] * m - r, y[S + 1] = (h - l[C]) * v - s;
                }
            }, r.updateWorldVerts = function(t) {
                for (var e = t.node._worldMatrix.m, i = e[0], n = e[1], r = e[4], s = e[5], o = e[12], a = e[13], c = this._local, l = this._renderData.vDatas[0], u = this.floatsPerVert, h = 0, _ = this.verticesCount; h < _; h++) {
                    var f = c[2 * h], d = c[2 * h + 1];
                    l[u * h] = f * i + d * r + o, l[u * h + 1] = f * n + d * s + a;
                }
            }, n;
        }(((n = t("../../../../assembler-2d")) && n.__esModule ? n : {
            default: n
        }).default);
        i.default = r, e.exports = i.default;
    }, {
        "../../../../assembler-2d": 208
    } ],
    235: [ function(t, e, i) {
        "use strict";
        i.__esModule = !0, i.default = void 0;
        var n, r = (n = t("../../../../assembler-2d")) && n.__esModule ? n : {
            default: n
        }, s = 2 * Math.PI, o = [ cc.v2(0, 0), cc.v2(0, 0), cc.v2(0, 0), cc.v2(0, 0) ], a = [ 0, 0, 0, 0 ], c = [ 0, 0, 0, 0, 0, 0, 0, 0 ], l = [ cc.v2(0, 0), cc.v2(0, 0), cc.v2(0, 0), cc.v2(0, 0) ], u = [ cc.v2(0, 0), cc.v2(0, 0), cc.v2(0, 0), cc.v2(0, 0) ], h = cc.v2(0, 0), _ = [];
        function f(t, e, i, n, r, s, o) {
            var a, c, l = Math.sin(s), u = Math.cos(s);
            if (0 !== Math.cos(s)) {
                if (a = l / u, (t - r.x) * u > 0) {
                    var h = r.y + a * (t - r.x);
                    o[0].x = t, o[0].y = h;
                }
                if ((e - r.x) * u > 0) {
                    var _ = r.y + a * (e - r.x);
                    o[2].x = e, o[2].y = _;
                }
            }
            if (0 !== Math.sin(s)) {
                if (c = u / l, (n - r.y) * l > 0) {
                    var f = r.x + c * (n - r.y);
                    o[3].x = f, o[3].y = n;
                }
                if ((i - r.y) * l > 0) {
                    var d = r.x + c * (i - r.y);
                    o[1].x = d, o[1].y = i;
                }
            }
        }
        function d(t) {
            var e = t.node, i = e.width, n = e.height, r = e.anchorX * i, s = e.anchorY * n, c = -r, l = -s, u = i - r, f = n - s, d = a;
            d[0] = c, d[1] = l, d[2] = u, d[3] = f;
            var p = t._fillCenter, m = h.x = Math.min(Math.max(0, p.x), 1) * (u - c) + c, v = h.y = Math.min(Math.max(0, p.y), 1) * (f - l) + l;
            o[0].x = o[3].x = c, o[1].x = o[2].x = u, o[0].y = o[1].y = l, o[2].y = o[3].y = f, 
            _.length = 0, m !== d[0] && (_[0] = [ 3, 0 ]), m !== d[2] && (_[2] = [ 1, 2 ]), 
            v !== d[1] && (_[1] = [ 0, 1 ]), v !== d[3] && (_[3] = [ 2, 3 ]);
        }
        function p(t, e) {
            var i, n;
            if (i = e.x - t.x, n = e.y - t.y, 0 !== i || 0 !== n) {
                if (0 === i) return n > 0 ? .5 * Math.PI : 1.5 * Math.PI;
                var r = Math.atan(n / i);
                return i < 0 && (r += Math.PI), r;
            }
        }
        var m = function(t) {
            var e, i;
            function n() {
                return t.apply(this, arguments) || this;
            }
            i = t, (e = n).prototype = Object.create(i.prototype), e.prototype.constructor = e, 
            e.__proto__ = i;
            var r = n.prototype;
            return r.initData = function() {
                this._renderData.createFlexData(0, 4, 6, this.getVfmt()), this.updateIndices();
            }, r.updateRenderData = function(e) {
                t.prototype.updateRenderData.call(this, e);
                var i, n, r, o, _, p, m, v, y, g = e.spriteFrame;
                if (this.packToDynamicAtlas(e, g), e._vertsDirty) {
                    var x = e._fillStart, A = e._fillRange;
                    for (A < 0 && (x += A, A = -A); x >= 1; ) x -= 1;
                    for (;x < 0; ) x += 1;
                    x *= s, A *= s, d(e), p = (i = g)._texture.width, m = i._texture.height, v = i._rect, 
                    y = c, i._rotated ? (n = v.x / p, r = (v.x + v.height) / p, o = v.y / m, _ = (v.y + v.width) / m, 
                    y[0] = y[2] = n, y[4] = y[6] = r, y[3] = y[7] = _, y[1] = y[5] = o) : (n = v.x / p, 
                    r = (v.x + v.width) / p, o = v.y / m, _ = (v.y + v.height) / m, y[0] = y[4] = n, 
                    y[2] = y[6] = r, y[1] = y[3] = _, y[5] = y[7] = o), f(a[0], a[2], a[1], a[3], h, x, l), 
                    f(a[0], a[2], a[1], a[3], h, x + A, u), this.updateVerts(e, x, A), e._vertsDirty = !1;
                }
            }, r.updateVerts = function(t, e, i) {
                var n = e + i, r = this._local;
                r.length = 0;
                for (var a = 0, c = 3 * this.floatsPerVert, f = 0; f < 4; ++f) {
                    var d = _[f];
                    if (d) if (i >= s) r.length = a + c, this._generateTriangle(r, a, h, o[d[0]], o[d[1]]), 
                    a += c; else {
                        var m = p(h, o[d[0]]), v = p(h, o[d[1]]);
                        v < m && (v += s), m -= s, v -= s;
                        for (var y = 0; y < 3; ++y) m >= n || (m >= e ? (r.length = a + c, v >= n ? this._generateTriangle(r, a, h, o[d[0]], u[f]) : this._generateTriangle(r, a, h, o[d[0]], o[d[1]]), 
                        a += c) : v <= e || (v <= n ? (r.length = a + c, this._generateTriangle(r, a, h, l[f], o[d[1]]), 
                        a += c) : (r.length = a + c, this._generateTriangle(r, a, h, l[f], u[f]), a += c))), 
                        m += s, v += s;
                    }
                }
                this.allocWorldVerts(t), this.updateWorldVerts(t);
            }, r.allocWorldVerts = function(t) {
                var e = t.node._color._val, i = this._renderData, n = this.floatsPerVert, r = this._local, s = r.length / n;
                this.verticesCount = this.indicesCount = s;
                var o = i._flexBuffer;
                o.reserve(s, s) && this.updateIndices(), o.used(this.verticesCount, this.indicesCount);
                for (var a = i.vDatas[0], c = i.uintVDatas[0], l = this.uvOffset, u = 0; u < r.length; u += n) {
                    var h = u + l;
                    a[h] = r[h], a[h + 1] = r[h + 1], c[h + 2] = e;
                }
            }, r.updateIndices = function() {
                for (var t = this._renderData.iDatas[0], e = 0; e < t.length; e++) t[e] = e;
            }, r.updateWorldVerts = function(t) {
                for (var e = t.node._worldMatrix.m, i = e[0], n = e[1], r = e[4], s = e[5], o = e[12], a = e[13], c = this._local, l = this._renderData.vDatas[0], u = this.floatsPerVert, h = 0; h < c.length; h += u) {
                    var _ = c[h], f = c[h + 1];
                    l[h] = _ * i + f * r + o, l[h + 1] = _ * n + f * s + a;
                }
            }, r._generateTriangle = function(t, e, i, n, r) {
                var s = a, o = s[0], c = s[1], l = s[2], u = s[3], h = this.floatsPerVert;
                t[e] = i.x, t[e + 1] = i.y, t[e + h] = n.x, t[e + h + 1] = n.y, t[e + 2 * h] = r.x, 
                t[e + 2 * h + 1] = r.y;
                var _, f, d = this.uvOffset;
                _ = (i.x - o) / (l - o), f = (i.y - c) / (u - c), this._generateUV(_, f, t, e + d), 
                _ = (n.x - o) / (l - o), f = (n.y - c) / (u - c), this._generateUV(_, f, t, e + h + d), 
                _ = (r.x - o) / (l - o), f = (r.y - c) / (u - c), this._generateUV(_, f, t, e + 2 * h + d);
            }, r._generateUV = function(t, e, i, n) {
                var r = c[0] + (c[2] - c[0]) * t, s = c[4] + (c[6] - c[4]) * t, o = c[1] + (c[3] - c[1]) * t, a = c[5] + (c[7] - c[5]) * t;
                i[n] = r + (s - r) * e, i[n + 1] = o + (a - o) * e;
            }, n;
        }(r.default);
        i.default = m, e.exports = i.default;
    }, {
        "../../../../assembler-2d": 208
    } ],
    236: [ function(t, e, i) {
        "use strict";
        var n;
        i.__esModule = !0, i.default = void 0;
        var r = function(t) {
            var e, i;
            function n() {
                return t.apply(this, arguments) || this;
            }
            i = t, (e = n).prototype = Object.create(i.prototype), e.prototype.constructor = e, 
            e.__proto__ = i;
            var r = n.prototype;
            return r.updateRenderData = function(t) {
                this.packToDynamicAtlas(t, t._spriteFrame), t._vertsDirty && (this.updateUVs(t), 
                this.updateVerts(t), t._vertsDirty = !1);
            }, r.updateUVs = function(t) {
                for (var e = t._spriteFrame.uv, i = this.uvOffset, n = this.floatsPerVert, r = this._renderData.vDatas[0], s = 0; s < 4; s++) {
                    var o = 2 * s, a = n * s + i;
                    r[a] = e[o], r[a + 1] = e[o + 1];
                }
            }, r.updateVerts = function(t) {
                var e, i, n, r, s = t.node, o = s.width, a = s.height, c = s.anchorX * o, l = s.anchorY * a;
                if (t.trim) e = -c, i = -l, n = o - c, r = a - l; else {
                    var u = t.spriteFrame, h = u._originalSize.width, _ = u._originalSize.height, f = u._rect.width, d = u._rect.height, p = u._offset, m = o / h, v = a / _, y = p.x + (h - f) / 2, g = p.x - (h - f) / 2;
                    e = y * m - c, i = (p.y + (_ - d) / 2) * v - l, n = o + g * m - c, r = a + (p.y - (_ - d) / 2) * v - l;
                }
                var x = this._local;
                x[0] = e, x[1] = i, x[2] = n, x[3] = r, this.updateWorldVerts(t);
            }, n;
        }(((n = t("../../../../assembler-2d")) && n.__esModule ? n : {
            default: n
        }).default);
        i.default = r, e.exports = i.default;
    }, {
        "../../../../assembler-2d": 208
    } ],
    237: [ function(t, e, i) {
        "use strict";
        var n;
        i.__esModule = !0, i.default = void 0;
        var r = function(t) {
            var e, i;
            function n() {
                return t.apply(this, arguments) || this;
            }
            i = t, (e = n).prototype = Object.create(i.prototype), e.prototype.constructor = e, 
            e.__proto__ = i;
            var r = n.prototype;
            return r.initData = function() {
                if (!(this._renderData.meshCount > 0)) {
                    this._renderData.createData(0, this.verticesFloats, this.indicesCount);
                    for (var t = this._renderData.iDatas[0], e = 0, i = 0; i < 3; ++i) for (var n = 0; n < 3; ++n) {
                        var r = 4 * i + n;
                        t[e++] = r, t[e++] = r + 1, t[e++] = r + 4, t[e++] = r + 1, t[e++] = r + 5, t[e++] = r + 4;
                    }
                }
            }, r.initLocal = function() {
                this._local = [], this._local.length = 8;
            }, r.updateRenderData = function(t) {
                var e = t._spriteFrame;
                this.packToDynamicAtlas(t, e), t._vertsDirty && (this.updateUVs(t), this.updateVerts(t), 
                t._vertsDirty = !1);
            }, r.updateVerts = function(t) {
                var e = t.node, i = e.width, n = e.height, r = e.anchorX * i, s = e.anchorY * n, o = t.spriteFrame, a = o.insetLeft, c = o.insetRight, l = o.insetTop, u = o.insetBottom, h = i - a - c, _ = n - l - u, f = i / (a + c), d = n / (l + u);
                f = isNaN(f) || f > 1 ? 1 : f, d = isNaN(d) || d > 1 ? 1 : d, h = h < 0 ? 0 : h, 
                _ = _ < 0 ? 0 : _;
                var p = this._local;
                p[0] = -r, p[1] = -s, p[2] = a * f - r, p[3] = u * d - s, p[4] = p[2] + h, p[5] = p[3] + _, 
                p[6] = i - r, p[7] = n - s, this.updateWorldVerts(t);
            }, r.updateUVs = function(t) {
                for (var e = this._renderData.vDatas[0], i = t.spriteFrame.uvSliced, n = this.uvOffset, r = this.floatsPerVert, s = 0; s < 4; ++s) for (var o = 0; o < 4; ++o) {
                    var a = 4 * s + o, c = i[a], l = a * r;
                    e[l + n] = c.u, e[l + n + 1] = c.v;
                }
            }, r.updateWorldVerts = function(t) {
                for (var e = t.node._worldMatrix.m, i = e[0], n = e[1], r = e[4], s = e[5], o = e[12], a = e[13], c = this._local, l = this._renderData.vDatas[0], u = this.floatsPerVert, h = 0; h < 4; ++h) for (var _ = c[2 * h + 1], f = 0; f < 4; ++f) {
                    var d = c[2 * f], p = (4 * h + f) * u;
                    l[p] = d * i + _ * r + o, l[p + 1] = d * n + _ * s + a;
                }
            }, n;
        }(((n = t("../../../../assembler-2d")) && n.__esModule ? n : {
            default: n
        }).default);
        i.default = r, Object.assign(r.prototype, {
            verticesCount: 16,
            indicesCount: 54
        }), e.exports = i.default;
    }, {
        "../../../../assembler-2d": 208
    } ],
    238: [ function(t, e, i) {
        "use strict";
        var n;
        i.__esModule = !0, i.default = void 0;
        var r = function(t) {
            var e, i;
            function n() {
                return t.apply(this, arguments) || this;
            }
            i = t, (e = n).prototype = Object.create(i.prototype), e.prototype.constructor = e, 
            e.__proto__ = i;
            var r = n.prototype;
            return r.initData = function() {
                this.verticesCount = 0, this.contentWidth = 0, this.contentHeight = 0, this.rectWidth = 0, 
                this.rectHeight = 0, this.hRepeat = 0, this.vRepeat = 0, this.row = 0, this.col = 0, 
                this._renderData.createFlexData(0, 4, 6, this.getVfmt()), this._updateIndices();
            }, r.initLocal = function() {
                this._local = {
                    x: [],
                    y: []
                };
            }, r._updateIndices = function() {
                for (var t = this._renderData.iDatas[0], e = 0, i = 0, n = t.length; e < n; e += 6, 
                i += 4) t[e] = i, t[e + 1] = i + 1, t[e + 2] = i + 2, t[e + 3] = i + 1, t[e + 4] = i + 3, 
                t[e + 5] = i + 2;
            }, r.updateRenderData = function(t) {
                var e = t._spriteFrame;
                this.packToDynamicAtlas(t, e);
                var i = t.node, n = this.contentWidth = Math.abs(i.width), r = this.contentHeight = Math.abs(i.height), s = e._rect, o = e.insetLeft, a = e.insetRight, c = s.width - o - a, l = e.insetTop, u = e.insetBottom, h = s.height - l - u;
                this.sizableWidth = n - o - a, this.sizableHeight = r - l - u, this.sizableWidth = this.sizableWidth > 0 ? this.sizableWidth : 0, 
                this.sizableHeight = this.sizableHeight > 0 ? this.sizableHeight : 0;
                var _ = this.hRepeat = 0 === c ? this.sizableWidth : this.sizableWidth / c, f = this.vRepeat = 0 === h ? this.sizableHeight : this.sizableHeight / h, d = (this.row = Math.ceil(f + 2)) * (this.col = Math.ceil(_ + 2));
                this.verticesCount = 4 * d, this.indicesCount = 6 * d;
                var p = this._renderData._flexBuffer;
                p.reserve(this.verticesCount, this.indicesCount) && (this._updateIndices(), this.updateColor(t)), 
                p.used(this.verticesCount, this.indicesCount), t._vertsDirty && (this.updateUVs(t), 
                this.updateVerts(t), t._vertsDirty = !1);
            }, r.updateVerts = function(t) {
                var e = t._spriteFrame, i = e._rect, n = t.node, r = n.anchorX * n.width, s = n.anchorY * n.height, o = this.row, a = this.col, c = this.contentWidth, l = this.contentHeight, u = this._local, h = u.x, _ = u.y;
                h.length = _.length = 0;
                var f, d, p = e.insetLeft, m = e.insetRight, v = i.width - p - m, y = e.insetTop, g = e.insetBottom, x = i.height - y - g, A = n.width / (p + m) > 1 ? 1 : n.width / (p + m), C = n.height / (y + g) > 1 ? 1 : n.height / (y + g);
                f = v > 0 ? Math.floor(1e3 * this.sizableWidth) / 1e3 % v == 0 ? v : this.sizableWidth % v : this.sizableWidth, 
                d = x > 0 ? Math.floor(1e3 * this.sizableHeight) / 1e3 % x == 0 ? x : this.sizableHeight % x : this.sizableHeight;
                for (var b = 0; b <= a; b++) 0 === b ? h[b] = -r : b > 0 && b < a ? h[b] = 1 === b ? p * A + Math.min(v, this.sizableWidth) - r : v > 0 ? b === a - 1 ? p + f + v * (b - 2) - r : p + Math.min(v, this.sizableWidth) + v * (b - 2) - r : p + this.sizableWidth - r : b === a && (h[b] = Math.min(p + this.sizableWidth + m, c) - r);
                for (var S = 0; S <= o; S++) 0 === S ? _[S] = -s : S > 0 && S < o ? _[S] = 1 === S ? g * C + Math.min(x, this.sizableHeight) - s : x > 0 ? S === o - 1 ? g + d + (S - 2) * x - s : g + Math.min(x, this.sizableHeight) + (S - 2) * x - s : g + this.sizableHeight - s : S === o && (_[S] = Math.min(g + this.sizableHeight + y, l) - s);
                this.updateWorldVerts(t);
            }, r.updateWorldVerts = function(t) {
                for (var e, i, n, r, s = this._renderData, o = this._local, a = o.x, c = o.y, l = s.vDatas[0], u = this.row, h = this.col, _ = t.node._worldMatrix.m, f = _[0], d = _[1], p = _[4], m = _[5], v = _[12], y = _[13], g = this.floatsPerVert, x = 0, A = 0, C = u; A < C; ++A) {
                    n = c[A], r = c[A + 1];
                    for (var b = 0, S = h; b < S; ++b) e = a[b], i = a[b + 1], l[x] = e * f + n * p + v, 
                    l[x + 1] = e * d + n * m + y, l[x += g] = i * f + n * p + v, l[x + 1] = i * d + n * m + y, 
                    l[x += g] = e * f + r * p + v, l[x + 1] = e * d + r * m + y, l[x += g] = i * f + r * p + v, 
                    l[x + 1] = i * d + r * m + y, x += g;
                }
            }, r.updateUVs = function(t) {
                var e = this._renderData.vDatas[0];
                if (e) for (var i = t._spriteFrame, n = i._rect, r = i.insetLeft, s = i.insetRight, o = n.width - r - s, a = i.insetTop, c = i.insetBottom, l = n.height - a - c, u = this.row, h = this.col, _ = this.hRepeat, f = this.vRepeat, d = 0, p = 0, m = t.spriteFrame.uv, v = t.spriteFrame.uvSliced, y = t.spriteFrame._rotated, g = this.floatsPerVert, x = this.uvOffset, A = 0, C = u; A < C; ++A) {
                    p = this.sizableHeight > l ? this.sizableHeight >= A * l ? 1 : f % 1 : f;
                    for (var b = 0, S = h; b < S; ++b) d = this.sizableWidth > o ? this.sizableWidth >= b * o ? 1 : _ % 1 : _, 
                    y ? (e[x] = m[0], e[x + 1] = m[1], e[x += g] = m[0], e[x + 1] = m[1] + (m[7] - m[1]) * d, 
                    e[x += g] = m[0] + (m[6] - m[0]) * p, e[x + 1] = m[1], e[x += g] = e[x - g], e[x + 1] = e[x + 1 - 2 * g], 
                    x += g) : (0 === b ? e[x] = m[0] : b > 0 && b < h - 1 ? e[x] = v[1].u : b === h - 1 && (e[x] = v[2].u), 
                    0 === A ? e[x + 1] = v[0].v : A > 0 && A < u - 1 ? e[x + 1] = v[4].v : A === u - 1 && (e[x + 1] = v[8].v), 
                    x += g, 0 === b ? e[x] = v[1].u + (v[2].u - v[1].u) * d : b > 0 && b < h - 1 ? e[x] = v[1].u + (v[2].u - v[1].u) * d : b === h - 1 && (e[x] = v[3].u), 
                    0 === A ? e[x + 1] = v[0].v : A > 0 && A < u - 1 ? e[x + 1] = v[4].v : A === u - 1 && (e[x + 1] = v[8].v), 
                    x += g, 0 === b ? e[x] = m[0] : b > 0 && b < h - 1 ? e[x] = v[1].u : b === h - 1 && (e[x] = v[2].u), 
                    0 === A ? e[x + 1] = v[4].v + (v[8].v - v[4].v) * p : A > 0 && A < u - 1 ? e[x + 1] = v[4].v + (v[8].v - v[4].v) * p : A === u - 1 && (e[x + 1] = v[12].v), 
                    e[x += g] = e[x - 2 * g], e[x + 1] = e[x + 1 - g], x += g);
                }
            }, n;
        }(((n = t("../../../../assembler-2d")) && n.__esModule ? n : {
            default: n
        }).default);
        i.default = r, e.exports = i.default;
    }, {
        "../../../../assembler-2d": 208
    } ],
    239: [ function(t) {
        "use strict";
        var e = p(t("../../../assembler")), i = t("../../../../components/CCSprite"), n = p(t("./2d/simple")), r = p(t("./2d/sliced")), s = p(t("./2d/tiled")), o = p(t("./2d/radial-filled")), a = p(t("./2d/bar-filled")), c = p(t("./2d/mesh")), l = p(t("./3d/simple")), u = p(t("./3d/sliced")), h = p(t("./3d/tiled")), _ = p(t("./3d/radial-filled")), f = p(t("./3d/bar-filled")), d = p(t("./3d/mesh"));
        function p(t) {
            return t && t.__esModule ? t : {
                default: t
            };
        }
        var m = {
            getConstructor: function(t) {
                var e = t.node.is3DNode, p = e ? l.default : n.default;
                switch (t.type) {
                  case i.Type.SLICED:
                    p = e ? u.default : r.default;
                    break;

                  case i.Type.TILED:
                    p = e ? h.default : s.default;
                    break;

                  case i.Type.FILLED:
                    p = t._fillType === i.FillType.RADIAL ? e ? _.default : o.default : e ? f.default : a.default;
                    break;

                  case i.Type.MESH:
                    p = e ? d.default : c.default;
                }
                return p;
            },
            Simple: n.default,
            Sliced: r.default,
            Tiled: s.default,
            RadialFilled: o.default,
            BarFilled: a.default,
            Mesh: c.default,
            Simple3D: l.default,
            Sliced3D: u.default,
            Tiled3D: h.default,
            RadialFilled3D: _.default,
            BarFilled3D: f.default,
            Mesh3D: d.default
        };
        e.default.register(cc.Sprite, m);
    }, {
        "../../../../components/CCSprite": 114,
        "../../../assembler": 210,
        "./2d/bar-filled": 233,
        "./2d/mesh": 234,
        "./2d/radial-filled": 235,
        "./2d/simple": 236,
        "./2d/sliced": 237,
        "./2d/tiled": 238,
        "./3d/bar-filled": void 0,
        "./3d/mesh": void 0,
        "./3d/radial-filled": void 0,
        "./3d/simple": void 0,
        "./3d/sliced": void 0,
        "./3d/tiled": void 0
    } ],
    240: [ function(t, e, i) {
        "use strict";
        i.__esModule = !0, i.default = void 0;
        var n = function() {
            function t(t, e, i, n, r) {
                this._handler = t, this._index = e, this._vfmt = r, this._verticesBytes = r._bytes, 
                this._initVerticesCount = i, this._initIndicesCount = n, this.reset();
            }
            var e = t.prototype;
            return e._reallocVData = function(t, e) {
                this.vData = new Float32Array(t), this.uintVData = new Uint32Array(this.vData.buffer), 
                e && this.vData.set(e), this._handler.updateMesh(this._index, this.vData, this.iData);
            }, e._reallocIData = function(t, e) {
                this.iData = new Uint16Array(t), e && this.iData.set(e), this._handler.updateMesh(this._index, this.vData, this.iData);
            }, e.reserve = function(t, e) {
                var i = t * this._verticesBytes >> 2, n = this.vData.length, r = !1;
                if (i > n) {
                    for (;n < i; ) n *= 2;
                    this._reallocVData(n, this.vData), r = !0;
                }
                var s = this.iData.length;
                if (e > s) {
                    for (;s < e; ) s *= 2;
                    this._reallocIData(e, this.iData), r = !0;
                }
                return r;
            }, e.used = function(t, e) {
                this.usedVertices = t, this.usedIndices = e, this.usedVerticesFloats = t * this._verticesBytes >> 2, 
                this._handler.updateMeshRange(t, e);
            }, e.reset = function() {
                var t = this._initVerticesCount * this._verticesBytes >> 2;
                this._reallocVData(t), this._reallocIData(this._initIndicesCount), this.usedVertices = 0, 
                this.usedVerticesFloats = 0, this.usedIndices = 0;
            }, t;
        }();
        i.default = n, cc.FlexBuffer = n, e.exports = i.default;
    }, {} ],
    241: [ function(t, e) {
        "use strict";
        var i, n = (i = t("../../../renderer/gfx")) && i.__esModule ? i : {
            default: i
        }, r = cc.sys.os === cc.sys.OS_IOS && cc.sys.isBrowser && cc.sys.isMobile && /iPhone OS 14/.test(window.navigator.userAgent), s = cc.Class({
            name: "cc.MeshBuffer",
            ctor: function(t, e) {
                this.init(t, e);
            },
            init: function(t, e) {
                this.byteOffset = 0, this.indiceOffset = 0, this.vertexOffset = 0, this.indiceStart = 0, 
                this._dirty = !1, this._vertexFormat = e, this._vertexBytes = this._vertexFormat._bytes, 
                this._arrOffset = 0, this._vbArr = [], this._vb = new n.default.VertexBuffer(t._device, e, n.default.USAGE_DYNAMIC, new ArrayBuffer(), 0), 
                this._vbArr[0] = this._vb, this._ibArr = [], this._ib = new n.default.IndexBuffer(t._device, n.default.INDEX_FMT_UINT16, n.default.USAGE_STATIC, new ArrayBuffer(), 0), 
                this._ibArr[0] = this._ib, this._vData = null, this._uintVData = null, this._iData = null, 
                this._batcher = t, this._initVDataCount = 256 * e._bytes, this._initIDataCount = 1536, 
                this._offsetInfo = {
                    byteOffset: 0,
                    vertexOffset: 0,
                    indiceOffset: 0
                }, this._reallocBuffer();
            },
            uploadData: function() {
                if (0 !== this.byteOffset && this._dirty) {
                    var t = new Float32Array(this._vData.buffer, 0, this.byteOffset >> 2), e = new Uint16Array(this._iData.buffer, 0, this.indiceOffset);
                    this._vb.update(0, t), this._ib.update(0, e), this._dirty = !1;
                }
            },
            switchBuffer: function() {
                var t = ++this._arrOffset;
                this.byteOffset = 0, this.vertexOffset = 0, this.indiceOffset = 0, this.indiceStart = 0, 
                t < this._vbArr.length ? (this._vb = this._vbArr[t], this._ib = this._ibArr[t]) : (this._vb = new n.default.VertexBuffer(this._batcher._device, this._vertexFormat, n.default.USAGE_DYNAMIC, new ArrayBuffer(), 0), 
                this._vbArr[t] = this._vb, this._ib = new n.default.IndexBuffer(this._batcher._device, n.default.INDEX_FMT_UINT16, n.default.USAGE_STATIC, new ArrayBuffer(), 0), 
                this._ibArr[t] = this._ib);
            },
            checkAndSwitchBuffer: function(t) {
                this.vertexOffset + t > 65535 && (this.uploadData(), this._batcher._flush(), this.switchBuffer());
            },
            requestStatic: function(t, e) {
                this.checkAndSwitchBuffer(t);
                var i = this.byteOffset + t * this._vertexBytes, n = this.indiceOffset + e, r = this._vData.byteLength, s = this._iData.length;
                if (i > r || n > s) {
                    for (;r < i || s < n; ) this._initVDataCount *= 2, this._initIDataCount *= 2, r = 4 * this._initVDataCount, 
                    s = this._initIDataCount;
                    this._reallocBuffer();
                }
                this._updateOffset(t, e, i);
            },
            _updateOffset: function(t, e, i) {
                var n = this._offsetInfo;
                n.vertexOffset = this.vertexOffset, this.vertexOffset += t, n.indiceOffset = this.indiceOffset, 
                this.indiceOffset += e, n.byteOffset = this.byteOffset, this.byteOffset = i, this._dirty = !0;
            },
            request: function(t, e) {
                return this._batcher._buffer !== this && (this._batcher._flush(), this._batcher._buffer = this), 
                this.requestStatic(t, e), this._offsetInfo;
            },
            _reallocBuffer: function() {
                this._reallocVData(!0), this._reallocIData(!0);
            },
            _reallocVData: function(t) {
                var e;
                this._vData && (e = new Uint8Array(this._vData.buffer)), this._vData = new Float32Array(this._initVDataCount), 
                this._uintVData = new Uint32Array(this._vData.buffer);
                var i = new Uint8Array(this._uintVData.buffer);
                if (e && t) for (var n = 0, r = e.length; n < r; n++) i[n] = e[n];
            },
            _reallocIData: function(t) {
                var e = this._iData;
                if (this._iData = new Uint16Array(this._initIDataCount), e && t) for (var i = this._iData, n = 0, r = e.length; n < r; n++) i[n] = e[n];
            },
            reset: function() {
                this._arrOffset = 0, this._vb = this._vbArr[0], this._ib = this._ibArr[0], this.byteOffset = 0, 
                this.indiceOffset = 0, this.vertexOffset = 0, this.indiceStart = 0, this._dirty = !1;
            },
            destroy: function() {
                this.reset();
                for (var t = 0; t < this._vbArr.length; t++) this._vbArr[t].destroy();
                this._vbArr = null;
                for (var e = 0; e < this._ibArr.length; e++) this._ibArr[e].destroy();
                this._ibArr = null, this._ib = null, this._vb = null;
            },
            forwardIndiceStartToOffset: function() {
                this.indiceStart = this.indiceOffset;
            }
        });
        r && (s.prototype.checkAndSwitchBuffer = function(t) {
            this.vertexOffset + t > 65535 && (this.uploadData(), this._batcher._flush());
        }, s.prototype.forwardIndiceStartToOffset = function() {
            this.uploadData(), this.switchBuffer();
        }), cc.MeshBuffer = e.exports = s;
    }, {
        "../../../renderer/gfx": 298
    } ],
    242: [ function(t, e) {
        "use strict";
        var i = s(t("../../../renderer/core/input-assembler")), n = s(t("../../../renderer/memop/recycle-pool")), r = s(t("../../../renderer/scene/model"));
        function s(t) {
            return t && t.__esModule ? t : {
                default: t
            };
        }
        var o = t("./vertex-format"), a = o.vfmtPosUvColor, c = o.vfmt3D, l = t("./quad-buffer"), u = t("./mesh-buffer"), h = t("./spine-buffer"), _ = t("../../assets/material/CCMaterial"), f = (new (t("../../platform/id-generater"))("VertextFormat"), 
        {}), d = new _(), p = new i.default();
        p._count = 0;
        var m = function(t, e) {
            this._renderScene = e, this._device = t, this.walking = !1, this.material = d, this.cullingMask = 1, 
            this._iaPool = new n.default(function() {
                return new i.default();
            }, 16), this._modelPool = new n.default(function() {
                return new r.default();
            }, 16), this._quadBuffer = this.getBuffer("quad", a), this._meshBuffer = this.getBuffer("mesh", a), 
            this._quadBuffer3D = this.getBuffer("quad", c), this._meshBuffer3D = this.getBuffer("mesh", c), 
            this._buffer = this._meshBuffer, this._batchedModels = [], this._dummyNode = new cc.Node(), 
            this._sortKey = 0, this.node = this._dummyNode, this.parentOpacity = 1, this.parentOpacityDirty = 0, 
            this.worldMatDirty = 0;
        };
        m.prototype = {
            constructor: m,
            reset: function() {
                this._iaPool.reset();
                for (var t = this._renderScene, e = this._batchedModels, i = 0; i < e.length; ++i) e[i].setInputAssembler(null), 
                e[i].setEffect(null), t.removeModel(e[i]);
                for (var n in this._modelPool.reset(), e.length = 0, this._sortKey = 0, f) f[n].reset();
                this._buffer = this._meshBuffer, this.node = this._dummyNode, this.material = d, 
                this.cullingMask = 1, this.parentOpacity = 1, this.parentOpacityDirty = 0, this.worldMatDirty = 0;
            },
            _flushMaterial: function(t) {
                if (t) {
                    this.material = t;
                    var e = t.effect;
                    if (e) {
                        var i = this._modelPool.add();
                        this._batchedModels.push(i), i.sortKey = this._sortKey++, i._cullingMask = this.cullingMask, 
                        i.setNode(this.node), i.setEffect(e, null), i.setInputAssembler(p), this._renderScene.addModel(i);
                    }
                }
            },
            _flush: function() {
                var t = this.material, e = this._buffer, i = e.indiceOffset - e.indiceStart;
                if (this.walking && t && !(i <= 0)) {
                    var n = t.effect;
                    if (n) {
                        var r = this._iaPool.add();
                        r._vertexBuffer = e._vb, r._indexBuffer = e._ib, r._start = e.indiceStart, r._count = i;
                        var s = this._modelPool.add();
                        this._batchedModels.push(s), s.sortKey = this._sortKey++, s._cullingMask = this.cullingMask, 
                        s.setNode(this.node), s.setEffect(n), s.setInputAssembler(r), this._renderScene.addModel(s), 
                        e.forwardIndiceStartToOffset();
                    }
                }
            },
            _flushIA: function(t) {
                if (t) {
                    var e = this.material.effect;
                    if (e) {
                        var i = this._modelPool.add();
                        this._batchedModels.push(i), i.sortKey = this._sortKey++, i._cullingMask = this.cullingMask, 
                        i.setNode(this.node), i.setEffect(e), i.setInputAssembler(t), this._renderScene.addModel(i);
                    }
                }
            },
            terminate: function() {
                for (var t in cc.dynamicAtlasManager && cc.dynamicAtlasManager.enabled && cc.dynamicAtlasManager.update(), 
                this._flush(), f) f[t].uploadData();
                this.walking = !1;
            },
            getBuffer: function(t, e) {
                var i = t + e.getHash(), n = f[i];
                if (!n) {
                    if ("mesh" === t) n = new u(this, e); else if ("quad" === t) n = new l(this, e); else {
                        if ("spine" !== t) return cc.error("Not support buffer type [" + t + "]"), null;
                        n = new h(this, e);
                    }
                    f[i] = n;
                }
                return n;
            }
        }, e.exports = m;
    }, {
        "../../../renderer/core/input-assembler": 288,
        "../../../renderer/memop/recycle-pool": 313,
        "../../../renderer/scene/model": 319,
        "../../assets/material/CCMaterial": 76,
        "../../platform/id-generater": 199,
        "./mesh-buffer": 241,
        "./quad-buffer": 243,
        "./spine-buffer": 245,
        "./vertex-format": 246
    } ],
    243: [ function(t, e) {
        "use strict";
        var i = t("./mesh-buffer"), n = cc.Class({
            name: "cc.QuadBuffer",
            extends: i,
            _fillQuadBuffer: function() {
                for (var t = this._initIDataCount / 6, e = this._iData, i = 0, n = 0; i < t; i++) {
                    var r = 4 * i;
                    e[n++] = r, e[n++] = r + 1, e[n++] = r + 2, e[n++] = r + 1, e[n++] = r + 3, e[n++] = r + 2;
                }
                var s = new Uint16Array(this._iData.buffer, 0, 6 * t);
                this._ib.update(0, s);
            },
            uploadData: function() {
                if (0 !== this.byteOffset && this._dirty) {
                    var t = new Float32Array(this._vData.buffer, 0, this.byteOffset >> 2);
                    this._vb.update(0, t), this._dirty = !1;
                }
            },
            switchBuffer: function() {
                this._super();
                var t = new Uint16Array(this._iData.buffer, 0, this._initIDataCount);
                this._ib.update(0, t);
            },
            _reallocBuffer: function() {
                this._reallocVData(!0), this._reallocIData(), this._fillQuadBuffer();
            }
        });
        cc.QuadBuffer = e.exports = n;
    }, {
        "./mesh-buffer": 241
    } ],
    244: [ function(t, e, i) {
        "use strict";
        i.__esModule = !0, i.default = o;
        var n, r = (n = t("./flex-buffer")) && n.__esModule ? n : {
            default: n
        }, s = t("./vertex-format");
        function o() {
            this.vDatas = [], this.uintVDatas = [], this.iDatas = [], this.meshCount = 0, this._infos = null, 
            this._flexBuffer = null;
        }
        cc.js.mixin(o.prototype, {
            init: function() {},
            clear: function() {
                this.vDatas.length = 0, this.iDatas.length = 0, this.uintVDatas.length = 0, this.meshCount = 0, 
                this._infos = null, this._flexBuffer && this._flexBuffer.reset();
            },
            updateMesh: function(t, e, i) {
                this.vDatas[t] = e, this.uintVDatas[t] = new Uint32Array(e.buffer, 0, e.length), 
                this.iDatas[t] = i, this.meshCount = this.vDatas.length;
            },
            updateMeshRange: function() {},
            createData: function(t, e, i) {
                var n = new Float32Array(e), r = new Uint16Array(i);
                this.updateMesh(t, n, r);
            },
            createQuadData: function(t, e, i) {
                this.createData(t, e, i), this.initQuadIndices(this.iDatas[t]);
            },
            createFlexData: function(t, e, i, n) {
                n = n || s.vfmtPosUvColor, this._flexBuffer = new r.default(this, t, e, i, n);
            },
            initQuadIndices: function(t) {
                for (var e = t.length / 6, i = 0, n = 0; i < e; i++) {
                    var r = 4 * i;
                    t[n++] = r, t[n++] = r + 1, t[n++] = r + 2, t[n++] = r + 1, t[n++] = r + 3, t[n++] = r + 2;
                }
            }
        }), cc.RenderData = o, e.exports = i.default;
    }, {
        "./flex-buffer": 240,
        "./vertex-format": 246
    } ],
    245: [ function(t, e) {
        "use strict";
        var i = cc.Class({
            name: "cc.SpineBuffer",
            extends: t("./mesh-buffer"),
            requestStatic: function(t, e) {
                this.checkAndSwitchBuffer(t);
                var i = this.byteOffset + t * this._vertexBytes, n = this.indiceOffset + e, r = this._vData.byteLength, s = this._iData.length;
                if (i > r || n > s) {
                    for (;r < i || s < n; ) this._initVDataCount *= 2, this._initIDataCount *= 2, r = 4 * this._initVDataCount, 
                    s = this._initIDataCount;
                    this._reallocBuffer();
                }
                var o = this._offsetInfo;
                o.vertexOffset = this.vertexOffset, o.indiceOffset = this.indiceOffset, o.byteOffset = this.byteOffset;
            },
            adjust: function(t, e) {
                this.vertexOffset += t, this.indiceOffset += e, this.byteOffset = this.byteOffset + t * this._vertexBytes, 
                this._dirty = !0;
            }
        });
        cc.SpineBuffer = e.exports = i;
    }, {
        "./mesh-buffer": 241
    } ],
    246: [ function(t, e) {
        "use strict";
        var i, n = (i = t("../../../renderer/gfx")) && i.__esModule ? i : {
            default: i
        }, r = new n.default.VertexFormat([ {
            name: n.default.ATTR_POSITION,
            type: n.default.ATTR_TYPE_FLOAT32,
            num: 3
        }, {
            name: n.default.ATTR_UV0,
            type: n.default.ATTR_TYPE_FLOAT32,
            num: 2
        }, {
            name: n.default.ATTR_COLOR,
            type: n.default.ATTR_TYPE_UINT8,
            num: 4,
            normalize: !0
        } ]);
        r.name = "vfmt3D", n.default.VertexFormat.XYZ_UV_Color = r;
        var s = new n.default.VertexFormat([ {
            name: n.default.ATTR_POSITION,
            type: n.default.ATTR_TYPE_FLOAT32,
            num: 2
        }, {
            name: n.default.ATTR_UV0,
            type: n.default.ATTR_TYPE_FLOAT32,
            num: 2
        }, {
            name: n.default.ATTR_COLOR,
            type: n.default.ATTR_TYPE_UINT8,
            num: 4,
            normalize: !0
        } ]);
        s.name = "vfmtPosUvColor", n.default.VertexFormat.XY_UV_Color = s;
        var o = new n.default.VertexFormat([ {
            name: n.default.ATTR_POSITION,
            type: n.default.ATTR_TYPE_FLOAT32,
            num: 2
        }, {
            name: n.default.ATTR_UV0,
            type: n.default.ATTR_TYPE_FLOAT32,
            num: 2
        }, {
            name: n.default.ATTR_COLOR,
            type: n.default.ATTR_TYPE_UINT8,
            num: 4,
            normalize: !0
        }, {
            name: n.default.ATTR_COLOR0,
            type: n.default.ATTR_TYPE_UINT8,
            num: 4,
            normalize: !0
        } ]);
        o.name = "vfmtPosUvTwoColor", n.default.VertexFormat.XY_UV_Two_Color = o;
        var a = new n.default.VertexFormat([ {
            name: n.default.ATTR_POSITION,
            type: n.default.ATTR_TYPE_FLOAT32,
            num: 2
        }, {
            name: n.default.ATTR_UV0,
            type: n.default.ATTR_TYPE_FLOAT32,
            num: 2
        } ]);
        a.name = "vfmtPosUv", n.default.VertexFormat.XY_UV = a;
        var c = new n.default.VertexFormat([ {
            name: n.default.ATTR_POSITION,
            type: n.default.ATTR_TYPE_FLOAT32,
            num: 2
        }, {
            name: n.default.ATTR_COLOR,
            type: n.default.ATTR_TYPE_UINT8,
            num: 4,
            normalize: !0
        } ]);
        c.name = "vfmtPosColor", n.default.VertexFormat.XY_Color = c;
        var l = new n.default.VertexFormat([ {
            name: n.default.ATTR_POSITION,
            type: n.default.ATTR_TYPE_FLOAT32,
            num: 2
        } ]);
        l.name = "vfmtPos", n.default.VertexFormat.XY = l, e.exports = {
            vfmt3D: r,
            vfmtPosUvColor: s,
            vfmtPosUvTwoColor: o,
            vfmtPosUv: a,
            vfmtPosColor: c,
            vfmtPos: l
        };
    }, {
        "../../../renderer/gfx": 298
    } ],
    247: [ function(t, e) {
        "use strict";
        t("../platform/CCSys");
        var i = /(\.[^\.\/\?\\]*)(\?.*)?$/, n = /((.*)(\/|\\|\\\\))?(.*?\..*$)?/, r = /[^\.\/]+\/\.\.\//;
        cc.path = {
            join: function() {
                for (var t = arguments.length, e = "", i = 0; i < t; i++) e = (e + ("" === e ? "" : "/") + arguments[i]).replace(/(\/|\\\\)$/, "");
                return e;
            },
            extname: function(t) {
                var e = i.exec(t);
                return e ? e[1] : "";
            },
            mainFileName: function(t) {
                if (t) {
                    var e = t.lastIndexOf(".");
                    if (-1 !== e) return t.substring(0, e);
                }
                return t;
            },
            basename: function(t, e) {
                var i = t.indexOf("?");
                i > 0 && (t = t.substring(0, i));
                var n = /(\/|\\)([^\/\\]+)$/g.exec(t.replace(/(\/|\\)$/, ""));
                if (!n) return t;
                var r = n[2];
                return e && t.substring(t.length - e.length).toLowerCase() === e.toLowerCase() ? r.substring(0, r.length - e.length) : r;
            },
            dirname: function(t) {
                var e = n.exec(t);
                return e ? e[2] : "";
            },
            changeExtname: function(t, e) {
                e = e || "";
                var i = t.indexOf("?"), n = "";
                return i > 0 && (n = t.substring(i), t = t.substring(0, i)), (i = t.lastIndexOf(".")) < 0 ? t + e + n : t.substring(0, i) + e + n;
            },
            changeBasename: function(t, e, i) {
                if (0 === e.indexOf(".")) return this.changeExtname(t, e);
                var n = t.indexOf("?"), r = "", s = i ? this.extname(t) : "";
                return n > 0 && (r = t.substring(n), t = t.substring(0, n)), n = (n = t.lastIndexOf("/")) <= 0 ? 0 : n + 1, 
                t.substring(0, n) + e + s + r;
            },
            _normalize: function(t) {
                var e = t = String(t);
                do {
                    e = t, t = t.replace(r, "");
                } while (e.length !== t.length);
                return t;
            },
            sep: cc.sys.os === cc.sys.OS_WINDOWS ? "\\" : "/",
            stripSep: function(t) {
                return t.replace(/[\/\\]$/, "");
            }
        }, e.exports = cc.path;
    }, {
        "../platform/CCSys": 191
    } ],
    248: [ function(t, e) {
        "use strict";
        var i = function(t, e, i, n, r, s) {
            this.a = t, this.b = e, this.c = i, this.d = n, this.tx = r, this.ty = s;
        };
        i.create = function(t, e, i, n, r, s) {
            return {
                a: t,
                b: e,
                c: i,
                d: n,
                tx: r,
                ty: s
            };
        }, i.identity = function() {
            return {
                a: 1,
                b: 0,
                c: 0,
                d: 1,
                tx: 0,
                ty: 0
            };
        }, i.clone = function(t) {
            return {
                a: t.a,
                b: t.b,
                c: t.c,
                d: t.d,
                tx: t.tx,
                ty: t.ty
            };
        }, i.concat = function(t, e, i) {
            var n = e.a, r = e.b, s = e.c, o = e.d, a = e.tx, c = e.ty;
            return t.a = n * i.a + r * i.c, t.b = n * i.b + r * i.d, t.c = s * i.a + o * i.c, 
            t.d = s * i.b + o * i.d, t.tx = a * i.a + c * i.c + i.tx, t.ty = a * i.b + c * i.d + i.ty, 
            t;
        }, i.invert = function(t, e) {
            var i = e.a, n = e.b, r = e.c, s = e.d, o = 1 / (i * s - n * r), a = e.tx, c = e.ty;
            return t.a = o * s, t.b = -o * n, t.c = -o * r, t.d = o * i, t.tx = o * (r * c - s * a), 
            t.ty = o * (n * a - i * c), t;
        }, i.fromMat4 = function(t, e) {
            var i = e.m;
            return t.a = i[0], t.b = i[1], t.c = i[4], t.d = i[5], t.tx = i[12], t.ty = i[13], 
            t;
        }, i.transformVec2 = function(t, e, i, n) {
            var r, s;
            return void 0 === n ? (n = i, r = e.x, s = e.y) : (r = e, s = i), t.x = n.a * r + n.c * s + n.tx, 
            t.y = n.b * r + n.d * s + n.ty, t;
        }, i.transformSize = function(t, e, i) {
            return t.width = i.a * e.width + i.c * e.height, t.height = i.b * e.width + i.d * e.height, 
            t;
        }, i.transformRect = function(t, e, i) {
            var n = e.x, r = e.y, s = n + e.width, o = r + e.height, a = i.a * n + i.c * r + i.tx, c = i.b * n + i.d * r + i.ty, l = i.a * s + i.c * r + i.tx, u = i.b * s + i.d * r + i.ty, h = i.a * n + i.c * o + i.tx, _ = i.b * n + i.d * o + i.ty, f = i.a * s + i.c * o + i.tx, d = i.b * s + i.d * o + i.ty, p = Math.min(a, l, h, f), m = Math.max(a, l, h, f), v = Math.min(c, u, _, d), y = Math.max(c, u, _, d);
            return t.x = p, t.y = v, t.width = m - p, t.height = y - v, t;
        }, i.transformObb = function(t, e, i, n, r, s) {
            var o = r.x, a = r.y, c = r.width, l = r.height, u = s.a * o + s.c * a + s.tx, h = s.b * o + s.d * a + s.ty, _ = s.a * c, f = s.b * c, d = s.c * l, p = s.d * l;
            e.x = u, e.y = h, i.x = _ + u, i.y = f + h, t.x = d + u, t.y = p + h, n.x = _ + d + u, 
            n.y = f + p + h;
        }, cc.AffineTransform = e.exports = i;
    }, {} ],
    249: [ function(t, e) {
        "use strict";
        var i = t("../platform/CCObject").Flags, n = t("./misc"), r = t("../platform/js"), s = t("../platform/id-generater"), o = t("../event-manager"), a = t("../renderer/render-flow"), c = i.Destroying, l = i.DontDestroy, u = i.Deactivating, h = new s("Node");
        function _(t) {
            return t ? "string" == typeof t ? r.getClassByName(t) : t : (cc.errorID(3804), null);
        }
        function f(t, e) {
            if (e._sealed) for (var i = 0; i < t._components.length; ++i) {
                var n = t._components[i];
                if (n.constructor === e) return n;
            } else for (var r = 0; r < t._components.length; ++r) {
                var s = t._components[r];
                if (s instanceof e) return s;
            }
            return null;
        }
        function d(t, e, i) {
            if (e._sealed) for (var n = 0; n < t._components.length; ++n) {
                var r = t._components[n];
                r.constructor === e && i.push(r);
            } else for (var s = 0; s < t._components.length; ++s) {
                var o = t._components[s];
                o instanceof e && i.push(o);
            }
        }
        function p(t, e) {
            for (var i = 0; i < t.length; ++i) {
                var n = t[i], r = f(n, e);
                if (r) return r;
                if (n._children.length > 0 && (r = p(n._children, e))) return r;
            }
            return null;
        }
        function m(t, e, i) {
            for (var n = 0; n < t.length; ++n) {
                var r = t[n];
                d(r, e, i), r._children.length > 0 && m(r._children, e, i);
            }
        }
        var v = cc.Class({
            name: "cc._BaseNode",
            extends: cc.Object,
            properties: {
                _parent: null,
                _children: [],
                _active: !0,
                _components: [],
                _prefab: null,
                _persistNode: {
                    get: function() {
                        return (this._objFlags & l) > 0;
                    },
                    set: function(t) {
                        t ? this._objFlags |= l : this._objFlags &= ~l;
                    }
                },
                name: {
                    get: function() {
                        return this._name;
                    },
                    set: function(t) {
                        this._name = t;
                    }
                },
                uuid: {
                    get: function() {
                        return this._id;
                    }
                },
                children: {
                    get: function() {
                        return this._children;
                    }
                },
                childrenCount: {
                    get: function() {
                        return this._children.length;
                    }
                },
                active: {
                    get: function() {
                        return this._active;
                    },
                    set: function(t) {
                        if (t = !!t, this._active !== t) {
                            this._active = t;
                            var e = this._parent;
                            e && e._activeInHierarchy && cc.director._nodeActivator.activateNode(this, t);
                        }
                    }
                },
                activeInHierarchy: {
                    get: function() {
                        return this._activeInHierarchy;
                    }
                }
            },
            ctor: function(t) {
                this._name = void 0 !== t ? t : "New Node", this._activeInHierarchy = !1, this._id = h.getNewId(), 
                cc.director._scheduler && cc.director._scheduler.enableForTarget(this), this.__eventTargets = [];
            },
            getParent: function() {
                return this._parent;
            },
            setParent: function(t) {
                if (this._parent !== t) {
                    var e = this._parent;
                    if (this._parent = t || null, this._onSetParent(t), t && (o._setDirtyForNode(this), 
                    t._children.push(this), t.emit && t.emit("child-added", this), t._renderFlag |= a.FLAG_CHILDREN), 
                    e) {
                        if (!(e._objFlags & c)) {
                            var i = e._children.indexOf(this);
                            e._children.splice(i, 1), e.emit && e.emit("child-removed", this), this._onHierarchyChanged(e), 
                            0 === e._children.length && (e._renderFlag &= ~a.FLAG_CHILDREN);
                        }
                    } else t && this._onHierarchyChanged(null);
                }
            },
            attr: function(t) {
                r.mixin(this, t);
            },
            getChildByUuid: function(t) {
                if (!t) return cc.log("Invalid uuid"), null;
                for (var e = this._children, i = 0, n = e.length; i < n; i++) if (e[i]._id === t) return e[i];
                return null;
            },
            getChildByName: function(t) {
                if (!t) return cc.log("Invalid name"), null;
                for (var e = this._children, i = 0, n = e.length; i < n; i++) if (e[i]._name === t) return e[i];
                return null;
            },
            addChild: function(t) {
                cc.assertID(t, 1606), cc.assertID(null === t._parent, 1605), t.setParent(this);
            },
            insertChild: function(t, e) {
                t.parent = this, t.setSiblingIndex(e);
            },
            getSiblingIndex: function() {
                return this._parent ? this._parent._children.indexOf(this) : 0;
            },
            setSiblingIndex: function(t) {
                if (this._parent) if (this._parent._objFlags & u) cc.errorID(3821); else {
                    var e = this._parent._children;
                    t = -1 !== t ? t : e.length - 1;
                    var i = e.indexOf(this);
                    t !== i && (e.splice(i, 1), t < e.length ? e.splice(t, 0, this) : e.push(this), 
                    this._onSiblingIndexChanged && this._onSiblingIndexChanged(t));
                }
            },
            walk: function(t, e) {
                var i, n, r, s, o = cc._BaseNode, a = 1, c = o._stacks[o._stackId];
                c || (c = [], o._stacks.push(c)), o._stackId++, c.length = 0, c[0] = this;
                var l = null;
                for (s = !1; a; ) if (n = c[--a]) if (!s && t ? t(n) : s && e && e(n), c[a] = null, 
                s) {
                    if (l === this._parent) break;
                    if (s = !1, i) if (i[++r]) c[a] = i[r], a++; else if (l && (c[a] = l, a++, s = !0, 
                    l._parent ? (r = (i = l._parent._children).indexOf(l), l = l._parent) : (l = null, 
                    i = null), r < 0)) break;
                } else n._children.length > 0 ? (l = n, i = n._children, r = 0, c[a] = i[r], a++) : (c[a] = n, 
                a++, s = !0);
                c.length = 0, o._stackId--;
            },
            cleanup: function() {},
            removeFromParent: function(t) {
                this._parent && (void 0 === t && (t = !0), this._parent.removeChild(this, t));
            },
            removeChild: function(t, e) {
                this._children.indexOf(t) > -1 && ((e || void 0 === e) && t.cleanup(), t.parent = null);
            },
            removeAllChildren: function(t) {
                var e = this._children;
                void 0 === t && (t = !0);
                for (var i = e.length - 1; i >= 0; i--) {
                    var n = e[i];
                    n && (t && n.cleanup(), n.parent = null);
                }
                this._children.length = 0;
            },
            isChildOf: function(t) {
                var e = this;
                do {
                    if (e === t) return !0;
                    e = e._parent;
                } while (e);
                return !1;
            },
            getComponent: function(t) {
                var e = _(t);
                return e ? f(this, e) : null;
            },
            getComponents: function(t) {
                var e = _(t), i = [];
                return e && d(this, e, i), i;
            },
            getComponentInChildren: function(t) {
                var e = _(t);
                return e ? p(this._children, e) : null;
            },
            getComponentsInChildren: function(t) {
                var e = _(t), i = [];
                return e && (d(this, e, i), m(this._children, e, i)), i;
            },
            _checkMultipleComp: !1,
            addComponent: function(t) {
                var e;
                if ("string" == typeof t) {
                    if (!(e = r.getClassByName(t))) return cc.errorID(3807, t), cc._RFpeek() && cc.errorID(3808, t), 
                    null;
                } else {
                    if (!t) return cc.errorID(3804), null;
                    e = t;
                }
                if ("function" != typeof e) return cc.errorID(3809), null;
                if (!r.isChildClassOf(e, cc.Component)) return cc.errorID(3810), null;
                var i = e._requireComponent;
                if (i && !this.getComponent(i) && !this.addComponent(i)) return null;
                var n = new e();
                return n.node = this, this._components.push(n), this._activeInHierarchy && cc.director._nodeActivator.activateComp(n), 
                n;
            },
            _addComponentAt: !1,
            removeComponent: function(t) {
                t ? (t instanceof cc.Component || (t = this.getComponent(t)), t && t.destroy()) : cc.errorID(3813);
            },
            _getDependComponent: !1,
            _removeComponent: function(t) {
                if (t) {
                    if (!(this._objFlags & c)) {
                        var e = this._components.indexOf(t);
                        -1 !== e ? this._components.splice(e, 1) : t.node !== this && cc.errorID(3815);
                    }
                } else cc.errorID(3814);
            },
            destroy: function() {
                cc.Object.prototype.destroy.call(this) && (this.active = !1);
            },
            destroyAllChildren: function() {
                for (var t = this._children, e = 0; e < t.length; ++e) t[e].destroy();
            },
            _onSetParent: function() {},
            _onPostActivated: function() {},
            _onBatchCreated: function() {},
            _onHierarchyChanged: function() {
                var t = this._parent;
                !this._persistNode || t instanceof cc.Scene || cc.game.removePersistRootNode(this);
                var e = this._active && !(!t || !t._activeInHierarchy);
                this._activeInHierarchy !== e && cc.director._nodeActivator.activateNode(this, e);
            },
            _instantiate: function(t, e) {
                return t || (t = cc.instantiate._clone(this, this)), t._prefab, t._parent = null, 
                t._onBatchCreated(e), t;
            },
            _registerIfAttached: !1,
            _onPreDestroy: function() {
                var t, e;
                this._objFlags |= c;
                var i = this._parent, n = i && i._objFlags & c, r = this._children;
                for (t = 0, e = r.length; t < e; ++t) r[t]._destroyImmediate();
                for (t = 0, e = this._components.length; t < e; ++t) this._components[t]._destroyImmediate();
                var s = this.__eventTargets;
                for (t = 0, e = s.length; t < e; ++t) {
                    var o = s[t];
                    o && o.targetOff(this);
                }
                if (s.length = 0, this._persistNode && cc.game.removePersistRootNode(this), !n && i) {
                    var a = i._children.indexOf(this);
                    i._children.splice(a, 1), i.emit && i.emit("child-removed", this);
                }
                return n;
            },
            onRestore: !1
        });
        v.idGenerater = h, v._stacks = [ [] ], v._stackId = 0, v.prototype._onPreDestroyBase = v.prototype._onPreDestroy, 
        v.prototype._onHierarchyChangedBase = v.prototype._onHierarchyChanged, n.propertyDefine(v, [ "parent", "name", "children", "childrenCount" ], {}), 
        cc._BaseNode = e.exports = v;
    }, {
        "../event-manager": 127,
        "../platform/CCObject": 188,
        "../platform/id-generater": 199,
        "../platform/js": 203,
        "../renderer/render-flow": 214,
        "./misc": 256
    } ],
    250: [ function(t, e) {
        "use strict";
        e.exports = {
            binarySearchEpsilon: function(t, e) {
                for (var i = 0, n = t.length - 1, r = n >>> 1; i <= n; r = i + n >>> 1) {
                    var s = t[r];
                    if (s > e + 1e-6) n = r - 1; else {
                        if (!(s < e - 1e-6)) return r;
                        i = r + 1;
                    }
                }
                return ~i;
            }
        };
    }, {} ],
    251: [ function(t, e) {
        "use strict";
        var i = t("../components/CCRenderComponent"), n = t("../platform/CCMacro").BlendFactor, r = t("../../renderer/gfx"), s = cc.Class({
            properties: {
                _srcBlendFactor: n.SRC_ALPHA,
                _dstBlendFactor: n.ONE_MINUS_SRC_ALPHA,
                srcBlendFactor: {
                    get: function() {
                        return this._srcBlendFactor;
                    },
                    set: function(t) {
                        this._srcBlendFactor !== t && (this._srcBlendFactor = t, this._updateBlendFunc(!0), 
                        this._onBlendChanged && this._onBlendChanged());
                    },
                    animatable: !1,
                    type: n,
                    tooltip: !1,
                    visible: !0
                },
                dstBlendFactor: {
                    get: function() {
                        return this._dstBlendFactor;
                    },
                    set: function(t) {
                        this._dstBlendFactor !== t && (this._dstBlendFactor = t, this._updateBlendFunc(!0));
                    },
                    animatable: !1,
                    type: n,
                    tooltip: !1,
                    visible: !0
                }
            },
            setMaterial: function(t, e) {
                var r = i.prototype.setMaterial.call(this, t, e);
                return this._srcBlendFactor === n.SRC_ALPHA && this._dstBlendFactor === n.ONE_MINUS_SRC_ALPHA || this._updateMaterialBlendFunc(r), 
                r;
            },
            _updateMaterial: function() {
                this._updateBlendFunc();
            },
            _updateBlendFunc: function(t) {
                if (t || this._srcBlendFactor !== n.SRC_ALPHA || this._dstBlendFactor !== n.ONE_MINUS_SRC_ALPHA) for (var e = this.getMaterials(), i = 0; i < e.length; i++) {
                    var r = e[i];
                    this._updateMaterialBlendFunc(r);
                }
            },
            _updateMaterialBlendFunc: function(t) {
                t.setBlend(!0, r.BLEND_FUNC_ADD, this._srcBlendFactor, this._dstBlendFactor, r.BLEND_FUNC_ADD, this._srcBlendFactor, this._dstBlendFactor);
            }
        });
        e.exports = cc.BlendFunc = s;
    }, {
        "../../renderer/gfx": 298,
        "../components/CCRenderComponent": 110,
        "../platform/CCMacro": 187
    } ],
    252: [ function(t, e) {
        "use strict";
        var i = t("./misc").BASE64_VALUES, n = "0123456789abcdef".split(""), r = [ "", "", "", "" ], s = r.concat(r, "-", r, "-", r, "-", r, "-", r, r, r), o = s.map(function(t, e) {
            return "-" === t ? NaN : e;
        }).filter(isFinite);
        e.exports = function(t) {
            if (22 !== t.length) return t;
            s[0] = t[0], s[1] = t[1];
            for (var e = 2, r = 2; e < 22; e += 2) {
                var a = i[t.charCodeAt(e)], c = i[t.charCodeAt(e + 1)];
                s[o[r++]] = n[a >> 2], s[o[r++]] = n[(3 & a) << 2 | c >> 4], s[o[r++]] = n[15 & c];
            }
            return s.join("");
        };
    }, {
        "./misc": 256
    } ],
    253: [ function(t, e) {
        "use strict";
        cc.find = e.exports = function(t, e) {
            if (null == t) return cc.errorID(3814), null;
            if (e) ; else {
                var i = cc.director.getScene();
                if (!i) return null;
                e = i;
            }
            for (var n = e, r = "/" !== t[0] ? 0 : 1, s = t.split("/"), o = r; o < s.length; o++) {
                var a = s[o], c = n._children;
                n = null;
                for (var l = 0, u = c.length; l < u; ++l) {
                    var h = c[l];
                    if (h.name === a) {
                        n = h;
                        break;
                    }
                }
                if (!n) return null;
            }
            return n;
        };
    }, {} ],
    254: [ function(t, e) {
        "use strict";
        var i, n = (i = t("../assets/material/material-variant")) && i.__esModule ? i : {
            default: i
        }, r = t("../assets/material/CCMaterial"), s = cc.Class({
            properties: {
                _normalMaterial: null,
                normalMaterial: {
                    get: function() {
                        return this._normalMaterial;
                    },
                    set: function(t) {
                        this._normalMaterial = t, this._updateDisabledState && this._updateDisabledState();
                    },
                    type: r,
                    tooltip: !1,
                    animatable: !1
                },
                _grayMaterial: null,
                grayMaterial: {
                    get: function() {
                        return this._grayMaterial;
                    },
                    set: function(t) {
                        this._grayMaterial = t, this._updateDisabledState && this._updateDisabledState();
                    },
                    type: r,
                    tooltip: !1,
                    animatable: !1
                }
            },
            _switchGrayMaterial: function(t, e) {
                var i;
                t ? ((i = this._grayMaterial) || (i = r.getBuiltinMaterial("2d-gray-sprite")), i = this._grayMaterial = n.default.create(i, e)) : ((i = this._normalMaterial) || (i = r.getBuiltinMaterial("2d-sprite", e)), 
                i = this._normalMaterial = n.default.create(i, e)), e.setMaterial(0, i);
            }
        });
        e.exports = s;
    }, {
        "../assets/material/CCMaterial": 76,
        "../assets/material/material-variant": 83
    } ],
    255: [ function(t) {
        "use strict";
        t("./CCPath"), t("./profiler/CCProfiler"), t("./find"), t("./mutable-forward-iterator");
    }, {
        "./CCPath": 247,
        "./find": 253,
        "./mutable-forward-iterator": 257,
        "./profiler/CCProfiler": 260
    } ],
    256: [ function(t, e) {
        "use strict";
        for (var i = t("../platform/js"), n = {
            propertyDefine: function(t, e, n) {
                function r(t, e, n, r) {
                    var s = Object.getOwnPropertyDescriptor(t, e);
                    if (s) s.get && (t[n] = s.get), s.set && r && (t[r] = s.set); else {
                        var o = t[n];
                        i.getset(t, e, o, t[r]);
                    }
                }
                for (var s, o = t.prototype, a = 0; a < e.length; a++) {
                    var c = (s = e[a])[0].toUpperCase() + s.slice(1);
                    r(o, s, "get" + c, "set" + c);
                }
                for (s in n) {
                    var l = n[s];
                    r(o, s, l[0], l[1]);
                }
            },
            NextPOT: function(t) {
                return t -= 1, t |= t >> 1, t |= t >> 2, t |= t >> 4, t |= t >> 8, 1 + (t |= t >> 16);
            },
            BUILTIN_CLASSID_RE: /^(?:cc|dragonBones|sp|ccsg)\..+/
        }, r = new Array(123), s = 0; s < 123; ++s) r[s] = 64;
        for (var o = 0; o < 64; ++o) r["ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charCodeAt(o)] = o;
        n.BASE64_VALUES = r, n.pushToMap = function(t, e, i, n) {
            var r = t[e];
            r ? Array.isArray(r) ? n ? (r.push(r[0]), r[0] = i) : r.push(i) : t[e] = n ? [ i, r ] : [ r, i ] : t[e] = i;
        }, n.clampf = function(t, e, i) {
            if (e > i) {
                var n = e;
                e = i, i = n;
            }
            return t < e ? e : t < i ? t : i;
        }, n.clamp01 = function(t) {
            return t < 0 ? 0 : t < 1 ? t : 1;
        }, n.lerp = function(t, e, i) {
            return t + (e - t) * i;
        }, n.degreesToRadians = function(t) {
            return t * cc.macro.RAD;
        }, n.radiansToDegrees = function(t) {
            return t * cc.macro.DEG;
        }, cc.misc = e.exports = n;
    }, {
        "../platform/js": 203
    } ],
    257: [ function(t, e) {
        "use strict";
        function i(t) {
            this.i = 0, this.array = t;
        }
        var n = i.prototype;
        n.remove = function(t) {
            var e = this.array.indexOf(t);
            e >= 0 && this.removeAt(e);
        }, n.removeAt = function(t) {
            this.array.splice(t, 1), t <= this.i && --this.i;
        }, n.fastRemove = function(t) {
            var e = this.array.indexOf(t);
            e >= 0 && this.fastRemoveAt(e);
        }, n.fastRemoveAt = function(t) {
            var e = this.array;
            e[t] = e[e.length - 1], --e.length, t <= this.i && --this.i;
        }, n.push = function(t) {
            this.array.push(t);
        }, e.exports = i;
    }, {} ],
    258: [ function(t, e, i) {
        "use strict";
        i.__esModule = !0, i.default = void 0;
        var n = function() {
            function t() {
                this.enabled = !1, this.count = 0, this.maxSize = 1024;
            }
            var e = t.prototype;
            return e.get = function() {}, e.put = function() {}, e.clear = function() {}, t;
        }();
        i.default = n, cc.pool = {}, n.register = function(t, e) {
            cc.pool[t] = e;
        }, e.exports = i.default;
    }, {} ],
    259: [ function(t, e) {
        "use strict";
        cc._PrefabInfo = cc.Class({
            name: "cc.PrefabInfo",
            properties: {
                root: null,
                asset: null,
                fileId: "",
                sync: !1
            }
        }), e.exports = {
            syncWithPrefab: function(t) {
                var e = t._prefab;
                if (!e.asset) return cc.errorID(3701, t.name), void (t._prefab = null);
                var i = t._objFlags, n = t._parent, r = t._id, s = t._name, o = t._active, a = t._eulerAngles.x, c = t._eulerAngles.y, l = t._eulerAngles.z, u = t._localZOrder, h = t._trs, _ = h[0], f = h[1], d = h[2];
                cc.game._isCloning = !0;
                var p = e.asset.data;
                p._iN$t = t, cc.instantiate._clone(p, p), cc.game._isCloning = !1, t._objFlags = i, 
                t._parent = n, t._id = r, t._prefab = e, t._name = s, t._active = o, t._localZOrder = u, 
                (h = t._trs)[0] = _, h[1] = f, h[2] = d, t._eulerAngles.x = a, t._eulerAngles.y = c, 
                t._eulerAngles.z = l;
            }
        };
    }, {} ],
    260: [ function(t, e) {
        "use strict";
        var i = t("../../platform/CCMacro"), n = t("./perf-counter"), r = !1, s = 15, o = null, a = null, c = null;
        function l() {
            if (!o) {
                o = {
                    frame: {
                        desc: "Frame time (ms)",
                        min: 0,
                        max: 50,
                        average: 500
                    },
                    fps: {
                        desc: "Framerate (FPS)",
                        below: 30,
                        average: 500
                    },
                    draws: {
                        desc: "Draw call"
                    },
                    logic: {
                        desc: "Game Logic (ms)",
                        min: 0,
                        max: 50,
                        average: 500,
                        color: "#080"
                    },
                    render: {
                        desc: "Renderer (ms)",
                        min: 0,
                        max: 50,
                        average: 500,
                        color: "#f90"
                    },
                    mode: {
                        desc: cc.game.renderType === cc.game.RENDER_TYPE_WEBGL ? "WebGL" : "Canvas",
                        min: 1
                    }
                };
                var t = performance.now();
                for (var e in o) o[e]._counter = new n(e, o[e], t);
            }
        }
        function u() {
            if (!a || !a.isValid) {
                (a = new cc.Node("PROFILER-NODE")).x = a.y = 10, a.groupIndex = cc.Node.BuiltinGroupIndex.DEBUG, 
                cc.Camera._setupDebugCamera(), a.zIndex = i.MAX_ZINDEX, cc.game.addPersistRootNode(a);
                var t = new cc.Node("LEFT-PANEL");
                t.anchorX = t.anchorY = 0;
                var e = t.addComponent(cc.Label);
                e.fontSize = s, e.lineHeight = s, t.parent = a;
                var n = new cc.Node("RIGHT-PANEL");
                n.anchorX = 1, n.anchorY = 0, n.x = 200;
                var r = n.addComponent(cc.Label);
                r.horizontalAlign = cc.Label.HorizontalAlign.RIGHT, r.fontSize = s, r.lineHeight = s, 
                n.parent = a, cc.sys.platform !== cc.sys.BAIDU_GAME_SUB && cc.sys.platform !== cc.sys.WECHAT_GAME_SUB && (e.cacheMode = cc.Label.CacheMode.CHAR, 
                r.cacheMode = cc.Label.CacheMode.CHAR), c = {
                    left: e,
                    right: r
                };
            }
        }
        function h() {
            u();
            var t = cc.director._lastUpdate;
            o.frame._counter.start(t), o.logic._counter.start(t);
        }
        function _() {
            var t = performance.now();
            cc.director.isPaused() ? o.frame._counter.start(t) : o.logic._counter.end(t), o.render._counter.start(t);
        }
        function f() {
            var t = performance.now();
            o.render._counter.end(t), o.draws._counter.value = cc.renderer.drawCalls, o.frame._counter.end(t), 
            o.fps._counter.frame(t);
            var e = "", i = "";
            for (var n in o) {
                var r = o[n];
                r._counter.sample(t), e += r.desc + "\n", i += r._counter.human() + "\n";
            }
            c && (c.left.string = e, c.right.string = i);
        }
        cc.profiler = e.exports = {
            isShowingStats: function() {
                return r;
            },
            hideStats: function() {
                r && (a && (a.active = !1), cc.director.off(cc.Director.EVENT_BEFORE_UPDATE, h), 
                cc.director.off(cc.Director.EVENT_AFTER_UPDATE, _), cc.director.off(cc.Director.EVENT_AFTER_DRAW, f), 
                r = !1);
            },
            showStats: function() {
                r || (l(), a && (a.active = !0), cc.director.on(cc.Director.EVENT_BEFORE_UPDATE, h), 
                cc.director.on(cc.Director.EVENT_AFTER_UPDATE, _), cc.director.on(cc.Director.EVENT_AFTER_DRAW, f), 
                r = !0);
            }
        };
    }, {
        "../../platform/CCMacro": 187,
        "./perf-counter": 262
    } ],
    261: [ function(t, e) {
        "use strict";
        var i = cc.Class({
            name: "cc.Counter",
            ctor: function(t, e, i) {
                this._id = t, this._opts = e || {}, this._value = 0, this._total = 0, this._averageValue = 0, 
                this._accumValue = 0, this._accumSamples = 0, this._accumStart = i;
            },
            properties: {
                value: {
                    get: function() {
                        return this._value;
                    },
                    set: function(t) {
                        this._value = t;
                    }
                }
            },
            _average: function(t, e) {
                if (this._opts.average) {
                    this._accumValue += t, ++this._accumSamples;
                    var i = e;
                    i - this._accumStart >= this._opts.average && (this._averageValue = this._accumValue / this._accumSamples, 
                    this._accumValue = 0, this._accumStart = i, this._accumSamples = 0);
                }
            },
            sample: function(t) {
                this._average(this._value, t);
            },
            human: function() {
                var t = this._opts.average ? this._averageValue : this._value;
                return Math.round(100 * t) / 100;
            },
            alarm: function() {
                return this._opts.below && this._value < this._opts.below || this._opts.over && this._value > this._opts.over;
            }
        });
        e.exports = i;
    }, {} ],
    262: [ function(t, e) {
        "use strict";
        var i = t("./counter"), n = cc.Class({
            name: "cc.PerfCounter",
            extends: i,
            ctor: function(t, e, i) {
                this._time = i;
            },
            start: function(t) {
                this._time = t;
            },
            end: function(t) {
                this._value = t - this._time, this._average(this._value);
            },
            tick: function() {
                this.end(), this.start();
            },
            frame: function(t) {
                var e = t, i = e - this._time;
                this._total++, i > (this._opts.average || 1e3) && (this._value = 1e3 * this._total / i, 
                this._total = 0, this._time = e, this._average(this._value));
            }
        });
        e.exports = n;
    }, {
        "./counter": 261
    } ],
    263: [ function(t, e) {
        "use strict";
        var i, n = new (((i = t("../platform/js")) && i.__esModule ? i : {
            default: i
        }).default.Pool)(2);
        function r(t) {
            this.count = 0, this.limit = t, this.datas = {}, this.head = null, this.tail = null;
        }
        n.get = function() {
            return this._get() || {
                key: null,
                value: null,
                prev: null,
                next: null
            };
        }, r.prototype.moveToHead = function(t) {
            t.next = this.head, t.prev = null, null !== this.head && (this.head.prev = t), this.head = t, 
            null === this.tail && (this.tail = t), this.count++, this.datas[t.key] = t;
        }, r.prototype.put = function(t, e) {
            var i = n.get();
            if (i.key = t, i.value = e, this.count >= this.limit) {
                var r = this.tail;
                delete this.datas[r.key], this.count--, this.tail = r.prev, this.tail.next = null, 
                r.prev = null, r.next = null, n.put(r);
            }
            this.moveToHead(i);
        }, r.prototype.remove = function(t) {
            null !== t.prev ? t.prev.next = t.next : this.head = t.next, null !== t.next ? t.next.prev = t.prev : this.tail = t.prev, 
            delete this.datas[t.key], this.count--;
        }, r.prototype.get = function(t) {
            var e = this.datas[t];
            return e ? (this.remove(e), this.moveToHead(e), e.value) : null;
        }, r.prototype.clear = function() {
            this.count = 0, this.datas = {}, this.head = null, this.tail = null;
        }, r.prototype.has = function(t) {
            return !!this.datas[t];
        }, r.prototype.delete = function(t) {
            var e = this.datas[t];
            this.remove(e);
        };
        var s = new r(100), o = {
            BASELINE_RATIO: .26,
            MIDDLE_RATIO: .37,
            BASELINE_OFFSET: 0,
            label_wordRex: /([a-zA-Z0-9\xc4\xd6\xdc\xe4\xf6\xfc\xdf\xe9\xe8\xe7\xe0\xf9\xea\xe2\xee\xf4\xfb\u0430-\u044f\u0410-\u042f\u0401\u0451]+|\S)/,
            label_symbolRex: /^[!,.:;'}\]%\?>\u3001\u2018\u201c\u300b\uff1f\u3002\uff0c\uff01]/,
            label_lastWordRex: /([a-zA-Z0-9\xc4\xd6\xdc\xe4\xf6\xfc\xdf\xe9\xe8\xe7\xe0\xf9\xea\xe2\xee\xf4\xfb\u0430\xed\xec\xcd\xcc\xef\xc1\xc0\xe1\xe0\xc9\xc8\xd2\xd3\xf2\xf3\u0150\u0151\xd9\xda\u0170\xfa\u0171\xf1\xd1\xe6\xc6\u0153\u0152\xc3\xc2\xe3\xd4\xf5\u011b\u0161\u010d\u0159\u017e\xfd\xe1\xed\xe9\xf3\xfa\u016f\u0165\u010f\u0148\u011a\u0160\u010c\u0158\u017d\xc1\xcd\xc9\xd3\xda\u0164\u017c\u017a\u015b\xf3\u0144\u0142\u0119\u0107\u0105\u017b\u0179\u015a\xd3\u0143\u0141\u0118\u0106\u0104-\u044f\u0410-\u042f\u0401\u0451]+|\S)$/,
            label_lastEnglish: /[a-zA-Z0-9\xc4\xd6\xdc\xe4\xf6\xfc\xdf\xe9\xe8\xe7\xe0\xf9\xea\xe2\xee\xf4\xfb\u0430\xed\xec\xcd\xcc\xef\xc1\xc0\xe1\xe0\xc9\xc8\xd2\xd3\xf2\xf3\u0150\u0151\xd9\xda\u0170\xfa\u0171\xf1\xd1\xe6\xc6\u0153\u0152\xc3\xc2\xe3\xd4\xf5\u011b\u0161\u010d\u0159\u017e\xfd\xe1\xed\xe9\xf3\xfa\u016f\u0165\u010f\u0148\u011a\u0160\u010c\u0158\u017d\xc1\xcd\xc9\xd3\xda\u0164\u017c\u017a\u015b\xf3\u0144\u0142\u0119\u0107\u0105\u017b\u0179\u015a\xd3\u0143\u0141\u0118\u0106\u0104-\u044f\u0410-\u042f\u0401\u0451]+$/,
            label_firstEnglish: /^[a-zA-Z0-9\xc4\xd6\xdc\xe4\xf6\xfc\xdf\xe9\xe8\xe7\xe0\xf9\xea\xe2\xee\xf4\xfb\u0430\xed\xec\xcd\xcc\xef\xc1\xc0\xe1\xe0\xc9\xc8\xd2\xd3\xf2\xf3\u0150\u0151\xd9\xda\u0170\xfa\u0171\xf1\xd1\xe6\xc6\u0153\u0152\xc3\xc2\xe3\xd4\xf5\u011b\u0161\u010d\u0159\u017e\xfd\xe1\xed\xe9\xf3\xfa\u016f\u0165\u010f\u0148\u011a\u0160\u010c\u0158\u017d\xc1\xcd\xc9\xd3\xda\u0164\u017c\u017a\u015b\xf3\u0144\u0142\u0119\u0107\u0105\u017b\u0179\u015a\xd3\u0143\u0141\u0118\u0106\u0104-\u044f\u0410-\u042f\u0401\u0451]/,
            highSurrogateRex: /[\uD800-\uDBFF]/,
            lowSurrogateRex: /[\uDC00-\uDFFF]/,
            label_wrapinspection: !0,
            __CHINESE_REG: /^[\u4E00-\u9FFF\u3400-\u4DFF]+$/,
            __JAPANESE_REG: /[\u3000-\u303F]|[\u3040-\u309F]|[\u30A0-\u30FF]|[\uFF00-\uFFEF]|[\u4E00-\u9FAF]|[\u2605-\u2606]|[\u2190-\u2195]|\u203B/g,
            __KOREAN_REG: /^[\u1100-\u11FF]|[\u3130-\u318F]|[\uA960-\uA97F]|[\uAC00-\uD7AF]|[\uD7B0-\uD7FF]+$/,
            isUnicodeCJK: function(t) {
                return this.__CHINESE_REG.test(t) || this.__JAPANESE_REG.test(t) || this.__KOREAN_REG.test(t);
            },
            isUnicodeSpace: function(t) {
                return (t = t.charCodeAt(0)) >= 9 && t <= 13 || 32 === t || 133 === t || 160 === t || 5760 === t || t >= 8192 && t <= 8202 || 8232 === t || 8233 === t || 8239 === t || 8287 === t || 12288 === t;
            },
            safeMeasureText: function(t, e, i) {
                var n = (i || t.font) + "" + e, r = s.get(n);
                if (null !== r) return r;
                var o = t.measureText(e), a = o && o.width || 0;
                return s.put(n, a), a;
            },
            _safeSubstring: function(t, e, i) {
                var n = e, r = i, s = t[e];
                if (this.lowSurrogateRex.test(s) && n--, void 0 !== i) if (i - 1 !== e) {
                    var o = t[i - 1];
                    this.highSurrogateRex.test(o) && r--;
                } else this.highSurrogateRex.test(s) && r++;
                return t.substring(n, r);
            },
            fragmentText: function(t, e, i, n) {
                var r = [];
                if (0 === t.length || i < 0) return r.push(""), r;
                for (var s = t; e > i && s.length > 1; ) {
                    for (var o = s.length * (i / e) | 0, a = this._safeSubstring(s, o), c = e - n(a), l = a, u = 0, h = 0; c > i && h++ < 10; ) o *= i / c, 
                    o |= 0, c = e - n(a = this._safeSubstring(s, o));
                    for (h = 0; c <= i && h++ < 10; ) {
                        if (a) {
                            var _ = this.label_wordRex.exec(a);
                            u = _ ? _[0].length : 1, l = a;
                        }
                        o += u, c = e - n(a = this._safeSubstring(s, o));
                    }
                    0 == (o -= u) ? (o = 1, l = this._safeSubstring(s, 1)) : 1 === o && this.highSurrogateRex.test(s[0]) && (o = 2, 
                    l = this._safeSubstring(s, 2));
                    var f, d = this._safeSubstring(s, 0, o);
                    this.label_wrapinspection && this.label_symbolRex.test(l || a) && (0 == (o -= (f = this.label_lastWordRex.exec(d)) ? f[0].length : 0) && (o = 1), 
                    l = this._safeSubstring(s, o), d = this._safeSubstring(s, 0, o)), this.label_firstEnglish.test(l) && (f = this.label_lastEnglish.exec(d)) && d !== f[0] && (o -= f[0].length, 
                    l = this._safeSubstring(s, o), d = this._safeSubstring(s, 0, o)), 0 === r.length ? r.push(d) : (d = d.trimLeft()).length > 0 && r.push(d), 
                    e = n(s = l || a);
                }
                return 0 === r.length ? r.push(s) : (s = s.trimLeft()).length > 0 && r.push(s), 
                r;
            }
        };
        cc.textUtils = e.exports = o;
    }, {
        "../platform/js": 203
    } ],
    264: [ function(t, e) {
        "use strict";
        var i = t("../assets/CCTexture2D"), n = {
            loadImage: function(t, e, i) {
                cc.assertID(t, 3103);
                var n = cc.assetManager.assets.get(t);
                if (n) return n.loaded ? (e && e.call(i, null, n), n) : (n.once("load", function() {
                    e && e.call(i, null, n);
                }, i), n);
                cc.assetManager.loadRemote(t, function(t, n) {
                    e && e.call(i, t, n);
                });
            },
            cacheImage: function(t, e) {
                if (t && e) {
                    var n = new i();
                    return n.initWithElement(e), cc.assetManager.assets.add(t, n), n;
                }
            },
            postLoadTexture: function(t, e) {
                t.loaded ? e && e() : t.nativeUrl ? cc.assetManager.loadNativeFile(t, function(i, n) {
                    i || (t._nativeAsset = n), e && e(i);
                }) : e && e();
            }
        };
        e.exports = n;
    }, {
        "../assets/CCTexture2D": 73
    } ],
    265: [ function(t, e) {
        "use strict";
        var i = t("./node-unit"), n = t("./node-mem-pool");
        e.exports = {
            NodeMemPool: new n(i)
        };
    }, {
        "./node-mem-pool": 267,
        "./node-unit": 268
    } ],
    266: [ function(t, e) {
        "use strict";
        var i = function(t) {
            this._unitClass = t, this._pool = [], this._findOrder = [];
        }, n = i.prototype;
        n._initNative = function() {
            this._nativeMemPool = new renderer.MemPool();
        }, n._buildUnit = function(t) {
            return new this._unitClass(t, this);
        }, n._destroyUnit = function(t) {
            this._pool[t] = null;
            for (var e = 0, i = this._findOrder.length; e < i; e++) {
                var n = this._findOrder[e];
                if (n && n.unitID == t) {
                    this._findOrder.splice(e, 1);
                    break;
                }
            }
        }, n._findUnitID = function() {
            for (var t = 0, e = this._pool; e[t]; ) t++;
            return t;
        }, n.pop = function() {
            for (var t = null, e = 0, i = this._findOrder, n = this._pool, r = i.length; e < r; e++) {
                var s = i[e];
                if (s && s.hasSpace()) {
                    t = s;
                    break;
                }
            }
            if (!t) {
                var o = this._findUnitID();
                t = this._buildUnit(o), n[o] = t, i.push(t), e = i.length - 1;
            }
            var a = i[0];
            return a !== t && (i[0] = t, i[e] = a), t.pop();
        }, n.push = function(t) {
            var e = this._pool[t.unitID];
            return e.push(t.index), this._findOrder.length > 1 && e.isAllFree() && this._destroyUnit(t.unitID), 
            e;
        }, e.exports = i;
    }, {} ],
    267: [ function(t, e) {
        "use strict";
        var i, n = t("./mem-pool"), r = function(t) {
            n.call(this, t);
        };
        (i = function() {}).prototype = n.prototype;
        var s = r.prototype = new i();
        s._initNative = function() {
            this._nativeMemPool = new renderer.NodeMemPool();
        }, s._destroyUnit = function(t) {
            n.prototype._destroyUnit.call(this, t);
        }, e.exports = r;
    }, {
        "./mem-pool": 266
    } ],
    268: [ function(t, e) {
        "use strict";
        var i, n = t("../../value-types/utils"), r = (Uint32Array, 10 * n.FLOAT_BYTES), s = 16 * n.FLOAT_BYTES, o = 16 * n.FLOAT_BYTES, a = (Uint32Array, 
        Uint32Array, Int32Array, Uint8Array, Uint8Array, Uint32Array, n.FLOAT_BYTES, t("./unit-base")), c = function(t, e) {
            a.call(this, t, e);
            var i = this._contentNum;
            this.trsList = new n.FLOAT_ARRAY_TYPE(10 * i), this.localMatList = new n.FLOAT_ARRAY_TYPE(16 * i), 
            this.worldMatList = new n.FLOAT_ARRAY_TYPE(16 * i);
            for (var c = 0; c < i; c++) {
                var l = this._spacesData[c];
                l.trs = new n.FLOAT_ARRAY_TYPE(this.trsList.buffer, c * r, 10), l.localMat = new n.FLOAT_ARRAY_TYPE(this.localMatList.buffer, c * s, 16), 
                l.worldMat = new n.FLOAT_ARRAY_TYPE(this.worldMatList.buffer, c * o, 16);
            }
        };
        (i = function() {}).prototype = a.prototype, c.prototype = new i(), e.exports = c;
    }, {
        "../../value-types/utils": 278,
        "./unit-base": 269
    } ],
    269: [ function(t, e) {
        "use strict";
        var i = function(t, e, i) {
            i = i || 128, this.unitID = t, this._memPool = e, this._data = new Uint16Array(2), 
            this._data[0] = 0, this._data[1] = 0, this._contentNum = i, this._signData = new Uint16Array(2 * this._contentNum), 
            this._spacesData = [];
            for (var n = 0; n < i; n++) {
                var r = 2 * n;
                this._signData[r + 0] = n + 1, this._signData[r + 1] = 0, this._spacesData[n] = {
                    index: n,
                    unitID: t
                };
            }
            this._signData[2 * (i - 1)] = 65535;
        }, n = i.prototype;
        n.hasSpace = function() {
            return 65535 !== this._data[0];
        }, n.isAllFree = function() {
            return 0 == this._data[1];
        }, n.pop = function() {
            var t = this._data[0];
            if (65535 === t) return null;
            var e = t, i = 2 * e, n = this._spacesData[e];
            return this._signData[i + 1] = 1, this._data[0] = this._signData[i + 0], this._data[1]++, 
            n;
        }, n.push = function(t) {
            var e = 2 * t;
            this._signData[e + 1] = 0, this._signData[e + 0] = this._data[0], this._data[0] = t, 
            this._data[1]--;
        }, n.dump = function() {
            for (var t = 0, e = this._data[0], i = ""; 65535 != e; ) t++, i += e + "->", e = this._signData[2 * e + 0];
            for (var n = 0, r = "", s = this._contentNum, o = 0; o < s; o++) 1 == this._signData[2 * o + 1] && (n++, 
            r += o + "->");
            var a = t + n;
            console.log("unitID:", this.unitID, "spaceNum:", t, "calc using num:", n, "store using num:", this._data[1], "calc total num:", a, "actually total num:", this._contentNum), 
            console.log("free info:", i), console.log("using info:", r), n != this._data[1] && cc.error("using num error", "calc using num:", n, "store using num:", this._data[1]), 
            t + n != this._contentNum && cc.error("total num error", "calc total num:", a, "actually total num:", this._contentNum);
        }, e.exports = i;
    }, {} ],
    270: [ function(t, e, i) {
        "use strict";
        i.__esModule = !0, i.default = void 0;
        var n = o(t("./value-type")), r = o(t("../platform/CCClass")), s = o(t("../utils/misc"));
        function o(t) {
            return t && t.__esModule ? t : {
                default: t
            };
        }
        function a(t, e) {
            for (var i = 0; i < e.length; i++) {
                var n = e[i];
                n.enumerable = n.enumerable || !1, n.configurable = !0, "value" in n && (n.writable = !0), 
                Object.defineProperty(t, n.key, n);
            }
        }
        function c(t, e, i) {
            return e && a(t.prototype, e), i && a(t, i), t;
        }
        var l = function(t) {
            var e, i;
            function n(e, i, n, r) {
                var s;
                return void 0 === e && (e = 0), void 0 === i && (i = 0), void 0 === n && (n = 0), 
                void 0 === r && (r = 255), (s = t.call(this) || this)._val = 0, "object" == typeof e && (i = e.g, 
                n = e.b, r = e.a, e = e.r), s._val = (r << 24 >>> 0) + (n << 16) + (i << 8) + (0 | e), 
                s;
            }
            i = t, (e = n).prototype = Object.create(i.prototype), e.prototype.constructor = e, 
            e.__proto__ = i, n.copy = function(t, e) {
                return t.r = e.r, t.g = e.g, t.b = e.b, t.a = e.a, t;
            }, n.clone = function(t) {
                return new n(t.r, t.g, t.b, t.a);
            }, n.set = function(t, e, i, n, r) {
                return void 0 === e && (e = 255), void 0 === i && (i = 255), void 0 === n && (n = 255), 
                void 0 === r && (r = 255), t.r = e, t.g = i, t.b = n, t.a = r, t;
            }, n.fromHex = function(t, e) {
                var i = (e >> 24) / 255, n = (e >> 16 & 255) / 255, r = (e >> 8 & 255) / 255, s = (255 & e) / 255;
                return t.r = i, t.g = n, t.b = r, t.a = s, t;
            }, n.fromHEX = function(t, e) {
                return e = 0 === e.indexOf("#") ? e.substring(1) : e, t.r = parseInt(e.substr(0, 2), 16) || 0, 
                t.g = parseInt(e.substr(2, 2), 16) || 0, t.b = parseInt(e.substr(4, 2), 16) || 0, 
                t.a = parseInt(e.substr(6, 2), 16) || 255, t._val = (t.a << 24 >>> 0) + (t.b << 16) + (t.g << 8) + t.r, 
                t;
            }, n.add = function(t, e, i) {
                return t.r = e.r + i.r, t.g = e.g + i.g, t.b = e.b + i.b, t.a = e.a + i.a, t;
            }, n.subtract = function(t, e, i) {
                return t.r = e.r - i.r, t.g = e.g - i.g, t.b = e.b - i.b, t.a = e.a - i.a, t;
            }, n.multiply = function(t, e, i) {
                return t.r = e.r * i.r, t.g = e.g * i.g, t.b = e.b * i.b, t.a = e.a * i.a, t;
            }, n.divide = function(t, e, i) {
                return t.r = e.r / i.r, t.g = e.g / i.g, t.b = e.b / i.b, t.a = e.a / i.a, t;
            }, n.scale = function(t, e, i) {
                return t.r = e.r * i, t.g = e.g * i, t.b = e.b * i, t.a = e.a * i, t;
            }, n.lerp = function(t, e, i, n) {
                var r = e.r, s = e.g, o = e.b, a = e.a;
                return t.r = r + n * (i.r - r), t.g = s + n * (i.g - s), t.b = o + n * (i.b - o), 
                t.a = a + n * (i.a - a), t;
            }, n.toArray = function(t, e, i) {
                void 0 === i && (i = 0);
                var r = e instanceof n || e.a > 1 ? 1 / 255 : 1;
                return t[i + 0] = e.r * r, t[i + 1] = e.g * r, t[i + 2] = e.b * r, t[i + 3] = e.a * r, 
                t;
            }, n.fromArray = function(t, e, i) {
                return void 0 === i && (i = 0), e.r = 255 * t[i + 0], e.g = 255 * t[i + 1], e.b = 255 * t[i + 2], 
                e.a = 255 * t[i + 3], e;
            }, n.premultiplyAlpha = function(t, e) {
                var i = e.a / 255;
                return t.r = e.r * i, t.g = e.g * i, t.b = e.b * i, t._fastSetA(e.a), t;
            }, c(n, null, [ {
                key: "WHITE",
                get: function() {
                    return new n(255, 255, 255, 255);
                }
            }, {
                key: "BLACK",
                get: function() {
                    return new n(0, 0, 0, 255);
                }
            }, {
                key: "TRANSPARENT",
                get: function() {
                    return new n(0, 0, 0, 0);
                }
            }, {
                key: "GRAY",
                get: function() {
                    return new n(127.5, 127.5, 127.5);
                }
            }, {
                key: "RED",
                get: function() {
                    return new n(255, 0, 0);
                }
            }, {
                key: "GREEN",
                get: function() {
                    return new n(0, 255, 0);
                }
            }, {
                key: "BLUE",
                get: function() {
                    return new n(0, 0, 255);
                }
            }, {
                key: "YELLOW",
                get: function() {
                    return new n(255, 235, 4);
                }
            }, {
                key: "ORANGE",
                get: function() {
                    return new n(255, 127, 0);
                }
            }, {
                key: "CYAN",
                get: function() {
                    return new n(0, 255, 255);
                }
            }, {
                key: "MAGENTA",
                get: function() {
                    return new n(255, 0, 255);
                }
            } ]);
            var r = n.prototype;
            return r.clone = function() {
                var t = new n();
                return t._val = this._val, t;
            }, r.equals = function(t) {
                return t && this._val === t._val;
            }, r.lerp = function(t, e, i) {
                i = i || new n();
                var r = this.r, s = this.g, o = this.b, a = this.a;
                return i.r = r + (t.r - r) * e, i.g = s + (t.g - s) * e, i.b = o + (t.b - o) * e, 
                i.a = a + (t.a - a) * e, i;
            }, r.toString = function() {
                return "rgba(" + this.r.toFixed() + ", " + this.g.toFixed() + ", " + this.b.toFixed() + ", " + this.a.toFixed() + ")";
            }, r.getR = function() {
                return 255 & this._val;
            }, r.setR = function(t) {
                return t = ~~s.default.clampf(t, 0, 255), this._val = (4294967040 & this._val | t) >>> 0, 
                this;
            }, r.getG = function() {
                return (65280 & this._val) >> 8;
            }, r.setG = function(t) {
                return t = ~~s.default.clampf(t, 0, 255), this._val = (4294902015 & this._val | t << 8) >>> 0, 
                this;
            }, r.getB = function() {
                return (16711680 & this._val) >> 16;
            }, r.setB = function(t) {
                return t = ~~s.default.clampf(t, 0, 255), this._val = (4278255615 & this._val | t << 16) >>> 0, 
                this;
            }, r.getA = function() {
                return (4278190080 & this._val) >>> 24;
            }, r.setA = function(t) {
                return t = ~~s.default.clampf(t, 0, 255), this._val = (16777215 & this._val | t << 24) >>> 0, 
                this;
            }, r.toCSS = function(t) {
                return t && "rgba" !== t ? "rgb" === t ? "rgb(" + this.r + "," + this.g + "," + this.b + ")" : "#" + this.toHEX(t) : "rgba(" + this.r + "," + this.g + "," + this.b + "," + (this.a / 255).toFixed(2) + ")";
            }, r.fromHEX = function(t) {
                t = 0 === t.indexOf("#") ? t.substring(1) : t;
                var e = parseInt(t.substr(0, 2), 16) || 0, i = parseInt(t.substr(2, 2), 16) || 0, n = parseInt(t.substr(4, 2), 16) || 0, r = parseInt(t.substr(6, 2), 16) || 255;
                return this._val = (r << 24 >>> 0) + (n << 16) + (i << 8) + e, this;
            }, r.toHEX = function(t) {
                var e = [ (this.r < 16 ? "0" : "") + this.r.toString(16), (this.g < 16 ? "0" : "") + this.g.toString(16), (this.b < 16 ? "0" : "") + this.b.toString(16) ];
                return "#rgb" === t ? (e[0] = e[0][0], e[1] = e[1][0], e[2] = e[2][0]) : "#rrggbbaa" === t && e.push((this.a < 16 ? "0" : "") + this.a.toString(16)), 
                e.join("");
            }, r.toRGBValue = function() {
                return 16777215 & this._val;
            }, r.fromHSV = function(t, e, i) {
                var n, r, s;
                if (0 === e) n = r = s = i; else if (0 === i) n = r = s = 0; else {
                    1 === t && (t = 0), t *= 6;
                    var o = Math.floor(t), a = t - o, c = i * (1 - e), l = i * (1 - e * a), u = i * (1 - e * (1 - a));
                    switch (o) {
                      case 0:
                        n = i, r = u, s = c;
                        break;

                      case 1:
                        n = l, r = i, s = c;
                        break;

                      case 2:
                        n = c, r = i, s = u;
                        break;

                      case 3:
                        n = c, r = l, s = i;
                        break;

                      case 4:
                        n = u, r = c, s = i;
                        break;

                      case 5:
                        n = i, r = c, s = l;
                    }
                }
                return n *= 255, r *= 255, s *= 255, this._val = (this.a << 24 >>> 0) + (s << 16) + (r << 8) + (0 | n), 
                this;
            }, r.toHSV = function() {
                var t = this.r / 255, e = this.g / 255, i = this.b / 255, n = {
                    h: 0,
                    s: 0,
                    v: 0
                }, r = Math.max(t, e, i), s = Math.min(t, e, i), o = 0;
                return n.v = r, n.s = r ? (r - s) / r : 0, n.s ? (o = r - s, n.h = t === r ? (e - i) / o : e === r ? 2 + (i - t) / o : 4 + (t - e) / o, 
                n.h /= 6, n.h < 0 && (n.h += 1)) : n.h = 0, n;
            }, r.set = function(t) {
                return t._val ? this._val = t._val : (this.r = t.r, this.g = t.g, this.b = t.b, 
                this.a = t.a), this;
            }, r._fastSetA = function(t) {
                this._val = (16777215 & this._val | t << 24) >>> 0;
            }, r.multiply = function(t) {
                var e = (255 & this._val) * t.r >> 8, i = (65280 & this._val) * t.g >> 8, n = (16711680 & this._val) * t.b >> 8, r = ((4278190080 & this._val) >>> 8) * t.a;
                return this._val = 4278190080 & r | 16711680 & n | 65280 & i | 255 & e, this;
            }, c(n, [ {
                key: "r",
                get: function() {
                    return this.getR();
                },
                set: function(t) {
                    this.setR(t);
                }
            }, {
                key: "g",
                get: function() {
                    return this.getG();
                },
                set: function(t) {
                    this.setG(t);
                }
            }, {
                key: "b",
                get: function() {
                    return this.getB();
                },
                set: function(t) {
                    this.setB(t);
                }
            }, {
                key: "a",
                get: function() {
                    return this.getA();
                },
                set: function(t) {
                    this.setA(t);
                }
            } ]), n;
        }(n.default);
        i.default = l, l.div = l.divide, l.sub = l.subtract, l.mul = l.multiply, l.WHITE_R = l.WHITE, 
        l.BLACK_R = l.BLACK, l.TRANSPARENT_R = l.TRANSPARENT, l.GRAY_R = l.GRAY, l.RED_R = l.RED, 
        l.GREEN_R = l.GREEN, l.BLUE_R = l.BLUE, l.YELLOW_R = l.YELLOW, l.ORANGE_R = l.ORANGE, 
        l.CYAN_R = l.CYAN, l.MAGENTA_R = l.MAGENTA, r.default.fastDefine("cc.Color", l, {
            r: 0,
            g: 0,
            b: 0,
            a: 255
        }), cc.Color = l, cc.color = function(t, e, i, n) {
            return "string" == typeof t ? new l().fromHEX(t) : "object" == typeof t ? new l(t.r, t.g, t.b, t.a) : new l(t, e, i, n);
        }, e.exports = i.default;
    }, {
        "../platform/CCClass": 182,
        "../utils/misc": 256,
        "./value-type": 279
    } ],
    271: [ function(t, e, i) {
        "use strict";
        i.__esModule = !0;
        var n = {
            Vec2: !0,
            Vec3: !0,
            Vec4: !0,
            Mat4: !0,
            Mat3: !0,
            Rect: !0,
            Size: !0,
            Color: !0,
            Quat: !0,
            Trs: !0
        };
        i.Trs = i.Quat = i.Color = i.Size = i.Rect = i.Mat3 = i.Mat4 = i.Vec4 = i.Vec3 = i.Vec2 = void 0;
        var r = p(t("./vec2"));
        i.Vec2 = r.default;
        var s = p(t("./vec3"));
        i.Vec3 = s.default;
        var o = p(t("./vec4"));
        i.Vec4 = o.default;
        var a = p(t("./mat4"));
        i.Mat4 = a.default;
        var c = p(t("./mat3"));
        i.Mat3 = c.default;
        var l = p(t("./rect"));
        i.Rect = l.default;
        var u = p(t("./size"));
        i.Size = u.default;
        var h = p(t("./color"));
        i.Color = h.default;
        var _ = p(t("./quat"));
        i.Quat = _.default;
        var f = p(t("./trs"));
        i.Trs = f.default;
        var d = t("./utils");
        function p(t) {
            return t && t.__esModule ? t : {
                default: t
            };
        }
        Object.keys(d).forEach(function(t) {
            "default" !== t && "__esModule" !== t && (Object.prototype.hasOwnProperty.call(n, t) || (i[t] = d[t]));
        }), cc.math = e.exports;
    }, {
        "./color": 270,
        "./mat3": 272,
        "./mat4": 273,
        "./quat": 274,
        "./rect": 275,
        "./size": 276,
        "./trs": 277,
        "./utils": 278,
        "./vec2": 280,
        "./vec3": 281,
        "./vec4": 282
    } ],
    272: [ function(t, e, i) {
        "use strict";
        i.__esModule = !0, i.default = void 0;
        var n, r = t("../value-types/utils"), s = (n = t("./vec3")) && n.__esModule ? n : {
            default: n
        }, o = function() {
            function t(t, e, i, n, s, o, a, c, l) {
                if (void 0 === t && (t = 1), void 0 === e && (e = 0), void 0 === i && (i = 0), void 0 === n && (n = 0), 
                void 0 === s && (s = 1), void 0 === o && (o = 0), void 0 === a && (a = 0), void 0 === c && (c = 0), 
                void 0 === l && (l = 1), this.m = void 0, t instanceof r.FLOAT_ARRAY_TYPE) this.m = t; else {
                    this.m = new r.FLOAT_ARRAY_TYPE(9);
                    var u = this.m;
                    u[0] = t, u[1] = e, u[2] = i, u[3] = n, u[4] = s, u[5] = o, u[6] = a, u[7] = c, 
                    u[8] = l;
                }
            }
            return t.create = function(e, i, n, r, s, o, a, c, l) {
                return void 0 === e && (e = 1), void 0 === i && (i = 0), void 0 === n && (n = 0), 
                void 0 === r && (r = 0), void 0 === s && (s = 1), void 0 === o && (o = 0), void 0 === a && (a = 0), 
                void 0 === c && (c = 0), void 0 === l && (l = 1), new t(e, i, n, r, s, o, a, c, l);
            }, t.clone = function(e) {
                var i = e.m;
                return new t(i[0], i[1], i[2], i[3], i[4], i[5], i[6], i[7], i[8]);
            }, t.copy = function(t, e) {
                return t.m.set(e.m), t;
            }, t.set = function(t, e, i, n, r, s, o, a, c, l) {
                var u = t.m;
                return u[0] = e, u[1] = i, u[2] = n, u[3] = r, u[4] = s, u[5] = o, u[6] = a, u[7] = c, 
                u[8] = l, t;
            }, t.identity = function(t) {
                var e = t.m;
                return e[0] = 1, e[1] = 0, e[2] = 0, e[3] = 0, e[4] = 1, e[5] = 0, e[6] = 0, e[7] = 0, 
                e[8] = 1, t;
            }, t.transpose = function(t, e) {
                var i = e.m, n = t.m;
                if (t === e) {
                    var r = i[1], s = i[2], o = i[5];
                    n[1] = i[3], n[2] = i[6], n[3] = r, n[5] = i[7], n[6] = s, n[7] = o;
                } else n[0] = i[0], n[1] = i[3], n[2] = i[6], n[3] = i[1], n[4] = i[4], n[5] = i[7], 
                n[6] = i[2], n[7] = i[5], n[8] = i[8];
                return t;
            }, t.invert = function(t, e) {
                var i = e.m, n = t.m, r = i[0], s = i[1], o = i[2], a = i[3], c = i[4], l = i[5], u = i[6], h = i[7], _ = i[8], f = _ * c - l * h, d = -_ * a + l * u, p = h * a - c * u, m = r * f + s * d + o * p;
                return m ? (m = 1 / m, n[0] = f * m, n[1] = (-_ * s + o * h) * m, n[2] = (l * s - o * c) * m, 
                n[3] = d * m, n[4] = (_ * r - o * u) * m, n[5] = (-l * r + o * a) * m, n[6] = p * m, 
                n[7] = (-h * r + s * u) * m, n[8] = (c * r - s * a) * m, t) : t;
            }, t.adjoint = function(t, e) {
                var i = e.m, n = t.m, r = i[0], s = i[1], o = i[2], a = i[3], c = i[4], l = i[5], u = i[6], h = i[7], _ = i[8];
                return n[0] = c * _ - l * h, n[1] = o * h - s * _, n[2] = s * l - o * c, n[3] = l * u - a * _, 
                n[4] = r * _ - o * u, n[5] = o * a - r * l, n[6] = a * h - c * u, n[7] = s * u - r * h, 
                n[8] = r * c - s * a, t;
            }, t.determinant = function(t) {
                var e = t.m, i = e[0], n = e[1], r = e[2], s = e[3], o = e[4], a = e[5], c = e[6], l = e[7], u = e[8];
                return i * (u * o - a * l) + n * (-u * s + a * c) + r * (l * s - o * c);
            }, t.multiply = function(t, e, i) {
                var n = e.m, r = i.m, s = t.m, o = n[0], a = n[1], c = n[2], l = n[3], u = n[4], h = n[5], _ = n[6], f = n[7], d = n[8], p = r[0], m = r[1], v = r[2], y = r[3], g = r[4], x = r[5], A = r[6], C = r[7], b = r[8];
                return s[0] = p * o + m * l + v * _, s[1] = p * a + m * u + v * f, s[2] = p * c + m * h + v * d, 
                s[3] = y * o + g * l + x * _, s[4] = y * a + g * u + x * f, s[5] = y * c + g * h + x * d, 
                s[6] = A * o + C * l + b * _, s[7] = A * a + C * u + b * f, s[8] = A * c + C * h + b * d, 
                t;
            }, t.multiplyMat4 = function(t, e, i) {
                var n = e.m, r = i.m, s = t.m, o = n[0], a = n[1], c = n[2], l = n[3], u = n[4], h = n[5], _ = n[6], f = n[7], d = n[8], p = r[0], m = r[1], v = r[2], y = r[4], g = r[5], x = r[6], A = r[8], C = r[9], b = r[10];
                return s[0] = p * o + m * l + v * _, s[1] = p * a + m * u + v * f, s[2] = p * c + m * h + v * d, 
                s[3] = y * o + g * l + x * _, s[4] = y * a + g * u + x * f, s[5] = y * c + g * h + x * d, 
                s[6] = A * o + C * l + b * _, s[7] = A * a + C * u + b * f, s[8] = A * c + C * h + b * d, 
                t;
            }, t.translate = function(t, e, i) {
                var n = e.m, r = t.m, s = n[0], o = n[1], a = n[2], c = n[3], l = n[4], u = n[5], h = n[6], _ = n[7], f = n[8], d = i.x, p = i.y;
                return r[0] = s, r[1] = o, r[2] = a, r[3] = c, r[4] = l, r[5] = u, r[6] = d * s + p * c + h, 
                r[7] = d * o + p * l + _, r[8] = d * a + p * u + f, t;
            }, t.rotate = function(t, e, i) {
                var n = e.m, r = t.m, s = n[0], o = n[1], a = n[2], c = n[3], l = n[4], u = n[5], h = n[6], _ = n[7], f = n[8], d = Math.sin(i), p = Math.cos(i);
                return r[0] = p * s + d * c, r[1] = p * o + d * l, r[2] = p * a + d * u, r[3] = p * c - d * s, 
                r[4] = p * l - d * o, r[5] = p * u - d * a, r[6] = h, r[7] = _, r[8] = f, t;
            }, t.scale = function(t, e, i) {
                var n = i.x, r = i.y, s = e.m, o = t.m;
                return o[0] = n * s[0], o[1] = n * s[1], o[2] = n * s[2], o[3] = r * s[3], o[4] = r * s[4], 
                o[5] = r * s[5], o[6] = s[6], o[7] = s[7], o[8] = s[8], t;
            }, t.fromMat4 = function(t, e) {
                var i = e.m, n = t.m;
                return n[0] = i[0], n[1] = i[1], n[2] = i[2], n[3] = i[4], n[4] = i[5], n[5] = i[6], 
                n[6] = i[8], n[7] = i[9], n[8] = i[10], t;
            }, t.fromTranslation = function(t, e) {
                var i = t.m;
                return i[0] = 1, i[1] = 0, i[2] = 0, i[3] = 0, i[4] = 1, i[5] = 0, i[6] = e.x, i[7] = e.y, 
                i[8] = 1, t;
            }, t.fromRotation = function(t, e) {
                var i = Math.sin(e), n = Math.cos(e), r = t.m;
                return r[0] = n, r[1] = i, r[2] = 0, r[3] = -i, r[4] = n, r[5] = 0, r[6] = 0, r[7] = 0, 
                r[8] = 1, t;
            }, t.fromScaling = function(t, e) {
                var i = t.m;
                return i[0] = e.x, i[1] = 0, i[2] = 0, i[3] = 0, i[4] = e.y, i[5] = 0, i[6] = 0, 
                i[7] = 0, i[8] = 1, t;
            }, t.fromQuat = function(t, e) {
                var i = t.m, n = e.x, r = e.y, s = e.z, o = e.w, a = n + n, c = r + r, l = s + s, u = n * a, h = r * a, _ = r * c, f = s * a, d = s * c, p = s * l, m = o * a, v = o * c, y = o * l;
                return i[0] = 1 - _ - p, i[3] = h - y, i[6] = f + v, i[1] = h + y, i[4] = 1 - u - p, 
                i[7] = d - m, i[2] = f - v, i[5] = d + m, i[8] = 1 - u - _, t;
            }, t.fromViewUp = function(e, i, n) {
                var o, a, c;
                return (o = new s.default(0, 1, 0), a = new s.default(), c = new s.default(), function(e, i, n) {
                    return s.default.lengthSqr(i) < r.EPSILON * r.EPSILON ? (t.identity(e), e) : (n = n || o, 
                    s.default.normalize(a, s.default.cross(a, n, i)), s.default.lengthSqr(a) < r.EPSILON * r.EPSILON ? (t.identity(e), 
                    e) : (s.default.cross(c, i, a), t.set(e, a.x, a.y, a.z, c.x, c.y, c.z, i.x, i.y, i.z), 
                    e));
                })(e, i, n);
            }, t.normalFromMat4 = function(t, e) {
                var i = e.m, n = t.m, r = i[0], s = i[1], o = i[2], a = i[3], c = i[4], l = i[5], u = i[6], h = i[7], _ = i[8], f = i[9], d = i[10], p = i[11], m = i[12], v = i[13], y = i[14], g = i[15], x = r * l - s * c, A = r * u - o * c, C = r * h - a * c, b = s * u - o * l, S = s * h - a * l, T = o * h - a * u, w = _ * v - f * m, E = _ * y - d * m, B = _ * g - p * m, M = f * y - d * v, R = f * g - p * v, P = d * g - p * y, I = x * P - A * R + C * M + b * B - S * E + T * w;
                return I ? (I = 1 / I, n[0] = (l * P - u * R + h * M) * I, n[1] = (u * B - c * P - h * E) * I, 
                n[2] = (c * R - l * B + h * w) * I, n[3] = (o * R - s * P - a * M) * I, n[4] = (r * P - o * B + a * E) * I, 
                n[5] = (s * B - r * R - a * w) * I, n[6] = (v * T - y * S + g * b) * I, n[7] = (y * C - m * T - g * A) * I, 
                n[8] = (m * S - v * C + g * x) * I, t) : t;
            }, t.frob = function(t) {
                var e = t.m;
                return Math.sqrt(Math.pow(e[0], 2) + Math.pow(e[1], 2) + Math.pow(e[2], 2) + Math.pow(e[3], 2) + Math.pow(e[4], 2) + Math.pow(e[5], 2) + Math.pow(e[6], 2) + Math.pow(e[7], 2) + Math.pow(e[8], 2));
            }, t.add = function(t, e, i) {
                var n = e.m, r = i.m, s = t.m;
                return s[0] = n[0] + r[0], s[1] = n[1] + r[1], s[2] = n[2] + r[2], s[3] = n[3] + r[3], 
                s[4] = n[4] + r[4], s[5] = n[5] + r[5], s[6] = n[6] + r[6], s[7] = n[7] + r[7], 
                s[8] = n[8] + r[8], t;
            }, t.subtract = function(t, e, i) {
                var n = e.m, r = i.m, s = t.m;
                return s[0] = n[0] - r[0], s[1] = n[1] - r[1], s[2] = n[2] - r[2], s[3] = n[3] - r[3], 
                s[4] = n[4] - r[4], s[5] = n[5] - r[5], s[6] = n[6] - r[6], s[7] = n[7] - r[7], 
                s[8] = n[8] - r[8], t;
            }, t.multiplyScalar = function(t, e, i) {
                var n = e.m, r = t.m;
                return r[0] = n[0] * i, r[1] = n[1] * i, r[2] = n[2] * i, r[3] = n[3] * i, r[4] = n[4] * i, 
                r[5] = n[5] * i, r[6] = n[6] * i, r[7] = n[7] * i, r[8] = n[8] * i, t;
            }, t.multiplyScalarAndAdd = function(t, e, i, n) {
                var r = e.m, s = i.m, o = t.m;
                return o[0] = r[0] + s[0] * n, o[1] = r[1] + s[1] * n, o[2] = r[2] + s[2] * n, o[3] = r[3] + s[3] * n, 
                o[4] = r[4] + s[4] * n, o[5] = r[5] + s[5] * n, o[6] = r[6] + s[6] * n, o[7] = r[7] + s[7] * n, 
                o[8] = r[8] + s[8] * n, t;
            }, t.exactEquals = function(t, e) {
                var i = t.m, n = e.m;
                return i[0] === n[0] && i[1] === n[1] && i[2] === n[2] && i[3] === n[3] && i[4] === n[4] && i[5] === n[5] && i[6] === n[6] && i[7] === n[7] && i[8] === n[8];
            }, t.equals = function(t, e) {
                var i = t.m, n = e.m, s = i[0], o = i[1], a = i[2], c = i[3], l = i[4], u = i[5], h = i[6], _ = i[7], f = i[8], d = n[0], p = n[1], m = n[2], v = n[3], y = n[4], g = n[5], x = n[6], A = n[7], C = n[8];
                return Math.abs(s - d) <= r.EPSILON * Math.max(1, Math.abs(s), Math.abs(d)) && Math.abs(o - p) <= r.EPSILON * Math.max(1, Math.abs(o), Math.abs(p)) && Math.abs(a - m) <= r.EPSILON * Math.max(1, Math.abs(a), Math.abs(m)) && Math.abs(c - v) <= r.EPSILON * Math.max(1, Math.abs(c), Math.abs(v)) && Math.abs(l - y) <= r.EPSILON * Math.max(1, Math.abs(l), Math.abs(y)) && Math.abs(u - g) <= r.EPSILON * Math.max(1, Math.abs(u), Math.abs(g)) && Math.abs(h - x) <= r.EPSILON * Math.max(1, Math.abs(h), Math.abs(x)) && Math.abs(_ - A) <= r.EPSILON * Math.max(1, Math.abs(_), Math.abs(A)) && Math.abs(f - C) <= r.EPSILON * Math.max(1, Math.abs(f), Math.abs(C));
            }, t.toArray = function(t, e, i) {
                void 0 === i && (i = 0);
                for (var n = e.m, r = 0; r < 9; r++) t[i + r] = n[r];
                return t;
            }, t.fromArray = function(t, e, i) {
                void 0 === i && (i = 0);
                for (var n = t.m, r = 0; r < 9; r++) n[r] = e[i + r];
                return t;
            }, t.prototype.toString = function() {
                var t = this.m;
                return "mat3(" + t[0] + ", " + t[1] + ", " + t[2] + ", " + t[3] + ", " + t[4] + ", " + t[5] + ", " + t[6] + ", " + t[7] + ", " + t[8] + ")";
            }, t;
        }();
        i.default = o, o.sub = o.subtract, o.mul = o.multiply, o.IDENTITY = Object.freeze(new o()), 
        cc.Mat3 = o, e.exports = i.default;
    }, {
        "../value-types/utils": 278,
        "./vec3": 281
    } ],
    273: [ function(t, e, i) {
        "use strict";
        i.__esModule = !0, i.default = void 0;
        var n = l(t("./value-type")), r = l(t("../platform/CCClass")), s = l(t("./vec3")), o = l(t("./quat")), a = t("./utils"), c = l(t("./mat3"));
        function l(t) {
            return t && t.__esModule ? t : {
                default: t
            };
        }
        var u = 0, h = 0, _ = 0, f = 0, d = 0, p = 0, m = 0, v = 0, y = 0, g = 0, x = 0, A = 0, C = 0, b = 0, S = 0, T = 0, w = function(t) {
            var e, i;
            i = t, (e = r).prototype = Object.create(i.prototype), e.prototype.constructor = e, 
            e.__proto__ = i;
            var n = r.prototype;
            function r(e, i, n, r, s, o, c, l, u, h, _, f, d, p, m, v) {
                var y;
                if (void 0 === e && (e = 1), void 0 === i && (i = 0), void 0 === n && (n = 0), void 0 === r && (r = 0), 
                void 0 === s && (s = 0), void 0 === o && (o = 1), void 0 === c && (c = 0), void 0 === l && (l = 0), 
                void 0 === u && (u = 0), void 0 === h && (h = 0), void 0 === _ && (_ = 1), void 0 === f && (f = 0), 
                void 0 === d && (d = 0), void 0 === p && (p = 0), void 0 === m && (m = 0), void 0 === v && (v = 1), 
                (y = t.call(this) || this).m = void 0, e instanceof a.FLOAT_ARRAY_TYPE) y.m = e; else {
                    y.m = new a.FLOAT_ARRAY_TYPE(16);
                    var g = y.m;
                    g[0] = e, g[1] = i, g[2] = n, g[3] = r, g[4] = s, g[5] = o, g[6] = c, g[7] = l, 
                    g[8] = u, g[9] = h, g[10] = _, g[11] = f, g[12] = d, g[13] = p, g[14] = m, g[15] = v;
                }
                return y;
            }
            return n.mul = function(t, e) {
                return r.multiply(e || new r(), this, t);
            }, n.mulScalar = function(t, e) {
                r.multiplyScalar(e || new r(), this, t);
            }, n.sub = function(t, e) {
                r.subtract(e || new r(), this, t);
            }, r.clone = function(t) {
                var e = t.m;
                return new r(e[0], e[1], e[2], e[3], e[4], e[5], e[6], e[7], e[8], e[9], e[10], e[11], e[12], e[13], e[14], e[15]);
            }, r.copy = function(t, e) {
                var i = t.m, n = e.m;
                return i[0] = n[0], i[1] = n[1], i[2] = n[2], i[3] = n[3], i[4] = n[4], i[5] = n[5], 
                i[6] = n[6], i[7] = n[7], i[8] = n[8], i[9] = n[9], i[10] = n[10], i[11] = n[11], 
                i[12] = n[12], i[13] = n[13], i[14] = n[14], i[15] = n[15], t;
            }, r.set = function(t, e, i, n, r, s, o, a, c, l, u, h, _, f, d, p, m) {
                var v = t.m;
                return v[0] = e, v[1] = i, v[2] = n, v[3] = r, v[4] = s, v[5] = o, v[6] = a, v[7] = c, 
                v[8] = l, v[9] = u, v[10] = h, v[11] = _, v[12] = f, v[13] = d, v[14] = p, v[15] = m, 
                t;
            }, r.identity = function(t) {
                var e = t.m;
                return e[0] = 1, e[1] = 0, e[2] = 0, e[3] = 0, e[4] = 0, e[5] = 1, e[6] = 0, e[7] = 0, 
                e[8] = 0, e[9] = 0, e[10] = 1, e[11] = 0, e[12] = 0, e[13] = 0, e[14] = 0, e[15] = 1, 
                t;
            }, r.transpose = function(t, e) {
                var i = t.m, n = e.m;
                if (t === e) {
                    var r = n[1], s = n[2], o = n[3], a = n[6], c = n[7], l = n[11];
                    i[1] = n[4], i[2] = n[8], i[3] = n[12], i[4] = r, i[6] = n[9], i[7] = n[13], i[8] = s, 
                    i[9] = a, i[11] = n[14], i[12] = o, i[13] = c, i[14] = l;
                } else i[0] = n[0], i[1] = n[4], i[2] = n[8], i[3] = n[12], i[4] = n[1], i[5] = n[5], 
                i[6] = n[9], i[7] = n[13], i[8] = n[2], i[9] = n[6], i[10] = n[10], i[11] = n[14], 
                i[12] = n[3], i[13] = n[7], i[14] = n[11], i[15] = n[15];
                return t;
            }, r.invert = function(t, e) {
                var i = e.m;
                u = i[0], h = i[1], _ = i[2], f = i[3], d = i[4], p = i[5], m = i[6], v = i[7], 
                y = i[8], g = i[9], x = i[10], A = i[11], C = i[12], b = i[13], S = i[14], T = i[15];
                var n = u * p - h * d, r = u * m - _ * d, s = u * v - f * d, o = h * m - _ * p, a = h * v - f * p, c = _ * v - f * m, l = y * b - g * C, w = y * S - x * C, E = y * T - A * C, B = g * S - x * b, M = g * T - A * b, R = x * T - A * S, P = n * R - r * M + s * B + o * E - a * w + c * l;
                if (0 === P) return null;
                P = 1 / P;
                var I = t.m;
                return I[0] = (p * R - m * M + v * B) * P, I[1] = (_ * M - h * R - f * B) * P, I[2] = (b * c - S * a + T * o) * P, 
                I[3] = (x * a - g * c - A * o) * P, I[4] = (m * E - d * R - v * w) * P, I[5] = (u * R - _ * E + f * w) * P, 
                I[6] = (S * s - C * c - T * r) * P, I[7] = (y * c - x * s + A * r) * P, I[8] = (d * M - p * E + v * l) * P, 
                I[9] = (h * E - u * M - f * l) * P, I[10] = (C * a - b * s + T * n) * P, I[11] = (g * s - y * a - A * n) * P, 
                I[12] = (p * w - d * B - m * l) * P, I[13] = (u * B - h * w + _ * l) * P, I[14] = (b * r - C * o - S * n) * P, 
                I[15] = (y * o - g * r + x * n) * P, t;
            }, r.determinant = function(t) {
                var e = t.m;
                return u = e[0], h = e[1], _ = e[2], f = e[3], d = e[4], p = e[5], m = e[6], v = e[7], 
                y = e[8], g = e[9], x = e[10], A = e[11], C = e[12], b = e[13], S = e[14], T = e[15], 
                (u * p - h * d) * (x * T - A * S) - (u * m - _ * d) * (g * T - A * b) + (u * v - f * d) * (g * S - x * b) + (h * m - _ * p) * (y * T - A * C) - (h * v - f * p) * (y * S - x * C) + (_ * v - f * m) * (y * b - g * C);
            }, r.multiply = function(t, e, i) {
                var n = t.m, r = e.m, s = i.m;
                u = r[0], h = r[1], _ = r[2], f = r[3], d = r[4], p = r[5], m = r[6], v = r[7], 
                y = r[8], g = r[9], x = r[10], A = r[11], C = r[12], b = r[13], S = r[14], T = r[15];
                var o = s[0], a = s[1], c = s[2], l = s[3];
                return n[0] = o * u + a * d + c * y + l * C, n[1] = o * h + a * p + c * g + l * b, 
                n[2] = o * _ + a * m + c * x + l * S, n[3] = o * f + a * v + c * A + l * T, o = s[4], 
                a = s[5], c = s[6], l = s[7], n[4] = o * u + a * d + c * y + l * C, n[5] = o * h + a * p + c * g + l * b, 
                n[6] = o * _ + a * m + c * x + l * S, n[7] = o * f + a * v + c * A + l * T, o = s[8], 
                a = s[9], c = s[10], l = s[11], n[8] = o * u + a * d + c * y + l * C, n[9] = o * h + a * p + c * g + l * b, 
                n[10] = o * _ + a * m + c * x + l * S, n[11] = o * f + a * v + c * A + l * T, o = s[12], 
                a = s[13], c = s[14], l = s[15], n[12] = o * u + a * d + c * y + l * C, n[13] = o * h + a * p + c * g + l * b, 
                n[14] = o * _ + a * m + c * x + l * S, n[15] = o * f + a * v + c * A + l * T, t;
            }, r.transform = function(t, e, i) {
                var n = i.x, r = i.y, s = i.z, o = t.m, a = e.m;
                return e === t ? (o[12] = a[0] * n + a[4] * r + a[8] * s + a[12], o[13] = a[1] * n + a[5] * r + a[9] * s + a[13], 
                o[14] = a[2] * n + a[6] * r + a[10] * s + a[14], o[15] = a[3] * n + a[7] * r + a[11] * s + a[15]) : (u = a[0], 
                h = a[1], _ = a[2], f = a[3], d = a[4], p = a[5], m = a[6], v = a[7], y = a[8], 
                g = a[9], x = a[10], A = a[11], C = a[12], b = a[13], S = a[14], T = a[15], o[0] = u, 
                o[1] = h, o[2] = _, o[3] = f, o[4] = d, o[5] = p, o[6] = m, o[7] = v, o[8] = y, 
                o[9] = g, o[10] = x, o[11] = A, o[12] = u * n + d * r + y * s + a[12], o[13] = h * n + p * r + g * s + a[13], 
                o[14] = _ * n + m * r + x * s + a[14], o[15] = f * n + v * r + A * s + a[15]), t;
            }, r.translate = function(t, e, i) {
                var n = t.m, r = e.m;
                return e === t ? (n[12] += i.x, n[13] += i.y, n[14] += i.z) : (n[0] = r[0], n[1] = r[1], 
                n[2] = r[2], n[3] = r[3], n[4] = r[4], n[5] = r[5], n[6] = r[6], n[7] = r[7], n[8] = r[8], 
                n[9] = r[9], n[10] = r[10], n[11] = r[11], n[12] += i.x, n[13] += i.y, n[14] += i.z, 
                n[15] = r[15]), t;
            }, r.scale = function(t, e, i) {
                var n = i.x, r = i.y, s = i.z, o = t.m, a = e.m;
                return o[0] = a[0] * n, o[1] = a[1] * n, o[2] = a[2] * n, o[3] = a[3] * n, o[4] = a[4] * r, 
                o[5] = a[5] * r, o[6] = a[6] * r, o[7] = a[7] * r, o[8] = a[8] * s, o[9] = a[9] * s, 
                o[10] = a[10] * s, o[11] = a[11] * s, o[12] = a[12], o[13] = a[13], o[14] = a[14], 
                o[15] = a[15], t;
            }, r.rotate = function(t, e, i, n) {
                var r = n.x, s = n.y, o = n.z, c = Math.sqrt(r * r + s * s + o * o);
                if (Math.abs(c) < a.EPSILON) return null;
                r *= c = 1 / c, s *= c, o *= c;
                var l = Math.sin(i), C = Math.cos(i), b = 1 - C, S = e.m;
                u = S[0], h = S[1], _ = S[2], f = S[3], d = S[4], p = S[5], m = S[6], v = S[7], 
                y = S[8], g = S[9], x = S[10], A = S[11];
                var T = r * r * b + C, w = s * r * b + o * l, E = o * r * b - s * l, B = r * s * b - o * l, M = s * s * b + C, R = o * s * b + r * l, P = r * o * b + s * l, I = s * o * b - r * l, D = o * o * b + C, V = t.m;
                return V[0] = u * T + d * w + y * E, V[1] = h * T + p * w + g * E, V[2] = _ * T + m * w + x * E, 
                V[3] = f * T + v * w + A * E, V[4] = u * B + d * M + y * R, V[5] = h * B + p * M + g * R, 
                V[6] = _ * B + m * M + x * R, V[7] = f * B + v * M + A * R, V[8] = u * P + d * I + y * D, 
                V[9] = h * P + p * I + g * D, V[10] = _ * P + m * I + x * D, V[11] = f * P + v * I + A * D, 
                e !== t && (V[12] = S[12], V[13] = S[13], V[14] = S[14], V[15] = S[15]), t;
            }, r.rotateX = function(t, e, i) {
                var n = t.m, r = e.m, s = Math.sin(i), o = Math.cos(i), a = r[4], c = r[5], l = r[6], u = r[7], h = r[8], _ = r[9], f = r[10], d = r[11];
                return e !== t && (n[0] = r[0], n[1] = r[1], n[2] = r[2], n[3] = r[3], n[12] = r[12], 
                n[13] = r[13], n[14] = r[14], n[15] = r[15]), n[4] = a * o + h * s, n[5] = c * o + _ * s, 
                n[6] = l * o + f * s, n[7] = u * o + d * s, n[8] = h * o - a * s, n[9] = _ * o - c * s, 
                n[10] = f * o - l * s, n[11] = d * o - u * s, t;
            }, r.rotateY = function(t, e, i) {
                var n = t.m, r = e.m, s = Math.sin(i), o = Math.cos(i), a = r[0], c = r[1], l = r[2], u = r[3], h = r[8], _ = r[9], f = r[10], d = r[11];
                return e !== t && (n[4] = r[4], n[5] = r[5], n[6] = r[6], n[7] = r[7], n[12] = r[12], 
                n[13] = r[13], n[14] = r[14], n[15] = r[15]), n[0] = a * o - h * s, n[1] = c * o - _ * s, 
                n[2] = l * o - f * s, n[3] = u * o - d * s, n[8] = a * s + h * o, n[9] = c * s + _ * o, 
                n[10] = l * s + f * o, n[11] = u * s + d * o, t;
            }, r.rotateZ = function(t, e, i) {
                var n = e.m, r = t.m, s = Math.sin(i), o = Math.cos(i), a = e.m[0], c = e.m[1], l = e.m[2], u = e.m[3], h = e.m[4], _ = e.m[5], f = e.m[6], d = e.m[7];
                return e !== t && (r[8] = n[8], r[9] = n[9], r[10] = n[10], r[11] = n[11], r[12] = n[12], 
                r[13] = n[13], r[14] = n[14], r[15] = n[15]), r[0] = a * o + h * s, r[1] = c * o + _ * s, 
                r[2] = l * o + f * s, r[3] = u * o + d * s, r[4] = h * o - a * s, r[5] = _ * o - c * s, 
                r[6] = f * o - l * s, r[7] = d * o - u * s, t;
            }, r.fromTranslation = function(t, e) {
                var i = t.m;
                return i[0] = 1, i[1] = 0, i[2] = 0, i[3] = 0, i[4] = 0, i[5] = 1, i[6] = 0, i[7] = 0, 
                i[8] = 0, i[9] = 0, i[10] = 1, i[11] = 0, i[12] = e.x, i[13] = e.y, i[14] = e.z, 
                i[15] = 1, t;
            }, r.fromScaling = function(t, e) {
                var i = t.m;
                return i[0] = e.x, i[1] = 0, i[2] = 0, i[3] = 0, i[4] = 0, i[5] = e.y, i[6] = 0, 
                i[7] = 0, i[8] = 0, i[9] = 0, i[10] = e.z, i[11] = 0, i[12] = 0, i[13] = 0, i[14] = 0, 
                i[15] = 1, t;
            }, r.fromRotation = function(t, e, i) {
                var n = i.x, r = i.y, s = i.z, o = Math.sqrt(n * n + r * r + s * s);
                if (Math.abs(o) < a.EPSILON) return null;
                n *= o = 1 / o, r *= o, s *= o;
                var c = Math.sin(e), l = Math.cos(e), u = 1 - l, h = t.m;
                return h[0] = n * n * u + l, h[1] = r * n * u + s * c, h[2] = s * n * u - r * c, 
                h[3] = 0, h[4] = n * r * u - s * c, h[5] = r * r * u + l, h[6] = s * r * u + n * c, 
                h[7] = 0, h[8] = n * s * u + r * c, h[9] = r * s * u - n * c, h[10] = s * s * u + l, 
                h[11] = 0, h[12] = 0, h[13] = 0, h[14] = 0, h[15] = 1, t;
            }, r.fromXRotation = function(t, e) {
                var i = Math.sin(e), n = Math.cos(e), r = t.m;
                return r[0] = 1, r[1] = 0, r[2] = 0, r[3] = 0, r[4] = 0, r[5] = n, r[6] = i, r[7] = 0, 
                r[8] = 0, r[9] = -i, r[10] = n, r[11] = 0, r[12] = 0, r[13] = 0, r[14] = 0, r[15] = 1, 
                t;
            }, r.fromYRotation = function(t, e) {
                var i = Math.sin(e), n = Math.cos(e), r = t.m;
                return r[0] = n, r[1] = 0, r[2] = -i, r[3] = 0, r[4] = 0, r[5] = 1, r[6] = 0, r[7] = 0, 
                r[8] = i, r[9] = 0, r[10] = n, r[11] = 0, r[12] = 0, r[13] = 0, r[14] = 0, r[15] = 1, 
                t;
            }, r.fromZRotation = function(t, e) {
                var i = Math.sin(e), n = Math.cos(e), r = t.m;
                return r[0] = n, r[1] = i, r[2] = 0, r[3] = 0, r[4] = -i, r[5] = n, r[6] = 0, r[7] = 0, 
                r[8] = 0, r[9] = 0, r[10] = 1, r[11] = 0, r[12] = 0, r[13] = 0, r[14] = 0, r[15] = 1, 
                t;
            }, r.fromRT = function(t, e, i) {
                var n = e.x, r = e.y, s = e.z, o = e.w, a = n + n, c = r + r, l = s + s, u = n * a, h = n * c, _ = n * l, f = r * c, d = r * l, p = s * l, m = o * a, v = o * c, y = o * l, g = t.m;
                return g[0] = 1 - (f + p), g[1] = h + y, g[2] = _ - v, g[3] = 0, g[4] = h - y, g[5] = 1 - (u + p), 
                g[6] = d + m, g[7] = 0, g[8] = _ + v, g[9] = d - m, g[10] = 1 - (u + f), g[11] = 0, 
                g[12] = i.x, g[13] = i.y, g[14] = i.z, g[15] = 1, t;
            }, r.getTranslation = function(t, e) {
                var i = e.m;
                return t.x = i[12], t.y = i[13], t.z = i[14], t;
            }, r.getScaling = function(t, e) {
                var i = e.m, n = B.m, r = n[0] = i[0], s = n[1] = i[1], o = n[2] = i[2], a = n[3] = i[4], l = n[4] = i[5], u = n[5] = i[6], h = n[6] = i[8], _ = n[7] = i[9], f = n[8] = i[10];
                return t.x = Math.sqrt(r * r + s * s + o * o), t.y = Math.sqrt(a * a + l * l + u * u), 
                t.z = Math.sqrt(h * h + _ * _ + f * f), c.default.determinant(B) < 0 && (t.x *= -1), 
                t;
            }, r.getRotation = function(t, e) {
                var i = e.m, n = i[0] + i[5] + i[10], r = 0;
                return n > 0 ? (r = 2 * Math.sqrt(n + 1), t.w = .25 * r, t.x = (i[6] - i[9]) / r, 
                t.y = (i[8] - i[2]) / r, t.z = (i[1] - i[4]) / r) : i[0] > i[5] && i[0] > i[10] ? (r = 2 * Math.sqrt(1 + i[0] - i[5] - i[10]), 
                t.w = (i[6] - i[9]) / r, t.x = .25 * r, t.y = (i[1] + i[4]) / r, t.z = (i[8] + i[2]) / r) : i[5] > i[10] ? (r = 2 * Math.sqrt(1 + i[5] - i[0] - i[10]), 
                t.w = (i[8] - i[2]) / r, t.x = (i[1] + i[4]) / r, t.y = .25 * r, t.z = (i[6] + i[9]) / r) : (r = 2 * Math.sqrt(1 + i[10] - i[0] - i[5]), 
                t.w = (i[1] - i[4]) / r, t.x = (i[8] + i[2]) / r, t.y = (i[6] + i[9]) / r, t.z = .25 * r), 
                t;
            }, r.toRTS = function(t, e, i, n) {
                var r = t.m, a = B.m;
                n.x = s.default.set(E, r[0], r[1], r[2]).mag(), a[0] = r[0] / n.x, a[1] = r[1] / n.x, 
                a[2] = r[2] / n.x, n.y = s.default.set(E, r[4], r[5], r[6]).mag(), a[3] = r[4] / n.y, 
                a[4] = r[5] / n.y, a[5] = r[6] / n.y, n.z = s.default.set(E, r[8], r[9], r[10]).mag(), 
                a[6] = r[8] / n.z, a[7] = r[9] / n.z, a[8] = r[10] / n.z, c.default.determinant(B) < 0 && (n.x *= -1, 
                a[0] *= -1, a[1] *= -1, a[2] *= -1), o.default.fromMat3(e, B), s.default.set(i, r[12], r[13], r[14]);
            }, r.fromRTS = function(t, e, i, n) {
                var r = e.x, s = e.y, o = e.z, a = e.w, c = r + r, l = s + s, u = o + o, h = r * c, _ = r * l, f = r * u, d = s * l, p = s * u, m = o * u, v = a * c, y = a * l, g = a * u, x = n.x, A = n.y, C = n.z, b = t.m;
                return b[0] = (1 - (d + m)) * x, b[1] = (_ + g) * x, b[2] = (f - y) * x, b[3] = 0, 
                b[4] = (_ - g) * A, b[5] = (1 - (h + m)) * A, b[6] = (p + v) * A, b[7] = 0, b[8] = (f + y) * C, 
                b[9] = (p - v) * C, b[10] = (1 - (h + d)) * C, b[11] = 0, b[12] = i.x, b[13] = i.y, 
                b[14] = i.z, b[15] = 1, t;
            }, r.fromRTSOrigin = function(t, e, i, n, r) {
                var s = e.x, o = e.y, a = e.z, c = e.w, l = s + s, u = o + o, h = a + a, _ = s * l, f = s * u, d = s * h, p = o * u, m = o * h, v = a * h, y = c * l, g = c * u, x = c * h, A = n.x, C = n.y, b = n.z, S = r.x, T = r.y, w = r.z, E = t.m;
                return E[0] = (1 - (p + v)) * A, E[1] = (f + x) * A, E[2] = (d - g) * A, E[3] = 0, 
                E[4] = (f - x) * C, E[5] = (1 - (_ + v)) * C, E[6] = (m + y) * C, E[7] = 0, E[8] = (d + g) * b, 
                E[9] = (m - y) * b, E[10] = (1 - (_ + p)) * b, E[11] = 0, E[12] = i.x + S - (E[0] * S + E[4] * T + E[8] * w), 
                E[13] = i.y + T - (E[1] * S + E[5] * T + E[9] * w), E[14] = i.z + w - (E[2] * S + E[6] * T + E[10] * w), 
                E[15] = 1, t;
            }, r.fromQuat = function(t, e) {
                var i = e.x, n = e.y, r = e.z, s = e.w, o = i + i, a = n + n, c = r + r, l = i * o, u = n * o, h = n * a, _ = r * o, f = r * a, d = r * c, p = s * o, m = s * a, v = s * c, y = t.m;
                return y[0] = 1 - h - d, y[1] = u + v, y[2] = _ - m, y[3] = 0, y[4] = u - v, y[5] = 1 - l - d, 
                y[6] = f + p, y[7] = 0, y[8] = _ + m, y[9] = f - p, y[10] = 1 - l - h, y[11] = 0, 
                y[12] = 0, y[13] = 0, y[14] = 0, y[15] = 1, t;
            }, r.frustum = function(t, e, i, n, r, s, o) {
                var a = 1 / (i - e), c = 1 / (r - n), l = 1 / (s - o), u = t.m;
                return u[0] = 2 * s * a, u[1] = 0, u[2] = 0, u[3] = 0, u[4] = 0, u[5] = 2 * s * c, 
                u[6] = 0, u[7] = 0, u[8] = (i + e) * a, u[9] = (r + n) * c, u[10] = (o + s) * l, 
                u[11] = -1, u[12] = 0, u[13] = 0, u[14] = o * s * 2 * l, u[15] = 0, t;
            }, r.perspective = function(t, e, i, n, r) {
                var s = 1 / Math.tan(e / 2), o = 1 / (n - r), a = t.m;
                return a[0] = s / i, a[1] = 0, a[2] = 0, a[3] = 0, a[4] = 0, a[5] = s, a[6] = 0, 
                a[7] = 0, a[8] = 0, a[9] = 0, a[10] = (r + n) * o, a[11] = -1, a[12] = 0, a[13] = 0, 
                a[14] = 2 * r * n * o, a[15] = 0, t;
            }, r.ortho = function(t, e, i, n, r, s, o) {
                var a = 1 / (e - i), c = 1 / (n - r), l = 1 / (s - o), u = t.m;
                return u[0] = -2 * a, u[1] = 0, u[2] = 0, u[3] = 0, u[4] = 0, u[5] = -2 * c, u[6] = 0, 
                u[7] = 0, u[8] = 0, u[9] = 0, u[10] = 2 * l, u[11] = 0, u[12] = (e + i) * a, u[13] = (r + n) * c, 
                u[14] = (o + s) * l, u[15] = 1, t;
            }, r.lookAt = function(t, e, i, n) {
                var r = e.x, s = e.y, o = e.z, a = n.x, c = n.y, l = n.z, u = r - i.x, h = s - i.y, _ = o - i.z, f = 1 / Math.sqrt(u * u + h * h + _ * _), d = c * (_ *= f) - l * (h *= f), p = l * (u *= f) - a * _, m = a * h - c * u, v = h * (m *= f = 1 / Math.sqrt(d * d + p * p + m * m)) - _ * (p *= f), y = _ * (d *= f) - u * m, g = u * p - h * d, x = t.m;
                return x[0] = d, x[1] = v, x[2] = u, x[3] = 0, x[4] = p, x[5] = y, x[6] = h, x[7] = 0, 
                x[8] = m, x[9] = g, x[10] = _, x[11] = 0, x[12] = -(d * r + p * s + m * o), x[13] = -(v * r + y * s + g * o), 
                x[14] = -(u * r + h * s + _ * o), x[15] = 1, t;
            }, r.inverseTranspose = function(t, e) {
                var i = e.m;
                u = i[0], h = i[1], _ = i[2], f = i[3], d = i[4], p = i[5], m = i[6], v = i[7], 
                y = i[8], g = i[9], x = i[10], A = i[11], C = i[12], b = i[13], S = i[14], T = i[15];
                var n = u * p - h * d, r = u * m - _ * d, s = u * v - f * d, o = h * m - _ * p, a = h * v - f * p, c = _ * v - f * m, l = y * b - g * C, w = y * S - x * C, E = y * T - A * C, B = g * S - x * b, M = g * T - A * b, R = x * T - A * S, P = n * R - r * M + s * B + o * E - a * w + c * l;
                return P ? (P = 1 / P, (i = t.m)[0] = (p * R - m * M + v * B) * P, i[1] = (m * E - d * R - v * w) * P, 
                i[2] = (d * M - p * E + v * l) * P, i[3] = 0, i[4] = (_ * M - h * R - f * B) * P, 
                i[5] = (u * R - _ * E + f * w) * P, i[6] = (h * E - u * M - f * l) * P, i[7] = 0, 
                i[8] = (b * c - S * a + T * o) * P, i[9] = (S * s - C * c - T * r) * P, i[10] = (C * a - b * s + T * n) * P, 
                i[11] = 0, i[12] = 0, i[13] = 0, i[14] = 0, i[15] = 1, t) : null;
            }, r.add = function(t, e, i) {
                var n = t.m, r = e.m, s = i.m;
                return n[0] = r[0] + s[0], n[1] = r[1] + s[1], n[2] = r[2] + s[2], n[3] = r[3] + s[3], 
                n[4] = r[4] + s[4], n[5] = r[5] + s[5], n[6] = r[6] + s[6], n[7] = r[7] + s[7], 
                n[8] = r[8] + s[8], n[9] = r[9] + s[9], n[10] = r[10] + s[10], n[11] = r[11] + s[11], 
                n[12] = r[12] + s[12], n[13] = r[13] + s[13], n[14] = r[14] + s[14], n[15] = r[15] + s[15], 
                t;
            }, r.subtract = function(t, e, i) {
                var n = t.m, r = e.m, s = i.m;
                return n[0] = r[0] - s[0], n[1] = r[1] - s[1], n[2] = r[2] - s[2], n[3] = r[3] - s[3], 
                n[4] = r[4] - s[4], n[5] = r[5] - s[5], n[6] = r[6] - s[6], n[7] = r[7] - s[7], 
                n[8] = r[8] - s[8], n[9] = r[9] - s[9], n[10] = r[10] - s[10], n[11] = r[11] - s[11], 
                n[12] = r[12] - s[12], n[13] = r[13] - s[13], n[14] = r[14] - s[14], n[15] = r[15] - s[15], 
                t;
            }, r.multiplyScalar = function(t, e, i) {
                var n = t.m, r = e.m;
                return n[0] = r[0] * i, n[1] = r[1] * i, n[2] = r[2] * i, n[3] = r[3] * i, n[4] = r[4] * i, 
                n[5] = r[5] * i, n[6] = r[6] * i, n[7] = r[7] * i, n[8] = r[8] * i, n[9] = r[9] * i, 
                n[10] = r[10] * i, n[11] = r[11] * i, n[12] = r[12] * i, n[13] = r[13] * i, n[14] = r[14] * i, 
                n[15] = r[15] * i, t;
            }, r.multiplyScalarAndAdd = function(t, e, i, n) {
                var r = t.m, s = e.m, o = i.m;
                return r[0] = s[0] + o[0] * n, r[1] = s[1] + o[1] * n, r[2] = s[2] + o[2] * n, r[3] = s[3] + o[3] * n, 
                r[4] = s[4] + o[4] * n, r[5] = s[5] + o[5] * n, r[6] = s[6] + o[6] * n, r[7] = s[7] + o[7] * n, 
                r[8] = s[8] + o[8] * n, r[9] = s[9] + o[9] * n, r[10] = s[10] + o[10] * n, r[11] = s[11] + o[11] * n, 
                r[12] = s[12] + o[12] * n, r[13] = s[13] + o[13] * n, r[14] = s[14] + o[14] * n, 
                r[15] = s[15] + o[15] * n, t;
            }, r.strictEquals = function(t, e) {
                var i = t.m, n = e.m;
                return i[0] === n[0] && i[1] === n[1] && i[2] === n[2] && i[3] === n[3] && i[4] === n[4] && i[5] === n[5] && i[6] === n[6] && i[7] === n[7] && i[8] === n[8] && i[9] === n[9] && i[10] === n[10] && i[11] === n[11] && i[12] === n[12] && i[13] === n[13] && i[14] === n[14] && i[15] === n[15];
            }, r.equals = function(t, e, i) {
                void 0 === i && (i = a.EPSILON);
                var n = t.m, r = e.m;
                return Math.abs(n[0] - r[0]) <= i * Math.max(1, Math.abs(n[0]), Math.abs(r[0])) && Math.abs(n[1] - r[1]) <= i * Math.max(1, Math.abs(n[1]), Math.abs(r[1])) && Math.abs(n[2] - r[2]) <= i * Math.max(1, Math.abs(n[2]), Math.abs(r[2])) && Math.abs(n[3] - r[3]) <= i * Math.max(1, Math.abs(n[3]), Math.abs(r[3])) && Math.abs(n[4] - r[4]) <= i * Math.max(1, Math.abs(n[4]), Math.abs(r[4])) && Math.abs(n[5] - r[5]) <= i * Math.max(1, Math.abs(n[5]), Math.abs(r[5])) && Math.abs(n[6] - r[6]) <= i * Math.max(1, Math.abs(n[6]), Math.abs(r[6])) && Math.abs(n[7] - r[7]) <= i * Math.max(1, Math.abs(n[7]), Math.abs(r[7])) && Math.abs(n[8] - r[8]) <= i * Math.max(1, Math.abs(n[8]), Math.abs(r[8])) && Math.abs(n[9] - r[9]) <= i * Math.max(1, Math.abs(n[9]), Math.abs(r[9])) && Math.abs(n[10] - r[10]) <= i * Math.max(1, Math.abs(n[10]), Math.abs(r[10])) && Math.abs(n[11] - r[11]) <= i * Math.max(1, Math.abs(n[11]), Math.abs(r[11])) && Math.abs(n[12] - r[12]) <= i * Math.max(1, Math.abs(n[12]), Math.abs(r[12])) && Math.abs(n[13] - r[13]) <= i * Math.max(1, Math.abs(n[13]), Math.abs(r[13])) && Math.abs(n[14] - r[14]) <= i * Math.max(1, Math.abs(n[14]), Math.abs(r[14])) && Math.abs(n[15] - r[15]) <= i * Math.max(1, Math.abs(n[15]), Math.abs(r[15]));
            }, r.adjoint = function(t, e) {
                var i = e.m, n = t.m, r = i[0], s = i[1], o = i[2], a = i[3], c = i[4], l = i[5], u = i[6], h = i[7], _ = i[8], f = i[9], d = i[10], p = i[11], m = i[12], v = i[13], y = i[14], g = i[15];
                return n[0] = l * (d * g - p * y) - f * (u * g - h * y) + v * (u * p - h * d), n[1] = -(s * (d * g - p * y) - f * (o * g - a * y) + v * (o * p - a * d)), 
                n[2] = s * (u * g - h * y) - l * (o * g - a * y) + v * (o * h - a * u), n[3] = -(s * (u * p - h * d) - l * (o * p - a * d) + f * (o * h - a * u)), 
                n[4] = -(c * (d * g - p * y) - _ * (u * g - h * y) + m * (u * p - h * d)), n[5] = r * (d * g - p * y) - _ * (o * g - a * y) + m * (o * p - a * d), 
                n[6] = -(r * (u * g - h * y) - c * (o * g - a * y) + m * (o * h - a * u)), n[7] = r * (u * p - h * d) - c * (o * p - a * d) + _ * (o * h - a * u), 
                n[8] = c * (f * g - p * v) - _ * (l * g - h * v) + m * (l * p - h * f), n[9] = -(r * (f * g - p * v) - _ * (s * g - a * v) + m * (s * p - a * f)), 
                n[10] = r * (l * g - h * v) - c * (s * g - a * v) + m * (s * h - a * l), n[11] = -(r * (l * p - h * f) - c * (s * p - a * f) + _ * (s * h - a * l)), 
                n[12] = -(c * (f * y - d * v) - _ * (l * y - u * v) + m * (l * d - u * f)), n[13] = r * (f * y - d * v) - _ * (s * y - o * v) + m * (s * d - o * f), 
                n[14] = -(r * (l * y - u * v) - c * (s * y - o * v) + m * (s * u - o * l)), n[15] = r * (l * d - u * f) - c * (s * d - o * f) + _ * (s * u - o * l), 
                t;
            }, r.toArray = function(t, e, i) {
                void 0 === i && (i = 0);
                for (var n = e.m, r = 0; r < 16; r++) t[i + r] = n[r];
                return t;
            }, r.fromArray = function(t, e, i) {
                void 0 === i && (i = 0);
                for (var n = t.m, r = 0; r < 16; r++) n[r] = e[i + r];
                return t;
            }, n.clone = function() {
                var t = this.m;
                return new r(t[0], t[1], t[2], t[3], t[4], t[5], t[6], t[7], t[8], t[9], t[10], t[11], t[12], t[13], t[14], t[15]);
            }, n.set = function(t) {
                var e = this.m, i = t.m;
                return e[0] = i[0], e[1] = i[1], e[2] = i[2], e[3] = i[3], e[4] = i[4], e[5] = i[5], 
                e[6] = i[6], e[7] = i[7], e[8] = i[8], e[9] = i[9], e[10] = i[10], e[11] = i[11], 
                e[12] = i[12], e[13] = i[13], e[14] = i[14], e[15] = i[15], this;
            }, n.equals = function(t) {
                return r.strictEquals(this, t);
            }, n.fuzzyEquals = function(t) {
                return r.equals(this, t);
            }, n.toString = function() {
                var t = this.m;
                return t ? "[\n" + t[0] + ", " + t[1] + ", " + t[2] + ", " + t[3] + ",\n" + t[4] + ", " + t[5] + ", " + t[6] + ", " + t[7] + ",\n" + t[8] + ", " + t[9] + ", " + t[10] + ", " + t[11] + ",\n" + t[12] + ", " + t[13] + ", " + t[14] + ", " + t[15] + "\n]" : "[\n1, 0, 0, 0\n0, 1, 0, 0\n0, 0, 1, 0\n0, 0, 0, 1\n]";
            }, n.identity = function() {
                return r.identity(this);
            }, n.transpose = function(t) {
                return t = t || new r(), r.transpose(t, this);
            }, n.invert = function(t) {
                return t = t || new r(), r.invert(t, this);
            }, n.adjoint = function(t) {
                return t = t || new r(), r.adjoint(t, this);
            }, n.determinant = function() {
                return r.determinant(this);
            }, n.add = function(t, e) {
                return e = e || new r(), r.add(e, this, t);
            }, n.subtract = function(t) {
                return r.subtract(this, this, t);
            }, n.multiply = function(t) {
                return r.multiply(this, this, t);
            }, n.multiplyScalar = function(t) {
                return r.multiplyScalar(this, this, t);
            }, n.translate = function(t, e) {
                return e = e || new r(), r.translate(e, this, t);
            }, n.scale = function(t, e) {
                return e = e || new r(), r.scale(e, this, t);
            }, n.rotate = function(t, e, i) {
                return i = i || new r(), r.rotate(i, this, t, e);
            }, n.getTranslation = function(t) {
                return t = t || new s.default(), r.getTranslation(t, this);
            }, n.getScale = function(t) {
                return t = t || new s.default(), r.getScaling(t, this);
            }, n.getRotation = function(t) {
                return t = t || new o.default(), r.getRotation(t, this);
            }, n.fromRTS = function(t, e, i) {
                return r.fromRTS(this, t, e, i);
            }, n.fromQuat = function(t) {
                return r.fromQuat(this, t);
            }, r;
        }(n.default);
        i.default = w, w.mul = w.multiply, w.sub = w.subtract, w.IDENTITY = Object.freeze(new w());
        var E = new s.default(), B = new c.default();
        r.default.fastDefine("cc.Mat4", w, {
            m00: 1,
            m01: 0,
            m02: 0,
            m03: 0,
            m04: 0,
            m05: 1,
            m06: 0,
            m07: 0,
            m08: 0,
            m09: 0,
            m10: 1,
            m11: 0,
            m12: 0,
            m13: 0,
            m14: 0,
            m15: 1
        });
        for (var M = function(t) {
            Object.defineProperty(w.prototype, "m" + t, {
                get: function() {
                    return this.m[t];
                },
                set: function(e) {
                    this.m[t] = e;
                }
            });
        }, R = 0; R < 16; R++) M(R);
        cc.mat4 = function(t, e, i, n, r, s, o, a, c, l, u, h, _, f, d, p) {
            var m = new w(t, e, i, n, r, s, o, a, c, l, u, h, _, f, d, p);
            return void 0 === t && w.identity(m), m;
        }, cc.Mat4 = w, e.exports = i.default;
    }, {
        "../platform/CCClass": 182,
        "./mat3": 272,
        "./quat": 274,
        "./utils": 278,
        "./value-type": 279,
        "./vec3": 281
    } ],
    274: [ function(t, e, i) {
        "use strict";
        i.__esModule = !0, i.default = void 0;
        var n = c(t("./value-type")), r = c(t("../platform/CCClass")), s = c(t("./vec3")), o = c(t("./mat3")), a = t("./utils");
        function c(t) {
            return t && t.__esModule ? t : {
                default: t
            };
        }
        var l = 0, u = 0, h = 0, _ = 0, f = function(t) {
            var e, i;
            i = t, (e = r).prototype = Object.create(i.prototype), e.prototype.constructor = e, 
            e.__proto__ = i;
            var n = r.prototype;
            function r(e, i, n, r) {
                var s;
                return void 0 === e && (e = 0), void 0 === i && (i = 0), void 0 === n && (n = 0), 
                void 0 === r && (r = 1), (s = t.call(this) || this).x = void 0, s.y = void 0, s.z = void 0, 
                s.w = void 0, e && "object" == typeof e ? (s.x = e.x, s.y = e.y, s.z = e.z, s.w = e.w) : (s.x = e, 
                s.y = i, s.z = n, s.w = r), s;
            }
            return n.mul = function(t, e) {
                return r.multiply(e || new r(), this, t);
            }, r.clone = function(t) {
                return new r(t.x, t.y, t.z, t.w);
            }, r.copy = function(t, e) {
                return t.x = e.x, t.y = e.y, t.z = e.z, t.w = e.w, t;
            }, r.set = function(t, e, i, n, r) {
                return t.x = e, t.y = i, t.z = n, t.w = r, t;
            }, r.identity = function(t) {
                return t.x = 0, t.y = 0, t.z = 0, t.w = 1, t;
            }, r.rotationTo = function(t, e, i) {
                var n = s.default.dot(e, i);
                return n < -.999999 ? (s.default.cross(m, s.default.RIGHT, e), m.mag() < 1e-6 && s.default.cross(m, s.default.UP, e), 
                s.default.normalize(m, m), r.fromAxisAngle(t, m, Math.PI), t) : n > .999999 ? (t.x = 0, 
                t.y = 0, t.z = 0, t.w = 1, t) : (s.default.cross(m, e, i), t.x = m.x, t.y = m.y, 
                t.z = m.z, t.w = 1 + n, r.normalize(t, t));
            }, r.getAxisAngle = function(t, e) {
                var i = 2 * Math.acos(e.w), n = Math.sin(i / 2);
                return 0 !== n ? (t.x = e.x / n, t.y = e.y / n, t.z = e.z / n) : (t.x = 1, t.y = 0, 
                t.z = 0), i;
            }, r.multiply = function(t, e, i) {
                return l = e.x * i.w + e.w * i.x + e.y * i.z - e.z * i.y, u = e.y * i.w + e.w * i.y + e.z * i.x - e.x * i.z, 
                h = e.z * i.w + e.w * i.z + e.x * i.y - e.y * i.x, _ = e.w * i.w - e.x * i.x - e.y * i.y - e.z * i.z, 
                t.x = l, t.y = u, t.z = h, t.w = _, t;
            }, r.multiplyScalar = function(t, e, i) {
                return t.x = e.x * i, t.y = e.y * i, t.z = e.z * i, t.w = e.w * i, t;
            }, r.scaleAndAdd = function(t, e, i, n) {
                return t.x = e.x + i.x * n, t.y = e.y + i.y * n, t.z = e.z + i.z * n, t.w = e.w + i.w * n, 
                t;
            }, r.rotateX = function(t, e, i) {
                i *= .5;
                var n = Math.sin(i), r = Math.cos(i);
                return l = e.x * r + e.w * n, u = e.y * r + e.z * n, h = e.z * r - e.y * n, _ = e.w * r - e.x * n, 
                t.x = l, t.y = u, t.z = h, t.w = _, t;
            }, r.rotateY = function(t, e, i) {
                i *= .5;
                var n = Math.sin(i), r = Math.cos(i);
                return l = e.x * r - e.z * n, u = e.y * r + e.w * n, h = e.z * r + e.x * n, _ = e.w * r - e.y * n, 
                t.x = l, t.y = u, t.z = h, t.w = _, t;
            }, r.rotateZ = function(t, e, i) {
                i *= .5;
                var n = Math.sin(i), r = Math.cos(i);
                return l = e.x * r + e.y * n, u = e.y * r - e.x * n, h = e.z * r + e.w * n, _ = e.w * r - e.z * n, 
                t.x = l, t.y = u, t.z = h, t.w = _, t;
            }, r.rotateAround = function(t, e, i, n) {
                return r.invert(d, e), s.default.transformQuat(m, i, d), r.fromAxisAngle(d, m, n), 
                r.multiply(t, e, d), t;
            }, r.rotateAroundLocal = function(t, e, i, n) {
                return r.fromAxisAngle(d, i, n), r.multiply(t, e, d), t;
            }, r.calculateW = function(t, e) {
                return t.x = e.x, t.y = e.y, t.z = e.z, t.w = Math.sqrt(Math.abs(1 - e.x * e.x - e.y * e.y - e.z * e.z)), 
                t;
            }, r.dot = function(t, e) {
                return t.x * e.x + t.y * e.y + t.z * e.z + t.w * e.w;
            }, r.lerp = function(t, e, i, n) {
                return t.x = e.x + n * (i.x - e.x), t.y = e.y + n * (i.y - e.y), t.z = e.z + n * (i.z - e.z), 
                t.w = e.w + n * (i.w - e.w), t;
            }, r.slerp = function(t, e, i, n) {
                var r = 0, s = 0, o = e.x * i.x + e.y * i.y + e.z * i.z + e.w * i.w;
                if (o < 0 && (o = -o, i.x = -i.x, i.y = -i.y, i.z = -i.z, i.w = -i.w), 1 - o > 1e-6) {
                    var a = Math.acos(o), c = Math.sin(a);
                    r = Math.sin((1 - n) * a) / c, s = Math.sin(n * a) / c;
                } else r = 1 - n, s = n;
                return t.x = r * e.x + s * i.x, t.y = r * e.y + s * i.y, t.z = r * e.z + s * i.z, 
                t.w = r * e.w + s * i.w, t;
            }, r.sqlerp = function(t, e, i, n, s, o) {
                return r.slerp(d, e, s, o), r.slerp(p, i, n, o), r.slerp(t, d, p, 2 * o * (1 - o)), 
                t;
            }, r.invert = function(t, e) {
                var i = e.x * e.x + e.y * e.y + e.z * e.z + e.w * e.w, n = i ? 1 / i : 0;
                return t.x = -e.x * n, t.y = -e.y * n, t.z = -e.z * n, t.w = e.w * n, t;
            }, r.conjugate = function(t, e) {
                return t.x = -e.x, t.y = -e.y, t.z = -e.z, t.w = e.w, t;
            }, r.len = function(t) {
                return Math.sqrt(t.x * t.x + t.y * t.y + t.z * t.z + t.w * t.w);
            }, r.lengthSqr = function(t) {
                return t.x * t.x + t.y * t.y + t.z * t.z + t.w * t.w;
            }, r.normalize = function(t, e) {
                var i = e.x * e.x + e.y * e.y + e.z * e.z + e.w * e.w;
                return i > 0 && (i = 1 / Math.sqrt(i), t.x = e.x * i, t.y = e.y * i, t.z = e.z * i, 
                t.w = e.w * i), t;
            }, r.fromAxes = function(t, e, i, n) {
                return o.default.set(v, e.x, e.y, e.z, i.x, i.y, i.z, n.x, n.y, n.z), r.normalize(t, r.fromMat3(t, v));
            }, r.fromViewUp = function(t, e, i) {
                return o.default.fromViewUp(v, e, i), r.normalize(t, r.fromMat3(t, v));
            }, r.fromAxisAngle = function(t, e, i) {
                i *= .5;
                var n = Math.sin(i);
                return t.x = n * e.x, t.y = n * e.y, t.z = n * e.z, t.w = Math.cos(i), t;
            }, r.fromAngleZ = function(t, e) {
                return e *= y, t.x = t.y = 0, t.z = Math.sin(e), t.w = Math.cos(e), t;
            }, r.fromMat3 = function(t, e) {
                var i = e.m, n = i[0], r = i[1], s = i[2], o = i[3], a = i[4], c = i[5], l = i[6], u = i[7], h = i[8], _ = n + a + h;
                if (_ > 0) {
                    var f = .5 / Math.sqrt(_ + 1);
                    t.w = .25 / f, t.x = (c - u) * f, t.y = (l - s) * f, t.z = (r - o) * f;
                } else if (n > a && n > h) {
                    var d = 2 * Math.sqrt(1 + n - a - h);
                    t.w = (c - u) / d, t.x = .25 * d, t.y = (o + r) / d, t.z = (l + s) / d;
                } else if (a > h) {
                    var p = 2 * Math.sqrt(1 + a - n - h);
                    t.w = (l - s) / p, t.x = (o + r) / p, t.y = .25 * p, t.z = (u + c) / p;
                } else {
                    var m = 2 * Math.sqrt(1 + h - n - a);
                    t.w = (r - o) / m, t.x = (l + s) / m, t.y = (u + c) / m, t.z = .25 * m;
                }
                return t;
            }, r.fromEuler = function(t, e, i, n) {
                e *= y, i *= y, n *= y;
                var r = Math.sin(e), s = Math.cos(e), o = Math.sin(i), a = Math.cos(i), c = Math.sin(n), l = Math.cos(n);
                return t.x = r * a * l + s * o * c, t.y = s * o * l + r * a * c, t.z = s * a * c - r * o * l, 
                t.w = s * a * l - r * o * c, t;
            }, r.toAxisX = function(t, e) {
                var i = 2 * e.y, n = 2 * e.z;
                return t.x = 1 - i * e.y - n * e.z, t.y = i * e.x + n * e.w, t.z = n * e.x + i * e.w, 
                t;
            }, r.toAxisY = function(t, e) {
                var i = 2 * e.x, n = 2 * e.y, r = 2 * e.z;
                return t.x = n * e.x - r * e.w, t.y = 1 - i * e.x - r * e.z, t.z = r * e.y + i * e.w, 
                t;
            }, r.toAxisZ = function(t, e) {
                var i = 2 * e.x, n = 2 * e.y, r = 2 * e.z;
                return t.x = r * e.x - n * e.w, t.y = r * e.y - i * e.w, t.z = 1 - i * e.x - n * e.y, 
                t;
            }, r.toEuler = function(t, e, i) {
                var n = e.x, r = e.y, s = e.z, o = e.w, c = 0, l = 0, u = 0, h = n * r + s * o;
                if (h > .499999) c = 0, l = (0, a.toDegree)(2 * Math.atan2(n, o)), u = 90; else if (h < -.499999) c = 0, 
                l = -(0, a.toDegree)(2 * Math.atan2(n, o)), u = -90; else {
                    var _ = n * n, f = r * r, d = s * s;
                    c = (0, a.toDegree)(Math.atan2(2 * n * o - 2 * r * s, 1 - 2 * _ - 2 * d)), l = (0, 
                    a.toDegree)(Math.atan2(2 * r * o - 2 * n * s, 1 - 2 * f - 2 * d)), u = (0, a.toDegree)(Math.asin(2 * h)), 
                    i && (c = -180 * Math.sign(c + 1e-6) + c, l = -180 * Math.sign(l + 1e-6) + l, u = 180 * Math.sign(u + 1e-6) - u);
                }
                return t.x = c, t.y = l, t.z = u, t;
            }, r.strictEquals = function(t, e) {
                return t.x === e.x && t.y === e.y && t.z === e.z && t.w === e.w;
            }, r.equals = function(t, e, i) {
                return void 0 === i && (i = a.EPSILON), Math.abs(t.x - e.x) <= i * Math.max(1, Math.abs(t.x), Math.abs(e.x)) && Math.abs(t.y - e.y) <= i * Math.max(1, Math.abs(t.y), Math.abs(e.y)) && Math.abs(t.z - e.z) <= i * Math.max(1, Math.abs(t.z), Math.abs(e.z)) && Math.abs(t.w - e.w) <= i * Math.max(1, Math.abs(t.w), Math.abs(e.w));
            }, r.toArray = function(t, e, i) {
                return void 0 === i && (i = 0), t[i + 0] = e.x, t[i + 1] = e.y, t[i + 2] = e.z, 
                t[i + 3] = e.w, t;
            }, r.fromArray = function(t, e, i) {
                return void 0 === i && (i = 0), t.x = e[i + 0], t.y = e[i + 1], t.z = e[i + 2], 
                t.w = e[i + 3], t;
            }, n.clone = function() {
                return new r(this.x, this.y, this.z, this.w);
            }, n.set = function(t) {
                return this.x = t.x, this.y = t.y, this.z = t.z, this.w = t.w, this;
            }, n.equals = function(t) {
                return t && this.x === t.x && this.y === t.y && this.z === t.z && this.w === t.w;
            }, n.toEuler = function(t) {
                return r.toEuler(t, this);
            }, n.fromEuler = function(t) {
                return r.fromEuler(this, t.x, t.y, t.z);
            }, n.lerp = function(t, e, i) {
                return i = i || new r(), r.slerp(i, this, t, e), i;
            }, n.multiply = function(t) {
                return r.multiply(this, this, t);
            }, n.rotateAround = function(t, e, i, n) {
                return n = n || new r(), r.rotateAround(n, t, e, i);
            }, r;
        }(n.default);
        i.default = f, f.mul = f.multiply, f.scale = f.multiplyScalar, f.mag = f.len, f.IDENTITY = Object.freeze(new f());
        var d = new f(), p = new f(), m = new s.default(), v = new o.default(), y = .5 * Math.PI / 180;
        r.default.fastDefine("cc.Quat", f, {
            x: 0,
            y: 0,
            z: 0,
            w: 1
        }), cc.quat = function(t, e, i, n) {
            return new f(t, e, i, n);
        }, cc.Quat = f, e.exports = i.default;
    }, {
        "../platform/CCClass": 182,
        "./mat3": 272,
        "./utils": 278,
        "./value-type": 279,
        "./vec3": 281
    } ],
    275: [ function(t, e, i) {
        "use strict";
        i.__esModule = !0, i.default = void 0;
        var n = a(t("./value-type")), r = a(t("../platform/CCClass")), s = a(t("./vec2")), o = a(t("./size"));
        function a(t) {
            return t && t.__esModule ? t : {
                default: t
            };
        }
        function c(t, e) {
            for (var i = 0; i < e.length; i++) {
                var n = e[i];
                n.enumerable = n.enumerable || !1, n.configurable = !0, "value" in n && (n.writable = !0), 
                Object.defineProperty(t, n.key, n);
            }
        }
        var l = function(t) {
            var e, i;
            function n(e, i, n, r) {
                var s;
                return void 0 === e && (e = 0), void 0 === i && (i = 0), void 0 === n && (n = 0), 
                void 0 === r && (r = 0), (s = t.call(this) || this).x = void 0, s.y = void 0, s.width = void 0, 
                s.height = void 0, e && "object" == typeof e && (i = e.y, n = e.width, r = e.height, 
                e = e.x), s.x = e || 0, s.y = i || 0, s.width = n || 0, s.height = r || 0, s;
            }
            i = t, (e = n).prototype = Object.create(i.prototype), e.prototype.constructor = e, 
            e.__proto__ = i, n.fromMinMax = function(t, e) {
                var i = Math.min(t.x, e.x), r = Math.min(t.y, e.y);
                return new n(i, r, Math.max(t.x, e.x) - i, Math.max(t.y, e.y) - r);
            };
            var r, a, l = n.prototype;
            return l.clone = function() {
                return new n(this.x, this.y, this.width, this.height);
            }, l.equals = function(t) {
                return t && this.x === t.x && this.y === t.y && this.width === t.width && this.height === t.height;
            }, l.lerp = function(t, e, i) {
                i = i || new n();
                var r = this.x, s = this.y, o = this.width, a = this.height;
                return i.x = r + (t.x - r) * e, i.y = s + (t.y - s) * e, i.width = o + (t.width - o) * e, 
                i.height = a + (t.height - a) * e, i;
            }, l.set = function(t) {
                return this.x = t.x, this.y = t.y, this.width = t.width, this.height = t.height, 
                this;
            }, l.intersects = function(t) {
                var e = this.x + this.width, i = this.y + this.height, n = t.x + t.width, r = t.y + t.height;
                return !(e < t.x || n < this.x || i < t.y || r < this.y);
            }, l.intersection = function(t, e) {
                var i = this.x, n = this.y, r = this.x + this.width, s = this.y + this.height, o = e.x, a = e.y, c = e.x + e.width, l = e.y + e.height;
                return t.x = Math.max(i, o), t.y = Math.max(n, a), t.width = Math.min(r, c) - t.x, 
                t.height = Math.min(s, l) - t.y, t;
            }, l.contains = function(t) {
                return this.x <= t.x && this.x + this.width >= t.x && this.y <= t.y && this.y + this.height >= t.y;
            }, l.containsRect = function(t) {
                return this.x <= t.x && this.x + this.width >= t.x + t.width && this.y <= t.y && this.y + this.height >= t.y + t.height;
            }, l.union = function(t, e) {
                var i = this.x, n = this.y, r = this.width, s = this.height, o = e.x, a = e.y, c = e.width, l = e.height;
                return t.x = Math.min(i, o), t.y = Math.min(n, a), t.width = Math.max(i + r, o + c) - t.x, 
                t.height = Math.max(n + s, a + l) - t.y, t;
            }, l.transformMat4 = function(t, e) {
                var i = this.x, n = this.y, r = i + this.width, s = n + this.height, o = e.m, a = o[0] * i + o[4] * n + o[12], c = o[1] * i + o[5] * n + o[13], l = o[0] * r + o[4] * n + o[12], u = o[1] * r + o[5] * n + o[13], h = o[0] * i + o[4] * s + o[12], _ = o[1] * i + o[5] * s + o[13], f = o[0] * r + o[4] * s + o[12], d = o[1] * r + o[5] * s + o[13], p = Math.min(a, l, h, f), m = Math.max(a, l, h, f), v = Math.min(c, u, _, d), y = Math.max(c, u, _, d);
                return t.x = p, t.y = v, t.width = m - p, t.height = y - v, t;
            }, l.toString = function() {
                return "(" + this.x.toFixed(2) + ", " + this.y.toFixed(2) + ", " + this.width.toFixed(2) + ", " + this.height.toFixed(2) + ")";
            }, r = n, (a = [ {
                key: "xMin",
                get: function() {
                    return this.x;
                },
                set: function(t) {
                    this.width += this.x - t, this.x = t;
                }
            }, {
                key: "yMin",
                get: function() {
                    return this.y;
                },
                set: function(t) {
                    this.height += this.y - t, this.y = t;
                }
            }, {
                key: "xMax",
                get: function() {
                    return this.x + this.width;
                },
                set: function(t) {
                    this.width = t - this.x;
                }
            }, {
                key: "yMax",
                get: function() {
                    return this.y + this.height;
                },
                set: function(t) {
                    this.height = t - this.y;
                }
            }, {
                key: "center",
                get: function() {
                    return new s.default(this.x + .5 * this.width, this.y + .5 * this.height);
                },
                set: function(t) {
                    this.x = t.x - .5 * this.width, this.y = t.y - .5 * this.height;
                }
            }, {
                key: "origin",
                get: function() {
                    return new s.default(this.x, this.y);
                },
                set: function(t) {
                    this.x = t.x, this.y = t.y;
                }
            }, {
                key: "size",
                get: function() {
                    return new o.default(this.width, this.height);
                },
                set: function(t) {
                    this.width = t.width, this.height = t.height;
                }
            } ]) && c(r.prototype, a), n;
        }(n.default);
        i.default = l, r.default.fastDefine("cc.Rect", l, {
            x: 0,
            y: 0,
            width: 0,
            height: 0
        }), cc.Rect = l, cc.rect = function(t, e, i, n) {
            return new l(t, e, i, n);
        }, e.exports = i.default;
    }, {
        "../platform/CCClass": 182,
        "./size": 276,
        "./value-type": 279,
        "./vec2": 280
    } ],
    276: [ function(t, e, i) {
        "use strict";
        i.__esModule = !0, i.default = void 0;
        var n = s(t("./value-type")), r = s(t("../platform/CCClass"));
        function s(t) {
            return t && t.__esModule ? t : {
                default: t
            };
        }
        function o(t, e) {
            for (var i = 0; i < e.length; i++) {
                var n = e[i];
                n.enumerable = n.enumerable || !1, n.configurable = !0, "value" in n && (n.writable = !0), 
                Object.defineProperty(t, n.key, n);
            }
        }
        var a = function(t) {
            var e, i, n, r;
            function s(e, i) {
                var n;
                return void 0 === e && (e = 0), void 0 === i && (i = 0), (n = t.call(this) || this).width = void 0, 
                n.height = void 0, e && "object" == typeof e ? (n.width = e.width, n.height = e.height) : (n.width = e || 0, 
                n.height = i || 0), n;
            }
            i = t, (e = s).prototype = Object.create(i.prototype), e.prototype.constructor = e, 
            e.__proto__ = i, n = s, r = [ {
                key: "ZERO",
                get: function() {
                    return new s();
                }
            } ], null && o(n.prototype, null), r && o(n, r);
            var a = s.prototype;
            return a.clone = function() {
                return new s(this.width, this.height);
            }, a.equals = function(t) {
                return t && this.width === t.width && this.height === t.height;
            }, a.lerp = function(t, e, i) {
                i = i || new s();
                var n = this.width, r = this.height;
                return i.width = n + (t.width - n) * e, i.height = r + (t.height - r) * e, i;
            }, a.set = function(t) {
                return this.width = t.width, this.height = t.height, this;
            }, a.toString = function() {
                return "(" + this.width.toFixed(2) + ", " + this.height.toFixed(2) + ")";
            }, s;
        }(n.default);
        i.default = a, a.ZERO_R = a.ZERO, r.default.fastDefine("cc.Size", a, {
            width: 0,
            height: 0
        }), cc.size = function(t, e) {
            return new a(t, e);
        }, cc.Size = a, e.exports = i.default;
    }, {
        "../platform/CCClass": 182,
        "./value-type": 279
    } ],
    277: [ function(t, e, i) {
        "use strict";
        i.__esModule = !0, i.default = void 0;
        var n, r = (n = t("./quat")) && n.__esModule ? n : {
            default: n
        }, s = new r.default(), o = function() {
            function t() {}
            return t.toRotation = function(t, e) {
                return t.x = e[3], t.y = e[4], t.z = e[5], t.w = e[6], t;
            }, t.fromRotation = function(t, e) {
                return t[3] = e.x, t[4] = e.y, t[5] = e.z, t[6] = e.w, t;
            }, t.toEuler = function(e, i) {
                return t.toRotation(s, i), r.default.toEuler(e, s), e;
            }, t.fromEuler = function(e, i) {
                return r.default.fromEuler(s, i.x, i.y, i.z), t.fromRotation(e, s), e;
            }, t.fromEulerNumber = function(e, i, n, o) {
                return r.default.fromEuler(s, i, n, o), t.fromRotation(e, s), e;
            }, t.toScale = function(t, e) {
                return t.x = e[7], t.y = e[8], t.z = e[9], t;
            }, t.fromScale = function(t, e) {
                return t[7] = e.x, t[8] = e.y, t[9] = e.z, t;
            }, t.toPosition = function(t, e) {
                return t.x = e[0], t.y = e[1], t.z = e[2], t;
            }, t.fromPosition = function(t, e) {
                return t[0] = e.x, t[1] = e.y, t[2] = e.z, t;
            }, t.fromAngleZ = function(e, i) {
                return r.default.fromAngleZ(s, i), t.fromRotation(e, s), e;
            }, t.toMat4 = function(t, e) {
                var i = e[3], n = e[4], r = e[5], s = e[6], o = i + i, a = n + n, c = r + r, l = i * o, u = i * a, h = i * c, _ = n * a, f = n * c, d = r * c, p = s * o, m = s * a, v = s * c, y = e[7], g = e[8], x = e[9], A = t.m;
                return A[0] = (1 - (_ + d)) * y, A[1] = (u + v) * y, A[2] = (h - m) * y, A[3] = 0, 
                A[4] = (u - v) * g, A[5] = (1 - (l + d)) * g, A[6] = (f + p) * g, A[7] = 0, A[8] = (h + m) * x, 
                A[9] = (f - p) * x, A[10] = (1 - (l + _)) * x, A[11] = 0, A[12] = e[0], A[13] = e[1], 
                A[14] = e[2], A[15] = 1, t;
            }, t;
        }();
        i.default = o, cc.Trs = o, e.exports = i.default;
    }, {
        "./quat": 274
    } ],
    278: [ function(t, e, i) {
        "use strict";
        i.__esModule = !0, i.equals = function(t, e) {
            return Math.abs(t - e) <= s * Math.max(1, Math.abs(t), Math.abs(e));
        }, i.approx = function(t, e, i) {
            return i = i || s, Math.abs(t - e) <= i;
        }, i.clamp = function(t, e, i) {
            return t < e ? e : t > i ? i : t;
        }, i.clamp01 = function(t) {
            return t < 0 ? 0 : t > 1 ? 1 : t;
        }, i.lerp = function(t, e, i) {
            return t + (e - t) * i;
        }, i.toRadian = function(t) {
            return t * n;
        }, i.toDegree = function(t) {
            return t * r;
        }, i.randomRange = c, i.randomRangeInt = function(t, e) {
            return Math.floor(c(t, e));
        }, i.pseudoRandom = l, i.pseudoRandomRange = u, i.pseudoRandomRangeInt = function(t, e, i) {
            return Math.floor(u(t, e, i));
        }, i.nextPow2 = function(t) {
            return --t, t |= t >> 1, t |= t >> 2, t |= t >> 4, t |= t >> 8, t |= t >> 16, ++t;
        }, i.repeat = h, i.pingPong = function(t, e) {
            return t = h(t, 2 * e), e - Math.abs(t - e);
        }, i.inverseLerp = function(t, e, i) {
            return (i - t) / (e - t);
        }, i.sign = function(t) {
            return (t > 0) - (t < 0);
        }, i.random = i.FLOAT_BYTES = i.FLOAT_ARRAY_TYPE = i.INT_MIN = i.INT_MAX = i.INT_BITS = i.EPSILON = void 0;
        var n = Math.PI / 180, r = 180 / Math.PI, s = 1e-6;
        i.EPSILON = s, i.INT_BITS = 32, i.INT_MAX = 2147483647, i.INT_MIN = -1 << 31;
        var o = Float64Array;
        i.FLOAT_ARRAY_TYPE = o, i.FLOAT_BYTES = 8;
        var a = Math.random;
        function c(t, e) {
            return Math.random() * (e - t) + t;
        }
        function l(t) {
            return (t = (9301 * t + 49297) % 233280) / 233280;
        }
        function u(t, e, i) {
            return l(t) * (i - e) + e;
        }
        function h(t, e) {
            return t - Math.floor(t / e) * e;
        }
        i.random = a;
    }, {} ],
    279: [ function(t, e, i) {
        "use strict";
        i.__esModule = !0, i.default = void 0;
        var n, r = (n = t("../platform/js")) && n.__esModule ? n : {
            default: n
        }, s = function() {
            function t() {}
            var e = t.prototype;
            return e.clone = function() {
                return cc.errorID("0100", r.default.getClassName(this) + ".clone"), null;
            }, e.equals = function() {
                return cc.errorID("0100", r.default.getClassName(this) + ".equals"), !1;
            }, e.lerp = function() {
                return cc.errorID("0100", r.default.getClassName(this) + ".lerp"), this.clone();
            }, e.set = function() {
                cc.errorID("0100", r.default.getClassName(this) + ".set");
            }, e.toString = function() {
                return "" + {};
            }, t;
        }();
        i.default = s, r.default.setClassName("cc.ValueType", s), cc.ValueType = s, e.exports = i.default;
    }, {
        "../platform/js": 203
    } ],
    280: [ function(t, e, i) {
        "use strict";
        i.__esModule = !0, i.default = void 0;
        var n = a(t("./value-type")), r = a(t("../platform/CCClass")), s = a(t("../utils/misc")), o = t("./utils");
        function a(t) {
            return t && t.__esModule ? t : {
                default: t
            };
        }
        function c(t, e) {
            for (var i = 0; i < e.length; i++) {
                var n = e[i];
                n.enumerable = n.enumerable || !1, n.configurable = !0, "value" in n && (n.writable = !0), 
                Object.defineProperty(t, n.key, n);
            }
        }
        var l = 0, u = 0, h = function(t) {
            var e, i;
            i = t, (e = h).prototype = Object.create(i.prototype), e.prototype.constructor = e, 
            e.__proto__ = i;
            var n, r, a = h.prototype;
            function h(e, i) {
                var n;
                return void 0 === e && (e = 0), void 0 === i && (i = 0), (n = t.call(this) || this).mag = h.prototype.len, 
                n.magSqr = h.prototype.lengthSqr, n.subSelf = h.prototype.subtract, n.mulSelf = h.prototype.multiplyScalar, 
                n.divSelf = h.prototype.divide, n.scaleSelf = h.prototype.multiply, n.negSelf = h.prototype.negate, 
                n.x = void 0, n.y = void 0, n.z = 0, e && "object" == typeof e ? (n.x = e.x || 0, 
                n.y = e.y || 0) : (n.x = e || 0, n.y = i || 0), n;
            }
            return a.sub = function(t, e) {
                return h.subtract(e || new h(), this, t);
            }, a.mul = function(t, e) {
                return h.multiplyScalar(e || new h(), this, t);
            }, a.div = function(t, e) {
                return h.multiplyScalar(e || new h(), this, 1 / t);
            }, a.scale = function(t, e) {
                return h.multiply(e || new h(), this, t);
            }, a.neg = function(t) {
                return h.negate(t || new h(), this);
            }, h.clone = function(t) {
                return new h(t.x, t.y);
            }, h.copy = function(t, e) {
                return t.x = e.x, t.y = e.y, t;
            }, h.set = function(t, e, i) {
                return t.x = e, t.y = i, t;
            }, h.add = function(t, e, i) {
                return t.x = e.x + i.x, t.y = e.y + i.y, t;
            }, h.subtract = function(t, e, i) {
                return t.x = e.x - i.x, t.y = e.y - i.y, t;
            }, h.multiply = function(t, e, i) {
                return t.x = e.x * i.x, t.y = e.y * i.y, t;
            }, h.divide = function(t, e, i) {
                return t.x = e.x / i.x, t.y = e.y / i.y, t;
            }, h.ceil = function(t, e) {
                return t.x = Math.ceil(e.x), t.y = Math.ceil(e.y), t;
            }, h.floor = function(t, e) {
                return t.x = Math.floor(e.x), t.y = Math.floor(e.y), t;
            }, h.min = function(t, e, i) {
                return t.x = Math.min(e.x, i.x), t.y = Math.min(e.y, i.y), t;
            }, h.max = function(t, e, i) {
                return t.x = Math.max(e.x, i.x), t.y = Math.max(e.y, i.y), t;
            }, h.round = function(t, e) {
                return t.x = Math.round(e.x), t.y = Math.round(e.y), t;
            }, h.multiplyScalar = function(t, e, i) {
                return t.x = e.x * i, t.y = e.y * i, t;
            }, h.scaleAndAdd = function(t, e, i, n) {
                return t.x = e.x + i.x * n, t.y = e.y + i.y * n, t;
            }, h.distance = function(t, e) {
                return l = e.x - t.x, u = e.y - t.y, Math.sqrt(l * l + u * u);
            }, h.squaredDistance = function(t, e) {
                return l = e.x - t.x, u = e.y - t.y, l * l + u * u;
            }, h.len = function(t) {
                return l = t.x, u = t.y, Math.sqrt(l * l + u * u);
            }, h.lengthSqr = function(t) {
                return l = t.x, u = t.y, l * l + u * u;
            }, h.negate = function(t, e) {
                return t.x = -e.x, t.y = -e.y, t;
            }, h.inverse = function(t, e) {
                return t.x = 1 / e.x, t.y = 1 / e.y, t;
            }, h.inverseSafe = function(t, e) {
                return l = e.x, u = e.y, Math.abs(l) < o.EPSILON ? t.x = 0 : t.x = 1 / l, Math.abs(u) < o.EPSILON ? t.y = 0 : t.y = 1 / u, 
                t;
            }, h.normalize = function(t, e) {
                l = e.x, u = e.y;
                var i = l * l + u * u;
                return i > 0 && (i = 1 / Math.sqrt(i), t.x = l * i, t.y = u * i), t;
            }, h.dot = function(t, e) {
                return t.x * e.x + t.y * e.y;
            }, h.cross = function(t, e, i) {
                return t.x = t.y = 0, t.z = e.x * i.y - e.y * i.x, t;
            }, h.lerp = function(t, e, i, n) {
                return l = e.x, u = e.y, t.x = l + n * (i.x - l), t.y = u + n * (i.y - u), t;
            }, h.random = function(t, e) {
                e = e || 1;
                var i = 2 * (0, o.random)() * Math.PI;
                return t.x = Math.cos(i) * e, t.y = Math.sin(i) * e, t;
            }, h.transformMat3 = function(t, e, i) {
                l = e.x, u = e.y;
                var n = i.m;
                return t.x = n[0] * l + n[3] * u + n[6], t.y = n[1] * l + n[4] * u + n[7], t;
            }, h.transformMat4 = function(t, e, i) {
                l = e.x, u = e.y;
                var n = i.m;
                return t.x = n[0] * l + n[4] * u + n[12], t.y = n[1] * l + n[5] * u + n[13], t;
            }, h.strictEquals = function(t, e) {
                return t.x === e.x && t.y === e.y;
            }, h.equals = function(t, e, i) {
                return void 0 === i && (i = o.EPSILON), Math.abs(t.x - e.x) <= i * Math.max(1, Math.abs(t.x), Math.abs(e.x)) && Math.abs(t.y - e.y) <= i * Math.max(1, Math.abs(t.y), Math.abs(e.y));
            }, h.angle = function(t, e) {
                h.normalize(_, t), h.normalize(f, e);
                var i = h.dot(_, f);
                return i > 1 ? 0 : i < -1 ? Math.PI : Math.acos(i);
            }, h.toArray = function(t, e, i) {
                return void 0 === i && (i = 0), t[i + 0] = e.x, t[i + 1] = e.y, t;
            }, h.fromArray = function(t, e, i) {
                return void 0 === i && (i = 0), t.x = e[i + 0], t.y = e[i + 1], t;
            }, n = h, r = [ {
                key: "ONE",
                get: function() {
                    return new h(1, 1);
                }
            }, {
                key: "ZERO",
                get: function() {
                    return new h(0, 0);
                }
            }, {
                key: "UP",
                get: function() {
                    return new h(0, 1);
                }
            }, {
                key: "RIGHT",
                get: function() {
                    return new h(1, 0);
                }
            } ], null && c(n.prototype, null), r && c(n, r), a.clone = function() {
                return new h(this.x, this.y);
            }, a.set = function(t) {
                return this.x = t.x, this.y = t.y, this;
            }, a.equals = function(t) {
                return t && this.x === t.x && this.y === t.y;
            }, a.fuzzyEquals = function(t, e) {
                return this.x - e <= t.x && t.x <= this.x + e && this.y - e <= t.y && t.y <= this.y + e;
            }, a.toString = function() {
                return "(" + this.x.toFixed(2) + ", " + this.y.toFixed(2) + ")";
            }, a.lerp = function(t, e, i) {
                i = i || new h();
                var n = this.x, r = this.y;
                return i.x = n + (t.x - n) * e, i.y = r + (t.y - r) * e, i;
            }, a.clampf = function(t, e) {
                return this.x = s.default.clampf(this.x, t.x, e.x), this.y = s.default.clampf(this.y, t.y, e.y), 
                this;
            }, a.add = function(t, e) {
                return (e = e || new h()).x = this.x + t.x, e.y = this.y + t.y, e;
            }, a.addSelf = function(t) {
                return this.x += t.x, this.y += t.y, this;
            }, a.subtract = function(t) {
                return this.x -= t.x, this.y -= t.y, this;
            }, a.multiplyScalar = function(t) {
                return this.x *= t, this.y *= t, this;
            }, a.multiply = function(t) {
                return this.x *= t.x, this.y *= t.y, this;
            }, a.divide = function(t) {
                return this.x /= t, this.y /= t, this;
            }, a.negate = function() {
                return this.x = -this.x, this.y = -this.y, this;
            }, a.dot = function(t) {
                return this.x * t.x + this.y * t.y;
            }, a.cross = function(t) {
                return this.x * t.y - this.y * t.x;
            }, a.len = function() {
                return Math.sqrt(this.x * this.x + this.y * this.y);
            }, a.lengthSqr = function() {
                return this.x * this.x + this.y * this.y;
            }, a.normalizeSelf = function() {
                var t = this.x * this.x + this.y * this.y;
                if (1 === t) return this;
                if (0 === t) return this;
                var e = 1 / Math.sqrt(t);
                return this.x *= e, this.y *= e, this;
            }, a.normalize = function(t) {
                return (t = t || new h()).x = this.x, t.y = this.y, t.normalizeSelf(), t;
            }, a.angle = function(t) {
                var e = this.magSqr(), i = t.magSqr();
                if (0 === e || 0 === i) return console.warn("Can't get angle between zero vector"), 
                0;
                var n = this.dot(t) / Math.sqrt(e * i);
                return n = s.default.clampf(n, -1, 1), Math.acos(n);
            }, a.signAngle = function(t) {
                var e = this.angle(t);
                return this.cross(t) < 0 ? -e : e;
            }, a.rotate = function(t, e) {
                return (e = e || new h()).x = this.x, e.y = this.y, e.rotateSelf(t);
            }, a.rotateSelf = function(t) {
                var e = Math.sin(t), i = Math.cos(t), n = this.x;
                return this.x = i * n - e * this.y, this.y = e * n + i * this.y, this;
            }, a.project = function(t) {
                return t.multiplyScalar(this.dot(t) / t.dot(t));
            }, a.transformMat4 = function(t, e) {
                return e = e || new h(), h.transformMat4(e, this, t), e;
            }, a.maxAxis = function() {
                return Math.max(this.x, this.y);
            }, h;
        }(n.default);
        i.default = h, h.sub = h.subtract, h.mul = h.multiply, h.scale = h.multiplyScalar, 
        h.mag = h.len, h.squaredMagnitude = h.lengthSqr, h.div = h.divide, h.ONE_R = h.ONE, 
        h.ZERO_R = h.ZERO, h.UP_R = h.UP, h.RIGHT_R = h.RIGHT;
        var _ = new h(), f = new h();
        r.default.fastDefine("cc.Vec2", h, {
            x: 0,
            y: 0
        }), cc.v2 = function(t, e) {
            return new h(t, e);
        }, cc.Vec2 = h, e.exports = i.default;
    }, {
        "../platform/CCClass": 182,
        "../utils/misc": 256,
        "./utils": 278,
        "./value-type": 279
    } ],
    281: [ function(t, e, i) {
        "use strict";
        i.__esModule = !0, i.default = void 0;
        var n = c(t("./value-type")), r = c(t("../platform/CCClass")), s = c(t("../utils/misc")), o = c(t("./vec2")), a = t("./utils");
        function c(t) {
            return t && t.__esModule ? t : {
                default: t
            };
        }
        function l(t, e) {
            for (var i = 0; i < e.length; i++) {
                var n = e[i];
                n.enumerable = n.enumerable || !1, n.configurable = !0, "value" in n && (n.writable = !0), 
                Object.defineProperty(t, n.key, n);
            }
        }
        var u = 0, h = 0, _ = 0, f = function(t) {
            var e, i;
            i = t, (e = f).prototype = Object.create(i.prototype), e.prototype.constructor = e, 
            e.__proto__ = i;
            var n, r, c = f.prototype;
            function f(e, i, n) {
                var r;
                return void 0 === e && (e = 0), void 0 === i && (i = 0), void 0 === n && (n = 0), 
                (r = t.call(this) || this).mag = f.prototype.len, r.magSqr = f.prototype.lengthSqr, 
                r.subSelf = f.prototype.subtract, r.mulSelf = f.prototype.multiplyScalar, r.divSelf = f.prototype.divide, 
                r.scaleSelf = f.prototype.multiply, r.negSelf = f.prototype.negate, r.x = void 0, 
                r.y = void 0, r.z = void 0, r.angle = o.default.prototype.angle, r.project = o.default.prototype.project, 
                e && "object" == typeof e ? (r.x = e.x, r.y = e.y, r.z = e.z) : (r.x = e, r.y = i, 
                r.z = n), r;
            }
            return c.sub = function(t, e) {
                return f.subtract(e || new f(), this, t);
            }, c.mul = function(t, e) {
                return f.multiplyScalar(e || new f(), this, t);
            }, c.div = function(t, e) {
                return f.multiplyScalar(e || new f(), this, 1 / t);
            }, c.scale = function(t, e) {
                return f.multiply(e || new f(), this, t);
            }, c.neg = function(t) {
                return f.negate(t || new f(), this);
            }, f.zero = function(t) {
                return t.x = 0, t.y = 0, t.z = 0, t;
            }, f.clone = function(t) {
                return new f(t.x, t.y, t.z);
            }, f.copy = function(t, e) {
                return t.x = e.x, t.y = e.y, t.z = e.z, t;
            }, f.set = function(t, e, i, n) {
                return t.x = e, t.y = i, t.z = n, t;
            }, f.add = function(t, e, i) {
                return t.x = e.x + i.x, t.y = e.y + i.y, t.z = e.z + i.z, t;
            }, f.subtract = function(t, e, i) {
                return t.x = e.x - i.x, t.y = e.y - i.y, t.z = e.z - i.z, t;
            }, f.multiply = function(t, e, i) {
                return t.x = e.x * i.x, t.y = e.y * i.y, t.z = e.z * i.z, t;
            }, f.divide = function(t, e, i) {
                return t.x = e.x / i.x, t.y = e.y / i.y, t.z = e.z / i.z, t;
            }, f.ceil = function(t, e) {
                return t.x = Math.ceil(e.x), t.y = Math.ceil(e.y), t.z = Math.ceil(e.z), t;
            }, f.floor = function(t, e) {
                return t.x = Math.floor(e.x), t.y = Math.floor(e.y), t.z = Math.floor(e.z), t;
            }, f.min = function(t, e, i) {
                return t.x = Math.min(e.x, i.x), t.y = Math.min(e.y, i.y), t.z = Math.min(e.z, i.z), 
                t;
            }, f.max = function(t, e, i) {
                return t.x = Math.max(e.x, i.x), t.y = Math.max(e.y, i.y), t.z = Math.max(e.z, i.z), 
                t;
            }, f.round = function(t, e) {
                return t.x = Math.round(e.x), t.y = Math.round(e.y), t.z = Math.round(e.z), t;
            }, f.multiplyScalar = function(t, e, i) {
                return t.x = e.x * i, t.y = e.y * i, t.z = e.z * i, t;
            }, f.scaleAndAdd = function(t, e, i, n) {
                return t.x = e.x + i.x * n, t.y = e.y + i.y * n, t.z = e.z + i.z * n, t;
            }, f.distance = function(t, e) {
                return u = e.x - t.x, h = e.y - t.y, _ = e.z - t.z, Math.sqrt(u * u + h * h + _ * _);
            }, f.squaredDistance = function(t, e) {
                return u = e.x - t.x, h = e.y - t.y, _ = e.z - t.z, u * u + h * h + _ * _;
            }, f.len = function(t) {
                return u = t.x, h = t.y, _ = t.z, Math.sqrt(u * u + h * h + _ * _);
            }, f.lengthSqr = function(t) {
                return u = t.x, h = t.y, _ = t.z, u * u + h * h + _ * _;
            }, f.negate = function(t, e) {
                return t.x = -e.x, t.y = -e.y, t.z = -e.z, t;
            }, f.inverse = function(t, e) {
                return t.x = 1 / e.x, t.y = 1 / e.y, t.z = 1 / e.z, t;
            }, f.inverseSafe = function(t, e) {
                return u = e.x, h = e.y, _ = e.z, Math.abs(u) < a.EPSILON ? t.x = 0 : t.x = 1 / u, 
                Math.abs(h) < a.EPSILON ? t.y = 0 : t.y = 1 / h, Math.abs(_) < a.EPSILON ? t.z = 0 : t.z = 1 / _, 
                t;
            }, f.normalize = function(t, e) {
                u = e.x, h = e.y, _ = e.z;
                var i = u * u + h * h + _ * _;
                return i > 0 && (i = 1 / Math.sqrt(i), t.x = u * i, t.y = h * i, t.z = _ * i), t;
            }, f.dot = function(t, e) {
                return t.x * e.x + t.y * e.y + t.z * e.z;
            }, f.cross = function(t, e, i) {
                var n = e.x, r = e.y, s = e.z, o = i.x, a = i.y, c = i.z;
                return t.x = r * c - s * a, t.y = s * o - n * c, t.z = n * a - r * o, t;
            }, f.lerp = function(t, e, i, n) {
                return t.x = e.x + n * (i.x - e.x), t.y = e.y + n * (i.y - e.y), t.z = e.z + n * (i.z - e.z), 
                t;
            }, f.random = function(t, e) {
                e = e || 1;
                var i = 2 * (0, a.random)() * Math.PI, n = 2 * (0, a.random)() - 1, r = Math.sqrt(1 - n * n);
                return t.x = r * Math.cos(i) * e, t.y = r * Math.sin(i) * e, t.z = n * e, t;
            }, f.transformMat4 = function(t, e, i) {
                u = e.x, h = e.y, _ = e.z;
                var n = i.m, r = n[3] * u + n[7] * h + n[11] * _ + n[15];
                return r = r ? 1 / r : 1, t.x = (n[0] * u + n[4] * h + n[8] * _ + n[12]) * r, t.y = (n[1] * u + n[5] * h + n[9] * _ + n[13]) * r, 
                t.z = (n[2] * u + n[6] * h + n[10] * _ + n[14]) * r, t;
            }, f.transformMat4Normal = function(t, e, i) {
                u = e.x, h = e.y, _ = e.z;
                var n = i.m, r = n[3] * u + n[7] * h + n[11] * _;
                return r = r ? 1 / r : 1, t.x = (n[0] * u + n[4] * h + n[8] * _) * r, t.y = (n[1] * u + n[5] * h + n[9] * _) * r, 
                t.z = (n[2] * u + n[6] * h + n[10] * _) * r, t;
            }, f.transformMat3 = function(t, e, i) {
                u = e.x, h = e.y, _ = e.z;
                var n = i.m;
                return t.x = u * n[0] + h * n[3] + _ * n[6], t.y = u * n[1] + h * n[4] + _ * n[7], 
                t.z = u * n[2] + h * n[5] + _ * n[8], t;
            }, f.transformAffine = function(t, e, i) {
                u = e.x, h = e.y, _ = e.z;
                var n = i.m;
                return t.x = n[0] * u + n[1] * h + n[2] * _ + n[3], t.y = n[4] * u + n[5] * h + n[6] * _ + n[7], 
                t.x = n[8] * u + n[9] * h + n[10] * _ + n[11], t;
            }, f.transformQuat = function(t, e, i) {
                var n = i.w * e.x + i.y * e.z - i.z * e.y, r = i.w * e.y + i.z * e.x - i.x * e.z, s = i.w * e.z + i.x * e.y - i.y * e.x, o = -i.x * e.x - i.y * e.y - i.z * e.z;
                return t.x = n * i.w + o * -i.x + r * -i.z - s * -i.y, t.y = r * i.w + o * -i.y + s * -i.x - n * -i.z, 
                t.z = s * i.w + o * -i.z + n * -i.y - r * -i.x, t;
            }, f.transformRTS = function(t, e, i, n, r) {
                var s = e.x * r.x, o = e.y * r.y, a = e.z * r.z, c = i.w * s + i.y * a - i.z * o, l = i.w * o + i.z * s - i.x * a, u = i.w * a + i.x * o - i.y * s, h = -i.x * s - i.y * o - i.z * a;
                return t.x = c * i.w + h * -i.x + l * -i.z - u * -i.y + n.x, t.y = l * i.w + h * -i.y + u * -i.x - c * -i.z + n.y, 
                t.z = u * i.w + h * -i.z + c * -i.y - l * -i.x + n.z, t;
            }, f.transformInverseRTS = function(t, e, i, n, r) {
                var s = e.x - n.x, o = e.y - n.y, a = e.z - n.z, c = i.w * s - i.y * a + i.z * o, l = i.w * o - i.z * s + i.x * a, u = i.w * a - i.x * o + i.y * s, h = i.x * s + i.y * o + i.z * a;
                return t.x = (c * i.w + h * i.x + l * i.z - u * i.y) / r.x, t.y = (l * i.w + h * i.y + u * i.x - c * i.z) / r.y, 
                t.z = (u * i.w + h * i.z + c * i.y - l * i.x) / r.z, t;
            }, f.rotateX = function(t, e, i, n) {
                u = e.x - i.x, h = e.y - i.y, _ = e.z - i.z;
                var r = Math.cos(n), s = Math.sin(n), o = u, a = h * r - _ * s, c = h * s + _ * r;
                return t.x = o + i.x, t.y = a + i.y, t.z = c + i.z, t;
            }, f.rotateY = function(t, e, i, n) {
                u = e.x - i.x, h = e.y - i.y, _ = e.z - i.z;
                var r = Math.cos(n), s = Math.sin(n), o = _ * s + u * r, a = h, c = _ * r - u * s;
                return t.x = o + i.x, t.y = a + i.y, t.z = c + i.z, t;
            }, f.rotateZ = function(t, e, i, n) {
                u = e.x - i.x, h = e.y - i.y, _ = e.z - i.z;
                var r = Math.cos(n), s = Math.sin(n), o = u * r - h * s, a = u * s + h * r, c = _;
                return t.x = o + i.x, t.y = a + i.y, t.z = c + i.z, t;
            }, f.strictEquals = function(t, e) {
                return t.x === e.x && t.y === e.y && t.z === e.z;
            }, f.equals = function(t, e, i) {
                void 0 === i && (i = a.EPSILON);
                var n = t.x, r = t.y, s = t.z, o = e.x, c = e.y, l = e.z;
                return Math.abs(n - o) <= i * Math.max(1, Math.abs(n), Math.abs(o)) && Math.abs(r - c) <= i * Math.max(1, Math.abs(r), Math.abs(c)) && Math.abs(s - l) <= i * Math.max(1, Math.abs(s), Math.abs(l));
            }, f.angle = function(t, e) {
                f.normalize(d, t), f.normalize(p, e);
                var i = f.dot(d, p);
                return i > 1 ? 0 : i < -1 ? Math.PI : Math.acos(i);
            }, f.projectOnPlane = function(t, e, i) {
                return f.subtract(t, e, f.project(t, e, i));
            }, f.project = function(t, e, i) {
                var n = f.lengthSqr(i);
                return n < 1e-6 ? f.set(t, 0, 0, 0) : f.multiplyScalar(t, i, f.dot(e, i) / n);
            }, f.toArray = function(t, e, i) {
                return void 0 === i && (i = 0), t[i + 0] = e.x, t[i + 1] = e.y, t[i + 2] = e.z, 
                t;
            }, f.fromArray = function(t, e, i) {
                return void 0 === i && (i = 0), t.x = e[i + 0], t.y = e[i + 1], t.z = e[i + 2], 
                t;
            }, n = f, r = [ {
                key: "ONE",
                get: function() {
                    return new f(1, 1, 1);
                }
            }, {
                key: "ZERO",
                get: function() {
                    return new f();
                }
            }, {
                key: "UP",
                get: function() {
                    return new f(0, 1, 0);
                }
            }, {
                key: "RIGHT",
                get: function() {
                    return new f(1, 0, 0);
                }
            }, {
                key: "FORWARD",
                get: function() {
                    return new f(0, 0, 1);
                }
            } ], null && l(n.prototype, null), r && l(n, r), c.clone = function() {
                return new f(this.x, this.y, this.z);
            }, c.set = function(t) {
                return this.x = t.x, this.y = t.y, this.z = t.z, this;
            }, c.equals = function(t) {
                return t && this.x === t.x && this.y === t.y && this.z === t.z;
            }, c.fuzzyEquals = function(t, e) {
                return this.x - e <= t.x && t.x <= this.x + e && this.y - e <= t.y && t.y <= this.y + e && this.z - e <= t.z && t.z <= this.z + e;
            }, c.toString = function() {
                return "(" + this.x.toFixed(2) + ", " + this.y.toFixed(2) + ", " + this.z.toFixed(2) + ")";
            }, c.lerp = function(t, e, i) {
                return i = i || new f(), f.lerp(i, this, t, e), i;
            }, c.clampf = function(t, e) {
                return this.x = s.default.clampf(this.x, t.x, e.x), this.y = s.default.clampf(this.y, t.y, e.y), 
                this.z = s.default.clampf(this.z, t.z, e.z), this;
            }, c.addSelf = function(t) {
                return this.x += t.x, this.y += t.y, this.z += t.z, this;
            }, c.add = function(t, e) {
                return (e = e || new f()).x = this.x + t.x, e.y = this.y + t.y, e.z = this.z + t.z, 
                e;
            }, c.subtract = function(t) {
                return this.x -= t.x, this.y -= t.y, this.z -= t.z, this;
            }, c.multiplyScalar = function(t) {
                return this.x *= t, this.y *= t, this.z *= t, this;
            }, c.multiply = function(t) {
                return this.x *= t.x, this.y *= t.y, this.z *= t.z, this;
            }, c.divide = function(t) {
                return this.x /= t, this.y /= t, this.z /= t, this;
            }, c.negate = function() {
                return this.x = -this.x, this.y = -this.y, this.z = -this.z, this;
            }, c.dot = function(t) {
                return this.x * t.x + this.y * t.y + this.z * t.z;
            }, c.cross = function(t, e) {
                return e = e || new f(), f.cross(e, this, t), e;
            }, c.len = function() {
                return Math.sqrt(this.x * this.x + this.y * this.y + this.z * this.z);
            }, c.lengthSqr = function() {
                return this.x * this.x + this.y * this.y + this.z * this.z;
            }, c.normalizeSelf = function() {
                return f.normalize(this, this), this;
            }, c.normalize = function(t) {
                return t = t || new f(), f.normalize(t, this), t;
            }, c.transformMat4 = function(t, e) {
                return e = e || new f(), f.transformMat4(e, this, t), e;
            }, c.maxAxis = function() {
                return Math.max(this.x, this.y, this.z);
            }, c.signAngle = function(t) {
                cc.warnID(1408, "vec3.signAngle", "v2.1", "cc.v2(selfVector).signAngle(vector)");
                var e = new o.default(this.x, this.y), i = new o.default(t.x, t.y);
                return e.signAngle(i);
            }, c.rotate = function(t, e) {
                return cc.warnID(1408, "vec3.rotate", "v2.1", "cc.v2(selfVector).rotate(radians, out)"), 
                o.default.prototype.rotate.call(this, t, e);
            }, c.rotateSelf = function(t) {
                return cc.warnID(1408, "vec3.rotateSelf", "v2.1", "cc.v2(selfVector).rotateSelf(radians)"), 
                o.default.prototype.rotateSelf.call(this, t);
            }, f;
        }(n.default);
        i.default = f, f.sub = f.subtract, f.mul = f.multiply, f.scale = f.multiplyScalar, 
        f.mag = f.len, f.squaredMagnitude = f.lengthSqr, f.div = f.divide, f.ONE_R = f.ONE, 
        f.ZERO_R = f.ZERO, f.UP_R = f.UP, f.RIGHT_R = f.RIGHT, f.FRONT_R = f.FORWARD;
        var d = new f(), p = new f();
        r.default.fastDefine("cc.Vec3", f, {
            x: 0,
            y: 0,
            z: 0
        }), cc.v3 = function(t, e, i) {
            return new f(t, e, i);
        }, cc.Vec3 = f, e.exports = i.default;
    }, {
        "../platform/CCClass": 182,
        "../utils/misc": 256,
        "./utils": 278,
        "./value-type": 279,
        "./vec2": 280
    } ],
    282: [ function(t, e, i) {
        "use strict";
        i.__esModule = !0, i.v4 = f, i.default = void 0;
        var n = o(t("../platform/CCClass")), r = o(t("./value-type")), s = t("./utils");
        function o(t) {
            return t && t.__esModule ? t : {
                default: t
            };
        }
        function a(t, e) {
            for (var i = 0; i < e.length; i++) {
                var n = e[i];
                n.enumerable = n.enumerable || !1, n.configurable = !0, "value" in n && (n.writable = !0), 
                Object.defineProperty(t, n.key, n);
            }
        }
        var c = 0, l = 0, u = 0, h = 0, _ = function(t) {
            var e, i;
            i = t, (e = _).prototype = Object.create(i.prototype), e.prototype.constructor = e, 
            e.__proto__ = i;
            var n, r, o = _.prototype;
            function _(e, i, n, r) {
                var s;
                return void 0 === e && (e = 0), void 0 === i && (i = 0), void 0 === n && (n = 0), 
                void 0 === r && (r = 0), (s = t.call(this) || this).mag = _.prototype.len, s.magSqr = _.prototype.lengthSqr, 
                s.subSelf = _.prototype.subtract, s.mulSelf = _.prototype.multiplyScalar, s.divSelf = _.prototype.divide, 
                s.scaleSelf = _.prototype.multiply, s.negSelf = _.prototype.negate, s.x = void 0, 
                s.y = void 0, s.z = void 0, s.w = void 0, e && "object" == typeof e ? (s.x = e.x, 
                s.y = e.y, s.z = e.z, s.w = e.w) : (s.x = e, s.y = i, s.z = n, s.w = r), s;
            }
            return o.sub = function(t, e) {
                return _.subtract(e || new _(), this, t);
            }, o.mul = function(t, e) {
                return _.multiplyScalar(e || new _(), this, t);
            }, o.div = function(t, e) {
                return _.multiplyScalar(e || new _(), this, 1 / t);
            }, o.scale = function(t, e) {
                return _.multiply(e || new _(), this, t);
            }, o.neg = function(t) {
                return _.negate(t || new _(), this);
            }, _.clone = function(t) {
                return new _(t.x, t.y, t.z, t.w);
            }, _.copy = function(t, e) {
                return t.x = e.x, t.y = e.y, t.z = e.z, t.w = e.w, t;
            }, _.set = function(t, e, i, n, r) {
                return t.x = e, t.y = i, t.z = n, t.w = r, t;
            }, _.add = function(t, e, i) {
                return t.x = e.x + i.x, t.y = e.y + i.y, t.z = e.z + i.z, t.w = e.w + i.w, t;
            }, _.subtract = function(t, e, i) {
                return t.x = e.x - i.x, t.y = e.y - i.y, t.z = e.z - i.z, t.w = e.w - i.w, t;
            }, _.multiply = function(t, e, i) {
                return t.x = e.x * i.x, t.y = e.y * i.y, t.z = e.z * i.z, t.w = e.w * i.w, t;
            }, _.divide = function(t, e, i) {
                return t.x = e.x / i.x, t.y = e.y / i.y, t.z = e.z / i.z, t.w = e.w / i.w, t;
            }, _.ceil = function(t, e) {
                return t.x = Math.ceil(e.x), t.y = Math.ceil(e.y), t.z = Math.ceil(e.z), t.w = Math.ceil(e.w), 
                t;
            }, _.floor = function(t, e) {
                return t.x = Math.floor(e.x), t.y = Math.floor(e.y), t.z = Math.floor(e.z), t.w = Math.floor(e.w), 
                t;
            }, _.min = function(t, e, i) {
                return t.x = Math.min(e.x, i.x), t.y = Math.min(e.y, i.y), t.z = Math.min(e.z, i.z), 
                t.w = Math.min(e.w, i.w), t;
            }, _.max = function(t, e, i) {
                return t.x = Math.max(e.x, i.x), t.y = Math.max(e.y, i.y), t.z = Math.max(e.z, i.z), 
                t.w = Math.max(e.w, i.w), t;
            }, _.round = function(t, e) {
                return t.x = Math.round(e.x), t.y = Math.round(e.y), t.z = Math.round(e.z), t.w = Math.round(e.w), 
                t;
            }, _.multiplyScalar = function(t, e, i) {
                return t.x = e.x * i, t.y = e.y * i, t.z = e.z * i, t.w = e.w * i, t;
            }, _.scaleAndAdd = function(t, e, i, n) {
                return t.x = e.x + i.x * n, t.y = e.y + i.y * n, t.z = e.z + i.z * n, t.w = e.w + i.w * n, 
                t;
            }, _.distance = function(t, e) {
                var i = e.x - t.x, n = e.y - t.y, r = e.z - t.z, s = e.w - t.w;
                return Math.sqrt(i * i + n * n + r * r + s * s);
            }, _.squaredDistance = function(t, e) {
                var i = e.x - t.x, n = e.y - t.y, r = e.z - t.z, s = e.w - t.w;
                return i * i + n * n + r * r + s * s;
            }, _.len = function(t) {
                return c = t.x, l = t.y, u = t.z, h = t.w, Math.sqrt(c * c + l * l + u * u + h * h);
            }, _.lengthSqr = function(t) {
                return c = t.x, l = t.y, u = t.z, h = t.w, c * c + l * l + u * u + h * h;
            }, _.negate = function(t, e) {
                return t.x = -e.x, t.y = -e.y, t.z = -e.z, t.w = -e.w, t;
            }, _.inverse = function(t, e) {
                return t.x = 1 / e.x, t.y = 1 / e.y, t.z = 1 / e.z, t.w = 1 / e.w, t;
            }, _.inverseSafe = function(t, e) {
                return c = e.x, l = e.y, u = e.z, h = e.w, Math.abs(c) < s.EPSILON ? t.x = 0 : t.x = 1 / c, 
                Math.abs(l) < s.EPSILON ? t.y = 0 : t.y = 1 / l, Math.abs(u) < s.EPSILON ? t.z = 0 : t.z = 1 / u, 
                Math.abs(h) < s.EPSILON ? t.w = 0 : t.w = 1 / h, t;
            }, _.normalize = function(t, e) {
                c = e.x, l = e.y, u = e.z, h = e.w;
                var i = c * c + l * l + u * u + h * h;
                return i > 0 && (i = 1 / Math.sqrt(i), t.x = c * i, t.y = l * i, t.z = u * i, t.w = h * i), 
                t;
            }, _.dot = function(t, e) {
                return t.x * e.x + t.y * e.y + t.z * e.z + t.w * e.w;
            }, _.lerp = function(t, e, i, n) {
                return t.x = e.x + n * (i.x - e.x), t.y = e.y + n * (i.y - e.y), t.z = e.z + n * (i.z - e.z), 
                t.w = e.w + n * (i.w - e.w), t;
            }, _.random = function(t, e) {
                e = e || 1;
                var i = 2 * (0, s.random)() * Math.PI, n = 2 * (0, s.random)() - 1, r = Math.sqrt(1 - n * n);
                return t.x = r * Math.cos(i) * e, t.y = r * Math.sin(i) * e, t.z = n * e, t.w = 0, 
                t;
            }, _.transformMat4 = function(t, e, i) {
                c = e.x, l = e.y, u = e.z, h = e.w;
                var n = i.m;
                return t.x = n[0] * c + n[4] * l + n[8] * u + n[12] * h, t.y = n[1] * c + n[5] * l + n[9] * u + n[13] * h, 
                t.z = n[2] * c + n[6] * l + n[10] * u + n[14] * h, t.w = n[3] * c + n[7] * l + n[11] * u + n[15] * h, 
                t;
            }, _.transformAffine = function(t, e, i) {
                c = e.x, l = e.y, u = e.z, h = e.w;
                var n = i.m;
                return t.x = n[0] * c + n[1] * l + n[2] * u + n[3] * h, t.y = n[4] * c + n[5] * l + n[6] * u + n[7] * h, 
                t.x = n[8] * c + n[9] * l + n[10] * u + n[11] * h, t.w = e.w, t;
            }, _.transformQuat = function(t, e, i) {
                var n = e.x, r = e.y, s = e.z;
                c = i.x, l = i.y, u = i.z;
                var o = (h = i.w) * n + l * s - u * r, a = h * r + u * n - c * s, _ = h * s + c * r - l * n, f = -c * n - l * r - u * s;
                return t.x = o * h + f * -c + a * -u - _ * -l, t.y = a * h + f * -l + _ * -c - o * -u, 
                t.z = _ * h + f * -u + o * -l - a * -c, t.w = e.w, t;
            }, _.strictEquals = function(t, e) {
                return t.x === e.x && t.y === e.y && t.z === e.z && t.w === e.w;
            }, _.equals = function(t, e, i) {
                return void 0 === i && (i = s.EPSILON), Math.abs(t.x - e.x) <= i * Math.max(1, Math.abs(t.x), Math.abs(e.x)) && Math.abs(t.y - e.y) <= i * Math.max(1, Math.abs(t.y), Math.abs(e.y)) && Math.abs(t.z - e.z) <= i * Math.max(1, Math.abs(t.z), Math.abs(e.z)) && Math.abs(t.w - e.w) <= i * Math.max(1, Math.abs(t.w), Math.abs(e.w));
            }, _.toArray = function(t, e, i) {
                return void 0 === i && (i = 0), t[i + 0] = e.x, t[i + 1] = e.y, t[i + 2] = e.z, 
                t[i + 3] = e.w, t;
            }, _.fromArray = function(t, e, i) {
                return void 0 === i && (i = 0), t.x = e[i + 0], t.y = e[i + 1], t.z = e[i + 2], 
                t.w = e[i + 3], t;
            }, n = _, r = [ {
                key: "ZERO",
                get: function() {
                    return new _(0, 0, 0, 0);
                }
            }, {
                key: "ONE",
                get: function() {
                    return new _(1, 1, 1, 1);
                }
            }, {
                key: "NEG_ONE",
                get: function() {
                    return new _(-1, -1, -1, -1);
                }
            } ], null && a(n.prototype, null), r && a(n, r), o.clone = function() {
                return new _(this.x, this.y, this.z, this.w);
            }, o.set = function(t, e, i, n) {
                return t && "object" == typeof t ? (this.x = t.x, this.y = t.y, this.z = t.z, this.w = t.w) : (this.x = t || 0, 
                this.y = e || 0, this.z = i || 0, this.w = n || 0), this;
            }, o.equals = function(t, e) {
                return void 0 === e && (e = s.EPSILON), Math.abs(this.x - t.x) <= e * Math.max(1, Math.abs(this.x), Math.abs(t.x)) && Math.abs(this.y - t.y) <= e * Math.max(1, Math.abs(this.y), Math.abs(t.y)) && Math.abs(this.z - t.z) <= e * Math.max(1, Math.abs(this.z), Math.abs(t.z)) && Math.abs(this.w - t.w) <= e * Math.max(1, Math.abs(this.w), Math.abs(t.w));
            }, o.equals4f = function(t, e, i, n, r) {
                return void 0 === r && (r = s.EPSILON), Math.abs(this.x - t) <= r * Math.max(1, Math.abs(this.x), Math.abs(t)) && Math.abs(this.y - e) <= r * Math.max(1, Math.abs(this.y), Math.abs(e)) && Math.abs(this.z - i) <= r * Math.max(1, Math.abs(this.z), Math.abs(i)) && Math.abs(this.w - n) <= r * Math.max(1, Math.abs(this.w), Math.abs(n));
            }, o.strictEquals = function(t) {
                return this.x === t.x && this.y === t.y && this.z === t.z && this.w === t.w;
            }, o.strictEquals4f = function(t, e, i, n) {
                return this.x === t && this.y === e && this.z === i && this.w === n;
            }, o.lerp = function(t, e) {
                return c = this.x, l = this.y, u = this.z, h = this.w, this.x = c + e * (t.x - c), 
                this.y = l + e * (t.y - l), this.z = u + e * (t.z - u), this.w = h + e * (t.w - h), 
                this;
            }, o.toString = function() {
                return "(" + this.x.toFixed(2) + ", " + this.y.toFixed(2) + ", " + this.z.toFixed(2) + ", " + this.w.toFixed(2) + ")";
            }, o.clampf = function(t, e) {
                return this.x = (0, s.clamp)(this.x, t.x, e.x), this.y = (0, s.clamp)(this.y, t.y, e.y), 
                this.z = (0, s.clamp)(this.z, t.z, e.z), this.w = (0, s.clamp)(this.w, t.w, e.w), 
                this;
            }, o.addSelf = function(t) {
                return this.x += t.x, this.y += t.y, this.z += t.z, this.w += t.w, this;
            }, o.add = function(t, e) {
                return (e = e || new _()).x = this.x + t.x, e.y = this.y + t.y, e.z = this.z + t.z, 
                e.w = this.w + t.w, e;
            }, o.subtract = function(t, e) {
                return (e = e || new _()).x = this.x - t.x, e.y = this.y - t.y, e.z = this.z - t.z, 
                e.w = this.w - t.w, e;
            }, o.multiplyScalar = function(t) {
                return this.x *= t, this.y *= t, this.z *= t, this.w *= t, this;
            }, o.multiply = function(t) {
                return this.x *= t.x, this.y *= t.y, this.z *= t.z, this.w *= t.w, this;
            }, o.divide = function(t) {
                return this.x /= t, this.y /= t, this.z /= t, this.w /= t, this;
            }, o.negate = function() {
                return this.x = -this.x, this.y = -this.y, this.z = -this.z, this.w = -this.w, this;
            }, o.dot = function(t) {
                return this.x * t.x + this.y * t.y + this.z * t.z + this.w * t.w;
            }, o.cross = function(t, e) {
                e = e || new _();
                var i = this.x, n = this.y, r = this.z, s = t.x, o = t.y, a = t.z;
                return e.x = n * a - r * o, e.y = r * s - i * a, e.z = i * o - n * s, e;
            }, o.len = function() {
                var t = this.x, e = this.y, i = this.z, n = this.w;
                return Math.sqrt(t * t + e * e + i * i + n * n);
            }, o.lengthSqr = function() {
                var t = this.x, e = this.y, i = this.z, n = this.w;
                return t * t + e * e + i * i + n * n;
            }, o.normalizeSelf = function() {
                return this.normalize(this), this;
            }, o.normalize = function(t) {
                t = t || new _(), c = this.x, l = this.y, u = this.z, h = this.w;
                var e = c * c + l * l + u * u + h * h;
                return e > 0 && (e = 1 / Math.sqrt(e), t.x = c * e, t.y = l * e, t.z = u * e, t.w = h * e), 
                t;
            }, o.transformMat4 = function(t, e) {
                e = e || new _(), c = this.x, l = this.y, u = this.z, h = this.w;
                var i = t.m;
                return e.x = i[0] * c + i[4] * l + i[8] * u + i[12] * h, e.y = i[1] * c + i[5] * l + i[9] * u + i[13] * h, 
                e.z = i[2] * c + i[6] * l + i[10] * u + i[14] * h, e.w = i[3] * c + i[7] * l + i[11] * u + i[15] * h, 
                e;
            }, o.maxAxis = function() {
                return Math.max(this.x, this.y, this.z, this.w);
            }, _;
        }(r.default);
        function f(t, e, i, n) {
            return new _(t, e, i, n);
        }
        i.default = _, _.sub = _.subtract, _.mul = _.multiply, _.div = _.divide, _.scale = _.multiplyScalar, 
        _.mag = _.len, _.squaredMagnitude = _.lengthSqr, _.ZERO_R = _.ZERO, _.ONE_R = _.ONE, 
        _.NEG_ONE_R = _.NEG_ONE, n.default.fastDefine("cc.Vec4", _, {
            x: 0,
            y: 0,
            z: 0,
            w: 0
        }), cc.v4 = f, cc.Vec4 = _;
    }, {
        "../platform/CCClass": 182,
        "./utils": 278,
        "./value-type": 279
    } ],
    283: [ function() {
        "use strict";
        cc.js;
    }, {} ],
    284: [ function(t) {
        "use strict";
        t("./core/CCGame"), t("./actions");
    }, {
        "./actions": 7,
        "./core/CCGame": 24
    } ],
    285: [ function(t, e) {
        "use strict";
        var i = t("../core/assets/CCAsset"), n = t("../core/assets/CCSpriteFrame"), r = cc.Class({
            name: "cc.ParticleAsset",
            extends: i,
            properties: {
                spriteFrame: {
                    default: null,
                    type: n
                }
            }
        });
        cc.ParticleAsset = e.exports = r;
    }, {
        "../core/assets/CCAsset": 58,
        "../core/assets/CCSpriteFrame": 70
    } ],
    286: [ function(t, e) {
        "use strict";
        var i, n, r, s, o, a, c, l, u, h, _, f, d, p, m, v, y, g, x, A, C, b, S, T, w, E, B, M, R, P, I, D, V, L, O, F, N, G, k, z, U, H;
        (function(t) {
            t[t.COMPRESSED_RGB_S3TC_DXT1_EXT = 33776] = "COMPRESSED_RGB_S3TC_DXT1_EXT", t[t.COMPRESSED_RGBA_S3TC_DXT1_EXT = 33777] = "COMPRESSED_RGBA_S3TC_DXT1_EXT", 
            t[t.COMPRESSED_RGBA_S3TC_DXT3_EXT = 33778] = "COMPRESSED_RGBA_S3TC_DXT3_EXT", t[t.COMPRESSED_RGBA_S3TC_DXT5_EXT = 33779] = "COMPRESSED_RGBA_S3TC_DXT5_EXT", 
            t[t.COMPRESSED_SRGB_S3TC_DXT1_EXT = 35916] = "COMPRESSED_SRGB_S3TC_DXT1_EXT", t[t.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT = 35917] = "COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT", 
            t[t.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT = 35918] = "COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT", 
            t[t.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT = 35919] = "COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT", 
            t[t.COMPRESSED_RGB_PVRTC_4BPPV1_IMG = 35840] = "COMPRESSED_RGB_PVRTC_4BPPV1_IMG", 
            t[t.COMPRESSED_RGB_PVRTC_2BPPV1_IMG = 35841] = "COMPRESSED_RGB_PVRTC_2BPPV1_IMG", 
            t[t.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG = 35842] = "COMPRESSED_RGBA_PVRTC_4BPPV1_IMG", 
            t[t.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG = 35843] = "COMPRESSED_RGBA_PVRTC_2BPPV1_IMG", 
            t[t.COMPRESSED_RGB_ETC1_WEBGL = 36196] = "COMPRESSED_RGB_ETC1_WEBGL";
        })(i || (i = {})), function(t) {
            t[t.UNKNOWN = 0] = "UNKNOWN", t[t.BUFFER = 1] = "BUFFER", t[t.TEXTURE = 2] = "TEXTURE", 
            t[t.TEXTURE_VIEW = 3] = "TEXTURE_VIEW", t[t.RENDER_PASS = 4] = "RENDER_PASS", t[t.FRAMEBUFFER = 5] = "FRAMEBUFFER", 
            t[t.SAMPLER = 6] = "SAMPLER", t[t.SHADER = 7] = "SHADER", t[t.PIPELINE_LAYOUT = 8] = "PIPELINE_LAYOUT", 
            t[t.PIPELINE_STATE = 9] = "PIPELINE_STATE", t[t.BINDING_LAYOUT = 10] = "BINDING_LAYOUT", 
            t[t.INPUT_ASSEMBLER = 11] = "INPUT_ASSEMBLER", t[t.COMMAND_ALLOCATOR = 12] = "COMMAND_ALLOCATOR", 
            t[t.COMMAND_BUFFER = 13] = "COMMAND_BUFFER", t[t.QUEUE = 14] = "QUEUE", t[t.WINDOW = 15] = "WINDOW";
        }(n || (n = {})), function(t) {
            t[t.UNREADY = 0] = "UNREADY", t[t.FAILED = 1] = "FAILED", t[t.SUCCESS = 2] = "SUCCESS";
        }(r || (r = {})), function() {
            function t(t) {
                this._gfxType = n.UNKNOWN, this._status = r.UNREADY, this._gfxType = t;
            }
            Object.defineProperty(t.prototype, "gfxType", {
                get: function() {
                    return this._gfxType;
                },
                enumerable: !0,
                configurable: !0
            }), Object.defineProperty(t.prototype, "status", {
                get: function() {
                    return this._status;
                },
                enumerable: !0,
                configurable: !0
            });
        }(), function(t) {
            t.ATTR_POSITION = "a_position", t.ATTR_NORMAL = "a_normal", t.ATTR_TANGENT = "a_tangent", 
            t.ATTR_BITANGENT = "a_bitangent", t.ATTR_WEIGHTS = "a_weights", t.ATTR_JOINTS = "a_joints", 
            t.ATTR_COLOR = "a_color", t.ATTR_COLOR1 = "a_color1", t.ATTR_COLOR2 = "a_color2", 
            t.ATTR_TEX_COORD = "a_texCoord", t.ATTR_TEX_COORD1 = "a_texCoord1", t.ATTR_TEX_COORD2 = "a_texCoord2", 
            t.ATTR_TEX_COORD3 = "a_texCoord3", t.ATTR_TEX_COORD4 = "a_texCoord4", t.ATTR_TEX_COORD5 = "a_texCoord5", 
            t.ATTR_TEX_COORD6 = "a_texCoord6", t.ATTR_TEX_COORD7 = "a_texCoord7", t.ATTR_TEX_COORD8 = "a_texCoord8";
        }(s || (s = {})), function(t) {
            t[t.UNKNOWN = 0] = "UNKNOWN", t[t.BOOL = 1] = "BOOL", t[t.BOOL2 = 2] = "BOOL2", 
            t[t.BOOL3 = 3] = "BOOL3", t[t.BOOL4 = 4] = "BOOL4", t[t.INT = 5] = "INT", t[t.INT2 = 6] = "INT2", 
            t[t.INT3 = 7] = "INT3", t[t.INT4 = 8] = "INT4", t[t.UINT = 9] = "UINT", t[t.UINT2 = 10] = "UINT2", 
            t[t.UINT3 = 11] = "UINT3", t[t.UINT4 = 12] = "UINT4", t[t.FLOAT = 13] = "FLOAT", 
            t[t.FLOAT2 = 14] = "FLOAT2", t[t.FLOAT3 = 15] = "FLOAT3", t[t.FLOAT4 = 16] = "FLOAT4", 
            t[t.COLOR4 = 17] = "COLOR4", t[t.MAT2 = 18] = "MAT2", t[t.MAT2X3 = 19] = "MAT2X3", 
            t[t.MAT2X4 = 20] = "MAT2X4", t[t.MAT3X2 = 21] = "MAT3X2", t[t.MAT3 = 22] = "MAT3", 
            t[t.MAT3X4 = 23] = "MAT3X4", t[t.MAT4X2 = 24] = "MAT4X2", t[t.MAT4X3 = 25] = "MAT4X3", 
            t[t.MAT4 = 26] = "MAT4", t[t.SAMPLER1D = 27] = "SAMPLER1D", t[t.SAMPLER1D_ARRAY = 28] = "SAMPLER1D_ARRAY", 
            t[t.SAMPLER2D = 29] = "SAMPLER2D", t[t.SAMPLER2D_ARRAY = 30] = "SAMPLER2D_ARRAY", 
            t[t.SAMPLER3D = 31] = "SAMPLER3D", t[t.SAMPLER_CUBE = 32] = "SAMPLER_CUBE", t[t.COUNT = 33] = "COUNT";
        }(o || (o = {})), function(t) {
            t[t.UNKNOWN = 0] = "UNKNOWN", t[t.A8 = 1] = "A8", t[t.L8 = 2] = "L8", t[t.LA8 = 3] = "LA8", 
            t[t.R8 = 4] = "R8", t[t.R8SN = 5] = "R8SN", t[t.R8UI = 6] = "R8UI", t[t.R8I = 7] = "R8I", 
            t[t.R16F = 8] = "R16F", t[t.R16UI = 9] = "R16UI", t[t.R16I = 10] = "R16I", t[t.R32F = 11] = "R32F", 
            t[t.R32UI = 12] = "R32UI", t[t.R32I = 13] = "R32I", t[t.RG8 = 14] = "RG8", t[t.RG8SN = 15] = "RG8SN", 
            t[t.RG8UI = 16] = "RG8UI", t[t.RG8I = 17] = "RG8I", t[t.RG16F = 18] = "RG16F", t[t.RG16UI = 19] = "RG16UI", 
            t[t.RG16I = 20] = "RG16I", t[t.RG32F = 21] = "RG32F", t[t.RG32UI = 22] = "RG32UI", 
            t[t.RG32I = 23] = "RG32I", t[t.RGB8 = 24] = "RGB8", t[t.SRGB8 = 25] = "SRGB8", t[t.RGB8SN = 26] = "RGB8SN", 
            t[t.RGB8UI = 27] = "RGB8UI", t[t.RGB8I = 28] = "RGB8I", t[t.RGB16F = 29] = "RGB16F", 
            t[t.RGB16UI = 30] = "RGB16UI", t[t.RGB16I = 31] = "RGB16I", t[t.RGB32F = 32] = "RGB32F", 
            t[t.RGB32UI = 33] = "RGB32UI", t[t.RGB32I = 34] = "RGB32I", t[t.RGBA8 = 35] = "RGBA8", 
            t[t.SRGB8_A8 = 36] = "SRGB8_A8", t[t.RGBA8SN = 37] = "RGBA8SN", t[t.RGBA8UI = 38] = "RGBA8UI", 
            t[t.RGBA8I = 39] = "RGBA8I", t[t.RGBA16F = 40] = "RGBA16F", t[t.RGBA16UI = 41] = "RGBA16UI", 
            t[t.RGBA16I = 42] = "RGBA16I", t[t.RGBA32F = 43] = "RGBA32F", t[t.RGBA32UI = 44] = "RGBA32UI", 
            t[t.RGBA32I = 45] = "RGBA32I", t[t.R5G6B5 = 46] = "R5G6B5", t[t.R11G11B10F = 47] = "R11G11B10F", 
            t[t.RGB5A1 = 48] = "RGB5A1", t[t.RGBA4 = 49] = "RGBA4", t[t.RGB10A2 = 50] = "RGB10A2", 
            t[t.RGB10A2UI = 51] = "RGB10A2UI", t[t.RGB9E5 = 52] = "RGB9E5", t[t.D16 = 53] = "D16", 
            t[t.D16S8 = 54] = "D16S8", t[t.D24 = 55] = "D24", t[t.D24S8 = 56] = "D24S8", t[t.D32F = 57] = "D32F", 
            t[t.D32F_S8 = 58] = "D32F_S8", t[t.BC1 = 59] = "BC1", t[t.BC1_ALPHA = 60] = "BC1_ALPHA", 
            t[t.BC1_SRGB = 61] = "BC1_SRGB", t[t.BC1_SRGB_ALPHA = 62] = "BC1_SRGB_ALPHA", t[t.BC2 = 63] = "BC2", 
            t[t.BC2_SRGB = 64] = "BC2_SRGB", t[t.BC3 = 65] = "BC3", t[t.BC3_SRGB = 66] = "BC3_SRGB", 
            t[t.BC4 = 67] = "BC4", t[t.BC4_SNORM = 68] = "BC4_SNORM", t[t.BC5 = 69] = "BC5", 
            t[t.BC5_SNORM = 70] = "BC5_SNORM", t[t.BC6H_UF16 = 71] = "BC6H_UF16", t[t.BC6H_SF16 = 72] = "BC6H_SF16", 
            t[t.BC7 = 73] = "BC7", t[t.BC7_SRGB = 74] = "BC7_SRGB", t[t.ETC_RGB8 = 75] = "ETC_RGB8", 
            t[t.ETC2_RGB8 = 76] = "ETC2_RGB8", t[t.ETC2_SRGB8 = 77] = "ETC2_SRGB8", t[t.ETC2_RGB8_A1 = 78] = "ETC2_RGB8_A1", 
            t[t.ETC2_SRGB8_A1 = 79] = "ETC2_SRGB8_A1", t[t.ETC2_RGBA8 = 80] = "ETC2_RGBA8", 
            t[t.ETC2_SRGB8_A8 = 81] = "ETC2_SRGB8_A8", t[t.EAC_R11 = 82] = "EAC_R11", t[t.EAC_R11SN = 83] = "EAC_R11SN", 
            t[t.EAC_RG11 = 84] = "EAC_RG11", t[t.EAC_RG11SN = 85] = "EAC_RG11SN", t[t.PVRTC_RGB2 = 86] = "PVRTC_RGB2", 
            t[t.PVRTC_RGBA2 = 87] = "PVRTC_RGBA2", t[t.PVRTC_RGB4 = 88] = "PVRTC_RGB4", t[t.PVRTC_RGBA4 = 89] = "PVRTC_RGBA4", 
            t[t.PVRTC2_2BPP = 90] = "PVRTC2_2BPP", t[t.PVRTC2_4BPP = 91] = "PVRTC2_4BPP";
        }(a || (a = {})), function(t) {
            t[t.NONE = 0] = "NONE", t[t.TRANSFER_SRC = 1] = "TRANSFER_SRC", t[t.TRANSFER_DST = 2] = "TRANSFER_DST", 
            t[t.INDEX = 4] = "INDEX", t[t.VERTEX = 8] = "VERTEX", t[t.UNIFORM = 16] = "UNIFORM", 
            t[t.STORAGE = 32] = "STORAGE", t[t.INDIRECT = 64] = "INDIRECT";
        }(c || (c = {})), function(t) {
            t[t.NONE = 0] = "NONE", t[t.DEVICE = 1] = "DEVICE", t[t.HOST = 2] = "HOST";
        }(l || (l = {})), function(t) {
            t[t.NONE = 0] = "NONE", t[t.READ = 1] = "READ", t[t.WRITE = 2] = "WRITE";
        }(u || (u = {})), function(t) {
            t[t.POINT_LIST = 0] = "POINT_LIST", t[t.LINE_LIST = 1] = "LINE_LIST", t[t.LINE_STRIP = 2] = "LINE_STRIP", 
            t[t.LINE_LOOP = 3] = "LINE_LOOP", t[t.LINE_LIST_ADJACENCY = 4] = "LINE_LIST_ADJACENCY", 
            t[t.LINE_STRIP_ADJACENCY = 5] = "LINE_STRIP_ADJACENCY", t[t.ISO_LINE_LIST = 6] = "ISO_LINE_LIST", 
            t[t.TRIANGLE_LIST = 7] = "TRIANGLE_LIST", t[t.TRIANGLE_STRIP = 8] = "TRIANGLE_STRIP", 
            t[t.TRIANGLE_FAN = 9] = "TRIANGLE_FAN", t[t.TRIANGLE_LIST_ADJACENCY = 10] = "TRIANGLE_LIST_ADJACENCY", 
            t[t.TRIANGLE_STRIP_ADJACENCY = 11] = "TRIANGLE_STRIP_ADJACENCY", t[t.TRIANGLE_PATCH_ADJACENCY = 12] = "TRIANGLE_PATCH_ADJACENCY", 
            t[t.QUAD_PATCH_LIST = 13] = "QUAD_PATCH_LIST";
        }(h || (h = {})), function(t) {
            t[t.FILL = 0] = "FILL", t[t.POINT = 1] = "POINT", t[t.LINE = 2] = "LINE";
        }(_ || (_ = {})), function(t) {
            t[t.GOURAND = 0] = "GOURAND", t[t.FLAT = 1] = "FLAT";
        }(f || (f = {})), function(t) {
            t[t.NONE = 0] = "NONE", t[t.FRONT = 1] = "FRONT", t[t.BACK = 2] = "BACK";
        }(d || (d = {})), function(t) {
            t[t.NEVER = 0] = "NEVER", t[t.LESS = 1] = "LESS", t[t.EQUAL = 2] = "EQUAL", t[t.LESS_EQUAL = 3] = "LESS_EQUAL", 
            t[t.GREATER = 4] = "GREATER", t[t.NOT_EQUAL = 5] = "NOT_EQUAL", t[t.GREATER_EQUAL = 6] = "GREATER_EQUAL", 
            t[t.ALWAYS = 7] = "ALWAYS";
        }(p || (p = {})), function(t) {
            t[t.ZERO = 0] = "ZERO", t[t.KEEP = 1] = "KEEP", t[t.REPLACE = 2] = "REPLACE", t[t.INCR = 3] = "INCR", 
            t[t.DECR = 4] = "DECR", t[t.INVERT = 5] = "INVERT", t[t.INCR_WRAP = 6] = "INCR_WRAP", 
            t[t.DECR_WRAP = 7] = "DECR_WRAP";
        }(m || (m = {})), function(t) {
            t[t.ADD = 0] = "ADD", t[t.SUB = 1] = "SUB", t[t.REV_SUB = 2] = "REV_SUB", t[t.MIN = 3] = "MIN", 
            t[t.MAX = 4] = "MAX";
        }(v || (v = {})), function(t) {
            t[t.ZERO = 0] = "ZERO", t[t.ONE = 1] = "ONE", t[t.SRC_ALPHA = 2] = "SRC_ALPHA", 
            t[t.DST_ALPHA = 3] = "DST_ALPHA", t[t.ONE_MINUS_SRC_ALPHA = 4] = "ONE_MINUS_SRC_ALPHA", 
            t[t.ONE_MINUS_DST_ALPHA = 5] = "ONE_MINUS_DST_ALPHA", t[t.SRC_COLOR = 6] = "SRC_COLOR", 
            t[t.DST_COLOR = 7] = "DST_COLOR", t[t.ONE_MINUS_SRC_COLOR = 8] = "ONE_MINUS_SRC_COLOR", 
            t[t.ONE_MINUS_DST_COLOR = 9] = "ONE_MINUS_DST_COLOR", t[t.SRC_ALPHA_SATURATE = 10] = "SRC_ALPHA_SATURATE", 
            t[t.CONSTANT_COLOR = 11] = "CONSTANT_COLOR", t[t.ONE_MINUS_CONSTANT_COLOR = 12] = "ONE_MINUS_CONSTANT_COLOR", 
            t[t.CONSTANT_ALPHA = 13] = "CONSTANT_ALPHA", t[t.ONE_MINUS_CONSTANT_ALPHA = 14] = "ONE_MINUS_CONSTANT_ALPHA";
        }(y || (y = {})), function(t) {
            t[t.NONE = 0] = "NONE", t[t.R = 1] = "R", t[t.G = 2] = "G", t[t.B = 4] = "B", t[t.A = 8] = "A", 
            t[t.ALL = 15] = "ALL";
        }(g || (g = {})), function(t) {
            t[t.NONE = 0] = "NONE", t[t.POINT = 1] = "POINT", t[t.LINEAR = 2] = "LINEAR", t[t.ANISOTROPIC = 3] = "ANISOTROPIC";
        }(x || (x = {})), function(t) {
            t[t.WRAP = 0] = "WRAP", t[t.MIRROR = 1] = "MIRROR", t[t.CLAMP = 2] = "CLAMP", t[t.BORDER = 3] = "BORDER";
        }(A || (A = {})), function(t) {
            t[t.TEX1D = 0] = "TEX1D", t[t.TEX2D = 1] = "TEX2D", t[t.TEX3D = 2] = "TEX3D";
        }(C || (C = {})), function(t) {
            t[t.NONE = 0] = "NONE", t[t.TRANSFER_SRC = 1] = "TRANSFER_SRC", t[t.TRANSFER_DST = 2] = "TRANSFER_DST", 
            t[t.SAMPLED = 4] = "SAMPLED", t[t.STORAGE = 8] = "STORAGE", t[t.COLOR_ATTACHMENT = 16] = "COLOR_ATTACHMENT", 
            t[t.DEPTH_STENCIL_ATTACHMENT = 32] = "DEPTH_STENCIL_ATTACHMENT", t[t.TRANSIENT_ATTACHMENT = 64] = "TRANSIENT_ATTACHMENT", 
            t[t.INPUT_ATTACHMENT = 128] = "INPUT_ATTACHMENT";
        }(b || (b = {})), function(t) {
            t[t.X1 = 0] = "X1", t[t.X2 = 1] = "X2", t[t.X4 = 2] = "X4", t[t.X8 = 3] = "X8", 
            t[t.X16 = 4] = "X16", t[t.X32 = 5] = "X32", t[t.X64 = 6] = "X64";
        }(S || (S = {})), function(t) {
            t[t.NONE = 0] = "NONE", t[t.GEN_MIPMAP = 1] = "GEN_MIPMAP", t[t.CUBEMAP = 2] = "CUBEMAP", 
            t[t.BAKUP_BUFFER = 4] = "BAKUP_BUFFER";
        }(T || (T = {})), function(t) {
            t[t.TV1D = 0] = "TV1D", t[t.TV2D = 1] = "TV2D", t[t.TV3D = 2] = "TV3D", t[t.CUBE = 3] = "CUBE", 
            t[t.TV1D_ARRAY = 4] = "TV1D_ARRAY", t[t.TV2D_ARRAY = 5] = "TV2D_ARRAY";
        }(w || (w = {})), function(t) {
            t[t.VERTEX = 0] = "VERTEX", t[t.HULL = 1] = "HULL", t[t.DOMAIN = 2] = "DOMAIN", 
            t[t.GEOMETRY = 3] = "GEOMETRY", t[t.FRAGMENT = 4] = "FRAGMENT", t[t.COMPUTE = 5] = "COMPUTE", 
            t[t.COUNT = 6] = "COUNT";
        }(E || (E = {})), function(t) {
            t[t.UNKNOWN = 0] = "UNKNOWN", t[t.UNIFORM_BUFFER = 1] = "UNIFORM_BUFFER", t[t.SAMPLER = 2] = "SAMPLER", 
            t[t.STORAGE_BUFFER = 3] = "STORAGE_BUFFER";
        }(B || (B = {})), function(t) {
            t[t.PRIMARY = 0] = "PRIMARY", t[t.SECONDARY = 1] = "SECONDARY";
        }(M || (M = {})), function(t) {
            t[t.LOAD = 0] = "LOAD", t[t.CLEAR = 1] = "CLEAR", t[t.DISCARD = 2] = "DISCARD";
        }(R || (R = {})), function(t) {
            t[t.STORE = 0] = "STORE", t[t.DISCARD = 1] = "DISCARD";
        }(P || (P = {})), function(t) {
            t[t.UNDEFINED = 0] = "UNDEFINED", t[t.GENERAL = 1] = "GENERAL", t[t.COLOR_ATTACHMENT_OPTIMAL = 2] = "COLOR_ATTACHMENT_OPTIMAL", 
            t[t.DEPTH_STENCIL_ATTACHMENT_OPTIMAL = 3] = "DEPTH_STENCIL_ATTACHMENT_OPTIMAL", 
            t[t.DEPTH_STENCIL_READONLY_OPTIMAL = 4] = "DEPTH_STENCIL_READONLY_OPTIMAL", t[t.SHADER_READONLY_OPTIMAL = 5] = "SHADER_READONLY_OPTIMAL", 
            t[t.TRANSFER_SRC_OPTIMAL = 6] = "TRANSFER_SRC_OPTIMAL", t[t.TRANSFER_DST_OPTIMAL = 7] = "TRANSFER_DST_OPTIMAL", 
            t[t.PREINITIALIZED = 8] = "PREINITIALIZED", t[t.PRESENT_SRC = 9] = "PRESENT_SRC";
        }(I || (I = {})), function(t) {
            t[t.GRAPHICS = 0] = "GRAPHICS", t[t.COMPUTE = 1] = "COMPUTE", t[t.RAY_TRACING = 2] = "RAY_TRACING";
        }(D || (D = {})), function(t) {
            t[t.VIEWPORT = 0] = "VIEWPORT", t[t.SCISSOR = 1] = "SCISSOR", t[t.LINE_WIDTH = 2] = "LINE_WIDTH", 
            t[t.DEPTH_BIAS = 3] = "DEPTH_BIAS", t[t.BLEND_CONSTANTS = 4] = "BLEND_CONSTANTS", 
            t[t.DEPTH_BOUNDS = 5] = "DEPTH_BOUNDS", t[t.STENCIL_WRITE_MASK = 6] = "STENCIL_WRITE_MASK", 
            t[t.STENCIL_COMPARE_MASK = 7] = "STENCIL_COMPARE_MASK";
        }(V || (V = {})), function(t) {
            t[t.FRONT = 0] = "FRONT", t[t.BACK = 1] = "BACK", t[t.ALL = 2] = "ALL";
        }(L || (L = {})), function(t) {
            t[t.GRAPHICS = 0] = "GRAPHICS", t[t.COMPUTE = 1] = "COMPUTE", t[t.TRANSFER = 2] = "TRANSFER";
        }(O || (O = {})), function(t) {
            t[t.NONE = 0] = "NONE", t[t.COLOR = 1] = "COLOR", t[t.DEPTH = 2] = "DEPTH", t[t.STENCIL = 4] = "STENCIL", 
            t[t.DEPTH_STENCIL = 6] = "DEPTH_STENCIL", t[t.ALL = 7] = "ALL";
        }(F || (F = {})), function(t) {
            t[t.DEFAULT = 100] = "DEFAULT";
        }(N || (N = {})), function(t) {
            t[t.MIN = 0] = "MIN", t[t.MAX = 255] = "MAX", t[t.DEFAULT = 128] = "DEFAULT";
        }(G || (G = {})), function(t) {
            t[t.UBO_GLOBAL = 23] = "UBO_GLOBAL", t[t.UBO_SHADOW = 22] = "UBO_SHADOW", t[t.UBO_LOCAL = 21] = "UBO_LOCAL", 
            t[t.UBO_FORWARD_LIGHTS = 20] = "UBO_FORWARD_LIGHTS", t[t.UBO_SKINNING = 19] = "UBO_SKINNING", 
            t[t.UBO_SKINNING_TEXTURE = 18] = "UBO_SKINNING_TEXTURE", t[t.UBO_UI = 17] = "UBO_UI", 
            t[t.SAMPLER_JOINTS = 25] = "SAMPLER_JOINTS", t[t.SAMPLER_ENVIRONMENT = 26] = "SAMPLER_ENVIRONMENT", 
            t[t.CUSTUM_UBO_BINDING_END_POINT = 17] = "CUSTUM_UBO_BINDING_END_POINT", t[t.CUSTOM_SAMPLER_BINDING_START_POINT = 30] = "CUSTOM_SAMPLER_BINDING_START_POINT";
        }(k || (k = {})), function(t) {
            t[t.minFilter = 0] = "minFilter", t[t.magFilter = 1] = "magFilter", t[t.mipFilter = 2] = "mipFilter", 
            t[t.addressU = 3] = "addressU", t[t.addressV = 4] = "addressV", t[t.addressW = 5] = "addressW", 
            t[t.maxAnisotropy = 6] = "maxAnisotropy", t[t.cmpFunc = 7] = "cmpFunc", t[t.minLOD = 8] = "minLOD", 
            t[t.maxLOD = 9] = "maxLOD", t[t.mipLODBias = 10] = "mipLODBias", t[t.borderColor = 11] = "borderColor", 
            t[t.total = 15] = "total";
        }(H || (H = {}));
        var W = {};
        W[W.bool = o.BOOL] = "bool", W[W.int = o.INT] = "int", W[W.ivec2 = o.INT2] = "ivec2invTypeParams", 
        W[W.ivec3 = o.INT3] = "ivec3", W[W.ivec4 = o.INT4] = "ivec4", W[W.float = o.FLOAT] = "float", 
        W[W.vec2 = o.FLOAT2] = "vec2", W[W.vec3 = o.FLOAT3] = "vec3", W[W.vec4 = o.FLOAT4] = "vec4", 
        W[W.mat2 = o.MAT2] = "mat2", W[W.mat3 = o.MAT3] = "mat3", W[W.mat4 = o.MAT4] = "mat4", 
        W[W.sampler2D = o.SAMPLER2D] = "sampler2D", W[W.samplerCube = o.SAMPLER_CUBE] = "samplerCube";
        var j = ((z = {})[o.BOOL] = 4, z[o.INT] = 4, z[o.INT2] = 8, z[o.INT3] = 12, z[o.INT4] = 16, 
        z[o.FLOAT] = 4, z[o.FLOAT2] = 8, z[o.FLOAT3] = 12, z[o.FLOAT4] = 16, z[o.MAT2] = 16, 
        z[o.MAT3] = 36, z[o.MAT4] = 64, z[o.SAMPLER2D] = 4, z[o.SAMPLER_CUBE] = 4, z), q = ((U = {})[o.BOOL] = a.R32I, 
        U[o.INT] = a.R32I, U[o.INT2] = a.RG32I, U[o.INT3] = a.RGB32I, U[o.INT4] = a.RGBA32I, 
        U[o.FLOAT] = a.R32F, U[o.FLOAT2] = a.RG32F, U[o.FLOAT3] = a.RGB32F, U[o.FLOAT4] = a.RGBA32F, 
        U), X = {
            BACK: 1029,
            FRONT: 1028,
            NONE: 0,
            ADD: 32774,
            SUB: 32778,
            REV_SUB: 32779,
            ZERO: 0,
            ONE: 1,
            SRC_COLOR: 768,
            ONE_MINUS_SRC_COLOR: 769,
            DST_COLOR: 774,
            ONE_MINUS_DST_COLOR: 775,
            SRC_ALPHA: 770,
            ONE_MINUS_SRC_ALPHA: 771,
            DST_ALPHA: 772,
            ONE_MINUS_DST_ALPHA: 773,
            CONSTANT_COLOR: 32769,
            ONE_MINUS_CONSTANT_COLOR: 32770,
            CONSTANT_ALPHA: 32771,
            ONE_MINUS_CONSTANT_ALPHA: 32772,
            SRC_ALPHA_SATURATE: 776,
            NEVER: 512,
            LESS: 513,
            EQUAL: 514,
            LEQUAL: 515,
            GREATER: 516,
            NOTEQUAL: 517,
            GEQUAL: 518,
            ALWAYS: 519,
            KEEP: 7680,
            REPLACE: 7681,
            INCR: 7682,
            INCR_WRAP: 34055,
            DECR: 7683,
            DECR_WRAP: 34056,
            INVERT: 5386
        };
        Object.assign(X, N);
        var Y = {
            murmurhash2_32_gc: function(t, e) {
                for (var i, n = t.length, r = e ^ n, s = 0; n >= 4; ) i = 1540483477 * (65535 & (i = 255 & t.charCodeAt(s) | (255 & t.charCodeAt(++s)) << 8 | (255 & t.charCodeAt(++s)) << 16 | (255 & t.charCodeAt(++s)) << 24)) + ((1540483477 * (i >>> 16) & 65535) << 16), 
                r = 1540483477 * (65535 & r) + ((1540483477 * (r >>> 16) & 65535) << 16) ^ (i = 1540483477 * (65535 & (i ^= i >>> 24)) + ((1540483477 * (i >>> 16) & 65535) << 16)), 
                n -= 4, ++s;
                switch (n) {
                  case 3:
                    r ^= (255 & t.charCodeAt(s + 2)) << 16;

                  case 2:
                    r ^= (255 & t.charCodeAt(s + 1)) << 8;

                  case 1:
                    r = 1540483477 * (65535 & (r ^= 255 & t.charCodeAt(s))) + ((1540483477 * (r >>> 16) & 65535) << 16);
                }
                return r = 1540483477 * (65535 & (r ^= r >>> 13)) + ((1540483477 * (r >>> 16) & 65535) << 16), 
                (r ^= r >>> 15) >>> 0;
            },
            SamplerInfoIndex: H,
            effectStructure: {
                $techniques: [ {
                    $passes: [ {
                        depthStencilState: {},
                        rasterizerState: {},
                        blendState: {
                            targets: [ {} ]
                        },
                        properties: {
                            any: {
                                sampler: {},
                                inspector: {}
                            }
                        }
                    } ]
                } ]
            },
            typeMap: W,
            sizeMap: j,
            formatMap: q,
            passParams: X,
            RenderQueue: {
                OPAQUE: 0,
                TRANSPARENT: 1,
                OVERLAY: 2
            },
            RenderPriority: G,
            GFXGetTypeSize: function(t) {
                switch (t) {
                  case o.BOOL:
                  case o.INT:
                  case o.UINT:
                  case o.FLOAT:
                    return 4;

                  case o.BOOL2:
                  case o.INT2:
                  case o.UINT2:
                  case o.FLOAT2:
                    return 8;

                  case o.BOOL3:
                  case o.INT3:
                  case o.UINT3:
                  case o.FLOAT3:
                    return 12;

                  case o.BOOL4:
                  case o.INT4:
                  case o.UINT4:
                  case o.FLOAT4:
                  case o.MAT2:
                    return 16;

                  case o.MAT2X3:
                    return 24;

                  case o.MAT2X4:
                    return 32;

                  case o.MAT3X2:
                    return 24;

                  case o.MAT3:
                    return 36;

                  case o.MAT3X4:
                    return 48;

                  case o.MAT4X2:
                  case o.MAT4X2:
                    return 32;

                  case o.MAT4:
                    return 64;

                  case o.SAMPLER1D:
                  case o.SAMPLER1D_ARRAY:
                  case o.SAMPLER2D:
                  case o.SAMPLER2D_ARRAY:
                  case o.SAMPLER3D:
                  case o.SAMPLER_CUBE:
                    return 4;

                  default:
                    return 0;
                }
            },
            UniformBinding: k
        };
        e.exports = Y;
    }, {} ],
    287: [ function(t, e, i) {
        "use strict";
        i.__esModule = !0, i.default = void 0;
        var n = t("../memop"), r = l(t("../enums")), s = t("../../core/value-types"), o = l(t("./program-lib")), a = l(t("./view")), c = l(t("../gfx"));
        function l(t) {
            return t && t.__esModule ? t : {
                default: t
            };
        }
        var u = new s.Mat4(), h = new n.RecyclePool(function() {
            return {
                stage: null,
                items: null
            };
        }, 8), _ = new n.RecyclePool(function() {
            return new Float32Array(2);
        }, 8), f = new n.RecyclePool(function() {
            return new Float32Array(3);
        }, 8), d = new n.RecyclePool(function() {
            return new Float32Array(4);
        }, 8), p = new n.RecyclePool(function() {
            return new Float32Array(9);
        }, 8), m = new n.RecyclePool(function() {
            return new Float32Array(16);
        }, 8), v = new n.RecyclePool(function() {
            return new Float32Array(64);
        }, 8), y = new n.RecyclePool(function() {
            return new Int32Array(2);
        }, 8), g = new n.RecyclePool(function() {
            return new Int32Array(3);
        }, 8), x = new n.RecyclePool(function() {
            return new Int32Array(4);
        }, 8), A = new n.RecyclePool(function() {
            return new Int32Array(64);
        }, 8), C = function() {
            function t(t, e) {
                var i;
                this._device = t, this._programLib = new o.default(t), this._opts = e, this._type2defaultValue = ((i = {})[r.default.PARAM_INT] = 0, 
                i[r.default.PARAM_INT2] = new s.Vec2(0, 0), i[r.default.PARAM_INT3] = new s.Vec3(0, 0, 0), 
                i[r.default.PARAM_INT4] = new s.Vec4(0, 0, 0, 0), i[r.default.PARAM_FLOAT] = 0, 
                i[r.default.PARAM_FLOAT2] = new s.Vec2(0, 0), i[r.default.PARAM_FLOAT3] = new s.Vec3(0, 0, 0), 
                i[r.default.PARAM_FLOAT4] = new s.Vec4(0, 0, 0, 0), i[r.default.PARAM_COLOR4] = new s.Color(0, 0, 0, 1), 
                i[r.default.PARAM_MAT3] = new s.Mat3(), i[r.default.PARAM_MAT4] = new s.Mat4(), 
                i[r.default.PARAM_TEXTURE_2D] = e.defaultTexture, i[r.default.PARAM_TEXTURE_CUBE] = e.defaultTextureCube, 
                i), this._stage2fn = {}, this._usedTextureUnits = 0, this._viewPools = new n.RecyclePool(function() {
                    return new a.default();
                }, 8), this._drawItemsPools = new n.RecyclePool(function() {
                    return {
                        model: null,
                        node: null,
                        ia: null,
                        effect: null,
                        defines: null,
                        uniforms: null
                    };
                }, 100), this._stageItemsPools = new n.RecyclePool(function() {
                    return new n.RecyclePool(function() {
                        return {
                            model: null,
                            node: null,
                            ia: null,
                            effect: null,
                            defines: null,
                            passes: [],
                            sortKey: -1,
                            uniforms: null
                        };
                    }, 100);
                }, 16);
            }
            var e = t.prototype;
            return e._resetTextuerUnit = function() {
                this._usedTextureUnits = 0;
            }, e._allocTextureUnit = function() {
                var t = this._device, e = this._usedTextureUnits;
                return e >= t._caps.maxTextureUnits && console.warn("Trying to use " + e + " texture units while this GPU supports only " + t._caps.maxTextureUnits), 
                this._usedTextureUnits += 1, e;
            }, e._registerStage = function(t, e) {
                this._stage2fn[t] = e;
            }, e.clear = function() {
                this._programLib.clear(), this.reset();
            }, e.reset = function() {
                this._viewPools.reset(), this._stageItemsPools.reset();
            }, e._requestView = function() {
                return this._viewPools.add();
            }, e._render = function(t, e) {
                var i = this._device;
                i.setFrameBuffer(t._framebuffer), i.setViewport(t._rect.x, t._rect.y, t._rect.w, t._rect.h);
                var n = {};
                t._clearFlags & r.default.CLEAR_COLOR && (n.color = s.Vec4.toArray([], t._color)), 
                t._clearFlags & r.default.CLEAR_DEPTH && (n.depth = t._depth), t._clearFlags & r.default.CLEAR_STENCIL && (n.stencil = t._stencil), 
                i.clear(n), this._drawItemsPools.reset();
                for (var o = 0; o < e._models.length; ++o) {
                    var a = e._models.data[o];
                    if (0 != (a._cullingMask & t._cullingMask)) {
                        var c = this._drawItemsPools.add();
                        a.extractDrawItem(c);
                    }
                }
                h.reset();
                for (var l = 0; l < t._stages.length; ++l) {
                    var u = t._stages[l], _ = this._stageItemsPools.add();
                    _.reset();
                    for (var f = 0; f < this._drawItemsPools.length; ++f) {
                        var d = this._drawItemsPools.data[f], p = d.effect.stagePasses[u];
                        if (p && 0 !== p.length) {
                            var m = _.add();
                            m.passes = p, m.model = d.model, m.node = d.node, m.ia = d.ia, m.effect = d.effect, 
                            m.defines = d.defines, m.sortKey = -1, m.uniforms = d.uniforms;
                        }
                    }
                    var v = h.add();
                    v.stage = u, v.items = _;
                }
                for (var y = 0; y < h.length; ++y) {
                    var g = h.data[y];
                    (0, this._stage2fn[g.stage])(t, g.items);
                }
            }, e._setProperty = function(t) {
                var e = this._device, i = t.value;
                if (void 0 === i && (i = t.val), void 0 === i && (i = this._type2defaultValue[t.type]), 
                void 0 !== i) if (t.type === r.default.PARAM_TEXTURE_2D || t.type === r.default.PARAM_TEXTURE_CUBE) if (Array.isArray(i)) {
                    if (i.length > t.count) return void console.error("Failed to set property [" + t.name + "] : The length of texture array [" + i.length + "] is bigger than [" + t.count + "].");
                    for (var n = A.add(), s = 0; s < i.length; ++s) n[s] = this._allocTextureUnit();
                    e.setTextureArray(t.name, i, n);
                } else e.setTexture(t.name, i, this._allocTextureUnit()); else t.directly ? e.setUniformDirectly(t.name, i) : e.setUniform(t.name, i); else console.warn("Failed to set technique property " + t.name + ", value not found.");
            }, e._draw = function(t) {
                var e = this._device, i = this._programLib, n = t.node, r = t.ia, o = t.passes, a = t.effect;
                _.reset(), f.reset(), d.reset(), p.reset(), m.reset(), v.reset(), y.reset(), g.reset(), 
                x.reset(), A.reset(), n.getWorldMatrix(u), e.setUniform("cc_matWorld", s.Mat4.toArray(m.add(), u)), 
                s.Mat4.invert(u, u), s.Mat4.transpose(u, u), e.setUniform("cc_matWorldIT", s.Mat4.toArray(m.add(), u));
                for (var l = this._defines, h = 0; h < o.length; ++h) {
                    var C = o[h], b = r.count;
                    r._vertexBuffer && e.setVertexBuffer(0, r._vertexBuffer), r._indexBuffer && e.setIndexBuffer(r._indexBuffer), 
                    e.setPrimitiveType(r._primitiveType), Object.setPrototypeOf(l, C._defines);
                    var S = i.getProgram(C._programName, l, a.name);
                    e.setProgram(S);
                    for (var T = S._uniforms, w = C._properties, E = 0; E < T.length; E++) {
                        var B = w[T[E].name];
                        void 0 !== B && this._setProperty(B);
                    }
                    e.setCullMode(C._cullMode), C._blend && (e.enableBlend(), e.setBlendFuncSep(C._blendSrc, C._blendDst, C._blendSrcAlpha, C._blendDstAlpha), 
                    e.setBlendEqSep(C._blendEq, C._blendAlphaEq), e.setBlendColor32(C._blendColor)), 
                    C._depthTest && (e.enableDepthTest(), e.setDepthFunc(C._depthFunc)), C._depthWrite && e.enableDepthWrite(), 
                    e.setStencilTest(C._stencilTest), C._stencilTest === c.default.STENCIL_ENABLE && (e.setStencilFuncFront(C._stencilFuncFront, C._stencilRefFront, C._stencilMaskFront), 
                    e.setStencilOpFront(C._stencilFailOpFront, C._stencilZFailOpFront, C._stencilZPassOpFront, C._stencilWriteMaskFront), 
                    e.setStencilFuncBack(C._stencilFuncBack, C._stencilRefBack, C._stencilMaskBack), 
                    e.setStencilOpBack(C._stencilFailOpBack, C._stencilZFailOpBack, C._stencilZPassOpBack, C._stencilWriteMaskBack)), 
                    e.draw(r._start, b), this._resetTextuerUnit();
                }
            }, t;
        }();
        i.default = C, e.exports = i.default;
    }, {
        "../../core/value-types": 271,
        "../enums": 293,
        "../gfx": 298,
        "../memop": 310,
        "./program-lib": 290,
        "./view": 292
    } ],
    288: [ function(t, e, i) {
        "use strict";
        i.__esModule = !0, i.default = void 0;
        var n, r = (n = t("../gfx")) && n.__esModule ? n : {
            default: n
        };
        function s(t, e) {
            for (var i = 0; i < e.length; i++) {
                var n = e[i];
                n.enumerable = n.enumerable || !1, n.configurable = !0, "value" in n && (n.writable = !0), 
                Object.defineProperty(t, n.key, n);
            }
        }
        var o = function() {
            function t(t, e, i) {
                void 0 === i && (i = r.default.PT_TRIANGLES), this._vertexBuffer = t, this._indexBuffer = e, 
                this._primitiveType = i, this._start = 0, this._count = -1;
            }
            var e, i;
            return e = t, (i = [ {
                key: "count",
                get: function() {
                    return -1 !== this._count ? this._count : this._indexBuffer ? this._indexBuffer.count : this._vertexBuffer ? this._vertexBuffer.count : 0;
                }
            } ]) && s(e.prototype, i), t;
        }();
        i.default = o, e.exports = i.default;
    }, {
        "../gfx": 298
    } ],
    289: [ function(t, e, i) {
        "use strict";
        i.__esModule = !0, i.default = void 0;
        var n = o(t("../gfx")), r = o(t("../enums")), s = o(t("../../core/value-types/value-type"));
        function o(t) {
            return t && t.__esModule ? t : {
                default: t
            };
        }
        var a = function() {
            function t(t, e, i, r, s, o) {
                void 0 === s && (s = {}), void 0 === o && (o = {}), this._name = t, this._detailName = e, 
                this._programName = i, this._stage = r, this._properties = s, this._defines = o, 
                this._cullMode = n.default.CULL_BACK, this._blend = !1, this._blendEq = n.default.BLEND_FUNC_ADD, 
                this._blendAlphaEq = n.default.BLEND_FUNC_ADD, this._blendSrc = n.default.BLEND_SRC_ALPHA, 
                this._blendDst = n.default.BLEND_ONE_MINUS_SRC_ALPHA, this._blendSrcAlpha = n.default.BLEND_SRC_ALPHA, 
                this._blendDstAlpha = n.default.BLEND_ONE_MINUS_SRC_ALPHA, this._blendColor = 4294967295, 
                this._depthTest = !1, this._depthWrite = !1, this._depthFunc = n.default.DS_FUNC_LESS, 
                this._stencilTest = n.default.STENCIL_INHERIT, this._stencilFuncFront = n.default.DS_FUNC_ALWAYS, 
                this._stencilRefFront = 0, this._stencilMaskFront = 255, this._stencilFailOpFront = n.default.STENCIL_OP_KEEP, 
                this._stencilZFailOpFront = n.default.STENCIL_OP_KEEP, this._stencilZPassOpFront = n.default.STENCIL_OP_KEEP, 
                this._stencilWriteMaskFront = 255, this._stencilFuncBack = n.default.DS_FUNC_ALWAYS, 
                this._stencilRefBack = 0, this._stencilMaskBack = 255, this._stencilFailOpBack = n.default.STENCIL_OP_KEEP, 
                this._stencilZFailOpBack = n.default.STENCIL_OP_KEEP, this._stencilZPassOpBack = n.default.STENCIL_OP_KEEP, 
                this._stencilWriteMaskBack = 255;
            }
            var e = t.prototype;
            return e.setCullMode = function(t) {
                void 0 === t && (t = n.default.CULL_BACK), this._cullMode = t;
            }, e.setBlend = function(t, e, i, r, s, o, a, c) {
                void 0 === t && (t = !1), void 0 === e && (e = n.default.BLEND_FUNC_ADD), void 0 === i && (i = n.default.BLEND_SRC_ALPHA), 
                void 0 === r && (r = n.default.BLEND_ONE_MINUS_SRC_ALPHA), void 0 === s && (s = n.default.BLEND_FUNC_ADD), 
                void 0 === o && (o = n.default.BLEND_SRC_ALPHA), void 0 === a && (a = n.default.BLEND_ONE_MINUS_SRC_ALPHA), 
                void 0 === c && (c = 4294967295), this._blend = t, this._blendEq = e, this._blendSrc = i, 
                this._blendDst = r, this._blendAlphaEq = s, this._blendSrcAlpha = o, this._blendDstAlpha = a, 
                this._blendColor = c;
            }, e.setDepth = function(t, e, i) {
                void 0 === t && (t = !1), void 0 === e && (e = !1), void 0 === i && (i = n.default.DS_FUNC_LESS), 
                this._depthTest = t, this._depthWrite = e, this._depthFunc = i;
            }, e.setStencilFront = function(t, e, i, r, s, o, a, c) {
                void 0 === t && (t = n.default.STENCIL_INHERIT), void 0 === e && (e = n.default.DS_FUNC_ALWAYS), 
                void 0 === i && (i = 0), void 0 === r && (r = 255), void 0 === s && (s = n.default.STENCIL_OP_KEEP), 
                void 0 === o && (o = n.default.STENCIL_OP_KEEP), void 0 === a && (a = n.default.STENCIL_OP_KEEP), 
                void 0 === c && (c = 255), this._stencilTest = t, this._stencilFuncFront = e, this._stencilRefFront = i, 
                this._stencilMaskFront = r, this._stencilFailOpFront = s, this._stencilZFailOpFront = o, 
                this._stencilZPassOpFront = a, this._stencilWriteMaskFront = c;
            }, e.setStencilEnabled = function(t) {
                void 0 === t && (t = n.default.STENCIL_INHERIT), this._stencilTest = t;
            }, e.setStencilBack = function(t, e, i, r, s, o, a, c) {
                void 0 === t && (t = n.default.STENCIL_INHERIT), void 0 === e && (e = n.default.DS_FUNC_ALWAYS), 
                void 0 === i && (i = 0), void 0 === r && (r = 255), void 0 === s && (s = n.default.STENCIL_OP_KEEP), 
                void 0 === o && (o = n.default.STENCIL_OP_KEEP), void 0 === a && (a = n.default.STENCIL_OP_KEEP), 
                void 0 === c && (c = 255), this._stencilTest = t, this._stencilFuncBack = e, this._stencilRefBack = i, 
                this._stencilMaskBack = r, this._stencilFailOpBack = s, this._stencilZFailOpBack = o, 
                this._stencilZPassOpBack = a, this._stencilWriteMaskBack = c;
            }, e.setStage = function(t) {
                this._stage = t;
            }, e.setProperties = function(t) {
                this._properties = t;
            }, e.getProperty = function(t) {
                if (this._properties[t]) return this._properties[t].value;
            }, e.setProperty = function(t, e, i) {
                var n = this._properties[t];
                if (!n) return !1;
                if (n.directly = i, Array.isArray(e)) {
                    var o = n.value;
                    if (o.length !== e.length) return void cc.warnID(9105, this._name, t);
                    for (var a = 0; a < e.length; a++) o[a] = e[a];
                } else e && !ArrayBuffer.isView(e) ? n.type === r.default.PARAM_TEXTURE_2D ? n.value = e.getImpl() : e instanceof s.default ? e.constructor.toArray(n.value, e) : ("object" == typeof e && cc.warnID(9106, this._name, t), 
                n.value = e) : n.value = e;
                return !0;
            }, e.getDefine = function(t) {
                return this._defines[t];
            }, e.define = function(t, e, i) {
                return !(!i && void 0 === this._defines[t]) && (this._defines[t] = e, !0);
            }, e.clone = function() {
                var e = new t(this._programName);
                Object.assign(e, this);
                var i = {}, n = this._properties;
                for (var r in n) {
                    var s = n[r], o = i[r] = {}, a = s.value;
                    for (var c in Array.isArray(a) ? o.value = a.concat() : ArrayBuffer.isView(a) ? o.value = new a.__proto__.constructor(a) : o.value = a, 
                    s) "value" !== c && (o[c] = s[c]);
                }
                return e._properties = i, e._defines = Object.assign({}, this._defines), e;
            }, t;
        }();
        i.default = a, e.exports = i.default;
    }, {
        "../../core/value-types/value-type": 279,
        "../enums": 293,
        "../gfx": 298
    } ],
    290: [ function(t, e, i) {
        "use strict";
        i.__esModule = !0, i.default = void 0;
        var n, r = (n = t("../gfx")) && n.__esModule ? n : {
            default: n
        }, s = 0;
        function o(t, e) {
            for (var i = [], n = 0; n < t.length; n++) {
                var r = t[n].name, s = e[r];
                "number" != typeof s && (s = s ? 1 : 0), i.push("#define " + r + " " + s);
            }
            return i.join("\n") + "\n";
        }
        function a(t, e, i) {
            for (var n = t, r = 0; r < e.length; r++) {
                var s = e[r].name, o = i[s];
                if (Number.isInteger(o)) {
                    var a = new RegExp(s, "g");
                    n = n.replace(a, o);
                }
            }
            return n;
        }
        function c(t) {
            return t.replace(/#pragma for (\w+) in range\(\s*(\d+)\s*,\s*(\d+)\s*\)([\s\S]+?)#pragma endFor/g, function(t, e, i, n, r) {
                var s = "", o = parseInt(i), a = parseInt(n);
                (o.isNaN || a.isNaN) && console.error("Unroll For Loops Error: begin and end of range must be an int num.");
                for (var c = o; c < a; ++c) s += r.replace(new RegExp("{" + e + "}", "g"), c);
                return s;
            });
        }
        function l(t) {
            return t.replace(/\bhighp\b/g, "mediump");
        }
        var u = function() {
            function t(t) {
                this._device = t, this._templates = {}, this._cache = {}, this._checkPrecision();
            }
            var e = t.prototype;
            return e.clear = function() {
                this._templates = {}, this._cache = {};
            }, e.define = function(t) {
                var e = t.name, i = t.defines, n = t.glsl1 || t, r = n.vert, o = n.frag;
                if (!this._templates[e]) {
                    for (var a = ++s, c = 0, l = 0; l < i.length; ++l) {
                        var u = i[l], h = 1;
                        if ("number" === u.type) {
                            var _ = u.range || [];
                            u.min = _[0] || 0, u.max = _[1] || 4, h = Math.ceil(Math.log2(u.max - u.min)), u._map = function(t) {
                                return t - this.min << this._offset;
                            }.bind(u);
                        } else u._map = function(t) {
                            return t ? 1 << this._offset : 0;
                        }.bind(u);
                        u._offset = c, c += h;
                    }
                    var f = t.uniforms || [];
                    if (t.samplers) for (var d = 0; d < t.samplers.length; d++) f.push(t.samplers[d]);
                    if (t.blocks) for (var p = 0; p < t.blocks.length; p++) for (var m = t.blocks[p].defines, v = t.blocks[p].members, y = 0; y < v.length; y++) f.push({
                        defines: m,
                        name: v[y].name,
                        type: v[y].type
                    });
                    this._templates[e] = {
                        id: a,
                        name: e,
                        vert: r,
                        frag: o,
                        defines: i,
                        attributes: t.attributes,
                        uniforms: f,
                        extensions: t.extensions
                    };
                }
            }, e.getTemplate = function(t) {
                return this._templates[t];
            }, e.hasProgram = function(t) {
                return void 0 !== this._templates[t];
            }, e.getKey = function(t, e) {
                for (var i = this._templates[t], n = 0, r = 0; r < i.defines.length; ++r) {
                    var s = i.defines[r], o = e[s.name];
                    void 0 !== o && (n |= s._map(o));
                }
                return i.id + ":" + n;
            }, e.getProgram = function(t, e, i) {
                var n = this.getKey(t, e), s = this._cache[n];
                if (s) return s;
                var u = this._templates[t], h = o(u.defines, e), _ = a(u.vert, u.defines, e);
                _ = h + c(_), this._highpSupported || (_ = l(_));
                var f = a(u.frag, u.defines, e);
                f = h + c(f), this._highpSupported || (f = l(f));
                var d = (s = new r.default.Program(this._device, {
                    vert: _,
                    frag: f
                })).link();
                if (d) {
                    var p = _.split("\n"), m = f.split("\n"), v = u.defines.length;
                    d.forEach(function(t) {
                        var e = t.line - 1, n = t.line - v, r = ("vs" === t.type ? p : m)[e], s = t.info || "Failed to compile " + t.type + " " + t.fileID + " (ln " + n + "): \n " + t.message + ": \n  " + r;
                        cc.error(i + " : " + s);
                    });
                }
                return this._cache[n] = s, s;
            }, e._checkPrecision = function() {
                var t = this._device._gl, e = !1;
                if (t.getShaderPrecisionFormat) {
                    var i = t.getShaderPrecisionFormat(t.VERTEX_SHADER, t.HIGH_FLOAT), n = t.getShaderPrecisionFormat(t.FRAGMENT_SHADER, t.HIGH_FLOAT);
                    e = i && i.precision > 0 && n && n.precision > 0;
                }
                e || cc.warnID(9102), this._highpSupported = e;
            }, t;
        }();
        i.default = u, e.exports = i.default;
    }, {
        "../gfx": 298
    } ],
    291: [ function(t, e, i) {
        "use strict";
        function n(t, e) {
            for (var i = 0; i < e.length; i++) {
                var n = e[i];
                n.enumerable = n.enumerable || !1, n.configurable = !0, "value" in n && (n.writable = !0), 
                Object.defineProperty(t, n.key, n);
            }
        }
        i.__esModule = !0, i.default = void 0;
        var r = function() {
            function t(t, e) {
                this._name = t, this._passes = e;
            }
            var e, i;
            return t.prototype.clone = function() {
                for (var e = [], i = 0; i < this._passes.length; i++) e.push(this._passes[i].clone());
                return new t(this._name, e);
            }, e = t, (i = [ {
                key: "name",
                get: function() {
                    return this._name;
                }
            }, {
                key: "passes",
                get: function() {
                    return this._passes;
                }
            } ]) && n(e.prototype, i), t;
        }();
        i.default = r, e.exports = i.default;
    }, {} ],
    292: [ function(t, e, i) {
        "use strict";
        i.__esModule = !0, i.default = void 0;
        var n, r = t("../../core/value-types"), s = (n = t("../enums")) && n.__esModule ? n : {
            default: n
        }, o = new r.Mat4(), a = 0, c = function() {
            function t() {
                this._id = a++, this._priority = 0, this._rect = {
                    x: 0,
                    y: 0,
                    w: 1,
                    h: 1
                }, this._color = new r.Vec4(.3, .3, .3, 1), this._depth = 1, this._stencil = 0, 
                this._clearFlags = s.default.CLEAR_COLOR | s.default.CLEAR_DEPTH, this._clearModel = null, 
                this._matView = cc.mat4(), this._matViewInv = cc.mat4(), this._matProj = cc.mat4(), 
                this._matViewProj = cc.mat4(), this._matInvViewProj = cc.mat4(), this._stages = [], 
                this._cullingByID = !1, this._framebuffer = null, this._shadowLight = null, this._cullingMask = 4294967295;
            }
            var e = t.prototype;
            return e.getForward = function(t) {
                var e = this._matView.m;
                return r.Vec3.set(t, -e[2], -e[6], -e[10]);
            }, e.getPosition = function(t) {
                return r.Mat4.invert(o, this._matView), r.Mat4.getTranslation(t, o);
            }, t;
        }();
        i.default = c, e.exports = i.default;
    }, {
        "../../core/value-types": 271,
        "../enums": 293
    } ],
    293: [ function(t, e, i) {
        "use strict";
        i.__esModule = !0, i.default = void 0;
        var n = t("./build/mappings"), r = {
            PROJ_PERSPECTIVE: 0,
            PROJ_ORTHO: 1,
            LIGHT_DIRECTIONAL: 0,
            LIGHT_POINT: 1,
            LIGHT_SPOT: 2,
            LIGHT_AMBIENT: 3,
            SHADOW_NONE: 0,
            SHADOW_HARD: 1,
            SHADOW_SOFT: 2,
            PARAM_INT: n.typeMap.int,
            PARAM_INT2: n.typeMap.ivec2,
            PARAM_INT3: n.typeMap.ivec3,
            PARAM_INT4: n.typeMap.ivec4,
            PARAM_FLOAT: n.typeMap.float,
            PARAM_FLOAT2: n.typeMap.vec2,
            PARAM_FLOAT3: n.typeMap.vec3,
            PARAM_FLOAT4: n.typeMap.vec4,
            PARAM_MAT2: n.typeMap.mat2,
            PARAM_MAT3: n.typeMap.mat3,
            PARAM_MAT4: n.typeMap.mat4,
            PARAM_TEXTURE_2D: n.typeMap.sampler2D,
            PARAM_TEXTURE_CUBE: n.typeMap.samplerCube,
            CLEAR_COLOR: 1,
            CLEAR_DEPTH: 2,
            CLEAR_STENCIL: 4,
            CLEAR_SKYBOX: 8,
            BUFFER_VIEW_INT8: 0,
            BUFFER_VIEW_UINT8: 1,
            BUFFER_VIEW_INT16: 2,
            BUFFER_VIEW_UINT16: 3,
            BUFFER_VIEW_INT32: 4,
            BUFFER_VIEW_UINT32: 5,
            BUFFER_VIEW_FLOAT32: 6
        };
        i.default = r, e.exports = i.default;
    }, {
        "./build/mappings": 286
    } ],
    294: [ function(t, e, i) {
        "use strict";
        i.__esModule = !0, i.default = void 0;
        var n, r, s = l(t("./state")), o = t("./enums"), a = l(t("./texture-2d")), c = l(t("./texture-cube"));
        function l(t) {
            return t && t.__esModule ? t : {
                default: t
            };
        }
        function u(t, e) {
            for (var i = 0; i < e.length; i++) {
                var n = e[i];
                n.enumerable = n.enumerable || !1, n.configurable = !0, "value" in n && (n.writable = !0), 
                Object.defineProperty(t, n.key, n);
            }
        }
        var h = ((n = {})[5124] = function(t, e, i) {
            t.uniform1i(e, i);
        }, n[5126] = function(t, e, i) {
            t.uniform1f(e, i);
        }, n[35664] = function(t, e, i) {
            t.uniform2fv(e, i);
        }, n[35665] = function(t, e, i) {
            t.uniform3fv(e, i);
        }, n[35666] = function(t, e, i) {
            t.uniform4fv(e, i);
        }, n[35667] = function(t, e, i) {
            t.uniform2iv(e, i);
        }, n[35668] = function(t, e, i) {
            t.uniform3iv(e, i);
        }, n[35669] = function(t, e, i) {
            t.uniform4iv(e, i);
        }, n[35670] = function(t, e, i) {
            t.uniform1i(e, i);
        }, n[35671] = function(t, e, i) {
            t.uniform2iv(e, i);
        }, n[35672] = function(t, e, i) {
            t.uniform3iv(e, i);
        }, n[35673] = function(t, e, i) {
            t.uniform4iv(e, i);
        }, n[35674] = function(t, e, i) {
            t.uniformMatrix2fv(e, !1, i);
        }, n[35675] = function(t, e, i) {
            t.uniformMatrix3fv(e, !1, i);
        }, n[35676] = function(t, e, i) {
            t.uniformMatrix4fv(e, !1, i);
        }, n[35678] = function(t, e, i) {
            t.uniform1i(e, i);
        }, n[35680] = function(t, e, i) {
            t.uniform1i(e, i);
        }, n), _ = ((r = {})[5124] = function(t, e, i) {
            t.uniform1iv(e, i);
        }, r[5126] = function(t, e, i) {
            t.uniform1fv(e, i);
        }, r[35664] = function(t, e, i) {
            t.uniform2fv(e, i);
        }, r[35665] = function(t, e, i) {
            t.uniform3fv(e, i);
        }, r[35666] = function(t, e, i) {
            t.uniform4fv(e, i);
        }, r[35667] = function(t, e, i) {
            t.uniform2iv(e, i);
        }, r[35668] = function(t, e, i) {
            t.uniform3iv(e, i);
        }, r[35669] = function(t, e, i) {
            t.uniform4iv(e, i);
        }, r[35670] = function(t, e, i) {
            t.uniform1iv(e, i);
        }, r[35671] = function(t, e, i) {
            t.uniform2iv(e, i);
        }, r[35672] = function(t, e, i) {
            t.uniform3iv(e, i);
        }, r[35673] = function(t, e, i) {
            t.uniform4iv(e, i);
        }, r[35674] = function(t, e, i) {
            t.uniformMatrix2fv(e, !1, i);
        }, r[35675] = function(t, e, i) {
            t.uniformMatrix3fv(e, !1, i);
        }, r[35676] = function(t, e, i) {
            t.uniformMatrix4fv(e, !1, i);
        }, r[35678] = function(t, e, i) {
            t.uniform1iv(e, i);
        }, r[35680] = function(t, e, i) {
            t.uniform1iv(e, i);
        }, r);
        function f(t, e, i) {
            if (e.blend !== i.blend) return i.blend ? (t.enable(t.BLEND), i.blendSrc !== o.enums.BLEND_CONSTANT_COLOR && i.blendSrc !== o.enums.BLEND_ONE_MINUS_CONSTANT_COLOR && i.blendDst !== o.enums.BLEND_CONSTANT_COLOR && i.blendDst !== o.enums.BLEND_ONE_MINUS_CONSTANT_COLOR || t.blendColor((i.blendColor >> 24) / 255, (i.blendColor >> 16 & 255) / 255, (i.blendColor >> 8 & 255) / 255, (255 & i.blendColor) / 255), 
            void (i.blendSep ? (t.blendFuncSeparate(i.blendSrc, i.blendDst, i.blendSrcAlpha, i.blendDstAlpha), 
            t.blendEquationSeparate(i.blendEq, i.blendAlphaEq)) : (t.blendFunc(i.blendSrc, i.blendDst), 
            t.blendEquation(i.blendEq)))) : void t.disable(t.BLEND);
            !1 !== i.blend && (e.blendColor !== i.blendColor && t.blendColor((i.blendColor >> 24) / 255, (i.blendColor >> 16 & 255) / 255, (i.blendColor >> 8 & 255) / 255, (255 & i.blendColor) / 255), 
            e.blendSep === i.blendSep ? i.blendSep ? (e.blendSrc === i.blendSrc && e.blendDst === i.blendDst && e.blendSrcAlpha === i.blendSrcAlpha && e.blendDstAlpha === i.blendDstAlpha || t.blendFuncSeparate(i.blendSrc, i.blendDst, i.blendSrcAlpha, i.blendDstAlpha), 
            e.blendEq === i.blendEq && e.blendAlphaEq === i.blendAlphaEq || t.blendEquationSeparate(i.blendEq, i.blendAlphaEq)) : (e.blendSrc === i.blendSrc && e.blendDst === i.blendDst || t.blendFunc(i.blendSrc, i.blendDst), 
            e.blendEq !== i.blendEq && t.blendEquation(i.blendEq)) : i.blendSep ? (t.blendFuncSeparate(i.blendSrc, i.blendDst, i.blendSrcAlpha, i.blendDstAlpha), 
            t.blendEquationSeparate(i.blendEq, i.blendAlphaEq)) : (t.blendFunc(i.blendSrc, i.blendDst), 
            t.blendEquation(i.blendEq)));
        }
        function d(t, e, i) {
            if (e.depthTest !== i.depthTest) return i.depthTest ? (t.enable(t.DEPTH_TEST), t.depthFunc(i.depthFunc), 
            void t.depthMask(i.depthWrite)) : void t.disable(t.DEPTH_TEST);
            e.depthWrite !== i.depthWrite && t.depthMask(i.depthWrite), !1 !== i.depthTest ? e.depthFunc !== i.depthFunc && t.depthFunc(i.depthFunc) : i.depthWrite && (i.depthTest = !0, 
            i.depthFunc = o.enums.DS_FUNC_ALWAYS, t.enable(t.DEPTH_TEST), t.depthFunc(i.depthFunc));
        }
        function p(t, e, i) {
            if (i.stencilTest !== o.enums.STENCIL_INHERIT) return i.stencilTest !== e.stencilTest ? i.stencilTest === o.enums.STENCIL_DISABLE ? void t.disable(t.STENCIL_TEST) : (t.enable(t.STENCIL_TEST), 
            void (i.stencilSep ? (t.stencilFuncSeparate(t.FRONT, i.stencilFuncFront, i.stencilRefFront, i.stencilMaskFront), 
            t.stencilMaskSeparate(t.FRONT, i.stencilWriteMaskFront), t.stencilOpSeparate(t.FRONT, i.stencilFailOpFront, i.stencilZFailOpFront, i.stencilZPassOpFront), 
            t.stencilFuncSeparate(t.BACK, i.stencilFuncBack, i.stencilRefBack, i.stencilMaskBack), 
            t.stencilMaskSeparate(t.BACK, i.stencilWriteMaskBack), t.stencilOpSeparate(t.BACK, i.stencilFailOpBack, i.stencilZFailOpBack, i.stencilZPassOpBack)) : (t.stencilFunc(i.stencilFuncFront, i.stencilRefFront, i.stencilMaskFront), 
            t.stencilMask(i.stencilWriteMaskFront), t.stencilOp(i.stencilFailOpFront, i.stencilZFailOpFront, i.stencilZPassOpFront)))) : void (i.stencilTest !== o.enums.STENCIL_DISABLE && (e.stencilSep === i.stencilSep ? i.stencilSep ? (e.stencilFuncFront === i.stencilFuncFront && e.stencilRefFront === i.stencilRefFront && e.stencilMaskFront === i.stencilMaskFront || t.stencilFuncSeparate(t.FRONT, i.stencilFuncFront, i.stencilRefFront, i.stencilMaskFront), 
            e.stencilWriteMaskFront !== i.stencilWriteMaskFront && t.stencilMaskSeparate(t.FRONT, i.stencilWriteMaskFront), 
            e.stencilFailOpFront === i.stencilFailOpFront && e.stencilZFailOpFront === i.stencilZFailOpFront && e.stencilZPassOpFront === i.stencilZPassOpFront || t.stencilOpSeparate(t.FRONT, i.stencilFailOpFront, i.stencilZFailOpFront, i.stencilZPassOpFront), 
            e.stencilFuncBack === i.stencilFuncBack && e.stencilRefBack === i.stencilRefBack && e.stencilMaskBack === i.stencilMaskBack || t.stencilFuncSeparate(t.BACK, i.stencilFuncBack, i.stencilRefBack, i.stencilMaskBack), 
            e.stencilWriteMaskBack !== i.stencilWriteMaskBack && t.stencilMaskSeparate(t.BACK, i.stencilWriteMaskBack), 
            e.stencilFailOpBack === i.stencilFailOpBack && e.stencilZFailOpBack === i.stencilZFailOpBack && e.stencilZPassOpBack === i.stencilZPassOpBack || t.stencilOpSeparate(t.BACK, i.stencilFailOpBack, i.stencilZFailOpBack, i.stencilZPassOpBack)) : (e.stencilFuncFront === i.stencilFuncFront && e.stencilRefFront === i.stencilRefFront && e.stencilMaskFront === i.stencilMaskFront || t.stencilFunc(i.stencilFuncFront, i.stencilRefFront, i.stencilMaskFront), 
            e.stencilWriteMaskFront !== i.stencilWriteMaskFront && t.stencilMask(i.stencilWriteMaskFront), 
            e.stencilFailOpFront === i.stencilFailOpFront && e.stencilZFailOpFront === i.stencilZFailOpFront && e.stencilZPassOpFront === i.stencilZPassOpFront || t.stencilOp(i.stencilFailOpFront, i.stencilZFailOpFront, i.stencilZPassOpFront)) : i.stencilSep ? (t.stencilFuncSeparate(t.FRONT, i.stencilFuncFront, i.stencilRefFront, i.stencilMaskFront), 
            t.stencilMaskSeparate(t.FRONT, i.stencilWriteMaskFront), t.stencilOpSeparate(t.FRONT, i.stencilFailOpFront, i.stencilZFailOpFront, i.stencilZPassOpFront), 
            t.stencilFuncSeparate(t.BACK, i.stencilFuncBack, i.stencilRefBack, i.stencilMaskBack), 
            t.stencilMaskSeparate(t.BACK, i.stencilWriteMaskBack), t.stencilOpSeparate(t.BACK, i.stencilFailOpBack, i.stencilZFailOpBack, i.stencilZPassOpBack)) : (t.stencilFunc(i.stencilFuncFront, i.stencilRefFront, i.stencilMaskFront), 
            t.stencilMask(i.stencilWriteMaskFront), t.stencilOp(i.stencilFailOpFront, i.stencilZFailOpFront, i.stencilZPassOpFront))));
        }
        function m(t, e, i) {
            e.cullMode !== i.cullMode && (i.cullMode !== o.enums.CULL_NONE ? (t.enable(t.CULL_FACE), 
            t.cullFace(i.cullMode)) : t.disable(t.CULL_FACE));
        }
        function v(t, e, i, n) {
            var r = !1;
            if (-1 !== n.maxStream) {
                if (i.maxStream !== n.maxStream) r = !0; else if (i.program !== n.program) r = !0; else for (var s = 0; s < n.maxStream + 1; ++s) if (i.vertexBuffers[s] !== n.vertexBuffers[s] || i.vertexBufferOffsets[s] !== n.vertexBufferOffsets[s]) {
                    r = !0;
                    break;
                }
                if (r) {
                    for (var o = 0; o < t._caps.maxVertexAttribs; ++o) t._newAttributes[o] = 0;
                    for (var a = 0; a < n.maxStream + 1; ++a) {
                        var c = n.vertexBuffers[a], l = n.vertexBufferOffsets[a];
                        if (c && -1 !== c._glID) {
                            e.bindBuffer(e.ARRAY_BUFFER, c._glID);
                            for (var u = 0; u < n.program._attributes.length; ++u) {
                                var h = n.program._attributes[u], _ = c._format.element(h.name);
                                _ ? (0 === t._enabledAttributes[h.location] && (e.enableVertexAttribArray(h.location), 
                                t._enabledAttributes[h.location] = 1), t._newAttributes[h.location] = 1, e.vertexAttribPointer(h.location, _.num, _.type, _.normalize, _.stride, _.offset + l * _.stride)) : console.warn("Can not find vertex attribute: " + h.name);
                            }
                        }
                    }
                    for (var f = 0; f < t._caps.maxVertexAttribs; ++f) t._enabledAttributes[f] !== t._newAttributes[f] && (e.disableVertexAttribArray(f), 
                    t._enabledAttributes[f] = 0);
                }
            }
        }
        function y(t, e, i) {
            for (var n = 0; n < i.maxTextureSlot + 1; ++n) if (e.textureUnits[n] !== i.textureUnits[n]) {
                var r = i.textureUnits[n];
                r && -1 !== r._glID && (t.activeTexture(t.TEXTURE0 + n), t.bindTexture(r._target, r._glID));
            }
        }
        function g(t, e, i, n) {
            void 0 === n && (n = 0), i instanceof a.default ? t.framebufferTexture2D(t.FRAMEBUFFER, e, t.TEXTURE_2D, i._glID, 0) : i instanceof c.default ? t.framebufferTexture2D(t.FRAMEBUFFER, e, t.TEXTURE_CUBE_MAP_POSITIVE_X + n, i._glID, 0) : t.framebufferRenderbuffer(t.FRAMEBUFFER, e, t.RENDERBUFFER, i._glID);
        }
        var x = function() {
            var t, e;
            function i(t, e) {
                var i;
                void 0 === (e = e || {}).alpha && (e.alpha = !1), void 0 === e.stencil && (e.stencil = !0), 
                void 0 === e.depth && (e.depth = !0), void 0 === e.antialias && (e.antialias = !1), 
                void 0 === e.preserveDrawingBuffer && (e.preserveDrawingBuffer = !1);
                try {
                    i = t.getContext("webgl", e) || t.getContext("experimental-webgl", e) || t.getContext("webkit-3d", e) || t.getContext("moz-webgl", e);
                } catch (r) {
                    return void console.error(r);
                }
                i || console.error("This device does not support webgl"), this._gl = i, this._extensions = {}, 
                this._caps = {}, this._stats = {
                    texture: 0,
                    vb: 0,
                    ib: 0,
                    drawcalls: 0
                }, this._initExtensions([ "EXT_texture_filter_anisotropic", "EXT_shader_texture_lod", "OES_standard_derivatives", "OES_texture_float", "OES_texture_float_linear", "OES_texture_half_float", "OES_texture_half_float_linear", "OES_vertex_array_object", "WEBGL_compressed_texture_atc", "WEBGL_compressed_texture_etc", "WEBGL_compressed_texture_etc1", "WEBGL_compressed_texture_pvrtc", "WEBGL_compressed_texture_s3tc", "WEBGL_depth_texture", "WEBGL_draw_buffers" ]), 
                this._initCaps(), this._initStates(), s.default.initDefault(this), this._current = new s.default(this), 
                this._next = new s.default(this), this._uniforms = {}, this._vx = this._vy = this._vw = this._vh = 0, 
                this._sx = this._sy = this._sw = this._sh = 0, this._framebuffer = null, this._enabledAttributes = new Array(this._caps.maxVertexAttribs), 
                this._newAttributes = new Array(this._caps.maxVertexAttribs);
                for (var n = 0; n < this._caps.maxVertexAttribs; ++n) this._enabledAttributes[n] = 0, 
                this._newAttributes[n] = 0;
            }
            t = i, (e = [ {
                key: "caps",
                get: function() {
                    return this._caps;
                }
            } ]) && u(t.prototype, e);
            var n = i.prototype;
            return n._initExtensions = function(t) {
                for (var e = this._gl, i = 0; i < t.length; ++i) for (var n = t[i], r = [ "", "WEBKIT_", "MOZ_" ], s = 0; s < r.length; s++) try {
                    var o = e.getExtension(r[s] + n);
                    if (o) {
                        this._extensions[n] = o;
                        break;
                    }
                } catch (a) {
                    console.error(a);
                }
            }, n._initCaps = function() {
                var t = this._gl, e = this.ext("WEBGL_draw_buffers");
                this._caps.maxVertexStreams = 4, this._caps.maxVertexTextures = t.getParameter(t.MAX_VERTEX_TEXTURE_IMAGE_UNITS), 
                this._caps.maxFragUniforms = t.getParameter(t.MAX_FRAGMENT_UNIFORM_VECTORS), this._caps.maxTextureUnits = t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS), 
                this._caps.maxVertexAttribs = t.getParameter(t.MAX_VERTEX_ATTRIBS), this._caps.maxTextureSize = t.getParameter(t.MAX_TEXTURE_SIZE), 
                this._caps.maxDrawBuffers = e ? t.getParameter(e.MAX_DRAW_BUFFERS_WEBGL) : 1, this._caps.maxColorAttachments = e ? t.getParameter(e.MAX_COLOR_ATTACHMENTS_WEBGL) : 1;
            }, n._initStates = function() {
                var t = this._gl;
                t.disable(t.BLEND), t.blendFunc(t.ONE, t.ZERO), t.blendEquation(t.FUNC_ADD), t.blendColor(1, 1, 1, 1), 
                t.colorMask(!0, !0, !0, !0), t.enable(t.CULL_FACE), t.cullFace(t.BACK), t.disable(t.DEPTH_TEST), 
                t.depthFunc(t.LESS), t.depthMask(!1), t.disable(t.POLYGON_OFFSET_FILL), t.depthRange(0, 1), 
                t.disable(t.STENCIL_TEST), t.stencilFunc(t.ALWAYS, 0, 255), t.stencilMask(255), 
                t.stencilOp(t.KEEP, t.KEEP, t.KEEP), t.clearDepth(1), t.clearColor(0, 0, 0, 0), 
                t.clearStencil(0), t.disable(t.SCISSOR_TEST);
            }, n._restoreTexture = function(t) {
                var e = this._gl, i = this._current.textureUnits[t];
                i && -1 !== i._glID ? e.bindTexture(i._target, i._glID) : e.bindTexture(e.TEXTURE_2D, null);
            }, n._restoreIndexBuffer = function() {
                var t = this._gl, e = this._current.indexBuffer;
                e && -1 !== e._glID ? t.bindBuffer(t.ELEMENT_ARRAY_BUFFER, e._glID) : t.bindBuffer(t.ELEMENT_ARRAY_BUFFER, null);
            }, n.ext = function(t) {
                return this._extensions[t];
            }, n.allowFloatTexture = function() {
                return null != this.ext("OES_texture_float");
            }, n.setFrameBuffer = function(t) {
                if (this._framebuffer !== t) {
                    this._framebuffer = t;
                    var e = this._gl;
                    if (t) {
                        e.bindFramebuffer(e.FRAMEBUFFER, t._glID);
                        for (var i = t._colors.length, n = 0; n < i; ++n) {
                            var r = t._colors[n];
                            g(e, e.COLOR_ATTACHMENT0 + n, r);
                        }
                        for (var s = i; s < this._caps.maxColorAttachments; ++s) e.framebufferTexture2D(e.FRAMEBUFFER, e.COLOR_ATTACHMENT0 + s, e.TEXTURE_2D, null, 0);
                        t._depth && g(e, e.DEPTH_ATTACHMENT, t._depth), t._stencil && g(e, e.STENCIL_ATTACHMENT, t._stencil), 
                        t._depthStencil && g(e, e.DEPTH_STENCIL_ATTACHMENT, t._depthStencil);
                    } else e.bindFramebuffer(e.FRAMEBUFFER, null);
                }
            }, n.setViewport = function(t, e, i, n) {
                this._vx === t && this._vy === e && this._vw === i && this._vh === n || (this._gl.viewport(t, e, i, n), 
                this._vx = t, this._vy = e, this._vw = i, this._vh = n);
            }, n.setScissor = function(t, e, i, n) {
                this._sx === t && this._sy === e && this._sw === i && this._sh === n || (this._gl.scissor(t, e, i, n), 
                this._sx = t, this._sy = e, this._sw = i, this._sh = n);
            }, n.clear = function(t) {
                if (void 0 !== t.color || void 0 !== t.depth || void 0 !== t.stencil) {
                    var e = this._gl, i = 0;
                    void 0 !== t.color && (i |= e.COLOR_BUFFER_BIT, e.clearColor(t.color[0], t.color[1], t.color[2], t.color[3])), 
                    void 0 !== t.depth && (i |= e.DEPTH_BUFFER_BIT, e.clearDepth(t.depth), e.enable(e.DEPTH_TEST), 
                    e.depthMask(!0), e.depthFunc(e.ALWAYS)), void 0 !== t.stencil && (i |= e.STENCIL_BUFFER_BIT, 
                    e.clearStencil(t.stencil)), e.clear(i), void 0 !== t.depth && (!1 === this._current.depthTest ? e.disable(e.DEPTH_TEST) : (!1 === this._current.depthWrite && e.depthMask(!1), 
                    this._current.depthFunc !== o.enums.DS_FUNC_ALWAYS && e.depthFunc(this._current.depthFunc)));
                }
            }, n.enableBlend = function() {
                this._next.blend = !0;
            }, n.enableDepthTest = function() {
                this._next.depthTest = !0;
            }, n.enableDepthWrite = function() {
                this._next.depthWrite = !0;
            }, n.setStencilTest = function(t) {
                this._next.stencilTest = t;
            }, n.setStencilFunc = function(t, e, i) {
                this._next.stencilSep = !1, this._next.stencilFuncFront = this._next.stencilFuncBack = t, 
                this._next.stencilRefFront = this._next.stencilRefBack = e, this._next.stencilMaskFront = this._next.stencilMaskBack = i;
            }, n.setStencilFuncFront = function(t, e, i) {
                this._next.stencilSep = !0, this._next.stencilFuncFront = t, this._next.stencilRefFront = e, 
                this._next.stencilMaskFront = i;
            }, n.setStencilFuncBack = function(t, e, i) {
                this._next.stencilSep = !0, this._next.stencilFuncBack = t, this._next.stencilRefBack = e, 
                this._next.stencilMaskBack = i;
            }, n.setStencilOp = function(t, e, i, n) {
                this._next.stencilFailOpFront = this._next.stencilFailOpBack = t, this._next.stencilZFailOpFront = this._next.stencilZFailOpBack = e, 
                this._next.stencilZPassOpFront = this._next.stencilZPassOpBack = i, this._next.stencilWriteMaskFront = this._next.stencilWriteMaskBack = n;
            }, n.setStencilOpFront = function(t, e, i, n) {
                this._next.stencilSep = !0, this._next.stencilFailOpFront = t, this._next.stencilZFailOpFront = e, 
                this._next.stencilZPassOpFront = i, this._next.stencilWriteMaskFront = n;
            }, n.setStencilOpBack = function(t, e, i, n) {
                this._next.stencilSep = !0, this._next.stencilFailOpBack = t, this._next.stencilZFailOpBack = e, 
                this._next.stencilZPassOpBack = i, this._next.stencilWriteMaskBack = n;
            }, n.setDepthFunc = function(t) {
                this._next.depthFunc = t;
            }, n.setBlendColor32 = function(t) {
                this._next.blendColor = t;
            }, n.setBlendColor = function(t, e, i, n) {
                this._next.blendColor = (255 * t << 24 | 255 * e << 16 | 255 * i << 8 | 255 * n) >>> 0;
            }, n.setBlendFunc = function(t, e) {
                this._next.blendSep = !1, this._next.blendSrc = t, this._next.blendDst = e;
            }, n.setBlendFuncSep = function(t, e, i, n) {
                this._next.blendSep = !0, this._next.blendSrc = t, this._next.blendDst = e, this._next.blendSrcAlpha = i, 
                this._next.blendDstAlpha = n;
            }, n.setBlendEq = function(t) {
                this._next.blendSep = !1, this._next.blendEq = t;
            }, n.setBlendEqSep = function(t, e) {
                this._next.blendSep = !0, this._next.blendEq = t, this._next.blendAlphaEq = e;
            }, n.setCullMode = function(t) {
                this._next.cullMode = t;
            }, n.setVertexBuffer = function(t, e, i) {
                void 0 === i && (i = 0), this._next.vertexBuffers[t] = e, this._next.vertexBufferOffsets[t] = i, 
                this._next.maxStream < t && (this._next.maxStream = t);
            }, n.setIndexBuffer = function(t) {
                this._next.indexBuffer = t;
            }, n.setProgram = function(t) {
                this._next.program = t;
            }, n.setTexture = function(t, e, i) {
                i >= this._caps.maxTextureUnits ? console.warn("Can not set texture " + t + " at stage " + i + ", max texture exceed: " + this._caps.maxTextureUnits) : (this._next.textureUnits[i] = e, 
                this.setUniform(t, i), this._next.maxTextureSlot < i && (this._next.maxTextureSlot = i));
            }, n.setTextureArray = function(t, e, i) {
                var n = e.length;
                if (n >= this._caps.maxTextureUnits) console.warn("Can not set " + n + " textures for " + t + ", max texture exceed: " + this._caps.maxTextureUnits); else {
                    for (var r = 0; r < n; ++r) {
                        var s = i[r];
                        this._next.textureUnits[s] = e[r], this._next.maxTextureSlot < s && (this._next.maxTextureSlot = s);
                    }
                    this.setUniform(t, i);
                }
            }, n.setUniform = function(t, e) {
                var i = this._uniforms[t], n = !1, r = !1, s = !1, o = !1;
                do {
                    if (!i) break;
                    if (s = Array.isArray(e) || e instanceof Float32Array, o = e instanceof Int32Array, 
                    r = s || o, i.isArray !== r) break;
                    if (i.isArray && i.value.length !== e.length) break;
                    n = !0;
                } while (0);
                if (n) {
                    var a = i.value, c = !1;
                    if (i.isArray) for (var l = 0, u = a.length; l < u; l++) a[l] !== e[l] && (c = !0, 
                    a[l] = e[l]); else a !== e && (c = !0, i.value = e);
                    c && (i.dirty = !0);
                } else {
                    var h = e;
                    s ? h = new Float32Array(e) : o && (h = new Int32Array(e)), i = {
                        dirty: !0,
                        value: h,
                        isArray: r
                    };
                }
                this._uniforms[t] = i;
            }, n.setUniformDirectly = function(t, e) {
                var i = this._uniforms[t];
                i || (this._uniforms[t] = i = {}), i.dirty = !0, i.value = e;
            }, n.setPrimitiveType = function(t) {
                this._next.primitiveType = t;
            }, n.resetDrawCalls = function() {
                this._stats.drawcalls = 0;
            }, n.getDrawCalls = function() {
                return this._stats.drawcalls;
            }, n.draw = function(t, e) {
                var i = this._gl, n = this._current, r = this._next;
                f(i, n, r), d(i, n, r), p(i, n, r), m(i, n, r), v(this, i, n, r), n.indexBuffer !== r.indexBuffer && i.bindBuffer(i.ELEMENT_ARRAY_BUFFER, r.indexBuffer && -1 !== r.indexBuffer._glID ? r.indexBuffer._glID : null);
                var s = !1;
                n.program !== r.program && (r.program._linked ? i.useProgram(r.program._glID) : console.warn("Failed to use program: has not linked yet."), 
                s = !0), y(i, n, r);
                for (var o = 0; o < r.program._uniforms.length; ++o) {
                    var a = r.program._uniforms[o], c = this._uniforms[a.name];
                    if (c && (s || c.dirty)) {
                        c.dirty = !1;
                        var l = void 0 === a.size ? h[a.type] : _[a.type];
                        l ? l(i, a.location, c.value) : console.warn("Can not find commit function for uniform " + a.name);
                    }
                }
                e && (r.indexBuffer ? i.drawElements(this._next.primitiveType, e, r.indexBuffer._format, t * r.indexBuffer._bytesPerIndex) : i.drawArrays(this._next.primitiveType, t, e), 
                this._stats.drawcalls++), n.set(r), r.reset();
            }, i;
        }();
        i.default = x, e.exports = i.default;
    }, {
        "./enums": 295,
        "./state": 302,
        "./texture-2d": 303,
        "./texture-cube": 304
    } ],
    295: [ function(t, e, i) {
        "use strict";
        i.__esModule = !0, i.attrTypeBytes = function(t) {
            return t === s.ATTR_TYPE_INT8 ? 1 : t === s.ATTR_TYPE_UINT8 ? 1 : t === s.ATTR_TYPE_INT16 ? 2 : t === s.ATTR_TYPE_UINT16 ? 2 : t === s.ATTR_TYPE_INT32 ? 4 : t === s.ATTR_TYPE_UINT32 ? 4 : t === s.ATTR_TYPE_FLOAT32 ? 4 : (console.warn("Unknown ATTR_TYPE: " + t), 
            0);
        }, i.glFilter = function(t, e, i) {
            void 0 === i && (i = -1);
            var r = n[e][i + 1];
            return void 0 === r ? (console.warn("Unknown FILTER: " + e), -1 === i ? t.LINEAR : t.LINEAR_MIPMAP_LINEAR) : r;
        }, i.glTextureFmt = function(t) {
            var e = r[t];
            return void 0 === e ? (console.warn("Unknown TEXTURE_FMT: " + t), r[s.TEXTURE_FMT_RGBA8]) : e;
        }, i.enums = void 0;
        var n = [ [ 9728, 9984, 9986 ], [ 9729, 9985, 9987 ] ], r = [ {
            format: 6407,
            internalFormat: 33776,
            pixelType: null
        }, {
            format: 6408,
            internalFormat: 33777,
            pixelType: null
        }, {
            format: 6408,
            internalFormat: 33778,
            pixelType: null
        }, {
            format: 6408,
            internalFormat: 33779,
            pixelType: null
        }, {
            format: 6407,
            internalFormat: 36196,
            pixelType: null
        }, {
            format: 6407,
            internalFormat: 35841,
            pixelType: null
        }, {
            format: 6408,
            internalFormat: 35843,
            pixelType: null
        }, {
            format: 6407,
            internalFormat: 35840,
            pixelType: null
        }, {
            format: 6408,
            internalFormat: 35842,
            pixelType: null
        }, {
            format: 6406,
            internalFormat: 6406,
            pixelType: 5121
        }, {
            format: 6409,
            internalFormat: 6409,
            pixelType: 5121
        }, {
            format: 6410,
            internalFormat: 6410,
            pixelType: 5121
        }, {
            format: 6407,
            internalFormat: 6407,
            pixelType: 33635
        }, {
            format: 6408,
            internalFormat: 6408,
            pixelType: 32820
        }, {
            format: 6408,
            internalFormat: 6408,
            pixelType: 32819
        }, {
            format: 6407,
            internalFormat: 6407,
            pixelType: 5121
        }, {
            format: 6408,
            internalFormat: 6408,
            pixelType: 5121
        }, {
            format: 6407,
            internalFormat: 6407,
            pixelType: 36193
        }, {
            format: 6408,
            internalFormat: 6408,
            pixelType: 36193
        }, {
            format: 6407,
            internalFormat: 6407,
            pixelType: 5126
        }, {
            format: 6408,
            internalFormat: 6408,
            pixelType: 5126
        }, {
            format: null,
            internalFormat: null,
            pixelType: null
        }, {
            format: null,
            internalFormat: null,
            pixelType: null
        }, {
            format: null,
            internalFormat: null,
            pixelType: null
        }, {
            format: null,
            internalFormat: null,
            pixelType: null
        }, {
            format: 6402,
            internalFormat: 6402,
            pixelType: 5123
        }, {
            format: 6402,
            internalFormat: 6402,
            pixelType: 5125
        }, {
            format: 6402,
            internalFormat: 6402,
            pixelType: 5125
        }, {
            format: 6407,
            internalFormat: 37492,
            pixelType: null
        }, {
            format: 6408,
            internalFormat: 37496,
            pixelType: null
        } ], s = {
            USAGE_STATIC: 35044,
            USAGE_DYNAMIC: 35048,
            USAGE_STREAM: 35040,
            INDEX_FMT_UINT8: 5121,
            INDEX_FMT_UINT16: 5123,
            INDEX_FMT_UINT32: 5125,
            ATTR_POSITION: "a_position",
            ATTR_NORMAL: "a_normal",
            ATTR_TANGENT: "a_tangent",
            ATTR_BITANGENT: "a_bitangent",
            ATTR_WEIGHTS: "a_weights",
            ATTR_JOINTS: "a_joints",
            ATTR_COLOR: "a_color",
            ATTR_COLOR0: "a_color0",
            ATTR_COLOR1: "a_color1",
            ATTR_UV: "a_uv",
            ATTR_UV0: "a_uv0",
            ATTR_UV1: "a_uv1",
            ATTR_UV2: "a_uv2",
            ATTR_UV3: "a_uv3",
            ATTR_UV4: "a_uv4",
            ATTR_UV5: "a_uv5",
            ATTR_UV6: "a_uv6",
            ATTR_UV7: "a_uv7",
            ATTR_TEX_COORD: "a_texCoord",
            ATTR_TEX_COORD1: "a_texCoord1",
            ATTR_TEX_COORD2: "a_texCoord2",
            ATTR_TEX_COORD3: "a_texCoord3",
            ATTR_TEX_COORD4: "a_texCoord4",
            ATTR_TEX_COORD5: "a_texCoord5",
            ATTR_TEX_COORD6: "a_texCoord6",
            ATTR_TEX_COORD7: "a_texCoord7",
            ATTR_TEX_COORD8: "a_texCoord8",
            ATTR_TYPE_INT8: 5120,
            ATTR_TYPE_UINT8: 5121,
            ATTR_TYPE_INT16: 5122,
            ATTR_TYPE_UINT16: 5123,
            ATTR_TYPE_INT32: 5124,
            ATTR_TYPE_UINT32: 5125,
            ATTR_TYPE_FLOAT32: 5126,
            FILTER_NEAREST: 0,
            FILTER_LINEAR: 1,
            WRAP_REPEAT: 10497,
            WRAP_CLAMP: 33071,
            WRAP_MIRROR: 33648,
            TEXTURE_FMT_RGB_DXT1: 0,
            TEXTURE_FMT_RGBA_DXT1: 1,
            TEXTURE_FMT_RGBA_DXT3: 2,
            TEXTURE_FMT_RGBA_DXT5: 3,
            TEXTURE_FMT_RGB_ETC1: 4,
            TEXTURE_FMT_RGB_PVRTC_2BPPV1: 5,
            TEXTURE_FMT_RGBA_PVRTC_2BPPV1: 6,
            TEXTURE_FMT_RGB_PVRTC_4BPPV1: 7,
            TEXTURE_FMT_RGBA_PVRTC_4BPPV1: 8,
            TEXTURE_FMT_A8: 9,
            TEXTURE_FMT_L8: 10,
            TEXTURE_FMT_L8_A8: 11,
            TEXTURE_FMT_R5_G6_B5: 12,
            TEXTURE_FMT_R5_G5_B5_A1: 13,
            TEXTURE_FMT_R4_G4_B4_A4: 14,
            TEXTURE_FMT_RGB8: 15,
            TEXTURE_FMT_RGBA8: 16,
            TEXTURE_FMT_RGB16F: 17,
            TEXTURE_FMT_RGBA16F: 18,
            TEXTURE_FMT_RGB32F: 19,
            TEXTURE_FMT_RGBA32F: 20,
            TEXTURE_FMT_R32F: 21,
            TEXTURE_FMT_111110F: 22,
            TEXTURE_FMT_SRGB: 23,
            TEXTURE_FMT_SRGBA: 24,
            TEXTURE_FMT_D16: 25,
            TEXTURE_FMT_D32: 26,
            TEXTURE_FMT_D24S8: 27,
            TEXTURE_FMT_RGB_ETC2: 28,
            TEXTURE_FMT_RGBA_ETC2: 29,
            DS_FUNC_NEVER: 512,
            DS_FUNC_LESS: 513,
            DS_FUNC_EQUAL: 514,
            DS_FUNC_LEQUAL: 515,
            DS_FUNC_GREATER: 516,
            DS_FUNC_NOTEQUAL: 517,
            DS_FUNC_GEQUAL: 518,
            DS_FUNC_ALWAYS: 519,
            RB_FMT_RGBA4: 32854,
            RB_FMT_RGB5_A1: 32855,
            RB_FMT_RGB565: 36194,
            RB_FMT_D16: 33189,
            RB_FMT_S8: 36168,
            RB_FMT_D24S8: 34041,
            BLEND_FUNC_ADD: 32774,
            BLEND_FUNC_SUBTRACT: 32778,
            BLEND_FUNC_REVERSE_SUBTRACT: 32779,
            BLEND_ZERO: 0,
            BLEND_ONE: 1,
            BLEND_SRC_COLOR: 768,
            BLEND_ONE_MINUS_SRC_COLOR: 769,
            BLEND_DST_COLOR: 774,
            BLEND_ONE_MINUS_DST_COLOR: 775,
            BLEND_SRC_ALPHA: 770,
            BLEND_ONE_MINUS_SRC_ALPHA: 771,
            BLEND_DST_ALPHA: 772,
            BLEND_ONE_MINUS_DST_ALPHA: 773,
            BLEND_CONSTANT_COLOR: 32769,
            BLEND_ONE_MINUS_CONSTANT_COLOR: 32770,
            BLEND_CONSTANT_ALPHA: 32771,
            BLEND_ONE_MINUS_CONSTANT_ALPHA: 32772,
            BLEND_SRC_ALPHA_SATURATE: 776,
            STENCIL_DISABLE: 0,
            STENCIL_ENABLE: 1,
            STENCIL_INHERIT: 2,
            STENCIL_OP_KEEP: 7680,
            STENCIL_OP_ZERO: 0,
            STENCIL_OP_REPLACE: 7681,
            STENCIL_OP_INCR: 7682,
            STENCIL_OP_INCR_WRAP: 34055,
            STENCIL_OP_DECR: 7683,
            STENCIL_OP_DECR_WRAP: 34056,
            STENCIL_OP_INVERT: 5386,
            CULL_NONE: 0,
            CULL_FRONT: 1028,
            CULL_BACK: 1029,
            CULL_FRONT_AND_BACK: 1032,
            PT_POINTS: 0,
            PT_LINES: 1,
            PT_LINE_LOOP: 2,
            PT_LINE_STRIP: 3,
            PT_TRIANGLES: 4,
            PT_TRIANGLE_STRIP: 5,
            PT_TRIANGLE_FAN: 6
        };
        i.enums = s;
    }, {} ],
    296: [ function(t, e, i) {
        "use strict";
        i.__esModule = !0, i.default = void 0;
        var n = function() {
            function t(t, e, i, n) {
                this._device = t, this._width = e, this._height = i, this._colors = n.colors || [], 
                this._depth = n.depth || null, this._stencil = n.stencil || null, this._depthStencil = n.depthStencil || null, 
                this._glID = t._gl.createFramebuffer();
            }
            var e = t.prototype;
            return e.destroy = function() {
                null !== this._glID ? (this._device._gl.deleteFramebuffer(this._glID), this._glID = null) : console.error("The frame-buffer already destroyed");
            }, e.getHandle = function() {
                return this._glID;
            }, t;
        }();
        i.default = n, e.exports = i.default;
    }, {} ],
    297: [ function(t, e, i) {
        "use strict";
        i.__esModule = !0, i.default = void 0;
        var n, r = t("./enums");
        function s(t, e) {
            for (var i = 0; i < e.length; i++) {
                var n = e[i];
                n.enumerable = n.enumerable || !1, n.configurable = !0, "value" in n && (n.writable = !0), 
                Object.defineProperty(t, n.key, n);
            }
        }
        var o = ((n = {})[r.enums.INDEX_FMT_UINT8] = 1, n[r.enums.INDEX_FMT_UINT16] = 2, 
        n[r.enums.INDEX_FMT_UINT32] = 4, n), a = function() {
            function t(t, e, i, n) {
                this._device = t, this._format = e, this._usage = i, this._bytesPerIndex = o[e], 
                this._bytes = n.byteLength, this._numIndices = this._bytes / this._bytesPerIndex, 
                this._needExpandDataStore = !0, this._glID = t._gl.createBuffer(), this.update(0, n), 
                t._stats.ib += this._bytes;
            }
            var e, i, n = t.prototype;
            return n.destroy = function() {
                -1 !== this._glID ? (this._device._gl.deleteBuffer(this._glID), this._device._stats.ib -= this.bytes, 
                this._glID = -1) : console.error("The buffer already destroyed");
            }, n.update = function(t, e) {
                if (-1 !== this._glID) {
                    if (0 !== e.byteLength) {
                        if (t + e.byteLength > this._bytes) {
                            if (t) return void console.error("Failed to update data, bytes exceed.");
                            this._needExpandDataStore = !0, this._bytes = t + e.byteLength, this._numIndices = this._bytes / this._bytesPerIndex;
                        }
                        var i = this._device._gl, n = this._usage;
                        i.bindBuffer(i.ELEMENT_ARRAY_BUFFER, this._glID), this._needExpandDataStore ? (i.bufferData(i.ELEMENT_ARRAY_BUFFER, e, n), 
                        this._needExpandDataStore = !1) : i.bufferSubData(i.ELEMENT_ARRAY_BUFFER, t, e), 
                        this._device._restoreIndexBuffer();
                    }
                } else console.error("The buffer is destroyed");
            }, n.setUsage = function(t) {
                this._usage = t;
            }, e = t, (i = [ {
                key: "count",
                get: function() {
                    return this._numIndices;
                }
            } ]) && s(e.prototype, i), t;
        }();
        a.BYTES_PER_INDEX = o;
        var c = a;
        i.default = c, e.exports = i.default;
    }, {
        "./enums": 295
    } ],
    298: [ function(t, e, i) {
        "use strict";
        i.__esModule = !0, i.default = void 0;
        var n, r = t("./enums");
        n = {
            VertexFormat: t("./vertex-format"),
            IndexBuffer: t("./index-buffer"),
            VertexBuffer: t("./vertex-buffer"),
            Program: t("./program"),
            Texture: t("./texture"),
            Texture2D: t("./texture-2d"),
            TextureCube: t("./texture-cube"),
            RenderBuffer: t("./render-buffer"),
            FrameBuffer: t("./frame-buffer"),
            Device: t("./device"),
            attrTypeBytes: r.attrTypeBytes,
            glFilter: r.glFilter,
            glTextureFmt: r.glTextureFmt
        }, Object.assign(n, r.enums);
        var s = n;
        i.default = s, cc.gfx = n, e.exports = i.default;
    }, {
        "./device": 294,
        "./enums": 295,
        "./frame-buffer": 296,
        "./index-buffer": 297,
        "./program": 300,
        "./render-buffer": 301,
        "./texture": 305,
        "./texture-2d": 303,
        "./texture-cube": 304,
        "./vertex-buffer": 306,
        "./vertex-format": 307
    } ],
    299: [ function(t, e, i) {
        "use strict";
        i.__esModule = !0, i.isPow2 = function(t) {
            return !(t & t - 1 || !t);
        };
    }, {} ],
    300: [ function(t, e, i) {
        "use strict";
        function n(t, e) {
            for (var i = 0; i < e.length; i++) {
                var n = e[i];
                n.enumerable = n.enumerable || !1, n.configurable = !0, "value" in n && (n.writable = !0), 
                Object.defineProperty(t, n.key, n);
            }
        }
        i.__esModule = !0, i.default = void 0;
        var r = 0;
        function s(t, e, i) {
            i.split("\n").forEach(function(i) {
                if (!(i.length < 5)) {
                    var n = /^ERROR:\s+(\d+):(\d+):\s*(.*)$/.exec(i);
                    n ? t.push({
                        type: e,
                        fileID: 0 | n[1],
                        line: 0 | n[2],
                        message: n[3].trim()
                    }) : i.length > 0 && t.push({
                        type: e,
                        fileID: -1,
                        line: 0,
                        message: i
                    });
                }
            });
        }
        var o = function() {
            function t(t, e) {
                this._device = t, this._attributes = [], this._uniforms = [], this._samplers = [], 
                this._errors = [], this._linked = !1, this._vertSource = e.vert, this._fragSource = e.frag, 
                this._glID = null, this._id = r++;
            }
            var e, i, o = t.prototype;
            return o.link = function() {
                if (!this._linked) {
                    var t = this._device._gl, e = a(t, t.VERTEX_SHADER, this._vertSource), i = a(t, t.FRAGMENT_SHADER, this._fragSource), n = t.createProgram();
                    t.attachShader(n, e), t.attachShader(n, i), t.linkProgram(n);
                    var r = !1, o = this._errors;
                    if (t.getShaderParameter(e, t.COMPILE_STATUS) || (s(o, "vs", t.getShaderInfoLog(e)), 
                    r = !0), t.getShaderParameter(i, t.COMPILE_STATUS) || (s(o, "fs", t.getShaderInfoLog(i)), 
                    r = !0), t.deleteShader(e), t.deleteShader(i), r) return o;
                    if (!t.getProgramParameter(n, t.LINK_STATUS)) return o.push({
                        info: "Failed to link shader program: " + t.getProgramInfoLog(n)
                    }), o;
                    this._glID = n;
                    for (var c = t.getProgramParameter(n, t.ACTIVE_ATTRIBUTES), l = 0; l < c; ++l) {
                        var u = t.getActiveAttrib(n, l), h = t.getAttribLocation(n, u.name);
                        this._attributes.push({
                            name: u.name,
                            location: h,
                            type: u.type
                        });
                    }
                    for (var _ = t.getProgramParameter(n, t.ACTIVE_UNIFORMS), f = 0; f < _; ++f) {
                        var d = t.getActiveUniform(n, f), p = d.name, m = t.getUniformLocation(n, p), v = "[0]" === p.substr(p.length - 3);
                        v && (p = p.substr(0, p.length - 3));
                        var y = {
                            name: p,
                            location: m,
                            type: d.type,
                            size: v ? d.size : void 0
                        };
                        this._uniforms.push(y);
                    }
                    this._linked = !0;
                }
            }, o.destroy = function() {
                this._device._gl.deleteProgram(this._glID), this._linked = !1, this._glID = null, 
                this._attributes = [], this._uniforms = [], this._samplers = [];
            }, e = t, (i = [ {
                key: "id",
                get: function() {
                    return this._id;
                }
            } ]) && n(e.prototype, i), t;
        }();
        function a(t, e, i) {
            var n = t.createShader(e);
            return t.shaderSource(n, i), t.compileShader(n), n;
        }
        i.default = o, e.exports = i.default;
    }, {} ],
    301: [ function(t, e, i) {
        "use strict";
        i.__esModule = !0, i.default = void 0;
        var n = function() {
            function t(t, e, i, n) {
                this._device = t, this._format = e, this._glID = t._gl.createRenderbuffer(), this.update(i, n);
            }
            var e = t.prototype;
            return e.update = function(t, e) {
                this._width = t, this._height = e;
                var i = this._device._gl;
                i.bindRenderbuffer(i.RENDERBUFFER, this._glID), i.renderbufferStorage(i.RENDERBUFFER, this._format, t, e), 
                i.bindRenderbuffer(i.RENDERBUFFER, null);
            }, e.destroy = function() {
                if (null !== this._glID) {
                    var t = this._device._gl;
                    t.bindRenderbuffer(t.RENDERBUFFER, null), t.deleteRenderbuffer(this._glID), this._glID = null;
                } else console.error("The render-buffer already destroyed");
            }, t;
        }();
        i.default = n, e.exports = i.default;
    }, {} ],
    302: [ function(t, e, i) {
        "use strict";
        i.__esModule = !0, i.default = void 0;
        var n = t("./enums"), r = {
            blend: !1,
            blendSep: !1,
            blendColor: 4294967295,
            blendEq: n.enums.BLEND_FUNC_ADD,
            blendAlphaEq: n.enums.BLEND_FUNC_ADD,
            blendSrc: n.enums.BLEND_ONE,
            blendDst: n.enums.BLEND_ZERO,
            blendSrcAlpha: n.enums.BLEND_ONE,
            blendDstAlpha: n.enums.BLEND_ZERO,
            depthTest: !1,
            depthWrite: !1,
            depthFunc: n.enums.DS_FUNC_LESS,
            stencilTest: !1,
            stencilSep: !1,
            stencilFuncFront: n.enums.DS_FUNC_ALWAYS,
            stencilRefFront: 0,
            stencilMaskFront: 255,
            stencilFailOpFront: n.enums.STENCIL_OP_KEEP,
            stencilZFailOpFront: n.enums.STENCIL_OP_KEEP,
            stencilZPassOpFront: n.enums.STENCIL_OP_KEEP,
            stencilWriteMaskFront: 255,
            stencilFuncBack: n.enums.DS_FUNC_ALWAYS,
            stencilRefBack: 0,
            stencilMaskBack: 255,
            stencilFailOpBack: n.enums.STENCIL_OP_KEEP,
            stencilZFailOpBack: n.enums.STENCIL_OP_KEEP,
            stencilZPassOpBack: n.enums.STENCIL_OP_KEEP,
            stencilWriteMaskBack: 255,
            cullMode: n.enums.CULL_BACK,
            primitiveType: n.enums.PT_TRIANGLES,
            maxStream: -1,
            vertexBuffers: [],
            vertexBufferOffsets: [],
            indexBuffer: null,
            maxTextureSlot: -1,
            textureUnits: [],
            program: null
        }, s = function() {
            function t(t) {
                this.vertexBuffers = new Array(t._caps.maxVertexStreams), this.vertexBufferOffsets = new Array(t._caps.maxVertexStreams), 
                this.textureUnits = new Array(t._caps.maxTextureUnits), this.set(r);
            }
            t.initDefault = function(t) {
                r.vertexBuffers = new Array(t._caps.maxVertexStreams), r.vertexBufferOffsets = new Array(t._caps.maxVertexStreams), 
                r.textureUnits = new Array(t._caps.maxTextureUnits);
            };
            var e = t.prototype;
            return e.reset = function() {
                this.set(r);
            }, e.set = function(t) {
                this.blend = t.blend, this.blendSep = t.blendSep, this.blendColor = t.blendColor, 
                this.blendEq = t.blendEq, this.blendAlphaEq = t.blendAlphaEq, this.blendSrc = t.blendSrc, 
                this.blendDst = t.blendDst, this.blendSrcAlpha = t.blendSrcAlpha, this.blendDstAlpha = t.blendDstAlpha, 
                this.depthTest = t.depthTest, this.depthWrite = t.depthWrite, this.depthFunc = t.depthFunc, 
                this.stencilTest = t.stencilTest, this.stencilSep = t.stencilSep, this.stencilFuncFront = t.stencilFuncFront, 
                this.stencilRefFront = t.stencilRefFront, this.stencilMaskFront = t.stencilMaskFront, 
                this.stencilFailOpFront = t.stencilFailOpFront, this.stencilZFailOpFront = t.stencilZFailOpFront, 
                this.stencilZPassOpFront = t.stencilZPassOpFront, this.stencilWriteMaskFront = t.stencilWriteMaskFront, 
                this.stencilFuncBack = t.stencilFuncBack, this.stencilRefBack = t.stencilRefBack, 
                this.stencilMaskBack = t.stencilMaskBack, this.stencilFailOpBack = t.stencilFailOpBack, 
                this.stencilZFailOpBack = t.stencilZFailOpBack, this.stencilZPassOpBack = t.stencilZPassOpBack, 
                this.stencilWriteMaskBack = t.stencilWriteMaskBack, this.cullMode = t.cullMode, 
                this.primitiveType = t.primitiveType, this.maxStream = t.maxStream;
                for (var e = 0; e < t.vertexBuffers.length; ++e) this.vertexBuffers[e] = t.vertexBuffers[e];
                for (var i = 0; i < t.vertexBufferOffsets.length; ++i) this.vertexBufferOffsets[i] = t.vertexBufferOffsets[i];
                this.indexBuffer = t.indexBuffer, this.maxTextureSlot = t.maxTextureSlot;
                for (var n = 0; n < t.textureUnits.length; ++n) this.textureUnits[n] = t.textureUnits[n];
                this.program = t.program;
            }, t;
        }();
        i.default = s, e.exports = i.default;
    }, {
        "./enums": 295
    } ],
    303: [ function(t, e, i) {
        "use strict";
        i.__esModule = !0, i.default = void 0;
        var n, r = (n = t("./texture")) && n.__esModule ? n : {
            default: n
        }, s = t("./enums"), o = t("./misc"), a = function(t) {
            var e, i;
            function n(e, i) {
                var n, r = (n = t.call(this, e) || this)._device._gl;
                return n._target = r.TEXTURE_2D, n._glID = r.createTexture(), i.images = i.images || [ null ], 
                n.update(i), n;
            }
            i = t, (e = n).prototype = Object.create(i.prototype), e.prototype.constructor = e, 
            e.__proto__ = i;
            var r = n.prototype;
            return r.update = function(t) {
                var e = this._device._gl, i = this._genMipmap;
                if (t) {
                    void 0 !== t.width && (this._width = t.width), void 0 !== t.height && (this._height = t.height), 
                    void 0 !== t.anisotropy && (this._anisotropy = t.anisotropy), void 0 !== t.minFilter && (this._minFilter = t.minFilter), 
                    void 0 !== t.magFilter && (this._magFilter = t.magFilter), void 0 !== t.mipFilter && (this._mipFilter = t.mipFilter), 
                    void 0 !== t.wrapS && (this._wrapS = t.wrapS), void 0 !== t.wrapT && (this._wrapT = t.wrapT), 
                    void 0 !== t.format && (this._format = t.format, this._compressed = this._format >= s.enums.TEXTURE_FMT_RGB_DXT1 && this._format <= s.enums.TEXTURE_FMT_RGBA_PVRTC_4BPPV1 || this._format >= s.enums.TEXTURE_FMT_RGB_ETC2 && this._format <= s.enums.TEXTURE_FMT_RGBA_ETC2), 
                    void 0 !== t.genMipmaps && (this._genMipmap = t.genMipmaps, i = t.genMipmaps);
                    var n = this._device.caps.maxTextureSize || Number.MAX_VALUE, r = Math.max(t.width || 0, t.height || 0);
                    n < r && console.warn("The current texture size " + r + " exceeds the maximum size [" + n + "] supported on the device."), 
                    void 0 !== t.images && t.images.length > 1 && (i = !1, (t.width > t.height ? t.width : t.height) >> t.images.length - 1 != 1 && console.error("texture-2d mipmap is invalid, should have a 1x1 mipmap."));
                }
                (0, o.isPow2)(this._width) && (0, o.isPow2)(this._height) || (i = !1), e.activeTexture(e.TEXTURE0), 
                e.bindTexture(e.TEXTURE_2D, this._glID), void 0 !== t.images && t.images.length > 0 && (this._setMipmap(t.images, t.flipY, t.premultiplyAlpha), 
                t.images.length > 1 && (this._genMipmap = !0)), i && (e.hint(e.GENERATE_MIPMAP_HINT, e.NICEST), 
                e.generateMipmap(e.TEXTURE_2D), this._genMipmap = !0), this._setTexInfo(), this._device._restoreTexture(0);
            }, r.updateSubImage = function(t) {
                var e = this._device._gl, i = (0, s.glTextureFmt)(this._format);
                e.activeTexture(e.TEXTURE0), e.bindTexture(e.TEXTURE_2D, this._glID), this._setSubImage(i, t), 
                this._device._restoreTexture(0);
            }, r.updateImage = function(t) {
                var e = this._device._gl, i = (0, s.glTextureFmt)(this._format);
                e.activeTexture(e.TEXTURE0), e.bindTexture(e.TEXTURE_2D, this._glID), this._setImage(i, t), 
                this._device._restoreTexture(0);
            }, r._setSubImage = function(t, e) {
                var i = this._device._gl, n = e.flipY, r = e.premultiplyAlpha, s = e.image;
                !s || ArrayBuffer.isView(s) || s instanceof ArrayBuffer ? (void 0 === n ? i.pixelStorei(i.UNPACK_FLIP_Y_WEBGL, !1) : i.pixelStorei(i.UNPACK_FLIP_Y_WEBGL, n), 
                void 0 === r ? i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL, !1) : i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL, r), 
                this._compressed ? i.compressedTexSubImage2D(i.TEXTURE_2D, e.level, e.x, e.y, e.width, e.height, t.format, s) : i.texSubImage2D(i.TEXTURE_2D, e.level, e.x, e.y, e.width, e.height, t.format, t.pixelType, s)) : (void 0 === n ? i.pixelStorei(i.UNPACK_FLIP_Y_WEBGL, !0) : i.pixelStorei(i.UNPACK_FLIP_Y_WEBGL, n), 
                void 0 === r ? i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL, !1) : i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL, r), 
                i.texSubImage2D(i.TEXTURE_2D, e.level, e.x, e.y, t.format, t.pixelType, s));
            }, r._setImage = function(t, e) {
                var i = this._device._gl, n = e.flipY, r = e.premultiplyAlpha, s = e.image;
                !s || ArrayBuffer.isView(s) || s instanceof ArrayBuffer ? (void 0 === n ? i.pixelStorei(i.UNPACK_FLIP_Y_WEBGL, !1) : i.pixelStorei(i.UNPACK_FLIP_Y_WEBGL, n), 
                void 0 === r ? i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL, !1) : i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL, r), 
                this._compressed ? i.compressedTexImage2D(i.TEXTURE_2D, e.level, t.internalFormat, e.width, e.height, 0, s) : i.texImage2D(i.TEXTURE_2D, e.level, t.internalFormat, e.width, e.height, 0, t.format, t.pixelType, s)) : (void 0 === n ? i.pixelStorei(i.UNPACK_FLIP_Y_WEBGL, !0) : i.pixelStorei(i.UNPACK_FLIP_Y_WEBGL, n), 
                void 0 === r ? i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL, !1) : i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL, r), 
                i.texImage2D(i.TEXTURE_2D, e.level, t.internalFormat, t.format, t.pixelType, s));
            }, r._setMipmap = function(t, e, i) {
                for (var n = (0, s.glTextureFmt)(this._format), r = {
                    width: this._width,
                    height: this._height,
                    flipY: e,
                    premultiplyAlpha: i,
                    level: 0,
                    image: null
                }, o = 0; o < t.length; ++o) r.level = o, r.width = this._width >> o, r.height = this._height >> o, 
                r.image = t[o], this._setImage(n, r);
            }, r._setTexInfo = function() {
                var t = this._device._gl, e = (0, o.isPow2)(this._width) && (0, o.isPow2)(this._height);
                e || this._wrapS === s.enums.WRAP_CLAMP && this._wrapT === s.enums.WRAP_CLAMP || (console.warn("WebGL1 doesn't support all wrap modes with NPOT textures"), 
                this._wrapS = s.enums.WRAP_CLAMP, this._wrapT = s.enums.WRAP_CLAMP);
                var i = this._genMipmap ? this._mipFilter : -1;
                e || -1 === i || (console.warn("NPOT textures do not support mipmap filter"), i = -1), 
                t.texParameteri(t.TEXTURE_2D, t.TEXTURE_MIN_FILTER, (0, s.glFilter)(t, this._minFilter, i)), 
                t.texParameteri(t.TEXTURE_2D, t.TEXTURE_MAG_FILTER, (0, s.glFilter)(t, this._magFilter, -1)), 
                t.texParameteri(t.TEXTURE_2D, t.TEXTURE_WRAP_S, this._wrapS), t.texParameteri(t.TEXTURE_2D, t.TEXTURE_WRAP_T, this._wrapT);
                var n = this._device.ext("EXT_texture_filter_anisotropic");
                n && t.texParameteri(t.TEXTURE_2D, n.TEXTURE_MAX_ANISOTROPY_EXT, this._anisotropy);
            }, n;
        }(r.default);
        i.default = a, e.exports = i.default;
    }, {
        "./enums": 295,
        "./misc": 299,
        "./texture": 305
    } ],
    304: [ function(t, e, i) {
        "use strict";
        i.__esModule = !0, i.default = void 0;
        var n, r = (n = t("./texture")) && n.__esModule ? n : {
            default: n
        }, s = t("./enums"), o = t("./misc"), a = function(t) {
            var e, i;
            function n(e, i) {
                var n, r = (n = t.call(this, e) || this)._device._gl;
                return n._target = r.TEXTURE_CUBE_MAP, n._glID = r.createTexture(), n.update(i), 
                n;
            }
            i = t, (e = n).prototype = Object.create(i.prototype), e.prototype.constructor = e, 
            e.__proto__ = i;
            var r = n.prototype;
            return r.update = function(t) {
                var e = this._device._gl, i = this._genMipmaps;
                t && (void 0 !== t.width && (this._width = t.width), void 0 !== t.height && (this._height = t.height), 
                void 0 !== t.anisotropy && (this._anisotropy = t.anisotropy), void 0 !== t.minFilter && (this._minFilter = t.minFilter), 
                void 0 !== t.magFilter && (this._magFilter = t.magFilter), void 0 !== t.mipFilter && (this._mipFilter = t.mipFilter), 
                void 0 !== t.wrapS && (this._wrapS = t.wrapS), void 0 !== t.wrapT && (this._wrapT = t.wrapT), 
                void 0 !== t.format && (this._format = t.format, this._compressed = this._format >= s.enums.TEXTURE_FMT_RGB_DXT1 && this._format <= s.enums.TEXTURE_FMT_RGBA_PVRTC_4BPPV1 || this._format >= s.enums.TEXTURE_FMT_RGB_ETC2 && this._format <= s.enums.TEXTURE_FMT_RGBA_ETC2), 
                void 0 !== t.genMipmaps && (this._genMipmaps = t.genMipmaps, i = t.genMipmaps), 
                void 0 !== t.images && t.images.length > 1 && (i = !1, t.width !== t.height && console.warn("texture-cube width and height should be identical."), 
                t.width >> t.images.length - 1 != 1 && console.error("texture-cube mipmap is invalid. please set mipmap as 1x1, 2x2, 4x4 ... nxn"))), 
                (0, o.isPow2)(this._width) && (0, o.isPow2)(this._height) || (i = !1), e.activeTexture(e.TEXTURE0), 
                e.bindTexture(e.TEXTURE_CUBE_MAP, this._glID), void 0 !== t.images && t.images.length > 0 && (this._setMipmap(t.images, t.flipY, t.premultiplyAlpha), 
                t.images.length > 1 && (this._genMipmaps = !0)), i && (e.hint(e.GENERATE_MIPMAP_HINT, e.NICEST), 
                e.generateMipmap(e.TEXTURE_CUBE_MAP), this._genMipmaps = !0), this._setTexInfo(), 
                this._device._restoreTexture(0);
            }, r.updateSubImage = function(t) {
                var e = this._device._gl, i = (0, s.glTextureFmt)(this._format);
                e.activeTexture(e.TEXTURE0), e.bindTexture(e.TEXTURE_CUBE_MAP, this._glID), this._setSubImage(i, t), 
                this._device._restoreTexture(0);
            }, r.updateImage = function(t) {
                var e = this._device._gl, i = (0, s.glTextureFmt)(this._format);
                e.activeTexture(e.TEXTURE0), e.bindTexture(e.TEXTURE_CUBE_MAP, this._glID), this._setImage(i, t), 
                this._device._restoreTexture(0);
            }, r._setSubImage = function(t, e) {
                var i = this._device._gl, n = e.flipY, r = e.premultiplyAlpha, s = e.faceIndex, o = e.image;
                void 0 === n ? i.pixelStorei(i.UNPACK_FLIP_Y_WEBGL, !1) : i.pixelStorei(i.UNPACK_FLIP_Y_WEBGL, n), 
                void 0 === r ? i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL, !1) : i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL, r), 
                !o || ArrayBuffer.isView(o) || o instanceof ArrayBuffer ? this._compressed ? i.compressedTexSubImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X + s, e.level, e.x, e.y, e.width, e.height, t.format, o) : i.texSubImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X + s, e.level, e.x, e.y, e.width, e.height, t.format, t.pixelType, o) : i.texSubImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X + s, e.level, e.x, e.y, t.format, t.pixelType, o);
            }, r._setImage = function(t, e) {
                var i = this._device._gl, n = e.flipY, r = e.premultiplyAlpha, s = e.faceIndex, o = e.image;
                void 0 === n ? i.pixelStorei(i.UNPACK_FLIP_Y_WEBGL, !1) : i.pixelStorei(i.UNPACK_FLIP_Y_WEBGL, n), 
                void 0 === r ? i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL, !1) : i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL, r), 
                !o || ArrayBuffer.isView(o) || o instanceof ArrayBuffer ? this._compressed ? i.compressedTexImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X + s, e.level, t.internalFormat, e.width, e.height, 0, o) : i.texImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X + s, e.level, t.internalFormat, e.width, e.height, 0, t.format, t.pixelType, o) : i.texImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X + s, e.level, t.internalFormat, t.format, t.pixelType, o);
            }, r._setMipmap = function(t, e, i) {
                for (var n = (0, s.glTextureFmt)(this._format), r = {
                    width: this._width,
                    height: this._height,
                    faceIndex: 0,
                    flipY: e,
                    premultiplyAlpha: i,
                    level: 0,
                    image: null
                }, o = 0; o < t.length; ++o) {
                    var a = t[o];
                    r.level = o, r.width = this._width >> o, r.height = this._height >> o;
                    for (var c = 0; c < 6; ++c) r.faceIndex = c, r.image = a[c], this._setImage(n, r);
                }
            }, r._setTexInfo = function() {
                var t = this._device._gl, e = (0, o.isPow2)(this._width) && (0, o.isPow2)(this._height);
                e || this._wrapS === s.enums.WRAP_CLAMP && this._wrapT === s.enums.WRAP_CLAMP || (console.warn("WebGL1 doesn't support all wrap modes with NPOT textures"), 
                this._wrapS = s.enums.WRAP_CLAMP, this._wrapT = s.enums.WRAP_CLAMP);
                var i = this._genMipmaps ? this._mipFilter : -1;
                e || -1 === i || (console.warn("NPOT textures do not support mipmap filter"), i = -1), 
                t.texParameteri(t.TEXTURE_CUBE_MAP, t.TEXTURE_MIN_FILTER, (0, s.glFilter)(t, this._minFilter, i)), 
                t.texParameteri(t.TEXTURE_CUBE_MAP, t.TEXTURE_MAG_FILTER, (0, s.glFilter)(t, this._magFilter, -1)), 
                t.texParameteri(t.TEXTURE_CUBE_MAP, t.TEXTURE_WRAP_S, this._wrapS), t.texParameteri(t.TEXTURE_CUBE_MAP, t.TEXTURE_WRAP_T, this._wrapT);
                var n = this._device.ext("EXT_texture_filter_anisotropic");
                n && t.texParameteri(t.TEXTURE_CUBE_MAP, n.TEXTURE_MAX_ANISOTROPY_EXT, this._anisotropy);
            }, n;
        }(r.default);
        i.default = a, e.exports = i.default;
    }, {
        "./enums": 295,
        "./misc": 299,
        "./texture": 305
    } ],
    305: [ function(t, e, i) {
        "use strict";
        i.__esModule = !0, i.default = void 0;
        var n = t("./enums"), r = 0, s = function() {
            function t(t) {
                this._device = t, this._width = 4, this._height = 4, this._genMipmaps = !1, this._compressed = !1, 
                this._anisotropy = 1, this._minFilter = n.enums.FILTER_LINEAR, this._magFilter = n.enums.FILTER_LINEAR, 
                this._mipFilter = n.enums.FILTER_LINEAR, this._wrapS = n.enums.WRAP_REPEAT, this._wrapT = n.enums.WRAP_REPEAT, 
                this._format = n.enums.TEXTURE_FMT_RGBA8, this._target = -1, this._id = r++;
            }
            return t.prototype.destroy = function() {
                null !== this._glID ? (this._device._gl.deleteTexture(this._glID), this._device._stats.tex -= this.bytes, 
                this._glID = null) : console.error("The texture already destroyed");
            }, t;
        }();
        i.default = s, e.exports = i.default;
    }, {
        "./enums": 295
    } ],
    306: [ function(t, e, i) {
        "use strict";
        function n(t, e) {
            for (var i = 0; i < e.length; i++) {
                var n = e[i];
                n.enumerable = n.enumerable || !1, n.configurable = !0, "value" in n && (n.writable = !0), 
                Object.defineProperty(t, n.key, n);
            }
        }
        i.__esModule = !0, i.default = void 0, t("./enums");
        var r = function() {
            function t(t, e, i, n) {
                this._device = t, this._format = e, this._usage = i, this._bytesPerVertex = this._format._bytes, 
                this._bytes = n.byteLength, this._numVertices = this._bytes / this._bytesPerVertex, 
                this._needExpandDataStore = !0, this._glID = t._gl.createBuffer(), this.update(0, n), 
                t._stats.vb += this._bytes;
            }
            var e, i, r = t.prototype;
            return r.destroy = function() {
                -1 !== this._glID ? (this._device._gl.deleteBuffer(this._glID), this._device._stats.vb -= this.bytes, 
                this._glID = -1) : console.error("The buffer already destroyed");
            }, r.update = function(t, e) {
                if (-1 !== this._glID) {
                    if (0 !== e.byteLength) {
                        if (t + e.byteLength > this._bytes) {
                            if (t) return void console.error("Failed to update data, bytes exceed.");
                            this._needExpandDataStore = !0, this._bytes = t + e.byteLength, this._numVertices = this._bytes / this._bytesPerVertex;
                        }
                        var i = this._device._gl, n = this._usage;
                        i.bindBuffer(i.ARRAY_BUFFER, this._glID), this._needExpandDataStore ? (i.bufferData(i.ARRAY_BUFFER, e, n), 
                        this._needExpandDataStore = !1) : i.bufferSubData(i.ARRAY_BUFFER, t, e), i.bindBuffer(i.ARRAY_BUFFER, null);
                    }
                } else console.error("The buffer is destroyed");
            }, r.getFormat = function(t) {
                return this._format.element(t);
            }, r.setUsage = function(t) {
                this._usage = t;
            }, e = t, (i = [ {
                key: "count",
                get: function() {
                    return this._numVertices;
                }
            } ]) && n(e.prototype, i), t;
        }();
        i.default = r, e.exports = i.default;
    }, {
        "./enums": 295
    } ],
    307: [ function(t, e, i) {
        "use strict";
        i.__esModule = !0, i.default = void 0;
        var n, r = t("./enums"), s = (n = t("../murmurhash2_gc")) && n.__esModule ? n : {
            default: n
        }, o = function() {
            function t(t) {
                this._attr2el = {}, this._elements = [], this._bytes = 0;
                for (var e = "", i = 0, n = t.length; i < n; ++i) {
                    var o = t[i], a = {
                        name: o.name,
                        offset: this._bytes,
                        stride: 0,
                        stream: -1,
                        type: o.type,
                        num: o.num,
                        normalize: void 0 !== o.normalize && o.normalize,
                        bytes: o.num * (0, r.attrTypeBytes)(o.type)
                    };
                    this._attr2el[a.name] = a, this._elements.push(a), this._bytes += a.bytes, e += a.name + ":" + a.num + ":" + a.type + ":" + a.normalize;
                }
                for (var c = 0, l = this._elements.length; c < l; ++c) this._elements[c].stride = this._bytes;
                this._hash = (0, s.default)(e, 666);
            }
            var e = t.prototype;
            return e.element = function(t) {
                return this._attr2el[t];
            }, e.getHash = function() {
                return this._hash;
            }, t;
        }();
        i.default = o, e.exports = i.default;
    }, {
        "../murmurhash2_gc": 316,
        "./enums": 295
    } ],
    308: [ function(t, e, i) {
        "use strict";
        i.__esModule = !0, i.default = void 0;
        var n = function() {
            function t(t, e) {
                this._cursor = 0, this._data = new Array(e);
                for (var i = 0; i < e; ++i) this._data[i] = t();
            }
            return t.prototype.request = function() {
                var t = this._data[this._cursor];
                return this._cursor = (this._cursor + 1) % this._data.length, t;
            }, t;
        }();
        i.default = n, e.exports = i.default;
    }, {} ],
    309: [ function(t, e, i) {
        "use strict";
        i.__esModule = !0, i.default = void 0;
        var n, r = (n = t("./timsort")) && n.__esModule ? n : {
            default: n
        };
        function s(t, e) {
            for (var i = 0; i < e.length; i++) {
                var n = e[i];
                n.enumerable = n.enumerable || !1, n.configurable = !0, "value" in n && (n.writable = !0), 
                Object.defineProperty(t, n.key, n);
            }
        }
        var o = function() {
            function t(t) {
                this._count = 0, this._data = new Array(t);
            }
            var e, i, n = t.prototype;
            return n._resize = function(t) {
                if (t > this._data.length) for (var e = this._data.length; e < t; ++e) this._data[e] = void 0;
            }, n.reset = function() {
                for (var t = 0; t < this._count; ++t) this._data[t] = void 0;
                this._count = 0;
            }, n.push = function(t) {
                this._count >= this._data.length && this._resize(2 * this._data.length), this._data[this._count] = t, 
                ++this._count;
            }, n.pop = function() {
                --this._count, this._count < 0 && (this._count = 0);
                var t = this._data[this._count];
                return this._data[this._count] = void 0, t;
            }, n.fastRemove = function(t) {
                if (!(t >= this._count || t < 0)) {
                    var e = this._count - 1;
                    this._data[t] = this._data[e], this._data[e] = void 0, this._count -= 1;
                }
            }, n.indexOf = function(t) {
                return this._data.indexOf(t);
            }, n.sort = function(t) {
                return (0, r.default)(this._data, 0, this._count, t);
            }, e = t, (i = [ {
                key: "length",
                get: function() {
                    return this._count;
                }
            }, {
                key: "data",
                get: function() {
                    return this._data;
                }
            } ]) && s(e.prototype, i), t;
        }();
        i.default = o, e.exports = i.default;
    }, {
        "./timsort": 314
    } ],
    310: [ function(t, e, i) {
        "use strict";
        i.__esModule = !0, i.TypedArrayPool = i.RecyclePool = i.Pool = i.LinkedArray = i.FixedArray = i.CircularPool = void 0;
        var n = l(t("./circular-pool"));
        i.CircularPool = n.default;
        var r = l(t("./fixed-array"));
        i.FixedArray = r.default;
        var s = l(t("./linked-array"));
        i.LinkedArray = s.default;
        var o = l(t("./pool"));
        i.Pool = o.default;
        var a = l(t("./recycle-pool"));
        i.RecyclePool = a.default;
        var c = l(t("./typed-array-pool"));
        function l(t) {
            return t && t.__esModule ? t : {
                default: t
            };
        }
        i.TypedArrayPool = c.default;
    }, {
        "./circular-pool": 308,
        "./fixed-array": 309,
        "./linked-array": 311,
        "./pool": 312,
        "./recycle-pool": 313,
        "./typed-array-pool": 315
    } ],
    311: [ function(t, e, i) {
        "use strict";
        i.__esModule = !0, i.default = void 0;
        var n, r = (n = t("./pool")) && n.__esModule ? n : {
            default: n
        };
        function s(t, e) {
            for (var i = 0; i < e.length; i++) {
                var n = e[i];
                n.enumerable = n.enumerable || !1, n.configurable = !0, "value" in n && (n.writable = !0), 
                Object.defineProperty(t, n.key, n);
            }
        }
        var o = function() {
            function t(t, e) {
                this._fn = t, this._count = 0, this._head = null, this._tail = null, this._pool = new r.default(t, e);
            }
            var e, i, n = t.prototype;
            return n.add = function() {
                var t = this._pool.alloc();
                return this._tail ? (this._tail._next = t, t._prev = this._tail) : this._head = t, 
                this._tail = t, this._count += 1, t;
            }, n.remove = function(t) {
                t._prev ? t._prev._next = t._next : this._head = t._next, t._next ? t._next._prev = t._prev : this._tail = t._prev, 
                t._next = null, t._prev = null, this._pool.free(t), this._count -= 1;
            }, n.forEach = function(t, e) {
                var i = this._head;
                if (i) {
                    e && (t = t.bind(e));
                    for (var n = 0, r = i; i; ) r = i._next, t(i, n, this), i = r, ++n;
                }
            }, e = t, (i = [ {
                key: "head",
                get: function() {
                    return this._head;
                }
            }, {
                key: "tail",
                get: function() {
                    return this._tail;
                }
            }, {
                key: "length",
                get: function() {
                    return this._count;
                }
            } ]) && s(e.prototype, i), t;
        }();
        i.default = o, e.exports = i.default;
    }, {
        "./pool": 312
    } ],
    312: [ function(t, e, i) {
        "use strict";
        i.__esModule = !0, i.default = void 0;
        var n = function() {
            function t(t, e) {
                this._fn = t, this._idx = e - 1, this._frees = new Array(e);
                for (var i = 0; i < e; ++i) this._frees[i] = t();
            }
            var e = t.prototype;
            return e._expand = function(t) {
                var e = this._frees;
                this._frees = new Array(t);
                for (var i = t - e.length, n = 0; n < i; ++n) this._frees[n] = this._fn();
                for (var r = i, s = 0; r < t; ++r, ++s) this._frees[r] = e[s];
                this._idx += i;
            }, e.alloc = function() {
                this._idx < 0 && this._expand(Math.round(1.2 * this._frees.length) + 1);
                var t = this._frees[this._idx];
                return this._frees[this._idx] = null, --this._idx, t;
            }, e.free = function(t) {
                ++this._idx, this._frees[this._idx] = t;
            }, e.clear = function(t) {
                for (var e = 0; e <= this._idx; e++) t && t(this._frees[e]);
                this._frees.length = 0, this._idx = -1;
            }, t;
        }();
        i.default = n, e.exports = i.default;
    }, {} ],
    313: [ function(t, e, i) {
        "use strict";
        i.__esModule = !0, i.default = void 0;
        var n, r = (n = t("./timsort")) && n.__esModule ? n : {
            default: n
        };
        function s(t, e) {
            for (var i = 0; i < e.length; i++) {
                var n = e[i];
                n.enumerable = n.enumerable || !1, n.configurable = !0, "value" in n && (n.writable = !0), 
                Object.defineProperty(t, n.key, n);
            }
        }
        var o = function() {
            function t(t, e) {
                this._fn = t, this._count = 0, this._data = new Array(e);
                for (var i = 0; i < e; ++i) this._data[i] = t();
            }
            var e, i, n = t.prototype;
            return n.reset = function() {
                this._count = 0;
            }, n.resize = function(t) {
                if (t > this._data.length) for (var e = this._data.length; e < t; ++e) this._data[e] = this._fn();
            }, n.add = function() {
                return this._count >= this._data.length && this.resize(2 * this._data.length), this._data[this._count++];
            }, n.remove = function(t) {
                if (!(t >= this._count)) {
                    var e = this._count - 1, i = this._data[t];
                    this._data[t] = this._data[e], this._data[e] = i, this._count -= 1;
                }
            }, n.sort = function(t) {
                return (0, r.default)(this._data, 0, this._count, t);
            }, e = t, (i = [ {
                key: "length",
                get: function() {
                    return this._count;
                }
            }, {
                key: "data",
                get: function() {
                    return this._data;
                }
            } ]) && s(e.prototype, i), t;
        }();
        i.default = o, cc.RecyclePool = o, e.exports = i.default;
    }, {
        "./timsort": 314
    } ],
    314: [ function(t, e, i) {
        "use strict";
        i.__esModule = !0, i.default = function(t, e, i, r) {
            if (!Array.isArray(t)) throw new TypeError("Can only sort arrays");
            void 0 === e && (e = 0), void 0 === i && (i = t.length), void 0 === r && (r = c);
            var s = i - e;
            if (!(s < 2)) {
                var o = 0;
                if (s < n) return void _(t, e, i, e + (o = u(t, e, i, r)), r);
                var a = new p(t, r), h = l(s);
                do {
                    if ((o = u(t, e, i, r)) < h) {
                        var f = s;
                        f > h && (f = h), _(t, e, e + f, e + o, r), o = f;
                    }
                    a.pushRun(e, o), a.mergeRuns(), s -= o, e += o;
                } while (0 !== s);
                a.forceMergeRuns();
            }
        };
        var n = 32, r = 7, s = 256, o = [ 1, 10, 100, 1e3, 1e4, 1e5, 1e6, 1e7, 1e8, 1e9 ];
        function a(t) {
            return t < 1e5 ? t < 100 ? t < 10 ? 0 : 1 : t < 1e4 ? t < 1e3 ? 2 : 3 : 4 : t < 1e7 ? t < 1e6 ? 5 : 6 : t < 1e9 ? t < 1e8 ? 7 : 8 : 9;
        }
        function c(t, e) {
            if (t === e) return 0;
            if (~~t === t && ~~e === e) {
                if (0 === t || 0 === e) return t < e ? -1 : 1;
                if (t < 0 || e < 0) {
                    if (e >= 0) return -1;
                    if (t >= 0) return 1;
                    t = -t, e = -e;
                }
                var i = a(t), n = a(e), r = 0;
                return i < n ? (t *= o[n - i - 1], e /= 10, r = -1) : i > n && (e *= o[i - n - 1], 
                t /= 10, r = 1), t === e ? r : t < e ? -1 : 1;
            }
            var s = String(t), c = String(e);
            return s === c ? 0 : s < c ? -1 : 1;
        }
        function l(t) {
            for (var e = 0; t >= n; ) e |= 1 & t, t >>= 1;
            return t + e;
        }
        function u(t, e, i, n) {
            var r = e + 1;
            if (r === i) return 1;
            if (n(t[r++], t[e]) < 0) {
                for (;r < i && n(t[r], t[r - 1]) < 0; ) r++;
                h(t, e, r);
            } else for (;r < i && n(t[r], t[r - 1]) >= 0; ) r++;
            return r - e;
        }
        function h(t, e, i) {
            for (i--; e < i; ) {
                var n = t[e];
                t[e++] = t[i], t[i--] = n;
            }
        }
        function _(t, e, i, n, r) {
            for (n === e && n++; n < i; n++) {
                for (var s = t[n], o = e, a = n; o < a; ) {
                    var c = o + a >>> 1;
                    r(s, t[c]) < 0 ? a = c : o = c + 1;
                }
                var l = n - o;
                switch (l) {
                  case 3:
                    t[o + 3] = t[o + 2];

                  case 2:
                    t[o + 2] = t[o + 1];

                  case 1:
                    t[o + 1] = t[o];
                    break;

                  default:
                    for (;l > 0; ) t[o + l] = t[o + l - 1], l--;
                }
                t[o] = s;
            }
        }
        function f(t, e, i, n, r, s) {
            var o = 0, a = 0, c = 1;
            if (s(t, e[i + r]) > 0) {
                for (a = n - r; c < a && s(t, e[i + r + c]) > 0; ) o = c, (c = 1 + (c << 1)) <= 0 && (c = a);
                c > a && (c = a), o += r, c += r;
            } else {
                for (a = r + 1; c < a && s(t, e[i + r - c]) <= 0; ) o = c, (c = 1 + (c << 1)) <= 0 && (c = a);
                c > a && (c = a);
                var l = o;
                o = r - c, c = r - l;
            }
            for (o++; o < c; ) {
                var u = o + (c - o >>> 1);
                s(t, e[i + u]) > 0 ? o = u + 1 : c = u;
            }
            return c;
        }
        function d(t, e, i, n, r, s) {
            var o = 0, a = 0, c = 1;
            if (s(t, e[i + r]) < 0) {
                for (a = r + 1; c < a && s(t, e[i + r - c]) < 0; ) o = c, (c = 1 + (c << 1)) <= 0 && (c = a);
                c > a && (c = a);
                var l = o;
                o = r - c, c = r - l;
            } else {
                for (a = n - r; c < a && s(t, e[i + r + c]) >= 0; ) o = c, (c = 1 + (c << 1)) <= 0 && (c = a);
                c > a && (c = a), o += r, c += r;
            }
            for (o++; o < c; ) {
                var u = o + (c - o >>> 1);
                s(t, e[i + u]) < 0 ? c = u : o = u + 1;
            }
            return c;
        }
        var p = function() {
            function t(t, e) {
                this.array = t, this.compare = e, this.minGallop = r, this.length = t.length, this.tmpStorageLength = s, 
                this.length < 2 * s && (this.tmpStorageLength = this.length >>> 1), this.tmp = new Array(this.tmpStorageLength), 
                this.stackLength = this.length < 120 ? 5 : this.length < 1542 ? 10 : this.length < 119151 ? 19 : 40, 
                this.runStart = new Array(this.stackLength), this.runLength = new Array(this.stackLength), 
                this.stackSize = 0;
            }
            var e = t.prototype;
            return e.pushRun = function(t, e) {
                this.runStart[this.stackSize] = t, this.runLength[this.stackSize] = e, this.stackSize += 1;
            }, e.mergeRuns = function() {
                for (;this.stackSize > 1; ) {
                    var t = this.stackSize - 2;
                    if (t >= 1 && this.runLength[t - 1] <= this.runLength[t] + this.runLength[t + 1] || t >= 2 && this.runLength[t - 2] <= this.runLength[t] + this.runLength[t - 1]) this.runLength[t - 1] < this.runLength[t + 1] && t--; else if (this.runLength[t] > this.runLength[t + 1]) break;
                    this.mergeAt(t);
                }
            }, e.forceMergeRuns = function() {
                for (;this.stackSize > 1; ) {
                    var t = this.stackSize - 2;
                    t > 0 && this.runLength[t - 1] < this.runLength[t + 1] && t--, this.mergeAt(t);
                }
            }, e.mergeAt = function(t) {
                var e = this.compare, i = this.array, n = this.runStart[t], r = this.runLength[t], s = this.runStart[t + 1], o = this.runLength[t + 1];
                this.runLength[t] = r + o, t === this.stackSize - 3 && (this.runStart[t + 1] = this.runStart[t + 2], 
                this.runLength[t + 1] = this.runLength[t + 2]), this.stackSize--;
                var a = d(i[s], i, n, r, 0, e);
                n += a, 0 != (r -= a) && 0 !== (o = f(i[n + r - 1], i, s, o, o - 1, e)) && (r <= o ? this.mergeLow(n, r, s, o) : this.mergeHigh(n, r, s, o));
            }, e.mergeLow = function(t, e, i, n) {
                var s = this.compare, o = this.array, a = this.tmp, c = 0;
                for (c = 0; c < e; c++) a[c] = o[t + c];
                var l = 0, u = i, h = t;
                if (o[h++] = o[u++], 0 != --n) if (1 !== e) {
                    for (var _ = this.minGallop; ;) {
                        var p = 0, m = 0, v = !1;
                        do {
                            if (s(o[u], a[l]) < 0) {
                                if (o[h++] = o[u++], m++, p = 0, 0 == --n) {
                                    v = !0;
                                    break;
                                }
                            } else if (o[h++] = a[l++], p++, m = 0, 1 == --e) {
                                v = !0;
                                break;
                            }
                        } while ((p | m) < _);
                        if (v) break;
                        do {
                            if (0 !== (p = d(o[u], a, l, e, 0, s))) {
                                for (c = 0; c < p; c++) o[h + c] = a[l + c];
                                if (h += p, l += p, (e -= p) <= 1) {
                                    v = !0;
                                    break;
                                }
                            }
                            if (o[h++] = o[u++], 0 == --n) {
                                v = !0;
                                break;
                            }
                            if (0 !== (m = f(a[l], o, u, n, 0, s))) {
                                for (c = 0; c < m; c++) o[h + c] = o[u + c];
                                if (h += m, u += m, 0 == (n -= m)) {
                                    v = !0;
                                    break;
                                }
                            }
                            if (o[h++] = a[l++], 1 == --e) {
                                v = !0;
                                break;
                            }
                            _--;
                        } while (p >= r || m >= r);
                        if (v) break;
                        _ < 0 && (_ = 0), _ += 2;
                    }
                    if (this.minGallop = _, _ < 1 && (this.minGallop = 1), 1 === e) {
                        for (c = 0; c < n; c++) o[h + c] = o[u + c];
                        o[h + n] = a[l];
                    } else {
                        if (0 === e) throw new Error("mergeLow preconditions were not respected");
                        for (c = 0; c < e; c++) o[h + c] = a[l + c];
                    }
                } else {
                    for (c = 0; c < n; c++) o[h + c] = o[u + c];
                    o[h + n] = a[l];
                } else for (c = 0; c < e; c++) o[h + c] = a[l + c];
            }, e.mergeHigh = function(t, e, i, n) {
                var s = this.compare, o = this.array, a = this.tmp, c = 0;
                for (c = 0; c < n; c++) a[c] = o[i + c];
                var l = t + e - 1, u = n - 1, h = i + n - 1, _ = 0, p = 0;
                if (o[h--] = o[l--], 0 != --e) if (1 !== n) {
                    for (var m = this.minGallop; ;) {
                        var v = 0, y = 0, g = !1;
                        do {
                            if (s(a[u], o[l]) < 0) {
                                if (o[h--] = o[l--], v++, y = 0, 0 == --e) {
                                    g = !0;
                                    break;
                                }
                            } else if (o[h--] = a[u--], y++, v = 0, 1 == --n) {
                                g = !0;
                                break;
                            }
                        } while ((v | y) < m);
                        if (g) break;
                        do {
                            if (0 != (v = e - d(a[u], o, t, e, e - 1, s))) {
                                for (e -= v, p = 1 + (h -= v), _ = 1 + (l -= v), c = v - 1; c >= 0; c--) o[p + c] = o[_ + c];
                                if (0 === e) {
                                    g = !0;
                                    break;
                                }
                            }
                            if (o[h--] = a[u--], 1 == --n) {
                                g = !0;
                                break;
                            }
                            if (0 != (y = n - f(o[l], a, 0, n, n - 1, s))) {
                                for (n -= y, p = 1 + (h -= y), _ = 1 + (u -= y), c = 0; c < y; c++) o[p + c] = a[_ + c];
                                if (n <= 1) {
                                    g = !0;
                                    break;
                                }
                            }
                            if (o[h--] = o[l--], 0 == --e) {
                                g = !0;
                                break;
                            }
                            m--;
                        } while (v >= r || y >= r);
                        if (g) break;
                        m < 0 && (m = 0), m += 2;
                    }
                    if (this.minGallop = m, m < 1 && (this.minGallop = 1), 1 === n) {
                        for (p = 1 + (h -= e), _ = 1 + (l -= e), c = e - 1; c >= 0; c--) o[p + c] = o[_ + c];
                        o[h] = a[u];
                    } else {
                        if (0 === n) throw new Error("mergeHigh preconditions were not respected");
                        for (_ = h - (n - 1), c = 0; c < n; c++) o[_ + c] = a[c];
                    }
                } else {
                    for (p = 1 + (h -= e), _ = 1 + (l -= e), c = e - 1; c >= 0; c--) o[p + c] = o[_ + c];
                    o[h] = a[u];
                } else for (_ = h - (n - 1), c = 0; c < n; c++) o[_ + c] = a[c];
            }, t;
        }();
        e.exports = i.default;
    }, {} ],
    315: [ function(t, e, i) {
        "use strict";
        i.__esModule = !0, i.default = void 0;
        for (var n = Array(8), r = 0; r < 8; ++r) n[r] = [];
        function s(t) {
            for (var e = 16; e <= 1 << 28; e *= 16) if (t <= e) return e;
            return 0;
        }
        function o(t) {
            var e, i;
            return e = (t > 65535) << 4, e |= i = ((t >>>= e) > 255) << 3, e |= i = ((t >>>= i) > 15) << 2, 
            (e |= i = ((t >>>= i) > 3) << 1) | (t >>>= i) >> 1;
        }
        function a(t) {
            var e = s(t), i = n[o(e) >> 2];
            return i.length > 0 ? i.pop() : new ArrayBuffer(e);
        }
        var c = {
            alloc_int8: function(t) {
                var e = new Int8Array(a(t), 0, t);
                return e.length !== t ? e.subarray(0, t) : e;
            },
            alloc_uint8: function(t) {
                var e = new Uint8Array(a(t), 0, t);
                return e.length !== t ? e.subarray(0, t) : e;
            },
            alloc_int16: function(t) {
                var e = new Int16Array(a(2 * t), 0, t);
                return e.length !== t ? e.subarray(0, t) : e;
            },
            alloc_uint16: function(t) {
                var e = new Uint16Array(a(2 * t), 0, t);
                return e.length !== t ? e.subarray(0, t) : e;
            },
            alloc_int32: function(t) {
                var e = new Int32Array(a(4 * t), 0, t);
                return e.length !== t ? e.subarray(0, t) : e;
            },
            alloc_uint32: function(t) {
                var e = new Uint32Array(a(4 * t), 0, t);
                return e.length !== t ? e.subarray(0, t) : e;
            },
            alloc_float32: function(t) {
                var e = new Float32Array(a(4 * t), 0, t);
                return e.length !== t ? e.subarray(0, t) : e;
            },
            alloc_float64: function(t) {
                var e = new Float64Array(a(8 * t), 0, t);
                return e.length !== t ? e.subarray(0, t) : e;
            },
            alloc_dataview: function(t) {
                var e = new DataView(a(t), 0, t);
                return e.length !== t ? e.subarray(0, t) : e;
            },
            free: function(t) {
                var e;
                e = t.buffer, n[o(e.byteLength) >> 2].push(e);
            },
            reset: function() {
                for (var t = Array(8), e = 0; e < 8; ++e) t[e] = [];
            }
        };
        i.default = c, e.exports = i.default;
    }, {} ],
    316: [ function(t, e, i) {
        "use strict";
        i.__esModule = !0, i.default = function(t, e) {
            for (var i, n = t.length, r = e ^ n, s = 0; n >= 4; ) i = 1540483477 * (65535 & (i = 255 & t.charCodeAt(s) | (255 & t.charCodeAt(++s)) << 8 | (255 & t.charCodeAt(++s)) << 16 | (255 & t.charCodeAt(++s)) << 24)) + ((1540483477 * (i >>> 16) & 65535) << 16), 
            r = 1540483477 * (65535 & r) + ((1540483477 * (r >>> 16) & 65535) << 16) ^ (i = 1540483477 * (65535 & (i ^= i >>> 24)) + ((1540483477 * (i >>> 16) & 65535) << 16)), 
            n -= 4, ++s;
            switch (n) {
              case 3:
                r ^= (255 & t.charCodeAt(s + 2)) << 16;

              case 2:
                r ^= (255 & t.charCodeAt(s + 1)) << 8;

              case 1:
                r = 1540483477 * (65535 & (r ^= 255 & t.charCodeAt(s))) + ((1540483477 * (r >>> 16) & 65535) << 16);
            }
            return r = 1540483477 * (65535 & (r ^= r >>> 13)) + ((1540483477 * (r >>> 16) & 65535) << 16), 
            (r ^= r >>> 15) >>> 0;
        }, e.exports = i.default;
    }, {} ],
    317: [ function(t, e, i) {
        "use strict";
        i.__esModule = !0, i.default = void 0;
        var n = t("../../core/value-types"), r = a(t("../core/base-renderer")), s = a(t("../enums")), o = t("../memop");
        function a(t) {
            return t && t.__esModule ? t : {
                default: t
            };
        }
        function c(t) {
            if (void 0 === t) throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
            return t;
        }
        var l = new Float32Array(16), u = new Float32Array(16), h = new Float32Array(16), _ = new Float32Array(16), f = new Float32Array(4), d = new Float32Array(64), p = [], m = new Float32Array(4), v = new n.Vec4(0, 0, 0, 0), y = new n.Vec3(0, 0, 0), g = new n.Vec3(0, 0, 0), x = new o.RecyclePool(function() {
            return new Float32Array(16);
        }, 8);
        function A(t, e) {
            return t._priority - e._priority;
        }
        var C = function(t) {
            var e, i;
            function r(e, i) {
                var n;
                return (n = t.call(this, e, i) || this)._time = new Float32Array(4), n._lights = [], 
                n._shadowLights = [], n._numLights = 0, n._defines = {}, n._registerStage("shadowcast", n._shadowStage.bind(c(n))), 
                n._registerStage("opaque", n._opaqueStage.bind(c(n))), n._registerStage("transparent", n._transparentStage.bind(c(n))), 
                n;
            }
            i = t, (e = r).prototype = Object.create(i.prototype), e.prototype.constructor = e, 
            e.__proto__ = i;
            var o = r.prototype;
            return o.reset = function() {
                x.reset(), t.prototype.reset.call(this);
            }, o.render = function(t, e) {
                this.reset(), e && (this._time[0] += e, this._time[1] = e, this._time[2]++), this._device.setUniform("cc_time", this._time), 
                this._updateLights(t);
                for (var i = this._device._gl.canvas, n = 0; n < t._cameras.length; ++n) {
                    var r = this._requestView(), s = i.width, o = i.height;
                    t._cameras.data[n].extractView(r, s, o);
                }
                this._viewPools.sort(A);
                for (var a = 0; a < this._viewPools.length; ++a) {
                    var c = this._viewPools.data[a];
                    this._render(c, t);
                }
            }, o.renderCamera = function(t, e) {
                this.reset(), this._updateLights(e);
                var i = this._device._gl.canvas, n = i.width, r = i.height, s = this._requestView();
                t.extractView(s, n, r), this._viewPools.sort(A);
                for (var o = 0; o < this._viewPools.length; ++o) {
                    var a = this._viewPools.data[o];
                    this._render(a, e);
                }
            }, o._updateLights = function(t) {
                this._lights.length = 0, this._shadowLights.length = 0;
                for (var e = t._lights, i = 0; i < e.length; ++i) {
                    var n = e.data[i];
                    if (n.update(this._device), n.shadowType !== s.default.SHADOW_NONE) {
                        this._shadowLights.length < 2 && this._shadowLights.splice(0, 0, n);
                        var r = this._requestView();
                        n.extractView(r, [ "shadowcast" ]), this._lights.splice(0, 0, n);
                    } else this._lights.push(n);
                }
                this._updateLightDefines(), this._numLights = e._count;
            }, o._updateLightDefines = function() {
                for (var t = this._defines, e = 0; e < this._lights.length; ++e) {
                    var i = this._lights[e];
                    t["CC_LIGHT_" + e + "_TYPE"] = i._type, t["CC_SHADOW_" + e + "_TYPE"] = i._shadowType;
                }
                t.CC_NUM_LIGHTS = Math.min(4, this._lights.length), t.CC_NUM_SHADOW_LIGHTS = Math.min(4, this._shadowLights.length);
            }, o._submitLightsUniforms = function() {
                var t = this._device;
                if (this._lights.length > 0) {
                    for (var e = x.add(), i = x.add(), n = x.add(), r = Math.min(4, this._lights.length), o = 0; o < r; ++o) {
                        var a = this._lights[o], c = 4 * o;
                        n.set(a._colorUniform, c), i.set(a._directionUniform, c), e.set(a._positionUniform, c), 
                        e[c + 3] = a._range, a._type === s.default.LIGHT_SPOT ? (i[c + 3] = a._spotUniform[0], 
                        n[c + 3] = a._spotUniform[1]) : (i[c + 3] = 0, n[c + 3] = 0);
                    }
                    t.setUniform("cc_lightDirection", i), t.setUniform("cc_lightColor", n), t.setUniform("cc_lightPositionAndRange", e);
                }
            }, o._submitShadowStageUniforms = function(t) {
                var e = t._shadowLight, i = m;
                i[0] = e.shadowMinDepth, i[1] = e.shadowMaxDepth, i[2] = e.shadowDepthScale, i[3] = e.shadowDarkness, 
                this._device.setUniform("cc_shadow_map_lightViewProjMatrix", n.Mat4.toArray(_, t._matViewProj)), 
                this._device.setUniform("cc_shadow_map_info", i), this._device.setUniform("cc_shadow_map_bias", e.shadowBias), 
                this._defines.CC_SHADOW_TYPE = e._shadowType;
            }, o._submitOtherStagesUniforms = function() {
                for (var t = x.add(), e = 0; e < this._shadowLights.length; ++e) {
                    var i = this._shadowLights[e], r = p[e];
                    r || (r = p[e] = new Float32Array(d.buffer, 64 * e, 16)), n.Mat4.toArray(r, i.viewProjMatrix);
                    var s = 4 * e;
                    t[s] = i.shadowMinDepth, t[s + 1] = i.shadowMaxDepth, t[s + 2] = i._shadowResolution, 
                    t[s + 3] = i.shadowDarkness;
                }
                this._device.setUniform("cc_shadow_lightViewProjMatrix", d), this._device.setUniform("cc_shadow_info", t);
            }, o._sortItems = function(t) {
                t.sort(function(t, e) {
                    return t.passes.length !== e.passes.length ? t.passes.length - e.passes.length : t.sortKey - e.sortKey;
                });
            }, o._shadowStage = function(t, e) {
                this._submitShadowStageUniforms(t);
                for (var i = 0; i < e.length; ++i) {
                    var n = e.data[i];
                    n.effect.getDefine("CC_CASTING_SHADOW") && this._draw(n);
                }
            }, o._drawItems = function(t, e) {
                var i = this._shadowLights;
                if (0 === i.length && 0 === this._numLights) for (var n = 0; n < e.length; ++n) {
                    var r = e.data[n];
                    this._draw(r);
                } else for (var s = 0; s < e.length; ++s) {
                    for (var o = e.data[s], a = 0; a < i.length; ++a) this._device.setTexture("cc_shadow_map_" + a, i[a].shadowMap, this._allocTextureUnit());
                    this._draw(o);
                }
            }, o._opaqueStage = function(t, e) {
                t.getPosition(v), this._device.setUniform("cc_matView", n.Mat4.toArray(l, t._matView)), 
                this._device.setUniform("cc_matViewInv", n.Mat4.toArray(u, t._matViewInv)), this._device.setUniform("cc_matProj", n.Mat4.toArray(h, t._matProj)), 
                this._device.setUniform("cc_matViewProj", n.Mat4.toArray(_, t._matViewProj)), this._device.setUniform("cc_cameraPos", n.Vec4.toArray(f, v)), 
                this._submitLightsUniforms(), this._submitOtherStagesUniforms(), this._drawItems(t, e);
            }, o._transparentStage = function(t, e) {
                t.getPosition(v), t.getForward(y), this._device.setUniform("cc_matView", n.Mat4.toArray(l, t._matView)), 
                this._device.setUniform("cc_matViewInv", n.Mat4.toArray(u, t._matViewInv)), this._device.setUniform("cc_matProj", n.Mat4.toArray(h, t._matProj)), 
                this._device.setUniform("cc_matViewProj", n.Mat4.toArray(_, t._matViewProj)), this._device.setUniform("cc_cameraPos", n.Vec4.toArray(f, v)), 
                this._submitLightsUniforms(), this._submitOtherStagesUniforms();
                for (var i = 0; i < e.length; ++i) {
                    var r = e.data[i];
                    r.node.getWorldPosition(g), n.Vec3.sub(g, g, v), r.sortKey = -n.Vec3.dot(g, y);
                }
                this._sortItems(e), this._drawItems(t, e);
            }, r;
        }(r.default);
        i.default = C, e.exports = i.default;
    }, {
        "../../core/value-types": 271,
        "../core/base-renderer": 287,
        "../enums": 293,
        "../memop": 310
    } ],
    318: [ function(t, e, i) {
        "use strict";
        i.__esModule = !0, i.default = void 0;
        var n, r = t("../../core/value-types"), s = t("../../core/geom-utils"), o = (n = t("../enums")) && n.__esModule ? n : {
            default: n
        };
        function a(t, e) {
            for (var i = 0; i < e.length; i++) {
                var n = e[i];
                n.enumerable = n.enumerable || !1, n.configurable = !0, "value" in n && (n.writable = !0), 
                Object.defineProperty(t, n.key, n);
            }
        }
        var c = new r.Mat4(), l = new r.Mat4(), u = new r.Mat4(), h = new r.Mat4(), _ = new r.Mat4(), f = new r.Mat4(), d = new r.Vec3(), p = new r.Vec3(), m = function() {
            function t() {
                this._poolID = -1, this._node = null, this._projection = o.default.PROJ_PERSPECTIVE, 
                this._priority = 0, this._color = new r.Vec4(.2, .3, .47, 1), this._depth = 1, this._stencil = 0, 
                this._clearFlags = o.default.CLEAR_COLOR | o.default.CLEAR_DEPTH, this._clearModel = null, 
                this._stages = [], this._framebuffer = null, this._near = .01, this._far = 1e3, 
                this._fov = Math.PI / 4, this._rect = {
                    x: 0,
                    y: 0,
                    w: 1,
                    h: 1
                }, this._orthoHeight = 10, this._cullingMask = 4294967295;
            }
            var e, i, n = t.prototype;
            return n.setCullingMask = function(t) {
                this._cullingMask = t;
            }, n.getNode = function() {
                return this._node;
            }, n.setNode = function(t) {
                this._node = t;
            }, n.getType = function() {
                return this._projection;
            }, n.setType = function(t) {
                this._projection = t;
            }, n.getPriority = function() {
                return this._priority;
            }, n.setPriority = function(t) {
                this._priority = t;
            }, n.getOrthoHeight = function() {
                return this._orthoHeight;
            }, n.setOrthoHeight = function(t) {
                this._orthoHeight = t;
            }, n.getFov = function() {
                return this._fov;
            }, n.setFov = function(t) {
                this._fov = t;
            }, n.getNear = function() {
                return this._near;
            }, n.setNear = function(t) {
                this._near = t;
            }, n.getFar = function() {
                return this._far;
            }, n.setFar = function(t) {
                this._far = t;
            }, n.getColor = function(t) {
                return r.Vec4.copy(t, this._color);
            }, n.setColor = function(t, e, i, n) {
                r.Vec4.set(this._color, t, e, i, n);
            }, n.getDepth = function() {
                return this._depth;
            }, n.setDepth = function(t) {
                this._depth = t;
            }, n.getStencil = function() {
                return this._stencil;
            }, n.setStencil = function(t) {
                this._stencil = t;
            }, n.getClearFlags = function() {
                return this._clearFlags;
            }, n.setClearFlags = function(t) {
                this._clearFlags = t;
            }, n.getRect = function(t) {
                return t.x = this._rect.x, t.y = this._rect.y, t.w = this._rect.w, t.h = this._rect.h, 
                t;
            }, n.setRect = function(t, e, i, n) {
                this._rect.x = t, this._rect.y = e, this._rect.w = i, this._rect.h = n;
            }, n.getStages = function() {
                return this._stages;
            }, n.setStages = function(t) {
                this._stages = t;
            }, n.getFramebuffer = function() {
                return this._framebuffer;
            }, n.setFrameBuffer = function(t) {
                this._framebuffer = t;
            }, n._calcMatrices = function(t, e) {
                this._node.getWorldRT(u), r.Mat4.invert(l, u);
                var i = t / e;
                if (this._projection === o.default.PROJ_PERSPECTIVE) r.Mat4.perspective(h, this._fov, i, this._near, this._far); else {
                    var n = this._orthoHeight * i, s = this._orthoHeight;
                    r.Mat4.ortho(h, -n, n, -s, s, this._near, this._far);
                }
                r.Mat4.mul(_, h, l), r.Mat4.invert(f, _);
            }, n.extractView = function(t, e, i) {
                this._framebuffer && (e = this._framebuffer._width, i = this._framebuffer._height), 
                t._priority = this._priority, t._rect.x = this._rect.x * e, t._rect.y = this._rect.y * i, 
                t._rect.w = this._rect.w * e, t._rect.h = this._rect.h * i, this.getColor(t._color), 
                t._depth = this._depth, t._stencil = this._stencil, t._clearFlags = this._clearFlags, 
                t._clearModel = this._clearModel, t._stages = this._stages, t._framebuffer = this._framebuffer, 
                this._calcMatrices(e, i), r.Mat4.copy(t._matView, l), r.Mat4.copy(t._matViewInv, u), 
                r.Mat4.copy(t._matProj, h), r.Mat4.copy(t._matViewProj, _), r.Mat4.copy(t._matInvViewProj, f), 
                t._cullingMask = this._cullingMask;
            }, n.screenPointToRay = function(t, e, i, n, a) {
                if (!cc.geomUtils) return a;
                a = a || new s.Ray(), this._calcMatrices(i, n);
                var c = this._rect.x * i, l = this._rect.y * n, u = this._rect.w * i, h = this._rect.h * n;
                return r.Vec3.set(p, (t - c) / u * 2 - 1, (e - l) / h * 2 - 1, 1), r.Vec3.transformMat4(p, p, f), 
                this._projection === o.default.PROJ_PERSPECTIVE ? this._node.getWorldPosition(d) : (r.Vec3.set(d, (t - c) / u * 2 - 1, (e - l) / h * 2 - 1, -1), 
                r.Vec3.transformMat4(d, d, f)), s.Ray.fromPoints(a, d, p);
            }, n.screenToWorld = function(t, e, i, n) {
                this._calcMatrices(i, n);
                var s = this._rect.x * i, a = this._rect.y * n, c = this._rect.w * i, l = this._rect.h * n;
                return this._projection === o.default.PROJ_PERSPECTIVE ? (r.Vec3.set(t, (e.x - s) / c * 2 - 1, (e.y - a) / l * 2 - 1, .9999), 
                r.Vec3.transformMat4(t, t, f), this._node.getWorldPosition(d), r.Vec3.lerp(t, d, t, (0, 
                r.lerp)(this._near / this._far, 1, e.z))) : (r.Vec3.set(t, (e.x - s) / c * 2 - 1, (e.y - a) / l * 2 - 1, 2 * e.z - 1), 
                r.Vec3.transformMat4(t, t, f)), t;
            }, n.worldToScreen = function(t, e, i, n) {
                this._calcMatrices(i, n);
                var s = this._rect.x * i, o = this._rect.y * n, a = this._rect.w * i, c = this._rect.h * n;
                return r.Vec3.transformMat4(t, e, _), t.x = s + .5 * (t.x + 1) * a, t.y = o + .5 * (t.y + 1) * c, 
                t.z = .5 * t.z + .5, t;
            }, n.worldMatrixToScreen = function(t, e, i, n) {
                this._calcMatrices(i, n), r.Mat4.mul(t, _, e);
                var s = i / 2, o = n / 2;
                return r.Mat4.identity(c), r.Mat4.transform(c, c, r.Vec3.set(d, s, o, 0)), r.Mat4.scale(c, c, r.Vec3.set(d, s, o, 1)), 
                r.Mat4.mul(t, c, t), t;
            }, e = t, (i = [ {
                key: "cullingMask",
                get: function() {
                    return this._cullingMask;
                },
                set: function(t) {
                    this._cullingMask = t;
                }
            } ]) && a(e.prototype, i), t;
        }();
        i.default = m, e.exports = i.default;
    }, {
        "../../core/geom-utils": 137,
        "../../core/value-types": 271,
        "../enums": 293
    } ],
    319: [ function(t, e, i) {
        "use strict";
        i.__esModule = !0, i.default = void 0;
        var n = function() {
            function t() {
                this._type = "default", this._poolID = -1, this._node = null, this._inputAssembler = null, 
                this._effect = null, this._viewID = -1, this._cameraID = -1, this._userKey = -1, 
                this._castShadow = !1, this._boundingShape = null;
            }
            var e = t.prototype;
            return e.setNode = function(t) {
                this._node = t;
            }, e.setInputAssembler = function(t) {
                this._inputAssembler = t;
            }, e.setEffect = function(t) {
                this._effect = t;
            }, e.setUserKey = function(t) {
                this._userKey = t;
            }, e.extractDrawItem = function(t) {
                t.model = this, t.node = this._node, t.ia = this._inputAssembler, t.effect = this._effect;
            }, t;
        }();
        i.default = n, e.exports = i.default;
    }, {} ],
    320: [ function(t, e, i) {
        "use strict";
        i.__esModule = !0, i.default = void 0;
        var n = t("../memop"), r = function() {
            function t(t) {
                this._lights = new n.FixedArray(16), this._models = new n.FixedArray(16), this._cameras = new n.FixedArray(16), 
                this._debugCamera = null, this._app = t, this._views = [];
            }
            var e = t.prototype;
            return e._add = function(t, e) {
                -1 === e._poolID && (t.push(e), e._poolID = t.length - 1);
            }, e._remove = function(t, e) {
                -1 !== e._poolID && (t.data[t.length - 1]._poolID = e._poolID, t.fastRemove(e._poolID), 
                e._poolID = -1);
            }, e.reset = function() {
                for (var t = 0; t < this._models.length; ++t) this._models.data[t]._viewID = -1;
            }, e.setDebugCamera = function(t) {
                this._debugCamera = t;
            }, e.getCameraCount = function() {
                return this._cameras.length;
            }, e.getCamera = function(t) {
                return this._cameras.data[t];
            }, e.addCamera = function(t) {
                this._add(this._cameras, t);
            }, e.removeCamera = function(t) {
                this._remove(this._cameras, t);
            }, e.getModelCount = function() {
                return this._models.length;
            }, e.getModel = function(t) {
                return this._models.data[t];
            }, e.addModel = function(t) {
                this._add(this._models, t);
            }, e.removeModel = function(t) {
                this._remove(this._models, t);
            }, e.getLightCount = function() {
                return this._lights.length;
            }, e.getLight = function(t) {
                return this._lights.data[t];
            }, e.addLight = function(t) {
                this._add(this._lights, t);
            }, e.removeLight = function(t) {
                this._remove(this._lights, t);
            }, e.addView = function(t) {
                -1 === this._views.indexOf(t) && this._views.push(t);
            }, e.removeView = function(t) {
                var e = this._views.indexOf(t);
                -1 !== e && this._views.splice(e, 1);
            }, t;
        }();
        i.default = r, e.exports = i.default;
    }, {
        "../memop": 310
    } ],
    321: [ function(t, e, i) {
        "use strict";
        i.__esModule = !0, i.getInspectorProps = function(t) {
            var e = {
                type: t.type
            };
            Object.assign(e, t.editor || t.inspector), e.defines = t.defines, e.value = y(e.type)(t.value), 
            t.range && (e.range = t.range);
            var i = g(e.type);
            return e.typeName = x[i] || i, e.valueCtor = d[e.type], "cc.Texture2D" == e.typeName && (e.typeName = "cc.Asset", 
            e.assetType = "cc.Texture2D"), e;
        }, i.getClassName = i.getInstanceCtor = i.getInstanceType = i.enums2default = i.ctor2enums = void 0;
        var n, r, s, o, a = u(t("./enums")), c = t("../core/value-types"), l = u(t("../core/assets/CCTexture2D"));
        function u(t) {
            return t && t.__esModule ? t : {
                default: t
            };
        }
        var h;
        h = t("./gfx/texture-2d");
        var _ = cc.Object, f = ((n = {})[Boolean] = function(t) {
            return t || !1;
        }, n[Number] = function(t) {
            return t ? ArrayBuffer.isView(t) ? t[0] : t : 0;
        }, n[c.Vec2] = function(t) {
            return t ? cc.v2(t[0], t[1]) : cc.v2();
        }, n[c.Vec3] = function(t) {
            return t ? cc.v3(t[0], t[1], t[2]) : cc.v3();
        }, n[c.Vec4] = function(t) {
            return t ? cc.v4(t[0], t[1], t[2], t[3]) : cc.v4();
        }, n[c.Color] = function(t) {
            return t ? cc.color(255 * t[0], 255 * t[1], 255 * t[2], 255 * (t[3] || 1)) : cc.color();
        }, n[c.Mat4] = function(t) {
            return t ? cc.mat4(t[0], t[1], t[2], t[3], t[4], t[5], t[6], t[7], t[8], t[9], t[10], t[11], t[12], t[13], t[14], t[15]) : cc.mat4();
        }, n[l.default] = function() {
            return null;
        }, n[_] = function() {
            return null;
        }, n), d = ((r = {})[a.default.PARAM_INT] = Number, r[a.default.PARAM_INT2] = c.Vec2, 
        r[a.default.PARAM_INT3] = c.Vec3, r[a.default.PARAM_INT4] = c.Vec4, r[a.default.PARAM_FLOAT] = Number, 
        r[a.default.PARAM_FLOAT2] = c.Vec2, r[a.default.PARAM_FLOAT3] = c.Vec3, r[a.default.PARAM_FLOAT4] = c.Vec4, 
        r[a.default.PARAM_MAT4] = c.Mat4, r[a.default.PARAM_TEXTURE_2D] = l.default, r.color = c.Color, 
        r.number = Number, r.boolean = Boolean, r.default = _, r), p = ((s = {})[Number] = a.default.PARAM_FLOAT, 
        s[c.Vec2] = a.default.PARAM_FLOAT2, s[c.Vec3] = a.default.PARAM_FLOAT3, s[c.Vec4] = a.default.PARAM_FLOAT4, 
        s[c.Color] = a.default.PARAM_COLOR3, s[c.Color] = a.default.PARAM_COLOR4, s[c.Mat4] = a.default.PARAM_MAT4, 
        s[l.default] = a.default.PARAM_TEXTURE_2D, s[h] = a.default.PARAM_TEXTURE_2D, s);
        i.ctor2enums = p;
        var m = ((o = {})[a.default.PARAM_INT] = new Uint32Array([ 0 ]), o[a.default.PARAM_INT2] = new Uint32Array([ 0, 0 ]), 
        o[a.default.PARAM_INT3] = new Uint32Array([ 0, 0, 0 ]), o[a.default.PARAM_INT4] = new Uint32Array([ 0, 0, 0, 0 ]), 
        o[a.default.PARAM_FLOAT] = new Float32Array([ 0 ]), o[a.default.PARAM_FLOAT2] = new Float32Array([ 0, 0 ]), 
        o[a.default.PARAM_FLOAT3] = new Float32Array([ 0, 0, 0 ]), o[a.default.PARAM_FLOAT4] = new Float32Array([ 0, 0, 0, 0 ]), 
        o[a.default.PARAM_MAT4] = cc.mat4().m, o[a.default.PARAM_TEXTURE_2D] = null, o.number = 0, 
        o.boolean = !1, o);
        i.enums2default = m;
        var v = function(t) {
            return d[t] || d.default;
        };
        i.getInstanceType = v;
        var y = function(t) {
            return f[v(t)];
        };
        i.getInstanceCtor = y;
        var g = function(t) {
            return cc.js.getClassName(v(t));
        };
        i.getClassName = g;
        var x = {
            Number: "number",
            Boolean: "boolean"
        };
    }, {
        "../core/assets/CCTexture2D": 73,
        "../core/value-types": 271,
        "./enums": 293,
        "./gfx/texture-2d": 303
    } ],
    322: [ function(t, e) {
        "use strict";
        var i = cc.Class({
            name: "cc.TiledMapAsset",
            extends: cc.Asset,
            properties: {
                tmxXmlStr: "",
                textures: {
                    default: [],
                    type: [ cc.Texture2D ]
                },
                textureNames: [ cc.String ],
                textureSizes: {
                    default: [],
                    type: [ cc.Size ]
                },
                imageLayerTextures: {
                    default: [],
                    type: [ cc.Texture2D ]
                },
                imageLayerTextureNames: [ cc.String ],
                tsxFiles: [ cc.TextAsset ],
                tsxFileNames: [ cc.String ]
            },
            statics: {
                preventDeferredLoadDependents: !0
            },
            createNode: !1
        });
        cc.TiledMapAsset = i, e.exports = i;
    }, {} ],
    323: [ function(t, e) {
        "use strict";
        var i = t("./video-player-impl"), n = i.EventType, r = cc.Enum({
            REMOTE: 0,
            LOCAL: 1
        }), s = cc.Class({
            name: "cc.VideoPlayer",
            extends: cc.Component,
            editor: !1,
            properties: {
                _resourceType: r.REMOTE,
                resourceType: {
                    tooltip: !1,
                    type: r,
                    set: function(t) {
                        this._resourceType = t, this._updateVideoSource();
                    },
                    get: function() {
                        return this._resourceType;
                    }
                },
                _remoteURL: "",
                remoteURL: {
                    tooltip: !1,
                    type: cc.String,
                    set: function(t) {
                        this._remoteURL = t, this._updateVideoSource();
                    },
                    get: function() {
                        return this._remoteURL;
                    }
                },
                _clip: {
                    default: null,
                    type: cc.Asset
                },
                clip: {
                    tooltip: !1,
                    get: function() {
                        return this._clip;
                    },
                    set: function(t) {
                        this._clip = t, this._updateVideoSource();
                    },
                    type: cc.Asset
                },
                currentTime: {
                    tooltip: !1,
                    type: cc.Float,
                    set: function(t) {
                        this._impl && this._impl.seekTo(t);
                    },
                    get: function() {
                        return this._impl ? this._currentStatus === n.NONE || this._currentStatus === n.STOPPED || this._currentStatus === n.META_LOADED || this._currentStatus === n.READY_TO_PLAY ? 0 : this._currentStatus === n.COMPLETED ? this._impl.duration() : this._impl.currentTime() : -1;
                    }
                },
                _volume: 1,
                volume: {
                    get: function() {
                        return this._volume;
                    },
                    set: function(t) {
                        this._volume = t, this.isPlaying() && !this._mute && this._syncVolume();
                    },
                    range: [ 0, 1 ],
                    type: cc.Float,
                    tooltip: !1
                },
                _mute: !1,
                mute: {
                    get: function() {
                        return this._mute;
                    },
                    set: function(t) {
                        this._mute = t, this._syncVolume();
                    },
                    tooltip: !1
                },
                keepAspectRatio: {
                    tooltip: !1,
                    default: !0,
                    type: cc.Boolean,
                    notify: function() {
                        this._impl && this._impl.setKeepAspectRatioEnabled(this.keepAspectRatio);
                    }
                },
                _isFullscreen: {
                    default: !1,
                    formerlySerializedAs: "_N$isFullscreen"
                },
                isFullscreen: {
                    get: function() {
                        return this._isFullscreen = this._impl && this._impl.isFullScreenEnabled(), this._isFullscreen;
                    },
                    set: function(t) {
                        this._isFullscreen = t, this._impl && this._impl.setFullScreenEnabled(t);
                    },
                    animatable: !1,
                    tooltip: !1
                },
                _stayOnBottom: !1,
                stayOnBottom: {
                    get: function() {
                        return this._stayOnBottom;
                    },
                    set: function(t) {
                        this._stayOnBottom = t, this._impl && this._impl.setStayOnBottom(t);
                    },
                    animatable: !1,
                    tooltip: !1
                },
                videoPlayerEvent: {
                    default: [],
                    type: cc.Component.EventHandler
                }
            },
            statics: {
                EventType: n,
                ResourceType: r,
                Impl: i
            },
            ctor: function() {
                this._impl = new i(), this._currentStatus = n.NONE;
            },
            _syncVolume: function() {
                var t = this._impl;
                if (t) {
                    var e = this._mute ? 0 : this._volume;
                    t.setVolume(e);
                }
            },
            _updateVideoSource: function() {
                var t = "";
                this.resourceType === r.REMOTE ? t = this.remoteURL : this._clip && (t = this._clip.nativeUrl), 
                this._impl.setURL(t, this._mute || 0 === this._volume), this._impl.setKeepAspectRatioEnabled(this.keepAspectRatio);
            },
            onLoad: function() {
                var t = this._impl;
                t && (t.createDomElementIfNeeded(this._mute || 0 === this._volume), t.setStayOnBottom(this._stayOnBottom), 
                this._updateVideoSource(), t.seekTo(this.currentTime), t.setFullScreenEnabled(this._isFullscreen), 
                this.pause(), t.setEventListener(n.PLAYING, this.onPlaying.bind(this)), t.setEventListener(n.PAUSED, this.onPasued.bind(this)), 
                t.setEventListener(n.STOPPED, this.onStopped.bind(this)), t.setEventListener(n.COMPLETED, this.onCompleted.bind(this)), 
                t.setEventListener(n.META_LOADED, this.onMetaLoaded.bind(this)), t.setEventListener(n.CLICKED, this.onClicked.bind(this)), 
                t.setEventListener(n.READY_TO_PLAY, this.onReadyToPlay.bind(this)));
            },
            onRestore: function() {
                this._impl || (this._impl = new i());
            },
            onEnable: function() {
                this._impl && this._impl.enable();
            },
            onDisable: function() {
                this._impl && this._impl.disable();
            },
            onDestroy: function() {
                this._impl && (this._impl.destroy(), this._impl = null);
            },
            update: function() {
                this._impl && this._impl.updateMatrix(this.node);
            },
            onReadyToPlay: function() {
                this._currentStatus = n.READY_TO_PLAY, cc.Component.EventHandler.emitEvents(this.videoPlayerEvent, this, n.READY_TO_PLAY), 
                this.node.emit("ready-to-play", this);
            },
            onMetaLoaded: function() {
                this._currentStatus = n.META_LOADED, cc.Component.EventHandler.emitEvents(this.videoPlayerEvent, this, n.META_LOADED), 
                this.node.emit("meta-loaded", this);
            },
            onClicked: function() {
                this._currentStatus = n.CLICKED, cc.Component.EventHandler.emitEvents(this.videoPlayerEvent, this, n.CLICKED), 
                this.node.emit("clicked", this);
            },
            onPlaying: function() {
                this._currentStatus = n.PLAYING, cc.Component.EventHandler.emitEvents(this.videoPlayerEvent, this, n.PLAYING), 
                this.node.emit("playing", this);
            },
            onPasued: function() {
                this._currentStatus = n.PAUSED, cc.Component.EventHandler.emitEvents(this.videoPlayerEvent, this, n.PAUSED), 
                this.node.emit("paused", this);
            },
            onStopped: function() {
                this._currentStatus = n.STOPPED, cc.Component.EventHandler.emitEvents(this.videoPlayerEvent, this, n.STOPPED), 
                this.node.emit("stopped", this);
            },
            onCompleted: function() {
                this._currentStatus = n.COMPLETED, cc.Component.EventHandler.emitEvents(this.videoPlayerEvent, this, n.COMPLETED), 
                this.node.emit("completed", this);
            },
            play: function() {
                this._impl && (this._syncVolume(), this._impl.play());
            },
            resume: function() {
                this._impl && (this._syncVolume(), this._impl.resume());
            },
            pause: function() {
                this._impl && this._impl.pause();
            },
            stop: function() {
                this._impl && this._impl.stop();
            },
            getDuration: function() {
                return this._impl ? this._impl.duration() : -1;
            },
            isPlaying: function() {
                return !!this._impl && this._impl.isPlaying();
            }
        });
        cc.VideoPlayer = e.exports = s;
    }, {
        "./video-player-impl": 324
    } ],
    324: [ function(t, e) {
        "use strict";
        var i = t("../core/platform/utils"), n = t("../core/platform/CCSys"), r = t("../core/platform/CCMacro"), s = 1, o = 4, a = cc.mat4(), c = cc.Class({
            name: "VideoPlayerImpl",
            ctor: function() {
                this._EventList = {}, this._video = null, this._url = "", this._waitingFullscreen = !1, 
                this._fullScreenEnabled = !1, this._stayOnBottom = !1, this._loadedmeta = !1, this._loaded = !1, 
                this._visible = !1, this._playing = !1, this._ignorePause = !1, this._forceUpdate = !1, 
                this._m00 = 0, this._m01 = 0, this._m04 = 0, this._m05 = 0, this._m12 = 0, this._m13 = 0, 
                this._w = 0, this._h = 0, this.__eventListeners = {};
            },
            _bindEvent: function() {
                var t = this._video, e = this, i = this.__eventListeners;
                i.loadedmetadata = function() {
                    e._loadedmeta = !0, e._forceUpdate = !0, e._waitingFullscreen && (e._waitingFullscreen = !1, 
                    e._toggleFullscreen(!0)), e._dispatchEvent(c.EventType.META_LOADED);
                }, i.ended = function() {
                    e._video === t && (e._playing = !1, e._dispatchEvent(c.EventType.COMPLETED));
                }, i.play = function() {
                    e._video === t && (e._playing = !0, e._updateVisibility(), e._dispatchEvent(c.EventType.PLAYING));
                }, i.pause = function() {
                    e._video === t && (e._playing = !1, e._ignorePause || e._dispatchEvent(c.EventType.PAUSED));
                }, i.click = function() {
                    e._dispatchEvent(c.EventType.CLICKED);
                }, t.addEventListener("loadedmetadata", i.loadedmetadata), t.addEventListener("ended", i.ended), 
                t.addEventListener("play", i.play), t.addEventListener("pause", i.pause), t.addEventListener("click", i.click), 
                i.onCanPlay = function() {
                    if (!e._loaded && !e._playing) {
                        var t = e._video;
                        t.readyState !== o && t.readyState !== s || (t.currentTime = 0, e._loaded = !0, 
                        e._forceUpdate = !0, e._dispatchEvent(c.EventType.READY_TO_PLAY), e._updateVisibility());
                    }
                }, t.addEventListener("canplay", i.onCanPlay), t.addEventListener("canplaythrough", i.onCanPlay), 
                t.addEventListener("suspend", i.onCanPlay);
            },
            _updateVisibility: function() {
                var t = this._video;
                t && (this._visible ? t.style.visibility = "visible" : (t.style.visibility = "hidden", 
                t.pause(), this._playing = !1));
            },
            _updateSize: function(t, e) {
                var i = this._video;
                i && (i.style.width = t + "px", i.style.height = e + "px");
            },
            _createDom: function(t) {
                var e = document.createElement("video");
                e.style.position = "absolute", e.style.bottom = "0px", e.style.left = "0px", e.style["z-index"] = this._stayOnBottom ? r.MIN_ZINDEX : 0, 
                e.className = "cocosVideo", e.setAttribute("preload", "auto"), e.setAttribute("webkit-playsinline", ""), 
                e.setAttribute("x5-playsinline", ""), e.setAttribute("playsinline", ""), t && e.setAttribute("muted", ""), 
                this._video = e, cc.game.container.appendChild(e);
            },
            createDomElementIfNeeded: function(t) {
                this._video || this._createDom(t);
            },
            removeDom: function() {
                var t = this._video;
                if (t) {
                    i.contains(cc.game.container, t) && cc.game.container.removeChild(t);
                    var e = this.__eventListeners;
                    t.removeEventListener("loadedmetadata", e.loadedmetadata), t.removeEventListener("ended", e.ended), 
                    t.removeEventListener("play", e.play), t.removeEventListener("pause", e.pause), 
                    t.removeEventListener("click", e.click), t.removeEventListener("canplay", e.onCanPlay), 
                    t.removeEventListener("canplaythrough", e.onCanPlay), t.removeEventListener("suspend", e.onCanPlay), 
                    e.loadedmetadata = null, e.ended = null, e.play = null, e.pause = null, e.click = null, 
                    e.onCanPlay = null;
                }
                this._video = null, this._url = "";
            },
            setURL: function(t, e) {
                var i, n;
                if (this._url !== t) {
                    this.removeDom(), this._url = t, this.createDomElementIfNeeded(e), this._bindEvent();
                    var r = this._video;
                    r.style.visibility = "hidden", this._loaded = !1, this._playing = !1, this._loadedmeta = !1, 
                    (i = document.createElement("source")).src = t, r.appendChild(i), n = cc.path.extname(t);
                    for (var s = c._polyfill, o = 0; o < s.canPlayType.length; o++) n !== s.canPlayType[o] && ((i = document.createElement("source")).src = t.replace(n, s.canPlayType[o]), 
                    r.appendChild(i));
                }
            },
            getURL: function() {
                return this._url;
            },
            play: function() {
                var t = this._video;
                t && this._visible && !this._playing && t.play();
            },
            pause: function() {
                var t = this._video;
                this._playing && t && t.pause();
            },
            resume: function() {
                this.play();
            },
            stop: function() {
                var t = this._video;
                t && this._visible && (this._ignorePause = !0, t.currentTime = 0, t.pause(), setTimeout(function() {
                    this._dispatchEvent(c.EventType.STOPPED), this._ignorePause = !1;
                }.bind(this), 0));
            },
            setVolume: function(t) {
                var e = this._video;
                e && (e.volume = t);
            },
            seekTo: function(t) {
                var e = this._video;
                e && (this._loaded ? e.currentTime = t : e.addEventListener(c._polyfill.event, function i() {
                    e.currentTime = t, e.removeEventListener(c._polyfill.event, i);
                }));
            },
            isPlaying: function() {
                return this._playing;
            },
            duration: function() {
                var t = this._video, e = -1;
                return t ? ((e = t.duration) <= 0 && cc.logID(7702), e) : e;
            },
            currentTime: function() {
                var t = this._video;
                return t ? t.currentTime : -1;
            },
            setKeepAspectRatioEnabled: function() {
                cc.logID(7700);
            },
            isKeepAspectRatioEnabled: function() {
                return !0;
            },
            _toggleFullscreen: function(t) {
                var e = this, i = this._video;
                i && (t ? (n.browserType === n.BROWSER_TYPE_IE && (i.style.transform = ""), cc.screen.requestFullScreen(i, function() {
                    var t = n.browserType === n.BROWSER_TYPE_IE ? document.msFullscreenElement : document.fullscreenElement;
                    e._fullScreenEnabled = t === i;
                }, function() {
                    e._fullScreenEnabled = !1;
                })) : cc.screen.fullScreen() && cc.screen.exitFullScreen(i));
            },
            setStayOnBottom: function(t) {
                this._stayOnBottom = t, this._video && (this._video.style["z-index"] = t ? r.MIN_ZINDEX : 0);
            },
            setFullScreenEnabled: function(t) {
                !this._loadedmeta && t ? this._waitingFullscreen = !0 : this._toggleFullscreen(t);
            },
            isFullScreenEnabled: function() {
                return this._fullScreenEnabled;
            },
            setEventListener: function(t, e) {
                this._EventList[t] = e;
            },
            removeEventListener: function(t) {
                this._EventList[t] = null;
            },
            _dispatchEvent: function(t) {
                var e = this._EventList[t];
                e && e.call(this, this, this._video.src);
            },
            onPlayEvent: function() {
                this._EventList[c.EventType.PLAYING].call(this, this, this._video.src);
            },
            enable: function() {
                var t = c.elements;
                -1 === t.indexOf(this) && t.push(this), this.setVisible(!0);
            },
            disable: function() {
                var t = c.elements, e = t.indexOf(this);
                -1 !== e && t.splice(e, 1), this.setVisible(!1);
            },
            destroy: function() {
                this.disable(), this.removeDom();
            },
            setVisible: function(t) {
                this._visible !== t && (this._visible = !!t, this._updateVisibility());
            },
            updateMatrix: function(t) {
                if (this._video && this._visible && !this._fullScreenEnabled) {
                    t.getWorldMatrix(a);
                    var e = cc.Camera._findRendererCamera(t);
                    e && e.worldMatrixToScreen(a, a, cc.game.canvas.width, cc.game.canvas.height);
                    var i = a.m;
                    if (this._forceUpdate || this._m00 !== i[0] || this._m01 !== i[1] || this._m04 !== i[4] || this._m05 !== i[5] || this._m12 !== i[12] || this._m13 !== i[13] || this._w !== t._contentSize.width || this._h !== t._contentSize.height) {
                        this._m00 = i[0], this._m01 = i[1], this._m04 = i[4], this._m05 = i[5], this._m12 = i[12], 
                        this._m13 = i[13], this._w = t._contentSize.width, this._h = t._contentSize.height;
                        var r, s, o = cc.view._devicePixelRatio, l = 1 / o, u = 1 / o, h = cc.game.container, _ = i[0] * l, f = i[1], d = i[4], p = i[5] * u, m = h && h.style.paddingLeft ? parseInt(h.style.paddingLeft) : 0, v = h && h.style.paddingBottom ? parseInt(h.style.paddingBottom) : 0;
                        c._polyfill.zoomInvalid ? (this._updateSize(this._w * _, this._h * p), _ = 1, p = 1, 
                        r = this._w * l, s = this._h * u) : (r = this._w * l, s = this._h * u, this._updateSize(this._w, this._h));
                        var y = r * i[0] * t._anchorPoint.x, g = s * i[5] * t._anchorPoint.y, x = "matrix(" + _ + "," + -f + "," + -d + "," + p + "," + (i[12] * l - y + m) + "," + -(i[13] * u - g + v) + ")";
                        this._video.style.transform = x, this._video.style["-webkit-transform"] = x, this._video.style["transform-origin"] = "0px 100% 0px", 
                        this._video.style["-webkit-transform-origin"] = "0px 100% 0px", n.browserType !== n.BROWSER_TYPE_IE && (this._forceUpdate = !1);
                    }
                }
            }
        });
        c.EventType = {
            NONE: -1,
            PLAYING: 0,
            PAUSED: 1,
            STOPPED: 2,
            COMPLETED: 3,
            META_LOADED: 4,
            CLICKED: 5,
            READY_TO_PLAY: 6
        }, c.elements = [], c.pauseElements = [], cc.game.on(cc.game.EVENT_HIDE, function() {
            for (var t, e = c.elements, i = 0; i < e.length; i++) (t = e[i]).isPlaying() && (t.pause(), 
            c.pauseElements.push(t));
        }), cc.game.on(cc.game.EVENT_SHOW, function() {
            for (var t = c.pauseElements, e = t.pop(); e; ) e.play(), e = t.pop();
        }), c._polyfill = {
            devicePixelRatio: !1,
            event: "canplay",
            canPlayType: []
        };
        var l = document.createElement("video");
        l.canPlayType && (l.canPlayType("video/ogg") && (c._polyfill.canPlayType.push(".ogg"), 
        c._polyfill.canPlayType.push(".ogv")), l.canPlayType("video/mp4") && c._polyfill.canPlayType.push(".mp4"), 
        l.canPlayType("video/webm") && c._polyfill.canPlayType.push(".webm")), n.OS_ANDROID !== n.os || n.browserType !== n.BROWSER_TYPE_SOUGOU && n.browserType !== n.BROWSER_TYPE_360 || (c._polyfill.zoomInvalid = !0);
        var u = document.createElement("style");
        u.innerHTML = ".cocosVideo:-moz-full-screen{transform:matrix(1,0,0,1,0,0) !important;}.cocosVideo:full-screen{transform:matrix(1,0,0,1,0,0) !important;}.cocosVideo:-webkit-full-screen{transform:matrix(1,0,0,1,0,0) !important;}", 
        document.head.appendChild(u), e.exports = c;
    }, {
        "../core/platform/CCMacro": 187,
        "../core/platform/CCSys": 191,
        "../core/platform/utils": 206
    } ],
    325: [ function(t) {
        "use strict";
        t("./cocos2d/core"), t("./cocos2d/animation"), t("./cocos2d/particle"), t("./cocos2d/tilemap"), 
        t("./cocos2d/videoplayer/CCVideoPlayer"), t("./cocos2d/webview/CCWebView"), t("./cocos2d/core/components/CCStudioComponent"), 
        t("./extensions/ccpool/CCNodePool"), t("./cocos2d/actions"), t("./extensions/spine"), 
        t("./extensions/dragonbones"), t("./cocos2d/deprecated");
    }, {
        "./cocos2d/actions": 7,
        "./cocos2d/animation": 16,
        "./cocos2d/core": 149,
        "./cocos2d/core/components/CCStudioComponent": void 0,
        "./cocos2d/deprecated": 283,
        "./cocos2d/particle": void 0,
        "./cocos2d/particle/CCParticleAsset": 285,
        "./cocos2d/tilemap": void 0,
        "./cocos2d/tilemap/CCTiledMapAsset": 322,
        "./cocos2d/videoplayer/CCVideoPlayer": 323,
        "./cocos2d/webview/CCWebView": void 0,
        "./extensions/ccpool/CCNodePool": 326,
        "./extensions/dragonbones": void 0,
        "./extensions/spine": void 0
    } ],
    326: [ function(t, e) {
        "use strict";
        cc.NodePool = function(t) {
            this.poolHandlerComp = t, this._pool = [];
        }, cc.NodePool.prototype = {
            constructor: cc.NodePool,
            size: function() {
                return this._pool.length;
            },
            clear: function() {
                for (var t = this._pool.length, e = 0; e < t; ++e) this._pool[e].destroy();
                this._pool.length = 0;
            },
            put: function(t) {
                if (t && -1 === this._pool.indexOf(t)) {
                    t.removeFromParent(!1);
                    var e = this.poolHandlerComp ? t.getComponent(this.poolHandlerComp) : null;
                    e && e.unuse && e.unuse(), this._pool.push(t);
                }
            },
            get: function() {
                var t = this._pool.length - 1;
                if (t < 0) return null;
                var e = this._pool[t];
                this._pool.length = t;
                var i = this.poolHandlerComp ? e.getComponent(this.poolHandlerComp) : null;
                return i && i.reuse && i.reuse.apply(i, arguments), e;
            }
        }, e.exports = cc.NodePool;
    }, {} ],
    327: [ function(t, e, i) {
        "use strict";
        var n;
        n = function(t) {
            function e(t, e) {
                return void 0 !== t ? t : e;
            }
            var i = 1e37, n = 1e-5, r = n * n, s = 3.14159265359, o = 2, a = 8, c = .008, l = 2 / 180 * s, u = 2 * c, h = -1, _ = function() {
                function t(t, e, i) {
                    void 0 === t && (t = 0), void 0 === e && (e = 0), void 0 === i && (i = 0), this.major = 0, 
                    this.minor = 0, this.revision = 0, this.major = t, this.minor = e, this.revision = i;
                }
                return t.prototype.toString = function() {
                    return this.major + "." + this.minor + "." + this.revision;
                }, t;
            }(), f = new _(2, 3, 2);
            function d(t, e) {
                for (var i = [], n = 0; n < t; ++n) i.push(e(n));
                return i;
            }
            function p(t, e) {
                void 0 === e && (e = 0);
                for (var i = [], n = 0; n < t; ++n) i.push(e);
                return i;
            }
            var m = Math.abs, v = Math.min, y = Math.max;
            function g(t, e, i) {
                return t < e ? e : t > i ? i : t;
            }
            var x = isFinite;
            function A(t) {
                return t * t;
            }
            function C(t) {
                return 1 / Math.sqrt(t);
            }
            var b, S = Math.sqrt, T = Math.pow, w = Math.cos, E = Math.sin, B = Math.acos, M = Math.asin, R = Math.atan2, P = function() {
                function t(t, e) {
                    void 0 === t && (t = 0), void 0 === e && (e = 0), this.x = t, this.y = e;
                }
                return t.prototype.Clone = function() {
                    return new t(this.x, this.y);
                }, t.prototype.SetZero = function() {
                    return this.x = 0, this.y = 0, this;
                }, t.prototype.Set = function(t, e) {
                    return this.x = t, this.y = e, this;
                }, t.prototype.Copy = function(t) {
                    return this.x = t.x, this.y = t.y, this;
                }, t.prototype.SelfAdd = function(t) {
                    return this.x += t.x, this.y += t.y, this;
                }, t.prototype.SelfAddXY = function(t, e) {
                    return this.x += t, this.y += e, this;
                }, t.prototype.SelfSub = function(t) {
                    return this.x -= t.x, this.y -= t.y, this;
                }, t.prototype.SelfSubXY = function(t, e) {
                    return this.x -= t, this.y -= e, this;
                }, t.prototype.SelfMul = function(t) {
                    return this.x *= t, this.y *= t, this;
                }, t.prototype.SelfMulAdd = function(t, e) {
                    return this.x += t * e.x, this.y += t * e.y, this;
                }, t.prototype.SelfMulSub = function(t, e) {
                    return this.x -= t * e.x, this.y -= t * e.y, this;
                }, t.prototype.Dot = function(t) {
                    return this.x * t.x + this.y * t.y;
                }, t.prototype.Cross = function(t) {
                    return this.x * t.y - this.y * t.x;
                }, t.prototype.Length = function() {
                    var t = this.x, e = this.y;
                    return Math.sqrt(t * t + e * e);
                }, t.prototype.LengthSquared = function() {
                    var t = this.x, e = this.y;
                    return t * t + e * e;
                }, t.prototype.Normalize = function() {
                    var t = this.Length();
                    if (t >= n) {
                        var e = 1 / t;
                        this.x *= e, this.y *= e;
                    }
                    return t;
                }, t.prototype.SelfNormalize = function() {
                    var t = this.Length();
                    if (t >= n) {
                        var e = 1 / t;
                        this.x *= e, this.y *= e;
                    }
                    return this;
                }, t.prototype.SelfRotate = function(t) {
                    var e = Math.cos(t), i = Math.sin(t), n = this.x;
                    return this.x = e * n - i * this.y, this.y = i * n + e * this.y, this;
                }, t.prototype.IsValid = function() {
                    return isFinite(this.x) && isFinite(this.y);
                }, t.prototype.SelfCrossVS = function(t) {
                    var e = this.x;
                    return this.x = t * this.y, this.y = -t * e, this;
                }, t.prototype.SelfCrossSV = function(t) {
                    var e = this.x;
                    return this.x = -t * this.y, this.y = t * e, this;
                }, t.prototype.SelfMinV = function(t) {
                    return this.x = v(this.x, t.x), this.y = v(this.y, t.y), this;
                }, t.prototype.SelfMaxV = function(t) {
                    return this.x = y(this.x, t.x), this.y = y(this.y, t.y), this;
                }, t.prototype.SelfAbs = function() {
                    return this.x = m(this.x), this.y = m(this.y), this;
                }, t.prototype.SelfNeg = function() {
                    return this.x = -this.x, this.y = -this.y, this;
                }, t.prototype.SelfSkew = function() {
                    var t = this.x;
                    return this.x = -this.y, this.y = t, this;
                }, t.MakeArray = function(e) {
                    return d(e, function() {
                        return new t();
                    });
                }, t.AbsV = function(t, e) {
                    return e.x = m(t.x), e.y = m(t.y), e;
                }, t.MinV = function(t, e, i) {
                    return i.x = v(t.x, e.x), i.y = v(t.y, e.y), i;
                }, t.MaxV = function(t, e, i) {
                    return i.x = y(t.x, e.x), i.y = y(t.y, e.y), i;
                }, t.ClampV = function(t, e, i, n) {
                    return n.x = g(t.x, e.x, i.x), n.y = g(t.y, e.y, i.y), n;
                }, t.RotateV = function(t, e, i) {
                    var n = t.x, r = t.y, s = Math.cos(e), o = Math.sin(e);
                    return i.x = s * n - o * r, i.y = o * n + s * r, i;
                }, t.DotVV = function(t, e) {
                    return t.x * e.x + t.y * e.y;
                }, t.CrossVV = function(t, e) {
                    return t.x * e.y - t.y * e.x;
                }, t.CrossVS = function(t, e, i) {
                    var n = t.x;
                    return i.x = e * t.y, i.y = -e * n, i;
                }, t.CrossVOne = function(t, e) {
                    var i = t.x;
                    return e.x = t.y, e.y = -i, e;
                }, t.CrossSV = function(t, e, i) {
                    var n = e.x;
                    return i.x = -t * e.y, i.y = t * n, i;
                }, t.CrossOneV = function(t, e) {
                    var i = t.x;
                    return e.x = -t.y, e.y = i, e;
                }, t.AddVV = function(t, e, i) {
                    return i.x = t.x + e.x, i.y = t.y + e.y, i;
                }, t.SubVV = function(t, e, i) {
                    return i.x = t.x - e.x, i.y = t.y - e.y, i;
                }, t.MulSV = function(t, e, i) {
                    return i.x = e.x * t, i.y = e.y * t, i;
                }, t.MulVS = function(t, e, i) {
                    return i.x = t.x * e, i.y = t.y * e, i;
                }, t.AddVMulSV = function(t, e, i, n) {
                    return n.x = t.x + e * i.x, n.y = t.y + e * i.y, n;
                }, t.SubVMulSV = function(t, e, i, n) {
                    return n.x = t.x - e * i.x, n.y = t.y - e * i.y, n;
                }, t.AddVCrossSV = function(t, e, i, n) {
                    var r = i.x;
                    return n.x = t.x - e * i.y, n.y = t.y + e * r, n;
                }, t.MidVV = function(t, e, i) {
                    return i.x = .5 * (t.x + e.x), i.y = .5 * (t.y + e.y), i;
                }, t.ExtVV = function(t, e, i) {
                    return i.x = .5 * (e.x - t.x), i.y = .5 * (e.y - t.y), i;
                }, t.IsEqualToV = function(t, e) {
                    return t.x === e.x && t.y === e.y;
                }, t.DistanceVV = function(t, e) {
                    var i = t.x - e.x, n = t.y - e.y;
                    return Math.sqrt(i * i + n * n);
                }, t.DistanceSquaredVV = function(t, e) {
                    var i = t.x - e.x, n = t.y - e.y;
                    return i * i + n * n;
                }, t.NegV = function(t, e) {
                    return e.x = -t.x, e.y = -t.y, e;
                }, t.ZERO = new t(0, 0), t.UNITX = new t(1, 0), t.UNITY = new t(0, 1), t.s_t0 = new t(), 
                t.s_t1 = new t(), t.s_t2 = new t(), t.s_t3 = new t(), t;
            }(), I = new P(0, 0), D = function() {
                function t(t, e, i) {
                    void 0 === t && (t = 0), void 0 === e && (e = 0), void 0 === i && (i = 0), this.x = t, 
                    this.y = e, this.z = i;
                }
                return t.prototype.Clone = function() {
                    return new t(this.x, this.y, this.z);
                }, t.prototype.SetZero = function() {
                    return this.x = 0, this.y = 0, this.z = 0, this;
                }, t.prototype.SetXYZ = function(t, e, i) {
                    return this.x = t, this.y = e, this.z = i, this;
                }, t.prototype.Copy = function(t) {
                    return this.x = t.x, this.y = t.y, this.z = t.z, this;
                }, t.prototype.SelfNeg = function() {
                    return this.x = -this.x, this.y = -this.y, this.z = -this.z, this;
                }, t.prototype.SelfAdd = function(t) {
                    return this.x += t.x, this.y += t.y, this.z += t.z, this;
                }, t.prototype.SelfAddXYZ = function(t, e, i) {
                    return this.x += t, this.y += e, this.z += i, this;
                }, t.prototype.SelfSub = function(t) {
                    return this.x -= t.x, this.y -= t.y, this.z -= t.z, this;
                }, t.prototype.SelfSubXYZ = function(t, e, i) {
                    return this.x -= t, this.y -= e, this.z -= i, this;
                }, t.prototype.SelfMul = function(t) {
                    return this.x *= t, this.y *= t, this.z *= t, this;
                }, t.DotV3V3 = function(t, e) {
                    return t.x * e.x + t.y * e.y + t.z * e.z;
                }, t.CrossV3V3 = function(t, e, i) {
                    var n = t.x, r = t.y, s = t.z, o = e.x, a = e.y, c = e.z;
                    return i.x = r * c - s * a, i.y = s * o - n * c, i.z = n * a - r * o, i;
                }, t.ZERO = new t(0, 0, 0), t.s_t0 = new t(), t;
            }(), V = function() {
                function t() {
                    this.ex = new P(1, 0), this.ey = new P(0, 1);
                }
                return t.prototype.Clone = function() {
                    return new t().Copy(this);
                }, t.FromVV = function(e, i) {
                    return new t().SetVV(e, i);
                }, t.FromSSSS = function(e, i, n, r) {
                    return new t().SetSSSS(e, i, n, r);
                }, t.FromAngle = function(e) {
                    return new t().SetAngle(e);
                }, t.prototype.SetSSSS = function(t, e, i, n) {
                    return this.ex.Set(t, i), this.ey.Set(e, n), this;
                }, t.prototype.SetVV = function(t, e) {
                    return this.ex.Copy(t), this.ey.Copy(e), this;
                }, t.prototype.SetAngle = function(t) {
                    var e = Math.cos(t), i = Math.sin(t);
                    return this.ex.Set(e, i), this.ey.Set(-i, e), this;
                }, t.prototype.Copy = function(t) {
                    return this.ex.Copy(t.ex), this.ey.Copy(t.ey), this;
                }, t.prototype.SetIdentity = function() {
                    return this.ex.Set(1, 0), this.ey.Set(0, 1), this;
                }, t.prototype.SetZero = function() {
                    return this.ex.SetZero(), this.ey.SetZero(), this;
                }, t.prototype.GetAngle = function() {
                    return Math.atan2(this.ex.y, this.ex.x);
                }, t.prototype.GetInverse = function(t) {
                    var e = this.ex.x, i = this.ey.x, n = this.ex.y, r = this.ey.y, s = e * r - i * n;
                    return 0 !== s && (s = 1 / s), t.ex.x = s * r, t.ey.x = -s * i, t.ex.y = -s * n, 
                    t.ey.y = s * e, t;
                }, t.prototype.Solve = function(t, e, i) {
                    var n = this.ex.x, r = this.ey.x, s = this.ex.y, o = this.ey.y, a = n * o - r * s;
                    return 0 !== a && (a = 1 / a), i.x = a * (o * t - r * e), i.y = a * (n * e - s * t), 
                    i;
                }, t.prototype.SelfAbs = function() {
                    return this.ex.SelfAbs(), this.ey.SelfAbs(), this;
                }, t.prototype.SelfInv = function() {
                    return this.GetInverse(this), this;
                }, t.prototype.SelfAddM = function(t) {
                    return this.ex.SelfAdd(t.ex), this.ey.SelfAdd(t.ey), this;
                }, t.prototype.SelfSubM = function(t) {
                    return this.ex.SelfSub(t.ex), this.ey.SelfSub(t.ey), this;
                }, t.AbsM = function(t, e) {
                    var i = t.ex, n = t.ey;
                    return e.ex.x = m(i.x), e.ex.y = m(i.y), e.ey.x = m(n.x), e.ey.y = m(n.y), e;
                }, t.MulMV = function(t, e, i) {
                    var n = t.ex, r = t.ey, s = e.x, o = e.y;
                    return i.x = n.x * s + r.x * o, i.y = n.y * s + r.y * o, i;
                }, t.MulTMV = function(t, e, i) {
                    var n = t.ex, r = t.ey, s = e.x, o = e.y;
                    return i.x = n.x * s + n.y * o, i.y = r.x * s + r.y * o, i;
                }, t.AddMM = function(t, e, i) {
                    var n = t.ex, r = t.ey, s = e.ex, o = e.ey;
                    return i.ex.x = n.x + s.x, i.ex.y = n.y + s.y, i.ey.x = r.x + o.x, i.ey.y = r.y + o.y, 
                    i;
                }, t.MulMM = function(t, e, i) {
                    var n = t.ex.x, r = t.ex.y, s = t.ey.x, o = t.ey.y, a = e.ex.x, c = e.ex.y, l = e.ey.x, u = e.ey.y;
                    return i.ex.x = n * a + s * c, i.ex.y = r * a + o * c, i.ey.x = n * l + s * u, i.ey.y = r * l + o * u, 
                    i;
                }, t.MulTMM = function(t, e, i) {
                    var n = t.ex.x, r = t.ex.y, s = t.ey.x, o = t.ey.y, a = e.ex.x, c = e.ex.y, l = e.ey.x, u = e.ey.y;
                    return i.ex.x = n * a + r * c, i.ex.y = s * a + o * c, i.ey.x = n * l + r * u, i.ey.y = s * l + o * u, 
                    i;
                }, t.IDENTITY = new t(), t;
            }(), L = function() {
                function t() {
                    this.ex = new D(1, 0, 0), this.ey = new D(0, 1, 0), this.ez = new D(0, 0, 1);
                }
                return t.prototype.Clone = function() {
                    return new t().Copy(this);
                }, t.prototype.SetVVV = function(t, e, i) {
                    return this.ex.Copy(t), this.ey.Copy(e), this.ez.Copy(i), this;
                }, t.prototype.Copy = function(t) {
                    return this.ex.Copy(t.ex), this.ey.Copy(t.ey), this.ez.Copy(t.ez), this;
                }, t.prototype.SetIdentity = function() {
                    return this.ex.SetXYZ(1, 0, 0), this.ey.SetXYZ(0, 1, 0), this.ez.SetXYZ(0, 0, 1), 
                    this;
                }, t.prototype.SetZero = function() {
                    return this.ex.SetZero(), this.ey.SetZero(), this.ez.SetZero(), this;
                }, t.prototype.SelfAddM = function(t) {
                    return this.ex.SelfAdd(t.ex), this.ey.SelfAdd(t.ey), this.ez.SelfAdd(t.ez), this;
                }, t.prototype.Solve33 = function(t, e, i, n) {
                    var r = this.ex.x, s = this.ex.y, o = this.ex.z, a = this.ey.x, c = this.ey.y, l = this.ey.z, u = this.ez.x, h = this.ez.y, _ = this.ez.z, f = r * (c * _ - l * h) + s * (l * u - a * _) + o * (a * h - c * u);
                    return 0 !== f && (f = 1 / f), n.x = f * (t * (c * _ - l * h) + e * (l * u - a * _) + i * (a * h - c * u)), 
                    n.y = f * (r * (e * _ - i * h) + s * (i * u - t * _) + o * (t * h - e * u)), n.z = f * (r * (c * i - l * e) + s * (l * t - a * i) + o * (a * e - c * t)), 
                    n;
                }, t.prototype.Solve22 = function(t, e, i) {
                    var n = this.ex.x, r = this.ey.x, s = this.ex.y, o = this.ey.y, a = n * o - r * s;
                    return 0 !== a && (a = 1 / a), i.x = a * (o * t - r * e), i.y = a * (n * e - s * t), 
                    i;
                }, t.prototype.GetInverse22 = function(t) {
                    var e = this.ex.x, i = this.ey.x, n = this.ex.y, r = this.ey.y, s = e * r - i * n;
                    0 !== s && (s = 1 / s), t.ex.x = s * r, t.ey.x = -s * i, t.ex.z = 0, t.ex.y = -s * n, 
                    t.ey.y = s * e, t.ey.z = 0, t.ez.x = 0, t.ez.y = 0, t.ez.z = 0;
                }, t.prototype.GetSymInverse33 = function(t) {
                    var e = D.DotV3V3(this.ex, D.CrossV3V3(this.ey, this.ez, D.s_t0));
                    0 !== e && (e = 1 / e);
                    var i = this.ex.x, n = this.ey.x, r = this.ez.x, s = this.ey.y, o = this.ez.y, a = this.ez.z;
                    t.ex.x = e * (s * a - o * o), t.ex.y = e * (r * o - n * a), t.ex.z = e * (n * o - r * s), 
                    t.ey.x = t.ex.y, t.ey.y = e * (i * a - r * r), t.ey.z = e * (r * n - i * o), t.ez.x = t.ex.z, 
                    t.ez.y = t.ey.z, t.ez.z = e * (i * s - n * n);
                }, t.MulM33V3 = function(t, e, i) {
                    var n = e.x, r = e.y, s = e.z;
                    return i.x = t.ex.x * n + t.ey.x * r + t.ez.x * s, i.y = t.ex.y * n + t.ey.y * r + t.ez.y * s, 
                    i.z = t.ex.z * n + t.ey.z * r + t.ez.z * s, i;
                }, t.MulM33XYZ = function(t, e, i, n, r) {
                    return r.x = t.ex.x * e + t.ey.x * i + t.ez.x * n, r.y = t.ex.y * e + t.ey.y * i + t.ez.y * n, 
                    r.z = t.ex.z * e + t.ey.z * i + t.ez.z * n, r;
                }, t.MulM33V2 = function(t, e, i) {
                    var n = e.x, r = e.y;
                    return i.x = t.ex.x * n + t.ey.x * r, i.y = t.ex.y * n + t.ey.y * r, i;
                }, t.MulM33XY = function(t, e, i, n) {
                    return n.x = t.ex.x * e + t.ey.x * i, n.y = t.ex.y * e + t.ey.y * i, n;
                }, t.IDENTITY = new t(), t;
            }(), O = function() {
                function t(t) {
                    void 0 === t && (t = 0), this.s = 0, this.c = 1, t && (this.s = Math.sin(t), this.c = Math.cos(t));
                }
                return t.prototype.Clone = function() {
                    return new t().Copy(this);
                }, t.prototype.Copy = function(t) {
                    return this.s = t.s, this.c = t.c, this;
                }, t.prototype.SetAngle = function(t) {
                    return this.s = Math.sin(t), this.c = Math.cos(t), this;
                }, t.prototype.SetIdentity = function() {
                    return this.s = 0, this.c = 1, this;
                }, t.prototype.GetAngle = function() {
                    return Math.atan2(this.s, this.c);
                }, t.prototype.GetXAxis = function(t) {
                    return t.x = this.c, t.y = this.s, t;
                }, t.prototype.GetYAxis = function(t) {
                    return t.x = -this.s, t.y = this.c, t;
                }, t.MulRR = function(t, e, i) {
                    var n = t.c, r = t.s, s = e.c, o = e.s;
                    return i.s = r * s + n * o, i.c = n * s - r * o, i;
                }, t.MulTRR = function(t, e, i) {
                    var n = t.c, r = t.s, s = e.c, o = e.s;
                    return i.s = n * o - r * s, i.c = n * s + r * o, i;
                }, t.MulRV = function(t, e, i) {
                    var n = t.c, r = t.s, s = e.x, o = e.y;
                    return i.x = n * s - r * o, i.y = r * s + n * o, i;
                }, t.MulTRV = function(t, e, i) {
                    var n = t.c, r = t.s, s = e.x, o = e.y;
                    return i.x = n * s + r * o, i.y = -r * s + n * o, i;
                }, t.IDENTITY = new t(), t;
            }(), F = function() {
                function t() {
                    this.p = new P(), this.q = new O();
                }
                return t.prototype.Clone = function() {
                    return new t().Copy(this);
                }, t.prototype.Copy = function(t) {
                    return this.p.Copy(t.p), this.q.Copy(t.q), this;
                }, t.prototype.SetIdentity = function() {
                    return this.p.SetZero(), this.q.SetIdentity(), this;
                }, t.prototype.SetPositionRotation = function(t, e) {
                    return this.p.Copy(t), this.q.Copy(e), this;
                }, t.prototype.SetPositionAngle = function(t, e) {
                    return this.p.Copy(t), this.q.SetAngle(e), this;
                }, t.prototype.SetPosition = function(t) {
                    return this.p.Copy(t), this;
                }, t.prototype.SetPositionXY = function(t, e) {
                    return this.p.Set(t, e), this;
                }, t.prototype.SetRotation = function(t) {
                    return this.q.Copy(t), this;
                }, t.prototype.SetRotationAngle = function(t) {
                    return this.q.SetAngle(t), this;
                }, t.prototype.GetPosition = function() {
                    return this.p;
                }, t.prototype.GetRotation = function() {
                    return this.q;
                }, t.prototype.GetRotationAngle = function() {
                    return this.q.GetAngle();
                }, t.prototype.GetAngle = function() {
                    return this.q.GetAngle();
                }, t.MulXV = function(t, e, i) {
                    var n = t.q.c, r = t.q.s, s = e.x, o = e.y;
                    return i.x = n * s - r * o + t.p.x, i.y = r * s + n * o + t.p.y, i;
                }, t.MulTXV = function(t, e, i) {
                    var n = t.q.c, r = t.q.s, s = e.x - t.p.x, o = e.y - t.p.y;
                    return i.x = n * s + r * o, i.y = -r * s + n * o, i;
                }, t.MulXX = function(t, e, i) {
                    return O.MulRR(t.q, e.q, i.q), P.AddVV(O.MulRV(t.q, e.p, i.p), t.p, i.p), i;
                }, t.MulTXX = function(t, e, i) {
                    return O.MulTRR(t.q, e.q, i.q), O.MulTRV(t.q, P.SubVV(e.p, t.p, i.p), i.p), i;
                }, t.IDENTITY = new t(), t;
            }(), N = function() {
                function t() {
                    this.localCenter = new P(), this.c0 = new P(), this.c = new P(), this.a0 = 0, this.a = 0, 
                    this.alpha0 = 0;
                }
                return t.prototype.Clone = function() {
                    return new t().Copy(this);
                }, t.prototype.Copy = function(t) {
                    return this.localCenter.Copy(t.localCenter), this.c0.Copy(t.c0), this.c.Copy(t.c), 
                    this.a0 = t.a0, this.a = t.a, this.alpha0 = t.alpha0, this;
                }, t.prototype.GetTransform = function(t, e) {
                    var i = 1 - e;
                    t.p.x = i * this.c0.x + e * this.c.x, t.p.y = i * this.c0.y + e * this.c.y;
                    var n = i * this.a0 + e * this.a;
                    return t.q.SetAngle(n), t.p.SelfSub(O.MulRV(t.q, this.localCenter, P.s_t0)), t;
                }, t.prototype.Advance = function(t) {
                    var e = (t - this.alpha0) / (1 - this.alpha0), i = 1 - e;
                    this.c0.x = i * this.c0.x + e * this.c.x, this.c0.y = i * this.c0.y + e * this.c.y, 
                    this.a0 = i * this.a0 + e * this.a, this.alpha0 = t;
                }, t.prototype.Normalize = function() {
                    var t = 6.28318530718 * Math.floor(this.a0 / 6.28318530718);
                    this.a0 -= t, this.a -= t;
                }, t;
            }(), G = function() {
                function t(t, e, i, n) {
                    void 0 === t && (t = .5), void 0 === e && (e = .5), void 0 === i && (i = .5), void 0 === n && (n = 1), 
                    this.r = t, this.g = e, this.b = i, this.a = n;
                }
                return t.prototype.Clone = function() {
                    return new t().Copy(this);
                }, t.prototype.Copy = function(t) {
                    return this.r = t.r, this.g = t.g, this.b = t.b, this.a = t.a, this;
                }, t.prototype.IsEqual = function(t) {
                    return this.r === t.r && this.g === t.g && this.b === t.b && this.a === t.a;
                }, t.prototype.IsZero = function() {
                    return 0 === this.r && 0 === this.g && 0 === this.b && 0 === this.a;
                }, t.prototype.Set = function(t, e, i, n) {
                    void 0 === n && (n = this.a), this.SetRGBA(t, e, i, n);
                }, t.prototype.SetByteRGB = function(t, e, i) {
                    return this.r = t / 255, this.g = e / 255, this.b = i / 255, this;
                }, t.prototype.SetByteRGBA = function(t, e, i, n) {
                    return this.r = t / 255, this.g = e / 255, this.b = i / 255, this.a = n / 255, this;
                }, t.prototype.SetRGB = function(t, e, i) {
                    return this.r = t, this.g = e, this.b = i, this;
                }, t.prototype.SetRGBA = function(t, e, i, n) {
                    return this.r = t, this.g = e, this.b = i, this.a = n, this;
                }, t.prototype.SelfAdd = function(t) {
                    return this.r += t.r, this.g += t.g, this.b += t.b, this.a += t.a, this;
                }, t.prototype.Add = function(t, e) {
                    return e.r = this.r + t.r, e.g = this.g + t.g, e.b = this.b + t.b, e.a = this.a + t.a, 
                    e;
                }, t.prototype.SelfSub = function(t) {
                    return this.r -= t.r, this.g -= t.g, this.b -= t.b, this.a -= t.a, this;
                }, t.prototype.Sub = function(t, e) {
                    return e.r = this.r - t.r, e.g = this.g - t.g, e.b = this.b - t.b, e.a = this.a - t.a, 
                    e;
                }, t.prototype.SelfMul = function(t) {
                    return this.r *= t, this.g *= t, this.b *= t, this.a *= t, this;
                }, t.prototype.Mul = function(t, e) {
                    return e.r = this.r * t, e.g = this.g * t, e.b = this.b * t, e.a = this.a * t, e;
                }, t.prototype.Mix = function(e, i) {
                    t.MixColors(this, e, i);
                }, t.MixColors = function(t, e, i) {
                    var n = i * (e.r - t.r), r = i * (e.g - t.g), s = i * (e.b - t.b), o = i * (e.a - t.a);
                    t.r += n, t.g += r, t.b += s, t.a += o, e.r -= n, e.g -= r, e.b -= s, e.a -= o;
                }, t.prototype.MakeStyleString = function(e) {
                    return void 0 === e && (e = this.a), t.MakeStyleString(this.r, this.g, this.b, e);
                }, t.MakeStyleString = function(t, e, i, n) {
                    return void 0 === n && (n = 1), t *= 255, e *= 255, i *= 255, n < 1 ? "rgba(" + t + "," + e + "," + i + "," + n + ")" : "rgb(" + t + "," + e + "," + i + ")";
                }, t.ZERO = new t(0, 0, 0, 0), t.RED = new t(1, 0, 0), t.GREEN = new t(0, 1, 0), 
                t.BLUE = new t(0, 0, 1), t;
            }();
            (b = t.b2DrawFlags || (t.b2DrawFlags = {}))[b.e_none = 0] = "e_none", b[b.e_shapeBit = 1] = "e_shapeBit", 
            b[b.e_jointBit = 2] = "e_jointBit", b[b.e_aabbBit = 4] = "e_aabbBit", b[b.e_pairBit = 8] = "e_pairBit", 
            b[b.e_centerOfMassBit = 16] = "e_centerOfMassBit", b[b.e_particleBit = 32] = "e_particleBit", 
            b[b.e_controllerBit = 64] = "e_controllerBit", b[b.e_all = 63] = "e_all";
            var k = function() {
                function t() {
                    this.m_drawFlags = 0;
                }
                return t.prototype.SetFlags = function(t) {
                    this.m_drawFlags = t;
                }, t.prototype.GetFlags = function() {
                    return this.m_drawFlags;
                }, t.prototype.AppendFlags = function(t) {
                    this.m_drawFlags |= t;
                }, t.prototype.ClearFlags = function(t) {
                    this.m_drawFlags &= ~t;
                }, t;
            }(), z = function() {
                function t() {
                    this.m_start = Date.now();
                }
                return t.prototype.Reset = function() {
                    return this.m_start = Date.now(), this;
                }, t.prototype.GetMilliseconds = function() {
                    return Date.now() - this.m_start;
                }, t;
            }(), U = function() {
                function t() {
                    this.m_count = 0, this.m_min_count = 0, this.m_max_count = 0;
                }
                return t.prototype.GetCount = function() {
                    return this.m_count;
                }, t.prototype.GetMinCount = function() {
                    return this.m_min_count;
                }, t.prototype.GetMaxCount = function() {
                    return this.m_max_count;
                }, t.prototype.ResetCount = function() {
                    var t = this.m_count;
                    return this.m_count = 0, t;
                }, t.prototype.ResetMinCount = function() {
                    this.m_min_count = 0;
                }, t.prototype.ResetMaxCount = function() {
                    this.m_max_count = 0;
                }, t.prototype.Increment = function() {
                    this.m_count++, this.m_max_count < this.m_count && (this.m_max_count = this.m_count);
                }, t.prototype.Decrement = function() {
                    this.m_count--, this.m_min_count > this.m_count && (this.m_min_count = this.m_count);
                }, t;
            }(), H = function() {
                function t(t) {
                    this.m_stack = [], this.m_count = 0, this.m_stack = d(t, function() {
                        return null;
                    }), this.m_count = 0;
                }
                return t.prototype.Reset = function() {
                    return this.m_count = 0, this;
                }, t.prototype.Push = function(t) {
                    this.m_stack[this.m_count] = t, this.m_count++;
                }, t.prototype.Pop = function() {
                    this.m_count--;
                    var t = this.m_stack[this.m_count];
                    if (this.m_stack[this.m_count] = null, null === t) throw new Error();
                    return t;
                }, t.prototype.GetCount = function() {
                    return this.m_count;
                }, t;
            }(), W = function() {
                function t() {
                    this.m_buffer = P.MakeArray(2), this.m_vertices = this.m_buffer, this.m_count = 0, 
                    this.m_radius = 0;
                }
                return t.prototype.Copy = function(t) {
                    return t.m_vertices === t.m_buffer ? (this.m_vertices = this.m_buffer, this.m_buffer[0].Copy(t.m_buffer[0]), 
                    this.m_buffer[1].Copy(t.m_buffer[1])) : this.m_vertices = t.m_vertices, this.m_count = t.m_count, 
                    this.m_radius = t.m_radius, this;
                }, t.prototype.Reset = function() {
                    return this.m_vertices = this.m_buffer, this.m_count = 0, this.m_radius = 0, this;
                }, t.prototype.SetShape = function(t, e) {
                    t.SetupDistanceProxy(this, e);
                }, t.prototype.SetVerticesRadius = function(t, e, i) {
                    this.m_vertices = t, this.m_count = e, this.m_radius = i;
                }, t.prototype.GetSupport = function(t) {
                    for (var e = 0, i = P.DotVV(this.m_vertices[0], t), n = 1; n < this.m_count; ++n) {
                        var r = P.DotVV(this.m_vertices[n], t);
                        r > i && (e = n, i = r);
                    }
                    return e;
                }, t.prototype.GetSupportVertex = function(t) {
                    for (var e = 0, i = P.DotVV(this.m_vertices[0], t), n = 1; n < this.m_count; ++n) {
                        var r = P.DotVV(this.m_vertices[n], t);
                        r > i && (e = n, i = r);
                    }
                    return this.m_vertices[e];
                }, t.prototype.GetVertexCount = function() {
                    return this.m_count;
                }, t.prototype.GetVertex = function(t) {
                    return this.m_vertices[t];
                }, t;
            }(), j = function() {
                function t() {
                    this.metric = 0, this.count = 0, this.indexA = [ 0, 0, 0 ], this.indexB = [ 0, 0, 0 ];
                }
                return t.prototype.Reset = function() {
                    return this.metric = 0, this.count = 0, this;
                }, t;
            }(), q = function() {
                function t() {
                    this.proxyA = new W(), this.proxyB = new W(), this.transformA = new F(), this.transformB = new F(), 
                    this.useRadii = !1;
                }
                return t.prototype.Reset = function() {
                    return this.proxyA.Reset(), this.proxyB.Reset(), this.transformA.SetIdentity(), 
                    this.transformB.SetIdentity(), this.useRadii = !1, this;
                }, t;
            }(), X = function() {
                function t() {
                    this.pointA = new P(), this.pointB = new P(), this.distance = 0, this.iterations = 0;
                }
                return t.prototype.Reset = function() {
                    return this.pointA.SetZero(), this.pointB.SetZero(), this.distance = 0, this.iterations = 0, 
                    this;
                }, t;
            }();
            t.b2_gjkCalls = 0, t.b2_gjkIters = 0, t.b2_gjkMaxIters = 0;
            var Y = function() {
                function t() {
                    this.wA = new P(), this.wB = new P(), this.w = new P(), this.a = 0, this.indexA = 0, 
                    this.indexB = 0;
                }
                return t.prototype.Copy = function(t) {
                    return this.wA.Copy(t.wA), this.wB.Copy(t.wB), this.w.Copy(t.w), this.a = t.a, this.indexA = t.indexA, 
                    this.indexB = t.indexB, this;
                }, t;
            }(), J = function() {
                function t() {
                    this.m_v1 = new Y(), this.m_v2 = new Y(), this.m_v3 = new Y(), this.m_vertices = [], 
                    this.m_count = 0, this.m_vertices[0] = this.m_v1, this.m_vertices[1] = this.m_v2, 
                    this.m_vertices[2] = this.m_v3;
                }
                return t.prototype.ReadCache = function(t, e, i, r, s) {
                    this.m_count = t.count;
                    for (var o = this.m_vertices, a = 0; a < this.m_count; ++a) {
                        (_ = o[a]).indexA = t.indexA[a], _.indexB = t.indexB[a];
                        var c = e.GetVertex(_.indexA), l = r.GetVertex(_.indexB);
                        F.MulXV(i, c, _.wA), F.MulXV(s, l, _.wB), P.SubVV(_.wB, _.wA, _.w), _.a = 0;
                    }
                    if (this.m_count > 1) {
                        var u = t.metric, h = this.GetMetric();
                        (h < .5 * u || 2 * u < h || h < n) && (this.m_count = 0);
                    }
                    var _;
                    0 === this.m_count && ((_ = o[0]).indexA = 0, _.indexB = 0, c = e.GetVertex(0), 
                    l = r.GetVertex(0), F.MulXV(i, c, _.wA), F.MulXV(s, l, _.wB), P.SubVV(_.wB, _.wA, _.w), 
                    _.a = 1, this.m_count = 1);
                }, t.prototype.WriteCache = function(t) {
                    t.metric = this.GetMetric(), t.count = this.m_count;
                    for (var e = this.m_vertices, i = 0; i < this.m_count; ++i) t.indexA[i] = e[i].indexA, 
                    t.indexB[i] = e[i].indexB;
                }, t.prototype.GetSearchDirection = function(t) {
                    switch (this.m_count) {
                      case 1:
                        return P.NegV(this.m_v1.w, t);

                      case 2:
                        var e = P.SubVV(this.m_v2.w, this.m_v1.w, t);
                        return P.CrossVV(e, P.NegV(this.m_v1.w, P.s_t0)) > 0 ? P.CrossOneV(e, t) : P.CrossVOne(e, t);

                      default:
                        return t.SetZero();
                    }
                }, t.prototype.GetClosestPoint = function(t) {
                    switch (this.m_count) {
                      case 0:
                        return t.SetZero();

                      case 1:
                        return t.Copy(this.m_v1.w);

                      case 2:
                        return t.Set(this.m_v1.a * this.m_v1.w.x + this.m_v2.a * this.m_v2.w.x, this.m_v1.a * this.m_v1.w.y + this.m_v2.a * this.m_v2.w.y);

                      case 3:
                      default:
                        return t.SetZero();
                    }
                }, t.prototype.GetWitnessPoints = function(t, e) {
                    switch (this.m_count) {
                      case 0:
                        break;

                      case 1:
                        t.Copy(this.m_v1.wA), e.Copy(this.m_v1.wB);
                        break;

                      case 2:
                        t.x = this.m_v1.a * this.m_v1.wA.x + this.m_v2.a * this.m_v2.wA.x, t.y = this.m_v1.a * this.m_v1.wA.y + this.m_v2.a * this.m_v2.wA.y, 
                        e.x = this.m_v1.a * this.m_v1.wB.x + this.m_v2.a * this.m_v2.wB.x, e.y = this.m_v1.a * this.m_v1.wB.y + this.m_v2.a * this.m_v2.wB.y;
                        break;

                      case 3:
                        e.x = t.x = this.m_v1.a * this.m_v1.wA.x + this.m_v2.a * this.m_v2.wA.x + this.m_v3.a * this.m_v3.wA.x, 
                        e.y = t.y = this.m_v1.a * this.m_v1.wA.y + this.m_v2.a * this.m_v2.wA.y + this.m_v3.a * this.m_v3.wA.y;
                    }
                }, t.prototype.GetMetric = function() {
                    switch (this.m_count) {
                      case 0:
                      case 1:
                        return 0;

                      case 2:
                        return P.DistanceVV(this.m_v1.w, this.m_v2.w);

                      case 3:
                        return P.CrossVV(P.SubVV(this.m_v2.w, this.m_v1.w, P.s_t0), P.SubVV(this.m_v3.w, this.m_v1.w, P.s_t1));

                      default:
                        return 0;
                    }
                }, t.prototype.Solve2 = function() {
                    var e = this.m_v1.w, i = this.m_v2.w, n = P.SubVV(i, e, t.s_e12), r = -P.DotVV(e, n);
                    if (r <= 0) return this.m_v1.a = 1, void (this.m_count = 1);
                    var s = P.DotVV(i, n);
                    if (s <= 0) return this.m_v2.a = 1, this.m_count = 1, void this.m_v1.Copy(this.m_v2);
                    var o = 1 / (s + r);
                    this.m_v1.a = s * o, this.m_v2.a = r * o, this.m_count = 2;
                }, t.prototype.Solve3 = function() {
                    var e = this.m_v1.w, i = this.m_v2.w, n = this.m_v3.w, r = P.SubVV(i, e, t.s_e12), s = P.DotVV(e, r), o = P.DotVV(i, r), a = -s, c = P.SubVV(n, e, t.s_e13), l = P.DotVV(e, c), u = P.DotVV(n, c), h = -l, _ = P.SubVV(n, i, t.s_e23), f = P.DotVV(i, _), d = P.DotVV(n, _), p = -f, m = P.CrossVV(r, c), v = m * P.CrossVV(i, n), y = m * P.CrossVV(n, e), g = m * P.CrossVV(e, i);
                    if (a <= 0 && h <= 0) return this.m_v1.a = 1, void (this.m_count = 1);
                    if (o > 0 && a > 0 && g <= 0) {
                        var x = 1 / (o + a);
                        return this.m_v1.a = o * x, this.m_v2.a = a * x, void (this.m_count = 2);
                    }
                    if (u > 0 && h > 0 && y <= 0) {
                        var A = 1 / (u + h);
                        return this.m_v1.a = u * A, this.m_v3.a = h * A, this.m_count = 2, void this.m_v2.Copy(this.m_v3);
                    }
                    if (o <= 0 && p <= 0) return this.m_v2.a = 1, this.m_count = 1, void this.m_v1.Copy(this.m_v2);
                    if (u <= 0 && d <= 0) return this.m_v3.a = 1, this.m_count = 1, void this.m_v1.Copy(this.m_v3);
                    if (d > 0 && p > 0 && v <= 0) {
                        var C = 1 / (d + p);
                        return this.m_v2.a = d * C, this.m_v3.a = p * C, this.m_count = 2, void this.m_v1.Copy(this.m_v3);
                    }
                    var b = 1 / (v + y + g);
                    this.m_v1.a = v * b, this.m_v2.a = y * b, this.m_v3.a = g * b, this.m_count = 3;
                }, t.s_e12 = new P(), t.s_e13 = new P(), t.s_e23 = new P(), t;
            }(), Z = new J(), K = [ 0, 0, 0 ], Q = [ 0, 0, 0 ], $ = new P(), tt = new P(), et = new P(), it = new P(), nt = new P();
            function rt(e, i, s) {
                ++t.b2_gjkCalls;
                var o = s.proxyA, a = s.proxyB, c = s.transformA, l = s.transformB, u = Z;
                u.ReadCache(i, o, c, a, l);
                for (var h = u.m_vertices, _ = K, f = Q, d = 0, p = 0; p < 20; ) {
                    d = u.m_count;
                    for (var m = 0; m < d; ++m) _[m] = h[m].indexA, f[m] = h[m].indexB;
                    switch (u.m_count) {
                      case 1:
                        break;

                      case 2:
                        u.Solve2();
                        break;

                      case 3:
                        u.Solve3();
                    }
                    if (3 === u.m_count) break;
                    var v = u.GetSearchDirection(tt);
                    if (v.LengthSquared() < r) break;
                    var g = h[u.m_count];
                    g.indexA = o.GetSupport(O.MulTRV(c.q, P.NegV(v, P.s_t0), it)), F.MulXV(c, o.GetVertex(g.indexA), g.wA), 
                    g.indexB = a.GetSupport(O.MulTRV(l.q, v, nt)), F.MulXV(l, a.GetVertex(g.indexB), g.wB), 
                    P.SubVV(g.wB, g.wA, g.w), ++p, ++t.b2_gjkIters;
                    var x = !1;
                    for (m = 0; m < d; ++m) if (g.indexA === _[m] && g.indexB === f[m]) {
                        x = !0;
                        break;
                    }
                    if (x) break;
                    ++u.m_count;
                }
                if (t.b2_gjkMaxIters = y(t.b2_gjkMaxIters, p), u.GetWitnessPoints(e.pointA, e.pointB), 
                e.distance = P.DistanceVV(e.pointA, e.pointB), e.iterations = p, u.WriteCache(i), 
                s.useRadii) {
                    var A = o.m_radius, C = a.m_radius;
                    if (e.distance > A + C && e.distance > n) {
                        e.distance -= A + C;
                        var b = P.SubVV(e.pointB, e.pointA, et);
                        b.Normalize(), e.pointA.SelfMulAdd(A, b), e.pointB.SelfMulSub(C, b);
                    } else {
                        var S = P.MidVV(e.pointA, e.pointB, $);
                        e.pointA.Copy(S), e.pointB.Copy(S), e.distance = 0;
                    }
                }
            }
            var st, ot = new P(), at = new J(), ct = new P(), lt = new P(), ut = new P(), ht = new P(), _t = new P(), ft = new P();
            (st = t.b2ContactFeatureType || (t.b2ContactFeatureType = {}))[st.e_vertex = 0] = "e_vertex", 
            st[st.e_face = 1] = "e_face";
            var dt, pt = function() {
                function t() {
                    this._key = 0, this._key_invalid = !1, this._indexA = 0, this._indexB = 0, this._typeA = 0, 
                    this._typeB = 0;
                }
                return Object.defineProperty(t.prototype, "key", {
                    get: function() {
                        return this._key_invalid && (this._key_invalid = !1, this._key = this._indexA | this._indexB << 8 | this._typeA << 16 | this._typeB << 24), 
                        this._key;
                    },
                    set: function(t) {
                        this._key = t, this._key_invalid = !1, this._indexA = 255 & this._key, this._indexB = this._key >> 8 & 255, 
                        this._typeA = this._key >> 16 & 255, this._typeB = this._key >> 24 & 255;
                    },
                    enumerable: !0,
                    configurable: !0
                }), Object.defineProperty(t.prototype, "indexA", {
                    get: function() {
                        return this._indexA;
                    },
                    set: function(t) {
                        this._indexA = t, this._key_invalid = !0;
                    },
                    enumerable: !0,
                    configurable: !0
                }), Object.defineProperty(t.prototype, "indexB", {
                    get: function() {
                        return this._indexB;
                    },
                    set: function(t) {
                        this._indexB = t, this._key_invalid = !0;
                    },
                    enumerable: !0,
                    configurable: !0
                }), Object.defineProperty(t.prototype, "typeA", {
                    get: function() {
                        return this._typeA;
                    },
                    set: function(t) {
                        this._typeA = t, this._key_invalid = !0;
                    },
                    enumerable: !0,
                    configurable: !0
                }), Object.defineProperty(t.prototype, "typeB", {
                    get: function() {
                        return this._typeB;
                    },
                    set: function(t) {
                        this._typeB = t, this._key_invalid = !0;
                    },
                    enumerable: !0,
                    configurable: !0
                }), t;
            }(), mt = function() {
                function t() {
                    this.cf = new pt();
                }
                return t.prototype.Copy = function(t) {
                    return this.key = t.key, this;
                }, t.prototype.Clone = function() {
                    return new t().Copy(this);
                }, Object.defineProperty(t.prototype, "key", {
                    get: function() {
                        return this.cf.key;
                    },
                    set: function(t) {
                        this.cf.key = t;
                    },
                    enumerable: !0,
                    configurable: !0
                }), t;
            }(), vt = function() {
                function t() {
                    this.localPoint = new P(), this.normalImpulse = 0, this.tangentImpulse = 0, this.id = new mt();
                }
                return t.MakeArray = function(e) {
                    return d(e, function() {
                        return new t();
                    });
                }, t.prototype.Reset = function() {
                    this.localPoint.SetZero(), this.normalImpulse = 0, this.tangentImpulse = 0, this.id.key = 0;
                }, t.prototype.Copy = function(t) {
                    return this.localPoint.Copy(t.localPoint), this.normalImpulse = t.normalImpulse, 
                    this.tangentImpulse = t.tangentImpulse, this.id.Copy(t.id), this;
                }, t;
            }();
            (dt = t.b2ManifoldType || (t.b2ManifoldType = {}))[dt.e_unknown = -1] = "e_unknown", 
            dt[dt.e_circles = 0] = "e_circles", dt[dt.e_faceA = 1] = "e_faceA", dt[dt.e_faceB = 2] = "e_faceB";
            var yt, gt = function() {
                function e() {
                    this.points = vt.MakeArray(o), this.localNormal = new P(), this.localPoint = new P(), 
                    this.type = t.b2ManifoldType.e_unknown, this.pointCount = 0;
                }
                return e.prototype.Reset = function() {
                    for (var e = 0; e < o; ++e) this.points[e].Reset();
                    this.localNormal.SetZero(), this.localPoint.SetZero(), this.type = t.b2ManifoldType.e_unknown, 
                    this.pointCount = 0;
                }, e.prototype.Copy = function(t) {
                    this.pointCount = t.pointCount;
                    for (var e = 0; e < o; ++e) this.points[e].Copy(t.points[e]);
                    return this.localNormal.Copy(t.localNormal), this.localPoint.Copy(t.localPoint), 
                    this.type = t.type, this;
                }, e.prototype.Clone = function() {
                    return new e().Copy(this);
                }, e;
            }(), xt = function() {
                function e() {
                    this.normal = new P(), this.points = P.MakeArray(o), this.separations = p(o);
                }
                return e.prototype.Initialize = function(i, n, s, o, a) {
                    if (0 !== i.pointCount) switch (i.type) {
                      case t.b2ManifoldType.e_circles:
                        this.normal.Set(1, 0);
                        var c = F.MulXV(n, i.localPoint, e.Initialize_s_pointA), l = F.MulXV(o, i.points[0].localPoint, e.Initialize_s_pointB);
                        P.DistanceSquaredVV(c, l) > r && P.SubVV(l, c, this.normal).SelfNormalize();
                        var u = P.AddVMulSV(c, s, this.normal, e.Initialize_s_cA), h = P.SubVMulSV(l, a, this.normal, e.Initialize_s_cB);
                        P.MidVV(u, h, this.points[0]), this.separations[0] = P.DotVV(P.SubVV(h, u, P.s_t0), this.normal);
                        break;

                      case t.b2ManifoldType.e_faceA:
                        O.MulRV(n.q, i.localNormal, this.normal);
                        for (var _ = F.MulXV(n, i.localPoint, e.Initialize_s_planePoint), f = 0; f < i.pointCount; ++f) {
                            var d = F.MulXV(o, i.points[f].localPoint, e.Initialize_s_clipPoint), p = s - P.DotVV(P.SubVV(d, _, P.s_t0), this.normal);
                            u = P.AddVMulSV(d, p, this.normal, e.Initialize_s_cA), h = P.SubVMulSV(d, a, this.normal, e.Initialize_s_cB), 
                            P.MidVV(u, h, this.points[f]), this.separations[f] = P.DotVV(P.SubVV(h, u, P.s_t0), this.normal);
                        }
                        break;

                      case t.b2ManifoldType.e_faceB:
                        for (O.MulRV(o.q, i.localNormal, this.normal), _ = F.MulXV(o, i.localPoint, e.Initialize_s_planePoint), 
                        f = 0; f < i.pointCount; ++f) d = F.MulXV(n, i.points[f].localPoint, e.Initialize_s_clipPoint), 
                        p = a - P.DotVV(P.SubVV(d, _, P.s_t0), this.normal), h = P.AddVMulSV(d, p, this.normal, e.Initialize_s_cB), 
                        u = P.SubVMulSV(d, s, this.normal, e.Initialize_s_cA), P.MidVV(u, h, this.points[f]), 
                        this.separations[f] = P.DotVV(P.SubVV(u, h, P.s_t0), this.normal);
                        this.normal.SelfNeg();
                    }
                }, e.Initialize_s_pointA = new P(), e.Initialize_s_pointB = new P(), e.Initialize_s_cA = new P(), 
                e.Initialize_s_cB = new P(), e.Initialize_s_planePoint = new P(), e.Initialize_s_clipPoint = new P(), 
                e;
            }();
            (yt = t.b2PointState || (t.b2PointState = {}))[yt.b2_nullState = 0] = "b2_nullState", 
            yt[yt.b2_addState = 1] = "b2_addState", yt[yt.b2_persistState = 2] = "b2_persistState", 
            yt[yt.b2_removeState = 3] = "b2_removeState";
            var At = function() {
                function t() {
                    this.v = new P(), this.id = new mt();
                }
                return t.MakeArray = function(e) {
                    return d(e, function() {
                        return new t();
                    });
                }, t.prototype.Copy = function(t) {
                    return this.v.Copy(t.v), this.id.Copy(t.id), this;
                }, t;
            }(), Ct = function() {
                function t() {
                    this.p1 = new P(), this.p2 = new P(), this.maxFraction = 1;
                }
                return t.prototype.Copy = function(t) {
                    return this.p1.Copy(t.p1), this.p2.Copy(t.p2), this.maxFraction = t.maxFraction, 
                    this;
                }, t;
            }(), bt = function() {
                function t() {
                    this.normal = new P(), this.fraction = 0;
                }
                return t.prototype.Copy = function(t) {
                    return this.normal.Copy(t.normal), this.fraction = t.fraction, this;
                }, t;
            }(), St = function() {
                function t() {
                    this.lowerBound = new P(), this.upperBound = new P(), this.m_cache_center = new P(), 
                    this.m_cache_extent = new P();
                }
                return t.prototype.Copy = function(t) {
                    return this.lowerBound.Copy(t.lowerBound), this.upperBound.Copy(t.upperBound), this;
                }, t.prototype.IsValid = function() {
                    var t = this.upperBound.x - this.lowerBound.x, e = this.upperBound.y - this.lowerBound.y, i = t >= 0 && e >= 0;
                    return i && this.lowerBound.IsValid() && this.upperBound.IsValid();
                }, t.prototype.GetCenter = function() {
                    return P.MidVV(this.lowerBound, this.upperBound, this.m_cache_center);
                }, t.prototype.GetExtents = function() {
                    return P.ExtVV(this.lowerBound, this.upperBound, this.m_cache_extent);
                }, t.prototype.GetPerimeter = function() {
                    return 2 * (this.upperBound.x - this.lowerBound.x + (this.upperBound.y - this.lowerBound.y));
                }, t.prototype.Combine1 = function(t) {
                    return this.lowerBound.x = v(this.lowerBound.x, t.lowerBound.x), this.lowerBound.y = v(this.lowerBound.y, t.lowerBound.y), 
                    this.upperBound.x = y(this.upperBound.x, t.upperBound.x), this.upperBound.y = y(this.upperBound.y, t.upperBound.y), 
                    this;
                }, t.prototype.Combine2 = function(t, e) {
                    return this.lowerBound.x = v(t.lowerBound.x, e.lowerBound.x), this.lowerBound.y = v(t.lowerBound.y, e.lowerBound.y), 
                    this.upperBound.x = y(t.upperBound.x, e.upperBound.x), this.upperBound.y = y(t.upperBound.y, e.upperBound.y), 
                    this;
                }, t.Combine = function(t, e, i) {
                    return i.Combine2(t, e), i;
                }, t.prototype.Contains = function(t) {
                    var e = !0;
                    return (e = (e = (e = e && this.lowerBound.x <= t.lowerBound.x) && this.lowerBound.y <= t.lowerBound.y) && t.upperBound.x <= this.upperBound.x) && t.upperBound.y <= this.upperBound.y;
                }, t.prototype.RayCast = function(t, e) {
                    var r, s, o = -i, a = i, c = e.p1.x, l = e.p1.y, u = e.p2.x - e.p1.x, h = e.p2.y - e.p1.y, _ = m(u), f = m(h), d = t.normal;
                    if (_ < n) {
                        if (c < this.lowerBound.x || this.upperBound.x < c) return !1;
                    } else {
                        var p = 1 / u, y = -1;
                        if ((r = (this.lowerBound.x - c) * p) > (s = (this.upperBound.x - c) * p)) {
                            var g = r;
                            r = s, s = g, y = 1;
                        }
                        if (r > o && (d.x = y, d.y = 0, o = r), o > (a = v(a, s))) return !1;
                    }
                    if (f < n) {
                        if (l < this.lowerBound.y || this.upperBound.y < l) return !1;
                    } else if (p = 1 / h, y = -1, (r = (this.lowerBound.y - l) * p) > (s = (this.upperBound.y - l) * p) && (g = r, 
                    r = s, s = g, y = 1), r > o && (d.x = 0, d.y = y, o = r), o > (a = v(a, s))) return !1;
                    return !(o < 0 || e.maxFraction < o || (t.fraction = o, 0));
                }, t.prototype.TestContain = function(t) {
                    return !(t.x < this.lowerBound.x || this.upperBound.x < t.x || t.y < this.lowerBound.y || this.upperBound.y < t.y);
                }, t.prototype.TestOverlap = function(t) {
                    var e = t.lowerBound.x - this.upperBound.x, i = t.lowerBound.y - this.upperBound.y, n = this.lowerBound.x - t.upperBound.x, r = this.lowerBound.y - t.upperBound.y;
                    return !(e > 0 || i > 0 || n > 0 || r > 0);
                }, t;
            }();
            function Tt(t, e) {
                var i = e.lowerBound.x - t.upperBound.x, n = e.lowerBound.y - t.upperBound.y, r = t.lowerBound.x - e.upperBound.x, s = t.lowerBound.y - e.upperBound.y;
                return !(i > 0 || n > 0 || r > 0 || s > 0);
            }
            function wt(e, i, n, r, s) {
                var o = 0, a = i[0], c = i[1], l = P.DotVV(n, a.v) - r, u = P.DotVV(n, c.v) - r;
                if (l <= 0 && e[o++].Copy(a), u <= 0 && e[o++].Copy(c), l * u < 0) {
                    var h = l / (l - u), _ = e[o].v;
                    _.x = a.v.x + h * (c.v.x - a.v.x), _.y = a.v.y + h * (c.v.y - a.v.y);
                    var f = e[o].id;
                    f.cf.indexA = s, f.cf.indexB = a.id.cf.indexB, f.cf.typeA = t.b2ContactFeatureType.e_vertex, 
                    f.cf.typeB = t.b2ContactFeatureType.e_face, ++o;
                }
                return o;
            }
            var Et = new q(), Bt = new j(), Mt = new X();
            function Rt(t, e, i, r, s, o) {
                var a = Et.Reset();
                a.proxyA.SetShape(t, e), a.proxyB.SetShape(i, r), a.transformA.Copy(s), a.transformB.Copy(o), 
                a.useRadii = !0;
                var c = Bt.Reset();
                c.count = 0;
                var l = Mt.Reset();
                return rt(l, c, a), l.distance < 10 * n;
            }
            function Pt(t) {
                if (null === t) throw new Error();
                return t;
            }
            var It = function() {
                function t(t) {
                    void 0 === t && (t = 0), this.m_id = 0, this.aabb = new St(), this.parent = null, 
                    this.child1 = null, this.child2 = null, this.height = 0, this.m_id = t;
                }
                return t.prototype.IsLeaf = function() {
                    return null === this.child1;
                }, t;
            }(), Dt = function() {
                function t() {
                    this.m_root = null, this.m_freeList = null, this.m_path = 0, this.m_insertionCount = 0, 
                    this.m_stack = new H(256);
                }
                return t.prototype.Query = function(t, e) {
                    if (null !== this.m_root) {
                        var i = this.m_stack.Reset();
                        for (i.Push(this.m_root); i.GetCount() > 0; ) {
                            var n = i.Pop();
                            if (n.aabb.TestOverlap(t)) if (n.IsLeaf()) {
                                if (!e(n)) return;
                            } else i.Push(Pt(n.child1)), i.Push(Pt(n.child2));
                        }
                    }
                }, t.prototype.QueryPoint = function(t, e) {
                    if (null !== this.m_root) {
                        var i = this.m_stack.Reset();
                        for (i.Push(this.m_root); i.GetCount() > 0; ) {
                            var n = i.Pop();
                            if (n.aabb.TestContain(t)) if (n.IsLeaf()) {
                                if (!e(n)) return;
                            } else i.Push(Pt(n.child1)), i.Push(Pt(n.child2));
                        }
                    }
                }, t.prototype.RayCast = function(e, i) {
                    if (null !== this.m_root) {
                        var n = e.p1, r = e.p2, s = P.SubVV(r, n, t.s_r);
                        s.Normalize();
                        var o = P.CrossOneV(s, t.s_v), a = P.AbsV(o, t.s_abs_v), c = e.maxFraction, l = t.s_segmentAABB, u = n.x + c * (r.x - n.x), h = n.y + c * (r.y - n.y);
                        l.lowerBound.x = v(n.x, u), l.lowerBound.y = v(n.y, h), l.upperBound.x = y(n.x, u), 
                        l.upperBound.y = y(n.y, h);
                        var _ = this.m_stack.Reset();
                        for (_.Push(this.m_root); _.GetCount() > 0; ) {
                            var f = _.Pop();
                            if (Tt(f.aabb, l)) {
                                var d = f.aabb.GetCenter(), p = f.aabb.GetExtents();
                                if (!(m(P.DotVV(o, P.SubVV(n, d, P.s_t0))) - P.DotVV(a, p) > 0)) if (f.IsLeaf()) {
                                    var g = t.s_subInput;
                                    g.p1.Copy(e.p1), g.p2.Copy(e.p2), g.maxFraction = c;
                                    var x = i(g, f);
                                    if (0 === x) return;
                                    x > 0 && (c = x, u = n.x + c * (r.x - n.x), h = n.y + c * (r.y - n.y), l.lowerBound.x = v(n.x, u), 
                                    l.lowerBound.y = v(n.y, h), l.upperBound.x = y(n.x, u), l.upperBound.y = y(n.y, h));
                                } else _.Push(Pt(f.child1)), _.Push(Pt(f.child2));
                            }
                        }
                    }
                }, t.prototype.AllocateNode = function() {
                    if (this.m_freeList) {
                        var e = this.m_freeList;
                        return this.m_freeList = e.parent, e.parent = null, e.child1 = null, e.child2 = null, 
                        e.height = 0, delete e.userData, e;
                    }
                    return new It(t.s_node_id++);
                }, t.prototype.FreeNode = function(t) {
                    t.parent = this.m_freeList, t.child1 = null, t.child2 = null, t.height = -1, delete t.userData, 
                    this.m_freeList = t;
                }, t.prototype.CreateProxy = function(t, e) {
                    var i = this.AllocateNode();
                    return i.aabb.lowerBound.x = t.lowerBound.x - .1, i.aabb.lowerBound.y = t.lowerBound.y - .1, 
                    i.aabb.upperBound.x = t.upperBound.x + .1, i.aabb.upperBound.y = t.upperBound.y + .1, 
                    i.userData = e, i.height = 0, this.InsertLeaf(i), i;
                }, t.prototype.DestroyProxy = function(t) {
                    this.RemoveLeaf(t), this.FreeNode(t);
                }, t.prototype.MoveProxy = function(t, e, i) {
                    if (t.aabb.Contains(e)) return !1;
                    this.RemoveLeaf(t);
                    var n = .1 + 2 * (i.x > 0 ? i.x : -i.x), r = .1 + 2 * (i.y > 0 ? i.y : -i.y);
                    return t.aabb.lowerBound.x = e.lowerBound.x - n, t.aabb.lowerBound.y = e.lowerBound.y - r, 
                    t.aabb.upperBound.x = e.upperBound.x + n, t.aabb.upperBound.y = e.upperBound.y + r, 
                    this.InsertLeaf(t), !0;
                }, t.prototype.InsertLeaf = function(e) {
                    if (++this.m_insertionCount, null === this.m_root) return this.m_root = e, void (this.m_root.parent = null);
                    for (var i = e.aabb, n = this.m_root; !n.IsLeaf(); ) {
                        var r = Pt(n.child1), s = Pt(n.child2), o = n.aabb.GetPerimeter(), a = t.s_combinedAABB;
                        a.Combine2(n.aabb, i);
                        var c = a.GetPerimeter(), l = 2 * c, u = 2 * (c - o), h = void 0, _ = t.s_aabb, f = void 0;
                        r.IsLeaf() ? (_.Combine2(i, r.aabb), h = _.GetPerimeter() + u) : (_.Combine2(i, r.aabb), 
                        f = r.aabb.GetPerimeter(), h = _.GetPerimeter() - f + u);
                        var d = void 0;
                        if (s.IsLeaf() ? (_.Combine2(i, s.aabb), d = _.GetPerimeter() + u) : (_.Combine2(i, s.aabb), 
                        f = s.aabb.GetPerimeter(), d = _.GetPerimeter() - f + u), l < h && l < d) break;
                        n = h < d ? r : s;
                    }
                    var p = n, m = p.parent, v = this.AllocateNode();
                    v.parent = m, delete v.userData, v.aabb.Combine2(i, p.aabb), v.height = p.height + 1, 
                    m ? (m.child1 === p ? m.child1 = v : m.child2 = v, v.child1 = p, v.child2 = e, p.parent = v, 
                    e.parent = v) : (v.child1 = p, v.child2 = e, p.parent = v, e.parent = v, this.m_root = v);
                    for (var g = e.parent; null !== g; ) r = Pt((g = this.Balance(g)).child1), s = Pt(g.child2), 
                    g.height = 1 + y(r.height, s.height), g.aabb.Combine2(r.aabb, s.aabb), g = g.parent;
                }, t.prototype.RemoveLeaf = function(t) {
                    if (t !== this.m_root) {
                        var e, i = Pt(t.parent), n = i && i.parent;
                        if (e = i.child1 === t ? Pt(i.child2) : Pt(i.child1), n) {
                            n.child1 === i ? n.child1 = e : n.child2 = e, e.parent = n, this.FreeNode(i);
                            for (var r = n; r; ) {
                                var s = Pt((r = this.Balance(r)).child1), o = Pt(r.child2);
                                r.aabb.Combine2(s.aabb, o.aabb), r.height = 1 + y(s.height, o.height), r = r.parent;
                            }
                        } else this.m_root = e, e.parent = null, this.FreeNode(i);
                    } else this.m_root = null;
                }, t.prototype.Balance = function(t) {
                    if (t.IsLeaf() || t.height < 2) return t;
                    var e = Pt(t.child1), i = Pt(t.child2), n = i.height - e.height;
                    if (n > 1) {
                        var r = Pt(i.child1), s = Pt(i.child2);
                        return i.child1 = t, i.parent = t.parent, t.parent = i, null !== i.parent ? i.parent.child1 === t ? i.parent.child1 = i : i.parent.child2 = i : this.m_root = i, 
                        r.height > s.height ? (i.child2 = r, t.child2 = s, s.parent = t, t.aabb.Combine2(e.aabb, s.aabb), 
                        i.aabb.Combine2(t.aabb, r.aabb), t.height = 1 + y(e.height, s.height), i.height = 1 + y(t.height, r.height)) : (i.child2 = s, 
                        t.child2 = r, r.parent = t, t.aabb.Combine2(e.aabb, r.aabb), i.aabb.Combine2(t.aabb, s.aabb), 
                        t.height = 1 + y(e.height, r.height), i.height = 1 + y(t.height, s.height)), i;
                    }
                    if (n < -1) {
                        var o = Pt(e.child1), a = Pt(e.child2);
                        return e.child1 = t, e.parent = t.parent, t.parent = e, null !== e.parent ? e.parent.child1 === t ? e.parent.child1 = e : e.parent.child2 = e : this.m_root = e, 
                        o.height > a.height ? (e.child2 = o, t.child1 = a, a.parent = t, t.aabb.Combine2(i.aabb, a.aabb), 
                        e.aabb.Combine2(t.aabb, o.aabb), t.height = 1 + y(i.height, a.height), e.height = 1 + y(t.height, o.height)) : (e.child2 = a, 
                        t.child1 = o, o.parent = t, t.aabb.Combine2(i.aabb, o.aabb), e.aabb.Combine2(t.aabb, a.aabb), 
                        t.height = 1 + y(i.height, o.height), e.height = 1 + y(t.height, a.height)), e;
                    }
                    return t;
                }, t.prototype.GetHeight = function() {
                    return null === this.m_root ? 0 : this.m_root.height;
                }, t.GetAreaNode = function(e) {
                    if (null === e) return 0;
                    if (e.IsLeaf()) return 0;
                    var i = e.aabb.GetPerimeter();
                    return (i += t.GetAreaNode(e.child1)) + t.GetAreaNode(e.child2);
                }, t.prototype.GetAreaRatio = function() {
                    if (null === this.m_root) return 0;
                    var e = this.m_root.aabb.GetPerimeter();
                    return t.GetAreaNode(this.m_root) / e;
                }, t.prototype.ComputeHeightNode = function(t) {
                    if (!t || t.IsLeaf()) return 0;
                    var e = this.ComputeHeightNode(t.child1), i = this.ComputeHeightNode(t.child2);
                    return 1 + y(e, i);
                }, t.prototype.ComputeHeight = function() {
                    return this.ComputeHeightNode(this.m_root);
                }, t.prototype.ValidateStructure = function(t) {
                    if (null !== t) {
                        this.m_root;
                        var e = t;
                        if (!e.IsLeaf()) {
                            var i = Pt(e.child1), n = Pt(e.child2);
                            this.ValidateStructure(i), this.ValidateStructure(n);
                        }
                    }
                }, t.prototype.ValidateMetrics = function(e) {
                    if (null !== e) {
                        var i = e;
                        if (!i.IsLeaf()) {
                            var n = Pt(i.child1), r = Pt(i.child2);
                            t.s_aabb.Combine2(n.aabb, r.aabb), this.ValidateMetrics(n), this.ValidateMetrics(r);
                        }
                    }
                }, t.prototype.Validate = function() {}, t.GetMaxBalanceNode = function(t, e) {
                    if (null === t) return e;
                    if (t.height <= 1) return e;
                    var i = Pt(t.child1), n = Pt(t.child2), r = m(n.height - i.height);
                    return y(e, r);
                }, t.prototype.GetMaxBalance = function() {
                    return t.GetMaxBalanceNode(this.m_root, 0);
                }, t.prototype.RebuildBottomUp = function() {
                    this.Validate();
                }, t.ShiftOriginNode = function(e, i) {
                    if (null !== e && !(e.height <= 1)) {
                        var n = e.child1, r = e.child2;
                        t.ShiftOriginNode(n, i), t.ShiftOriginNode(r, i), e.aabb.lowerBound.SelfSub(i), 
                        e.aabb.upperBound.SelfSub(i);
                    }
                }, t.prototype.ShiftOrigin = function(e) {
                    t.ShiftOriginNode(this.m_root, e);
                }, t.s_r = new P(), t.s_v = new P(), t.s_abs_v = new P(), t.s_segmentAABB = new St(), 
                t.s_subInput = new Ct(), t.s_combinedAABB = new St(), t.s_aabb = new St(), t.s_node_id = 0, 
                t;
            }(), Vt = function(t, e) {
                this.proxyA = t, this.proxyB = e;
            }, Lt = function() {
                function t() {
                    this.m_tree = new Dt(), this.m_proxyCount = 0, this.m_moveCount = 0, this.m_moveBuffer = [], 
                    this.m_pairCount = 0, this.m_pairBuffer = [];
                }
                return t.prototype.CreateProxy = function(t, e) {
                    var i = this.m_tree.CreateProxy(t, e);
                    return ++this.m_proxyCount, this.BufferMove(i), i;
                }, t.prototype.DestroyProxy = function(t) {
                    this.UnBufferMove(t), --this.m_proxyCount, this.m_tree.DestroyProxy(t);
                }, t.prototype.MoveProxy = function(t, e, i) {
                    this.m_tree.MoveProxy(t, e, i) && this.BufferMove(t);
                }, t.prototype.TouchProxy = function(t) {
                    this.BufferMove(t);
                }, t.prototype.GetProxyCount = function() {
                    return this.m_proxyCount;
                }, t.prototype.UpdatePairs = function(t) {
                    var e = this;
                    this.m_pairCount = 0;
                    for (var i = function(t) {
                        var i = n.m_moveBuffer[t];
                        if (null === i) return "continue";
                        var r = i.aabb;
                        n.m_tree.Query(r, function(t) {
                            if (t.m_id === i.m_id) return !0;
                            var n, r;
                            if (t.m_id < i.m_id ? (n = t, r = i) : (n = i, r = t), e.m_pairCount === e.m_pairBuffer.length) e.m_pairBuffer[e.m_pairCount] = new Vt(n, r); else {
                                var s = e.m_pairBuffer[e.m_pairCount];
                                s.proxyA = n, s.proxyB = r;
                            }
                            return ++e.m_pairCount, !0;
                        });
                    }, n = this, r = 0; r < this.m_moveCount; ++r) i(r);
                    this.m_moveCount = 0, this.m_pairBuffer.length = this.m_pairCount, this.m_pairBuffer.sort(Ot);
                    for (var s = 0; s < this.m_pairCount; ) {
                        var o = this.m_pairBuffer[s], a = o.proxyA.userData, c = o.proxyB.userData;
                        for (a && c && t(a, c), ++s; s < this.m_pairCount; ) {
                            var l = this.m_pairBuffer[s];
                            if (l.proxyA.m_id !== o.proxyA.m_id || l.proxyB.m_id !== o.proxyB.m_id) break;
                            ++s;
                        }
                    }
                }, t.prototype.Query = function(t, e) {
                    this.m_tree.Query(t, e);
                }, t.prototype.QueryPoint = function(t, e) {
                    this.m_tree.QueryPoint(t, e);
                }, t.prototype.RayCast = function(t, e) {
                    this.m_tree.RayCast(t, e);
                }, t.prototype.GetTreeHeight = function() {
                    return this.m_tree.GetHeight();
                }, t.prototype.GetTreeBalance = function() {
                    return this.m_tree.GetMaxBalance();
                }, t.prototype.GetTreeQuality = function() {
                    return this.m_tree.GetAreaRatio();
                }, t.prototype.ShiftOrigin = function(t) {
                    this.m_tree.ShiftOrigin(t);
                }, t.prototype.BufferMove = function(t) {
                    this.m_moveBuffer[this.m_moveCount] = t, ++this.m_moveCount;
                }, t.prototype.UnBufferMove = function(t) {
                    var e = this.m_moveBuffer.indexOf(t);
                    this.m_moveBuffer[e] = null;
                }, t;
            }();
            function Ot(t, e) {
                return t.proxyA.m_id === e.proxyA.m_id ? t.proxyB.m_id - e.proxyB.m_id : t.proxyA.m_id - e.proxyA.m_id;
            }
            t.b2_toiTime = 0, t.b2_toiMaxTime = 0, t.b2_toiCalls = 0, t.b2_toiIters = 0, t.b2_toiMaxIters = 0, 
            t.b2_toiRootIters = 0, t.b2_toiMaxRootIters = 0;
            var Ft, Nt = new F(), Gt = new F(), kt = new P(), zt = new P(), Ut = new P(), Ht = new P(), Wt = new P(), jt = function() {
                this.proxyA = new W(), this.proxyB = new W(), this.sweepA = new N(), this.sweepB = new N(), 
                this.tMax = 0;
            };
            (Ft = t.b2TOIOutputState || (t.b2TOIOutputState = {}))[Ft.e_unknown = 0] = "e_unknown", 
            Ft[Ft.e_failed = 1] = "e_failed", Ft[Ft.e_overlapped = 2] = "e_overlapped", Ft[Ft.e_touching = 3] = "e_touching", 
            Ft[Ft.e_separated = 4] = "e_separated";
            var qt, Xt = function() {
                this.state = t.b2TOIOutputState.e_unknown, this.t = 0;
            };
            (qt = t.b2SeparationFunctionType || (t.b2SeparationFunctionType = {}))[qt.e_unknown = -1] = "e_unknown", 
            qt[qt.e_points = 0] = "e_points", qt[qt.e_faceA = 1] = "e_faceA", qt[qt.e_faceB = 2] = "e_faceB";
            var Yt = function() {
                function e() {
                    this.m_sweepA = new N(), this.m_sweepB = new N(), this.m_type = t.b2SeparationFunctionType.e_unknown, 
                    this.m_localPoint = new P(), this.m_axis = new P();
                }
                return e.prototype.Initialize = function(e, i, n, r, s, o) {
                    this.m_proxyA = i, this.m_proxyB = r;
                    var a = e.count;
                    this.m_sweepA.Copy(n), this.m_sweepB.Copy(s);
                    var c = Nt, l = Gt;
                    if (this.m_sweepA.GetTransform(c, o), this.m_sweepB.GetTransform(l, o), 1 === a) {
                        this.m_type = t.b2SeparationFunctionType.e_points;
                        var u = this.m_proxyA.GetVertex(e.indexA[0]), h = this.m_proxyB.GetVertex(e.indexB[0]), _ = F.MulXV(c, u, kt), f = F.MulXV(l, h, zt);
                        P.SubVV(f, _, this.m_axis);
                        var d = this.m_axis.Normalize();
                        return this.m_localPoint.SetZero(), d;
                    }
                    if (e.indexA[0] === e.indexA[1]) {
                        this.m_type = t.b2SeparationFunctionType.e_faceB;
                        var p = this.m_proxyB.GetVertex(e.indexB[0]), m = this.m_proxyB.GetVertex(e.indexB[1]);
                        P.CrossVOne(P.SubVV(m, p, P.s_t0), this.m_axis).SelfNormalize();
                        var v = O.MulRV(l.q, this.m_axis, Ut);
                        return P.MidVV(p, m, this.m_localPoint), f = F.MulXV(l, this.m_localPoint, zt), 
                        u = this.m_proxyA.GetVertex(e.indexA[0]), _ = F.MulXV(c, u, kt), (d = P.DotVV(P.SubVV(_, f, P.s_t0), v)) < 0 && (this.m_axis.SelfNeg(), 
                        d = -d), d;
                    }
                    this.m_type = t.b2SeparationFunctionType.e_faceA;
                    var y = this.m_proxyA.GetVertex(e.indexA[0]), g = this.m_proxyA.GetVertex(e.indexA[1]);
                    return P.CrossVOne(P.SubVV(g, y, P.s_t0), this.m_axis).SelfNormalize(), v = O.MulRV(c.q, this.m_axis, Ut), 
                    P.MidVV(y, g, this.m_localPoint), _ = F.MulXV(c, this.m_localPoint, kt), h = this.m_proxyB.GetVertex(e.indexB[0]), 
                    f = F.MulXV(l, h, zt), (d = P.DotVV(P.SubVV(f, _, P.s_t0), v)) < 0 && (this.m_axis.SelfNeg(), 
                    d = -d), d;
                }, e.prototype.FindMinSeparation = function(e, i, n) {
                    var r = Nt, s = Gt;
                    switch (this.m_sweepA.GetTransform(r, n), this.m_sweepB.GetTransform(s, n), this.m_type) {
                      case t.b2SeparationFunctionType.e_points:
                        var o = O.MulTRV(r.q, this.m_axis, Ht), a = O.MulTRV(s.q, P.NegV(this.m_axis, P.s_t0), Wt);
                        e[0] = this.m_proxyA.GetSupport(o), i[0] = this.m_proxyB.GetSupport(a);
                        var c = this.m_proxyA.GetVertex(e[0]), l = this.m_proxyB.GetVertex(i[0]), u = F.MulXV(r, c, kt), h = F.MulXV(s, l, zt);
                        return P.DotVV(P.SubVV(h, u, P.s_t0), this.m_axis);

                      case t.b2SeparationFunctionType.e_faceA:
                        var _ = O.MulRV(r.q, this.m_axis, Ut);
                        return u = F.MulXV(r, this.m_localPoint, kt), a = O.MulTRV(s.q, P.NegV(_, P.s_t0), Wt), 
                        e[0] = -1, i[0] = this.m_proxyB.GetSupport(a), l = this.m_proxyB.GetVertex(i[0]), 
                        h = F.MulXV(s, l, zt), P.DotVV(P.SubVV(h, u, P.s_t0), _);

                      case t.b2SeparationFunctionType.e_faceB:
                        return _ = O.MulRV(s.q, this.m_axis, Ut), h = F.MulXV(s, this.m_localPoint, zt), 
                        o = O.MulTRV(r.q, P.NegV(_, P.s_t0), Ht), i[0] = -1, e[0] = this.m_proxyA.GetSupport(o), 
                        c = this.m_proxyA.GetVertex(e[0]), u = F.MulXV(r, c, kt), P.DotVV(P.SubVV(u, h, P.s_t0), _);

                      default:
                        return e[0] = -1, i[0] = -1, 0;
                    }
                }, e.prototype.Evaluate = function(e, i, n) {
                    var r = Nt, s = Gt;
                    switch (this.m_sweepA.GetTransform(r, n), this.m_sweepB.GetTransform(s, n), this.m_type) {
                      case t.b2SeparationFunctionType.e_points:
                        var o = this.m_proxyA.GetVertex(e), a = this.m_proxyB.GetVertex(i), c = F.MulXV(r, o, kt), l = F.MulXV(s, a, zt);
                        return P.DotVV(P.SubVV(l, c, P.s_t0), this.m_axis);

                      case t.b2SeparationFunctionType.e_faceA:
                        var u = O.MulRV(r.q, this.m_axis, Ut);
                        return c = F.MulXV(r, this.m_localPoint, kt), a = this.m_proxyB.GetVertex(i), l = F.MulXV(s, a, zt), 
                        P.DotVV(P.SubVV(l, c, P.s_t0), u);

                      case t.b2SeparationFunctionType.e_faceB:
                        return u = O.MulRV(s.q, this.m_axis, Ut), l = F.MulXV(s, this.m_localPoint, zt), 
                        o = this.m_proxyA.GetVertex(e), c = F.MulXV(r, o, kt), P.DotVV(P.SubVV(c, l, P.s_t0), u);

                      default:
                        return 0;
                    }
                }, e;
            }(), Jt = new z(), Zt = new j(), Kt = new q(), Qt = new X(), $t = new Yt(), te = [ 0 ], ee = [ 0 ], ie = new N(), ne = new N();
            function re(e, i) {
                var n = Jt.Reset();
                ++t.b2_toiCalls, e.state = t.b2TOIOutputState.e_unknown, e.t = i.tMax;
                var r = i.proxyA, s = i.proxyB, o = ie.Copy(i.sweepA), l = ne.Copy(i.sweepB);
                o.Normalize(), l.Normalize();
                var u = i.tMax, h = r.m_radius + s.m_radius, _ = y(c, h - 3 * c), f = .25 * c, d = 0, p = 0, v = Zt;
                v.count = 0;
                var g = Kt;
                for (g.proxyA.Copy(i.proxyA), g.proxyB.Copy(i.proxyB), g.useRadii = !1; ;) {
                    var x = Nt, A = Gt;
                    o.GetTransform(x, d), l.GetTransform(A, d), g.transformA.Copy(x), g.transformB.Copy(A);
                    var C = Qt;
                    if (rt(C, v, g), C.distance <= 0) {
                        e.state = t.b2TOIOutputState.e_overlapped, e.t = 0;
                        break;
                    }
                    if (C.distance < _ + f) {
                        e.state = t.b2TOIOutputState.e_touching, e.t = d;
                        break;
                    }
                    var b = $t;
                    b.Initialize(v, r, o, s, l, d);
                    for (var S = !1, T = u, w = 0; ;) {
                        var E = te, B = ee, M = b.FindMinSeparation(E, B, T);
                        if (M > _ + f) {
                            e.state = t.b2TOIOutputState.e_separated, e.t = u, S = !0;
                            break;
                        }
                        if (M > _ - f) {
                            d = T;
                            break;
                        }
                        var R = b.Evaluate(E[0], B[0], d);
                        if (R < _ - f) {
                            e.state = t.b2TOIOutputState.e_failed, e.t = d, S = !0;
                            break;
                        }
                        if (R <= _ + f) {
                            e.state = t.b2TOIOutputState.e_touching, e.t = d, S = !0;
                            break;
                        }
                        for (var P = 0, I = d, D = T; ;) {
                            var V;
                            V = 1 & P ? I + (_ - R) * (D - I) / (M - R) : .5 * (I + D), ++P, ++t.b2_toiRootIters;
                            var L = b.Evaluate(E[0], B[0], V);
                            if (m(L - _) < f) {
                                T = V;
                                break;
                            }
                            if (L > _ ? (I = V, R = L) : (D = V, M = L), 50 === P) break;
                        }
                        if (t.b2_toiMaxRootIters = y(t.b2_toiMaxRootIters, P), ++w === a) break;
                    }
                    if (++p, ++t.b2_toiIters, S) break;
                    if (20 === p) {
                        e.state = t.b2TOIOutputState.e_failed, e.t = d;
                        break;
                    }
                }
                t.b2_toiMaxIters = y(t.b2_toiMaxIters, p);
                var O = n.GetMilliseconds();
                t.b2_toiMaxTime = y(t.b2_toiMaxTime, O), t.b2_toiTime += O;
            }
            var se = new P(), oe = new P();
            function ae(e, i, n, r, s) {
                e.pointCount = 0;
                var o = F.MulXV(n, i.m_p, se), a = F.MulXV(s, r.m_p, oe), c = P.DistanceSquaredVV(o, a), l = i.m_radius + r.m_radius;
                c > l * l || (e.type = t.b2ManifoldType.e_circles, e.localPoint.Copy(i.m_p), e.localNormal.SetZero(), 
                e.pointCount = 1, e.points[0].localPoint.Copy(r.m_p), e.points[0].id.key = 0);
            }
            var ce = new P(), le = new P(), ue = new P();
            function he(e, r, s, o, a) {
                e.pointCount = 0;
                for (var c = F.MulXV(a, o.m_p, ce), l = F.MulTXV(s, c, le), u = 0, h = -i, _ = r.m_radius + o.m_radius, f = r.m_count, d = r.m_vertices, p = r.m_normals, m = 0; m < f; ++m) {
                    var v = P.DotVV(p[m], P.SubVV(l, d[m], P.s_t0));
                    if (v > _) return;
                    v > h && (h = v, u = m);
                }
                var y = u, g = (y + 1) % f, x = d[y], A = d[g];
                if (h < n) return e.pointCount = 1, e.type = t.b2ManifoldType.e_faceA, e.localNormal.Copy(p[u]), 
                P.MidVV(x, A, e.localPoint), e.points[0].localPoint.Copy(o.m_p), void (e.points[0].id.key = 0);
                var C = P.DotVV(P.SubVV(l, x, P.s_t0), P.SubVV(A, x, P.s_t1)), b = P.DotVV(P.SubVV(l, A, P.s_t0), P.SubVV(x, A, P.s_t1));
                if (C <= 0) {
                    if (P.DistanceSquaredVV(l, x) > _ * _) return;
                    e.pointCount = 1, e.type = t.b2ManifoldType.e_faceA, P.SubVV(l, x, e.localNormal).SelfNormalize(), 
                    e.localPoint.Copy(x), e.points[0].localPoint.Copy(o.m_p), e.points[0].id.key = 0;
                } else if (b <= 0) {
                    if (P.DistanceSquaredVV(l, A) > _ * _) return;
                    e.pointCount = 1, e.type = t.b2ManifoldType.e_faceA, P.SubVV(l, A, e.localNormal).SelfNormalize(), 
                    e.localPoint.Copy(A), e.points[0].localPoint.Copy(o.m_p), e.points[0].id.key = 0;
                } else {
                    var S = P.MidVV(x, A, ue);
                    if (P.DotVV(P.SubVV(l, S, P.s_t1), p[y]) > _) return;
                    e.pointCount = 1, e.type = t.b2ManifoldType.e_faceA, e.localNormal.Copy(p[y]).SelfNormalize(), 
                    e.localPoint.Copy(S), e.points[0].localPoint.Copy(o.m_p), e.points[0].id.key = 0;
                }
            }
            var _e = new P(), fe = new P(), de = new P(), pe = new P();
            function me(t, e, n, r, s) {
                for (var o = t.m_vertices, a = t.m_normals, c = r.m_count, l = r.m_vertices, u = O.MulRV(e.q, a[n], _e), h = O.MulTRV(s.q, u, fe), _ = 0, f = i, d = 0; d < c; ++d) {
                    var p = P.DotVV(l[d], h);
                    p < f && (f = p, _ = d);
                }
                var m = F.MulXV(e, o[n], de), v = F.MulXV(s, l[_], pe);
                return P.DotVV(P.SubVV(v, m, P.s_t0), u);
            }
            var ve = new P(), ye = new P();
            function ge(t, e, n, r, s) {
                for (var o = e.m_count, a = e.m_normals, c = P.SubVV(F.MulXV(s, r.m_centroid, P.s_t0), F.MulXV(n, e.m_centroid, P.s_t1), ve), l = O.MulTRV(n.q, c, ye), u = 0, h = -i, _ = 0; _ < o; ++_) {
                    var f = P.DotVV(a[_], l);
                    f > h && (h = f, u = _);
                }
                var d = me(e, n, u, r, s), p = (u + o - 1) % o, m = me(e, n, p, r, s), v = (u + 1) % o, y = me(e, n, v, r, s), g = 0, x = 0, A = 0;
                if (m > d && m > y) A = -1, g = p, x = m; else {
                    if (!(y > d)) return t[0] = u, d;
                    A = 1, g = v, x = y;
                }
                for (;(d = me(e, n, u = -1 === A ? (g + o - 1) % o : (g + 1) % o, r, s)) > x; ) g = u, 
                x = d;
                return t[0] = g, x;
            }
            var xe = new P();
            function Ae(e, n, r, s, o, a) {
                for (var c = n.m_normals, l = o.m_count, u = o.m_vertices, h = o.m_normals, _ = O.MulTRV(a.q, O.MulRV(r.q, c[s], P.s_t0), xe), f = 0, d = i, p = 0; p < l; ++p) {
                    var m = P.DotVV(_, h[p]);
                    m < d && (d = m, f = p);
                }
                var v = f, y = (v + 1) % l, g = e[0];
                F.MulXV(a, u[v], g.v);
                var x = g.id.cf;
                x.indexA = s, x.indexB = v, x.typeA = t.b2ContactFeatureType.e_face, x.typeB = t.b2ContactFeatureType.e_vertex;
                var A = e[1];
                F.MulXV(a, u[y], A.v);
                var C = A.id.cf;
                C.indexA = s, C.indexB = y, C.typeA = t.b2ContactFeatureType.e_face, C.typeB = t.b2ContactFeatureType.e_vertex;
            }
            var Ce = At.MakeArray(2), be = At.MakeArray(2), Se = At.MakeArray(2), Te = [ 0 ], we = [ 0 ], Ee = new P(), Be = new P(), Me = new P(), Re = new P(), Pe = new P(), Ie = new P(), De = new P(), Ve = new P();
            function Le(e, i, n, r, s) {
                e.pointCount = 0;
                var a = i.m_radius + r.m_radius, c = Te;
                c[0] = 0;
                var l = ge(c, i, n, r, s);
                if (!(l > a)) {
                    var u = we;
                    u[0] = 0;
                    var h = ge(u, r, s, i, n);
                    if (!(h > a)) {
                        var _, f, d, p, m = 0, v = 0;
                        h > .98 * l + .001 ? (_ = r, f = i, d = s, p = n, m = u[0], e.type = t.b2ManifoldType.e_faceB, 
                        v = 1) : (_ = i, f = r, d = n, p = s, m = c[0], e.type = t.b2ManifoldType.e_faceA, 
                        v = 0);
                        var y = Ce;
                        Ae(y, _, d, m, f, p);
                        var g = _.m_count, x = _.m_vertices, A = m, C = (m + 1) % g, b = x[A], S = x[C], T = P.SubVV(S, b, Ee);
                        T.Normalize();
                        var w = P.CrossVOne(T, Be), E = P.MidVV(b, S, Me), B = O.MulRV(d.q, T, Pe), M = P.CrossVOne(B, Re), R = F.MulXV(d, b, De), I = F.MulXV(d, S, Ve), D = P.DotVV(M, R), V = -P.DotVV(B, R) + a, L = P.DotVV(B, I) + a, N = be, G = Se;
                        if (!(wt(N, y, P.NegV(B, Ie), V, A) < 2 || wt(G, N, B, L, C) < 2)) {
                            e.localNormal.Copy(w), e.localPoint.Copy(E);
                            for (var k = 0, z = 0; z < o; ++z) {
                                var U = G[z];
                                if (P.DotVV(M, U.v) - D <= a) {
                                    var H = e.points[k];
                                    if (F.MulTXV(p, U.v, H.localPoint), H.id.Copy(U.id), v) {
                                        var W = H.id.cf;
                                        H.id.cf.indexA = W.indexB, H.id.cf.indexB = W.indexA, H.id.cf.typeA = W.typeB, H.id.cf.typeB = W.typeA;
                                    }
                                    ++k;
                                }
                            }
                            e.pointCount = k;
                        }
                    }
                }
            }
            var Oe = new P(), Fe = new P(), Ne = new P(), Ge = new P(), ke = new P(), ze = new P(), Ue = new P(), He = new mt();
            function We(e, i, n, r, s) {
                e.pointCount = 0;
                var o = F.MulTXV(n, F.MulXV(s, r.m_p, P.s_t0), Oe), a = i.m_vertex1, c = i.m_vertex2, l = P.SubVV(c, a, Fe), u = P.DotVV(l, P.SubVV(c, o, P.s_t0)), h = P.DotVV(l, P.SubVV(o, a, P.s_t0)), _ = i.m_radius + r.m_radius, f = He;
                if (f.cf.indexB = 0, f.cf.typeB = t.b2ContactFeatureType.e_vertex, h <= 0) {
                    var d = a, p = P.SubVV(o, d, Ne);
                    if (P.DotVV(p, p) > _ * _) return;
                    if (i.m_hasVertex0) {
                        var m = i.m_vertex0, v = a, y = P.SubVV(v, m, Ge);
                        if (P.DotVV(y, P.SubVV(v, o, P.s_t0)) > 0) return;
                    }
                    return f.cf.indexA = 0, f.cf.typeA = t.b2ContactFeatureType.e_vertex, e.pointCount = 1, 
                    e.type = t.b2ManifoldType.e_circles, e.localNormal.SetZero(), e.localPoint.Copy(d), 
                    e.points[0].id.Copy(f), void e.points[0].localPoint.Copy(r.m_p);
                }
                if (u <= 0) {
                    var g = c, x = P.SubVV(o, g, Ne);
                    if (P.DotVV(x, x) > _ * _) return;
                    if (i.m_hasVertex3) {
                        var A = i.m_vertex3, C = c, b = P.SubVV(A, C, ke);
                        if (P.DotVV(b, P.SubVV(o, C, P.s_t0)) > 0) return;
                    }
                    return f.cf.indexA = 1, f.cf.typeA = t.b2ContactFeatureType.e_vertex, e.pointCount = 1, 
                    e.type = t.b2ManifoldType.e_circles, e.localNormal.SetZero(), e.localPoint.Copy(g), 
                    e.points[0].id.Copy(f), void e.points[0].localPoint.Copy(r.m_p);
                }
                var S = P.DotVV(l, l), T = ze;
                T.x = 1 / S * (u * a.x + h * c.x), T.y = 1 / S * (u * a.y + h * c.y);
                var w = P.SubVV(o, T, Ne);
                if (!(P.DotVV(w, w) > _ * _)) {
                    var E = Ue.Set(-l.y, l.x);
                    P.DotVV(E, P.SubVV(o, a, P.s_t0)) < 0 && E.Set(-E.x, -E.y), E.Normalize(), f.cf.indexA = 0, 
                    f.cf.typeA = t.b2ContactFeatureType.e_face, e.pointCount = 1, e.type = t.b2ManifoldType.e_faceA, 
                    e.localNormal.Copy(E), e.localPoint.Copy(a), e.points[0].id.Copy(f), e.points[0].localPoint.Copy(r.m_p);
                }
            }
            var je = function() {
                this.type = 0, this.index = 0, this.separation = 0;
            }, qe = function() {
                this.vertices = P.MakeArray(a), this.normals = P.MakeArray(a), this.count = 0;
            }, Xe = function() {
                this.i1 = 0, this.i2 = 0, this.v1 = new P(), this.v2 = new P(), this.normal = new P(), 
                this.sideNormal1 = new P(), this.sideOffset1 = 0, this.sideNormal2 = new P(), this.sideOffset2 = 0;
            }, Ye = new (function() {
                function e() {
                    this.m_polygonB = new qe(), this.m_xf = new F(), this.m_centroidB = new P(), this.m_v0 = new P(), 
                    this.m_v1 = new P(), this.m_v2 = new P(), this.m_v3 = new P(), this.m_normal0 = new P(), 
                    this.m_normal1 = new P(), this.m_normal2 = new P(), this.m_normal = new P(), this.m_type1 = 0, 
                    this.m_type2 = 0, this.m_lowerLimit = new P(), this.m_upperLimit = new P(), this.m_radius = 0, 
                    this.m_front = !1;
                }
                return e.prototype.Collide = function(i, n, r, s, a) {
                    F.MulTXX(r, a, this.m_xf), F.MulXV(this.m_xf, s.m_centroid, this.m_centroidB), this.m_v0.Copy(n.m_vertex0), 
                    this.m_v1.Copy(n.m_vertex1), this.m_v2.Copy(n.m_vertex2), this.m_v3.Copy(n.m_vertex3);
                    var c = n.m_hasVertex0, l = n.m_hasVertex3, u = P.SubVV(this.m_v2, this.m_v1, e.s_edge1);
                    u.Normalize(), this.m_normal1.Set(u.y, -u.x);
                    var h = P.DotVV(this.m_normal1, P.SubVV(this.m_centroidB, this.m_v1, P.s_t0)), _ = 0, f = 0, d = !1, p = !1;
                    if (c) {
                        var m = P.SubVV(this.m_v1, this.m_v0, e.s_edge0);
                        m.Normalize(), this.m_normal0.Set(m.y, -m.x), d = P.CrossVV(m, u) >= 0, _ = P.DotVV(this.m_normal0, P.SubVV(this.m_centroidB, this.m_v0, P.s_t0));
                    }
                    if (l) {
                        var v = P.SubVV(this.m_v3, this.m_v2, e.s_edge2);
                        v.Normalize(), this.m_normal2.Set(v.y, -v.x), p = P.CrossVV(u, v) > 0, f = P.DotVV(this.m_normal2, P.SubVV(this.m_centroidB, this.m_v2, P.s_t0));
                    }
                    c && l ? d && p ? (this.m_front = _ >= 0 || h >= 0 || f >= 0, this.m_front ? (this.m_normal.Copy(this.m_normal1), 
                    this.m_lowerLimit.Copy(this.m_normal0), this.m_upperLimit.Copy(this.m_normal2)) : (this.m_normal.Copy(this.m_normal1).SelfNeg(), 
                    this.m_lowerLimit.Copy(this.m_normal1).SelfNeg(), this.m_upperLimit.Copy(this.m_normal1).SelfNeg())) : d ? (this.m_front = _ >= 0 || h >= 0 && f >= 0, 
                    this.m_front ? (this.m_normal.Copy(this.m_normal1), this.m_lowerLimit.Copy(this.m_normal0), 
                    this.m_upperLimit.Copy(this.m_normal1)) : (this.m_normal.Copy(this.m_normal1).SelfNeg(), 
                    this.m_lowerLimit.Copy(this.m_normal2).SelfNeg(), this.m_upperLimit.Copy(this.m_normal1).SelfNeg())) : p ? (this.m_front = f >= 0 || _ >= 0 && h >= 0, 
                    this.m_front ? (this.m_normal.Copy(this.m_normal1), this.m_lowerLimit.Copy(this.m_normal1), 
                    this.m_upperLimit.Copy(this.m_normal2)) : (this.m_normal.Copy(this.m_normal1).SelfNeg(), 
                    this.m_lowerLimit.Copy(this.m_normal1).SelfNeg(), this.m_upperLimit.Copy(this.m_normal0).SelfNeg())) : (this.m_front = _ >= 0 && h >= 0 && f >= 0, 
                    this.m_front ? (this.m_normal.Copy(this.m_normal1), this.m_lowerLimit.Copy(this.m_normal1), 
                    this.m_upperLimit.Copy(this.m_normal1)) : (this.m_normal.Copy(this.m_normal1).SelfNeg(), 
                    this.m_lowerLimit.Copy(this.m_normal2).SelfNeg(), this.m_upperLimit.Copy(this.m_normal0).SelfNeg())) : c ? d ? (this.m_front = _ >= 0 || h >= 0, 
                    this.m_front ? (this.m_normal.Copy(this.m_normal1), this.m_lowerLimit.Copy(this.m_normal0), 
                    this.m_upperLimit.Copy(this.m_normal1).SelfNeg()) : (this.m_normal.Copy(this.m_normal1).SelfNeg(), 
                    this.m_lowerLimit.Copy(this.m_normal1), this.m_upperLimit.Copy(this.m_normal1).SelfNeg())) : (this.m_front = _ >= 0 && h >= 0, 
                    this.m_front ? (this.m_normal.Copy(this.m_normal1), this.m_lowerLimit.Copy(this.m_normal1), 
                    this.m_upperLimit.Copy(this.m_normal1).SelfNeg()) : (this.m_normal.Copy(this.m_normal1).SelfNeg(), 
                    this.m_lowerLimit.Copy(this.m_normal1), this.m_upperLimit.Copy(this.m_normal0).SelfNeg())) : l ? p ? (this.m_front = h >= 0 || f >= 0, 
                    this.m_front ? (this.m_normal.Copy(this.m_normal1), this.m_lowerLimit.Copy(this.m_normal1).SelfNeg(), 
                    this.m_upperLimit.Copy(this.m_normal2)) : (this.m_normal.Copy(this.m_normal1).SelfNeg(), 
                    this.m_lowerLimit.Copy(this.m_normal1).SelfNeg(), this.m_upperLimit.Copy(this.m_normal1))) : (this.m_front = h >= 0 && f >= 0, 
                    this.m_front ? (this.m_normal.Copy(this.m_normal1), this.m_lowerLimit.Copy(this.m_normal1).SelfNeg(), 
                    this.m_upperLimit.Copy(this.m_normal1)) : (this.m_normal.Copy(this.m_normal1).SelfNeg(), 
                    this.m_lowerLimit.Copy(this.m_normal2).SelfNeg(), this.m_upperLimit.Copy(this.m_normal1))) : (this.m_front = h >= 0, 
                    this.m_front ? (this.m_normal.Copy(this.m_normal1), this.m_lowerLimit.Copy(this.m_normal1).SelfNeg(), 
                    this.m_upperLimit.Copy(this.m_normal1).SelfNeg()) : (this.m_normal.Copy(this.m_normal1).SelfNeg(), 
                    this.m_lowerLimit.Copy(this.m_normal1), this.m_upperLimit.Copy(this.m_normal1))), 
                    this.m_polygonB.count = s.m_count;
                    for (var y = 0; y < s.m_count; ++y) F.MulXV(this.m_xf, s.m_vertices[y], this.m_polygonB.vertices[y]), 
                    O.MulRV(this.m_xf.q, s.m_normals[y], this.m_polygonB.normals[y]);
                    this.m_radius = s.m_radius + n.m_radius, i.pointCount = 0;
                    var g = this.ComputeEdgeSeparation(e.s_edgeAxis);
                    if (0 !== g.type && !(g.separation > this.m_radius)) {
                        var x = this.ComputePolygonSeparation(e.s_polygonAxis);
                        if (!(0 !== x.type && x.separation > this.m_radius)) {
                            var A;
                            A = 0 === x.type ? g : x.separation > .98 * g.separation + .001 ? x : g;
                            var C = e.s_ie, b = e.s_rf;
                            if (1 === A.type) {
                                i.type = t.b2ManifoldType.e_faceA;
                                var S = 0, T = P.DotVV(this.m_normal, this.m_polygonB.normals[0]);
                                for (y = 1; y < this.m_polygonB.count; ++y) {
                                    var w = P.DotVV(this.m_normal, this.m_polygonB.normals[y]);
                                    w < T && (T = w, S = y);
                                }
                                var E = S, B = (E + 1) % this.m_polygonB.count;
                                (M = C[0]).v.Copy(this.m_polygonB.vertices[E]), M.id.cf.indexA = 0, M.id.cf.indexB = E, 
                                M.id.cf.typeA = t.b2ContactFeatureType.e_face, M.id.cf.typeB = t.b2ContactFeatureType.e_vertex, 
                                (R = C[1]).v.Copy(this.m_polygonB.vertices[B]), R.id.cf.indexA = 0, R.id.cf.indexB = B, 
                                R.id.cf.typeA = t.b2ContactFeatureType.e_face, R.id.cf.typeB = t.b2ContactFeatureType.e_vertex, 
                                this.m_front ? (b.i1 = 0, b.i2 = 1, b.v1.Copy(this.m_v1), b.v2.Copy(this.m_v2), 
                                b.normal.Copy(this.m_normal1)) : (b.i1 = 1, b.i2 = 0, b.v1.Copy(this.m_v2), b.v2.Copy(this.m_v1), 
                                b.normal.Copy(this.m_normal1).SelfNeg());
                            } else {
                                var M, R;
                                i.type = t.b2ManifoldType.e_faceB, (M = C[0]).v.Copy(this.m_v1), M.id.cf.indexA = 0, 
                                M.id.cf.indexB = A.index, M.id.cf.typeA = t.b2ContactFeatureType.e_vertex, M.id.cf.typeB = t.b2ContactFeatureType.e_face, 
                                (R = C[1]).v.Copy(this.m_v2), R.id.cf.indexA = 0, R.id.cf.indexB = A.index, R.id.cf.typeA = t.b2ContactFeatureType.e_vertex, 
                                R.id.cf.typeB = t.b2ContactFeatureType.e_face, b.i1 = A.index, b.i2 = (b.i1 + 1) % this.m_polygonB.count, 
                                b.v1.Copy(this.m_polygonB.vertices[b.i1]), b.v2.Copy(this.m_polygonB.vertices[b.i2]), 
                                b.normal.Copy(this.m_polygonB.normals[b.i1]);
                            }
                            b.sideNormal1.Set(b.normal.y, -b.normal.x), b.sideNormal2.Copy(b.sideNormal1).SelfNeg(), 
                            b.sideOffset1 = P.DotVV(b.sideNormal1, b.v1), b.sideOffset2 = P.DotVV(b.sideNormal2, b.v2);
                            var I = e.s_clipPoints1, D = e.s_clipPoints2;
                            if (!(wt(I, C, b.sideNormal1, b.sideOffset1, b.i1) < o || wt(D, I, b.sideNormal2, b.sideOffset2, b.i2) < o)) {
                                1 === A.type ? (i.localNormal.Copy(b.normal), i.localPoint.Copy(b.v1)) : (i.localNormal.Copy(s.m_normals[b.i1]), 
                                i.localPoint.Copy(s.m_vertices[b.i1]));
                                var V = 0;
                                for (y = 0; y < o; ++y) if (P.DotVV(b.normal, P.SubVV(D[y].v, b.v1, P.s_t0)) <= this.m_radius) {
                                    var L = i.points[V];
                                    1 === A.type ? (F.MulTXV(this.m_xf, D[y].v, L.localPoint), L.id = D[y].id) : (L.localPoint.Copy(D[y].v), 
                                    L.id.cf.typeA = D[y].id.cf.typeB, L.id.cf.typeB = D[y].id.cf.typeA, L.id.cf.indexA = D[y].id.cf.indexB, 
                                    L.id.cf.indexB = D[y].id.cf.indexA), ++V;
                                }
                                i.pointCount = V;
                            }
                        }
                    }
                }, e.prototype.ComputeEdgeSeparation = function(t) {
                    var e = t;
                    e.type = 1, e.index = this.m_front ? 0 : 1, e.separation = i;
                    for (var n = 0; n < this.m_polygonB.count; ++n) {
                        var r = P.DotVV(this.m_normal, P.SubVV(this.m_polygonB.vertices[n], this.m_v1, P.s_t0));
                        r < e.separation && (e.separation = r);
                    }
                    return e;
                }, e.prototype.ComputePolygonSeparation = function(t) {
                    var n = t;
                    n.type = 0, n.index = -1, n.separation = -i;
                    for (var r = e.s_perp.Set(-this.m_normal.y, this.m_normal.x), s = 0; s < this.m_polygonB.count; ++s) {
                        var o = P.NegV(this.m_polygonB.normals[s], e.s_n), a = P.DotVV(o, P.SubVV(this.m_polygonB.vertices[s], this.m_v1, P.s_t0)), c = P.DotVV(o, P.SubVV(this.m_polygonB.vertices[s], this.m_v2, P.s_t0)), u = v(a, c);
                        if (u > this.m_radius) return n.type = 2, n.index = s, n.separation = u, n;
                        if (P.DotVV(o, r) >= 0) {
                            if (P.DotVV(P.SubVV(o, this.m_upperLimit, P.s_t0), this.m_normal) < -l) continue;
                        } else if (P.DotVV(P.SubVV(o, this.m_lowerLimit, P.s_t0), this.m_normal) < -l) continue;
                        u > n.separation && (n.type = 2, n.index = s, n.separation = u);
                    }
                    return n;
                }, e.s_edge1 = new P(), e.s_edge0 = new P(), e.s_edge2 = new P(), e.s_ie = At.MakeArray(2), 
                e.s_rf = new Xe(), e.s_clipPoints1 = At.MakeArray(2), e.s_clipPoints2 = At.MakeArray(2), 
                e.s_edgeAxis = new je(), e.s_polygonAxis = new je(), e.s_n = new P(), e.s_perp = new P(), 
                e;
            }())();
            function Je(t, e, i, n, r) {
                Ye.Collide(t, e, i, n, r);
            }
            var Ze, Ke = function() {
                this.mass = 0, this.center = new P(0, 0), this.I = 0;
            };
            (Ze = t.b2ShapeType || (t.b2ShapeType = {}))[Ze.e_unknown = -1] = "e_unknown", Ze[Ze.e_circleShape = 0] = "e_circleShape", 
            Ze[Ze.e_edgeShape = 1] = "e_edgeShape", Ze[Ze.e_polygonShape = 2] = "e_polygonShape", 
            Ze[Ze.e_chainShape = 3] = "e_chainShape", Ze[Ze.e_shapeTypeCount = 4] = "e_shapeTypeCount";
            var Qe = function() {
                function e(e, i) {
                    this.m_type = t.b2ShapeType.e_unknown, this.m_radius = 0, this.m_type = e, this.m_radius = i;
                }
                return e.prototype.Copy = function(t) {
                    return this.m_radius = t.m_radius, this;
                }, e.prototype.GetType = function() {
                    return this.m_type;
                }, e;
            }(), $e = Object.setPrototypeOf || {
                __proto__: []
            } instanceof Array && function(t, e) {
                t.__proto__ = e;
            } || function(t, e) {
                for (var i in e) e.hasOwnProperty(i) && (t[i] = e[i]);
            };
            function ti(t, e) {
                function i() {
                    this.constructor = t;
                }
                $e(t, e), t.prototype = null === e ? Object.create(e) : (i.prototype = e.prototype, 
                new i());
            }
            var ei, ii = function(e) {
                function i(i) {
                    void 0 === i && (i = 0);
                    var n = e.call(this, t.b2ShapeType.e_circleShape, i) || this;
                    return n.m_p = new P(), n;
                }
                return ti(i, e), i.prototype.Set = function(t, e) {
                    return void 0 === e && (e = this.m_radius), this.m_p.Copy(t), this.m_radius = e, 
                    this;
                }, i.prototype.Clone = function() {
                    return new i().Copy(this);
                }, i.prototype.Copy = function(t) {
                    return e.prototype.Copy.call(this, t), this.m_p.Copy(t.m_p), this;
                }, i.prototype.GetChildCount = function() {
                    return 1;
                }, i.prototype.TestPoint = function(t, e) {
                    var n = F.MulXV(t, this.m_p, i.TestPoint_s_center), r = P.SubVV(e, n, i.TestPoint_s_d);
                    return P.DotVV(r, r) <= A(this.m_radius);
                }, i.prototype.ComputeDistance = function(t, e, n) {
                    var r = F.MulXV(t, this.m_p, i.ComputeDistance_s_center);
                    return P.SubVV(e, r, n), n.Normalize() - this.m_radius;
                }, i.prototype.RayCast = function(t, e, r) {
                    var s = F.MulXV(r, this.m_p, i.RayCast_s_position), o = P.SubVV(e.p1, s, i.RayCast_s_s), a = P.DotVV(o, o) - A(this.m_radius), c = P.SubVV(e.p2, e.p1, i.RayCast_s_r), l = P.DotVV(o, c), u = P.DotVV(c, c), h = l * l - u * a;
                    if (h < 0 || u < n) return !1;
                    var _ = -(l + S(h));
                    return 0 <= _ && _ <= e.maxFraction * u && (_ /= u, t.fraction = _, P.AddVMulSV(o, _, c, t.normal).SelfNormalize(), 
                    !0);
                }, i.prototype.ComputeAABB = function(t, e) {
                    var n = F.MulXV(e, this.m_p, i.ComputeAABB_s_p);
                    t.lowerBound.Set(n.x - this.m_radius, n.y - this.m_radius), t.upperBound.Set(n.x + this.m_radius, n.y + this.m_radius);
                }, i.prototype.ComputeMass = function(t, e) {
                    var i = A(this.m_radius);
                    t.mass = e * s * i, t.center.Copy(this.m_p), t.I = t.mass * (.5 * i + P.DotVV(this.m_p, this.m_p));
                }, i.prototype.SetupDistanceProxy = function(t) {
                    t.m_vertices = t.m_buffer, t.m_vertices[0].Copy(this.m_p), t.m_count = 1, t.m_radius = this.m_radius;
                }, i.prototype.ComputeSubmergedArea = function(t, e, i, r) {
                    var o = F.MulXV(i, this.m_p, new P()), a = -(P.DotVV(t, o) - e);
                    if (a < -this.m_radius + n) return 0;
                    if (a > this.m_radius) return r.Copy(o), s * this.m_radius * this.m_radius;
                    var c = this.m_radius * this.m_radius, l = a * a, u = c * (M(a / this.m_radius) + s / 2) + a * S(c - l), h = -2 / 3 * T(c - l, 1.5) / u;
                    return r.x = o.x + t.x * h, r.y = o.y + t.y * h, u;
                }, i.prototype.Dump = function(t) {
                    t("    const shape: b2CircleShape = new b2CircleShape();\n"), t("    shape.m_radius = %.15f;\n", this.m_radius), 
                    t("    shape.m_p.Set(%.15f, %.15f);\n", this.m_p.x, this.m_p.y);
                }, i.TestPoint_s_center = new P(), i.TestPoint_s_d = new P(), i.ComputeDistance_s_center = new P(), 
                i.RayCast_s_position = new P(), i.RayCast_s_s = new P(), i.RayCast_s_r = new P(), 
                i.ComputeAABB_s_p = new P(), i;
            }(Qe), ni = function(e) {
                function r() {
                    var i = e.call(this, t.b2ShapeType.e_polygonShape, u) || this;
                    return i.m_centroid = new P(0, 0), i.m_vertices = [], i.m_normals = [], i.m_count = 0, 
                    i;
                }
                return ti(r, e), r.prototype.Clone = function() {
                    return new r().Copy(this);
                }, r.prototype.Copy = function(t) {
                    e.prototype.Copy.call(this, t), this.m_centroid.Copy(t.m_centroid), this.m_count = t.m_count, 
                    this.m_vertices = P.MakeArray(this.m_count), this.m_normals = P.MakeArray(this.m_count);
                    for (var i = 0; i < this.m_count; ++i) this.m_vertices[i].Copy(t.m_vertices[i]), 
                    this.m_normals[i].Copy(t.m_normals[i]);
                    return this;
                }, r.prototype.GetChildCount = function() {
                    return 1;
                }, r.prototype.Set = function(t, e, i) {
                    if (void 0 === e && (e = t.length), void 0 === i && (i = 0), e < 3) return this.SetAsBox(1, 1);
                    for (var n = v(e, a), s = r.Set_s_ps, o = 0, l = 0; l < n; ++l) {
                        for (var u = t[i + l], h = !0, _ = 0; _ < o; ++_) if (P.DistanceSquaredVV(u, s[_]) < .25 * c * c) {
                            h = !1;
                            break;
                        }
                        h && s[o++].Copy(u);
                    }
                    if ((n = o) < 3) return this.SetAsBox(1, 1);
                    var f = 0, d = s[0].x;
                    for (l = 1; l < n; ++l) {
                        var p = s[l].x;
                        (p > d || p === d && s[l].y < s[f].y) && (f = l, d = p);
                    }
                    for (var m = r.Set_s_hull, y = 0, g = f; ;) {
                        m[y] = g;
                        var x = 0;
                        for (_ = 1; _ < n; ++_) if (x !== g) {
                            var A = P.SubVV(s[x], s[m[y]], r.Set_s_r), C = (u = P.SubVV(s[_], s[m[y]], r.Set_s_v), 
                            P.CrossVV(A, u));
                            C < 0 && (x = _), 0 === C && u.LengthSquared() > A.LengthSquared() && (x = _);
                        } else x = _;
                        if (++y, g = x, x === f) break;
                    }
                    for (this.m_count = y, this.m_vertices = P.MakeArray(this.m_count), this.m_normals = P.MakeArray(this.m_count), 
                    l = 0; l < y; ++l) this.m_vertices[l].Copy(s[m[l]]);
                    for (l = 0; l < y; ++l) {
                        var b = this.m_vertices[l], S = this.m_vertices[(l + 1) % y], T = P.SubVV(S, b, P.s_t0);
                        P.CrossVOne(T, this.m_normals[l]).SelfNormalize();
                    }
                    return r.ComputeCentroid(this.m_vertices, y, this.m_centroid), this;
                }, r.prototype.SetAsArray = function(t, e) {
                    return void 0 === e && (e = t.length), this.Set(t, e);
                }, r.prototype.SetAsBox = function(t, e, i, n) {
                    if (void 0 === n && (n = 0), this.m_count = 4, this.m_vertices = P.MakeArray(this.m_count), 
                    this.m_normals = P.MakeArray(this.m_count), this.m_vertices[0].Set(-t, -e), this.m_vertices[1].Set(t, -e), 
                    this.m_vertices[2].Set(t, e), this.m_vertices[3].Set(-t, e), this.m_normals[0].Set(0, -1), 
                    this.m_normals[1].Set(1, 0), this.m_normals[2].Set(0, 1), this.m_normals[3].Set(-1, 0), 
                    this.m_centroid.SetZero(), i) {
                        this.m_centroid.Copy(i);
                        var r = new F();
                        r.SetPosition(i), r.SetRotationAngle(n);
                        for (var s = 0; s < this.m_count; ++s) F.MulXV(r, this.m_vertices[s], this.m_vertices[s]), 
                        O.MulRV(r.q, this.m_normals[s], this.m_normals[s]);
                    }
                    return this;
                }, r.prototype.TestPoint = function(t, e) {
                    for (var i = F.MulTXV(t, e, r.TestPoint_s_pLocal), n = 0; n < this.m_count; ++n) if (P.DotVV(this.m_normals[n], P.SubVV(i, this.m_vertices[n], P.s_t0)) > 0) return !1;
                    return !0;
                }, r.prototype.ComputeDistance = function(t, e, n) {
                    for (var s = F.MulTXV(t, e, r.ComputeDistance_s_pLocal), o = -i, a = r.ComputeDistance_s_normalForMaxDistance.Copy(s), c = 0; c < this.m_count; ++c) {
                        var l = P.DotVV(this.m_normals[c], P.SubVV(s, this.m_vertices[c], P.s_t0));
                        l > o && (o = l, a.Copy(this.m_normals[c]));
                    }
                    if (o > 0) {
                        var u = r.ComputeDistance_s_minDistance.Copy(a), h = o * o;
                        for (c = 0; c < this.m_count; ++c) {
                            var _ = P.SubVV(s, this.m_vertices[c], r.ComputeDistance_s_distance), f = _.LengthSquared();
                            h > f && (u.Copy(_), h = f);
                        }
                        return O.MulRV(t.q, u, n), n.Normalize(), Math.sqrt(h);
                    }
                    return O.MulRV(t.q, a, n), o;
                }, r.prototype.RayCast = function(t, e, i) {
                    for (var n = F.MulTXV(i, e.p1, r.RayCast_s_p1), s = F.MulTXV(i, e.p2, r.RayCast_s_p2), o = P.SubVV(s, n, r.RayCast_s_d), a = 0, c = e.maxFraction, l = -1, u = 0; u < this.m_count; ++u) {
                        var h = P.DotVV(this.m_normals[u], P.SubVV(this.m_vertices[u], n, P.s_t0)), _ = P.DotVV(this.m_normals[u], o);
                        if (0 === _) {
                            if (h < 0) return !1;
                        } else _ < 0 && h < a * _ ? (a = h / _, l = u) : _ > 0 && h < c * _ && (c = h / _);
                        if (c < a) return !1;
                    }
                    return l >= 0 && (t.fraction = a, O.MulRV(i.q, this.m_normals[l], t.normal), !0);
                }, r.prototype.ComputeAABB = function(t, e) {
                    for (var i = F.MulXV(e, this.m_vertices[0], t.lowerBound), n = t.upperBound.Copy(i), s = 0; s < this.m_count; ++s) {
                        var o = F.MulXV(e, this.m_vertices[s], r.ComputeAABB_s_v);
                        P.MinV(o, i, i), P.MaxV(o, n, n);
                    }
                    var a = this.m_radius;
                    i.SelfSubXY(a, a), n.SelfAddXY(a, a);
                }, r.prototype.ComputeMass = function(t, e) {
                    for (var i = r.ComputeMass_s_center.SetZero(), n = 0, s = 0, o = r.ComputeMass_s_s.SetZero(), a = 0; a < this.m_count; ++a) o.SelfAdd(this.m_vertices[a]);
                    for (o.SelfMul(1 / this.m_count), a = 0; a < this.m_count; ++a) {
                        var c = P.SubVV(this.m_vertices[a], o, r.ComputeMass_s_e1), l = P.SubVV(this.m_vertices[(a + 1) % this.m_count], o, r.ComputeMass_s_e2), u = P.CrossVV(c, l), h = .5 * u;
                        n += h, i.SelfAdd(P.MulSV(h * (1 / 3), P.AddVV(c, l, P.s_t0), P.s_t1));
                        var _ = c.x, f = c.y, d = l.x, p = l.y;
                        s += 1 / 3 * .25 * u * (_ * _ + d * _ + d * d + f * f + p * f + p * p);
                    }
                    t.mass = e * n, i.SelfMul(1 / n), P.AddVV(i, o, t.center), t.I = e * s, t.I += t.mass * (P.DotVV(t.center, t.center) - P.DotVV(i, i));
                }, r.prototype.Validate = function() {
                    for (var t = 0; t < this.m_count; ++t) for (var e = t, i = (t + 1) % this.m_count, n = this.m_vertices[e], s = P.SubVV(this.m_vertices[i], n, r.Validate_s_e), o = 0; o < this.m_count; ++o) if (o !== e && o !== i) {
                        var a = P.SubVV(this.m_vertices[o], n, r.Validate_s_v);
                        if (P.CrossVV(s, a) < 0) return !1;
                    }
                    return !0;
                }, r.prototype.SetupDistanceProxy = function(t) {
                    t.m_vertices = this.m_vertices, t.m_count = this.m_count, t.m_radius = this.m_radius;
                }, r.prototype.ComputeSubmergedArea = function(t, e, i, s) {
                    for (var o = O.MulTRV(i.q, t, r.ComputeSubmergedArea_s_normalL), a = e - P.DotVV(t, i.p), c = r.ComputeSubmergedArea_s_depths, l = 0, u = -1, h = -1, _ = !1, f = 0; f < this.m_count; ++f) {
                        c[f] = P.DotVV(o, this.m_vertices[f]) - a;
                        var d = c[f] < -n;
                        f > 0 && (d ? _ || (u = f - 1, l++) : _ && (h = f - 1, l++)), _ = d;
                    }
                    switch (l) {
                      case 0:
                        if (_) {
                            var p = r.ComputeSubmergedArea_s_md;
                            return this.ComputeMass(p, 1), F.MulXV(i, p.center, s), p.mass;
                        }
                        return 0;

                      case 1:
                        -1 === u ? u = this.m_count - 1 : h = this.m_count - 1;
                    }
                    for (var m, v = (u + 1) % this.m_count, y = (h + 1) % this.m_count, g = (0 - c[u]) / (c[v] - c[u]), x = (0 - c[h]) / (c[y] - c[h]), A = r.ComputeSubmergedArea_s_intoVec.Set(this.m_vertices[u].x * (1 - g) + this.m_vertices[v].x * g, this.m_vertices[u].y * (1 - g) + this.m_vertices[v].y * g), C = r.ComputeSubmergedArea_s_outoVec.Set(this.m_vertices[h].x * (1 - x) + this.m_vertices[y].x * x, this.m_vertices[h].y * (1 - x) + this.m_vertices[y].y * x), b = 0, S = r.ComputeSubmergedArea_s_center.SetZero(), T = this.m_vertices[v], w = v; w !== y; ) {
                        m = (w = (w + 1) % this.m_count) === y ? C : this.m_vertices[w];
                        var E = .5 * ((T.x - A.x) * (m.y - A.y) - (T.y - A.y) * (m.x - A.x));
                        b += E, S.x += E * (A.x + T.x + m.x) / 3, S.y += E * (A.y + T.y + m.y) / 3, T = m;
                    }
                    return S.SelfMul(1 / b), F.MulXV(i, S, s), b;
                }, r.prototype.Dump = function(t) {
                    t("    const shape: b2PolygonShape = new b2PolygonShape();\n"), t("    const vs: b2Vec2[] = b2Vec2.MakeArray(%d);\n", a);
                    for (var e = 0; e < this.m_count; ++e) t("    vs[%d].Set(%.15f, %.15f);\n", e, this.m_vertices[e].x, this.m_vertices[e].y);
                    t("    shape.Set(vs, %d);\n", this.m_count);
                }, r.ComputeCentroid = function(t, e, i) {
                    var n = i;
                    n.SetZero();
                    for (var s = 0, o = r.ComputeCentroid_s_pRef.SetZero(), a = 0; a < e; ++a) {
                        var c = o, l = t[a], u = t[(a + 1) % e], h = P.SubVV(l, c, r.ComputeCentroid_s_e1), _ = P.SubVV(u, c, r.ComputeCentroid_s_e2), f = .5 * P.CrossVV(h, _);
                        s += f, n.x += f * (1 / 3) * (c.x + l.x + u.x), n.y += f * (1 / 3) * (c.y + l.y + u.y);
                    }
                    return n.SelfMul(1 / s), n;
                }, r.Set_s_ps = P.MakeArray(a), r.Set_s_hull = p(a), r.Set_s_r = new P(), r.Set_s_v = new P(), 
                r.TestPoint_s_pLocal = new P(), r.ComputeDistance_s_pLocal = new P(), r.ComputeDistance_s_normalForMaxDistance = new P(), 
                r.ComputeDistance_s_minDistance = new P(), r.ComputeDistance_s_distance = new P(), 
                r.RayCast_s_p1 = new P(), r.RayCast_s_p2 = new P(), r.RayCast_s_d = new P(), r.ComputeAABB_s_v = new P(), 
                r.ComputeMass_s_center = new P(), r.ComputeMass_s_s = new P(), r.ComputeMass_s_e1 = new P(), 
                r.ComputeMass_s_e2 = new P(), r.Validate_s_e = new P(), r.Validate_s_v = new P(), 
                r.ComputeSubmergedArea_s_normalL = new P(), r.ComputeSubmergedArea_s_depths = p(a), 
                r.ComputeSubmergedArea_s_md = new Ke(), r.ComputeSubmergedArea_s_intoVec = new P(), 
                r.ComputeSubmergedArea_s_outoVec = new P(), r.ComputeSubmergedArea_s_center = new P(), 
                r.ComputeCentroid_s_pRef = new P(), r.ComputeCentroid_s_e1 = new P(), r.ComputeCentroid_s_e2 = new P(), 
                r;
            }(Qe), ri = function(e) {
                function i() {
                    var i = e.call(this, t.b2ShapeType.e_edgeShape, u) || this;
                    return i.m_vertex1 = new P(), i.m_vertex2 = new P(), i.m_vertex0 = new P(), i.m_vertex3 = new P(), 
                    i.m_hasVertex0 = !1, i.m_hasVertex3 = !1, i;
                }
                return ti(i, e), i.prototype.Set = function(t, e) {
                    return this.m_vertex1.Copy(t), this.m_vertex2.Copy(e), this.m_hasVertex0 = !1, this.m_hasVertex3 = !1, 
                    this;
                }, i.prototype.Clone = function() {
                    return new i().Copy(this);
                }, i.prototype.Copy = function(t) {
                    return e.prototype.Copy.call(this, t), this.m_vertex1.Copy(t.m_vertex1), this.m_vertex2.Copy(t.m_vertex2), 
                    this.m_vertex0.Copy(t.m_vertex0), this.m_vertex3.Copy(t.m_vertex3), this.m_hasVertex0 = t.m_hasVertex0, 
                    this.m_hasVertex3 = t.m_hasVertex3, this;
                }, i.prototype.GetChildCount = function() {
                    return 1;
                }, i.prototype.TestPoint = function() {
                    return !1;
                }, i.prototype.ComputeDistance = function(t, e, n) {
                    var r = F.MulXV(t, this.m_vertex1, i.ComputeDistance_s_v1), s = F.MulXV(t, this.m_vertex2, i.ComputeDistance_s_v2), o = P.SubVV(e, r, i.ComputeDistance_s_d), a = P.SubVV(s, r, i.ComputeDistance_s_s), c = P.DotVV(o, a);
                    if (c > 0) {
                        var l = P.DotVV(a, a);
                        c > l ? P.SubVV(e, s, o) : o.SelfMulSub(c / l, a);
                    }
                    return n.Copy(o), n.Normalize();
                }, i.prototype.RayCast = function(t, e, n) {
                    var r = F.MulTXV(n, e.p1, i.RayCast_s_p1), s = F.MulTXV(n, e.p2, i.RayCast_s_p2), o = P.SubVV(s, r, i.RayCast_s_d), a = this.m_vertex1, c = this.m_vertex2, l = P.SubVV(c, a, i.RayCast_s_e), u = t.normal.Set(l.y, -l.x).SelfNormalize(), h = P.DotVV(u, P.SubVV(a, r, P.s_t0)), _ = P.DotVV(u, o);
                    if (0 === _) return !1;
                    var f = h / _;
                    if (f < 0 || e.maxFraction < f) return !1;
                    var d = P.AddVMulSV(r, f, o, i.RayCast_s_q), p = P.SubVV(c, a, i.RayCast_s_r), m = P.DotVV(p, p);
                    if (0 === m) return !1;
                    var v = P.DotVV(P.SubVV(d, a, P.s_t0), p) / m;
                    return !(v < 0 || 1 < v || (t.fraction = f, O.MulRV(n.q, t.normal, t.normal), h > 0 && t.normal.SelfNeg(), 
                    0));
                }, i.prototype.ComputeAABB = function(t, e) {
                    var n = F.MulXV(e, this.m_vertex1, i.ComputeAABB_s_v1), r = F.MulXV(e, this.m_vertex2, i.ComputeAABB_s_v2);
                    P.MinV(n, r, t.lowerBound), P.MaxV(n, r, t.upperBound);
                    var s = this.m_radius;
                    t.lowerBound.SelfSubXY(s, s), t.upperBound.SelfAddXY(s, s);
                }, i.prototype.ComputeMass = function(t) {
                    t.mass = 0, P.MidVV(this.m_vertex1, this.m_vertex2, t.center), t.I = 0;
                }, i.prototype.SetupDistanceProxy = function(t) {
                    t.m_vertices = t.m_buffer, t.m_vertices[0].Copy(this.m_vertex1), t.m_vertices[1].Copy(this.m_vertex2), 
                    t.m_count = 2, t.m_radius = this.m_radius;
                }, i.prototype.ComputeSubmergedArea = function(t, e, i, n) {
                    return n.SetZero(), 0;
                }, i.prototype.Dump = function(t) {
                    t("    const shape: b2EdgeShape = new b2EdgeShape();\n"), t("    shape.m_radius = %.15f;\n", this.m_radius), 
                    t("    shape.m_vertex0.Set(%.15f, %.15f);\n", this.m_vertex0.x, this.m_vertex0.y), 
                    t("    shape.m_vertex1.Set(%.15f, %.15f);\n", this.m_vertex1.x, this.m_vertex1.y), 
                    t("    shape.m_vertex2.Set(%.15f, %.15f);\n", this.m_vertex2.x, this.m_vertex2.y), 
                    t("    shape.m_vertex3.Set(%.15f, %.15f);\n", this.m_vertex3.x, this.m_vertex3.y), 
                    t("    shape.m_hasVertex0 = %s;\n", this.m_hasVertex0), t("    shape.m_hasVertex3 = %s;\n", this.m_hasVertex3);
                }, i.ComputeDistance_s_v1 = new P(), i.ComputeDistance_s_v2 = new P(), i.ComputeDistance_s_d = new P(), 
                i.ComputeDistance_s_s = new P(), i.RayCast_s_p1 = new P(), i.RayCast_s_p2 = new P(), 
                i.RayCast_s_d = new P(), i.RayCast_s_e = new P(), i.RayCast_s_q = new P(), i.RayCast_s_r = new P(), 
                i.ComputeAABB_s_v1 = new P(), i.ComputeAABB_s_v2 = new P(), i;
            }(Qe), si = function(e) {
                function i() {
                    var i = e.call(this, t.b2ShapeType.e_chainShape, u) || this;
                    return i.m_vertices = [], i.m_count = 0, i.m_prevVertex = new P(), i.m_nextVertex = new P(), 
                    i.m_hasPrevVertex = !1, i.m_hasNextVertex = !1, i;
                }
                return ti(i, e), i.prototype.CreateLoop = function(t, e, i) {
                    if (void 0 === e && (e = t.length), void 0 === i && (i = 0), e < 3) return this;
                    this.m_count = e + 1, this.m_vertices = P.MakeArray(this.m_count);
                    for (var n = 0; n < e; ++n) this.m_vertices[n].Copy(t[i + n]);
                    return this.m_vertices[e].Copy(this.m_vertices[0]), this.m_prevVertex.Copy(this.m_vertices[this.m_count - 2]), 
                    this.m_nextVertex.Copy(this.m_vertices[1]), this.m_hasPrevVertex = !0, this.m_hasNextVertex = !0, 
                    this;
                }, i.prototype.CreateChain = function(t, e, i) {
                    void 0 === e && (e = t.length), void 0 === i && (i = 0), this.m_count = e, this.m_vertices = P.MakeArray(e);
                    for (var n = 0; n < e; ++n) this.m_vertices[n].Copy(t[i + n]);
                    return this.m_hasPrevVertex = !1, this.m_hasNextVertex = !1, this.m_prevVertex.SetZero(), 
                    this.m_nextVertex.SetZero(), this;
                }, i.prototype.SetPrevVertex = function(t) {
                    return this.m_prevVertex.Copy(t), this.m_hasPrevVertex = !0, this;
                }, i.prototype.SetNextVertex = function(t) {
                    return this.m_nextVertex.Copy(t), this.m_hasNextVertex = !0, this;
                }, i.prototype.Clone = function() {
                    return new i().Copy(this);
                }, i.prototype.Copy = function(t) {
                    return e.prototype.Copy.call(this, t), this.CreateChain(t.m_vertices, t.m_count), 
                    this.m_prevVertex.Copy(t.m_prevVertex), this.m_nextVertex.Copy(t.m_nextVertex), 
                    this.m_hasPrevVertex = t.m_hasPrevVertex, this.m_hasNextVertex = t.m_hasNextVertex, 
                    this;
                }, i.prototype.GetChildCount = function() {
                    return this.m_count - 1;
                }, i.prototype.GetChildEdge = function(e, i) {
                    e.m_type = t.b2ShapeType.e_edgeShape, e.m_radius = this.m_radius, e.m_vertex1.Copy(this.m_vertices[i]), 
                    e.m_vertex2.Copy(this.m_vertices[i + 1]), i > 0 ? (e.m_vertex0.Copy(this.m_vertices[i - 1]), 
                    e.m_hasVertex0 = !0) : (e.m_vertex0.Copy(this.m_prevVertex), e.m_hasVertex0 = this.m_hasPrevVertex), 
                    i < this.m_count - 2 ? (e.m_vertex3.Copy(this.m_vertices[i + 2]), e.m_hasVertex3 = !0) : (e.m_vertex3.Copy(this.m_nextVertex), 
                    e.m_hasVertex3 = this.m_hasNextVertex);
                }, i.prototype.TestPoint = function() {
                    return !1;
                }, i.prototype.ComputeDistance = function(t, e, n, r) {
                    var s = i.ComputeDistance_s_edgeShape;
                    return this.GetChildEdge(s, r), s.ComputeDistance(t, e, n, 0);
                }, i.prototype.RayCast = function(t, e, n, r) {
                    var s = i.RayCast_s_edgeShape;
                    return s.m_vertex1.Copy(this.m_vertices[r]), s.m_vertex2.Copy(this.m_vertices[(r + 1) % this.m_count]), 
                    s.RayCast(t, e, n, 0);
                }, i.prototype.ComputeAABB = function(t, e, n) {
                    var r = this.m_vertices[n], s = this.m_vertices[(n + 1) % this.m_count], o = F.MulXV(e, r, i.ComputeAABB_s_v1), a = F.MulXV(e, s, i.ComputeAABB_s_v2);
                    P.MinV(o, a, t.lowerBound), P.MaxV(o, a, t.upperBound);
                }, i.prototype.ComputeMass = function(t) {
                    t.mass = 0, t.center.SetZero(), t.I = 0;
                }, i.prototype.SetupDistanceProxy = function(t, e) {
                    t.m_vertices = t.m_buffer, t.m_vertices[0].Copy(this.m_vertices[e]), e + 1 < this.m_count ? t.m_vertices[1].Copy(this.m_vertices[e + 1]) : t.m_vertices[1].Copy(this.m_vertices[0]), 
                    t.m_count = 2, t.m_radius = this.m_radius;
                }, i.prototype.ComputeSubmergedArea = function(t, e, i, n) {
                    return n.SetZero(), 0;
                }, i.prototype.Dump = function(t) {
                    t("    const shape: b2ChainShape = new b2ChainShape();\n"), t("    const vs: b2Vec2[] = b2Vec2.MakeArray(%d);\n", a);
                    for (var e = 0; e < this.m_count; ++e) t("    vs[%d].Set(%.15f, %.15f);\n", e, this.m_vertices[e].x, this.m_vertices[e].y);
                    t("    shape.CreateChain(vs, %d);\n", this.m_count), t("    shape.m_prevVertex.Set(%.15f, %.15f);\n", this.m_prevVertex.x, this.m_prevVertex.y), 
                    t("    shape.m_nextVertex.Set(%.15f, %.15f);\n", this.m_nextVertex.x, this.m_nextVertex.y), 
                    t("    shape.m_hasPrevVertex = %s;\n", this.m_hasPrevVertex ? "true" : "false"), 
                    t("    shape.m_hasNextVertex = %s;\n", this.m_hasNextVertex ? "true" : "false");
                }, i.ComputeDistance_s_edgeShape = new ri(), i.RayCast_s_edgeShape = new ri(), i.ComputeAABB_s_v1 = new P(), 
                i.ComputeAABB_s_v2 = new P(), i;
            }(Qe), oi = function() {
                function t() {
                    this.categoryBits = 1, this.maskBits = 65535, this.groupIndex = 0;
                }
                return t.prototype.Clone = function() {
                    return new t().Copy(this);
                }, t.prototype.Copy = function(t) {
                    return this.categoryBits = t.categoryBits, this.maskBits = t.maskBits, this.groupIndex = t.groupIndex || 0, 
                    this;
                }, t.DEFAULT = new t(), t;
            }(), ai = function() {
                this.userData = null, this.friction = .2, this.restitution = 0, this.density = 0, 
                this.isSensor = !1, this.filter = new oi();
            }, ci = function(t) {
                this.aabb = new St(), this.childIndex = 0, this.fixture = t;
            }, li = function() {
                function t(t, e) {
                    this.m_density = 0, this.m_next = null, this.m_friction = 0, this.m_restitution = 0, 
                    this.m_proxies = [], this.m_proxyCount = 0, this.m_filter = new oi(), this.m_isSensor = !1, 
                    this.m_userData = null, this.m_body = e, this.m_shape = t.shape.Clone();
                }
                return t.prototype.GetType = function() {
                    return this.m_shape.GetType();
                }, t.prototype.GetShape = function() {
                    return this.m_shape;
                }, t.prototype.SetSensor = function(t) {
                    t !== this.m_isSensor && (this.m_body.SetAwake(!0), this.m_isSensor = t);
                }, t.prototype.IsSensor = function() {
                    return this.m_isSensor;
                }, t.prototype.SetFilterData = function(t) {
                    this.m_filter.Copy(t), this.Refilter();
                }, t.prototype.GetFilterData = function() {
                    return this.m_filter;
                }, t.prototype.Refilter = function() {
                    for (var t = this.m_body.GetContactList(); t; ) {
                        var e = t.contact, i = e.GetFixtureA(), n = e.GetFixtureB();
                        i !== this && n !== this || e.FlagForFiltering(), t = t.next;
                    }
                    var r = this.m_body.GetWorld();
                    if (null !== r) for (var s = r.m_contactManager.m_broadPhase, o = 0; o < this.m_proxyCount; ++o) s.TouchProxy(this.m_proxies[o].treeNode);
                }, t.prototype.GetBody = function() {
                    return this.m_body;
                }, t.prototype.GetNext = function() {
                    return this.m_next;
                }, t.prototype.GetUserData = function() {
                    return this.m_userData;
                }, t.prototype.SetUserData = function(t) {
                    this.m_userData = t;
                }, t.prototype.TestPoint = function(t) {
                    return this.m_shape.TestPoint(this.m_body.GetTransform(), t);
                }, t.prototype.ComputeDistance = function(t, e, i) {
                    return this.m_shape.ComputeDistance(this.m_body.GetTransform(), t, e, i);
                }, t.prototype.RayCast = function(t, e, i) {
                    return this.m_shape.RayCast(t, e, this.m_body.GetTransform(), i);
                }, t.prototype.GetMassData = function(t) {
                    return void 0 === t && (t = new Ke()), this.m_shape.ComputeMass(t, this.m_density), 
                    t;
                }, t.prototype.SetDensity = function(t) {
                    this.m_density = t;
                }, t.prototype.GetDensity = function() {
                    return this.m_density;
                }, t.prototype.GetFriction = function() {
                    return this.m_friction;
                }, t.prototype.SetFriction = function(t) {
                    this.m_friction = t;
                }, t.prototype.GetRestitution = function() {
                    return this.m_restitution;
                }, t.prototype.SetRestitution = function(t) {
                    this.m_restitution = t;
                }, t.prototype.GetAABB = function(t) {
                    return this.m_proxies[t].aabb;
                }, t.prototype.Dump = function(t, e) {
                    t("    const fd: b2FixtureDef = new b2FixtureDef();\n"), t("    fd.friction = %.15f;\n", this.m_friction), 
                    t("    fd.restitution = %.15f;\n", this.m_restitution), t("    fd.density = %.15f;\n", this.m_density), 
                    t("    fd.isSensor = %s;\n", this.m_isSensor ? "true" : "false"), t("    fd.filter.categoryBits = %d;\n", this.m_filter.categoryBits), 
                    t("    fd.filter.maskBits = %d;\n", this.m_filter.maskBits), t("    fd.filter.groupIndex = %d;\n", this.m_filter.groupIndex), 
                    this.m_shape.Dump(t), t("\n"), t("    fd.shape = shape;\n"), t("\n"), t("    bodies[%d].CreateFixture(fd);\n", e);
                }, t.prototype.Create = function(t) {
                    var i = this;
                    this.m_userData = t.userData, this.m_friction = e(t.friction, .2), this.m_restitution = e(t.restitution, 0), 
                    this.m_next = null, this.m_filter.Copy(e(t.filter, oi.DEFAULT)), this.m_isSensor = e(t.isSensor, !1), 
                    this.m_proxies = d(this.m_shape.GetChildCount(), function() {
                        return new ci(i);
                    }), this.m_proxyCount = 0, this.m_density = e(t.density, 0);
                }, t.prototype.Destroy = function() {}, t.prototype.CreateProxies = function(t) {
                    var e = this.m_body.m_world.m_contactManager.m_broadPhase;
                    this.m_proxyCount = this.m_shape.GetChildCount();
                    for (var i = 0; i < this.m_proxyCount; ++i) {
                        var n = this.m_proxies[i] = new ci(this);
                        this.m_shape.ComputeAABB(n.aabb, t, i), n.treeNode = e.CreateProxy(n.aabb, n), n.childIndex = i;
                    }
                }, t.prototype.DestroyProxies = function() {
                    for (var t = this.m_body.m_world.m_contactManager.m_broadPhase, e = 0; e < this.m_proxyCount; ++e) {
                        var i = this.m_proxies[e];
                        delete i.treeNode.userData, t.DestroyProxy(i.treeNode), delete i.treeNode;
                    }
                    this.m_proxyCount = 0;
                }, t.prototype.TouchProxies = function() {
                    for (var t = this.m_body.m_world.m_contactManager.m_broadPhase, e = this.m_proxyCount, i = 0; i < e; ++i) t.TouchProxy(this.m_proxies[i].treeNode);
                }, t.prototype.Synchronize = function(e, i) {
                    if (0 !== this.m_proxyCount) for (var n = this.m_body.m_world.m_contactManager.m_broadPhase, r = 0; r < this.m_proxyCount; ++r) {
                        var s = this.m_proxies[r], o = t.Synchronize_s_aabb1, a = t.Synchronize_s_aabb2;
                        this.m_shape.ComputeAABB(o, e, r), this.m_shape.ComputeAABB(a, i, r), s.aabb.Combine2(o, a);
                        var c = P.SubVV(i.p, e.p, t.Synchronize_s_displacement);
                        n.MoveProxy(s.treeNode, s.aabb, c);
                    }
                }, t.Synchronize_s_aabb1 = new St(), t.Synchronize_s_aabb2 = new St(), t.Synchronize_s_displacement = new P(), 
                t;
            }();
            (ei = t.b2BodyType || (t.b2BodyType = {}))[ei.b2_unknown = -1] = "b2_unknown", ei[ei.b2_staticBody = 0] = "b2_staticBody", 
            ei[ei.b2_kinematicBody = 1] = "b2_kinematicBody", ei[ei.b2_dynamicBody = 2] = "b2_dynamicBody";
            var ui, hi, _i = function() {
                function i(i, n) {
                    this.m_type = t.b2BodyType.b2_staticBody, this.m_islandFlag = !1, this.m_awakeFlag = !1, 
                    this.m_autoSleepFlag = !1, this.m_bulletFlag = !1, this.m_fixedRotationFlag = !1, 
                    this.m_activeFlag = !1, this.m_toiFlag = !1, this.m_islandIndex = 0, this.m_xf = new F(), 
                    this.m_xf0 = new F(), this.m_sweep = new N(), this.m_linearVelocity = new P(), this.m_angularVelocity = 0, 
                    this.m_force = new P(), this.m_torque = 0, this.m_prev = null, this.m_next = null, 
                    this.m_fixtureList = null, this.m_fixtureCount = 0, this.m_jointList = null, this.m_contactList = null, 
                    this.m_mass = 1, this.m_invMass = 1, this.m_I = 0, this.m_invI = 0, this.m_linearDamping = 0, 
                    this.m_angularDamping = 0, this.m_gravityScale = 1, this.m_sleepTime = 0, this.m_userData = null, 
                    this.m_controllerList = null, this.m_controllerCount = 0, this.m_bulletFlag = e(i.bullet, !1), 
                    this.m_fixedRotationFlag = e(i.fixedRotation, !1), this.m_autoSleepFlag = e(i.allowSleep, !0), 
                    this.m_awakeFlag = e(i.awake, !0), this.m_activeFlag = e(i.active, !0), this.m_world = n, 
                    this.m_xf.p.Copy(e(i.position, P.ZERO)), this.m_xf.q.SetAngle(e(i.angle, 0)), this.m_xf0.Copy(this.m_xf), 
                    this.m_sweep.localCenter.SetZero(), this.m_sweep.c0.Copy(this.m_xf.p), this.m_sweep.c.Copy(this.m_xf.p), 
                    this.m_sweep.a0 = this.m_sweep.a = this.m_xf.q.GetAngle(), this.m_sweep.alpha0 = 0, 
                    this.m_linearVelocity.Copy(e(i.linearVelocity, P.ZERO)), this.m_angularVelocity = e(i.angularVelocity, 0), 
                    this.m_linearDamping = e(i.linearDamping, 0), this.m_angularDamping = e(i.angularDamping, 0), 
                    this.m_gravityScale = e(i.gravityScale, 1), this.m_force.SetZero(), this.m_torque = 0, 
                    this.m_sleepTime = 0, this.m_type = e(i.type, t.b2BodyType.b2_staticBody), i.type === t.b2BodyType.b2_dynamicBody ? (this.m_mass = 1, 
                    this.m_invMass = 1) : (this.m_mass = 0, this.m_invMass = 0), this.m_I = 0, this.m_invI = 0, 
                    this.m_userData = i.userData, this.m_fixtureList = null, this.m_fixtureCount = 0, 
                    this.m_controllerList = null, this.m_controllerCount = 0;
                }
                return i.prototype.CreateFixture = function(t, e) {
                    return void 0 === e && (e = 0), t instanceof Qe ? this.CreateFixtureShapeDensity(t, e) : this.CreateFixtureDef(t);
                }, i.prototype.CreateFixtureDef = function(t) {
                    if (this.m_world.IsLocked()) throw new Error();
                    var e = new li(t, this);
                    return e.Create(t), this.m_activeFlag && e.CreateProxies(this.m_xf), e.m_next = this.m_fixtureList, 
                    this.m_fixtureList = e, ++this.m_fixtureCount, e.m_density > 0 && this.ResetMassData(), 
                    this.m_world.m_newFixture = !0, e;
                }, i.prototype.CreateFixtureShapeDensity = function(t, e) {
                    void 0 === e && (e = 0);
                    var n = i.CreateFixtureShapeDensity_s_def;
                    return n.shape = t, n.density = e, this.CreateFixtureDef(n);
                }, i.prototype.DestroyFixture = function(t) {
                    if (this.m_world.IsLocked()) throw new Error();
                    for (var e = this.m_fixtureList, i = null; null !== e; ) {
                        if (e === t) {
                            i ? i.m_next = t.m_next : this.m_fixtureList = t.m_next;
                            break;
                        }
                        i = e, e = e.m_next;
                    }
                    for (var n = this.m_contactList; n; ) {
                        var r = n.contact;
                        n = n.next;
                        var s = r.GetFixtureA(), o = r.GetFixtureB();
                        t !== s && t !== o || this.m_world.m_contactManager.Destroy(r);
                    }
                    this.m_activeFlag && t.DestroyProxies(), t.m_next = null, t.Destroy(), --this.m_fixtureCount, 
                    this.ResetMassData();
                }, i.prototype.SetTransformVec = function(t, e) {
                    this.SetTransformXY(t.x, t.y, e);
                }, i.prototype.SetTransformXY = function(t, e, i) {
                    if (this.m_world.IsLocked()) throw new Error();
                    this.m_xf.q.SetAngle(i), this.m_xf.p.Set(t, e), this.m_xf0.Copy(this.m_xf), F.MulXV(this.m_xf, this.m_sweep.localCenter, this.m_sweep.c), 
                    this.m_sweep.a = i, this.m_sweep.c0.Copy(this.m_sweep.c), this.m_sweep.a0 = i;
                    for (var n = this.m_fixtureList; n; n = n.m_next) n.Synchronize(this.m_xf, this.m_xf);
                    this.m_world.m_contactManager.FindNewContacts();
                }, i.prototype.SetTransform = function(t) {
                    this.SetTransformVec(t.p, t.GetAngle());
                }, i.prototype.GetTransform = function() {
                    return this.m_xf;
                }, i.prototype.GetPosition = function() {
                    return this.m_xf.p;
                }, i.prototype.SetPosition = function(t) {
                    this.SetTransformVec(t, this.GetAngle());
                }, i.prototype.SetPositionXY = function(t, e) {
                    this.SetTransformXY(t, e, this.GetAngle());
                }, i.prototype.GetAngle = function() {
                    return this.m_sweep.a;
                }, i.prototype.SetAngle = function(t) {
                    this.SetTransformVec(this.GetPosition(), t);
                }, i.prototype.GetWorldCenter = function() {
                    return this.m_sweep.c;
                }, i.prototype.GetLocalCenter = function() {
                    return this.m_sweep.localCenter;
                }, i.prototype.SetLinearVelocity = function(e) {
                    this.m_type !== t.b2BodyType.b2_staticBody && (P.DotVV(e, e) > 0 && this.SetAwake(!0), 
                    this.m_linearVelocity.Copy(e));
                }, i.prototype.GetLinearVelocity = function() {
                    return this.m_linearVelocity;
                }, i.prototype.SetAngularVelocity = function(e) {
                    this.m_type !== t.b2BodyType.b2_staticBody && (e * e > 0 && this.SetAwake(!0), this.m_angularVelocity = e);
                }, i.prototype.GetAngularVelocity = function() {
                    return this.m_angularVelocity;
                }, i.prototype.GetDefinition = function(t) {
                    return t.type = this.GetType(), t.allowSleep = this.m_autoSleepFlag, t.angle = this.GetAngle(), 
                    t.angularDamping = this.m_angularDamping, t.gravityScale = this.m_gravityScale, 
                    t.angularVelocity = this.m_angularVelocity, t.fixedRotation = this.m_fixedRotationFlag, 
                    t.bullet = this.m_bulletFlag, t.awake = this.m_awakeFlag, t.linearDamping = this.m_linearDamping, 
                    t.linearVelocity.Copy(this.GetLinearVelocity()), t.position.Copy(this.GetPosition()), 
                    t.userData = this.GetUserData(), t;
                }, i.prototype.ApplyForce = function(e, i, n) {
                    void 0 === n && (n = !0), this.m_type === t.b2BodyType.b2_dynamicBody && (n && !this.m_awakeFlag && this.SetAwake(!0), 
                    this.m_awakeFlag && (this.m_force.x += e.x, this.m_force.y += e.y, this.m_torque += (i.x - this.m_sweep.c.x) * e.y - (i.y - this.m_sweep.c.y) * e.x));
                }, i.prototype.ApplyForceToCenter = function(e, i) {
                    void 0 === i && (i = !0), this.m_type === t.b2BodyType.b2_dynamicBody && (i && !this.m_awakeFlag && this.SetAwake(!0), 
                    this.m_awakeFlag && (this.m_force.x += e.x, this.m_force.y += e.y));
                }, i.prototype.ApplyTorque = function(e, i) {
                    void 0 === i && (i = !0), this.m_type === t.b2BodyType.b2_dynamicBody && (i && !this.m_awakeFlag && this.SetAwake(!0), 
                    this.m_awakeFlag && (this.m_torque += e));
                }, i.prototype.ApplyLinearImpulse = function(e, i, n) {
                    void 0 === n && (n = !0), this.m_type === t.b2BodyType.b2_dynamicBody && (n && !this.m_awakeFlag && this.SetAwake(!0), 
                    this.m_awakeFlag && (this.m_linearVelocity.x += this.m_invMass * e.x, this.m_linearVelocity.y += this.m_invMass * e.y, 
                    this.m_angularVelocity += this.m_invI * ((i.x - this.m_sweep.c.x) * e.y - (i.y - this.m_sweep.c.y) * e.x)));
                }, i.prototype.ApplyLinearImpulseToCenter = function(e, i) {
                    void 0 === i && (i = !0), this.m_type === t.b2BodyType.b2_dynamicBody && (i && !this.m_awakeFlag && this.SetAwake(!0), 
                    this.m_awakeFlag && (this.m_linearVelocity.x += this.m_invMass * e.x, this.m_linearVelocity.y += this.m_invMass * e.y));
                }, i.prototype.ApplyAngularImpulse = function(e, i) {
                    void 0 === i && (i = !0), this.m_type === t.b2BodyType.b2_dynamicBody && (i && !this.m_awakeFlag && this.SetAwake(!0), 
                    this.m_awakeFlag && (this.m_angularVelocity += this.m_invI * e));
                }, i.prototype.GetMass = function() {
                    return this.m_mass;
                }, i.prototype.GetInertia = function() {
                    return this.m_I + this.m_mass * P.DotVV(this.m_sweep.localCenter, this.m_sweep.localCenter);
                }, i.prototype.GetMassData = function(t) {
                    return t.mass = this.m_mass, t.I = this.m_I + this.m_mass * P.DotVV(this.m_sweep.localCenter, this.m_sweep.localCenter), 
                    t.center.Copy(this.m_sweep.localCenter), t;
                }, i.prototype.SetMassData = function(e) {
                    if (this.m_world.IsLocked()) throw new Error();
                    if (this.m_type === t.b2BodyType.b2_dynamicBody) {
                        this.m_invMass = 0, this.m_I = 0, this.m_invI = 0, this.m_mass = e.mass, this.m_mass <= 0 && (this.m_mass = 1), 
                        this.m_invMass = 1 / this.m_mass, e.I > 0 && !this.m_fixedRotationFlag && (this.m_I = e.I - this.m_mass * P.DotVV(e.center, e.center), 
                        this.m_invI = 1 / this.m_I);
                        var n = i.SetMassData_s_oldCenter.Copy(this.m_sweep.c);
                        this.m_sweep.localCenter.Copy(e.center), F.MulXV(this.m_xf, this.m_sweep.localCenter, this.m_sweep.c), 
                        this.m_sweep.c0.Copy(this.m_sweep.c), P.AddVCrossSV(this.m_linearVelocity, this.m_angularVelocity, P.SubVV(this.m_sweep.c, n, P.s_t0), this.m_linearVelocity);
                    }
                }, i.prototype.ResetMassData = function() {
                    if (this.m_mass = 0, this.m_invMass = 0, this.m_I = 0, this.m_invI = 0, this.m_sweep.localCenter.SetZero(), 
                    this.m_type === t.b2BodyType.b2_staticBody || this.m_type === t.b2BodyType.b2_kinematicBody) return this.m_sweep.c0.Copy(this.m_xf.p), 
                    this.m_sweep.c.Copy(this.m_xf.p), void (this.m_sweep.a0 = this.m_sweep.a);
                    for (var e = i.ResetMassData_s_localCenter.SetZero(), n = this.m_fixtureList; n; n = n.m_next) if (0 !== n.m_density) {
                        var r = n.GetMassData(i.ResetMassData_s_massData);
                        this.m_mass += r.mass, e.x += r.center.x * r.mass, e.y += r.center.y * r.mass, this.m_I += r.I;
                    }
                    this.m_mass > 0 ? (this.m_invMass = 1 / this.m_mass, e.x *= this.m_invMass, e.y *= this.m_invMass) : (this.m_mass = 1, 
                    this.m_invMass = 1), this.m_I > 0 && !this.m_fixedRotationFlag ? (this.m_I -= this.m_mass * P.DotVV(e, e), 
                    this.m_invI = 1 / this.m_I) : (this.m_I = 0, this.m_invI = 0);
                    var s = i.ResetMassData_s_oldCenter.Copy(this.m_sweep.c);
                    this.m_sweep.localCenter.Copy(e), F.MulXV(this.m_xf, this.m_sweep.localCenter, this.m_sweep.c), 
                    this.m_sweep.c0.Copy(this.m_sweep.c), P.AddVCrossSV(this.m_linearVelocity, this.m_angularVelocity, P.SubVV(this.m_sweep.c, s, P.s_t0), this.m_linearVelocity);
                }, i.prototype.GetWorldPoint = function(t, e) {
                    return F.MulXV(this.m_xf, t, e);
                }, i.prototype.GetWorldVector = function(t, e) {
                    return O.MulRV(this.m_xf.q, t, e);
                }, i.prototype.GetLocalPoint = function(t, e) {
                    return F.MulTXV(this.m_xf, t, e);
                }, i.prototype.GetLocalVector = function(t, e) {
                    return O.MulTRV(this.m_xf.q, t, e);
                }, i.prototype.GetLinearVelocityFromWorldPoint = function(t, e) {
                    return P.AddVCrossSV(this.m_linearVelocity, this.m_angularVelocity, P.SubVV(t, this.m_sweep.c, P.s_t0), e);
                }, i.prototype.GetLinearVelocityFromLocalPoint = function(t, e) {
                    return this.GetLinearVelocityFromWorldPoint(this.GetWorldPoint(t, e), e);
                }, i.prototype.GetLinearDamping = function() {
                    return this.m_linearDamping;
                }, i.prototype.SetLinearDamping = function(t) {
                    this.m_linearDamping = t;
                }, i.prototype.GetAngularDamping = function() {
                    return this.m_angularDamping;
                }, i.prototype.SetAngularDamping = function(t) {
                    this.m_angularDamping = t;
                }, i.prototype.GetGravityScale = function() {
                    return this.m_gravityScale;
                }, i.prototype.SetGravityScale = function(t) {
                    this.m_gravityScale = t;
                }, i.prototype.SetType = function(e) {
                    if (this.m_world.IsLocked()) throw new Error();
                    if (this.m_type !== e) {
                        this.m_type = e, this.ResetMassData(), this.m_type === t.b2BodyType.b2_staticBody && (this.m_linearVelocity.SetZero(), 
                        this.m_angularVelocity = 0, this.m_sweep.a0 = this.m_sweep.a, this.m_sweep.c0.Copy(this.m_sweep.c), 
                        this.SynchronizeFixtures()), this.SetAwake(!0), this.m_force.SetZero(), this.m_torque = 0;
                        for (var i = this.m_contactList; i; ) {
                            var n = i;
                            i = i.next, this.m_world.m_contactManager.Destroy(n.contact);
                        }
                        this.m_contactList = null;
                        for (var r = this.m_fixtureList; r; r = r.m_next) r.TouchProxies();
                    }
                }, i.prototype.GetType = function() {
                    return this.m_type;
                }, i.prototype.SetBullet = function(t) {
                    this.m_bulletFlag = t;
                }, i.prototype.IsBullet = function() {
                    return this.m_bulletFlag;
                }, i.prototype.SetSleepingAllowed = function(t) {
                    this.m_autoSleepFlag = t, t || this.SetAwake(!0);
                }, i.prototype.IsSleepingAllowed = function() {
                    return this.m_autoSleepFlag;
                }, i.prototype.SetAwake = function(t) {
                    t ? (this.m_awakeFlag = !0, this.m_sleepTime = 0) : (this.m_awakeFlag = !1, this.m_sleepTime = 0, 
                    this.m_linearVelocity.SetZero(), this.m_angularVelocity = 0, this.m_force.SetZero(), 
                    this.m_torque = 0);
                }, i.prototype.IsAwake = function() {
                    return this.m_awakeFlag;
                }, i.prototype.SetActive = function(t) {
                    if (this.m_world.IsLocked()) throw new Error();
                    if (t !== this.IsActive()) if (this.m_activeFlag = t, t) for (var e = this.m_fixtureList; e; e = e.m_next) e.CreateProxies(this.m_xf); else {
                        for (e = this.m_fixtureList; e; e = e.m_next) e.DestroyProxies();
                        for (var i = this.m_contactList; i; ) {
                            var n = i;
                            i = i.next, this.m_world.m_contactManager.Destroy(n.contact);
                        }
                        this.m_contactList = null;
                    }
                }, i.prototype.IsActive = function() {
                    return this.m_activeFlag;
                }, i.prototype.SetFixedRotation = function(t) {
                    this.m_fixedRotationFlag !== t && (this.m_fixedRotationFlag = t, this.m_angularVelocity = 0, 
                    this.ResetMassData());
                }, i.prototype.IsFixedRotation = function() {
                    return this.m_fixedRotationFlag;
                }, i.prototype.GetFixtureList = function() {
                    return this.m_fixtureList;
                }, i.prototype.GetJointList = function() {
                    return this.m_jointList;
                }, i.prototype.GetContactList = function() {
                    return this.m_contactList;
                }, i.prototype.GetNext = function() {
                    return this.m_next;
                }, i.prototype.GetUserData = function() {
                    return this.m_userData;
                }, i.prototype.SetUserData = function(t) {
                    this.m_userData = t;
                }, i.prototype.GetWorld = function() {
                    return this.m_world;
                }, i.prototype.Dump = function(e) {
                    var i = this.m_islandIndex;
                    e("{\n"), e("  const bd: b2BodyDef = new b2BodyDef();\n");
                    var n = "";
                    switch (this.m_type) {
                      case t.b2BodyType.b2_staticBody:
                        n = "b2BodyType.b2_staticBody";
                        break;

                      case t.b2BodyType.b2_kinematicBody:
                        n = "b2BodyType.b2_kinematicBody";
                        break;

                      case t.b2BodyType.b2_dynamicBody:
                        n = "b2BodyType.b2_dynamicBody";
                    }
                    e("  bd.type = %s;\n", n), e("  bd.position.Set(%.15f, %.15f);\n", this.m_xf.p.x, this.m_xf.p.y), 
                    e("  bd.angle = %.15f;\n", this.m_sweep.a), e("  bd.linearVelocity.Set(%.15f, %.15f);\n", this.m_linearVelocity.x, this.m_linearVelocity.y), 
                    e("  bd.angularVelocity = %.15f;\n", this.m_angularVelocity), e("  bd.linearDamping = %.15f;\n", this.m_linearDamping), 
                    e("  bd.angularDamping = %.15f;\n", this.m_angularDamping), e("  bd.allowSleep = %s;\n", this.m_autoSleepFlag ? "true" : "false"), 
                    e("  bd.awake = %s;\n", this.m_awakeFlag ? "true" : "false"), e("  bd.fixedRotation = %s;\n", this.m_fixedRotationFlag ? "true" : "false"), 
                    e("  bd.bullet = %s;\n", this.m_bulletFlag ? "true" : "false"), e("  bd.active = %s;\n", this.m_activeFlag ? "true" : "false"), 
                    e("  bd.gravityScale = %.15f;\n", this.m_gravityScale), e("\n"), e("  bodies[%d] = this.m_world.CreateBody(bd);\n", this.m_islandIndex), 
                    e("\n");
                    for (var r = this.m_fixtureList; r; r = r.m_next) e("  {\n"), r.Dump(e, i), e("  }\n");
                    e("}\n");
                }, i.prototype.SynchronizeFixtures = function() {
                    var t = i.SynchronizeFixtures_s_xf1;
                    t.q.SetAngle(this.m_sweep.a0), O.MulRV(t.q, this.m_sweep.localCenter, t.p), P.SubVV(this.m_sweep.c0, t.p, t.p);
                    for (var e = this.m_fixtureList; e; e = e.m_next) e.Synchronize(t, this.m_xf);
                }, i.prototype.SynchronizeTransform = function() {
                    this.m_xf.q.SetAngle(this.m_sweep.a), O.MulRV(this.m_xf.q, this.m_sweep.localCenter, this.m_xf.p), 
                    P.SubVV(this.m_sweep.c, this.m_xf.p, this.m_xf.p);
                }, i.prototype.ShouldCollide = function(e) {
                    return (this.m_type !== t.b2BodyType.b2_staticBody || e.m_type !== t.b2BodyType.b2_staticBody) && this.ShouldCollideConnected(e);
                }, i.prototype.ShouldCollideConnected = function(t) {
                    for (var e = this.m_jointList; e; e = e.next) if (e.other === t && !e.joint.m_collideConnected) return !1;
                    return !0;
                }, i.prototype.Advance = function(t) {
                    this.m_sweep.Advance(t), this.m_sweep.c.Copy(this.m_sweep.c0), this.m_sweep.a = this.m_sweep.a0, 
                    this.m_xf.q.SetAngle(this.m_sweep.a), O.MulRV(this.m_xf.q, this.m_sweep.localCenter, this.m_xf.p), 
                    P.SubVV(this.m_sweep.c, this.m_xf.p, this.m_xf.p);
                }, i.prototype.GetControllerList = function() {
                    return this.m_controllerList;
                }, i.prototype.GetControllerCount = function() {
                    return this.m_controllerCount;
                }, i.CreateFixtureShapeDensity_s_def = new ai(), i.SetMassData_s_oldCenter = new P(), 
                i.ResetMassData_s_localCenter = new P(), i.ResetMassData_s_oldCenter = new P(), 
                i.ResetMassData_s_massData = new Ke(), i.SynchronizeFixtures_s_xf1 = new F(), i;
            }();
            (ui = t.b2JointType || (t.b2JointType = {}))[ui.e_unknownJoint = 0] = "e_unknownJoint", 
            ui[ui.e_revoluteJoint = 1] = "e_revoluteJoint", ui[ui.e_prismaticJoint = 2] = "e_prismaticJoint", 
            ui[ui.e_distanceJoint = 3] = "e_distanceJoint", ui[ui.e_pulleyJoint = 4] = "e_pulleyJoint", 
            ui[ui.e_mouseJoint = 5] = "e_mouseJoint", ui[ui.e_gearJoint = 6] = "e_gearJoint", 
            ui[ui.e_wheelJoint = 7] = "e_wheelJoint", ui[ui.e_weldJoint = 8] = "e_weldJoint", 
            ui[ui.e_frictionJoint = 9] = "e_frictionJoint", ui[ui.e_ropeJoint = 10] = "e_ropeJoint", 
            ui[ui.e_motorJoint = 11] = "e_motorJoint", ui[ui.e_areaJoint = 12] = "e_areaJoint", 
            (hi = t.b2LimitState || (t.b2LimitState = {}))[hi.e_inactiveLimit = 0] = "e_inactiveLimit", 
            hi[hi.e_atLowerLimit = 1] = "e_atLowerLimit", hi[hi.e_atUpperLimit = 2] = "e_atUpperLimit", 
            hi[hi.e_equalLimits = 3] = "e_equalLimits";
            var fi = function() {
                function t() {
                    this.linear = new P(), this.angularA = 0, this.angularB = 0;
                }
                return t.prototype.SetZero = function() {
                    return this.linear.SetZero(), this.angularA = 0, this.angularB = 0, this;
                }, t.prototype.Set = function(t, e, i) {
                    return this.linear.Copy(t), this.angularA = e, this.angularB = i, this;
                }, t;
            }(), di = function(t, e) {
                this.prev = null, this.next = null, this.joint = t, this.other = e;
            }, pi = function(e) {
                this.type = t.b2JointType.e_unknownJoint, this.userData = null, this.collideConnected = !1, 
                this.type = e;
            }, mi = function() {
                function i(i) {
                    this.m_type = t.b2JointType.e_unknownJoint, this.m_prev = null, this.m_next = null, 
                    this.m_index = 0, this.m_islandFlag = !1, this.m_collideConnected = !1, this.m_userData = null, 
                    this.m_type = i.type, this.m_edgeA = new di(this, i.bodyB), this.m_edgeB = new di(this, i.bodyA), 
                    this.m_bodyA = i.bodyA, this.m_bodyB = i.bodyB, this.m_collideConnected = e(i.collideConnected, !1), 
                    this.m_userData = i.userData;
                }
                return i.prototype.GetType = function() {
                    return this.m_type;
                }, i.prototype.GetBodyA = function() {
                    return this.m_bodyA;
                }, i.prototype.GetBodyB = function() {
                    return this.m_bodyB;
                }, i.prototype.GetNext = function() {
                    return this.m_next;
                }, i.prototype.GetUserData = function() {
                    return this.m_userData;
                }, i.prototype.SetUserData = function(t) {
                    this.m_userData = t;
                }, i.prototype.IsActive = function() {
                    return this.m_bodyA.IsActive() && this.m_bodyB.IsActive();
                }, i.prototype.GetCollideConnected = function() {
                    return this.m_collideConnected;
                }, i.prototype.Dump = function(t) {
                    t("// Dump is not supported for this joint type.\n");
                }, i.prototype.ShiftOrigin = function() {}, i;
            }(), vi = function(e) {
                function i() {
                    var i = e.call(this, t.b2JointType.e_distanceJoint) || this;
                    return i.localAnchorA = new P(), i.localAnchorB = new P(), i.length = 1, i.frequencyHz = 0, 
                    i.dampingRatio = 0, i;
                }
                return ti(i, e), i.prototype.Initialize = function(t, e, i, n) {
                    this.bodyA = t, this.bodyB = e, this.bodyA.GetLocalPoint(i, this.localAnchorA), 
                    this.bodyB.GetLocalPoint(n, this.localAnchorB), this.length = P.DistanceVV(i, n), 
                    this.frequencyHz = 0, this.dampingRatio = 0;
                }, i;
            }(pi), yi = function(t) {
                function i(i) {
                    var n = t.call(this, i) || this;
                    return n.m_frequencyHz = 0, n.m_dampingRatio = 0, n.m_bias = 0, n.m_localAnchorA = new P(), 
                    n.m_localAnchorB = new P(), n.m_gamma = 0, n.m_impulse = 0, n.m_length = 0, n.m_indexA = 0, 
                    n.m_indexB = 0, n.m_u = new P(), n.m_rA = new P(), n.m_rB = new P(), n.m_localCenterA = new P(), 
                    n.m_localCenterB = new P(), n.m_invMassA = 0, n.m_invMassB = 0, n.m_invIA = 0, n.m_invIB = 0, 
                    n.m_mass = 0, n.m_qA = new O(), n.m_qB = new O(), n.m_lalcA = new P(), n.m_lalcB = new P(), 
                    n.m_frequencyHz = e(i.frequencyHz, 0), n.m_dampingRatio = e(i.dampingRatio, 0), 
                    n.m_localAnchorA.Copy(i.localAnchorA), n.m_localAnchorB.Copy(i.localAnchorB), n.m_length = i.length, 
                    n;
                }
                return ti(i, t), i.prototype.GetAnchorA = function(t) {
                    return this.m_bodyA.GetWorldPoint(this.m_localAnchorA, t);
                }, i.prototype.GetAnchorB = function(t) {
                    return this.m_bodyB.GetWorldPoint(this.m_localAnchorB, t);
                }, i.prototype.GetReactionForce = function(t, e) {
                    return e.x = t * this.m_impulse * this.m_u.x, e.y = t * this.m_impulse * this.m_u.y, 
                    e;
                }, i.prototype.GetReactionTorque = function() {
                    return 0;
                }, i.prototype.GetLocalAnchorA = function() {
                    return this.m_localAnchorA;
                }, i.prototype.GetLocalAnchorB = function() {
                    return this.m_localAnchorB;
                }, i.prototype.SetLength = function(t) {
                    this.m_length = t;
                }, i.prototype.Length = function() {
                    return this.m_length;
                }, i.prototype.SetFrequency = function(t) {
                    this.m_frequencyHz = t;
                }, i.prototype.GetFrequency = function() {
                    return this.m_frequencyHz;
                }, i.prototype.SetDampingRatio = function(t) {
                    this.m_dampingRatio = t;
                }, i.prototype.GetDampingRatio = function() {
                    return this.m_dampingRatio;
                }, i.prototype.Dump = function(t) {
                    var e = this.m_bodyA.m_islandIndex, i = this.m_bodyB.m_islandIndex;
                    t("  const jd: b2DistanceJointDef = new b2DistanceJointDef();\n"), t("  jd.bodyA = bodies[%d];\n", e), 
                    t("  jd.bodyB = bodies[%d];\n", i), t("  jd.collideConnected = %s;\n", this.m_collideConnected ? "true" : "false"), 
                    t("  jd.localAnchorA.Set(%.15f, %.15f);\n", this.m_localAnchorA.x, this.m_localAnchorA.y), 
                    t("  jd.localAnchorB.Set(%.15f, %.15f);\n", this.m_localAnchorB.x, this.m_localAnchorB.y), 
                    t("  jd.length = %.15f;\n", this.m_length), t("  jd.frequencyHz = %.15f;\n", this.m_frequencyHz), 
                    t("  jd.dampingRatio = %.15f;\n", this.m_dampingRatio), t("  joints[%d] = this.m_world.CreateJoint(jd);\n", this.m_index);
                }, i.prototype.InitVelocityConstraints = function(t) {
                    this.m_indexA = this.m_bodyA.m_islandIndex, this.m_indexB = this.m_bodyB.m_islandIndex, 
                    this.m_localCenterA.Copy(this.m_bodyA.m_sweep.localCenter), this.m_localCenterB.Copy(this.m_bodyB.m_sweep.localCenter), 
                    this.m_invMassA = this.m_bodyA.m_invMass, this.m_invMassB = this.m_bodyB.m_invMass, 
                    this.m_invIA = this.m_bodyA.m_invI, this.m_invIB = this.m_bodyB.m_invI;
                    var e = t.positions[this.m_indexA].c, n = t.positions[this.m_indexA].a, r = t.velocities[this.m_indexA].v, o = t.velocities[this.m_indexA].w, a = t.positions[this.m_indexB].c, l = t.positions[this.m_indexB].a, u = t.velocities[this.m_indexB].v, h = t.velocities[this.m_indexB].w, _ = this.m_qA.SetAngle(n), f = this.m_qB.SetAngle(l);
                    P.SubVV(this.m_localAnchorA, this.m_localCenterA, this.m_lalcA), O.MulRV(_, this.m_lalcA, this.m_rA), 
                    P.SubVV(this.m_localAnchorB, this.m_localCenterB, this.m_lalcB), O.MulRV(f, this.m_lalcB, this.m_rB), 
                    this.m_u.x = a.x + this.m_rB.x - e.x - this.m_rA.x, this.m_u.y = a.y + this.m_rB.y - e.y - this.m_rA.y;
                    var d = this.m_u.Length();
                    d > c ? this.m_u.SelfMul(1 / d) : this.m_u.SetZero();
                    var p = P.CrossVV(this.m_rA, this.m_u), m = P.CrossVV(this.m_rB, this.m_u), v = this.m_invMassA + this.m_invIA * p * p + this.m_invMassB + this.m_invIB * m * m;
                    if (this.m_mass = 0 !== v ? 1 / v : 0, this.m_frequencyHz > 0) {
                        var y = d - this.m_length, g = 2 * s * this.m_frequencyHz, x = 2 * this.m_mass * this.m_dampingRatio * g, A = this.m_mass * g * g, C = t.step.dt;
                        this.m_gamma = C * (x + C * A), this.m_gamma = 0 !== this.m_gamma ? 1 / this.m_gamma : 0, 
                        this.m_bias = y * C * A * this.m_gamma, v += this.m_gamma, this.m_mass = 0 !== v ? 1 / v : 0;
                    } else this.m_gamma = 0, this.m_bias = 0;
                    if (t.step.warmStarting) {
                        this.m_impulse *= t.step.dtRatio;
                        var b = P.MulSV(this.m_impulse, this.m_u, i.InitVelocityConstraints_s_P);
                        r.SelfMulSub(this.m_invMassA, b), o -= this.m_invIA * P.CrossVV(this.m_rA, b), u.SelfMulAdd(this.m_invMassB, b), 
                        h += this.m_invIB * P.CrossVV(this.m_rB, b);
                    } else this.m_impulse = 0;
                    t.velocities[this.m_indexA].w = o, t.velocities[this.m_indexB].w = h;
                }, i.prototype.SolveVelocityConstraints = function(t) {
                    var e = t.velocities[this.m_indexA].v, n = t.velocities[this.m_indexA].w, r = t.velocities[this.m_indexB].v, s = t.velocities[this.m_indexB].w, o = P.AddVCrossSV(e, n, this.m_rA, i.SolveVelocityConstraints_s_vpA), a = P.AddVCrossSV(r, s, this.m_rB, i.SolveVelocityConstraints_s_vpB), c = P.DotVV(this.m_u, P.SubVV(a, o, P.s_t0)), l = -this.m_mass * (c + this.m_bias + this.m_gamma * this.m_impulse);
                    this.m_impulse += l;
                    var u = P.MulSV(l, this.m_u, i.SolveVelocityConstraints_s_P);
                    e.SelfMulSub(this.m_invMassA, u), n -= this.m_invIA * P.CrossVV(this.m_rA, u), r.SelfMulAdd(this.m_invMassB, u), 
                    s += this.m_invIB * P.CrossVV(this.m_rB, u), t.velocities[this.m_indexA].w = n, 
                    t.velocities[this.m_indexB].w = s;
                }, i.prototype.SolvePositionConstraints = function(t) {
                    if (this.m_frequencyHz > 0) return !0;
                    var e = t.positions[this.m_indexA].c, n = t.positions[this.m_indexA].a, r = t.positions[this.m_indexB].c, s = t.positions[this.m_indexB].a, o = this.m_qA.SetAngle(n), a = this.m_qB.SetAngle(s), l = O.MulRV(o, this.m_lalcA, this.m_rA), u = O.MulRV(a, this.m_lalcB, this.m_rB), h = this.m_u;
                    h.x = r.x + u.x - e.x - l.x, h.y = r.y + u.y - e.y - l.y;
                    var _ = this.m_u.Normalize() - this.m_length;
                    _ = g(_, -.2, .2);
                    var f = -this.m_mass * _, d = P.MulSV(f, h, i.SolvePositionConstraints_s_P);
                    return e.SelfMulSub(this.m_invMassA, d), n -= this.m_invIA * P.CrossVV(l, d), r.SelfMulAdd(this.m_invMassB, d), 
                    s += this.m_invIB * P.CrossVV(u, d), t.positions[this.m_indexA].a = n, t.positions[this.m_indexB].a = s, 
                    m(_) < c;
                }, i.InitVelocityConstraints_s_P = new P(), i.SolveVelocityConstraints_s_vpA = new P(), 
                i.SolveVelocityConstraints_s_vpB = new P(), i.SolveVelocityConstraints_s_P = new P(), 
                i.SolvePositionConstraints_s_P = new P(), i;
            }(mi), gi = function(e) {
                function i() {
                    var i = e.call(this, t.b2JointType.e_areaJoint) || this;
                    return i.bodies = [], i.frequencyHz = 0, i.dampingRatio = 0, i;
                }
                return ti(i, e), i.prototype.AddBody = function(t) {
                    this.bodies.push(t), 1 === this.bodies.length ? this.bodyA = t : 2 === this.bodies.length && (this.bodyB = t);
                }, i;
            }(pi), xi = function(t) {
                function i(i) {
                    var n = t.call(this, i) || this;
                    n.m_frequencyHz = 0, n.m_dampingRatio = 0, n.m_impulse = 0, n.m_targetArea = 0, 
                    n.m_bodies = i.bodies, n.m_frequencyHz = e(i.frequencyHz, 0), n.m_dampingRatio = e(i.dampingRatio, 0), 
                    n.m_targetLengths = p(i.bodies.length), n.m_normals = P.MakeArray(i.bodies.length), 
                    n.m_joints = [], n.m_deltas = P.MakeArray(i.bodies.length), n.m_delta = new P();
                    var r = new vi();
                    r.frequencyHz = n.m_frequencyHz, r.dampingRatio = n.m_dampingRatio, n.m_targetArea = 0;
                    for (var s = 0; s < n.m_bodies.length; ++s) {
                        var o = n.m_bodies[s], a = n.m_bodies[(s + 1) % n.m_bodies.length], c = o.GetWorldCenter(), l = a.GetWorldCenter();
                        n.m_targetLengths[s] = P.DistanceVV(c, l), n.m_targetArea += P.CrossVV(c, l), r.Initialize(o, a, c, l), 
                        n.m_joints[s] = o.GetWorld().CreateJoint(r);
                    }
                    return n.m_targetArea *= .5, n;
                }
                return ti(i, t), i.prototype.GetAnchorA = function(t) {
                    return t;
                }, i.prototype.GetAnchorB = function(t) {
                    return t;
                }, i.prototype.GetReactionForce = function(t, e) {
                    return e;
                }, i.prototype.GetReactionTorque = function() {
                    return 0;
                }, i.prototype.SetFrequency = function(t) {
                    this.m_frequencyHz = t;
                    for (var e = 0; e < this.m_joints.length; ++e) this.m_joints[e].SetFrequency(t);
                }, i.prototype.GetFrequency = function() {
                    return this.m_frequencyHz;
                }, i.prototype.SetDampingRatio = function(t) {
                    this.m_dampingRatio = t;
                    for (var e = 0; e < this.m_joints.length; ++e) this.m_joints[e].SetDampingRatio(t);
                }, i.prototype.GetDampingRatio = function() {
                    return this.m_dampingRatio;
                }, i.prototype.Dump = function(t) {
                    t("Area joint dumping is not supported.\n");
                }, i.prototype.InitVelocityConstraints = function(t) {
                    for (var e = 0; e < this.m_bodies.length; ++e) {
                        var i = this.m_bodies[(e + this.m_bodies.length - 1) % this.m_bodies.length], n = this.m_bodies[(e + 1) % this.m_bodies.length], r = t.positions[i.m_islandIndex].c, s = t.positions[n.m_islandIndex].c, o = this.m_deltas[e];
                        P.SubVV(s, r, o);
                    }
                    if (t.step.warmStarting) for (this.m_impulse *= t.step.dtRatio, e = 0; e < this.m_bodies.length; ++e) {
                        var a = this.m_bodies[e], c = t.velocities[a.m_islandIndex].v;
                        o = this.m_deltas[e], c.x += a.m_invMass * o.y * .5 * this.m_impulse, c.y += a.m_invMass * -o.x * .5 * this.m_impulse;
                    } else this.m_impulse = 0;
                }, i.prototype.SolveVelocityConstraints = function(t) {
                    for (var e = 0, i = 0, n = 0; n < this.m_bodies.length; ++n) {
                        var r = this.m_bodies[n], s = t.velocities[r.m_islandIndex].v;
                        e += (a = this.m_deltas[n]).LengthSquared() / r.GetMass(), i += P.CrossVV(s, a);
                    }
                    var o = -2 * i / e;
                    for (this.m_impulse += o, n = 0; n < this.m_bodies.length; ++n) {
                        r = this.m_bodies[n], s = t.velocities[r.m_islandIndex].v;
                        var a = this.m_deltas[n];
                        s.x += r.m_invMass * a.y * .5 * o, s.y += r.m_invMass * -a.x * .5 * o;
                    }
                }, i.prototype.SolvePositionConstraints = function(t) {
                    for (var e = 0, i = 0, r = 0; r < this.m_bodies.length; ++r) {
                        var s = this.m_bodies[r], o = this.m_bodies[(r + 1) % this.m_bodies.length], a = t.positions[s.m_islandIndex].c, l = t.positions[o.m_islandIndex].c, u = (f = P.SubVV(l, a, this.m_delta)).Length();
                        u < n && (u = 1), this.m_normals[r].x = f.y / u, this.m_normals[r].y = -f.x / u, 
                        e += u, i += P.CrossVV(a, l);
                    }
                    i *= .5;
                    var h = .5 * (this.m_targetArea - i) / e, _ = !0;
                    for (r = 0; r < this.m_bodies.length; ++r) {
                        s = this.m_bodies[r], a = t.positions[s.m_islandIndex].c;
                        var f, d = (r + 1) % this.m_bodies.length;
                        (f = P.AddVV(this.m_normals[r], this.m_normals[d], this.m_delta)).SelfMul(h);
                        var p = f.LengthSquared();
                        p > A(.2) && f.SelfMul(.2 / S(p)), p > A(c) && (_ = !1), a.x += f.x, a.y += f.y;
                    }
                    return _;
                }, i;
            }(mi), Ai = function(e) {
                function i() {
                    var i = e.call(this, t.b2JointType.e_frictionJoint) || this;
                    return i.localAnchorA = new P(), i.localAnchorB = new P(), i.maxForce = 0, i.maxTorque = 0, 
                    i;
                }
                return ti(i, e), i.prototype.Initialize = function(t, e, i) {
                    this.bodyA = t, this.bodyB = e, this.bodyA.GetLocalPoint(i, this.localAnchorA), 
                    this.bodyB.GetLocalPoint(i, this.localAnchorB);
                }, i;
            }(pi), Ci = function(t) {
                function i(i) {
                    var n = t.call(this, i) || this;
                    return n.m_localAnchorA = new P(), n.m_localAnchorB = new P(), n.m_linearImpulse = new P(), 
                    n.m_angularImpulse = 0, n.m_maxForce = 0, n.m_maxTorque = 0, n.m_indexA = 0, n.m_indexB = 0, 
                    n.m_rA = new P(), n.m_rB = new P(), n.m_localCenterA = new P(), n.m_localCenterB = new P(), 
                    n.m_invMassA = 0, n.m_invMassB = 0, n.m_invIA = 0, n.m_invIB = 0, n.m_linearMass = new V(), 
                    n.m_angularMass = 0, n.m_qA = new O(), n.m_qB = new O(), n.m_lalcA = new P(), n.m_lalcB = new P(), 
                    n.m_K = new V(), n.m_localAnchorA.Copy(i.localAnchorA), n.m_localAnchorB.Copy(i.localAnchorB), 
                    n.m_linearImpulse.SetZero(), n.m_maxForce = e(i.maxForce, 0), n.m_maxTorque = e(i.maxTorque, 0), 
                    n.m_linearMass.SetZero(), n;
                }
                return ti(i, t), i.prototype.InitVelocityConstraints = function(t) {
                    this.m_indexA = this.m_bodyA.m_islandIndex, this.m_indexB = this.m_bodyB.m_islandIndex, 
                    this.m_localCenterA.Copy(this.m_bodyA.m_sweep.localCenter), this.m_localCenterB.Copy(this.m_bodyB.m_sweep.localCenter), 
                    this.m_invMassA = this.m_bodyA.m_invMass, this.m_invMassB = this.m_bodyB.m_invMass, 
                    this.m_invIA = this.m_bodyA.m_invI, this.m_invIB = this.m_bodyB.m_invI;
                    var e = t.positions[this.m_indexA].a, i = t.velocities[this.m_indexA].v, n = t.velocities[this.m_indexA].w, r = t.positions[this.m_indexB].a, s = t.velocities[this.m_indexB].v, o = t.velocities[this.m_indexB].w, a = this.m_qA.SetAngle(e), c = this.m_qB.SetAngle(r);
                    P.SubVV(this.m_localAnchorA, this.m_localCenterA, this.m_lalcA);
                    var l = O.MulRV(a, this.m_lalcA, this.m_rA);
                    P.SubVV(this.m_localAnchorB, this.m_localCenterB, this.m_lalcB);
                    var u = O.MulRV(c, this.m_lalcB, this.m_rB), h = this.m_invMassA, _ = this.m_invMassB, f = this.m_invIA, d = this.m_invIB, p = this.m_K;
                    if (p.ex.x = h + _ + f * l.y * l.y + d * u.y * u.y, p.ex.y = -f * l.x * l.y - d * u.x * u.y, 
                    p.ey.x = p.ex.y, p.ey.y = h + _ + f * l.x * l.x + d * u.x * u.x, p.GetInverse(this.m_linearMass), 
                    this.m_angularMass = f + d, this.m_angularMass > 0 && (this.m_angularMass = 1 / this.m_angularMass), 
                    t.step.warmStarting) {
                        this.m_linearImpulse.SelfMul(t.step.dtRatio), this.m_angularImpulse *= t.step.dtRatio;
                        var m = this.m_linearImpulse;
                        i.SelfMulSub(h, m), n -= f * (P.CrossVV(this.m_rA, m) + this.m_angularImpulse), 
                        s.SelfMulAdd(_, m), o += d * (P.CrossVV(this.m_rB, m) + this.m_angularImpulse);
                    } else this.m_linearImpulse.SetZero(), this.m_angularImpulse = 0;
                    t.velocities[this.m_indexA].w = n, t.velocities[this.m_indexB].w = o;
                }, i.prototype.SolveVelocityConstraints = function(t) {
                    var e = t.velocities[this.m_indexA].v, n = t.velocities[this.m_indexA].w, r = t.velocities[this.m_indexB].v, s = t.velocities[this.m_indexB].w, o = this.m_invMassA, a = this.m_invMassB, c = this.m_invIA, l = this.m_invIB, u = t.step.dt, h = s - n, _ = -this.m_angularMass * h, f = this.m_angularImpulse, d = u * this.m_maxTorque;
                    this.m_angularImpulse = g(this.m_angularImpulse + _, -d, d), n -= c * (_ = this.m_angularImpulse - f), 
                    s += l * _;
                    var p = P.SubVV(P.AddVCrossSV(r, s, this.m_rB, P.s_t0), P.AddVCrossSV(e, n, this.m_rA, P.s_t1), i.SolveVelocityConstraints_s_Cdot_v2), m = V.MulMV(this.m_linearMass, p, i.SolveVelocityConstraints_s_impulseV).SelfNeg(), v = i.SolveVelocityConstraints_s_oldImpulseV.Copy(this.m_linearImpulse);
                    this.m_linearImpulse.SelfAdd(m), d = u * this.m_maxForce, this.m_linearImpulse.LengthSquared() > d * d && (this.m_linearImpulse.Normalize(), 
                    this.m_linearImpulse.SelfMul(d)), P.SubVV(this.m_linearImpulse, v, m), e.SelfMulSub(o, m), 
                    n -= c * P.CrossVV(this.m_rA, m), r.SelfMulAdd(a, m), s += l * P.CrossVV(this.m_rB, m), 
                    t.velocities[this.m_indexA].w = n, t.velocities[this.m_indexB].w = s;
                }, i.prototype.SolvePositionConstraints = function() {
                    return !0;
                }, i.prototype.GetAnchorA = function(t) {
                    return this.m_bodyA.GetWorldPoint(this.m_localAnchorA, t);
                }, i.prototype.GetAnchorB = function(t) {
                    return this.m_bodyB.GetWorldPoint(this.m_localAnchorB, t);
                }, i.prototype.GetReactionForce = function(t, e) {
                    return e.x = t * this.m_linearImpulse.x, e.y = t * this.m_linearImpulse.y, e;
                }, i.prototype.GetReactionTorque = function(t) {
                    return t * this.m_angularImpulse;
                }, i.prototype.GetLocalAnchorA = function() {
                    return this.m_localAnchorA;
                }, i.prototype.GetLocalAnchorB = function() {
                    return this.m_localAnchorB;
                }, i.prototype.SetMaxForce = function(t) {
                    this.m_maxForce = t;
                }, i.prototype.GetMaxForce = function() {
                    return this.m_maxForce;
                }, i.prototype.SetMaxTorque = function(t) {
                    this.m_maxTorque = t;
                }, i.prototype.GetMaxTorque = function() {
                    return this.m_maxTorque;
                }, i.prototype.Dump = function(t) {
                    var e = this.m_bodyA.m_islandIndex, i = this.m_bodyB.m_islandIndex;
                    t("  const jd: b2FrictionJointDef = new b2FrictionJointDef();\n"), t("  jd.bodyA = bodies[%d];\n", e), 
                    t("  jd.bodyB = bodies[%d];\n", i), t("  jd.collideConnected = %s;\n", this.m_collideConnected ? "true" : "false"), 
                    t("  jd.localAnchorA.Set(%.15f, %.15f);\n", this.m_localAnchorA.x, this.m_localAnchorA.y), 
                    t("  jd.localAnchorB.Set(%.15f, %.15f);\n", this.m_localAnchorB.x, this.m_localAnchorB.y), 
                    t("  jd.maxForce = %.15f;\n", this.m_maxForce), t("  jd.maxTorque = %.15f;\n", this.m_maxTorque), 
                    t("  joints[%d] = this.m_world.CreateJoint(jd);\n", this.m_index);
                }, i.SolveVelocityConstraints_s_Cdot_v2 = new P(), i.SolveVelocityConstraints_s_impulseV = new P(), 
                i.SolveVelocityConstraints_s_oldImpulseV = new P(), i;
            }(mi), bi = function(e) {
                function i() {
                    var i = e.call(this, t.b2JointType.e_gearJoint) || this;
                    return i.ratio = 1, i;
                }
                return ti(i, e), i;
            }(pi), Si = function(i) {
                function n(n) {
                    var r, s, o = i.call(this, n) || this;
                    o.m_typeA = t.b2JointType.e_unknownJoint, o.m_typeB = t.b2JointType.e_unknownJoint, 
                    o.m_localAnchorA = new P(), o.m_localAnchorB = new P(), o.m_localAnchorC = new P(), 
                    o.m_localAnchorD = new P(), o.m_localAxisC = new P(), o.m_localAxisD = new P(), 
                    o.m_referenceAngleA = 0, o.m_referenceAngleB = 0, o.m_constant = 0, o.m_ratio = 0, 
                    o.m_impulse = 0, o.m_indexA = 0, o.m_indexB = 0, o.m_indexC = 0, o.m_indexD = 0, 
                    o.m_lcA = new P(), o.m_lcB = new P(), o.m_lcC = new P(), o.m_lcD = new P(), o.m_mA = 0, 
                    o.m_mB = 0, o.m_mC = 0, o.m_mD = 0, o.m_iA = 0, o.m_iB = 0, o.m_iC = 0, o.m_iD = 0, 
                    o.m_JvAC = new P(), o.m_JvBD = new P(), o.m_JwA = 0, o.m_JwB = 0, o.m_JwC = 0, o.m_JwD = 0, 
                    o.m_mass = 0, o.m_qA = new O(), o.m_qB = new O(), o.m_qC = new O(), o.m_qD = new O(), 
                    o.m_lalcA = new P(), o.m_lalcB = new P(), o.m_lalcC = new P(), o.m_lalcD = new P(), 
                    o.m_joint1 = n.joint1, o.m_joint2 = n.joint2, o.m_typeA = o.m_joint1.GetType(), 
                    o.m_typeB = o.m_joint2.GetType(), o.m_bodyC = o.m_joint1.GetBodyA(), o.m_bodyA = o.m_joint1.GetBodyB();
                    var a = o.m_bodyA.m_xf, c = o.m_bodyA.m_sweep.a, l = o.m_bodyC.m_xf, u = o.m_bodyC.m_sweep.a;
                    if (o.m_typeA === t.b2JointType.e_revoluteJoint) {
                        var h = n.joint1;
                        o.m_localAnchorC.Copy(h.m_localAnchorA), o.m_localAnchorA.Copy(h.m_localAnchorB), 
                        o.m_referenceAngleA = h.m_referenceAngle, o.m_localAxisC.SetZero(), r = c - u - o.m_referenceAngleA;
                    } else {
                        var _ = n.joint1;
                        o.m_localAnchorC.Copy(_.m_localAnchorA), o.m_localAnchorA.Copy(_.m_localAnchorB), 
                        o.m_referenceAngleA = _.m_referenceAngle, o.m_localAxisC.Copy(_.m_localXAxisA);
                        var f = o.m_localAnchorC, d = O.MulTRV(l.q, P.AddVV(O.MulRV(a.q, o.m_localAnchorA, P.s_t0), P.SubVV(a.p, l.p, P.s_t1), P.s_t0), P.s_t0);
                        r = P.DotVV(P.SubVV(d, f, P.s_t0), o.m_localAxisC);
                    }
                    o.m_bodyD = o.m_joint2.GetBodyA(), o.m_bodyB = o.m_joint2.GetBodyB();
                    var p = o.m_bodyB.m_xf, m = o.m_bodyB.m_sweep.a, v = o.m_bodyD.m_xf, y = o.m_bodyD.m_sweep.a;
                    if (o.m_typeB === t.b2JointType.e_revoluteJoint) h = n.joint2, o.m_localAnchorD.Copy(h.m_localAnchorA), 
                    o.m_localAnchorB.Copy(h.m_localAnchorB), o.m_referenceAngleB = h.m_referenceAngle, 
                    o.m_localAxisD.SetZero(), s = m - y - o.m_referenceAngleB; else {
                        _ = n.joint2, o.m_localAnchorD.Copy(_.m_localAnchorA), o.m_localAnchorB.Copy(_.m_localAnchorB), 
                        o.m_referenceAngleB = _.m_referenceAngle, o.m_localAxisD.Copy(_.m_localXAxisA);
                        var g = o.m_localAnchorD, x = O.MulTRV(v.q, P.AddVV(O.MulRV(p.q, o.m_localAnchorB, P.s_t0), P.SubVV(p.p, v.p, P.s_t1), P.s_t0), P.s_t0);
                        s = P.DotVV(P.SubVV(x, g, P.s_t0), o.m_localAxisD);
                    }
                    return o.m_ratio = e(n.ratio, 1), o.m_constant = r + o.m_ratio * s, o.m_impulse = 0, 
                    o;
                }
                return ti(n, i), n.prototype.InitVelocityConstraints = function(e) {
                    this.m_indexA = this.m_bodyA.m_islandIndex, this.m_indexB = this.m_bodyB.m_islandIndex, 
                    this.m_indexC = this.m_bodyC.m_islandIndex, this.m_indexD = this.m_bodyD.m_islandIndex, 
                    this.m_lcA.Copy(this.m_bodyA.m_sweep.localCenter), this.m_lcB.Copy(this.m_bodyB.m_sweep.localCenter), 
                    this.m_lcC.Copy(this.m_bodyC.m_sweep.localCenter), this.m_lcD.Copy(this.m_bodyD.m_sweep.localCenter), 
                    this.m_mA = this.m_bodyA.m_invMass, this.m_mB = this.m_bodyB.m_invMass, this.m_mC = this.m_bodyC.m_invMass, 
                    this.m_mD = this.m_bodyD.m_invMass, this.m_iA = this.m_bodyA.m_invI, this.m_iB = this.m_bodyB.m_invI, 
                    this.m_iC = this.m_bodyC.m_invI, this.m_iD = this.m_bodyD.m_invI;
                    var i = e.positions[this.m_indexA].a, r = e.velocities[this.m_indexA].v, s = e.velocities[this.m_indexA].w, o = e.positions[this.m_indexB].a, a = e.velocities[this.m_indexB].v, c = e.velocities[this.m_indexB].w, l = e.positions[this.m_indexC].a, u = e.velocities[this.m_indexC].v, h = e.velocities[this.m_indexC].w, _ = e.positions[this.m_indexD].a, f = e.velocities[this.m_indexD].v, d = e.velocities[this.m_indexD].w, p = this.m_qA.SetAngle(i), m = this.m_qB.SetAngle(o), v = this.m_qC.SetAngle(l), y = this.m_qD.SetAngle(_);
                    if (this.m_mass = 0, this.m_typeA === t.b2JointType.e_revoluteJoint) this.m_JvAC.SetZero(), 
                    this.m_JwA = 1, this.m_JwC = 1, this.m_mass += this.m_iA + this.m_iC; else {
                        var g = O.MulRV(v, this.m_localAxisC, n.InitVelocityConstraints_s_u);
                        P.SubVV(this.m_localAnchorC, this.m_lcC, this.m_lalcC);
                        var x = O.MulRV(v, this.m_lalcC, n.InitVelocityConstraints_s_rC);
                        P.SubVV(this.m_localAnchorA, this.m_lcA, this.m_lalcA);
                        var A = O.MulRV(p, this.m_lalcA, n.InitVelocityConstraints_s_rA);
                        this.m_JvAC.Copy(g), this.m_JwC = P.CrossVV(x, g), this.m_JwA = P.CrossVV(A, g), 
                        this.m_mass += this.m_mC + this.m_mA + this.m_iC * this.m_JwC * this.m_JwC + this.m_iA * this.m_JwA * this.m_JwA;
                    }
                    if (this.m_typeB === t.b2JointType.e_revoluteJoint) this.m_JvBD.SetZero(), this.m_JwB = this.m_ratio, 
                    this.m_JwD = this.m_ratio, this.m_mass += this.m_ratio * this.m_ratio * (this.m_iB + this.m_iD); else {
                        g = O.MulRV(y, this.m_localAxisD, n.InitVelocityConstraints_s_u), P.SubVV(this.m_localAnchorD, this.m_lcD, this.m_lalcD);
                        var C = O.MulRV(y, this.m_lalcD, n.InitVelocityConstraints_s_rD);
                        P.SubVV(this.m_localAnchorB, this.m_lcB, this.m_lalcB);
                        var b = O.MulRV(m, this.m_lalcB, n.InitVelocityConstraints_s_rB);
                        P.MulSV(this.m_ratio, g, this.m_JvBD), this.m_JwD = this.m_ratio * P.CrossVV(C, g), 
                        this.m_JwB = this.m_ratio * P.CrossVV(b, g), this.m_mass += this.m_ratio * this.m_ratio * (this.m_mD + this.m_mB) + this.m_iD * this.m_JwD * this.m_JwD + this.m_iB * this.m_JwB * this.m_JwB;
                    }
                    this.m_mass = this.m_mass > 0 ? 1 / this.m_mass : 0, e.step.warmStarting ? (r.SelfMulAdd(this.m_mA * this.m_impulse, this.m_JvAC), 
                    s += this.m_iA * this.m_impulse * this.m_JwA, a.SelfMulAdd(this.m_mB * this.m_impulse, this.m_JvBD), 
                    c += this.m_iB * this.m_impulse * this.m_JwB, u.SelfMulSub(this.m_mC * this.m_impulse, this.m_JvAC), 
                    h -= this.m_iC * this.m_impulse * this.m_JwC, f.SelfMulSub(this.m_mD * this.m_impulse, this.m_JvBD), 
                    d -= this.m_iD * this.m_impulse * this.m_JwD) : this.m_impulse = 0, e.velocities[this.m_indexA].w = s, 
                    e.velocities[this.m_indexB].w = c, e.velocities[this.m_indexC].w = h, e.velocities[this.m_indexD].w = d;
                }, n.prototype.SolveVelocityConstraints = function(t) {
                    var e = t.velocities[this.m_indexA].v, i = t.velocities[this.m_indexA].w, n = t.velocities[this.m_indexB].v, r = t.velocities[this.m_indexB].w, s = t.velocities[this.m_indexC].v, o = t.velocities[this.m_indexC].w, a = t.velocities[this.m_indexD].v, c = t.velocities[this.m_indexD].w, l = P.DotVV(this.m_JvAC, P.SubVV(e, s, P.s_t0)) + P.DotVV(this.m_JvBD, P.SubVV(n, a, P.s_t0));
                    l += this.m_JwA * i - this.m_JwC * o + (this.m_JwB * r - this.m_JwD * c);
                    var u = -this.m_mass * l;
                    this.m_impulse += u, e.SelfMulAdd(this.m_mA * u, this.m_JvAC), i += this.m_iA * u * this.m_JwA, 
                    n.SelfMulAdd(this.m_mB * u, this.m_JvBD), r += this.m_iB * u * this.m_JwB, s.SelfMulSub(this.m_mC * u, this.m_JvAC), 
                    o -= this.m_iC * u * this.m_JwC, a.SelfMulSub(this.m_mD * u, this.m_JvBD), c -= this.m_iD * u * this.m_JwD, 
                    t.velocities[this.m_indexA].w = i, t.velocities[this.m_indexB].w = r, t.velocities[this.m_indexC].w = o, 
                    t.velocities[this.m_indexD].w = c;
                }, n.prototype.SolvePositionConstraints = function(e) {
                    var i, r, s, o, a, l, u = e.positions[this.m_indexA].c, h = e.positions[this.m_indexA].a, _ = e.positions[this.m_indexB].c, f = e.positions[this.m_indexB].a, d = e.positions[this.m_indexC].c, p = e.positions[this.m_indexC].a, m = e.positions[this.m_indexD].c, v = e.positions[this.m_indexD].a, y = this.m_qA.SetAngle(h), g = this.m_qB.SetAngle(f), x = this.m_qC.SetAngle(p), A = this.m_qD.SetAngle(v), C = this.m_JvAC, b = this.m_JvBD, S = 0;
                    if (this.m_typeA === t.b2JointType.e_revoluteJoint) C.SetZero(), s = 1, a = 1, S += this.m_iA + this.m_iC, 
                    i = h - p - this.m_referenceAngleA; else {
                        var T = O.MulRV(x, this.m_localAxisC, n.SolvePositionConstraints_s_u), w = O.MulRV(x, this.m_lalcC, n.SolvePositionConstraints_s_rC), E = O.MulRV(y, this.m_lalcA, n.SolvePositionConstraints_s_rA);
                        C.Copy(T), a = P.CrossVV(w, T), s = P.CrossVV(E, T), S += this.m_mC + this.m_mA + this.m_iC * a * a + this.m_iA * s * s;
                        var B = this.m_lalcC, M = O.MulTRV(x, P.AddVV(E, P.SubVV(u, d, P.s_t0), P.s_t0), P.s_t0);
                        i = P.DotVV(P.SubVV(M, B, P.s_t0), this.m_localAxisC);
                    }
                    if (this.m_typeB === t.b2JointType.e_revoluteJoint) b.SetZero(), o = this.m_ratio, 
                    l = this.m_ratio, S += this.m_ratio * this.m_ratio * (this.m_iB + this.m_iD), r = f - v - this.m_referenceAngleB; else {
                        T = O.MulRV(A, this.m_localAxisD, n.SolvePositionConstraints_s_u);
                        var R = O.MulRV(A, this.m_lalcD, n.SolvePositionConstraints_s_rD), I = O.MulRV(g, this.m_lalcB, n.SolvePositionConstraints_s_rB);
                        P.MulSV(this.m_ratio, T, b), l = this.m_ratio * P.CrossVV(R, T), o = this.m_ratio * P.CrossVV(I, T), 
                        S += this.m_ratio * this.m_ratio * (this.m_mD + this.m_mB) + this.m_iD * l * l + this.m_iB * o * o;
                        var D = this.m_lalcD, V = O.MulTRV(A, P.AddVV(I, P.SubVV(_, m, P.s_t0), P.s_t0), P.s_t0);
                        r = P.DotVV(P.SubVV(V, D, P.s_t0), this.m_localAxisD);
                    }
                    var L = i + this.m_ratio * r - this.m_constant, F = 0;
                    return S > 0 && (F = -L / S), u.SelfMulAdd(this.m_mA * F, C), h += this.m_iA * F * s, 
                    _.SelfMulAdd(this.m_mB * F, b), f += this.m_iB * F * o, d.SelfMulSub(this.m_mC * F, C), 
                    p -= this.m_iC * F * a, m.SelfMulSub(this.m_mD * F, b), v -= this.m_iD * F * l, 
                    e.positions[this.m_indexA].a = h, e.positions[this.m_indexB].a = f, e.positions[this.m_indexC].a = p, 
                    e.positions[this.m_indexD].a = v, 0 < c;
                }, n.prototype.GetAnchorA = function(t) {
                    return this.m_bodyA.GetWorldPoint(this.m_localAnchorA, t);
                }, n.prototype.GetAnchorB = function(t) {
                    return this.m_bodyB.GetWorldPoint(this.m_localAnchorB, t);
                }, n.prototype.GetReactionForce = function(t, e) {
                    return P.MulSV(t * this.m_impulse, this.m_JvAC, e);
                }, n.prototype.GetReactionTorque = function(t) {
                    return t * this.m_impulse * this.m_JwA;
                }, n.prototype.GetJoint1 = function() {
                    return this.m_joint1;
                }, n.prototype.GetJoint2 = function() {
                    return this.m_joint2;
                }, n.prototype.GetRatio = function() {
                    return this.m_ratio;
                }, n.prototype.SetRatio = function(t) {
                    this.m_ratio = t;
                }, n.prototype.Dump = function(t) {
                    var e = this.m_bodyA.m_islandIndex, i = this.m_bodyB.m_islandIndex, n = this.m_joint1.m_index, r = this.m_joint2.m_index;
                    t("  const jd: b2GearJointDef = new b2GearJointDef();\n"), t("  jd.bodyA = bodies[%d];\n", e), 
                    t("  jd.bodyB = bodies[%d];\n", i), t("  jd.collideConnected = %s;\n", this.m_collideConnected ? "true" : "false"), 
                    t("  jd.joint1 = joints[%d];\n", n), t("  jd.joint2 = joints[%d];\n", r), t("  jd.ratio = %.15f;\n", this.m_ratio), 
                    t("  joints[%d] = this.m_world.CreateJoint(jd);\n", this.m_index);
                }, n.InitVelocityConstraints_s_u = new P(), n.InitVelocityConstraints_s_rA = new P(), 
                n.InitVelocityConstraints_s_rB = new P(), n.InitVelocityConstraints_s_rC = new P(), 
                n.InitVelocityConstraints_s_rD = new P(), n.SolvePositionConstraints_s_u = new P(), 
                n.SolvePositionConstraints_s_rA = new P(), n.SolvePositionConstraints_s_rB = new P(), 
                n.SolvePositionConstraints_s_rC = new P(), n.SolvePositionConstraints_s_rD = new P(), 
                n;
            }(mi), Ti = function(e) {
                function i() {
                    var i = e.call(this, t.b2JointType.e_motorJoint) || this;
                    return i.linearOffset = new P(0, 0), i.angularOffset = 0, i.maxForce = 1, i.maxTorque = 1, 
                    i.correctionFactor = .3, i;
                }
                return ti(i, e), i.prototype.Initialize = function(t, e) {
                    this.bodyA = t, this.bodyB = e, this.bodyA.GetLocalPoint(this.bodyB.GetPosition(), this.linearOffset);
                    var i = this.bodyA.GetAngle(), n = this.bodyB.GetAngle();
                    this.angularOffset = n - i;
                }, i;
            }(pi), wi = function(t) {
                function i(i) {
                    var n = t.call(this, i) || this;
                    return n.m_linearOffset = new P(), n.m_angularOffset = 0, n.m_linearImpulse = new P(), 
                    n.m_angularImpulse = 0, n.m_maxForce = 0, n.m_maxTorque = 0, n.m_correctionFactor = .3, 
                    n.m_indexA = 0, n.m_indexB = 0, n.m_rA = new P(), n.m_rB = new P(), n.m_localCenterA = new P(), 
                    n.m_localCenterB = new P(), n.m_linearError = new P(), n.m_angularError = 0, n.m_invMassA = 0, 
                    n.m_invMassB = 0, n.m_invIA = 0, n.m_invIB = 0, n.m_linearMass = new V(), n.m_angularMass = 0, 
                    n.m_qA = new O(), n.m_qB = new O(), n.m_K = new V(), n.m_linearOffset.Copy(e(i.linearOffset, P.ZERO)), 
                    n.m_linearImpulse.SetZero(), n.m_maxForce = e(i.maxForce, 0), n.m_maxTorque = e(i.maxTorque, 0), 
                    n.m_correctionFactor = e(i.correctionFactor, .3), n;
                }
                return ti(i, t), i.prototype.GetAnchorA = function(t) {
                    var e = this.m_bodyA.GetPosition();
                    return t.x = e.x, t.y = e.y, t;
                }, i.prototype.GetAnchorB = function(t) {
                    var e = this.m_bodyB.GetPosition();
                    return t.x = e.x, t.y = e.y, t;
                }, i.prototype.GetReactionForce = function(t, e) {
                    return P.MulSV(t, this.m_linearImpulse, e);
                }, i.prototype.GetReactionTorque = function(t) {
                    return t * this.m_angularImpulse;
                }, i.prototype.SetLinearOffset = function(t) {
                    P.IsEqualToV(t, this.m_linearOffset) || (this.m_bodyA.SetAwake(!0), this.m_bodyB.SetAwake(!0), 
                    this.m_linearOffset.Copy(t));
                }, i.prototype.GetLinearOffset = function() {
                    return this.m_linearOffset;
                }, i.prototype.SetAngularOffset = function(t) {
                    t !== this.m_angularOffset && (this.m_bodyA.SetAwake(!0), this.m_bodyB.SetAwake(!0), 
                    this.m_angularOffset = t);
                }, i.prototype.GetAngularOffset = function() {
                    return this.m_angularOffset;
                }, i.prototype.SetMaxForce = function(t) {
                    this.m_maxForce = t;
                }, i.prototype.GetMaxForce = function() {
                    return this.m_maxForce;
                }, i.prototype.SetMaxTorque = function(t) {
                    this.m_maxTorque = t;
                }, i.prototype.GetMaxTorque = function() {
                    return this.m_maxTorque;
                }, i.prototype.InitVelocityConstraints = function(t) {
                    this.m_indexA = this.m_bodyA.m_islandIndex, this.m_indexB = this.m_bodyB.m_islandIndex, 
                    this.m_localCenterA.Copy(this.m_bodyA.m_sweep.localCenter), this.m_localCenterB.Copy(this.m_bodyB.m_sweep.localCenter), 
                    this.m_invMassA = this.m_bodyA.m_invMass, this.m_invMassB = this.m_bodyB.m_invMass, 
                    this.m_invIA = this.m_bodyA.m_invI, this.m_invIB = this.m_bodyB.m_invI;
                    var e = t.positions[this.m_indexA].c, i = t.positions[this.m_indexA].a, n = t.velocities[this.m_indexA].v, r = t.velocities[this.m_indexA].w, s = t.positions[this.m_indexB].c, o = t.positions[this.m_indexB].a, a = t.velocities[this.m_indexB].v, c = t.velocities[this.m_indexB].w, l = this.m_qA.SetAngle(i), u = this.m_qB.SetAngle(o), h = O.MulRV(l, P.SubVV(this.m_linearOffset, this.m_localCenterA, P.s_t0), this.m_rA), _ = O.MulRV(u, P.NegV(this.m_localCenterB, P.s_t0), this.m_rB), f = this.m_invMassA, d = this.m_invMassB, p = this.m_invIA, m = this.m_invIB, v = this.m_K;
                    if (v.ex.x = f + d + p * h.y * h.y + m * _.y * _.y, v.ex.y = -p * h.x * h.y - m * _.x * _.y, 
                    v.ey.x = v.ex.y, v.ey.y = f + d + p * h.x * h.x + m * _.x * _.x, v.GetInverse(this.m_linearMass), 
                    this.m_angularMass = p + m, this.m_angularMass > 0 && (this.m_angularMass = 1 / this.m_angularMass), 
                    P.SubVV(P.AddVV(s, _, P.s_t0), P.AddVV(e, h, P.s_t1), this.m_linearError), this.m_angularError = o - i - this.m_angularOffset, 
                    t.step.warmStarting) {
                        this.m_linearImpulse.SelfMul(t.step.dtRatio), this.m_angularImpulse *= t.step.dtRatio;
                        var y = this.m_linearImpulse;
                        n.SelfMulSub(f, y), r -= p * (P.CrossVV(h, y) + this.m_angularImpulse), a.SelfMulAdd(d, y), 
                        c += m * (P.CrossVV(_, y) + this.m_angularImpulse);
                    } else this.m_linearImpulse.SetZero(), this.m_angularImpulse = 0;
                    t.velocities[this.m_indexA].w = r, t.velocities[this.m_indexB].w = c;
                }, i.prototype.SolveVelocityConstraints = function(t) {
                    var e = t.velocities[this.m_indexA].v, n = t.velocities[this.m_indexA].w, r = t.velocities[this.m_indexB].v, s = t.velocities[this.m_indexB].w, o = this.m_invMassA, a = this.m_invMassB, c = this.m_invIA, l = this.m_invIB, u = t.step.dt, h = t.step.inv_dt, _ = s - n + h * this.m_correctionFactor * this.m_angularError, f = -this.m_angularMass * _, d = this.m_angularImpulse, p = u * this.m_maxTorque;
                    this.m_angularImpulse = g(this.m_angularImpulse + f, -p, p), n -= c * (f = this.m_angularImpulse - d), 
                    s += l * f;
                    var m = this.m_rA, v = this.m_rB, y = P.AddVV(P.SubVV(P.AddVV(r, P.CrossSV(s, v, P.s_t0), P.s_t0), P.AddVV(e, P.CrossSV(n, m, P.s_t1), P.s_t1), P.s_t2), P.MulSV(h * this.m_correctionFactor, this.m_linearError, P.s_t3), i.SolveVelocityConstraints_s_Cdot_v2), x = V.MulMV(this.m_linearMass, y, i.SolveVelocityConstraints_s_impulse_v2).SelfNeg(), A = i.SolveVelocityConstraints_s_oldImpulse_v2.Copy(this.m_linearImpulse);
                    this.m_linearImpulse.SelfAdd(x), p = u * this.m_maxForce, this.m_linearImpulse.LengthSquared() > p * p && (this.m_linearImpulse.Normalize(), 
                    this.m_linearImpulse.SelfMul(p)), P.SubVV(this.m_linearImpulse, A, x), e.SelfMulSub(o, x), 
                    n -= c * P.CrossVV(m, x), r.SelfMulAdd(a, x), s += l * P.CrossVV(v, x), t.velocities[this.m_indexA].w = n, 
                    t.velocities[this.m_indexB].w = s;
                }, i.prototype.SolvePositionConstraints = function() {
                    return !0;
                }, i.prototype.Dump = function(t) {
                    var e = this.m_bodyA.m_islandIndex, i = this.m_bodyB.m_islandIndex;
                    t("  const jd: b2MotorJointDef = new b2MotorJointDef();\n"), t("  jd.bodyA = bodies[%d];\n", e), 
                    t("  jd.bodyB = bodies[%d];\n", i), t("  jd.collideConnected = %s;\n", this.m_collideConnected ? "true" : "false"), 
                    t("  jd.linearOffset.Set(%.15f, %.15f);\n", this.m_linearOffset.x, this.m_linearOffset.y), 
                    t("  jd.angularOffset = %.15f;\n", this.m_angularOffset), t("  jd.maxForce = %.15f;\n", this.m_maxForce), 
                    t("  jd.maxTorque = %.15f;\n", this.m_maxTorque), t("  jd.correctionFactor = %.15f;\n", this.m_correctionFactor), 
                    t("  joints[%d] = this.m_world.CreateJoint(jd);\n", this.m_index);
                }, i.SolveVelocityConstraints_s_Cdot_v2 = new P(), i.SolveVelocityConstraints_s_impulse_v2 = new P(), 
                i.SolveVelocityConstraints_s_oldImpulse_v2 = new P(), i;
            }(mi), Ei = function(e) {
                function i() {
                    var i = e.call(this, t.b2JointType.e_mouseJoint) || this;
                    return i.target = new P(), i.maxForce = 0, i.frequencyHz = 5, i.dampingRatio = .7, 
                    i;
                }
                return ti(i, e), i;
            }(pi), Bi = function(t) {
                function i(i) {
                    var n = t.call(this, i) || this;
                    return n.m_localAnchorB = new P(), n.m_targetA = new P(), n.m_frequencyHz = 0, n.m_dampingRatio = 0, 
                    n.m_beta = 0, n.m_impulse = new P(), n.m_maxForce = 0, n.m_gamma = 0, n.m_indexA = 0, 
                    n.m_indexB = 0, n.m_rB = new P(), n.m_localCenterB = new P(), n.m_invMassB = 0, 
                    n.m_invIB = 0, n.m_mass = new V(), n.m_C = new P(), n.m_qB = new O(), n.m_lalcB = new P(), 
                    n.m_K = new V(), n.m_targetA.Copy(e(i.target, P.ZERO)), F.MulTXV(n.m_bodyB.GetTransform(), n.m_targetA, n.m_localAnchorB), 
                    n.m_maxForce = e(i.maxForce, 0), n.m_impulse.SetZero(), n.m_frequencyHz = e(i.frequencyHz, 0), 
                    n.m_dampingRatio = e(i.dampingRatio, 0), n.m_beta = 0, n.m_gamma = 0, n;
                }
                return ti(i, t), i.prototype.SetTarget = function(t) {
                    this.m_bodyB.IsAwake() || this.m_bodyB.SetAwake(!0), this.m_targetA.Copy(t);
                }, i.prototype.GetTarget = function() {
                    return this.m_targetA;
                }, i.prototype.SetMaxForce = function(t) {
                    this.m_maxForce = t;
                }, i.prototype.GetMaxForce = function() {
                    return this.m_maxForce;
                }, i.prototype.SetFrequency = function(t) {
                    this.m_frequencyHz = t;
                }, i.prototype.GetFrequency = function() {
                    return this.m_frequencyHz;
                }, i.prototype.SetDampingRatio = function(t) {
                    this.m_dampingRatio = t;
                }, i.prototype.GetDampingRatio = function() {
                    return this.m_dampingRatio;
                }, i.prototype.InitVelocityConstraints = function(t) {
                    this.m_indexB = this.m_bodyB.m_islandIndex, this.m_localCenterB.Copy(this.m_bodyB.m_sweep.localCenter), 
                    this.m_invMassB = this.m_bodyB.m_invMass, this.m_invIB = this.m_bodyB.m_invI;
                    var e = t.positions[this.m_indexB].c, i = t.positions[this.m_indexB].a, n = t.velocities[this.m_indexB].v, r = t.velocities[this.m_indexB].w, o = this.m_qB.SetAngle(i), a = this.m_bodyB.GetMass(), c = 2 * s * this.m_frequencyHz, l = 2 * a * this.m_dampingRatio * c, u = a * c * c, h = t.step.dt;
                    this.m_gamma = h * (l + h * u), 0 !== this.m_gamma && (this.m_gamma = 1 / this.m_gamma), 
                    this.m_beta = h * u * this.m_gamma, P.SubVV(this.m_localAnchorB, this.m_localCenterB, this.m_lalcB), 
                    O.MulRV(o, this.m_lalcB, this.m_rB);
                    var _ = this.m_K;
                    _.ex.x = this.m_invMassB + this.m_invIB * this.m_rB.y * this.m_rB.y + this.m_gamma, 
                    _.ex.y = -this.m_invIB * this.m_rB.x * this.m_rB.y, _.ey.x = _.ex.y, _.ey.y = this.m_invMassB + this.m_invIB * this.m_rB.x * this.m_rB.x + this.m_gamma, 
                    _.GetInverse(this.m_mass), this.m_C.x = e.x + this.m_rB.x - this.m_targetA.x, this.m_C.y = e.y + this.m_rB.y - this.m_targetA.y, 
                    this.m_C.SelfMul(this.m_beta), r *= .98, t.step.warmStarting ? (this.m_impulse.SelfMul(t.step.dtRatio), 
                    n.x += this.m_invMassB * this.m_impulse.x, n.y += this.m_invMassB * this.m_impulse.y, 
                    r += this.m_invIB * P.CrossVV(this.m_rB, this.m_impulse)) : this.m_impulse.SetZero(), 
                    t.velocities[this.m_indexB].w = r;
                }, i.prototype.SolveVelocityConstraints = function(t) {
                    var e = t.velocities[this.m_indexB].v, n = t.velocities[this.m_indexB].w, r = P.AddVCrossSV(e, n, this.m_rB, i.SolveVelocityConstraints_s_Cdot), s = V.MulMV(this.m_mass, P.AddVV(r, P.AddVV(this.m_C, P.MulSV(this.m_gamma, this.m_impulse, P.s_t0), P.s_t0), P.s_t0).SelfNeg(), i.SolveVelocityConstraints_s_impulse), o = i.SolveVelocityConstraints_s_oldImpulse.Copy(this.m_impulse);
                    this.m_impulse.SelfAdd(s);
                    var a = t.step.dt * this.m_maxForce;
                    this.m_impulse.LengthSquared() > a * a && this.m_impulse.SelfMul(a / this.m_impulse.Length()), 
                    P.SubVV(this.m_impulse, o, s), e.SelfMulAdd(this.m_invMassB, s), n += this.m_invIB * P.CrossVV(this.m_rB, s), 
                    t.velocities[this.m_indexB].w = n;
                }, i.prototype.SolvePositionConstraints = function() {
                    return !0;
                }, i.prototype.GetAnchorA = function(t) {
                    return t.x = this.m_targetA.x, t.y = this.m_targetA.y, t;
                }, i.prototype.GetAnchorB = function(t) {
                    return this.m_bodyB.GetWorldPoint(this.m_localAnchorB, t);
                }, i.prototype.GetReactionForce = function(t, e) {
                    return P.MulSV(t, this.m_impulse, e);
                }, i.prototype.GetReactionTorque = function() {
                    return 0;
                }, i.prototype.Dump = function(t) {
                    t("Mouse joint dumping is not supported.\n");
                }, i.prototype.ShiftOrigin = function(t) {
                    this.m_targetA.SelfSub(t);
                }, i.SolveVelocityConstraints_s_Cdot = new P(), i.SolveVelocityConstraints_s_impulse = new P(), 
                i.SolveVelocityConstraints_s_oldImpulse = new P(), i;
            }(mi), Mi = function(e) {
                function i() {
                    var i = e.call(this, t.b2JointType.e_prismaticJoint) || this;
                    return i.localAnchorA = new P(), i.localAnchorB = new P(), i.localAxisA = new P(1, 0), 
                    i.referenceAngle = 0, i.enableLimit = !1, i.lowerTranslation = 0, i.upperTranslation = 0, 
                    i.enableMotor = !1, i.maxMotorForce = 0, i.motorSpeed = 0, i;
                }
                return ti(i, e), i.prototype.Initialize = function(t, e, i, n) {
                    this.bodyA = t, this.bodyB = e, this.bodyA.GetLocalPoint(i, this.localAnchorA), 
                    this.bodyB.GetLocalPoint(i, this.localAnchorB), this.bodyA.GetLocalVector(n, this.localAxisA), 
                    this.referenceAngle = this.bodyB.GetAngle() - this.bodyA.GetAngle();
                }, i;
            }(pi), Ri = function(i) {
                function n(n) {
                    var r = i.call(this, n) || this;
                    return r.m_localAnchorA = new P(), r.m_localAnchorB = new P(), r.m_localXAxisA = new P(), 
                    r.m_localYAxisA = new P(), r.m_referenceAngle = 0, r.m_impulse = new D(0, 0, 0), 
                    r.m_motorImpulse = 0, r.m_lowerTranslation = 0, r.m_upperTranslation = 0, r.m_maxMotorForce = 0, 
                    r.m_motorSpeed = 0, r.m_enableLimit = !1, r.m_enableMotor = !1, r.m_limitState = t.b2LimitState.e_inactiveLimit, 
                    r.m_indexA = 0, r.m_indexB = 0, r.m_localCenterA = new P(), r.m_localCenterB = new P(), 
                    r.m_invMassA = 0, r.m_invMassB = 0, r.m_invIA = 0, r.m_invIB = 0, r.m_axis = new P(0, 0), 
                    r.m_perp = new P(0, 0), r.m_s1 = 0, r.m_s2 = 0, r.m_a1 = 0, r.m_a2 = 0, r.m_K = new L(), 
                    r.m_K3 = new L(), r.m_K2 = new V(), r.m_motorMass = 0, r.m_qA = new O(), r.m_qB = new O(), 
                    r.m_lalcA = new P(), r.m_lalcB = new P(), r.m_rA = new P(), r.m_rB = new P(), r.m_localAnchorA.Copy(e(n.localAnchorA, P.ZERO)), 
                    r.m_localAnchorB.Copy(e(n.localAnchorB, P.ZERO)), r.m_localXAxisA.Copy(e(n.localAxisA, new P(1, 0))).SelfNormalize(), 
                    P.CrossOneV(r.m_localXAxisA, r.m_localYAxisA), r.m_referenceAngle = e(n.referenceAngle, 0), 
                    r.m_lowerTranslation = e(n.lowerTranslation, 0), r.m_upperTranslation = e(n.upperTranslation, 0), 
                    r.m_maxMotorForce = e(n.maxMotorForce, 0), r.m_motorSpeed = e(n.motorSpeed, 0), 
                    r.m_enableLimit = e(n.enableLimit, !1), r.m_enableMotor = e(n.enableMotor, !1), 
                    r;
                }
                return ti(n, i), n.prototype.InitVelocityConstraints = function(e) {
                    this.m_indexA = this.m_bodyA.m_islandIndex, this.m_indexB = this.m_bodyB.m_islandIndex, 
                    this.m_localCenterA.Copy(this.m_bodyA.m_sweep.localCenter), this.m_localCenterB.Copy(this.m_bodyB.m_sweep.localCenter), 
                    this.m_invMassA = this.m_bodyA.m_invMass, this.m_invMassB = this.m_bodyB.m_invMass, 
                    this.m_invIA = this.m_bodyA.m_invI, this.m_invIB = this.m_bodyB.m_invI;
                    var i = e.positions[this.m_indexA].c, r = e.positions[this.m_indexA].a, s = e.velocities[this.m_indexA].v, o = e.velocities[this.m_indexA].w, a = e.positions[this.m_indexB].c, l = e.positions[this.m_indexB].a, u = e.velocities[this.m_indexB].v, h = e.velocities[this.m_indexB].w, _ = this.m_qA.SetAngle(r), f = this.m_qB.SetAngle(l);
                    P.SubVV(this.m_localAnchorA, this.m_localCenterA, this.m_lalcA);
                    var d = O.MulRV(_, this.m_lalcA, this.m_rA);
                    P.SubVV(this.m_localAnchorB, this.m_localCenterB, this.m_lalcB);
                    var p = O.MulRV(f, this.m_lalcB, this.m_rB), v = P.AddVV(P.SubVV(a, i, P.s_t0), P.SubVV(p, d, P.s_t1), n.InitVelocityConstraints_s_d), y = this.m_invMassA, g = this.m_invMassB, x = this.m_invIA, A = this.m_invIB;
                    if (O.MulRV(_, this.m_localXAxisA, this.m_axis), this.m_a1 = P.CrossVV(P.AddVV(v, d, P.s_t0), this.m_axis), 
                    this.m_a2 = P.CrossVV(p, this.m_axis), this.m_motorMass = y + g + x * this.m_a1 * this.m_a1 + A * this.m_a2 * this.m_a2, 
                    this.m_motorMass > 0 && (this.m_motorMass = 1 / this.m_motorMass), O.MulRV(_, this.m_localYAxisA, this.m_perp), 
                    this.m_s1 = P.CrossVV(P.AddVV(v, d, P.s_t0), this.m_perp), this.m_s2 = P.CrossVV(p, this.m_perp), 
                    this.m_K.ex.x = y + g + x * this.m_s1 * this.m_s1 + A * this.m_s2 * this.m_s2, this.m_K.ex.y = x * this.m_s1 + A * this.m_s2, 
                    this.m_K.ex.z = x * this.m_s1 * this.m_a1 + A * this.m_s2 * this.m_a2, this.m_K.ey.x = this.m_K.ex.y, 
                    this.m_K.ey.y = x + A, 0 === this.m_K.ey.y && (this.m_K.ey.y = 1), this.m_K.ey.z = x * this.m_a1 + A * this.m_a2, 
                    this.m_K.ez.x = this.m_K.ex.z, this.m_K.ez.y = this.m_K.ey.z, this.m_K.ez.z = y + g + x * this.m_a1 * this.m_a1 + A * this.m_a2 * this.m_a2, 
                    this.m_enableLimit) {
                        var C = P.DotVV(this.m_axis, v);
                        m(this.m_upperTranslation - this.m_lowerTranslation) < 2 * c ? this.m_limitState = t.b2LimitState.e_equalLimits : C <= this.m_lowerTranslation ? this.m_limitState !== t.b2LimitState.e_atLowerLimit && (this.m_limitState = t.b2LimitState.e_atLowerLimit, 
                        this.m_impulse.z = 0) : C >= this.m_upperTranslation ? this.m_limitState !== t.b2LimitState.e_atUpperLimit && (this.m_limitState = t.b2LimitState.e_atUpperLimit, 
                        this.m_impulse.z = 0) : (this.m_limitState = t.b2LimitState.e_inactiveLimit, this.m_impulse.z = 0);
                    } else this.m_limitState = t.b2LimitState.e_inactiveLimit, this.m_impulse.z = 0;
                    if (this.m_enableMotor || (this.m_motorImpulse = 0), e.step.warmStarting) {
                        this.m_impulse.SelfMul(e.step.dtRatio), this.m_motorImpulse *= e.step.dtRatio;
                        var b = P.AddVV(P.MulSV(this.m_impulse.x, this.m_perp, P.s_t0), P.MulSV(this.m_motorImpulse + this.m_impulse.z, this.m_axis, P.s_t1), n.InitVelocityConstraints_s_P), S = this.m_impulse.x * this.m_s1 + this.m_impulse.y + (this.m_motorImpulse + this.m_impulse.z) * this.m_a1, T = this.m_impulse.x * this.m_s2 + this.m_impulse.y + (this.m_motorImpulse + this.m_impulse.z) * this.m_a2;
                        s.SelfMulSub(y, b), o -= x * S, u.SelfMulAdd(g, b), h += A * T;
                    } else this.m_impulse.SetZero(), this.m_motorImpulse = 0;
                    e.velocities[this.m_indexA].w = o, e.velocities[this.m_indexB].w = h;
                }, n.prototype.SolveVelocityConstraints = function(e) {
                    var i = e.velocities[this.m_indexA].v, r = e.velocities[this.m_indexA].w, s = e.velocities[this.m_indexB].v, o = e.velocities[this.m_indexB].w, a = this.m_invMassA, c = this.m_invMassB, l = this.m_invIA, u = this.m_invIB;
                    if (this.m_enableMotor && this.m_limitState !== t.b2LimitState.e_equalLimits) {
                        var h = P.DotVV(this.m_axis, P.SubVV(s, i, P.s_t0)) + this.m_a2 * o - this.m_a1 * r, _ = this.m_motorMass * (this.m_motorSpeed - h), f = this.m_motorImpulse, d = e.step.dt * this.m_maxMotorForce;
                        this.m_motorImpulse = g(this.m_motorImpulse + _, -d, d), _ = this.m_motorImpulse - f;
                        var p = P.MulSV(_, this.m_axis, n.SolveVelocityConstraints_s_P), m = _ * this.m_a1, x = _ * this.m_a2;
                        i.SelfMulSub(a, p), r -= l * m, s.SelfMulAdd(c, p), o += u * x;
                    }
                    var A = P.DotVV(this.m_perp, P.SubVV(s, i, P.s_t0)) + this.m_s2 * o - this.m_s1 * r, C = o - r;
                    if (this.m_enableLimit && this.m_limitState !== t.b2LimitState.e_inactiveLimit) {
                        var b = P.DotVV(this.m_axis, P.SubVV(s, i, P.s_t0)) + this.m_a2 * o - this.m_a1 * r, S = n.SolveVelocityConstraints_s_f1.Copy(this.m_impulse), T = this.m_K.Solve33(-A, -C, -b, n.SolveVelocityConstraints_s_df3);
                        this.m_impulse.SelfAdd(T), this.m_limitState === t.b2LimitState.e_atLowerLimit ? this.m_impulse.z = y(this.m_impulse.z, 0) : this.m_limitState === t.b2LimitState.e_atUpperLimit && (this.m_impulse.z = v(this.m_impulse.z, 0));
                        var w = -A - (this.m_impulse.z - S.z) * this.m_K.ez.x, E = -C - (this.m_impulse.z - S.z) * this.m_K.ez.y, B = this.m_K.Solve22(w, E, n.SolveVelocityConstraints_s_f2r);
                        B.x += S.x, B.y += S.y, this.m_impulse.x = B.x, this.m_impulse.y = B.y, T.x = this.m_impulse.x - S.x, 
                        T.y = this.m_impulse.y - S.y, T.z = this.m_impulse.z - S.z, p = P.AddVV(P.MulSV(T.x, this.m_perp, P.s_t0), P.MulSV(T.z, this.m_axis, P.s_t1), n.SolveVelocityConstraints_s_P), 
                        m = T.x * this.m_s1 + T.y + T.z * this.m_a1, x = T.x * this.m_s2 + T.y + T.z * this.m_a2, 
                        i.SelfMulSub(a, p), r -= l * m, s.SelfMulAdd(c, p), o += u * x;
                    } else {
                        var M = this.m_K.Solve22(-A, -C, n.SolveVelocityConstraints_s_df2);
                        this.m_impulse.x += M.x, this.m_impulse.y += M.y, p = P.MulSV(M.x, this.m_perp, n.SolveVelocityConstraints_s_P), 
                        m = M.x * this.m_s1 + M.y, x = M.x * this.m_s2 + M.y, i.SelfMulSub(a, p), r -= l * m, 
                        s.SelfMulAdd(c, p), o += u * x;
                    }
                    e.velocities[this.m_indexA].w = r, e.velocities[this.m_indexB].w = o;
                }, n.prototype.SolvePositionConstraints = function(t) {
                    var e = t.positions[this.m_indexA].c, i = t.positions[this.m_indexA].a, r = t.positions[this.m_indexB].c, s = t.positions[this.m_indexB].a, o = this.m_qA.SetAngle(i), a = this.m_qB.SetAngle(s), u = this.m_invMassA, h = this.m_invMassB, _ = this.m_invIA, f = this.m_invIB, d = O.MulRV(o, this.m_lalcA, this.m_rA), p = O.MulRV(a, this.m_lalcB, this.m_rB), v = P.SubVV(P.AddVV(r, p, P.s_t0), P.AddVV(e, d, P.s_t1), n.SolvePositionConstraints_s_d), x = O.MulRV(o, this.m_localXAxisA, this.m_axis), A = P.CrossVV(P.AddVV(v, d, P.s_t0), x), C = P.CrossVV(p, x), b = O.MulRV(o, this.m_localYAxisA, this.m_perp), S = P.CrossVV(P.AddVV(v, d, P.s_t0), b), T = P.CrossVV(p, b), w = n.SolvePositionConstraints_s_impulse, E = P.DotVV(b, v), B = s - i - this.m_referenceAngle, M = m(E), R = m(B), I = !1, D = 0;
                    if (this.m_enableLimit) {
                        var V = P.DotVV(x, v);
                        m(this.m_upperTranslation - this.m_lowerTranslation) < 2 * c ? (D = g(V, -.2, .2), 
                        M = y(M, m(V)), I = !0) : V <= this.m_lowerTranslation ? (D = g(V - this.m_lowerTranslation + c, -.2, 0), 
                        M = y(M, this.m_lowerTranslation - V), I = !0) : V >= this.m_upperTranslation && (D = g(V - this.m_upperTranslation - c, 0, .2), 
                        M = y(M, V - this.m_upperTranslation), I = !0);
                    }
                    if (I) {
                        var L = u + h + _ * S * S + f * T * T, F = _ * S + f * T, N = _ * S * A + f * T * C;
                        0 === (U = _ + f) && (U = 1);
                        var G = _ * A + f * C, k = u + h + _ * A * A + f * C * C, z = this.m_K3;
                        z.ex.SetXYZ(L, F, N), z.ey.SetXYZ(F, U, G), z.ez.SetXYZ(N, G, k), w = z.Solve33(-E, -B, -D, w);
                    } else {
                        var U;
                        L = u + h + _ * S * S + f * T * T, F = _ * S + f * T, 0 === (U = _ + f) && (U = 1);
                        var H = this.m_K2;
                        H.ex.Set(L, F), H.ey.Set(F, U);
                        var W = H.Solve(-E, -B, n.SolvePositionConstraints_s_impulse1);
                        w.x = W.x, w.y = W.y, w.z = 0;
                    }
                    var j = P.AddVV(P.MulSV(w.x, b, P.s_t0), P.MulSV(w.z, x, P.s_t1), n.SolvePositionConstraints_s_P), q = w.x * S + w.y + w.z * A, X = w.x * T + w.y + w.z * C;
                    return e.SelfMulSub(u, j), i -= _ * q, r.SelfMulAdd(h, j), s += f * X, t.positions[this.m_indexA].a = i, 
                    t.positions[this.m_indexB].a = s, M <= c && R <= l;
                }, n.prototype.GetAnchorA = function(t) {
                    return this.m_bodyA.GetWorldPoint(this.m_localAnchorA, t);
                }, n.prototype.GetAnchorB = function(t) {
                    return this.m_bodyB.GetWorldPoint(this.m_localAnchorB, t);
                }, n.prototype.GetReactionForce = function(t, e) {
                    return e.x = t * (this.m_impulse.x * this.m_perp.x + (this.m_motorImpulse + this.m_impulse.z) * this.m_axis.x), 
                    e.y = t * (this.m_impulse.x * this.m_perp.y + (this.m_motorImpulse + this.m_impulse.z) * this.m_axis.y), 
                    e;
                }, n.prototype.GetReactionTorque = function(t) {
                    return t * this.m_impulse.y;
                }, n.prototype.GetLocalAnchorA = function() {
                    return this.m_localAnchorA;
                }, n.prototype.GetLocalAnchorB = function() {
                    return this.m_localAnchorB;
                }, n.prototype.GetLocalAxisA = function() {
                    return this.m_localXAxisA;
                }, n.prototype.GetReferenceAngle = function() {
                    return this.m_referenceAngle;
                }, n.prototype.GetJointTranslation = function() {
                    var t = this.m_bodyA.GetWorldPoint(this.m_localAnchorA, n.GetJointTranslation_s_pA), e = this.m_bodyB.GetWorldPoint(this.m_localAnchorB, n.GetJointTranslation_s_pB), i = P.SubVV(e, t, n.GetJointTranslation_s_d), r = this.m_bodyA.GetWorldVector(this.m_localXAxisA, n.GetJointTranslation_s_axis);
                    return P.DotVV(i, r);
                }, n.prototype.GetJointSpeed = function() {
                    var t = this.m_bodyA, e = this.m_bodyB;
                    P.SubVV(this.m_localAnchorA, t.m_sweep.localCenter, this.m_lalcA);
                    var i = O.MulRV(t.m_xf.q, this.m_lalcA, this.m_rA);
                    P.SubVV(this.m_localAnchorB, e.m_sweep.localCenter, this.m_lalcB);
                    var n = O.MulRV(e.m_xf.q, this.m_lalcB, this.m_rB), r = P.AddVV(t.m_sweep.c, i, P.s_t0), s = P.AddVV(e.m_sweep.c, n, P.s_t1), o = P.SubVV(s, r, P.s_t2), a = t.GetWorldVector(this.m_localXAxisA, this.m_axis), c = t.m_linearVelocity, l = e.m_linearVelocity, u = t.m_angularVelocity, h = e.m_angularVelocity;
                    return P.DotVV(o, P.CrossSV(u, a, P.s_t0)) + P.DotVV(a, P.SubVV(P.AddVCrossSV(l, h, n, P.s_t0), P.AddVCrossSV(c, u, i, P.s_t1), P.s_t0));
                }, n.prototype.IsLimitEnabled = function() {
                    return this.m_enableLimit;
                }, n.prototype.EnableLimit = function(t) {
                    t !== this.m_enableLimit && (this.m_bodyA.SetAwake(!0), this.m_bodyB.SetAwake(!0), 
                    this.m_enableLimit = t, this.m_impulse.z = 0);
                }, n.prototype.GetLowerLimit = function() {
                    return this.m_lowerTranslation;
                }, n.prototype.GetUpperLimit = function() {
                    return this.m_upperTranslation;
                }, n.prototype.SetLimits = function(t, e) {
                    t === this.m_lowerTranslation && e === this.m_upperTranslation || (this.m_bodyA.SetAwake(!0), 
                    this.m_bodyB.SetAwake(!0), this.m_lowerTranslation = t, this.m_upperTranslation = e, 
                    this.m_impulse.z = 0);
                }, n.prototype.IsMotorEnabled = function() {
                    return this.m_enableMotor;
                }, n.prototype.EnableMotor = function(t) {
                    t !== this.m_enableMotor && (this.m_bodyA.SetAwake(!0), this.m_bodyB.SetAwake(!0), 
                    this.m_enableMotor = t);
                }, n.prototype.SetMotorSpeed = function(t) {
                    t !== this.m_motorSpeed && (this.m_bodyA.SetAwake(!0), this.m_bodyB.SetAwake(!0), 
                    this.m_motorSpeed = t);
                }, n.prototype.GetMotorSpeed = function() {
                    return this.m_motorSpeed;
                }, n.prototype.SetMaxMotorForce = function(t) {
                    t !== this.m_maxMotorForce && (this.m_bodyA.SetAwake(!0), this.m_bodyB.SetAwake(!0), 
                    this.m_maxMotorForce = t);
                }, n.prototype.GetMaxMotorForce = function() {
                    return this.m_maxMotorForce;
                }, n.prototype.GetMotorForce = function(t) {
                    return t * this.m_motorImpulse;
                }, n.prototype.Dump = function(t) {
                    var e = this.m_bodyA.m_islandIndex, i = this.m_bodyB.m_islandIndex;
                    t("  const jd: b2PrismaticJointDef = new b2PrismaticJointDef();\n"), t("  jd.bodyA = bodies[%d];\n", e), 
                    t("  jd.bodyB = bodies[%d];\n", i), t("  jd.collideConnected = %s;\n", this.m_collideConnected ? "true" : "false"), 
                    t("  jd.localAnchorA.Set(%.15f, %.15f);\n", this.m_localAnchorA.x, this.m_localAnchorA.y), 
                    t("  jd.localAnchorB.Set(%.15f, %.15f);\n", this.m_localAnchorB.x, this.m_localAnchorB.y), 
                    t("  jd.localAxisA.Set(%.15f, %.15f);\n", this.m_localXAxisA.x, this.m_localXAxisA.y), 
                    t("  jd.referenceAngle = %.15f;\n", this.m_referenceAngle), t("  jd.enableLimit = %s;\n", this.m_enableLimit ? "true" : "false"), 
                    t("  jd.lowerTranslation = %.15f;\n", this.m_lowerTranslation), t("  jd.upperTranslation = %.15f;\n", this.m_upperTranslation), 
                    t("  jd.enableMotor = %s;\n", this.m_enableMotor ? "true" : "false"), t("  jd.motorSpeed = %.15f;\n", this.m_motorSpeed), 
                    t("  jd.maxMotorForce = %.15f;\n", this.m_maxMotorForce), t("  joints[%d] = this.m_world.CreateJoint(jd);\n", this.m_index);
                }, n.InitVelocityConstraints_s_d = new P(), n.InitVelocityConstraints_s_P = new P(), 
                n.SolveVelocityConstraints_s_P = new P(), n.SolveVelocityConstraints_s_f2r = new P(), 
                n.SolveVelocityConstraints_s_f1 = new D(), n.SolveVelocityConstraints_s_df3 = new D(), 
                n.SolveVelocityConstraints_s_df2 = new P(), n.SolvePositionConstraints_s_d = new P(), 
                n.SolvePositionConstraints_s_impulse = new D(), n.SolvePositionConstraints_s_impulse1 = new P(), 
                n.SolvePositionConstraints_s_P = new P(), n.GetJointTranslation_s_pA = new P(), 
                n.GetJointTranslation_s_pB = new P(), n.GetJointTranslation_s_d = new P(), n.GetJointTranslation_s_axis = new P(), 
                n;
            }(mi), Pi = function(e) {
                function i() {
                    var i = e.call(this, t.b2JointType.e_pulleyJoint) || this;
                    return i.groundAnchorA = new P(-1, 1), i.groundAnchorB = new P(1, 1), i.localAnchorA = new P(-1, 0), 
                    i.localAnchorB = new P(1, 0), i.lengthA = 0, i.lengthB = 0, i.ratio = 1, i.collideConnected = !0, 
                    i;
                }
                return ti(i, e), i.prototype.Initialize = function(t, e, i, n, r, s, o) {
                    this.bodyA = t, this.bodyB = e, this.groundAnchorA.Copy(i), this.groundAnchorB.Copy(n), 
                    this.bodyA.GetLocalPoint(r, this.localAnchorA), this.bodyB.GetLocalPoint(s, this.localAnchorB), 
                    this.lengthA = P.DistanceVV(r, i), this.lengthB = P.DistanceVV(s, n), this.ratio = o;
                }, i;
            }(pi), Ii = function(t) {
                function i(i) {
                    var n = t.call(this, i) || this;
                    return n.m_groundAnchorA = new P(), n.m_groundAnchorB = new P(), n.m_lengthA = 0, 
                    n.m_lengthB = 0, n.m_localAnchorA = new P(), n.m_localAnchorB = new P(), n.m_constant = 0, 
                    n.m_ratio = 0, n.m_impulse = 0, n.m_indexA = 0, n.m_indexB = 0, n.m_uA = new P(), 
                    n.m_uB = new P(), n.m_rA = new P(), n.m_rB = new P(), n.m_localCenterA = new P(), 
                    n.m_localCenterB = new P(), n.m_invMassA = 0, n.m_invMassB = 0, n.m_invIA = 0, n.m_invIB = 0, 
                    n.m_mass = 0, n.m_qA = new O(), n.m_qB = new O(), n.m_lalcA = new P(), n.m_lalcB = new P(), 
                    n.m_groundAnchorA.Copy(e(i.groundAnchorA, new P(-1, 1))), n.m_groundAnchorB.Copy(e(i.groundAnchorB, new P(1, 0))), 
                    n.m_localAnchorA.Copy(e(i.localAnchorA, new P(-1, 0))), n.m_localAnchorB.Copy(e(i.localAnchorB, new P(1, 0))), 
                    n.m_lengthA = e(i.lengthA, 0), n.m_lengthB = e(i.lengthB, 0), n.m_ratio = e(i.ratio, 1), 
                    n.m_constant = e(i.lengthA, 0) + n.m_ratio * e(i.lengthB, 0), n.m_impulse = 0, n;
                }
                return ti(i, t), i.prototype.InitVelocityConstraints = function(t) {
                    this.m_indexA = this.m_bodyA.m_islandIndex, this.m_indexB = this.m_bodyB.m_islandIndex, 
                    this.m_localCenterA.Copy(this.m_bodyA.m_sweep.localCenter), this.m_localCenterB.Copy(this.m_bodyB.m_sweep.localCenter), 
                    this.m_invMassA = this.m_bodyA.m_invMass, this.m_invMassB = this.m_bodyB.m_invMass, 
                    this.m_invIA = this.m_bodyA.m_invI, this.m_invIB = this.m_bodyB.m_invI;
                    var e = t.positions[this.m_indexA].c, n = t.positions[this.m_indexA].a, r = t.velocities[this.m_indexA].v, s = t.velocities[this.m_indexA].w, o = t.positions[this.m_indexB].c, a = t.positions[this.m_indexB].a, l = t.velocities[this.m_indexB].v, u = t.velocities[this.m_indexB].w, h = this.m_qA.SetAngle(n), _ = this.m_qB.SetAngle(a);
                    P.SubVV(this.m_localAnchorA, this.m_localCenterA, this.m_lalcA), O.MulRV(h, this.m_lalcA, this.m_rA), 
                    P.SubVV(this.m_localAnchorB, this.m_localCenterB, this.m_lalcB), O.MulRV(_, this.m_lalcB, this.m_rB), 
                    this.m_uA.Copy(e).SelfAdd(this.m_rA).SelfSub(this.m_groundAnchorA), this.m_uB.Copy(o).SelfAdd(this.m_rB).SelfSub(this.m_groundAnchorB);
                    var f = this.m_uA.Length(), d = this.m_uB.Length();
                    f > 10 * c ? this.m_uA.SelfMul(1 / f) : this.m_uA.SetZero(), d > 10 * c ? this.m_uB.SelfMul(1 / d) : this.m_uB.SetZero();
                    var p = P.CrossVV(this.m_rA, this.m_uA), m = P.CrossVV(this.m_rB, this.m_uB), v = this.m_invMassA + this.m_invIA * p * p, y = this.m_invMassB + this.m_invIB * m * m;
                    if (this.m_mass = v + this.m_ratio * this.m_ratio * y, this.m_mass > 0 && (this.m_mass = 1 / this.m_mass), 
                    t.step.warmStarting) {
                        this.m_impulse *= t.step.dtRatio;
                        var g = P.MulSV(-this.m_impulse, this.m_uA, i.InitVelocityConstraints_s_PA), x = P.MulSV(-this.m_ratio * this.m_impulse, this.m_uB, i.InitVelocityConstraints_s_PB);
                        r.SelfMulAdd(this.m_invMassA, g), s += this.m_invIA * P.CrossVV(this.m_rA, g), l.SelfMulAdd(this.m_invMassB, x), 
                        u += this.m_invIB * P.CrossVV(this.m_rB, x);
                    } else this.m_impulse = 0;
                    t.velocities[this.m_indexA].w = s, t.velocities[this.m_indexB].w = u;
                }, i.prototype.SolveVelocityConstraints = function(t) {
                    var e = t.velocities[this.m_indexA].v, n = t.velocities[this.m_indexA].w, r = t.velocities[this.m_indexB].v, s = t.velocities[this.m_indexB].w, o = P.AddVCrossSV(e, n, this.m_rA, i.SolveVelocityConstraints_s_vpA), a = P.AddVCrossSV(r, s, this.m_rB, i.SolveVelocityConstraints_s_vpB), c = -P.DotVV(this.m_uA, o) - this.m_ratio * P.DotVV(this.m_uB, a), l = -this.m_mass * c;
                    this.m_impulse += l;
                    var u = P.MulSV(-l, this.m_uA, i.SolveVelocityConstraints_s_PA), h = P.MulSV(-this.m_ratio * l, this.m_uB, i.SolveVelocityConstraints_s_PB);
                    e.SelfMulAdd(this.m_invMassA, u), n += this.m_invIA * P.CrossVV(this.m_rA, u), r.SelfMulAdd(this.m_invMassB, h), 
                    s += this.m_invIB * P.CrossVV(this.m_rB, h), t.velocities[this.m_indexA].w = n, 
                    t.velocities[this.m_indexB].w = s;
                }, i.prototype.SolvePositionConstraints = function(t) {
                    var e = t.positions[this.m_indexA].c, n = t.positions[this.m_indexA].a, r = t.positions[this.m_indexB].c, s = t.positions[this.m_indexB].a, o = this.m_qA.SetAngle(n), a = this.m_qB.SetAngle(s);
                    P.SubVV(this.m_localAnchorA, this.m_localCenterA, this.m_lalcA);
                    var l = O.MulRV(o, this.m_lalcA, this.m_rA);
                    P.SubVV(this.m_localAnchorB, this.m_localCenterB, this.m_lalcB);
                    var u = O.MulRV(a, this.m_lalcB, this.m_rB), h = this.m_uA.Copy(e).SelfAdd(l).SelfSub(this.m_groundAnchorA), _ = this.m_uB.Copy(r).SelfAdd(u).SelfSub(this.m_groundAnchorB), f = h.Length(), d = _.Length();
                    f > 10 * c ? h.SelfMul(1 / f) : h.SetZero(), d > 10 * c ? _.SelfMul(1 / d) : _.SetZero();
                    var p = P.CrossVV(l, h), v = P.CrossVV(u, _), y = this.m_invMassA + this.m_invIA * p * p, g = this.m_invMassB + this.m_invIB * v * v, x = y + this.m_ratio * this.m_ratio * g;
                    x > 0 && (x = 1 / x);
                    var A = this.m_constant - f - this.m_ratio * d, C = m(A), b = -x * A, S = P.MulSV(-b, h, i.SolvePositionConstraints_s_PA), T = P.MulSV(-this.m_ratio * b, _, i.SolvePositionConstraints_s_PB);
                    return e.SelfMulAdd(this.m_invMassA, S), n += this.m_invIA * P.CrossVV(l, S), r.SelfMulAdd(this.m_invMassB, T), 
                    s += this.m_invIB * P.CrossVV(u, T), t.positions[this.m_indexA].a = n, t.positions[this.m_indexB].a = s, 
                    C < c;
                }, i.prototype.GetAnchorA = function(t) {
                    return this.m_bodyA.GetWorldPoint(this.m_localAnchorA, t);
                }, i.prototype.GetAnchorB = function(t) {
                    return this.m_bodyB.GetWorldPoint(this.m_localAnchorB, t);
                }, i.prototype.GetReactionForce = function(t, e) {
                    return e.x = t * this.m_impulse * this.m_uB.x, e.y = t * this.m_impulse * this.m_uB.y, 
                    e;
                }, i.prototype.GetReactionTorque = function() {
                    return 0;
                }, i.prototype.GetGroundAnchorA = function() {
                    return this.m_groundAnchorA;
                }, i.prototype.GetGroundAnchorB = function() {
                    return this.m_groundAnchorB;
                }, i.prototype.GetLengthA = function() {
                    return this.m_lengthA;
                }, i.prototype.GetLengthB = function() {
                    return this.m_lengthB;
                }, i.prototype.GetRatio = function() {
                    return this.m_ratio;
                }, i.prototype.GetCurrentLengthA = function() {
                    var t = this.m_bodyA.GetWorldPoint(this.m_localAnchorA, i.GetCurrentLengthA_s_p), e = this.m_groundAnchorA;
                    return P.DistanceVV(t, e);
                }, i.prototype.GetCurrentLengthB = function() {
                    var t = this.m_bodyB.GetWorldPoint(this.m_localAnchorB, i.GetCurrentLengthB_s_p), e = this.m_groundAnchorB;
                    return P.DistanceVV(t, e);
                }, i.prototype.Dump = function(t) {
                    var e = this.m_bodyA.m_islandIndex, i = this.m_bodyB.m_islandIndex;
                    t("  const jd: b2PulleyJointDef = new b2PulleyJointDef();\n"), t("  jd.bodyA = bodies[%d];\n", e), 
                    t("  jd.bodyB = bodies[%d];\n", i), t("  jd.collideConnected = %s;\n", this.m_collideConnected ? "true" : "false"), 
                    t("  jd.groundAnchorA.Set(%.15f, %.15f);\n", this.m_groundAnchorA.x, this.m_groundAnchorA.y), 
                    t("  jd.groundAnchorB.Set(%.15f, %.15f);\n", this.m_groundAnchorB.x, this.m_groundAnchorB.y), 
                    t("  jd.localAnchorA.Set(%.15f, %.15f);\n", this.m_localAnchorA.x, this.m_localAnchorA.y), 
                    t("  jd.localAnchorB.Set(%.15f, %.15f);\n", this.m_localAnchorB.x, this.m_localAnchorB.y), 
                    t("  jd.lengthA = %.15f;\n", this.m_lengthA), t("  jd.lengthB = %.15f;\n", this.m_lengthB), 
                    t("  jd.ratio = %.15f;\n", this.m_ratio), t("  joints[%d] = this.m_world.CreateJoint(jd);\n", this.m_index);
                }, i.prototype.ShiftOrigin = function(t) {
                    this.m_groundAnchorA.SelfSub(t), this.m_groundAnchorB.SelfSub(t);
                }, i.InitVelocityConstraints_s_PA = new P(), i.InitVelocityConstraints_s_PB = new P(), 
                i.SolveVelocityConstraints_s_vpA = new P(), i.SolveVelocityConstraints_s_vpB = new P(), 
                i.SolveVelocityConstraints_s_PA = new P(), i.SolveVelocityConstraints_s_PB = new P(), 
                i.SolvePositionConstraints_s_PA = new P(), i.SolvePositionConstraints_s_PB = new P(), 
                i.GetCurrentLengthA_s_p = new P(), i.GetCurrentLengthB_s_p = new P(), i;
            }(mi), Di = function(e) {
                function i() {
                    var i = e.call(this, t.b2JointType.e_revoluteJoint) || this;
                    return i.localAnchorA = new P(0, 0), i.localAnchorB = new P(0, 0), i.referenceAngle = 0, 
                    i.enableLimit = !1, i.lowerAngle = 0, i.upperAngle = 0, i.enableMotor = !1, i.motorSpeed = 0, 
                    i.maxMotorTorque = 0, i;
                }
                return ti(i, e), i.prototype.Initialize = function(t, e, i) {
                    this.bodyA = t, this.bodyB = e, this.bodyA.GetLocalPoint(i, this.localAnchorA), 
                    this.bodyB.GetLocalPoint(i, this.localAnchorB), this.referenceAngle = this.bodyB.GetAngle() - this.bodyA.GetAngle();
                }, i;
            }(pi), Vi = function(i) {
                function n(n) {
                    var r = i.call(this, n) || this;
                    return r.m_localAnchorA = new P(), r.m_localAnchorB = new P(), r.m_impulse = new D(), 
                    r.m_motorImpulse = 0, r.m_enableMotor = !1, r.m_maxMotorTorque = 0, r.m_motorSpeed = 0, 
                    r.m_enableLimit = !1, r.m_referenceAngle = 0, r.m_lowerAngle = 0, r.m_upperAngle = 0, 
                    r.m_indexA = 0, r.m_indexB = 0, r.m_rA = new P(), r.m_rB = new P(), r.m_localCenterA = new P(), 
                    r.m_localCenterB = new P(), r.m_invMassA = 0, r.m_invMassB = 0, r.m_invIA = 0, r.m_invIB = 0, 
                    r.m_mass = new L(), r.m_motorMass = 0, r.m_limitState = t.b2LimitState.e_inactiveLimit, 
                    r.m_qA = new O(), r.m_qB = new O(), r.m_lalcA = new P(), r.m_lalcB = new P(), r.m_K = new V(), 
                    r.m_localAnchorA.Copy(e(n.localAnchorA, P.ZERO)), r.m_localAnchorB.Copy(e(n.localAnchorB, P.ZERO)), 
                    r.m_referenceAngle = e(n.referenceAngle, 0), r.m_impulse.SetZero(), r.m_motorImpulse = 0, 
                    r.m_lowerAngle = e(n.lowerAngle, 0), r.m_upperAngle = e(n.upperAngle, 0), r.m_maxMotorTorque = e(n.maxMotorTorque, 0), 
                    r.m_motorSpeed = e(n.motorSpeed, 0), r.m_enableLimit = e(n.enableLimit, !1), r.m_enableMotor = e(n.enableMotor, !1), 
                    r.m_limitState = t.b2LimitState.e_inactiveLimit, r;
                }
                return ti(n, i), n.prototype.InitVelocityConstraints = function(e) {
                    this.m_indexA = this.m_bodyA.m_islandIndex, this.m_indexB = this.m_bodyB.m_islandIndex, 
                    this.m_localCenterA.Copy(this.m_bodyA.m_sweep.localCenter), this.m_localCenterB.Copy(this.m_bodyB.m_sweep.localCenter), 
                    this.m_invMassA = this.m_bodyA.m_invMass, this.m_invMassB = this.m_bodyB.m_invMass, 
                    this.m_invIA = this.m_bodyA.m_invI, this.m_invIB = this.m_bodyB.m_invI;
                    var i = e.positions[this.m_indexA].a, r = e.velocities[this.m_indexA].v, s = e.velocities[this.m_indexA].w, o = e.positions[this.m_indexB].a, a = e.velocities[this.m_indexB].v, c = e.velocities[this.m_indexB].w, u = this.m_qA.SetAngle(i), h = this.m_qB.SetAngle(o);
                    P.SubVV(this.m_localAnchorA, this.m_localCenterA, this.m_lalcA), O.MulRV(u, this.m_lalcA, this.m_rA), 
                    P.SubVV(this.m_localAnchorB, this.m_localCenterB, this.m_lalcB), O.MulRV(h, this.m_lalcB, this.m_rB);
                    var _ = this.m_invMassA, f = this.m_invMassB, d = this.m_invIA, p = this.m_invIB, v = d + p === 0;
                    if (this.m_mass.ex.x = _ + f + this.m_rA.y * this.m_rA.y * d + this.m_rB.y * this.m_rB.y * p, 
                    this.m_mass.ey.x = -this.m_rA.y * this.m_rA.x * d - this.m_rB.y * this.m_rB.x * p, 
                    this.m_mass.ez.x = -this.m_rA.y * d - this.m_rB.y * p, this.m_mass.ex.y = this.m_mass.ey.x, 
                    this.m_mass.ey.y = _ + f + this.m_rA.x * this.m_rA.x * d + this.m_rB.x * this.m_rB.x * p, 
                    this.m_mass.ez.y = this.m_rA.x * d + this.m_rB.x * p, this.m_mass.ex.z = this.m_mass.ez.x, 
                    this.m_mass.ey.z = this.m_mass.ez.y, this.m_mass.ez.z = d + p, this.m_motorMass = d + p, 
                    this.m_motorMass > 0 && (this.m_motorMass = 1 / this.m_motorMass), this.m_enableMotor && !v || (this.m_motorImpulse = 0), 
                    this.m_enableLimit && !v) {
                        var y = o - i - this.m_referenceAngle;
                        m(this.m_upperAngle - this.m_lowerAngle) < 2 * l ? this.m_limitState = t.b2LimitState.e_equalLimits : y <= this.m_lowerAngle ? (this.m_limitState !== t.b2LimitState.e_atLowerLimit && (this.m_impulse.z = 0), 
                        this.m_limitState = t.b2LimitState.e_atLowerLimit) : y >= this.m_upperAngle ? (this.m_limitState !== t.b2LimitState.e_atUpperLimit && (this.m_impulse.z = 0), 
                        this.m_limitState = t.b2LimitState.e_atUpperLimit) : (this.m_limitState = t.b2LimitState.e_inactiveLimit, 
                        this.m_impulse.z = 0);
                    } else this.m_limitState = t.b2LimitState.e_inactiveLimit;
                    if (e.step.warmStarting) {
                        this.m_impulse.SelfMul(e.step.dtRatio), this.m_motorImpulse *= e.step.dtRatio;
                        var g = n.InitVelocityConstraints_s_P.Set(this.m_impulse.x, this.m_impulse.y);
                        r.SelfMulSub(_, g), s -= d * (P.CrossVV(this.m_rA, g) + this.m_motorImpulse + this.m_impulse.z), 
                        a.SelfMulAdd(f, g), c += p * (P.CrossVV(this.m_rB, g) + this.m_motorImpulse + this.m_impulse.z);
                    } else this.m_impulse.SetZero(), this.m_motorImpulse = 0;
                    e.velocities[this.m_indexA].w = s, e.velocities[this.m_indexB].w = c;
                }, n.prototype.SolveVelocityConstraints = function(e) {
                    var i = e.velocities[this.m_indexA].v, r = e.velocities[this.m_indexA].w, s = e.velocities[this.m_indexB].v, o = e.velocities[this.m_indexB].w, a = this.m_invMassA, c = this.m_invMassB, l = this.m_invIA, u = this.m_invIB, h = l + u === 0;
                    if (this.m_enableMotor && this.m_limitState !== t.b2LimitState.e_equalLimits && !h) {
                        var _ = o - r - this.m_motorSpeed, f = -this.m_motorMass * _, d = this.m_motorImpulse, p = e.step.dt * this.m_maxMotorTorque;
                        this.m_motorImpulse = g(this.m_motorImpulse + f, -p, p), r -= l * (f = this.m_motorImpulse - d), 
                        o += u * f;
                    }
                    if (this.m_enableLimit && this.m_limitState !== t.b2LimitState.e_inactiveLimit && !h) {
                        var m = P.SubVV(P.AddVCrossSV(s, o, this.m_rB, P.s_t0), P.AddVCrossSV(i, r, this.m_rA, P.s_t1), n.SolveVelocityConstraints_s_Cdot1), v = o - r, y = this.m_mass.Solve33(m.x, m.y, v, n.SolveVelocityConstraints_s_impulse_v3).SelfNeg();
                        if (this.m_limitState === t.b2LimitState.e_equalLimits) this.m_impulse.SelfAdd(y); else if (this.m_limitState === t.b2LimitState.e_atLowerLimit) if (this.m_impulse.z + y.z < 0) {
                            var x = -m.x + this.m_impulse.z * this.m_mass.ez.x, A = -m.y + this.m_impulse.z * this.m_mass.ez.y, C = this.m_mass.Solve22(x, A, n.SolveVelocityConstraints_s_reduced_v2);
                            y.x = C.x, y.y = C.y, y.z = -this.m_impulse.z, this.m_impulse.x += C.x, this.m_impulse.y += C.y, 
                            this.m_impulse.z = 0;
                        } else this.m_impulse.SelfAdd(y); else this.m_limitState === t.b2LimitState.e_atUpperLimit && (this.m_impulse.z + y.z > 0 ? (x = -m.x + this.m_impulse.z * this.m_mass.ez.x, 
                        A = -m.y + this.m_impulse.z * this.m_mass.ez.y, C = this.m_mass.Solve22(x, A, n.SolveVelocityConstraints_s_reduced_v2), 
                        y.x = C.x, y.y = C.y, y.z = -this.m_impulse.z, this.m_impulse.x += C.x, this.m_impulse.y += C.y, 
                        this.m_impulse.z = 0) : this.m_impulse.SelfAdd(y));
                        var b = n.SolveVelocityConstraints_s_P.Set(y.x, y.y);
                        i.SelfMulSub(a, b), r -= l * (P.CrossVV(this.m_rA, b) + y.z), s.SelfMulAdd(c, b), 
                        o += u * (P.CrossVV(this.m_rB, b) + y.z);
                    } else {
                        var S = P.SubVV(P.AddVCrossSV(s, o, this.m_rB, P.s_t0), P.AddVCrossSV(i, r, this.m_rA, P.s_t1), n.SolveVelocityConstraints_s_Cdot_v2), T = this.m_mass.Solve22(-S.x, -S.y, n.SolveVelocityConstraints_s_impulse_v2);
                        this.m_impulse.x += T.x, this.m_impulse.y += T.y, i.SelfMulSub(a, T), r -= l * P.CrossVV(this.m_rA, T), 
                        s.SelfMulAdd(c, T), o += u * P.CrossVV(this.m_rB, T);
                    }
                    e.velocities[this.m_indexA].w = r, e.velocities[this.m_indexB].w = o;
                }, n.prototype.SolvePositionConstraints = function(e) {
                    var i, r = e.positions[this.m_indexA].c, s = e.positions[this.m_indexA].a, o = e.positions[this.m_indexB].c, a = e.positions[this.m_indexB].a, u = this.m_qA.SetAngle(s), h = this.m_qB.SetAngle(a), _ = 0, f = this.m_invIA + this.m_invIB === 0;
                    if (this.m_enableLimit && this.m_limitState !== t.b2LimitState.e_inactiveLimit && !f) {
                        var d = a - s - this.m_referenceAngle, p = 0;
                        if (this.m_limitState === t.b2LimitState.e_equalLimits) {
                            var v = g(d - this.m_lowerAngle, -.13962634015955555, .13962634015955555);
                            p = -this.m_motorMass * v, _ = m(v);
                        } else this.m_limitState === t.b2LimitState.e_atLowerLimit ? (_ = -(v = d - this.m_lowerAngle), 
                        v = g(v + l, -.13962634015955555, 0), p = -this.m_motorMass * v) : this.m_limitState === t.b2LimitState.e_atUpperLimit && (_ = v = d - this.m_upperAngle, 
                        v = g(v - l, 0, .13962634015955555), p = -this.m_motorMass * v);
                        s -= this.m_invIA * p, a += this.m_invIB * p;
                    }
                    u.SetAngle(s), h.SetAngle(a), P.SubVV(this.m_localAnchorA, this.m_localCenterA, this.m_lalcA);
                    var y = O.MulRV(u, this.m_lalcA, this.m_rA);
                    P.SubVV(this.m_localAnchorB, this.m_localCenterB, this.m_lalcB);
                    var x = O.MulRV(h, this.m_lalcB, this.m_rB), A = P.SubVV(P.AddVV(o, x, P.s_t0), P.AddVV(r, y, P.s_t1), n.SolvePositionConstraints_s_C_v2);
                    i = A.Length();
                    var C = this.m_invMassA, b = this.m_invMassB, S = this.m_invIA, T = this.m_invIB, w = this.m_K;
                    w.ex.x = C + b + S * y.y * y.y + T * x.y * x.y, w.ex.y = -S * y.x * y.y - T * x.x * x.y, 
                    w.ey.x = w.ex.y, w.ey.y = C + b + S * y.x * y.x + T * x.x * x.x;
                    var E = w.Solve(A.x, A.y, n.SolvePositionConstraints_s_impulse).SelfNeg();
                    return r.SelfMulSub(C, E), s -= S * P.CrossVV(y, E), o.SelfMulAdd(b, E), a += T * P.CrossVV(x, E), 
                    e.positions[this.m_indexA].a = s, e.positions[this.m_indexB].a = a, i <= c && _ <= l;
                }, n.prototype.GetAnchorA = function(t) {
                    return this.m_bodyA.GetWorldPoint(this.m_localAnchorA, t);
                }, n.prototype.GetAnchorB = function(t) {
                    return this.m_bodyB.GetWorldPoint(this.m_localAnchorB, t);
                }, n.prototype.GetReactionForce = function(t, e) {
                    return e.x = t * this.m_impulse.x, e.y = t * this.m_impulse.y, e;
                }, n.prototype.GetReactionTorque = function(t) {
                    return t * this.m_impulse.z;
                }, n.prototype.GetLocalAnchorA = function() {
                    return this.m_localAnchorA;
                }, n.prototype.GetLocalAnchorB = function() {
                    return this.m_localAnchorB;
                }, n.prototype.GetReferenceAngle = function() {
                    return this.m_referenceAngle;
                }, n.prototype.GetJointAngle = function() {
                    return this.m_bodyB.m_sweep.a - this.m_bodyA.m_sweep.a - this.m_referenceAngle;
                }, n.prototype.GetJointSpeed = function() {
                    return this.m_bodyB.m_angularVelocity - this.m_bodyA.m_angularVelocity;
                }, n.prototype.IsMotorEnabled = function() {
                    return this.m_enableMotor;
                }, n.prototype.EnableMotor = function(t) {
                    t !== this.m_enableMotor && (this.m_bodyA.SetAwake(!0), this.m_bodyB.SetAwake(!0), 
                    this.m_enableMotor = t);
                }, n.prototype.GetMotorTorque = function(t) {
                    return t * this.m_motorImpulse;
                }, n.prototype.GetMotorSpeed = function() {
                    return this.m_motorSpeed;
                }, n.prototype.SetMaxMotorTorque = function(t) {
                    t !== this.m_maxMotorTorque && (this.m_bodyA.SetAwake(!0), this.m_bodyB.SetAwake(!0), 
                    this.m_maxMotorTorque = t);
                }, n.prototype.GetMaxMotorTorque = function() {
                    return this.m_maxMotorTorque;
                }, n.prototype.IsLimitEnabled = function() {
                    return this.m_enableLimit;
                }, n.prototype.EnableLimit = function(t) {
                    t !== this.m_enableLimit && (this.m_bodyA.SetAwake(!0), this.m_bodyB.SetAwake(!0), 
                    this.m_enableLimit = t, this.m_impulse.z = 0);
                }, n.prototype.GetLowerLimit = function() {
                    return this.m_lowerAngle;
                }, n.prototype.GetUpperLimit = function() {
                    return this.m_upperAngle;
                }, n.prototype.SetLimits = function(t, e) {
                    t === this.m_lowerAngle && e === this.m_upperAngle || (this.m_bodyA.SetAwake(!0), 
                    this.m_bodyB.SetAwake(!0), this.m_impulse.z = 0, this.m_lowerAngle = t, this.m_upperAngle = e);
                }, n.prototype.SetMotorSpeed = function(t) {
                    t !== this.m_motorSpeed && (this.m_bodyA.SetAwake(!0), this.m_bodyB.SetAwake(!0), 
                    this.m_motorSpeed = t);
                }, n.prototype.Dump = function(t) {
                    var e = this.m_bodyA.m_islandIndex, i = this.m_bodyB.m_islandIndex;
                    t("  const jd: b2RevoluteJointDef = new b2RevoluteJointDef();\n"), t("  jd.bodyA = bodies[%d];\n", e), 
                    t("  jd.bodyB = bodies[%d];\n", i), t("  jd.collideConnected = %s;\n", this.m_collideConnected ? "true" : "false"), 
                    t("  jd.localAnchorA.Set(%.15f, %.15f);\n", this.m_localAnchorA.x, this.m_localAnchorA.y), 
                    t("  jd.localAnchorB.Set(%.15f, %.15f);\n", this.m_localAnchorB.x, this.m_localAnchorB.y), 
                    t("  jd.referenceAngle = %.15f;\n", this.m_referenceAngle), t("  jd.enableLimit = %s;\n", this.m_enableLimit ? "true" : "false"), 
                    t("  jd.lowerAngle = %.15f;\n", this.m_lowerAngle), t("  jd.upperAngle = %.15f;\n", this.m_upperAngle), 
                    t("  jd.enableMotor = %s;\n", this.m_enableMotor ? "true" : "false"), t("  jd.motorSpeed = %.15f;\n", this.m_motorSpeed), 
                    t("  jd.maxMotorTorque = %.15f;\n", this.m_maxMotorTorque), t("  joints[%d] = this.m_world.CreateJoint(jd);\n", this.m_index);
                }, n.InitVelocityConstraints_s_P = new P(), n.SolveVelocityConstraints_s_P = new P(), 
                n.SolveVelocityConstraints_s_Cdot_v2 = new P(), n.SolveVelocityConstraints_s_Cdot1 = new P(), 
                n.SolveVelocityConstraints_s_impulse_v3 = new D(), n.SolveVelocityConstraints_s_reduced_v2 = new P(), 
                n.SolveVelocityConstraints_s_impulse_v2 = new P(), n.SolvePositionConstraints_s_C_v2 = new P(), 
                n.SolvePositionConstraints_s_impulse = new P(), n;
            }(mi), Li = function(e) {
                function i() {
                    var i = e.call(this, t.b2JointType.e_ropeJoint) || this;
                    return i.localAnchorA = new P(-1, 0), i.localAnchorB = new P(1, 0), i.maxLength = 0, 
                    i;
                }
                return ti(i, e), i;
            }(pi), Oi = function(i) {
                function n(n) {
                    var r = i.call(this, n) || this;
                    return r.m_localAnchorA = new P(), r.m_localAnchorB = new P(), r.m_maxLength = 0, 
                    r.m_length = 0, r.m_impulse = 0, r.m_indexA = 0, r.m_indexB = 0, r.m_u = new P(), 
                    r.m_rA = new P(), r.m_rB = new P(), r.m_localCenterA = new P(), r.m_localCenterB = new P(), 
                    r.m_invMassA = 0, r.m_invMassB = 0, r.m_invIA = 0, r.m_invIB = 0, r.m_mass = 0, 
                    r.m_state = t.b2LimitState.e_inactiveLimit, r.m_qA = new O(), r.m_qB = new O(), 
                    r.m_lalcA = new P(), r.m_lalcB = new P(), r.m_localAnchorA.Copy(e(n.localAnchorA, new P(-1, 0))), 
                    r.m_localAnchorB.Copy(e(n.localAnchorB, new P(1, 0))), r.m_maxLength = e(n.maxLength, 0), 
                    r;
                }
                return ti(n, i), n.prototype.InitVelocityConstraints = function(e) {
                    this.m_indexA = this.m_bodyA.m_islandIndex, this.m_indexB = this.m_bodyB.m_islandIndex, 
                    this.m_localCenterA.Copy(this.m_bodyA.m_sweep.localCenter), this.m_localCenterB.Copy(this.m_bodyB.m_sweep.localCenter), 
                    this.m_invMassA = this.m_bodyA.m_invMass, this.m_invMassB = this.m_bodyB.m_invMass, 
                    this.m_invIA = this.m_bodyA.m_invI, this.m_invIB = this.m_bodyB.m_invI;
                    var i = e.positions[this.m_indexA].c, r = e.positions[this.m_indexA].a, s = e.velocities[this.m_indexA].v, o = e.velocities[this.m_indexA].w, a = e.positions[this.m_indexB].c, l = e.positions[this.m_indexB].a, u = e.velocities[this.m_indexB].v, h = e.velocities[this.m_indexB].w, _ = this.m_qA.SetAngle(r), f = this.m_qB.SetAngle(l);
                    P.SubVV(this.m_localAnchorA, this.m_localCenterA, this.m_lalcA), O.MulRV(_, this.m_lalcA, this.m_rA), 
                    P.SubVV(this.m_localAnchorB, this.m_localCenterB, this.m_lalcB), O.MulRV(f, this.m_lalcB, this.m_rB), 
                    this.m_u.Copy(a).SelfAdd(this.m_rB).SelfSub(i).SelfSub(this.m_rA), this.m_length = this.m_u.Length();
                    var d = this.m_length - this.m_maxLength;
                    if (this.m_state = d > 0 ? t.b2LimitState.e_atUpperLimit : t.b2LimitState.e_inactiveLimit, 
                    !(this.m_length > c)) return this.m_u.SetZero(), this.m_mass = 0, void (this.m_impulse = 0);
                    this.m_u.SelfMul(1 / this.m_length);
                    var p = P.CrossVV(this.m_rA, this.m_u), m = P.CrossVV(this.m_rB, this.m_u), v = this.m_invMassA + this.m_invIA * p * p + this.m_invMassB + this.m_invIB * m * m;
                    if (this.m_mass = 0 !== v ? 1 / v : 0, e.step.warmStarting) {
                        this.m_impulse *= e.step.dtRatio;
                        var y = P.MulSV(this.m_impulse, this.m_u, n.InitVelocityConstraints_s_P);
                        s.SelfMulSub(this.m_invMassA, y), o -= this.m_invIA * P.CrossVV(this.m_rA, y), u.SelfMulAdd(this.m_invMassB, y), 
                        h += this.m_invIB * P.CrossVV(this.m_rB, y);
                    } else this.m_impulse = 0;
                    e.velocities[this.m_indexA].w = o, e.velocities[this.m_indexB].w = h;
                }, n.prototype.SolveVelocityConstraints = function(t) {
                    var e = t.velocities[this.m_indexA].v, i = t.velocities[this.m_indexA].w, r = t.velocities[this.m_indexB].v, s = t.velocities[this.m_indexB].w, o = P.AddVCrossSV(e, i, this.m_rA, n.SolveVelocityConstraints_s_vpA), a = P.AddVCrossSV(r, s, this.m_rB, n.SolveVelocityConstraints_s_vpB), c = this.m_length - this.m_maxLength, l = P.DotVV(this.m_u, P.SubVV(a, o, P.s_t0));
                    c < 0 && (l += t.step.inv_dt * c);
                    var u = -this.m_mass * l, h = this.m_impulse;
                    this.m_impulse = v(0, this.m_impulse + u), u = this.m_impulse - h;
                    var _ = P.MulSV(u, this.m_u, n.SolveVelocityConstraints_s_P);
                    e.SelfMulSub(this.m_invMassA, _), i -= this.m_invIA * P.CrossVV(this.m_rA, _), r.SelfMulAdd(this.m_invMassB, _), 
                    s += this.m_invIB * P.CrossVV(this.m_rB, _), t.velocities[this.m_indexA].w = i, 
                    t.velocities[this.m_indexB].w = s;
                }, n.prototype.SolvePositionConstraints = function(t) {
                    var e = t.positions[this.m_indexA].c, i = t.positions[this.m_indexA].a, r = t.positions[this.m_indexB].c, s = t.positions[this.m_indexB].a, o = this.m_qA.SetAngle(i), a = this.m_qB.SetAngle(s);
                    P.SubVV(this.m_localAnchorA, this.m_localCenterA, this.m_lalcA);
                    var l = O.MulRV(o, this.m_lalcA, this.m_rA);
                    P.SubVV(this.m_localAnchorB, this.m_localCenterB, this.m_lalcB);
                    var u = O.MulRV(a, this.m_lalcB, this.m_rB), h = this.m_u.Copy(r).SelfAdd(u).SelfSub(e).SelfSub(l), _ = h.Normalize(), f = _ - this.m_maxLength;
                    f = g(f, 0, .2);
                    var d = -this.m_mass * f, p = P.MulSV(d, h, n.SolvePositionConstraints_s_P);
                    return e.SelfMulSub(this.m_invMassA, p), i -= this.m_invIA * P.CrossVV(l, p), r.SelfMulAdd(this.m_invMassB, p), 
                    s += this.m_invIB * P.CrossVV(u, p), t.positions[this.m_indexA].a = i, t.positions[this.m_indexB].a = s, 
                    _ - this.m_maxLength < c;
                }, n.prototype.GetAnchorA = function(t) {
                    return this.m_bodyA.GetWorldPoint(this.m_localAnchorA, t);
                }, n.prototype.GetAnchorB = function(t) {
                    return this.m_bodyB.GetWorldPoint(this.m_localAnchorB, t);
                }, n.prototype.GetReactionForce = function(t, e) {
                    return P.MulSV(t * this.m_impulse, this.m_u, e);
                }, n.prototype.GetReactionTorque = function() {
                    return 0;
                }, n.prototype.GetLocalAnchorA = function() {
                    return this.m_localAnchorA;
                }, n.prototype.GetLocalAnchorB = function() {
                    return this.m_localAnchorB;
                }, n.prototype.SetMaxLength = function(t) {
                    this.m_maxLength = t;
                }, n.prototype.GetMaxLength = function() {
                    return this.m_maxLength;
                }, n.prototype.GetLimitState = function() {
                    return this.m_state;
                }, n.prototype.Dump = function(t) {
                    var e = this.m_bodyA.m_islandIndex, i = this.m_bodyB.m_islandIndex;
                    t("  const jd: b2RopeJointDef = new b2RopeJointDef();\n"), t("  jd.bodyA = bodies[%d];\n", e), 
                    t("  jd.bodyB = bodies[%d];\n", i), t("  jd.collideConnected = %s;\n", this.m_collideConnected ? "true" : "false"), 
                    t("  jd.localAnchorA.Set(%.15f, %.15f);\n", this.m_localAnchorA.x, this.m_localAnchorA.y), 
                    t("  jd.localAnchorB.Set(%.15f, %.15f);\n", this.m_localAnchorB.x, this.m_localAnchorB.y), 
                    t("  jd.maxLength = %.15f;\n", this.m_maxLength), t("  joints[%d] = this.m_world.CreateJoint(jd);\n", this.m_index);
                }, n.InitVelocityConstraints_s_P = new P(), n.SolveVelocityConstraints_s_vpA = new P(), 
                n.SolveVelocityConstraints_s_vpB = new P(), n.SolveVelocityConstraints_s_P = new P(), 
                n.SolvePositionConstraints_s_P = new P(), n;
            }(mi), Fi = function(e) {
                function i() {
                    var i = e.call(this, t.b2JointType.e_weldJoint) || this;
                    return i.localAnchorA = new P(), i.localAnchorB = new P(), i.referenceAngle = 0, 
                    i.frequencyHz = 0, i.dampingRatio = 0, i;
                }
                return ti(i, e), i.prototype.Initialize = function(t, e, i) {
                    this.bodyA = t, this.bodyB = e, this.bodyA.GetLocalPoint(i, this.localAnchorA), 
                    this.bodyB.GetLocalPoint(i, this.localAnchorB), this.referenceAngle = this.bodyB.GetAngle() - this.bodyA.GetAngle();
                }, i;
            }(pi), Ni = function(t) {
                function i(i) {
                    var n = t.call(this, i) || this;
                    return n.m_frequencyHz = 0, n.m_dampingRatio = 0, n.m_bias = 0, n.m_localAnchorA = new P(), 
                    n.m_localAnchorB = new P(), n.m_referenceAngle = 0, n.m_gamma = 0, n.m_impulse = new D(0, 0, 0), 
                    n.m_indexA = 0, n.m_indexB = 0, n.m_rA = new P(), n.m_rB = new P(), n.m_localCenterA = new P(), 
                    n.m_localCenterB = new P(), n.m_invMassA = 0, n.m_invMassB = 0, n.m_invIA = 0, n.m_invIB = 0, 
                    n.m_mass = new L(), n.m_qA = new O(), n.m_qB = new O(), n.m_lalcA = new P(), n.m_lalcB = new P(), 
                    n.m_K = new L(), n.m_frequencyHz = e(i.frequencyHz, 0), n.m_dampingRatio = e(i.dampingRatio, 0), 
                    n.m_localAnchorA.Copy(e(i.localAnchorA, P.ZERO)), n.m_localAnchorB.Copy(e(i.localAnchorB, P.ZERO)), 
                    n.m_referenceAngle = e(i.referenceAngle, 0), n.m_impulse.SetZero(), n;
                }
                return ti(i, t), i.prototype.InitVelocityConstraints = function(t) {
                    this.m_indexA = this.m_bodyA.m_islandIndex, this.m_indexB = this.m_bodyB.m_islandIndex, 
                    this.m_localCenterA.Copy(this.m_bodyA.m_sweep.localCenter), this.m_localCenterB.Copy(this.m_bodyB.m_sweep.localCenter), 
                    this.m_invMassA = this.m_bodyA.m_invMass, this.m_invMassB = this.m_bodyB.m_invMass, 
                    this.m_invIA = this.m_bodyA.m_invI, this.m_invIB = this.m_bodyB.m_invI;
                    var e = t.positions[this.m_indexA].a, n = t.velocities[this.m_indexA].v, r = t.velocities[this.m_indexA].w, o = t.positions[this.m_indexB].a, a = t.velocities[this.m_indexB].v, c = t.velocities[this.m_indexB].w, l = this.m_qA.SetAngle(e), u = this.m_qB.SetAngle(o);
                    P.SubVV(this.m_localAnchorA, this.m_localCenterA, this.m_lalcA), O.MulRV(l, this.m_lalcA, this.m_rA), 
                    P.SubVV(this.m_localAnchorB, this.m_localCenterB, this.m_lalcB), O.MulRV(u, this.m_lalcB, this.m_rB);
                    var h = this.m_invMassA, _ = this.m_invMassB, f = this.m_invIA, d = this.m_invIB, p = this.m_K;
                    if (p.ex.x = h + _ + this.m_rA.y * this.m_rA.y * f + this.m_rB.y * this.m_rB.y * d, 
                    p.ey.x = -this.m_rA.y * this.m_rA.x * f - this.m_rB.y * this.m_rB.x * d, p.ez.x = -this.m_rA.y * f - this.m_rB.y * d, 
                    p.ex.y = p.ey.x, p.ey.y = h + _ + this.m_rA.x * this.m_rA.x * f + this.m_rB.x * this.m_rB.x * d, 
                    p.ez.y = this.m_rA.x * f + this.m_rB.x * d, p.ex.z = p.ez.x, p.ey.z = p.ez.y, p.ez.z = f + d, 
                    this.m_frequencyHz > 0) {
                        p.GetInverse22(this.m_mass);
                        var m = f + d, v = m > 0 ? 1 / m : 0, y = o - e - this.m_referenceAngle, g = 2 * s * this.m_frequencyHz, x = 2 * v * this.m_dampingRatio * g, A = v * g * g, C = t.step.dt;
                        this.m_gamma = C * (x + C * A), this.m_gamma = 0 !== this.m_gamma ? 1 / this.m_gamma : 0, 
                        this.m_bias = y * C * A * this.m_gamma, m += this.m_gamma, this.m_mass.ez.z = 0 !== m ? 1 / m : 0;
                    } else p.GetSymInverse33(this.m_mass), this.m_gamma = 0, this.m_bias = 0;
                    if (t.step.warmStarting) {
                        this.m_impulse.SelfMul(t.step.dtRatio);
                        var b = i.InitVelocityConstraints_s_P.Set(this.m_impulse.x, this.m_impulse.y);
                        n.SelfMulSub(h, b), r -= f * (P.CrossVV(this.m_rA, b) + this.m_impulse.z), a.SelfMulAdd(_, b), 
                        c += d * (P.CrossVV(this.m_rB, b) + this.m_impulse.z);
                    } else this.m_impulse.SetZero();
                    t.velocities[this.m_indexA].w = r, t.velocities[this.m_indexB].w = c;
                }, i.prototype.SolveVelocityConstraints = function(t) {
                    var e = t.velocities[this.m_indexA].v, n = t.velocities[this.m_indexA].w, r = t.velocities[this.m_indexB].v, s = t.velocities[this.m_indexB].w, o = this.m_invMassA, a = this.m_invMassB, c = this.m_invIA, l = this.m_invIB;
                    if (this.m_frequencyHz > 0) {
                        var u = s - n, h = -this.m_mass.ez.z * (u + this.m_bias + this.m_gamma * this.m_impulse.z);
                        this.m_impulse.z += h, n -= c * h, s += l * h;
                        var _ = P.SubVV(P.AddVCrossSV(r, s, this.m_rB, P.s_t0), P.AddVCrossSV(e, n, this.m_rA, P.s_t1), i.SolveVelocityConstraints_s_Cdot1), f = L.MulM33XY(this.m_mass, _.x, _.y, i.SolveVelocityConstraints_s_impulse1).SelfNeg();
                        this.m_impulse.x += f.x, this.m_impulse.y += f.y;
                        var d = f;
                        e.SelfMulSub(o, d), n -= c * P.CrossVV(this.m_rA, d), r.SelfMulAdd(a, d), s += l * P.CrossVV(this.m_rB, d);
                    } else {
                        _ = P.SubVV(P.AddVCrossSV(r, s, this.m_rB, P.s_t0), P.AddVCrossSV(e, n, this.m_rA, P.s_t1), i.SolveVelocityConstraints_s_Cdot1), 
                        u = s - n;
                        var p = L.MulM33XYZ(this.m_mass, _.x, _.y, u, i.SolveVelocityConstraints_s_impulse).SelfNeg();
                        this.m_impulse.SelfAdd(p), d = i.SolveVelocityConstraints_s_P.Set(p.x, p.y), e.SelfMulSub(o, d), 
                        n -= c * (P.CrossVV(this.m_rA, d) + p.z), r.SelfMulAdd(a, d), s += l * (P.CrossVV(this.m_rB, d) + p.z);
                    }
                    t.velocities[this.m_indexA].w = n, t.velocities[this.m_indexB].w = s;
                }, i.prototype.SolvePositionConstraints = function(t) {
                    var e = t.positions[this.m_indexA].c, n = t.positions[this.m_indexA].a, r = t.positions[this.m_indexB].c, s = t.positions[this.m_indexB].a, o = this.m_qA.SetAngle(n), a = this.m_qB.SetAngle(s), u = this.m_invMassA, h = this.m_invMassB, _ = this.m_invIA, f = this.m_invIB;
                    P.SubVV(this.m_localAnchorA, this.m_localCenterA, this.m_lalcA);
                    var d = O.MulRV(o, this.m_lalcA, this.m_rA);
                    P.SubVV(this.m_localAnchorB, this.m_localCenterB, this.m_lalcB);
                    var p, v, y = O.MulRV(a, this.m_lalcB, this.m_rB), g = this.m_K;
                    if (g.ex.x = u + h + d.y * d.y * _ + y.y * y.y * f, g.ey.x = -d.y * d.x * _ - y.y * y.x * f, 
                    g.ez.x = -d.y * _ - y.y * f, g.ex.y = g.ey.x, g.ey.y = u + h + d.x * d.x * _ + y.x * y.x * f, 
                    g.ez.y = d.x * _ + y.x * f, g.ex.z = g.ez.x, g.ey.z = g.ez.y, g.ez.z = _ + f, this.m_frequencyHz > 0) {
                        p = (A = P.SubVV(P.AddVV(r, y, P.s_t0), P.AddVV(e, d, P.s_t1), i.SolvePositionConstraints_s_C1)).Length(), 
                        v = 0;
                        var x = g.Solve22(A.x, A.y, i.SolvePositionConstraints_s_P).SelfNeg();
                        e.SelfMulSub(u, x), n -= _ * P.CrossVV(d, x), r.SelfMulAdd(h, x), s += f * P.CrossVV(y, x);
                    } else {
                        var A = P.SubVV(P.AddVV(r, y, P.s_t0), P.AddVV(e, d, P.s_t1), i.SolvePositionConstraints_s_C1), C = s - n - this.m_referenceAngle;
                        p = A.Length(), v = m(C);
                        var b = g.Solve33(A.x, A.y, C, i.SolvePositionConstraints_s_impulse).SelfNeg();
                        x = i.SolvePositionConstraints_s_P.Set(b.x, b.y), e.SelfMulSub(u, x), n -= _ * (P.CrossVV(this.m_rA, x) + b.z), 
                        r.SelfMulAdd(h, x), s += f * (P.CrossVV(this.m_rB, x) + b.z);
                    }
                    return t.positions[this.m_indexA].a = n, t.positions[this.m_indexB].a = s, p <= c && v <= l;
                }, i.prototype.GetAnchorA = function(t) {
                    return this.m_bodyA.GetWorldPoint(this.m_localAnchorA, t);
                }, i.prototype.GetAnchorB = function(t) {
                    return this.m_bodyB.GetWorldPoint(this.m_localAnchorB, t);
                }, i.prototype.GetReactionForce = function(t, e) {
                    return e.x = t * this.m_impulse.x, e.y = t * this.m_impulse.y, e;
                }, i.prototype.GetReactionTorque = function(t) {
                    return t * this.m_impulse.z;
                }, i.prototype.GetLocalAnchorA = function() {
                    return this.m_localAnchorA;
                }, i.prototype.GetLocalAnchorB = function() {
                    return this.m_localAnchorB;
                }, i.prototype.GetReferenceAngle = function() {
                    return this.m_referenceAngle;
                }, i.prototype.SetFrequency = function(t) {
                    this.m_frequencyHz = t;
                }, i.prototype.GetFrequency = function() {
                    return this.m_frequencyHz;
                }, i.prototype.SetDampingRatio = function(t) {
                    this.m_dampingRatio = t;
                }, i.prototype.GetDampingRatio = function() {
                    return this.m_dampingRatio;
                }, i.prototype.Dump = function(t) {
                    var e = this.m_bodyA.m_islandIndex, i = this.m_bodyB.m_islandIndex;
                    t("  const jd: b2WeldJointDef = new b2WeldJointDef();\n"), t("  jd.bodyA = bodies[%d];\n", e), 
                    t("  jd.bodyB = bodies[%d];\n", i), t("  jd.collideConnected = %s;\n", this.m_collideConnected ? "true" : "false"), 
                    t("  jd.localAnchorA.Set(%.15f, %.15f);\n", this.m_localAnchorA.x, this.m_localAnchorA.y), 
                    t("  jd.localAnchorB.Set(%.15f, %.15f);\n", this.m_localAnchorB.x, this.m_localAnchorB.y), 
                    t("  jd.referenceAngle = %.15f;\n", this.m_referenceAngle), t("  jd.frequencyHz = %.15f;\n", this.m_frequencyHz), 
                    t("  jd.dampingRatio = %.15f;\n", this.m_dampingRatio), t("  joints[%d] = this.m_world.CreateJoint(jd);\n", this.m_index);
                }, i.InitVelocityConstraints_s_P = new P(), i.SolveVelocityConstraints_s_Cdot1 = new P(), 
                i.SolveVelocityConstraints_s_impulse1 = new P(), i.SolveVelocityConstraints_s_impulse = new D(), 
                i.SolveVelocityConstraints_s_P = new P(), i.SolvePositionConstraints_s_C1 = new P(), 
                i.SolvePositionConstraints_s_P = new P(), i.SolvePositionConstraints_s_impulse = new D(), 
                i;
            }(mi), Gi = function(e) {
                function i() {
                    var i = e.call(this, t.b2JointType.e_wheelJoint) || this;
                    return i.localAnchorA = new P(0, 0), i.localAnchorB = new P(0, 0), i.localAxisA = new P(1, 0), 
                    i.enableMotor = !1, i.maxMotorTorque = 0, i.motorSpeed = 0, i.frequencyHz = 2, i.dampingRatio = .7, 
                    i;
                }
                return ti(i, e), i.prototype.Initialize = function(t, e, i, n) {
                    this.bodyA = t, this.bodyB = e, this.bodyA.GetLocalPoint(i, this.localAnchorA), 
                    this.bodyB.GetLocalPoint(i, this.localAnchorB), this.bodyA.GetLocalVector(n, this.localAxisA);
                }, i;
            }(pi), ki = function(t) {
                function i(i) {
                    var n = t.call(this, i) || this;
                    return n.m_frequencyHz = 0, n.m_dampingRatio = 0, n.m_localAnchorA = new P(), n.m_localAnchorB = new P(), 
                    n.m_localXAxisA = new P(), n.m_localYAxisA = new P(), n.m_impulse = 0, n.m_motorImpulse = 0, 
                    n.m_springImpulse = 0, n.m_maxMotorTorque = 0, n.m_motorSpeed = 0, n.m_enableMotor = !1, 
                    n.m_indexA = 0, n.m_indexB = 0, n.m_localCenterA = new P(), n.m_localCenterB = new P(), 
                    n.m_invMassA = 0, n.m_invMassB = 0, n.m_invIA = 0, n.m_invIB = 0, n.m_ax = new P(), 
                    n.m_ay = new P(), n.m_sAx = 0, n.m_sBx = 0, n.m_sAy = 0, n.m_sBy = 0, n.m_mass = 0, 
                    n.m_motorMass = 0, n.m_springMass = 0, n.m_bias = 0, n.m_gamma = 0, n.m_qA = new O(), 
                    n.m_qB = new O(), n.m_lalcA = new P(), n.m_lalcB = new P(), n.m_rA = new P(), n.m_rB = new P(), 
                    n.m_frequencyHz = e(i.frequencyHz, 2), n.m_dampingRatio = e(i.dampingRatio, .7), 
                    n.m_localAnchorA.Copy(e(i.localAnchorA, P.ZERO)), n.m_localAnchorB.Copy(e(i.localAnchorB, P.ZERO)), 
                    n.m_localXAxisA.Copy(e(i.localAxisA, P.UNITX)), P.CrossOneV(n.m_localXAxisA, n.m_localYAxisA), 
                    n.m_maxMotorTorque = e(i.maxMotorTorque, 0), n.m_motorSpeed = e(i.motorSpeed, 0), 
                    n.m_enableMotor = e(i.enableMotor, !1), n.m_ax.SetZero(), n.m_ay.SetZero(), n;
                }
                return ti(i, t), i.prototype.GetMotorSpeed = function() {
                    return this.m_motorSpeed;
                }, i.prototype.GetMaxMotorTorque = function() {
                    return this.m_maxMotorTorque;
                }, i.prototype.SetSpringFrequencyHz = function(t) {
                    this.m_frequencyHz = t;
                }, i.prototype.GetSpringFrequencyHz = function() {
                    return this.m_frequencyHz;
                }, i.prototype.SetSpringDampingRatio = function(t) {
                    this.m_dampingRatio = t;
                }, i.prototype.GetSpringDampingRatio = function() {
                    return this.m_dampingRatio;
                }, i.prototype.InitVelocityConstraints = function(t) {
                    this.m_indexA = this.m_bodyA.m_islandIndex, this.m_indexB = this.m_bodyB.m_islandIndex, 
                    this.m_localCenterA.Copy(this.m_bodyA.m_sweep.localCenter), this.m_localCenterB.Copy(this.m_bodyB.m_sweep.localCenter), 
                    this.m_invMassA = this.m_bodyA.m_invMass, this.m_invMassB = this.m_bodyB.m_invMass, 
                    this.m_invIA = this.m_bodyA.m_invI, this.m_invIB = this.m_bodyB.m_invI;
                    var e = this.m_invMassA, n = this.m_invMassB, r = this.m_invIA, o = this.m_invIB, a = t.positions[this.m_indexA].c, c = t.positions[this.m_indexA].a, l = t.velocities[this.m_indexA].v, u = t.velocities[this.m_indexA].w, h = t.positions[this.m_indexB].c, _ = t.positions[this.m_indexB].a, f = t.velocities[this.m_indexB].v, d = t.velocities[this.m_indexB].w, p = this.m_qA.SetAngle(c), m = this.m_qB.SetAngle(_);
                    P.SubVV(this.m_localAnchorA, this.m_localCenterA, this.m_lalcA);
                    var v = O.MulRV(p, this.m_lalcA, this.m_rA);
                    P.SubVV(this.m_localAnchorB, this.m_localCenterB, this.m_lalcB);
                    var y = O.MulRV(m, this.m_lalcB, this.m_rB), g = P.SubVV(P.AddVV(h, y, P.s_t0), P.AddVV(a, v, P.s_t1), i.InitVelocityConstraints_s_d);
                    if (O.MulRV(p, this.m_localYAxisA, this.m_ay), this.m_sAy = P.CrossVV(P.AddVV(g, v, P.s_t0), this.m_ay), 
                    this.m_sBy = P.CrossVV(y, this.m_ay), this.m_mass = e + n + r * this.m_sAy * this.m_sAy + o * this.m_sBy * this.m_sBy, 
                    this.m_mass > 0 && (this.m_mass = 1 / this.m_mass), this.m_springMass = 0, this.m_bias = 0, 
                    this.m_gamma = 0, this.m_frequencyHz > 0) {
                        O.MulRV(p, this.m_localXAxisA, this.m_ax), this.m_sAx = P.CrossVV(P.AddVV(g, v, P.s_t0), this.m_ax), 
                        this.m_sBx = P.CrossVV(y, this.m_ax);
                        var x = e + n + r * this.m_sAx * this.m_sAx + o * this.m_sBx * this.m_sBx;
                        if (x > 0) {
                            this.m_springMass = 1 / x;
                            var A = P.DotVV(g, this.m_ax), C = 2 * s * this.m_frequencyHz, b = 2 * this.m_springMass * this.m_dampingRatio * C, S = this.m_springMass * C * C, T = t.step.dt;
                            this.m_gamma = T * (b + T * S), this.m_gamma > 0 && (this.m_gamma = 1 / this.m_gamma), 
                            this.m_bias = A * T * S * this.m_gamma, this.m_springMass = x + this.m_gamma, this.m_springMass > 0 && (this.m_springMass = 1 / this.m_springMass);
                        }
                    } else this.m_springImpulse = 0;
                    if (this.m_enableMotor ? (this.m_motorMass = r + o, this.m_motorMass > 0 && (this.m_motorMass = 1 / this.m_motorMass)) : (this.m_motorMass = 0, 
                    this.m_motorImpulse = 0), t.step.warmStarting) {
                        this.m_impulse *= t.step.dtRatio, this.m_springImpulse *= t.step.dtRatio, this.m_motorImpulse *= t.step.dtRatio;
                        var w = P.AddVV(P.MulSV(this.m_impulse, this.m_ay, P.s_t0), P.MulSV(this.m_springImpulse, this.m_ax, P.s_t1), i.InitVelocityConstraints_s_P), E = this.m_impulse * this.m_sAy + this.m_springImpulse * this.m_sAx + this.m_motorImpulse, B = this.m_impulse * this.m_sBy + this.m_springImpulse * this.m_sBx + this.m_motorImpulse;
                        l.SelfMulSub(this.m_invMassA, w), u -= this.m_invIA * E, f.SelfMulAdd(this.m_invMassB, w), 
                        d += this.m_invIB * B;
                    } else this.m_impulse = 0, this.m_springImpulse = 0, this.m_motorImpulse = 0;
                    t.velocities[this.m_indexA].w = u, t.velocities[this.m_indexB].w = d;
                }, i.prototype.SolveVelocityConstraints = function(t) {
                    var e = this.m_invMassA, n = this.m_invMassB, r = this.m_invIA, s = this.m_invIB, o = t.velocities[this.m_indexA].v, a = t.velocities[this.m_indexA].w, c = t.velocities[this.m_indexB].v, l = t.velocities[this.m_indexB].w, u = P.DotVV(this.m_ax, P.SubVV(c, o, P.s_t0)) + this.m_sBx * l - this.m_sAx * a, h = -this.m_springMass * (u + this.m_bias + this.m_gamma * this.m_springImpulse);
                    this.m_springImpulse += h;
                    var _ = P.MulSV(h, this.m_ax, i.SolveVelocityConstraints_s_P), f = h * this.m_sAx, d = h * this.m_sBx;
                    o.SelfMulSub(e, _), a -= r * f, c.SelfMulAdd(n, _), u = (l += s * d) - a - this.m_motorSpeed, 
                    h = -this.m_motorMass * u;
                    var p = this.m_motorImpulse, m = t.step.dt * this.m_maxMotorTorque;
                    this.m_motorImpulse = g(this.m_motorImpulse + h, -m, m), a -= r * (h = this.m_motorImpulse - p), 
                    l += s * h, u = P.DotVV(this.m_ay, P.SubVV(c, o, P.s_t0)) + this.m_sBy * l - this.m_sAy * a, 
                    h = -this.m_mass * u, this.m_impulse += h, _ = P.MulSV(h, this.m_ay, i.SolveVelocityConstraints_s_P), 
                    f = h * this.m_sAy, d = h * this.m_sBy, o.SelfMulSub(e, _), a -= r * f, c.SelfMulAdd(n, _), 
                    l += s * d, t.velocities[this.m_indexA].w = a, t.velocities[this.m_indexB].w = l;
                }, i.prototype.SolvePositionConstraints = function(t) {
                    var e = t.positions[this.m_indexA].c, n = t.positions[this.m_indexA].a, r = t.positions[this.m_indexB].c, s = t.positions[this.m_indexB].a, o = this.m_qA.SetAngle(n), a = this.m_qB.SetAngle(s);
                    P.SubVV(this.m_localAnchorA, this.m_localCenterA, this.m_lalcA);
                    var l = O.MulRV(o, this.m_lalcA, this.m_rA);
                    P.SubVV(this.m_localAnchorB, this.m_localCenterB, this.m_lalcB);
                    var u, h = O.MulRV(a, this.m_lalcB, this.m_rB), _ = P.AddVV(P.SubVV(r, e, P.s_t0), P.SubVV(h, l, P.s_t1), i.SolvePositionConstraints_s_d), f = O.MulRV(o, this.m_localYAxisA, this.m_ay), d = P.CrossVV(P.AddVV(_, l, P.s_t0), f), p = P.CrossVV(h, f), v = P.DotVV(_, this.m_ay), y = this.m_invMassA + this.m_invMassB + this.m_invIA * this.m_sAy * this.m_sAy + this.m_invIB * this.m_sBy * this.m_sBy;
                    u = 0 !== y ? -v / y : 0;
                    var g = P.MulSV(u, f, i.SolvePositionConstraints_s_P), x = u * d, A = u * p;
                    return e.SelfMulSub(this.m_invMassA, g), n -= this.m_invIA * x, r.SelfMulAdd(this.m_invMassB, g), 
                    s += this.m_invIB * A, t.positions[this.m_indexA].a = n, t.positions[this.m_indexB].a = s, 
                    m(v) <= c;
                }, i.prototype.GetDefinition = function(t) {
                    return t;
                }, i.prototype.GetAnchorA = function(t) {
                    return this.m_bodyA.GetWorldPoint(this.m_localAnchorA, t);
                }, i.prototype.GetAnchorB = function(t) {
                    return this.m_bodyB.GetWorldPoint(this.m_localAnchorB, t);
                }, i.prototype.GetReactionForce = function(t, e) {
                    return e.x = t * (this.m_impulse * this.m_ay.x + this.m_springImpulse * this.m_ax.x), 
                    e.y = t * (this.m_impulse * this.m_ay.y + this.m_springImpulse * this.m_ax.y), e;
                }, i.prototype.GetReactionTorque = function(t) {
                    return t * this.m_motorImpulse;
                }, i.prototype.GetLocalAnchorA = function() {
                    return this.m_localAnchorA;
                }, i.prototype.GetLocalAnchorB = function() {
                    return this.m_localAnchorB;
                }, i.prototype.GetLocalAxisA = function() {
                    return this.m_localXAxisA;
                }, i.prototype.GetJointTranslation = function() {
                    return this.GetPrismaticJointTranslation();
                }, i.prototype.GetJointLinearSpeed = function() {
                    return this.GetPrismaticJointSpeed();
                }, i.prototype.GetJointAngle = function() {
                    return this.GetRevoluteJointAngle();
                }, i.prototype.GetJointAngularSpeed = function() {
                    return this.GetRevoluteJointSpeed();
                }, i.prototype.GetPrismaticJointTranslation = function() {
                    var t = this.m_bodyA, e = this.m_bodyB, i = t.GetWorldPoint(this.m_localAnchorA, new P()), n = e.GetWorldPoint(this.m_localAnchorB, new P()), r = P.SubVV(n, i, new P()), s = t.GetWorldVector(this.m_localXAxisA, new P());
                    return P.DotVV(r, s);
                }, i.prototype.GetPrismaticJointSpeed = function() {
                    var t = this.m_bodyA, e = this.m_bodyB;
                    P.SubVV(this.m_localAnchorA, t.m_sweep.localCenter, this.m_lalcA);
                    var i = O.MulRV(t.m_xf.q, this.m_lalcA, this.m_rA);
                    P.SubVV(this.m_localAnchorB, e.m_sweep.localCenter, this.m_lalcB);
                    var n = O.MulRV(e.m_xf.q, this.m_lalcB, this.m_rB), r = P.AddVV(t.m_sweep.c, i, P.s_t0), s = P.AddVV(e.m_sweep.c, n, P.s_t1), o = P.SubVV(s, r, P.s_t2), a = t.GetWorldVector(this.m_localXAxisA, new P()), c = t.m_linearVelocity, l = e.m_linearVelocity, u = t.m_angularVelocity, h = e.m_angularVelocity;
                    return P.DotVV(o, P.CrossSV(u, a, P.s_t0)) + P.DotVV(a, P.SubVV(P.AddVCrossSV(l, h, n, P.s_t0), P.AddVCrossSV(c, u, i, P.s_t1), P.s_t0));
                }, i.prototype.GetRevoluteJointAngle = function() {
                    return this.m_bodyB.m_sweep.a - this.m_bodyA.m_sweep.a;
                }, i.prototype.GetRevoluteJointSpeed = function() {
                    var t = this.m_bodyA.m_angularVelocity;
                    return this.m_bodyB.m_angularVelocity - t;
                }, i.prototype.IsMotorEnabled = function() {
                    return this.m_enableMotor;
                }, i.prototype.EnableMotor = function(t) {
                    t !== this.m_enableMotor && (this.m_bodyA.SetAwake(!0), this.m_bodyB.SetAwake(!0), 
                    this.m_enableMotor = t);
                }, i.prototype.SetMotorSpeed = function(t) {
                    t !== this.m_motorSpeed && (this.m_bodyA.SetAwake(!0), this.m_bodyB.SetAwake(!0), 
                    this.m_motorSpeed = t);
                }, i.prototype.SetMaxMotorTorque = function(t) {
                    t !== this.m_maxMotorTorque && (this.m_bodyA.SetAwake(!0), this.m_bodyB.SetAwake(!0), 
                    this.m_maxMotorTorque = t);
                }, i.prototype.GetMotorTorque = function(t) {
                    return t * this.m_motorImpulse;
                }, i.prototype.Dump = function(t) {
                    var e = this.m_bodyA.m_islandIndex, i = this.m_bodyB.m_islandIndex;
                    t("  const jd: b2WheelJointDef = new b2WheelJointDef();\n"), t("  jd.bodyA = bodies[%d];\n", e), 
                    t("  jd.bodyB = bodies[%d];\n", i), t("  jd.collideConnected = %s;\n", this.m_collideConnected ? "true" : "false"), 
                    t("  jd.localAnchorA.Set(%.15f, %.15f);\n", this.m_localAnchorA.x, this.m_localAnchorA.y), 
                    t("  jd.localAnchorB.Set(%.15f, %.15f);\n", this.m_localAnchorB.x, this.m_localAnchorB.y), 
                    t("  jd.localAxisA.Set(%.15f, %.15f);\n", this.m_localXAxisA.x, this.m_localXAxisA.y), 
                    t("  jd.enableMotor = %s;\n", this.m_enableMotor ? "true" : "false"), t("  jd.motorSpeed = %.15f;\n", this.m_motorSpeed), 
                    t("  jd.maxMotorTorque = %.15f;\n", this.m_maxMotorTorque), t("  jd.frequencyHz = %.15f;\n", this.m_frequencyHz), 
                    t("  jd.dampingRatio = %.15f;\n", this.m_dampingRatio), t("  joints[%d] = this.m_world.CreateJoint(jd);\n", this.m_index);
                }, i.InitVelocityConstraints_s_d = new P(), i.InitVelocityConstraints_s_P = new P(), 
                i.SolveVelocityConstraints_s_P = new P(), i.SolvePositionConstraints_s_d = new P(), 
                i.SolvePositionConstraints_s_P = new P(), i;
            }(mi);
            function zi(t, e) {
                return S(t * e);
            }
            function Ui(t, e) {
                return t > e ? t : e;
            }
            var Hi, Wi = function(t) {
                this.prev = null, this.next = null, this.contact = t;
            }, ji = function() {
                function t() {
                    this.m_islandFlag = !1, this.m_touchingFlag = !1, this.m_enabledFlag = !1, this.m_filterFlag = !1, 
                    this.m_bulletHitFlag = !1, this.m_toiFlag = !1, this.m_prev = null, this.m_next = null, 
                    this.m_indexA = 0, this.m_indexB = 0, this.m_manifold = new gt(), this.m_toiCount = 0, 
                    this.m_toi = 0, this.m_friction = 0, this.m_restitution = 0, this.m_tangentSpeed = 0, 
                    this.m_oldManifold = new gt(), this.m_nodeA = new Wi(this), this.m_nodeB = new Wi(this);
                }
                return t.prototype.GetManifold = function() {
                    return this.m_manifold;
                }, t.prototype.GetWorldManifold = function(t) {
                    var e = this.m_fixtureA.GetBody(), i = this.m_fixtureB.GetBody(), n = this.m_fixtureA.GetShape(), r = this.m_fixtureB.GetShape();
                    t.Initialize(this.m_manifold, e.GetTransform(), n.m_radius, i.GetTransform(), r.m_radius);
                }, t.prototype.IsTouching = function() {
                    return this.m_touchingFlag;
                }, t.prototype.SetEnabled = function(t) {
                    this.m_enabledFlag = t;
                }, t.prototype.IsEnabled = function() {
                    return this.m_enabledFlag;
                }, t.prototype.GetNext = function() {
                    return this.m_next;
                }, t.prototype.GetFixtureA = function() {
                    return this.m_fixtureA;
                }, t.prototype.GetChildIndexA = function() {
                    return this.m_indexA;
                }, t.prototype.GetFixtureB = function() {
                    return this.m_fixtureB;
                }, t.prototype.GetChildIndexB = function() {
                    return this.m_indexB;
                }, t.prototype.FlagForFiltering = function() {
                    this.m_filterFlag = !0;
                }, t.prototype.SetFriction = function(t) {
                    this.m_friction = t;
                }, t.prototype.GetFriction = function() {
                    return this.m_friction;
                }, t.prototype.ResetFriction = function() {
                    this.m_friction = zi(this.m_fixtureA.m_friction, this.m_fixtureB.m_friction);
                }, t.prototype.SetRestitution = function(t) {
                    this.m_restitution = t;
                }, t.prototype.GetRestitution = function() {
                    return this.m_restitution;
                }, t.prototype.ResetRestitution = function() {
                    this.m_restitution = Ui(this.m_fixtureA.m_restitution, this.m_fixtureB.m_restitution);
                }, t.prototype.SetTangentSpeed = function(t) {
                    this.m_tangentSpeed = t;
                }, t.prototype.GetTangentSpeed = function() {
                    return this.m_tangentSpeed;
                }, t.prototype.Reset = function(t, e, i, n) {
                    this.m_islandFlag = !1, this.m_touchingFlag = !1, this.m_enabledFlag = !0, this.m_filterFlag = !1, 
                    this.m_bulletHitFlag = !1, this.m_toiFlag = !1, this.m_fixtureA = t, this.m_fixtureB = i, 
                    this.m_indexA = e, this.m_indexB = n, this.m_manifold.pointCount = 0, this.m_prev = null, 
                    this.m_next = null, delete this.m_nodeA.contact, this.m_nodeA.prev = null, this.m_nodeA.next = null, 
                    delete this.m_nodeA.other, delete this.m_nodeB.contact, this.m_nodeB.prev = null, 
                    this.m_nodeB.next = null, delete this.m_nodeB.other, this.m_toiCount = 0, this.m_friction = zi(this.m_fixtureA.m_friction, this.m_fixtureB.m_friction), 
                    this.m_restitution = Ui(this.m_fixtureA.m_restitution, this.m_fixtureB.m_restitution);
                }, t.prototype.Update = function(t) {
                    var e = this.m_oldManifold;
                    this.m_oldManifold = this.m_manifold, this.m_manifold = e, this.m_enabledFlag = !0;
                    var i = !1, n = this.m_touchingFlag, r = this.m_fixtureA.IsSensor(), s = this.m_fixtureB.IsSensor(), o = r || s, a = this.m_fixtureA.GetBody(), c = this.m_fixtureB.GetBody(), l = a.GetTransform(), u = c.GetTransform();
                    if (o) {
                        var h = this.m_fixtureA.GetShape(), _ = this.m_fixtureB.GetShape();
                        i = Rt(h, this.m_indexA, _, this.m_indexB, l, u), this.m_manifold.pointCount = 0;
                    } else {
                        this.Evaluate(this.m_manifold, l, u), i = this.m_manifold.pointCount > 0;
                        for (var f = 0; f < this.m_manifold.pointCount; ++f) {
                            var d = this.m_manifold.points[f];
                            d.normalImpulse = 0, d.tangentImpulse = 0;
                            for (var p = d.id, m = 0; m < this.m_oldManifold.pointCount; ++m) {
                                var v = this.m_oldManifold.points[m];
                                if (v.id.key === p.key) {
                                    d.normalImpulse = v.normalImpulse, d.tangentImpulse = v.tangentImpulse;
                                    break;
                                }
                            }
                        }
                        i !== n && (a.SetAwake(!0), c.SetAwake(!0));
                    }
                    this.m_touchingFlag = i, !n && i && t && t.BeginContact(this), n && !i && t && t.EndContact(this), 
                    !o && i && t && t.PreSolve(this, this.m_oldManifold);
                }, t.prototype.ComputeTOI = function(e, i) {
                    var n = t.ComputeTOI_s_input;
                    n.proxyA.SetShape(this.m_fixtureA.GetShape(), this.m_indexA), n.proxyB.SetShape(this.m_fixtureB.GetShape(), this.m_indexB), 
                    n.sweepA.Copy(e), n.sweepB.Copy(i), n.tMax = c;
                    var r = t.ComputeTOI_s_output;
                    return re(r, n), r.t;
                }, t.ComputeTOI_s_input = new jt(), t.ComputeTOI_s_output = new Xt(), t;
            }(), qi = function(t) {
                function e() {
                    return t.call(this) || this;
                }
                return ti(e, t), e.Create = function() {
                    return new e();
                }, e.Destroy = function() {}, e.prototype.Reset = function(e, i, n, r) {
                    t.prototype.Reset.call(this, e, i, n, r);
                }, e.prototype.Evaluate = function(t, e, i) {
                    ae(t, this.m_fixtureA.GetShape(), e, this.m_fixtureB.GetShape(), i);
                }, e;
            }(ji), Xi = function(t) {
                function e() {
                    return t.call(this) || this;
                }
                return ti(e, t), e.Create = function() {
                    return new e();
                }, e.Destroy = function() {}, e.prototype.Reset = function(e, i, n, r) {
                    t.prototype.Reset.call(this, e, i, n, r);
                }, e.prototype.Evaluate = function(t, e, i) {
                    Le(t, this.m_fixtureA.GetShape(), e, this.m_fixtureB.GetShape(), i);
                }, e;
            }(ji), Yi = function(t) {
                function e() {
                    return t.call(this) || this;
                }
                return ti(e, t), e.Create = function() {
                    return new e();
                }, e.Destroy = function() {}, e.prototype.Reset = function(e, i, n, r) {
                    t.prototype.Reset.call(this, e, i, n, r);
                }, e.prototype.Evaluate = function(t, e, i) {
                    he(t, this.m_fixtureA.GetShape(), e, this.m_fixtureB.GetShape(), i);
                }, e;
            }(ji), Ji = function(t) {
                function e() {
                    return t.call(this) || this;
                }
                return ti(e, t), e.Create = function() {
                    return new e();
                }, e.Destroy = function() {}, e.prototype.Reset = function(e, i, n, r) {
                    t.prototype.Reset.call(this, e, i, n, r);
                }, e.prototype.Evaluate = function(t, e, i) {
                    We(t, this.m_fixtureA.GetShape(), e, this.m_fixtureB.GetShape(), i);
                }, e;
            }(ji), Zi = function(t) {
                function e() {
                    return t.call(this) || this;
                }
                return ti(e, t), e.Create = function() {
                    return new e();
                }, e.Destroy = function() {}, e.prototype.Reset = function(e, i, n, r) {
                    t.prototype.Reset.call(this, e, i, n, r);
                }, e.prototype.Evaluate = function(t, e, i) {
                    Je(t, this.m_fixtureA.GetShape(), e, this.m_fixtureB.GetShape(), i);
                }, e;
            }(ji), Ki = function(t) {
                function e() {
                    return t.call(this) || this;
                }
                return ti(e, t), e.Create = function() {
                    return new e();
                }, e.Destroy = function() {}, e.prototype.Reset = function(e, i, n, r) {
                    t.prototype.Reset.call(this, e, i, n, r);
                }, e.prototype.Evaluate = function(t, i, n) {
                    var r = this.m_fixtureA.GetShape(), s = this.m_fixtureB.GetShape(), o = r, a = e.Evaluate_s_edge;
                    o.GetChildEdge(a, this.m_indexA), We(t, a, i, s, n);
                }, e.Evaluate_s_edge = new ri(), e;
            }(ji), Qi = function(t) {
                function e() {
                    return t.call(this) || this;
                }
                return ti(e, t), e.Create = function() {
                    return new e();
                }, e.Destroy = function() {}, e.prototype.Reset = function(e, i, n, r) {
                    t.prototype.Reset.call(this, e, i, n, r);
                }, e.prototype.Evaluate = function(t, i, n) {
                    var r = this.m_fixtureA.GetShape(), s = this.m_fixtureB.GetShape(), o = r, a = e.Evaluate_s_edge;
                    o.GetChildEdge(a, this.m_indexA), Je(t, a, i, s, n);
                }, e.Evaluate_s_edge = new ri(), e;
            }(ji), $i = function() {
                this.createFcn = null, this.destroyFcn = null, this.primary = !1;
            }, tn = function() {
                function e(t) {
                    this.m_allocator = null, this.m_allocator = t, this.InitializeRegisters();
                }
                return e.prototype.AddType = function(t, e, i, n) {
                    var r = this, s = d(256, function() {
                        return t(r.m_allocator);
                    });
                    function o(e) {
                        return s.pop() || t(e);
                    }
                    function a(t) {
                        s.push(t);
                    }
                    this.m_registers[i][n].createFcn = o, this.m_registers[i][n].destroyFcn = a, this.m_registers[i][n].primary = !0, 
                    i !== n && (this.m_registers[n][i].createFcn = o, this.m_registers[n][i].destroyFcn = a, 
                    this.m_registers[n][i].primary = !1);
                }, e.prototype.InitializeRegisters = function() {
                    this.m_registers = [];
                    for (var e = 0; e < t.b2ShapeType.e_shapeTypeCount; e++) {
                        this.m_registers[e] = [];
                        for (var i = 0; i < t.b2ShapeType.e_shapeTypeCount; i++) this.m_registers[e][i] = new $i();
                    }
                    this.AddType(qi.Create, qi.Destroy, t.b2ShapeType.e_circleShape, t.b2ShapeType.e_circleShape), 
                    this.AddType(Yi.Create, Yi.Destroy, t.b2ShapeType.e_polygonShape, t.b2ShapeType.e_circleShape), 
                    this.AddType(Xi.Create, Xi.Destroy, t.b2ShapeType.e_polygonShape, t.b2ShapeType.e_polygonShape), 
                    this.AddType(Ji.Create, Ji.Destroy, t.b2ShapeType.e_edgeShape, t.b2ShapeType.e_circleShape), 
                    this.AddType(Zi.Create, Zi.Destroy, t.b2ShapeType.e_edgeShape, t.b2ShapeType.e_polygonShape), 
                    this.AddType(Ki.Create, Ki.Destroy, t.b2ShapeType.e_chainShape, t.b2ShapeType.e_circleShape), 
                    this.AddType(Qi.Create, Qi.Destroy, t.b2ShapeType.e_chainShape, t.b2ShapeType.e_polygonShape);
                }, e.prototype.Create = function(t, e, i, n) {
                    var r = t.GetType(), s = i.GetType(), o = this.m_registers[r][s];
                    if (o.createFcn) {
                        var a = o.createFcn(this.m_allocator);
                        return o.primary ? a.Reset(t, e, i, n) : a.Reset(i, n, t, e), a;
                    }
                    return null;
                }, e.prototype.Destroy = function(t) {
                    var e = t.m_fixtureA, i = t.m_fixtureB;
                    t.m_manifold.pointCount > 0 && !e.IsSensor() && !i.IsSensor() && (e.GetBody().SetAwake(!0), 
                    i.GetBody().SetAwake(!0));
                    var n = e.GetType(), r = i.GetType(), s = this.m_registers[n][r];
                    s.destroyFcn && s.destroyFcn(t, this.m_allocator);
                }, e;
            }(), en = function() {
                function t() {}
                return t.prototype.SayGoodbyeJoint = function() {}, t.prototype.SayGoodbyeFixture = function() {}, 
                t.prototype.SayGoodbyeParticleGroup = function() {}, t.prototype.SayGoodbyeParticle = function() {}, 
                t;
            }(), nn = function() {
                function e() {}
                return e.prototype.ShouldCollide = function(e, i) {
                    var n = e.GetBody(), r = i.GetBody();
                    if (r.GetType() === t.b2BodyType.b2_staticBody && n.GetType() === t.b2BodyType.b2_staticBody) return !1;
                    if (!r.ShouldCollideConnected(n)) return !1;
                    var s = e.GetFilterData(), o = i.GetFilterData();
                    return s.groupIndex === o.groupIndex && 0 !== s.groupIndex ? s.groupIndex > 0 : 0 != (s.maskBits & o.categoryBits) && 0 != (s.categoryBits & o.maskBits);
                }, e.prototype.ShouldCollideFixtureParticle = function() {
                    return !0;
                }, e.prototype.ShouldCollideParticleParticle = function() {
                    return !0;
                }, e.b2_defaultFilter = new e(), e;
            }(), rn = function() {
                this.normalImpulses = p(o), this.tangentImpulses = p(o), this.count = 0;
            }, sn = function() {
                function t() {}
                return t.prototype.BeginContact = function() {}, t.prototype.EndContact = function() {}, 
                t.prototype.BeginContactFixtureParticle = function() {}, t.prototype.EndContactFixtureParticle = function() {}, 
                t.prototype.BeginContactParticleParticle = function() {}, t.prototype.EndContactParticleParticle = function() {}, 
                t.prototype.PreSolve = function() {}, t.prototype.PostSolve = function() {}, t.b2_defaultListener = new t(), 
                t;
            }(), on = function() {
                function t() {}
                return t.prototype.ReportFixture = function() {
                    return !0;
                }, t.prototype.ReportParticle = function() {
                    return !1;
                }, t.prototype.ShouldQueryParticleSystem = function() {
                    return !0;
                }, t;
            }(), an = function() {
                function t() {}
                return t.prototype.ReportFixture = function(t, e, i, n) {
                    return n;
                }, t.prototype.ReportParticle = function() {
                    return 0;
                }, t.prototype.ShouldQueryParticleSystem = function() {
                    return !0;
                }, t;
            }(), cn = function() {
                function e() {
                    this.m_broadPhase = new Lt(), this.m_contactList = null, this.m_contactCount = 0, 
                    this.m_contactFilter = nn.b2_defaultFilter, this.m_contactListener = sn.b2_defaultListener, 
                    this.m_allocator = null, this.m_contactFactory = new tn(this.m_allocator);
                }
                return e.prototype.AddPair = function(t, e) {
                    var i = t.fixture, n = e.fixture, r = t.childIndex, s = e.childIndex, o = i.GetBody(), a = n.GetBody();
                    if (o !== a) {
                        for (var c = a.GetContactList(); c; ) {
                            if (c.other === o) {
                                var l = c.contact.GetFixtureA(), u = c.contact.GetFixtureB(), h = c.contact.GetChildIndexA(), _ = c.contact.GetChildIndexB();
                                if (l === i && u === n && h === r && _ === s) return;
                                if (l === n && u === i && h === s && _ === r) return;
                            }
                            c = c.next;
                        }
                        if (!this.m_contactFilter || this.m_contactFilter.ShouldCollide(i, n)) {
                            var f = this.m_contactFactory.Create(i, r, n, s);
                            null !== f && (i = f.GetFixtureA(), n = f.GetFixtureB(), r = f.GetChildIndexA(), 
                            s = f.GetChildIndexB(), o = i.m_body, a = n.m_body, f.m_prev = null, f.m_next = this.m_contactList, 
                            null !== this.m_contactList && (this.m_contactList.m_prev = f), this.m_contactList = f, 
                            f.m_nodeA.contact = f, f.m_nodeA.other = a, f.m_nodeA.prev = null, f.m_nodeA.next = o.m_contactList, 
                            null !== o.m_contactList && (o.m_contactList.prev = f.m_nodeA), o.m_contactList = f.m_nodeA, 
                            f.m_nodeB.contact = f, f.m_nodeB.other = o, f.m_nodeB.prev = null, f.m_nodeB.next = a.m_contactList, 
                            null !== a.m_contactList && (a.m_contactList.prev = f.m_nodeB), a.m_contactList = f.m_nodeB, 
                            i.IsSensor() || n.IsSensor() || (o.SetAwake(!0), a.SetAwake(!0)), ++this.m_contactCount);
                        }
                    }
                }, e.prototype.FindNewContacts = function() {
                    var t = this;
                    this.m_broadPhase.UpdatePairs(function(e, i) {
                        t.AddPair(e, i);
                    });
                }, e.prototype.Destroy = function(t) {
                    var e = t.GetFixtureA(), i = t.GetFixtureB(), n = e.GetBody(), r = i.GetBody();
                    this.m_contactListener && t.IsTouching() && this.m_contactListener.EndContact(t), 
                    t.m_prev && (t.m_prev.m_next = t.m_next), t.m_next && (t.m_next.m_prev = t.m_prev), 
                    t === this.m_contactList && (this.m_contactList = t.m_next), t.m_nodeA.prev && (t.m_nodeA.prev.next = t.m_nodeA.next), 
                    t.m_nodeA.next && (t.m_nodeA.next.prev = t.m_nodeA.prev), t.m_nodeA === n.m_contactList && (n.m_contactList = t.m_nodeA.next), 
                    t.m_nodeB.prev && (t.m_nodeB.prev.next = t.m_nodeB.next), t.m_nodeB.next && (t.m_nodeB.next.prev = t.m_nodeB.prev), 
                    t.m_nodeB === r.m_contactList && (r.m_contactList = t.m_nodeB.next), this.m_contactFactory.Destroy(t), 
                    --this.m_contactCount;
                }, e.prototype.Collide = function() {
                    for (var e = this.m_contactList; e; ) {
                        var i = e.GetFixtureA(), n = e.GetFixtureB(), r = e.GetChildIndexA(), s = e.GetChildIndexB(), o = i.GetBody(), a = n.GetBody();
                        if (e.m_filterFlag) {
                            if (this.m_contactFilter && !this.m_contactFilter.ShouldCollide(i, n)) {
                                e = (u = e).m_next, this.Destroy(u);
                                continue;
                            }
                            e.m_filterFlag = !1;
                        }
                        var c = o.IsAwake() && o.m_type !== t.b2BodyType.b2_staticBody, l = a.IsAwake() && a.m_type !== t.b2BodyType.b2_staticBody;
                        if (c || l) {
                            var u, h = i.m_proxies[r].treeNode, _ = n.m_proxies[s].treeNode;
                            Tt(h.aabb, _.aabb) ? (e.Update(this.m_contactListener), e = e.m_next) : (e = (u = e).m_next, 
                            this.Destroy(u));
                        } else e = e.m_next;
                    }
                }, e;
            }(), ln = function() {
                function t() {
                    this.step = 0, this.collide = 0, this.solve = 0, this.solveInit = 0, this.solveVelocity = 0, 
                    this.solvePosition = 0, this.broadphase = 0, this.solveTOI = 0;
                }
                return t.prototype.Reset = function() {
                    return this.step = 0, this.collide = 0, this.solve = 0, this.solveInit = 0, this.solveVelocity = 0, 
                    this.solvePosition = 0, this.broadphase = 0, this.solveTOI = 0, this;
                }, t;
            }(), un = function() {
                function t() {
                    this.dt = 0, this.inv_dt = 0, this.dtRatio = 0, this.velocityIterations = 0, this.positionIterations = 0, 
                    this.particleIterations = 0, this.warmStarting = !1;
                }
                return t.prototype.Copy = function(t) {
                    return this.dt = t.dt, this.inv_dt = t.inv_dt, this.dtRatio = t.dtRatio, this.positionIterations = t.positionIterations, 
                    this.velocityIterations = t.velocityIterations, this.particleIterations = t.particleIterations, 
                    this.warmStarting = t.warmStarting, this;
                }, t;
            }(), hn = function() {
                function t() {
                    this.c = new P(), this.a = 0;
                }
                return t.MakeArray = function(e) {
                    return d(e, function() {
                        return new t();
                    });
                }, t;
            }(), _n = function() {
                function t() {
                    this.v = new P(), this.w = 0;
                }
                return t.MakeArray = function(e) {
                    return d(e, function() {
                        return new t();
                    });
                }, t;
            }(), fn = function() {
                this.step = new un();
            }, dn = function() {
                function t() {
                    this.rA = new P(), this.rB = new P(), this.normalImpulse = 0, this.tangentImpulse = 0, 
                    this.normalMass = 0, this.tangentMass = 0, this.velocityBias = 0;
                }
                return t.MakeArray = function(e) {
                    return d(e, function() {
                        return new t();
                    });
                }, t;
            }(), pn = function() {
                function t() {
                    this.points = dn.MakeArray(o), this.normal = new P(), this.tangent = new P(), this.normalMass = new V(), 
                    this.K = new V(), this.indexA = 0, this.indexB = 0, this.invMassA = 0, this.invMassB = 0, 
                    this.invIA = 0, this.invIB = 0, this.friction = 0, this.restitution = 0, this.tangentSpeed = 0, 
                    this.pointCount = 0, this.contactIndex = 0;
                }
                return t.MakeArray = function(e) {
                    return d(e, function() {
                        return new t();
                    });
                }, t;
            }(), mn = function() {
                function e() {
                    this.localPoints = P.MakeArray(o), this.localNormal = new P(), this.localPoint = new P(), 
                    this.indexA = 0, this.indexB = 0, this.invMassA = 0, this.invMassB = 0, this.localCenterA = new P(), 
                    this.localCenterB = new P(), this.invIA = 0, this.invIB = 0, this.type = t.b2ManifoldType.e_unknown, 
                    this.radiusA = 0, this.radiusB = 0, this.pointCount = 0;
                }
                return e.MakeArray = function(t) {
                    return d(t, function() {
                        return new e();
                    });
                }, e;
            }(), vn = function() {
                this.step = new un(), this.count = 0, this.allocator = null;
            }, yn = function() {
                function e() {
                    this.normal = new P(), this.point = new P(), this.separation = 0;
                }
                return e.prototype.Initialize = function(i, n, r, s) {
                    var o = e.Initialize_s_pointA, a = e.Initialize_s_pointB, c = e.Initialize_s_planePoint, l = e.Initialize_s_clipPoint;
                    switch (i.type) {
                      case t.b2ManifoldType.e_circles:
                        F.MulXV(n, i.localPoint, o), F.MulXV(r, i.localPoints[0], a), P.SubVV(a, o, this.normal).SelfNormalize(), 
                        P.MidVV(o, a, this.point), this.separation = P.DotVV(P.SubVV(a, o, P.s_t0), this.normal) - i.radiusA - i.radiusB;
                        break;

                      case t.b2ManifoldType.e_faceA:
                        O.MulRV(n.q, i.localNormal, this.normal), F.MulXV(n, i.localPoint, c), F.MulXV(r, i.localPoints[s], l), 
                        this.separation = P.DotVV(P.SubVV(l, c, P.s_t0), this.normal) - i.radiusA - i.radiusB, 
                        this.point.Copy(l);
                        break;

                      case t.b2ManifoldType.e_faceB:
                        O.MulRV(r.q, i.localNormal, this.normal), F.MulXV(r, i.localPoint, c), F.MulXV(n, i.localPoints[s], l), 
                        this.separation = P.DotVV(P.SubVV(l, c, P.s_t0), this.normal) - i.radiusA - i.radiusB, 
                        this.point.Copy(l), this.normal.SelfNeg();
                    }
                }, e.Initialize_s_pointA = new P(), e.Initialize_s_pointB = new P(), e.Initialize_s_planePoint = new P(), 
                e.Initialize_s_clipPoint = new P(), e;
            }(), gn = function() {
                function t() {
                    this.m_step = new un(), this.m_allocator = null, this.m_positionConstraints = mn.MakeArray(1024), 
                    this.m_velocityConstraints = pn.MakeArray(1024), this.m_count = 0;
                }
                return t.prototype.Initialize = function(t) {
                    if (this.m_step.Copy(t.step), this.m_allocator = t.allocator, this.m_count = t.count, 
                    this.m_positionConstraints.length < this.m_count) for (var e = y(2 * this.m_positionConstraints.length, this.m_count); this.m_positionConstraints.length < e; ) this.m_positionConstraints[this.m_positionConstraints.length] = new mn();
                    if (this.m_velocityConstraints.length < this.m_count) for (e = y(2 * this.m_velocityConstraints.length, this.m_count); this.m_velocityConstraints.length < e; ) this.m_velocityConstraints[this.m_velocityConstraints.length] = new pn();
                    this.m_positions = t.positions, this.m_velocities = t.velocities, this.m_contacts = t.contacts;
                    for (var i = 0; i < this.m_count; ++i) {
                        var n = this.m_contacts[i], r = n.m_fixtureA, s = n.m_fixtureB, o = r.GetShape(), a = s.GetShape(), c = o.m_radius, l = a.m_radius, u = r.GetBody(), h = s.GetBody(), _ = n.GetManifold(), f = _.pointCount, d = this.m_velocityConstraints[i];
                        d.friction = n.m_friction, d.restitution = n.m_restitution, d.tangentSpeed = n.m_tangentSpeed, 
                        d.indexA = u.m_islandIndex, d.indexB = h.m_islandIndex, d.invMassA = u.m_invMass, 
                        d.invMassB = h.m_invMass, d.invIA = u.m_invI, d.invIB = h.m_invI, d.contactIndex = i, 
                        d.pointCount = f, d.K.SetZero(), d.normalMass.SetZero();
                        var p = this.m_positionConstraints[i];
                        p.indexA = u.m_islandIndex, p.indexB = h.m_islandIndex, p.invMassA = u.m_invMass, 
                        p.invMassB = h.m_invMass, p.localCenterA.Copy(u.m_sweep.localCenter), p.localCenterB.Copy(h.m_sweep.localCenter), 
                        p.invIA = u.m_invI, p.invIB = h.m_invI, p.localNormal.Copy(_.localNormal), p.localPoint.Copy(_.localPoint), 
                        p.pointCount = f, p.radiusA = c, p.radiusB = l, p.type = _.type;
                        for (var m = 0; m < f; ++m) {
                            var v = _.points[m], g = d.points[m];
                            this.m_step.warmStarting ? (g.normalImpulse = this.m_step.dtRatio * v.normalImpulse, 
                            g.tangentImpulse = this.m_step.dtRatio * v.tangentImpulse) : (g.normalImpulse = 0, 
                            g.tangentImpulse = 0), g.rA.SetZero(), g.rB.SetZero(), g.normalMass = 0, g.tangentMass = 0, 
                            g.velocityBias = 0, p.localPoints[m].Copy(v.localPoint);
                        }
                    }
                    return this;
                }, t.prototype.InitializeVelocityConstraints = function() {
                    for (var e = t.InitializeVelocityConstraints_s_xfA, i = t.InitializeVelocityConstraints_s_xfB, n = t.InitializeVelocityConstraints_s_worldManifold, r = 0; r < this.m_count; ++r) {
                        var s = this.m_velocityConstraints[r], o = this.m_positionConstraints[r], a = o.radiusA, c = o.radiusB, l = this.m_contacts[s.contactIndex].GetManifold(), u = s.indexA, h = s.indexB, _ = s.invMassA, f = s.invMassB, d = s.invIA, p = s.invIB, m = o.localCenterA, v = o.localCenterB, y = this.m_positions[u].c, g = this.m_positions[u].a, x = this.m_velocities[u].v, A = this.m_velocities[u].w, C = this.m_positions[h].c, b = this.m_positions[h].a, S = this.m_velocities[h].v, T = this.m_velocities[h].w;
                        e.q.SetAngle(g), i.q.SetAngle(b), P.SubVV(y, O.MulRV(e.q, m, P.s_t0), e.p), P.SubVV(C, O.MulRV(i.q, v, P.s_t0), i.p), 
                        n.Initialize(l, e, a, i, c), s.normal.Copy(n.normal), P.CrossVOne(s.normal, s.tangent);
                        for (var w = s.pointCount, E = 0; E < w; ++E) {
                            var B = s.points[E];
                            P.SubVV(n.points[E], y, B.rA), P.SubVV(n.points[E], C, B.rB);
                            var M = P.CrossVV(B.rA, s.normal), R = P.CrossVV(B.rB, s.normal), I = _ + f + d * M * M + p * R * R;
                            B.normalMass = I > 0 ? 1 / I : 0;
                            var D = s.tangent, V = P.CrossVV(B.rA, D), L = P.CrossVV(B.rB, D), F = _ + f + d * V * V + p * L * L;
                            B.tangentMass = F > 0 ? 1 / F : 0, B.velocityBias = 0;
                            var N = P.DotVV(s.normal, P.SubVV(P.AddVCrossSV(S, T, B.rB, P.s_t0), P.AddVCrossSV(x, A, B.rA, P.s_t1), P.s_t0));
                            N < -1 && (B.velocityBias += -s.restitution * N);
                        }
                        s.pointCount;
                    }
                }, t.prototype.WarmStart = function() {
                    for (var e = t.WarmStart_s_P, i = 0; i < this.m_count; ++i) {
                        for (var n = this.m_velocityConstraints[i], r = n.indexA, s = n.indexB, o = n.invMassA, a = n.invIA, c = n.invMassB, l = n.invIB, u = n.pointCount, h = this.m_velocities[r].v, _ = this.m_velocities[r].w, f = this.m_velocities[s].v, d = this.m_velocities[s].w, p = n.normal, m = n.tangent, v = 0; v < u; ++v) {
                            var y = n.points[v];
                            P.AddVV(P.MulSV(y.normalImpulse, p, P.s_t0), P.MulSV(y.tangentImpulse, m, P.s_t1), e), 
                            _ -= a * P.CrossVV(y.rA, e), h.SelfMulSub(o, e), d += l * P.CrossVV(y.rB, e), f.SelfMulAdd(c, e);
                        }
                        this.m_velocities[r].w = _, this.m_velocities[s].w = d;
                    }
                }, t.prototype.SolveVelocityConstraints = function() {
                    for (var e = t.SolveVelocityConstraints_s_dv, i = (t.SolveVelocityConstraints_s_dv1, 
                    t.SolveVelocityConstraints_s_dv2, t.SolveVelocityConstraints_s_P), n = (t.SolveVelocityConstraints_s_a, 
                    t.SolveVelocityConstraints_s_b, t.SolveVelocityConstraints_s_x, t.SolveVelocityConstraints_s_d, 
                    t.SolveVelocityConstraints_s_P1, t.SolveVelocityConstraints_s_P2, t.SolveVelocityConstraints_s_P1P2, 
                    0); n < this.m_count; ++n) {
                        for (var r = this.m_velocityConstraints[n], s = r.indexA, o = r.indexB, a = r.invMassA, c = r.invIA, l = r.invMassB, u = r.invIB, h = r.pointCount, _ = this.m_velocities[s].v, f = this.m_velocities[s].w, d = this.m_velocities[o].v, p = this.m_velocities[o].w, m = r.normal, v = r.tangent, x = r.friction, A = 0; A < h; ++A) {
                            var C = r.points[A];
                            P.SubVV(P.AddVCrossSV(d, p, C.rB, P.s_t0), P.AddVCrossSV(_, f, C.rA, P.s_t1), e);
                            var b = P.DotVV(e, v) - r.tangentSpeed, S = C.tangentMass * -b, T = x * C.normalImpulse;
                            S = (w = g(C.tangentImpulse + S, -T, T)) - C.tangentImpulse, C.tangentImpulse = w, 
                            P.MulSV(S, v, i), _.SelfMulSub(a, i), f -= c * P.CrossVV(C.rA, i), d.SelfMulAdd(l, i), 
                            p += u * P.CrossVV(C.rB, i);
                        }
                        for (r.pointCount, A = 0; A < h; ++A) {
                            C = r.points[A], P.SubVV(P.AddVCrossSV(d, p, C.rB, P.s_t0), P.AddVCrossSV(_, f, C.rA, P.s_t1), e);
                            var w, E = P.DotVV(e, m);
                            S = -C.normalMass * (E - C.velocityBias), S = (w = y(C.normalImpulse + S, 0)) - C.normalImpulse, 
                            C.normalImpulse = w, P.MulSV(S, m, i), _.SelfMulSub(a, i), f -= c * P.CrossVV(C.rA, i), 
                            d.SelfMulAdd(l, i), p += u * P.CrossVV(C.rB, i);
                        }
                        this.m_velocities[s].w = f, this.m_velocities[o].w = p;
                    }
                }, t.prototype.StoreImpulses = function() {
                    for (var t = 0; t < this.m_count; ++t) for (var e = this.m_velocityConstraints[t], i = this.m_contacts[e.contactIndex].GetManifold(), n = 0; n < e.pointCount; ++n) i.points[n].normalImpulse = e.points[n].normalImpulse, 
                    i.points[n].tangentImpulse = e.points[n].tangentImpulse;
                }, t.prototype.SolvePositionConstraints = function() {
                    for (var e = t.SolvePositionConstraints_s_xfA, i = t.SolvePositionConstraints_s_xfB, n = t.SolvePositionConstraints_s_psm, r = t.SolvePositionConstraints_s_rA, s = t.SolvePositionConstraints_s_rB, o = t.SolvePositionConstraints_s_P, a = 0, l = 0; l < this.m_count; ++l) {
                        for (var u = this.m_positionConstraints[l], h = u.indexA, _ = u.indexB, f = u.localCenterA, d = u.invMassA, p = u.invIA, m = u.localCenterB, y = u.invMassB, x = u.invIB, A = u.pointCount, C = this.m_positions[h].c, b = this.m_positions[h].a, S = this.m_positions[_].c, T = this.m_positions[_].a, w = 0; w < A; ++w) {
                            e.q.SetAngle(b), i.q.SetAngle(T), P.SubVV(C, O.MulRV(e.q, f, P.s_t0), e.p), P.SubVV(S, O.MulRV(i.q, m, P.s_t0), i.p), 
                            n.Initialize(u, e, i, w);
                            var E = n.normal, B = n.point, M = n.separation;
                            P.SubVV(B, C, r), P.SubVV(B, S, s), a = v(a, M);
                            var R = g(.2 * (M + c), -.2, 0), I = P.CrossVV(r, E), D = P.CrossVV(s, E), V = d + y + p * I * I + x * D * D, L = V > 0 ? -R / V : 0;
                            P.MulSV(L, E, o), C.SelfMulSub(d, o), b -= p * P.CrossVV(r, o), S.SelfMulAdd(y, o), 
                            T += x * P.CrossVV(s, o);
                        }
                        this.m_positions[h].a = b, this.m_positions[_].a = T;
                    }
                    return a > -3 * c;
                }, t.prototype.SolveTOIPositionConstraints = function(e, i) {
                    for (var n = t.SolveTOIPositionConstraints_s_xfA, r = t.SolveTOIPositionConstraints_s_xfB, s = t.SolveTOIPositionConstraints_s_psm, o = t.SolveTOIPositionConstraints_s_rA, a = t.SolveTOIPositionConstraints_s_rB, l = t.SolveTOIPositionConstraints_s_P, u = 0, h = 0; h < this.m_count; ++h) {
                        var _ = this.m_positionConstraints[h], f = _.indexA, d = _.indexB, p = _.localCenterA, m = _.localCenterB, y = _.pointCount, x = 0, A = 0;
                        f !== e && f !== i || (x = _.invMassA, A = _.invIA);
                        var C = 0, b = 0;
                        d !== e && d !== i || (C = _.invMassB, b = _.invIB);
                        for (var S = this.m_positions[f].c, T = this.m_positions[f].a, w = this.m_positions[d].c, E = this.m_positions[d].a, B = 0; B < y; ++B) {
                            n.q.SetAngle(T), r.q.SetAngle(E), P.SubVV(S, O.MulRV(n.q, p, P.s_t0), n.p), P.SubVV(w, O.MulRV(r.q, m, P.s_t0), r.p), 
                            s.Initialize(_, n, r, B);
                            var M = s.normal, R = s.point, I = s.separation;
                            P.SubVV(R, S, o), P.SubVV(R, w, a), u = v(u, I);
                            var D = g(.75 * (I + c), -.2, 0), V = P.CrossVV(o, M), L = P.CrossVV(a, M), F = x + C + A * V * V + b * L * L, N = F > 0 ? -D / F : 0;
                            P.MulSV(N, M, l), S.SelfMulSub(x, l), T -= A * P.CrossVV(o, l), w.SelfMulAdd(C, l), 
                            E += b * P.CrossVV(a, l);
                        }
                        this.m_positions[f].a = T, this.m_positions[d].a = E;
                    }
                    return u >= -1.5 * c;
                }, t.InitializeVelocityConstraints_s_xfA = new F(), t.InitializeVelocityConstraints_s_xfB = new F(), 
                t.InitializeVelocityConstraints_s_worldManifold = new xt(), t.WarmStart_s_P = new P(), 
                t.SolveVelocityConstraints_s_dv = new P(), t.SolveVelocityConstraints_s_dv1 = new P(), 
                t.SolveVelocityConstraints_s_dv2 = new P(), t.SolveVelocityConstraints_s_P = new P(), 
                t.SolveVelocityConstraints_s_a = new P(), t.SolveVelocityConstraints_s_b = new P(), 
                t.SolveVelocityConstraints_s_x = new P(), t.SolveVelocityConstraints_s_d = new P(), 
                t.SolveVelocityConstraints_s_P1 = new P(), t.SolveVelocityConstraints_s_P2 = new P(), 
                t.SolveVelocityConstraints_s_P1P2 = new P(), t.SolvePositionConstraints_s_xfA = new F(), 
                t.SolvePositionConstraints_s_xfB = new F(), t.SolvePositionConstraints_s_psm = new yn(), 
                t.SolvePositionConstraints_s_rA = new P(), t.SolvePositionConstraints_s_rB = new P(), 
                t.SolvePositionConstraints_s_P = new P(), t.SolveTOIPositionConstraints_s_xfA = new F(), 
                t.SolveTOIPositionConstraints_s_xfB = new F(), t.SolveTOIPositionConstraints_s_psm = new yn(), 
                t.SolveTOIPositionConstraints_s_rA = new P(), t.SolveTOIPositionConstraints_s_rB = new P(), 
                t.SolveTOIPositionConstraints_s_P = new P(), t;
            }(), xn = function() {
                function e() {
                    this.m_allocator = null, this.m_bodies = [], this.m_contacts = [], this.m_joints = [], 
                    this.m_positions = hn.MakeArray(1024), this.m_velocities = _n.MakeArray(1024), this.m_bodyCount = 0, 
                    this.m_jointCount = 0, this.m_contactCount = 0, this.m_bodyCapacity = 0, this.m_contactCapacity = 0, 
                    this.m_jointCapacity = 0;
                }
                return e.prototype.Initialize = function(t, e, i, n, r) {
                    if (this.m_bodyCapacity = t, this.m_contactCapacity = e, this.m_jointCapacity = i, 
                    this.m_bodyCount = 0, this.m_contactCount = 0, this.m_jointCount = 0, this.m_allocator = n, 
                    this.m_listener = r, this.m_positions.length < t) for (var s = y(2 * this.m_positions.length, t); this.m_positions.length < s; ) this.m_positions[this.m_positions.length] = new hn();
                    if (this.m_velocities.length < t) for (s = y(2 * this.m_velocities.length, t); this.m_velocities.length < s; ) this.m_velocities[this.m_velocities.length] = new _n();
                }, e.prototype.Clear = function() {
                    this.m_bodyCount = 0, this.m_contactCount = 0, this.m_jointCount = 0;
                }, e.prototype.AddBody = function(t) {
                    t.m_islandIndex = this.m_bodyCount, this.m_bodies[this.m_bodyCount++] = t;
                }, e.prototype.AddContact = function(t) {
                    this.m_contacts[this.m_contactCount++] = t;
                }, e.prototype.AddJoint = function(t) {
                    this.m_joints[this.m_jointCount++] = t;
                }, e.prototype.Solve = function(n, r, s, o) {
                    for (var a = e.s_timer.Reset(), c = r.dt, l = 0; l < this.m_bodyCount; ++l) {
                        var u = this.m_bodies[l];
                        this.m_positions[l].c.Copy(u.m_sweep.c);
                        var h = u.m_sweep.a, _ = this.m_velocities[l].v.Copy(u.m_linearVelocity), f = u.m_angularVelocity;
                        u.m_sweep.c0.Copy(u.m_sweep.c), u.m_sweep.a0 = u.m_sweep.a, u.m_type === t.b2BodyType.b2_dynamicBody && (_.x += c * (u.m_gravityScale * s.x + u.m_invMass * u.m_force.x), 
                        _.y += c * (u.m_gravityScale * s.y + u.m_invMass * u.m_force.y), f += c * u.m_invI * u.m_torque, 
                        _.SelfMul(1 / (1 + c * u.m_linearDamping)), f *= 1 / (1 + c * u.m_angularDamping)), 
                        this.m_positions[l].a = h, this.m_velocities[l].w = f;
                    }
                    a.Reset();
                    var d = e.s_solverData;
                    d.step.Copy(r), d.positions = this.m_positions, d.velocities = this.m_velocities;
                    var p = e.s_contactSolverDef;
                    p.step.Copy(r), p.contacts = this.m_contacts, p.count = this.m_contactCount, p.positions = this.m_positions, 
                    p.velocities = this.m_velocities, p.allocator = this.m_allocator;
                    var y = e.s_contactSolver.Initialize(p);
                    for (y.InitializeVelocityConstraints(), r.warmStarting && y.WarmStart(), l = 0; l < this.m_jointCount; ++l) this.m_joints[l].InitVelocityConstraints(d);
                    for (n.solveInit = a.GetMilliseconds(), a.Reset(), l = 0; l < r.velocityIterations; ++l) {
                        for (var g = 0; g < this.m_jointCount; ++g) this.m_joints[g].SolveVelocityConstraints(d);
                        y.SolveVelocityConstraints();
                    }
                    for (y.StoreImpulses(), n.solveVelocity = a.GetMilliseconds(), l = 0; l < this.m_bodyCount; ++l) {
                        var x = this.m_positions[l].c, A = (h = this.m_positions[l].a, _ = this.m_velocities[l].v, 
                        f = this.m_velocities[l].w, P.MulSV(c, _, e.s_translation));
                        if (P.DotVV(A, A) > 4) {
                            var C = 2 / A.Length();
                            _.SelfMul(C);
                        }
                        var b = c * f;
                        b * b > 2.4674011002726646 && (f *= C = 1.570796326795 / m(b)), x.x += c * _.x, 
                        x.y += c * _.y, h += c * f, this.m_positions[l].a = h, this.m_velocities[l].w = f;
                    }
                    a.Reset();
                    var S = !1;
                    for (l = 0; l < r.positionIterations; ++l) {
                        var T = y.SolvePositionConstraints(), w = !0;
                        for (g = 0; g < this.m_jointCount; ++g) {
                            var E = this.m_joints[g].SolvePositionConstraints(d);
                            w = w && E;
                        }
                        if (T && w) {
                            S = !0;
                            break;
                        }
                    }
                    for (l = 0; l < this.m_bodyCount; ++l) {
                        var B = this.m_bodies[l];
                        B.m_sweep.c.Copy(this.m_positions[l].c), B.m_sweep.a = this.m_positions[l].a, B.m_linearVelocity.Copy(this.m_velocities[l].v), 
                        B.m_angularVelocity = this.m_velocities[l].w, B.SynchronizeTransform();
                    }
                    if (n.solvePosition = a.GetMilliseconds(), this.Report(y.m_velocityConstraints), 
                    o) {
                        var M = i;
                        for (l = 0; l < this.m_bodyCount; ++l) (u = this.m_bodies[l]).GetType() !== t.b2BodyType.b2_staticBody && (!u.m_autoSleepFlag || u.m_angularVelocity * u.m_angularVelocity > .0012184696791469947 || P.DotVV(u.m_linearVelocity, u.m_linearVelocity) > 1e-4 ? (u.m_sleepTime = 0, 
                        M = 0) : (u.m_sleepTime += c, M = v(M, u.m_sleepTime)));
                        if (M >= .5 && S) for (l = 0; l < this.m_bodyCount; ++l) (u = this.m_bodies[l]).SetAwake(!1);
                    }
                }, e.prototype.SolveTOI = function(t, i, n) {
                    for (var r = 0; r < this.m_bodyCount; ++r) {
                        var s = this.m_bodies[r];
                        this.m_positions[r].c.Copy(s.m_sweep.c), this.m_positions[r].a = s.m_sweep.a, this.m_velocities[r].v.Copy(s.m_linearVelocity), 
                        this.m_velocities[r].w = s.m_angularVelocity;
                    }
                    var o = e.s_contactSolverDef;
                    o.contacts = this.m_contacts, o.count = this.m_contactCount, o.allocator = this.m_allocator, 
                    o.step.Copy(t), o.positions = this.m_positions, o.velocities = this.m_velocities;
                    var a = e.s_contactSolver.Initialize(o);
                    for (r = 0; r < t.positionIterations && !a.SolveTOIPositionConstraints(i, n); ++r) ;
                    for (this.m_bodies[i].m_sweep.c0.Copy(this.m_positions[i].c), this.m_bodies[i].m_sweep.a0 = this.m_positions[i].a, 
                    this.m_bodies[n].m_sweep.c0.Copy(this.m_positions[n].c), this.m_bodies[n].m_sweep.a0 = this.m_positions[n].a, 
                    a.InitializeVelocityConstraints(), r = 0; r < t.velocityIterations; ++r) a.SolveVelocityConstraints();
                    var c = t.dt;
                    for (r = 0; r < this.m_bodyCount; ++r) {
                        var l = this.m_positions[r].c, u = this.m_positions[r].a, h = this.m_velocities[r].v, _ = this.m_velocities[r].w, f = P.MulSV(c, h, e.s_translation);
                        if (P.DotVV(f, f) > 4) {
                            var d = 2 / f.Length();
                            h.SelfMul(d);
                        }
                        var p = c * _;
                        p * p > 2.4674011002726646 && (_ *= d = 1.570796326795 / m(p)), l.SelfMulAdd(c, h), 
                        u += c * _, this.m_positions[r].a = u, this.m_velocities[r].w = _;
                        var v = this.m_bodies[r];
                        v.m_sweep.c.Copy(l), v.m_sweep.a = u, v.m_linearVelocity.Copy(h), v.m_angularVelocity = _, 
                        v.SynchronizeTransform();
                    }
                    this.Report(a.m_velocityConstraints);
                }, e.prototype.Report = function(t) {
                    if (null !== this.m_listener) for (var i = 0; i < this.m_contactCount; ++i) {
                        var n = this.m_contacts[i];
                        if (n) {
                            var r = t[i], s = e.s_impulse;
                            s.count = r.pointCount;
                            for (var o = 0; o < r.pointCount; ++o) s.normalImpulses[o] = r.points[o].normalImpulse, 
                            s.tangentImpulses[o] = r.points[o].tangentImpulse;
                            this.m_listener.PostSolve(n, s);
                        }
                    }
                }, e.s_timer = new z(), e.s_solverData = new fn(), e.s_contactSolverDef = new vn(), 
                e.s_contactSolver = new gn(), e.s_translation = new P(), e.s_impulse = new rn(), 
                e;
            }();
            (Hi = t.b2ParticleFlag || (t.b2ParticleFlag = {}))[Hi.b2_waterParticle = 0] = "b2_waterParticle", 
            Hi[Hi.b2_zombieParticle = 2] = "b2_zombieParticle", Hi[Hi.b2_wallParticle = 4] = "b2_wallParticle", 
            Hi[Hi.b2_springParticle = 8] = "b2_springParticle", Hi[Hi.b2_elasticParticle = 16] = "b2_elasticParticle", 
            Hi[Hi.b2_viscousParticle = 32] = "b2_viscousParticle", Hi[Hi.b2_powderParticle = 64] = "b2_powderParticle", 
            Hi[Hi.b2_tensileParticle = 128] = "b2_tensileParticle", Hi[Hi.b2_colorMixingParticle = 256] = "b2_colorMixingParticle", 
            Hi[Hi.b2_destructionListenerParticle = 512] = "b2_destructionListenerParticle", 
            Hi[Hi.b2_barrierParticle = 1024] = "b2_barrierParticle", Hi[Hi.b2_staticPressureParticle = 2048] = "b2_staticPressureParticle", 
            Hi[Hi.b2_reactiveParticle = 4096] = "b2_reactiveParticle", Hi[Hi.b2_repulsiveParticle = 8192] = "b2_repulsiveParticle", 
            Hi[Hi.b2_fixtureContactListenerParticle = 16384] = "b2_fixtureContactListenerParticle", 
            Hi[Hi.b2_particleContactListenerParticle = 32768] = "b2_particleContactListenerParticle", 
            Hi[Hi.b2_fixtureContactFilterParticle = 65536] = "b2_fixtureContactFilterParticle", 
            Hi[Hi.b2_particleContactFilterParticle = 131072] = "b2_particleContactFilterParticle";
            var An = function() {
                this.flags = 0, this.position = new P(), this.velocity = new P(), this.color = new G(0, 0, 0, 0), 
                this.lifetime = 0, this.userData = null, this.group = null;
            };
            function Cn(t, e, i) {
                return g(Math.ceil(Math.sqrt(t / (.01 * e)) * i), 1, 8);
            }
            var bn, Sn = function() {
                function t() {
                    this.m_index = h;
                }
                return t.prototype.GetIndex = function() {
                    return this.m_index;
                }, t.prototype.SetIndex = function(t) {
                    this.m_index = t;
                }, t;
            }();
            (bn = t.b2ParticleGroupFlag || (t.b2ParticleGroupFlag = {}))[bn.b2_solidParticleGroup = 1] = "b2_solidParticleGroup", 
            bn[bn.b2_rigidParticleGroup = 2] = "b2_rigidParticleGroup", bn[bn.b2_particleGroupCanBeEmpty = 4] = "b2_particleGroupCanBeEmpty", 
            bn[bn.b2_particleGroupWillBeDestroyed = 8] = "b2_particleGroupWillBeDestroyed", 
            bn[bn.b2_particleGroupNeedsUpdateDepth = 16] = "b2_particleGroupNeedsUpdateDepth", 
            bn[bn.b2_particleGroupInternalMask = 24] = "b2_particleGroupInternalMask";
            var Tn = function() {
                this.flags = 0, this.groupFlags = 0, this.position = new P(), this.angle = 0, this.linearVelocity = new P(), 
                this.angularVelocity = 0, this.color = new G(), this.strength = 1, this.shapeCount = 0, 
                this.stride = 0, this.particleCount = 0, this.lifetime = 0, this.userData = null, 
                this.group = null;
            }, wn = function() {
                function e(t) {
                    this.m_firstIndex = 0, this.m_lastIndex = 0, this.m_groupFlags = 0, this.m_strength = 1, 
                    this.m_prev = null, this.m_next = null, this.m_timestamp = -1, this.m_mass = 0, 
                    this.m_inertia = 0, this.m_center = new P(), this.m_linearVelocity = new P(), this.m_angularVelocity = 0, 
                    this.m_transform = new F(), this.m_userData = null, this.m_system = t;
                }
                return e.prototype.GetNext = function() {
                    return this.m_next;
                }, e.prototype.GetParticleSystem = function() {
                    return this.m_system;
                }, e.prototype.GetParticleCount = function() {
                    return this.m_lastIndex - this.m_firstIndex;
                }, e.prototype.GetBufferIndex = function() {
                    return this.m_firstIndex;
                }, e.prototype.ContainsParticle = function(t) {
                    return this.m_firstIndex <= t && t < this.m_lastIndex;
                }, e.prototype.GetAllParticleFlags = function() {
                    if (!this.m_system.m_flagsBuffer.data) throw new Error();
                    for (var t = 0, e = this.m_firstIndex; e < this.m_lastIndex; e++) t |= this.m_system.m_flagsBuffer.data[e];
                    return t;
                }, e.prototype.GetGroupFlags = function() {
                    return this.m_groupFlags;
                }, e.prototype.SetGroupFlags = function(e) {
                    e |= this.m_groupFlags & t.b2ParticleGroupFlag.b2_particleGroupInternalMask, this.m_system.SetGroupFlags(this, e);
                }, e.prototype.GetMass = function() {
                    return this.UpdateStatistics(), this.m_mass;
                }, e.prototype.GetInertia = function() {
                    return this.UpdateStatistics(), this.m_inertia;
                }, e.prototype.GetCenter = function() {
                    return this.UpdateStatistics(), this.m_center;
                }, e.prototype.GetLinearVelocity = function() {
                    return this.UpdateStatistics(), this.m_linearVelocity;
                }, e.prototype.GetAngularVelocity = function() {
                    return this.UpdateStatistics(), this.m_angularVelocity;
                }, e.prototype.GetTransform = function() {
                    return this.m_transform;
                }, e.prototype.GetPosition = function() {
                    return this.m_transform.p;
                }, e.prototype.GetAngle = function() {
                    return this.m_transform.q.GetAngle();
                }, e.prototype.GetLinearVelocityFromWorldPoint = function(t, i) {
                    var n = e.GetLinearVelocityFromWorldPoint_s_t0;
                    return this.UpdateStatistics(), P.AddVCrossSV(this.m_linearVelocity, this.m_angularVelocity, P.SubVV(t, this.m_center, n), i);
                }, e.prototype.GetUserData = function() {
                    return this.m_userData;
                }, e.prototype.SetUserData = function(t) {
                    this.m_userData = t;
                }, e.prototype.ApplyForce = function(t) {
                    this.m_system.ApplyForce(this.m_firstIndex, this.m_lastIndex, t);
                }, e.prototype.ApplyLinearImpulse = function(t) {
                    this.m_system.ApplyLinearImpulse(this.m_firstIndex, this.m_lastIndex, t);
                }, e.prototype.DestroyParticles = function(t) {
                    if (this.m_system.m_world.IsLocked()) throw new Error();
                    for (var e = this.m_firstIndex; e < this.m_lastIndex; e++) this.m_system.DestroyParticle(e, t);
                }, e.prototype.UpdateStatistics = function() {
                    if (!this.m_system.m_positionBuffer.data) throw new Error();
                    if (!this.m_system.m_velocityBuffer.data) throw new Error();
                    var t = new P(), e = new P();
                    if (this.m_timestamp !== this.m_system.m_timestamp) {
                        var i = this.m_system.GetParticleMass();
                        this.m_mass = i * (this.m_lastIndex - this.m_firstIndex), this.m_center.SetZero(), 
                        this.m_linearVelocity.SetZero();
                        for (var n = this.m_firstIndex; n < this.m_lastIndex; n++) this.m_center.SelfMulAdd(i, this.m_system.m_positionBuffer.data[n]), 
                        this.m_linearVelocity.SelfMulAdd(i, this.m_system.m_velocityBuffer.data[n]);
                        if (this.m_mass > 0) {
                            var r = 1 / this.m_mass;
                            this.m_center.SelfMul(r), this.m_linearVelocity.SelfMul(r);
                        }
                        for (this.m_inertia = 0, this.m_angularVelocity = 0, n = this.m_firstIndex; n < this.m_lastIndex; n++) P.SubVV(this.m_system.m_positionBuffer.data[n], this.m_center, t), 
                        P.SubVV(this.m_system.m_velocityBuffer.data[n], this.m_linearVelocity, e), this.m_inertia += i * P.DotVV(t, t), 
                        this.m_angularVelocity += i * P.CrossVV(t, e);
                        this.m_inertia > 0 && (this.m_angularVelocity *= 1 / this.m_inertia), this.m_timestamp = this.m_system.m_timestamp;
                    }
                }, e.GetLinearVelocityFromWorldPoint_s_t0 = new P(), e;
            }(), En = function() {
                function t(t) {
                    this.m_front = 0, this.m_back = 0, this.m_capacity = 0, this.m_buffer = d(t, function() {
                        return null;
                    }), this.m_capacity = t;
                }
                return t.prototype.Push = function(t) {
                    if (this.m_back >= this.m_capacity) {
                        for (var e = this.m_front; e < this.m_back; e++) this.m_buffer[e - this.m_front] = this.m_buffer[e];
                        this.m_back -= this.m_front, this.m_front = 0, this.m_back >= this.m_capacity && (this.m_capacity > 0 ? (this.m_buffer.concat(d(this.m_capacity, function() {
                            return null;
                        })), this.m_capacity *= 2) : (this.m_buffer.concat(d(1, function() {
                            return null;
                        })), this.m_capacity = 1));
                    }
                    this.m_buffer[this.m_back] = t, this.m_back++;
                }, t.prototype.Pop = function() {
                    this.m_buffer[this.m_front] = null, this.m_front++;
                }, t.prototype.Empty = function() {
                    return this.m_front === this.m_back;
                }, t.prototype.Front = function() {
                    var t = this.m_buffer[this.m_front];
                    if (!t) throw new Error();
                    return t;
                }, t;
            }(), Bn = function() {
                function t(e) {
                    this.m_generatorCapacity = 0, this.m_generatorCount = 0, this.m_countX = 0, this.m_countY = 0, 
                    this.m_diagram = [], this.m_generatorBuffer = d(e, function() {
                        return new t.Generator();
                    }), this.m_generatorCapacity = e;
                }
                return t.prototype.AddGenerator = function(t, e, i) {
                    var n = this.m_generatorBuffer[this.m_generatorCount++];
                    n.center.Copy(t), n.tag = e, n.necessary = i;
                }, t.prototype.Generate = function(e, n) {
                    for (var r = 1 / e, s = new P(+i, +i), o = new P(-i, -i), a = 0, c = 0; c < this.m_generatorCount; c++) (f = this.m_generatorBuffer[c]).necessary && (P.MinV(s, f.center, s), 
                    P.MaxV(o, f.center, o), ++a);
                    if (0 === a) return this.m_countX = 0, void (this.m_countY = 0);
                    s.x -= n, s.y -= n, o.x += n, o.y += n, this.m_countX = 1 + Math.floor(r * (o.x - s.x)), 
                    this.m_countY = 1 + Math.floor(r * (o.y - s.y)), this.m_diagram = [];
                    var l = new En(4 * this.m_countX * this.m_countY);
                    for (c = 0; c < this.m_generatorCount; c++) {
                        (f = this.m_generatorBuffer[c]).center.SelfSub(s).SelfMul(r);
                        var u = Math.floor(f.center.x), h = Math.floor(f.center.y);
                        u >= 0 && h >= 0 && u < this.m_countX && h < this.m_countY && l.Push(new t.Task(u, h, u + h * this.m_countX, f));
                    }
                    for (;!l.Empty(); ) {
                        u = (d = l.Front()).m_x, h = d.m_y;
                        var _ = d.m_i, f = d.m_generator;
                        l.Pop(), this.m_diagram[_] || (this.m_diagram[_] = f, u > 0 && l.Push(new t.Task(u - 1, h, _ - 1, f)), 
                        h > 0 && l.Push(new t.Task(u, h - 1, _ - this.m_countX, f)), u < this.m_countX - 1 && l.Push(new t.Task(u + 1, h, _ + 1, f)), 
                        h < this.m_countY - 1 && l.Push(new t.Task(u, h + 1, _ + this.m_countX, f)));
                    }
                    for (h = 0; h < this.m_countY; h++) for (u = 0; u < this.m_countX - 1; u++) _ = u + h * this.m_countX, 
                    (p = this.m_diagram[_]) !== (m = this.m_diagram[_ + 1]) && (l.Push(new t.Task(u, h, _, m)), 
                    l.Push(new t.Task(u + 1, h, _ + 1, p)));
                    for (h = 0; h < this.m_countY - 1; h++) for (u = 0; u < this.m_countX; u++) _ = u + h * this.m_countX, 
                    (p = this.m_diagram[_]) !== (m = this.m_diagram[_ + this.m_countX]) && (l.Push(new t.Task(u, h, _, m)), 
                    l.Push(new t.Task(u, h + 1, _ + this.m_countX, p)));
                    for (;!l.Empty(); ) {
                        var d, p, m;
                        if (u = (d = l.Front()).m_x, h = d.m_y, _ = d.m_i, c = d.m_generator, l.Pop(), (p = this.m_diagram[_]) !== (m = c)) {
                            var v = p.center.x - u, y = p.center.y - h, g = m.center.x - u, x = m.center.y - h;
                            v * v + y * y > g * g + x * x && (this.m_diagram[_] = m, u > 0 && l.Push(new t.Task(u - 1, h, _ - 1, m)), 
                            h > 0 && l.Push(new t.Task(u, h - 1, _ - this.m_countX, m)), u < this.m_countX - 1 && l.Push(new t.Task(u + 1, h, _ + 1, m)), 
                            h < this.m_countY - 1 && l.Push(new t.Task(u, h + 1, _ + this.m_countX, m)));
                        }
                    }
                }, t.prototype.GetNodes = function(t) {
                    for (var e = 0; e < this.m_countY - 1; e++) for (var i = 0; i < this.m_countX - 1; i++) {
                        var n = i + e * this.m_countX, r = this.m_diagram[n], s = this.m_diagram[n + 1], o = this.m_diagram[n + this.m_countX], a = this.m_diagram[n + 1 + this.m_countX];
                        s !== o && (r !== s && r !== o && (r.necessary || s.necessary || o.necessary) && t(r.tag, s.tag, o.tag), 
                        a !== s && a !== o && (r.necessary || s.necessary || o.necessary) && t(s.tag, a.tag, o.tag));
                    }
                }, t;
            }();
            function Mn(t, e, i) {
                var n = t[e];
                t[e] = t[i], t[i] = n;
            }
            function Rn(t, e) {
                return t < e;
            }
            function Pn(t, e, i, n) {
                void 0 === e && (e = 0), void 0 === i && (i = t.length - e), void 0 === n && (n = Rn);
                for (var r = e, s = [], o = 0; ;) {
                    for (;r + 1 < i; i++) {
                        var a = t[r + Math.floor(Math.random() * (i - r))];
                        s[o++] = i;
                        for (var c = r - 1; ;) {
                            for (;n(t[++c], a); ) ;
                            for (;n(a, t[--i]); ) ;
                            if (c >= i) break;
                            Mn(t, c, i);
                        }
                    }
                    if (0 === o) break;
                    r = i, i = s[--o];
                }
                return t;
            }
            function In(t, e, i, n) {
                return void 0 === e && (e = 0), void 0 === i && (i = t.length - e), void 0 === n && (n = Rn), 
                Pn(t, e, i, n);
            }
            function Dn(t, e, i) {
                void 0 === i && (i = t.length);
                for (var n = 0, r = 0; r < i; ++r) e(t[r]) || (r !== n ? Mn(t, n++, r) : ++n);
                return n;
            }
            function Vn(t, e, i, n, r) {
                void 0 === r && (r = Rn);
                for (var s = i - e; s > 0; ) {
                    var o = Math.floor(s / 2), a = e + o;
                    r(t[a], n) ? (e = ++a, s -= o + 1) : s = o;
                }
                return e;
            }
            function Ln(t, e, i, n, r) {
                void 0 === r && (r = Rn);
                for (var s = i - e; s > 0; ) {
                    var o = Math.floor(s / 2), a = e + o;
                    r(n, t[a]) ? s = o : (e = ++a, s -= o + 1);
                }
                return e;
            }
            function On(t, e, i, n) {
                for (var r = i; e !== r; ) Mn(t, e++, r++), r === n ? r = i : e === i && (i = r);
            }
            function Fn(t, e, i, n) {
                if (e === i) return i;
                for (var r = e; ++e !== i; ) n(t[r], t[e]) || Mn(t, ++r, e);
                return ++r;
            }
            (function(t) {
                t.Generator = function() {
                    this.center = new P(), this.tag = 0, this.necessary = !1;
                };
                t.Task = function(t, e, i, n) {
                    this.m_x = t, this.m_y = e, this.m_i = i, this.m_generator = n;
                };
            })(Bn || (Bn = {}));
            var Nn = function() {
                function t(t) {
                    this.data = [], this.count = 0, this.capacity = 0, this.allocator = t;
                }
                return t.prototype.Append = function() {
                    return this.count >= this.capacity && this.Grow(), this.count++;
                }, t.prototype.Reserve = function(t) {
                    if (!(this.capacity >= t)) {
                        for (var e = this.capacity; e < t; ++e) this.data[e] = this.allocator();
                        this.capacity = t;
                    }
                }, t.prototype.Grow = function() {
                    var t = this.capacity ? 2 * this.capacity : 256;
                    this.Reserve(t);
                }, t.prototype.Free = function() {
                    0 !== this.data.length && (this.data = [], this.capacity = 0, this.count = 0);
                }, t.prototype.Shorten = function() {}, t.prototype.Data = function() {
                    return this.data;
                }, t.prototype.GetCount = function() {
                    return this.count;
                }, t.prototype.SetCount = function(t) {
                    this.count = t;
                }, t.prototype.GetCapacity = function() {
                    return this.capacity;
                }, t.prototype.RemoveIf = function(t) {
                    this.count = Dn(this.data, t, this.count);
                }, t.prototype.Unique = function(t) {
                    this.count = Fn(this.data, 0, this.count, t);
                }, t;
            }(), Gn = function(t) {
                function e(e) {
                    var i = t.call(this) || this;
                    return i.m_system = e, i;
                }
                return ti(e, t), e.prototype.ShouldQueryParticleSystem = function() {
                    return !1;
                }, e.prototype.ReportFixture = function(t) {
                    if (t.IsSensor()) return !0;
                    for (var e = t.GetShape().GetChildCount(), i = 0; i < e; i++) for (var n = t.GetAABB(i), r = this.m_system.GetInsideBoundsEnumerator(n), s = void 0; (s = r.GetNext()) >= 0; ) this.ReportFixtureAndParticle(t, i, s);
                    return !0;
                }, e.prototype.ReportParticle = function() {
                    return !1;
                }, e.prototype.ReportFixtureAndParticle = function() {}, e;
            }(on), kn = function() {
                function t() {
                    this.indexA = 0, this.indexB = 0, this.weight = 0, this.normal = new P(), this.flags = 0;
                }
                return t.prototype.SetIndices = function(t, e) {
                    this.indexA = t, this.indexB = e;
                }, t.prototype.SetWeight = function(t) {
                    this.weight = t;
                }, t.prototype.SetNormal = function(t) {
                    this.normal.Copy(t);
                }, t.prototype.SetFlags = function(t) {
                    this.flags = t;
                }, t.prototype.GetIndexA = function() {
                    return this.indexA;
                }, t.prototype.GetIndexB = function() {
                    return this.indexB;
                }, t.prototype.GetWeight = function() {
                    return this.weight;
                }, t.prototype.GetNormal = function() {
                    return this.normal;
                }, t.prototype.GetFlags = function() {
                    return this.flags;
                }, t.prototype.IsEqual = function(t) {
                    return this.indexA === t.indexA && this.indexB === t.indexB && this.flags === t.flags && this.weight === t.weight && this.normal.x === t.normal.x && this.normal.y === t.normal.y;
                }, t.prototype.IsNotEqual = function(t) {
                    return !this.IsEqual(t);
                }, t.prototype.ApproximatelyEqual = function(t) {
                    return this.indexA === t.indexA && this.indexB === t.indexB && this.flags === t.flags && m(this.weight - t.weight) < .01 && P.DistanceSquaredVV(this.normal, t.normal) < 1e-4;
                }, t;
            }(), zn = function() {
                this.index = 0, this.weight = 0, this.normal = new P(), this.mass = 0;
            }, Un = function() {
                this.indexA = 0, this.indexB = 0, this.flags = 0, this.strength = 0, this.distance = 0;
            }, Hn = function() {
                this.indexA = 0, this.indexB = 0, this.indexC = 0, this.flags = 0, this.strength = 0, 
                this.pa = new P(0, 0), this.pb = new P(0, 0), this.pc = new P(0, 0), this.ka = 0, 
                this.kb = 0, this.kc = 0, this.s = 0;
            }, Wn = function() {
                function t() {
                    this.strictContactCheck = !1, this.density = 1, this.gravityScale = 1, this.radius = 1, 
                    this.maxCount = 0, this.pressureStrength = .005, this.dampingStrength = 1, this.elasticStrength = .25, 
                    this.springStrength = .25, this.viscousStrength = .25, this.surfaceTensionPressureStrength = .2, 
                    this.surfaceTensionNormalStrength = .2, this.repulsiveStrength = 1, this.powderStrength = .5, 
                    this.ejectionStrength = .5, this.staticPressureStrength = .2, this.staticPressureRelaxation = .2, 
                    this.staticPressureIterations = 8, this.colorMixingStrength = .5, this.destroyByAge = !0, 
                    this.lifetimeGranularity = 1 / 60;
                }
                return t.prototype.Copy = function(t) {
                    return this.strictContactCheck = t.strictContactCheck, this.density = t.density, 
                    this.gravityScale = t.gravityScale, this.radius = t.radius, this.maxCount = t.maxCount, 
                    this.pressureStrength = t.pressureStrength, this.dampingStrength = t.dampingStrength, 
                    this.elasticStrength = t.elasticStrength, this.springStrength = t.springStrength, 
                    this.viscousStrength = t.viscousStrength, this.surfaceTensionPressureStrength = t.surfaceTensionPressureStrength, 
                    this.surfaceTensionNormalStrength = t.surfaceTensionNormalStrength, this.repulsiveStrength = t.repulsiveStrength, 
                    this.powderStrength = t.powderStrength, this.ejectionStrength = t.ejectionStrength, 
                    this.staticPressureStrength = t.staticPressureStrength, this.staticPressureRelaxation = t.staticPressureRelaxation, 
                    this.staticPressureIterations = t.staticPressureIterations, this.colorMixingStrength = t.colorMixingStrength, 
                    this.destroyByAge = t.destroyByAge, this.lifetimeGranularity = t.lifetimeGranularity, 
                    this;
                }, t.prototype.Clone = function() {
                    return new t().Copy(this);
                }, t;
            }();
            t.b2ParticleSystem = function() {
                function n(t, e) {
                    this.m_paused = !1, this.m_timestamp = 0, this.m_allParticleFlags = 0, this.m_needsUpdateAllParticleFlags = !1, 
                    this.m_allGroupFlags = 0, this.m_needsUpdateAllGroupFlags = !1, this.m_hasForce = !1, 
                    this.m_iterationIndex = 0, this.m_inverseDensity = 0, this.m_particleDiameter = 0, 
                    this.m_inverseDiameter = 0, this.m_squaredDiameter = 0, this.m_count = 0, this.m_internalAllocatedCapacity = 0, 
                    this.m_handleIndexBuffer = new n.UserOverridableBuffer(), this.m_flagsBuffer = new n.UserOverridableBuffer(), 
                    this.m_positionBuffer = new n.UserOverridableBuffer(), this.m_velocityBuffer = new n.UserOverridableBuffer(), 
                    this.m_forceBuffer = [], this.m_weightBuffer = [], this.m_staticPressureBuffer = [], 
                    this.m_accumulationBuffer = [], this.m_accumulation2Buffer = [], this.m_depthBuffer = [], 
                    this.m_colorBuffer = new n.UserOverridableBuffer(), this.m_groupBuffer = [], this.m_userDataBuffer = new n.UserOverridableBuffer(), 
                    this.m_stuckThreshold = 0, this.m_lastBodyContactStepBuffer = new n.UserOverridableBuffer(), 
                    this.m_bodyContactCountBuffer = new n.UserOverridableBuffer(), this.m_consecutiveContactStepsBuffer = new n.UserOverridableBuffer(), 
                    this.m_stuckParticleBuffer = new Nn(function() {
                        return 0;
                    }), this.m_proxyBuffer = new Nn(function() {
                        return new n.Proxy();
                    }), this.m_contactBuffer = new Nn(function() {
                        return new kn();
                    }), this.m_bodyContactBuffer = new Nn(function() {
                        return new zn();
                    }), this.m_pairBuffer = new Nn(function() {
                        return new Un();
                    }), this.m_triadBuffer = new Nn(function() {
                        return new Hn();
                    }), this.m_expirationTimeBuffer = new n.UserOverridableBuffer(), this.m_indexByExpirationTimeBuffer = new n.UserOverridableBuffer(), 
                    this.m_timeElapsed = 0, this.m_expirationTimeBufferRequiresSorting = !1, this.m_groupCount = 0, 
                    this.m_groupList = null, this.m_def = new Wn(), this.m_prev = null, this.m_next = null, 
                    this.SetStrictContactCheck(t.strictContactCheck), this.SetDensity(t.density), this.SetGravityScale(t.gravityScale), 
                    this.SetRadius(t.radius), this.SetMaxParticleCount(t.maxCount), this.m_def = t.Clone(), 
                    this.m_world = e, this.SetDestructionByAge(this.m_def.destroyByAge);
                }
                return n.computeTag = function(t, e) {
                    return (e + n.yOffset >>> 0 << n.yShift) + (n.xScale * t + n.xOffset >>> 0) >>> 0;
                }, n.computeRelativeTag = function(t, e, i) {
                    return t + (i << n.yShift) + (e << n.xShift) >>> 0;
                }, n.prototype.Drop = function() {
                    for (;this.m_groupList; ) this.DestroyParticleGroup(this.m_groupList);
                    this.FreeUserOverridableBuffer(this.m_handleIndexBuffer), this.FreeUserOverridableBuffer(this.m_flagsBuffer), 
                    this.FreeUserOverridableBuffer(this.m_lastBodyContactStepBuffer), this.FreeUserOverridableBuffer(this.m_bodyContactCountBuffer), 
                    this.FreeUserOverridableBuffer(this.m_consecutiveContactStepsBuffer), this.FreeUserOverridableBuffer(this.m_positionBuffer), 
                    this.FreeUserOverridableBuffer(this.m_velocityBuffer), this.FreeUserOverridableBuffer(this.m_colorBuffer), 
                    this.FreeUserOverridableBuffer(this.m_userDataBuffer), this.FreeUserOverridableBuffer(this.m_expirationTimeBuffer), 
                    this.FreeUserOverridableBuffer(this.m_indexByExpirationTimeBuffer), this.FreeBuffer(this.m_forceBuffer, this.m_internalAllocatedCapacity), 
                    this.FreeBuffer(this.m_weightBuffer, this.m_internalAllocatedCapacity), this.FreeBuffer(this.m_staticPressureBuffer, this.m_internalAllocatedCapacity), 
                    this.FreeBuffer(this.m_accumulationBuffer, this.m_internalAllocatedCapacity), this.FreeBuffer(this.m_accumulation2Buffer, this.m_internalAllocatedCapacity), 
                    this.FreeBuffer(this.m_depthBuffer, this.m_internalAllocatedCapacity), this.FreeBuffer(this.m_groupBuffer, this.m_internalAllocatedCapacity);
                }, n.prototype.CreateParticle = function(t) {
                    if (this.m_world.IsLocked()) throw new Error();
                    if (this.m_count >= this.m_internalAllocatedCapacity) {
                        var i = this.m_count ? 2 * this.m_count : 256;
                        this.ReallocateInternalAllocatedBuffers(i);
                    }
                    if (this.m_count >= this.m_internalAllocatedCapacity) {
                        if (!this.m_def.destroyByAge) return h;
                        this.DestroyOldestParticle(0, !1), this.SolveZombie();
                    }
                    var n = this.m_count++;
                    if (!this.m_flagsBuffer.data) throw new Error();
                    if (this.m_flagsBuffer.data[n] = 0, this.m_lastBodyContactStepBuffer.data && (this.m_lastBodyContactStepBuffer.data[n] = 0), 
                    this.m_bodyContactCountBuffer.data && (this.m_bodyContactCountBuffer.data[n] = 0), 
                    this.m_consecutiveContactStepsBuffer.data && (this.m_consecutiveContactStepsBuffer.data[n] = 0), 
                    !this.m_positionBuffer.data) throw new Error();
                    if (!this.m_velocityBuffer.data) throw new Error();
                    this.m_positionBuffer.data[n] = (this.m_positionBuffer.data[n] || new P()).Copy(e(t.position, P.ZERO)), 
                    this.m_velocityBuffer.data[n] = (this.m_velocityBuffer.data[n] || new P()).Copy(e(t.velocity, P.ZERO)), 
                    this.m_weightBuffer[n] = 0, this.m_forceBuffer[n] = (this.m_forceBuffer[n] || new P()).SetZero(), 
                    this.m_staticPressureBuffer && (this.m_staticPressureBuffer[n] = 0), this.m_depthBuffer && (this.m_depthBuffer[n] = 0);
                    var r = new G().Copy(e(t.color, G.ZERO));
                    !this.m_colorBuffer.data && r.IsZero() || (this.m_colorBuffer.data = this.RequestBuffer(this.m_colorBuffer.data), 
                    this.m_colorBuffer.data[n] = (this.m_colorBuffer.data[n] || new G()).Copy(r)), (this.m_userDataBuffer.data || t.userData) && (this.m_userDataBuffer.data = this.RequestBuffer(this.m_userDataBuffer.data), 
                    this.m_userDataBuffer.data[n] = t.userData), this.m_handleIndexBuffer.data && (this.m_handleIndexBuffer.data[n] = null);
                    var s = this.m_proxyBuffer.data[this.m_proxyBuffer.Append()], o = e(t.lifetime, 0), a = o > 0;
                    if (this.m_expirationTimeBuffer.data || a) {
                        if (this.SetParticleLifetime(n, a ? o : this.ExpirationTimeToLifetime(-this.GetQuantizedTimeElapsed())), 
                        !this.m_indexByExpirationTimeBuffer.data) throw new Error();
                        this.m_indexByExpirationTimeBuffer.data[n] = n;
                    }
                    s.index = n;
                    var c = e(t.group, null);
                    return this.m_groupBuffer[n] = c, c && (c.m_firstIndex < c.m_lastIndex ? (this.RotateBuffer(c.m_firstIndex, c.m_lastIndex, n), 
                    c.m_lastIndex = n + 1) : (c.m_firstIndex = n, c.m_lastIndex = n + 1)), this.SetParticleFlags(n, e(t.flags, 0)), 
                    n;
                }, n.prototype.GetParticleHandleFromIndex = function(t) {
                    this.m_handleIndexBuffer.data = this.RequestBuffer(this.m_handleIndexBuffer.data);
                    var e = this.m_handleIndexBuffer.data[t];
                    return e || ((e = new Sn()).SetIndex(t), this.m_handleIndexBuffer.data[t] = e, e);
                }, n.prototype.DestroyParticle = function(e, i) {
                    if (void 0 === i && (i = !1), !this.m_flagsBuffer.data) throw new Error();
                    var n = t.b2ParticleFlag.b2_zombieParticle;
                    i && (n |= t.b2ParticleFlag.b2_destructionListenerParticle), this.SetParticleFlags(e, this.m_flagsBuffer.data[e] | n);
                }, n.prototype.DestroyOldestParticle = function(t, e) {
                    void 0 === e && (e = !1);
                    var i = this.GetParticleCount();
                    if (!this.m_indexByExpirationTimeBuffer.data) throw new Error();
                    if (!this.m_expirationTimeBuffer.data) throw new Error();
                    var n = this.m_indexByExpirationTimeBuffer.data[i - (t + 1)], r = this.m_indexByExpirationTimeBuffer.data[t];
                    this.DestroyParticle(this.m_expirationTimeBuffer.data[n] > 0 ? n : r, e);
                }, n.prototype.DestroyParticlesInShape = function(t, e, i) {
                    void 0 === i && (i = !1);
                    var r = n.DestroyParticlesInShape_s_aabb;
                    if (this.m_world.IsLocked()) throw new Error();
                    var s = new n.DestroyParticlesInShapeCallback(this, t, e, i), o = r;
                    return t.ComputeAABB(o, e, 0), this.m_world.QueryAABB(s, o), s.Destroyed();
                }, n.prototype.CreateParticleGroup = function(t) {
                    var i = n.CreateParticleGroup_s_transform;
                    if (this.m_world.IsLocked()) throw new Error();
                    var r = i;
                    r.SetPositionAngle(e(t.position, P.ZERO), e(t.angle, 0));
                    var s = this.m_count;
                    if (t.shape && this.CreateParticlesWithShapeForGroup(t.shape, t, r), t.shapes && this.CreateParticlesWithShapesForGroup(t.shapes, e(t.shapeCount, t.shapes.length), t, r), 
                    t.positionData) for (var o = e(t.particleCount, t.positionData.length), a = 0; a < o; a++) {
                        var c = t.positionData[a];
                        this.CreateParticleForGroup(t, r, c);
                    }
                    var l = this.m_count, u = new wn(this);
                    for (u.m_firstIndex = s, u.m_lastIndex = l, u.m_strength = e(t.strength, 1), u.m_userData = t.userData, 
                    u.m_transform.Copy(r), u.m_prev = null, u.m_next = this.m_groupList, this.m_groupList && (this.m_groupList.m_prev = u), 
                    this.m_groupList = u, ++this.m_groupCount, a = s; a < l; a++) this.m_groupBuffer[a] = u;
                    this.SetGroupFlags(u, e(t.groupFlags, 0));
                    var h = new n.ConnectionFilter();
                    return this.UpdateContacts(!0), this.UpdatePairsAndTriads(s, l, h), t.group && (this.JoinParticleGroups(t.group, u), 
                    u = t.group), u;
                }, n.prototype.JoinParticleGroups = function(t, e) {
                    if (this.m_world.IsLocked()) throw new Error();
                    this.RotateBuffer(e.m_firstIndex, e.m_lastIndex, this.m_count), this.RotateBuffer(t.m_firstIndex, t.m_lastIndex, e.m_firstIndex);
                    var i = new n.JoinParticleGroupsFilter(e.m_firstIndex);
                    this.UpdateContacts(!0), this.UpdatePairsAndTriads(t.m_firstIndex, e.m_lastIndex, i);
                    for (var r = e.m_firstIndex; r < e.m_lastIndex; r++) this.m_groupBuffer[r] = t;
                    var s = t.m_groupFlags | e.m_groupFlags;
                    this.SetGroupFlags(t, s), t.m_lastIndex = e.m_lastIndex, e.m_firstIndex = e.m_lastIndex, 
                    this.DestroyParticleGroup(e);
                }, n.prototype.SplitParticleGroup = function(t) {
                    this.UpdateContacts(!0);
                    var e = d(t.GetParticleCount(), function() {
                        return new n.ParticleListNode();
                    });
                    n.InitializeParticleLists(t, e), this.MergeParticleListsInContact(t, e);
                    var i = n.FindLongestParticleList(t, e);
                    this.MergeZombieParticleListNodes(t, e, i), this.CreateParticleGroupsFromParticleList(t, e, i), 
                    this.UpdatePairsAndTriadsWithParticleList(t, e);
                }, n.prototype.GetParticleGroupList = function() {
                    return this.m_groupList;
                }, n.prototype.GetParticleGroupCount = function() {
                    return this.m_groupCount;
                }, n.prototype.GetParticleCount = function() {
                    return this.m_count;
                }, n.prototype.GetMaxParticleCount = function() {
                    return this.m_def.maxCount;
                }, n.prototype.SetMaxParticleCount = function(t) {
                    this.m_def.maxCount = t;
                }, n.prototype.GetAllParticleFlags = function() {
                    return this.m_allParticleFlags;
                }, n.prototype.GetAllGroupFlags = function() {
                    return this.m_allGroupFlags;
                }, n.prototype.SetPaused = function(t) {
                    this.m_paused = t;
                }, n.prototype.GetPaused = function() {
                    return this.m_paused;
                }, n.prototype.SetDensity = function(t) {
                    this.m_def.density = t, this.m_inverseDensity = 1 / this.m_def.density;
                }, n.prototype.GetDensity = function() {
                    return this.m_def.density;
                }, n.prototype.SetGravityScale = function(t) {
                    this.m_def.gravityScale = t;
                }, n.prototype.GetGravityScale = function() {
                    return this.m_def.gravityScale;
                }, n.prototype.SetDamping = function(t) {
                    this.m_def.dampingStrength = t;
                }, n.prototype.GetDamping = function() {
                    return this.m_def.dampingStrength;
                }, n.prototype.SetStaticPressureIterations = function(t) {
                    this.m_def.staticPressureIterations = t;
                }, n.prototype.GetStaticPressureIterations = function() {
                    return this.m_def.staticPressureIterations;
                }, n.prototype.SetRadius = function(t) {
                    this.m_particleDiameter = 2 * t, this.m_squaredDiameter = this.m_particleDiameter * this.m_particleDiameter, 
                    this.m_inverseDiameter = 1 / this.m_particleDiameter;
                }, n.prototype.GetRadius = function() {
                    return this.m_particleDiameter / 2;
                }, n.prototype.GetPositionBuffer = function() {
                    if (!this.m_positionBuffer.data) throw new Error();
                    return this.m_positionBuffer.data;
                }, n.prototype.GetVelocityBuffer = function() {
                    if (!this.m_velocityBuffer.data) throw new Error();
                    return this.m_velocityBuffer.data;
                }, n.prototype.GetColorBuffer = function() {
                    return this.m_colorBuffer.data = this.RequestBuffer(this.m_colorBuffer.data), this.m_colorBuffer.data;
                }, n.prototype.GetGroupBuffer = function() {
                    return this.m_groupBuffer;
                }, n.prototype.GetWeightBuffer = function() {
                    return this.m_weightBuffer;
                }, n.prototype.GetUserDataBuffer = function() {
                    return this.m_userDataBuffer.data = this.RequestBuffer(this.m_userDataBuffer.data), 
                    this.m_userDataBuffer.data;
                }, n.prototype.GetFlagsBuffer = function() {
                    if (!this.m_flagsBuffer.data) throw new Error();
                    return this.m_flagsBuffer.data;
                }, n.prototype.SetParticleFlags = function(e, i) {
                    if (!this.m_flagsBuffer.data) throw new Error();
                    this.m_flagsBuffer.data[e] & ~i && (this.m_needsUpdateAllParticleFlags = !0), ~this.m_allParticleFlags & i && (i & t.b2ParticleFlag.b2_tensileParticle && (this.m_accumulation2Buffer = this.RequestBuffer(this.m_accumulation2Buffer)), 
                    i & t.b2ParticleFlag.b2_colorMixingParticle && (this.m_colorBuffer.data = this.RequestBuffer(this.m_colorBuffer.data)), 
                    this.m_allParticleFlags |= i), this.m_flagsBuffer.data[e] = i;
                }, n.prototype.GetParticleFlags = function(t) {
                    if (!this.m_flagsBuffer.data) throw new Error();
                    return this.m_flagsBuffer.data[t];
                }, n.prototype.SetFlagsBuffer = function(t, e) {
                    this.SetUserOverridableBuffer(this.m_flagsBuffer, t, e);
                }, n.prototype.SetPositionBuffer = function(t, e) {
                    this.SetUserOverridableBuffer(this.m_positionBuffer, t, e);
                }, n.prototype.SetVelocityBuffer = function(t, e) {
                    this.SetUserOverridableBuffer(this.m_velocityBuffer, t, e);
                }, n.prototype.SetColorBuffer = function(t, e) {
                    this.SetUserOverridableBuffer(this.m_colorBuffer, t, e);
                }, n.prototype.SetUserDataBuffer = function(t, e) {
                    this.SetUserOverridableBuffer(this.m_userDataBuffer, t, e);
                }, n.prototype.GetContacts = function() {
                    return this.m_contactBuffer.data;
                }, n.prototype.GetContactCount = function() {
                    return this.m_contactBuffer.count;
                }, n.prototype.GetBodyContacts = function() {
                    return this.m_bodyContactBuffer.data;
                }, n.prototype.GetBodyContactCount = function() {
                    return this.m_bodyContactBuffer.count;
                }, n.prototype.GetPairs = function() {
                    return this.m_pairBuffer.data;
                }, n.prototype.GetPairCount = function() {
                    return this.m_pairBuffer.count;
                }, n.prototype.GetTriads = function() {
                    return this.m_triadBuffer.data;
                }, n.prototype.GetTriadCount = function() {
                    return this.m_triadBuffer.count;
                }, n.prototype.SetStuckThreshold = function(t) {
                    this.m_stuckThreshold = t, t > 0 && (this.m_lastBodyContactStepBuffer.data = this.RequestBuffer(this.m_lastBodyContactStepBuffer.data), 
                    this.m_bodyContactCountBuffer.data = this.RequestBuffer(this.m_bodyContactCountBuffer.data), 
                    this.m_consecutiveContactStepsBuffer.data = this.RequestBuffer(this.m_consecutiveContactStepsBuffer.data));
                }, n.prototype.GetStuckCandidates = function() {
                    return this.m_stuckParticleBuffer.Data();
                }, n.prototype.GetStuckCandidateCount = function() {
                    return this.m_stuckParticleBuffer.GetCount();
                }, n.prototype.ComputeCollisionEnergy = function() {
                    if (!this.m_velocityBuffer.data) throw new Error();
                    for (var t = n.ComputeCollisionEnergy_s_v, e = this.m_velocityBuffer.data, i = 0, r = 0; r < this.m_contactBuffer.count; r++) {
                        var s = this.m_contactBuffer.data[r], o = s.indexA, a = s.indexB, c = s.normal, l = P.SubVV(e[a], e[o], t), u = P.DotVV(l, c);
                        u < 0 && (i += u * u);
                    }
                    return .5 * this.GetParticleMass() * i;
                }, n.prototype.SetStrictContactCheck = function(t) {
                    this.m_def.strictContactCheck = t;
                }, n.prototype.GetStrictContactCheck = function() {
                    return this.m_def.strictContactCheck;
                }, n.prototype.SetParticleLifetime = function(t, e) {
                    var i = null === this.m_indexByExpirationTimeBuffer.data;
                    if (this.m_expirationTimeBuffer.data = this.RequestBuffer(this.m_expirationTimeBuffer.data), 
                    this.m_indexByExpirationTimeBuffer.data = this.RequestBuffer(this.m_indexByExpirationTimeBuffer.data), 
                    i) for (var n = this.GetParticleCount(), r = 0; r < n; ++r) this.m_indexByExpirationTimeBuffer.data[r] = r;
                    var s = e / this.m_def.lifetimeGranularity, o = s > 0 ? this.GetQuantizedTimeElapsed() + s : s;
                    o !== this.m_expirationTimeBuffer.data[t] && (this.m_expirationTimeBuffer.data[t] = o, 
                    this.m_expirationTimeBufferRequiresSorting = !0);
                }, n.prototype.GetParticleLifetime = function(t) {
                    return this.ExpirationTimeToLifetime(this.GetExpirationTimeBuffer()[t]);
                }, n.prototype.SetDestructionByAge = function(t) {
                    t && this.GetExpirationTimeBuffer(), this.m_def.destroyByAge = t;
                }, n.prototype.GetDestructionByAge = function() {
                    return this.m_def.destroyByAge;
                }, n.prototype.GetExpirationTimeBuffer = function() {
                    return this.m_expirationTimeBuffer.data = this.RequestBuffer(this.m_expirationTimeBuffer.data), 
                    this.m_expirationTimeBuffer.data;
                }, n.prototype.ExpirationTimeToLifetime = function(t) {
                    return (t > 0 ? t - this.GetQuantizedTimeElapsed() : t) * this.m_def.lifetimeGranularity;
                }, n.prototype.GetIndexByExpirationTimeBuffer = function() {
                    if (this.GetParticleCount() ? this.SetParticleLifetime(0, this.GetParticleLifetime(0)) : this.m_indexByExpirationTimeBuffer.data = this.RequestBuffer(this.m_indexByExpirationTimeBuffer.data), 
                    !this.m_indexByExpirationTimeBuffer.data) throw new Error();
                    return this.m_indexByExpirationTimeBuffer.data;
                }, n.prototype.ParticleApplyLinearImpulse = function(t, e) {
                    this.ApplyLinearImpulse(t, t + 1, e);
                }, n.prototype.ApplyLinearImpulse = function(t, e, i) {
                    if (!this.m_velocityBuffer.data) throw new Error();
                    for (var n = this.m_velocityBuffer.data, r = (e - t) * this.GetParticleMass(), s = new P().Copy(i).SelfMul(1 / r), o = t; o < e; o++) n[o].SelfAdd(s);
                }, n.IsSignificantForce = function(t) {
                    return 0 !== t.x || 0 !== t.y;
                }, n.prototype.ParticleApplyForce = function(t, e) {
                    if (!this.m_flagsBuffer.data) throw new Error();
                    n.IsSignificantForce(e) && this.ForceCanBeApplied(this.m_flagsBuffer.data[t]) && (this.PrepareForceBuffer(), 
                    this.m_forceBuffer[t].SelfAdd(e));
                }, n.prototype.ApplyForce = function(t, e, i) {
                    var r = new P().Copy(i).SelfMul(1 / (e - t));
                    if (n.IsSignificantForce(r)) {
                        this.PrepareForceBuffer();
                        for (var s = t; s < e; s++) this.m_forceBuffer[s].SelfAdd(r);
                    }
                }, n.prototype.GetNext = function() {
                    return this.m_next;
                }, n.prototype.QueryAABB = function(t, e) {
                    if (0 !== this.m_proxyBuffer.count) {
                        var i = this.m_proxyBuffer.count, r = Vn(this.m_proxyBuffer.data, 0, i, n.computeTag(this.m_inverseDiameter * e.lowerBound.x, this.m_inverseDiameter * e.lowerBound.y), n.Proxy.CompareProxyTag), s = Ln(this.m_proxyBuffer.data, r, i, n.computeTag(this.m_inverseDiameter * e.upperBound.x, this.m_inverseDiameter * e.upperBound.y), n.Proxy.CompareTagProxy);
                        if (!this.m_positionBuffer.data) throw new Error();
                        for (var o = this.m_positionBuffer.data, a = r; a < s; ++a) {
                            var c = this.m_proxyBuffer.data[a].index, l = o[c];
                            if (e.lowerBound.x < l.x && l.x < e.upperBound.x && e.lowerBound.y < l.y && l.y < e.upperBound.y && !t.ReportParticle(this, c)) break;
                        }
                    }
                }, n.prototype.QueryShapeAABB = function(t, e, i, r) {
                    void 0 === r && (r = 0);
                    var s = n.QueryShapeAABB_s_aabb;
                    e.ComputeAABB(s, i, r), this.QueryAABB(t, s);
                }, n.prototype.QueryPointAABB = function(t, e, i) {
                    void 0 === i && (i = c);
                    var r = n.QueryPointAABB_s_aabb;
                    r.lowerBound.Set(e.x - i, e.y - i), r.upperBound.Set(e.x + i, e.y + i), this.QueryAABB(t, r);
                }, n.prototype.RayCast = function(t, e, i) {
                    var r = n.RayCast_s_aabb, s = n.RayCast_s_p, o = n.RayCast_s_v, a = n.RayCast_s_n, c = n.RayCast_s_point;
                    if (0 !== this.m_proxyBuffer.count) {
                        if (!this.m_positionBuffer.data) throw new Error();
                        var l = this.m_positionBuffer.data, u = r;
                        P.MinV(e, i, u.lowerBound), P.MaxV(e, i, u.upperBound);
                        for (var h, _ = 1, f = P.SubVV(i, e, o), d = P.DotVV(f, f), p = this.GetInsideBoundsEnumerator(u); (h = p.GetNext()) >= 0; ) {
                            var m = P.SubVV(e, l[h], s), y = P.DotVV(m, f), g = y * y - d * (P.DotVV(m, m) - this.m_squaredDiameter);
                            if (g >= 0) {
                                var x = S(g), A = (-y - x) / d;
                                if (A > _) continue;
                                if (A < 0 && ((A = (-y + x) / d) < 0 || A > _)) continue;
                                var C = P.AddVMulSV(m, A, f, a);
                                C.Normalize();
                                var b = t.ReportParticle(this, h, P.AddVMulSV(e, A, f, c), C, A);
                                if ((_ = v(_, b)) <= 0) break;
                            }
                        }
                    }
                }, n.prototype.ComputeAABB = function(t) {
                    var e = this.GetParticleCount();
                    if (t.lowerBound.x = +i, t.lowerBound.y = +i, t.upperBound.x = -i, t.upperBound.y = -i, 
                    !this.m_positionBuffer.data) throw new Error();
                    for (var n = this.m_positionBuffer.data, r = 0; r < e; r++) {
                        var s = n[r];
                        P.MinV(t.lowerBound, s, t.lowerBound), P.MaxV(t.upperBound, s, t.upperBound);
                    }
                    t.lowerBound.x -= this.m_particleDiameter, t.lowerBound.y -= this.m_particleDiameter, 
                    t.upperBound.x += this.m_particleDiameter, t.upperBound.y += this.m_particleDiameter;
                }, n.prototype.FreeBuffer = function(t) {
                    null !== t && (t.length = 0);
                }, n.prototype.FreeUserOverridableBuffer = function(t) {
                    0 === t.userSuppliedCapacity && this.FreeBuffer(t.data, this.m_internalAllocatedCapacity);
                }, n.prototype.ReallocateBuffer3 = function(t, e, i) {
                    if (i <= e) throw new Error();
                    var n = t ? t.slice() : [];
                    return n.length = i, n;
                }, n.prototype.ReallocateBuffer5 = function(t, e, i, n, r) {
                    if (n <= i) throw new Error();
                    if (e && !(n <= e)) throw new Error();
                    return r && !t || e || (t = this.ReallocateBuffer3(t, i, n)), t;
                }, n.prototype.ReallocateBuffer4 = function(t, e, i, n) {
                    return this.ReallocateBuffer5(t.data, t.userSuppliedCapacity, e, i, n);
                }, n.prototype.RequestBuffer = function(t) {
                    return t || (0 === this.m_internalAllocatedCapacity && this.ReallocateInternalAllocatedBuffers(256), 
                    (t = []).length = this.m_internalAllocatedCapacity), t;
                }, n.prototype.ReallocateHandleBuffers = function(t) {
                    this.m_handleIndexBuffer.data = this.ReallocateBuffer4(this.m_handleIndexBuffer, this.m_internalAllocatedCapacity, t, !0);
                }, n.prototype.ReallocateInternalAllocatedBuffers = function(t) {
                    function e(t, e) {
                        return e && t > e ? e : t;
                    }
                    if (t = e(t, this.m_def.maxCount), t = e(t, this.m_flagsBuffer.userSuppliedCapacity), 
                    t = e(t, this.m_positionBuffer.userSuppliedCapacity), t = e(t, this.m_velocityBuffer.userSuppliedCapacity), 
                    t = e(t, this.m_colorBuffer.userSuppliedCapacity), t = e(t, this.m_userDataBuffer.userSuppliedCapacity), 
                    this.m_internalAllocatedCapacity < t) {
                        this.ReallocateHandleBuffers(t), this.m_flagsBuffer.data = this.ReallocateBuffer4(this.m_flagsBuffer, this.m_internalAllocatedCapacity, t, !1);
                        var i = this.m_stuckThreshold > 0;
                        this.m_lastBodyContactStepBuffer.data = this.ReallocateBuffer4(this.m_lastBodyContactStepBuffer, this.m_internalAllocatedCapacity, t, i), 
                        this.m_bodyContactCountBuffer.data = this.ReallocateBuffer4(this.m_bodyContactCountBuffer, this.m_internalAllocatedCapacity, t, i), 
                        this.m_consecutiveContactStepsBuffer.data = this.ReallocateBuffer4(this.m_consecutiveContactStepsBuffer, this.m_internalAllocatedCapacity, t, i), 
                        this.m_positionBuffer.data = this.ReallocateBuffer4(this.m_positionBuffer, this.m_internalAllocatedCapacity, t, !1), 
                        this.m_velocityBuffer.data = this.ReallocateBuffer4(this.m_velocityBuffer, this.m_internalAllocatedCapacity, t, !1), 
                        this.m_forceBuffer = this.ReallocateBuffer5(this.m_forceBuffer, 0, this.m_internalAllocatedCapacity, t, !1), 
                        this.m_weightBuffer = this.ReallocateBuffer5(this.m_weightBuffer, 0, this.m_internalAllocatedCapacity, t, !1), 
                        this.m_staticPressureBuffer = this.ReallocateBuffer5(this.m_staticPressureBuffer, 0, this.m_internalAllocatedCapacity, t, !0), 
                        this.m_accumulationBuffer = this.ReallocateBuffer5(this.m_accumulationBuffer, 0, this.m_internalAllocatedCapacity, t, !1), 
                        this.m_accumulation2Buffer = this.ReallocateBuffer5(this.m_accumulation2Buffer, 0, this.m_internalAllocatedCapacity, t, !0), 
                        this.m_depthBuffer = this.ReallocateBuffer5(this.m_depthBuffer, 0, this.m_internalAllocatedCapacity, t, !0), 
                        this.m_colorBuffer.data = this.ReallocateBuffer4(this.m_colorBuffer, this.m_internalAllocatedCapacity, t, !0), 
                        this.m_groupBuffer = this.ReallocateBuffer5(this.m_groupBuffer, 0, this.m_internalAllocatedCapacity, t, !1), 
                        this.m_userDataBuffer.data = this.ReallocateBuffer4(this.m_userDataBuffer, this.m_internalAllocatedCapacity, t, !0), 
                        this.m_expirationTimeBuffer.data = this.ReallocateBuffer4(this.m_expirationTimeBuffer, this.m_internalAllocatedCapacity, t, !0), 
                        this.m_indexByExpirationTimeBuffer.data = this.ReallocateBuffer4(this.m_indexByExpirationTimeBuffer, this.m_internalAllocatedCapacity, t, !1), 
                        this.m_internalAllocatedCapacity = t;
                    }
                }, n.prototype.CreateParticleForGroup = function(t, i, n) {
                    var r = new An();
                    r.flags = e(t.flags, 0), F.MulXV(i, n, r.position), P.AddVV(e(t.linearVelocity, P.ZERO), P.CrossSV(e(t.angularVelocity, 0), P.SubVV(r.position, e(t.position, P.ZERO), P.s_t0), P.s_t0), r.velocity), 
                    r.color.Copy(e(t.color, G.ZERO)), r.lifetime = e(t.lifetime, 0), r.userData = t.userData, 
                    this.CreateParticle(r);
                }, n.prototype.CreateParticlesStrokeShapeForGroup = function(i, r, s) {
                    var o = n.CreateParticlesStrokeShapeForGroup_s_edge, a = n.CreateParticlesStrokeShapeForGroup_s_d, c = n.CreateParticlesStrokeShapeForGroup_s_p, l = e(r.stride, 0);
                    0 === l && (l = this.GetParticleStride());
                    for (var u = 0, h = i.GetChildCount(), _ = 0; _ < h; _++) {
                        var f = null;
                        i.GetType() === t.b2ShapeType.e_edgeShape ? f = i : (f = o, i.GetChildEdge(f, _));
                        for (var d = P.SubVV(f.m_vertex2, f.m_vertex1, a), p = d.Length(); u < p; ) {
                            var m = P.AddVMulSV(f.m_vertex1, u / p, d, c);
                            this.CreateParticleForGroup(r, s, m), u += l;
                        }
                        u -= p;
                    }
                }, n.prototype.CreateParticlesFillShapeForGroup = function(t, i, r) {
                    var s = n.CreateParticlesFillShapeForGroup_s_aabb, o = n.CreateParticlesFillShapeForGroup_s_p, a = e(i.stride, 0);
                    0 === a && (a = this.GetParticleStride());
                    var c = F.IDENTITY, l = s;
                    t.ComputeAABB(l, c, 0);
                    for (var u = Math.floor(l.lowerBound.y / a) * a; u < l.upperBound.y; u += a) for (var h = Math.floor(l.lowerBound.x / a) * a; h < l.upperBound.x; h += a) {
                        var _ = o.Set(h, u);
                        t.TestPoint(c, _) && this.CreateParticleForGroup(i, r, _);
                    }
                }, n.prototype.CreateParticlesWithShapeForGroup = function(e, i, n) {
                    switch (e.GetType()) {
                      case t.b2ShapeType.e_edgeShape:
                      case t.b2ShapeType.e_chainShape:
                        this.CreateParticlesStrokeShapeForGroup(e, i, n);
                        break;

                      case t.b2ShapeType.e_polygonShape:
                      case t.b2ShapeType.e_circleShape:
                        this.CreateParticlesFillShapeForGroup(e, i, n);
                    }
                }, n.prototype.CreateParticlesWithShapesForGroup = function(t, e, i, r) {
                    var s = new n.CompositeShape(t, e);
                    this.CreateParticlesFillShapeForGroup(s, i, r);
                }, n.prototype.CloneParticle = function(t, e) {
                    var i = new An();
                    if (!this.m_flagsBuffer.data) throw new Error();
                    if (!this.m_positionBuffer.data) throw new Error();
                    if (!this.m_velocityBuffer.data) throw new Error();
                    i.flags = this.m_flagsBuffer.data[t], i.position.Copy(this.m_positionBuffer.data[t]), 
                    i.velocity.Copy(this.m_velocityBuffer.data[t]), this.m_colorBuffer.data && i.color.Copy(this.m_colorBuffer.data[t]), 
                    this.m_userDataBuffer.data && (i.userData = this.m_userDataBuffer.data[t]), i.group = e;
                    var n = this.CreateParticle(i);
                    if (this.m_handleIndexBuffer.data) {
                        var r = this.m_handleIndexBuffer.data[t];
                        r && r.SetIndex(n), this.m_handleIndexBuffer.data[n] = r, this.m_handleIndexBuffer.data[t] = null;
                    }
                    return this.m_lastBodyContactStepBuffer.data && (this.m_lastBodyContactStepBuffer.data[n] = this.m_lastBodyContactStepBuffer.data[t]), 
                    this.m_bodyContactCountBuffer.data && (this.m_bodyContactCountBuffer.data[n] = this.m_bodyContactCountBuffer.data[t]), 
                    this.m_consecutiveContactStepsBuffer.data && (this.m_consecutiveContactStepsBuffer.data[n] = this.m_consecutiveContactStepsBuffer.data[t]), 
                    this.m_hasForce && this.m_forceBuffer[n].Copy(this.m_forceBuffer[t]), this.m_staticPressureBuffer && (this.m_staticPressureBuffer[n] = this.m_staticPressureBuffer[t]), 
                    this.m_depthBuffer && (this.m_depthBuffer[n] = this.m_depthBuffer[t]), this.m_expirationTimeBuffer.data && (this.m_expirationTimeBuffer.data[n] = this.m_expirationTimeBuffer.data[t]), 
                    n;
                }, n.prototype.DestroyParticlesInGroup = function(t, e) {
                    void 0 === e && (e = !1);
                    for (var i = t.m_firstIndex; i < t.m_lastIndex; i++) this.DestroyParticle(i, e);
                }, n.prototype.DestroyParticleGroup = function(t) {
                    this.m_world.m_destructionListener && this.m_world.m_destructionListener.SayGoodbyeParticleGroup(t), 
                    this.SetGroupFlags(t, 0);
                    for (var e = t.m_firstIndex; e < t.m_lastIndex; e++) this.m_groupBuffer[e] = null;
                    t.m_prev && (t.m_prev.m_next = t.m_next), t.m_next && (t.m_next.m_prev = t.m_prev), 
                    t === this.m_groupList && (this.m_groupList = t.m_next), --this.m_groupCount;
                }, n.ParticleCanBeConnected = function(e, i) {
                    return 0 != (e & (t.b2ParticleFlag.b2_wallParticle | t.b2ParticleFlag.b2_springParticle | t.b2ParticleFlag.b2_elasticParticle)) || null !== i && 0 != (i.GetGroupFlags() & t.b2ParticleGroupFlag.b2_rigidParticleGroup);
                }, n.prototype.UpdatePairsAndTriads = function(e, i, r) {
                    var s = n.UpdatePairsAndTriads_s_dab, o = n.UpdatePairsAndTriads_s_dbc, a = n.UpdatePairsAndTriads_s_dca;
                    if (!this.m_flagsBuffer.data) throw new Error();
                    if (!this.m_positionBuffer.data) throw new Error();
                    if (!this.m_velocityBuffer.data) throw new Error();
                    for (var c = this.m_positionBuffer.data, l = 0, u = e; u < i; u++) l |= this.m_flagsBuffer.data[u];
                    if (l & n.k_pairFlags) for (var h = 0; h < this.m_contactBuffer.count; h++) {
                        var _ = this.m_contactBuffer.data[h], f = _.indexA, d = _.indexB, p = this.m_flagsBuffer.data[f], m = this.m_flagsBuffer.data[d], y = this.m_groupBuffer[f], g = this.m_groupBuffer[d];
                        if (f >= e && f < i && d >= e && d < i && !((p | m) & t.b2ParticleFlag.b2_zombieParticle) && (p | m) & n.k_pairFlags && (r.IsNecessary(f) || r.IsNecessary(d)) && n.ParticleCanBeConnected(p, y) && n.ParticleCanBeConnected(m, g) && r.ShouldCreatePair(f, d)) {
                            var x = this.m_pairBuffer.data[this.m_pairBuffer.Append()];
                            x.indexA = f, x.indexB = d, x.flags = _.flags, x.strength = v(y ? y.m_strength : 1, g ? g.m_strength : 1), 
                            x.distance = P.DistanceVV(c[f], c[d]);
                        }
                        In(this.m_pairBuffer.data, 0, this.m_pairBuffer.count, n.ComparePairIndices), this.m_pairBuffer.Unique(n.MatchPairIndices);
                    }
                    if (l & n.k_triadFlags) {
                        var A = new Bn(i - e);
                        for (u = e; u < i; u++) {
                            var C = this.m_flagsBuffer.data[u], b = this.m_groupBuffer[u];
                            C & t.b2ParticleFlag.b2_zombieParticle || !n.ParticleCanBeConnected(C, b) || A.AddGenerator(c[u], u, r.IsNecessary(u));
                        }
                        var S = this.GetParticleStride();
                        A.Generate(S / 2, 2 * S);
                        var T = this;
                        A.GetNodes(function(t, e, i) {
                            if (!T.m_flagsBuffer.data) throw new Error();
                            var l = T.m_flagsBuffer.data[t], u = T.m_flagsBuffer.data[e], h = T.m_flagsBuffer.data[i];
                            if ((l | u | h) & n.k_triadFlags && r.ShouldCreateTriad(t, e, i)) {
                                var _ = c[t], f = c[e], d = c[i], p = P.SubVV(_, f, s), m = P.SubVV(f, d, o), y = P.SubVV(d, _, a), g = 4 * T.m_squaredDiameter;
                                if (P.DotVV(p, p) > g || P.DotVV(m, m) > g || P.DotVV(y, y) > g) return;
                                var x = T.m_groupBuffer[t], A = T.m_groupBuffer[e], C = T.m_groupBuffer[i], b = T.m_triadBuffer.data[T.m_triadBuffer.Append()];
                                b.indexA = t, b.indexB = e, b.indexC = i, b.flags = l | u | h, b.strength = v(v(x ? x.m_strength : 1, A ? A.m_strength : 1), C ? C.m_strength : 1);
                                var S = (_.x + f.x + d.x) / 3, w = (_.y + f.y + d.y) / 3;
                                b.pa.x = _.x - S, b.pa.y = _.y - w, b.pb.x = f.x - S, b.pb.y = f.y - w, b.pc.x = d.x - S, 
                                b.pc.y = d.y - w, b.ka = -P.DotVV(y, p), b.kb = -P.DotVV(p, m), b.kc = -P.DotVV(m, y), 
                                b.s = P.CrossVV(_, f) + P.CrossVV(f, d) + P.CrossVV(d, _);
                            }
                        }), In(this.m_triadBuffer.data, 0, this.m_triadBuffer.count, n.CompareTriadIndices), 
                        this.m_triadBuffer.Unique(n.MatchTriadIndices);
                    }
                }, n.prototype.UpdatePairsAndTriadsWithReactiveParticles = function() {
                    var e = new n.ReactiveFilter(this.m_flagsBuffer);
                    if (this.UpdatePairsAndTriads(0, this.m_count, e), !this.m_flagsBuffer.data) throw new Error();
                    for (var i = 0; i < this.m_count; i++) this.m_flagsBuffer.data[i] &= ~t.b2ParticleFlag.b2_reactiveParticle;
                    this.m_allParticleFlags &= ~t.b2ParticleFlag.b2_reactiveParticle;
                }, n.ComparePairIndices = function(t, e) {
                    var i = t.indexA - e.indexA;
                    return 0 !== i ? i < 0 : t.indexB < e.indexB;
                }, n.MatchPairIndices = function(t, e) {
                    return t.indexA === e.indexA && t.indexB === e.indexB;
                }, n.CompareTriadIndices = function(t, e) {
                    var i = t.indexA - e.indexA;
                    if (0 !== i) return i < 0;
                    var n = t.indexB - e.indexB;
                    return 0 !== n ? n < 0 : t.indexC < e.indexC;
                }, n.MatchTriadIndices = function(t, e) {
                    return t.indexA === e.indexA && t.indexB === e.indexB && t.indexC === e.indexC;
                }, n.InitializeParticleLists = function(t, e) {
                    for (var i = t.GetBufferIndex(), n = t.GetParticleCount(), r = 0; r < n; r++) {
                        var s = e[r];
                        s.list = s, s.next = null, s.count = 1, s.index = r + i;
                    }
                }, n.prototype.MergeParticleListsInContact = function(t, e) {
                    for (var i = t.GetBufferIndex(), r = 0; r < this.m_contactBuffer.count; r++) {
                        var s = this.m_contactBuffer.data[r], o = s.indexA, a = s.indexB;
                        if (t.ContainsParticle(o) && t.ContainsParticle(a)) {
                            var c = e[o - i].list, l = e[a - i].list;
                            if (c !== l) {
                                if (c.count < l.count) {
                                    var u = c;
                                    c = l, l = u;
                                }
                                n.MergeParticleLists(c, l);
                            }
                        }
                    }
                }, n.MergeParticleLists = function(t, e) {
                    for (var i = e; ;) {
                        i.list = t;
                        var n = i.next;
                        if (!n) {
                            i.next = t.next;
                            break;
                        }
                        i = n;
                    }
                    t.next = e, t.count += e.count, e.count = 0;
                }, n.FindLongestParticleList = function(t, e) {
                    for (var i = t.GetParticleCount(), n = e[0], r = 0; r < i; r++) {
                        var s = e[r];
                        n.count < s.count && (n = s);
                    }
                    return n;
                }, n.prototype.MergeZombieParticleListNodes = function(e, i, r) {
                    if (!this.m_flagsBuffer.data) throw new Error();
                    for (var s = e.GetParticleCount(), o = 0; o < s; o++) {
                        var a = i[o];
                        a !== r && this.m_flagsBuffer.data[a.index] & t.b2ParticleFlag.b2_zombieParticle && n.MergeParticleListAndNode(r, a);
                    }
                }, n.MergeParticleListAndNode = function(t, e) {
                    e.list = t, e.next = t.next, t.next = e, t.count++, e.count = 0;
                }, n.prototype.CreateParticleGroupsFromParticleList = function(e, i, n) {
                    if (!this.m_flagsBuffer.data) throw new Error();
                    var r = e.GetParticleCount(), s = new Tn();
                    s.groupFlags = e.GetGroupFlags(), s.userData = e.GetUserData();
                    for (var o = 0; o < r; o++) {
                        var a = i[o];
                        if (a.count && a !== n) for (var c = this.CreateParticleGroup(s), l = a; l; l = l.next) {
                            var u = l.index, h = this.CloneParticle(u, c);
                            this.m_flagsBuffer.data[u] |= t.b2ParticleFlag.b2_zombieParticle, l.index = h;
                        }
                    }
                }, n.prototype.UpdatePairsAndTriadsWithParticleList = function(t, e) {
                    for (var i = t.GetBufferIndex(), n = 0; n < this.m_pairBuffer.count; n++) {
                        var r = this.m_pairBuffer.data[n], s = r.indexA, o = r.indexB;
                        t.ContainsParticle(s) && (r.indexA = e[s - i].index), t.ContainsParticle(o) && (r.indexB = e[o - i].index);
                    }
                    for (n = 0; n < this.m_triadBuffer.count; n++) {
                        var a = this.m_triadBuffer.data[n], c = (s = a.indexA, o = a.indexB, a.indexC);
                        t.ContainsParticle(s) && (a.indexA = e[s - i].index), t.ContainsParticle(o) && (a.indexB = e[o - i].index), 
                        t.ContainsParticle(c) && (a.indexC = e[c - i].index);
                    }
                }, n.prototype.ComputeDepth = function() {
                    for (var e = [], n = 0, r = 0; r < this.m_contactBuffer.count; r++) {
                        var s = (y = this.m_contactBuffer.data[r]).indexA, o = y.indexB, a = this.m_groupBuffer[s], c = this.m_groupBuffer[o];
                        a && a === c && a.m_groupFlags & t.b2ParticleGroupFlag.b2_particleGroupNeedsUpdateDepth && (e[n++] = y);
                    }
                    for (var l = [], u = 0, h = this.m_groupList; h; h = h.GetNext()) if (h.m_groupFlags & t.b2ParticleGroupFlag.b2_particleGroupNeedsUpdateDepth) {
                        l[u++] = h, this.SetGroupFlags(h, h.m_groupFlags & ~t.b2ParticleGroupFlag.b2_particleGroupNeedsUpdateDepth);
                        for (var _ = h.m_firstIndex; _ < h.m_lastIndex; _++) this.m_accumulationBuffer[_] = 0;
                    }
                    for (r = 0; r < n; r++) {
                        s = (y = e[r]).indexA, o = y.indexB;
                        var f = y.weight;
                        this.m_accumulationBuffer[s] += f, this.m_accumulationBuffer[o] += f;
                    }
                    for (_ = 0; _ < u; _++) for (var d = (h = l[_]).m_firstIndex; d < h.m_lastIndex; d++) f = this.m_accumulationBuffer[d], 
                    this.m_depthBuffer[d] = f < .8 ? 0 : i;
                    for (var p = S(this.m_count) >> 0, m = 0; m < p; m++) {
                        var v = !1;
                        for (r = 0; r < n; r++) {
                            s = (y = e[r]).indexA, o = y.indexB;
                            var y, g = 1 - y.weight, x = this.m_depthBuffer[s], A = this.m_depthBuffer[o], C = A + g, b = x + g;
                            x > C && (this.m_depthBuffer[s] = C, v = !0), A > b && (this.m_depthBuffer[o] = b, 
                            v = !0);
                        }
                        if (!v) break;
                    }
                    for (_ = 0; _ < u; _++) for (var T = (h = l[_]).m_firstIndex; T < h.m_lastIndex; T++) this.m_depthBuffer[T] < i ? this.m_depthBuffer[T] *= this.m_particleDiameter : this.m_depthBuffer[T] = 0;
                }, n.prototype.GetInsideBoundsEnumerator = function(t) {
                    var e = n.computeTag(this.m_inverseDiameter * t.lowerBound.x - 1, this.m_inverseDiameter * t.lowerBound.y - 1), i = n.computeTag(this.m_inverseDiameter * t.upperBound.x + 1, this.m_inverseDiameter * t.upperBound.y + 1), r = this.m_proxyBuffer.count, s = Vn(this.m_proxyBuffer.data, 0, r, e, n.Proxy.CompareProxyTag), o = Ln(this.m_proxyBuffer.data, 0, r, i, n.Proxy.CompareTagProxy);
                    return new n.InsideBoundsEnumerator(this, e, i, s, o);
                }, n.prototype.UpdateAllParticleFlags = function() {
                    if (!this.m_flagsBuffer.data) throw new Error();
                    this.m_allParticleFlags = 0;
                    for (var t = 0; t < this.m_count; t++) this.m_allParticleFlags |= this.m_flagsBuffer.data[t];
                    this.m_needsUpdateAllParticleFlags = !1;
                }, n.prototype.UpdateAllGroupFlags = function() {
                    this.m_allGroupFlags = 0;
                    for (var t = this.m_groupList; t; t = t.GetNext()) this.m_allGroupFlags |= t.m_groupFlags;
                    this.m_needsUpdateAllGroupFlags = !1;
                }, n.prototype.AddContact = function(t, e) {
                    if (!this.m_flagsBuffer.data) throw new Error();
                    if (!this.m_positionBuffer.data) throw new Error();
                    var i = n.AddContact_s_d, r = this.m_positionBuffer.data, s = P.SubVV(r[e], r[t], i), o = P.DotVV(s, s);
                    if (o < this.m_squaredDiameter) {
                        var a = C(o);
                        isFinite(a) || (a = 198177537e11);
                        var c = this.m_contactBuffer.data[this.m_contactBuffer.Append()];
                        c.indexA = t, c.indexB = e, c.flags = this.m_flagsBuffer.data[t] | this.m_flagsBuffer.data[e], 
                        c.weight = 1 - o * a * this.m_inverseDiameter, P.MulSV(a, s, c.normal);
                    }
                }, n.prototype.FindContacts_Reference = function() {
                    var t = this.m_proxyBuffer.count;
                    this.m_contactBuffer.count = 0;
                    for (var e = 0, i = 0; e < t; e++) {
                        for (var r = n.computeRelativeTag(this.m_proxyBuffer.data[e].tag, 1, 0), s = e + 1; s < t && !(r < this.m_proxyBuffer.data[s].tag); s++) this.AddContact(this.m_proxyBuffer.data[e].index, this.m_proxyBuffer.data[s].index, this.m_contactBuffer);
                        for (var o = n.computeRelativeTag(this.m_proxyBuffer.data[e].tag, -1, 1); i < t && !(o <= this.m_proxyBuffer.data[i].tag); i++) ;
                        var a = n.computeRelativeTag(this.m_proxyBuffer.data[e].tag, 1, 1);
                        for (s = i; s < t && !(a < this.m_proxyBuffer.data[s].tag); s++) this.AddContact(this.m_proxyBuffer.data[e].index, this.m_proxyBuffer.data[s].index, this.m_contactBuffer);
                    }
                }, n.prototype.FindContacts = function(t) {
                    this.FindContacts_Reference(t);
                }, n.prototype.UpdateProxies_Reference = function() {
                    if (!this.m_positionBuffer.data) throw new Error();
                    for (var t = this.m_positionBuffer.data, e = this.m_inverseDiameter, i = 0; i < this.m_proxyBuffer.count; ++i) {
                        var r = this.m_proxyBuffer.data[i], s = t[r.index];
                        r.tag = n.computeTag(e * s.x, e * s.y);
                    }
                }, n.prototype.UpdateProxies = function(t) {
                    this.UpdateProxies_Reference(t);
                }, n.prototype.SortProxies = function() {
                    Pn(this.m_proxyBuffer.data, 0, this.m_proxyBuffer.count, n.Proxy.CompareProxyProxy);
                }, n.prototype.FilterContacts = function() {
                    var e = this.GetParticleContactFilter();
                    if (null !== e) {
                        var i = this;
                        this.m_contactBuffer.RemoveIf(function(n) {
                            return 0 != (n.flags & t.b2ParticleFlag.b2_particleContactFilterParticle) && !e.ShouldCollideParticleParticle(i, n.indexA, n.indexB);
                        });
                    }
                }, n.prototype.NotifyContactListenerPreContact = function(t) {
                    if (null !== this.GetParticleContactListener()) throw t.Initialize(this.m_contactBuffer, this.m_flagsBuffer), 
                    new Error();
                }, n.prototype.NotifyContactListenerPostContact = function() {
                    var t = this.GetParticleContactListener();
                    if (null !== t) {
                        for (var e = 0; e < this.m_contactBuffer.count; ++e) {
                            var i = this.m_contactBuffer.data[e];
                            t.BeginContactParticleParticle(this, i);
                        }
                        throw new Error();
                    }
                }, n.b2ParticleContactIsZombie = function(e) {
                    return (e.flags & t.b2ParticleFlag.b2_zombieParticle) === t.b2ParticleFlag.b2_zombieParticle;
                }, n.prototype.UpdateContacts = function(t) {
                    this.UpdateProxies(this.m_proxyBuffer), this.SortProxies(this.m_proxyBuffer);
                    var e = new n.b2ParticlePairSet();
                    this.NotifyContactListenerPreContact(e), this.FindContacts(this.m_contactBuffer), 
                    this.FilterContacts(this.m_contactBuffer), this.NotifyContactListenerPostContact(e), 
                    t && this.m_contactBuffer.RemoveIf(n.b2ParticleContactIsZombie);
                }, n.prototype.NotifyBodyContactListenerPreContact = function(t) {
                    if (null !== this.GetFixtureContactListener()) throw t.Initialize(this.m_bodyContactBuffer, this.m_flagsBuffer), 
                    new Error();
                }, n.prototype.NotifyBodyContactListenerPostContact = function() {
                    var t = this.GetFixtureContactListener();
                    if (null !== t) {
                        for (var e = 0; e < this.m_bodyContactBuffer.count; e++) {
                            var i = this.m_bodyContactBuffer.data[e];
                            t.BeginContactFixtureParticle(this, i);
                        }
                        throw new Error();
                    }
                }, n.prototype.UpdateBodyContacts = function() {
                    var t = n.UpdateBodyContacts_s_aabb, e = new n.FixtureParticleSet();
                    if (this.NotifyBodyContactListenerPreContact(e), this.m_stuckThreshold > 0) {
                        if (!this.m_bodyContactCountBuffer.data) throw new Error();
                        if (!this.m_lastBodyContactStepBuffer.data) throw new Error();
                        if (!this.m_consecutiveContactStepsBuffer.data) throw new Error();
                        for (var i = this.GetParticleCount(), r = 0; r < i; r++) this.m_bodyContactCountBuffer.data[r] = 0, 
                        this.m_timestamp > this.m_lastBodyContactStepBuffer.data[r] + 1 && (this.m_consecutiveContactStepsBuffer.data[r] = 0);
                    }
                    this.m_bodyContactBuffer.SetCount(0), this.m_stuckParticleBuffer.SetCount(0);
                    var s = t;
                    this.ComputeAABB(s);
                    var o = new n.UpdateBodyContactsCallback(this, this.GetFixtureContactFilter());
                    this.m_world.QueryAABB(o, s), this.m_def.strictContactCheck && this.RemoveSpuriousBodyContacts(), 
                    this.NotifyBodyContactListenerPostContact(e);
                }, n.prototype.Solve = function(e) {
                    var i = n.Solve_s_subStep;
                    if (0 !== this.m_count && (this.m_expirationTimeBuffer.data && this.SolveLifetimes(e), 
                    this.m_allParticleFlags & t.b2ParticleFlag.b2_zombieParticle && this.SolveZombie(), 
                    this.m_needsUpdateAllParticleFlags && this.UpdateAllParticleFlags(), this.m_needsUpdateAllGroupFlags && this.UpdateAllGroupFlags(), 
                    !this.m_paused)) for (this.m_iterationIndex = 0; this.m_iterationIndex < e.particleIterations; this.m_iterationIndex++) {
                        ++this.m_timestamp;
                        var r = i.Copy(e);
                        if (r.dt /= e.particleIterations, r.inv_dt *= e.particleIterations, this.UpdateContacts(!1), 
                        this.UpdateBodyContacts(), this.ComputeWeight(), this.m_allGroupFlags & t.b2ParticleGroupFlag.b2_particleGroupNeedsUpdateDepth && this.ComputeDepth(), 
                        this.m_allParticleFlags & t.b2ParticleFlag.b2_reactiveParticle && this.UpdatePairsAndTriadsWithReactiveParticles(), 
                        this.m_hasForce && this.SolveForce(r), this.m_allParticleFlags & t.b2ParticleFlag.b2_viscousParticle && this.SolveViscous(), 
                        this.m_allParticleFlags & t.b2ParticleFlag.b2_repulsiveParticle && this.SolveRepulsive(r), 
                        this.m_allParticleFlags & t.b2ParticleFlag.b2_powderParticle && this.SolvePowder(r), 
                        this.m_allParticleFlags & t.b2ParticleFlag.b2_tensileParticle && this.SolveTensile(r), 
                        this.m_allGroupFlags & t.b2ParticleGroupFlag.b2_solidParticleGroup && this.SolveSolid(r), 
                        this.m_allParticleFlags & t.b2ParticleFlag.b2_colorMixingParticle && this.SolveColorMixing(), 
                        this.SolveGravity(r), this.m_allParticleFlags & t.b2ParticleFlag.b2_staticPressureParticle && this.SolveStaticPressure(r), 
                        this.SolvePressure(r), this.SolveDamping(r), this.m_allParticleFlags & n.k_extraDampingFlags && this.SolveExtraDamping(), 
                        this.m_allParticleFlags & t.b2ParticleFlag.b2_elasticParticle && this.SolveElastic(r), 
                        this.m_allParticleFlags & t.b2ParticleFlag.b2_springParticle && this.SolveSpring(r), 
                        this.LimitVelocity(r), this.m_allGroupFlags & t.b2ParticleGroupFlag.b2_rigidParticleGroup && this.SolveRigidDamping(), 
                        this.m_allParticleFlags & t.b2ParticleFlag.b2_barrierParticle && this.SolveBarrier(r), 
                        this.SolveCollision(r), this.m_allGroupFlags & t.b2ParticleGroupFlag.b2_rigidParticleGroup && this.SolveRigid(r), 
                        this.m_allParticleFlags & t.b2ParticleFlag.b2_wallParticle && this.SolveWall(), 
                        !this.m_positionBuffer.data) throw new Error();
                        if (!this.m_velocityBuffer.data) throw new Error();
                        for (var s = 0; s < this.m_count; s++) this.m_positionBuffer.data[s].SelfMulAdd(r.dt, this.m_velocityBuffer.data[s]);
                    }
                }, n.prototype.SolveCollision = function(t) {
                    var e = n.SolveCollision_s_aabb;
                    if (!this.m_positionBuffer.data) throw new Error();
                    if (!this.m_velocityBuffer.data) throw new Error();
                    var r = this.m_positionBuffer.data, s = this.m_velocityBuffer.data, o = e;
                    o.lowerBound.x = +i, o.lowerBound.y = +i, o.upperBound.x = -i, o.upperBound.y = -i;
                    for (var a = 0; a < this.m_count; a++) {
                        var c = s[a], l = r[a], u = l.x + t.dt * c.x, h = l.y + t.dt * c.y;
                        o.lowerBound.x = v(o.lowerBound.x, v(l.x, u)), o.lowerBound.y = v(o.lowerBound.y, v(l.y, h)), 
                        o.upperBound.x = y(o.upperBound.x, y(l.x, u)), o.upperBound.y = y(o.upperBound.y, y(l.y, h));
                    }
                    var _ = new n.SolveCollisionCallback(this, t);
                    this.m_world.QueryAABB(_, o);
                }, n.prototype.LimitVelocity = function(t) {
                    if (!this.m_velocityBuffer.data) throw new Error();
                    for (var e = this.m_velocityBuffer.data, i = this.GetCriticalVelocitySquared(t), n = 0; n < this.m_count; n++) {
                        var r = e[n], s = P.DotVV(r, r);
                        s > i && r.SelfMul(S(i / s));
                    }
                }, n.prototype.SolveGravity = function(t) {
                    if (!this.m_velocityBuffer.data) throw new Error();
                    for (var e = n.SolveGravity_s_gravity, i = this.m_velocityBuffer.data, r = P.MulSV(t.dt * this.m_def.gravityScale, this.m_world.GetGravity(), e), s = 0; s < this.m_count; s++) i[s].SelfAdd(r);
                }, n.prototype.SolveBarrier = function(e) {
                    var i = n.SolveBarrier_s_aabb, r = n.SolveBarrier_s_va, s = n.SolveBarrier_s_vb, o = n.SolveBarrier_s_pba, a = n.SolveBarrier_s_vba, c = n.SolveBarrier_s_vc, l = n.SolveBarrier_s_pca, u = n.SolveBarrier_s_vca, h = n.SolveBarrier_s_qba, _ = n.SolveBarrier_s_qca, f = n.SolveBarrier_s_dv, d = n.SolveBarrier_s_f;
                    if (!this.m_flagsBuffer.data) throw new Error();
                    if (!this.m_positionBuffer.data) throw new Error();
                    if (!this.m_velocityBuffer.data) throw new Error();
                    for (var p = this.m_positionBuffer.data, m = this.m_velocityBuffer.data, v = 0; v < this.m_count; v++) 0 != (this.m_flagsBuffer.data[v] & n.k_barrierWallFlags) && m[v].SetZero();
                    for (var y = 2.5 * e.dt, g = this.GetParticleMass(), x = 0; x < this.m_pairBuffer.count; x++) {
                        var A = this.m_pairBuffer.data[x];
                        if (A.flags & t.b2ParticleFlag.b2_barrierParticle) {
                            var C = A.indexA, b = A.indexB, T = p[C], w = p[b], E = i;
                            P.MinV(T, w, E.lowerBound), P.MaxV(T, w, E.upperBound);
                            for (var B = this.m_groupBuffer[C], M = this.m_groupBuffer[b], R = this.GetLinearVelocity(B, C, T, r), I = this.GetLinearVelocity(M, b, w, s), D = P.SubVV(w, T, o), V = P.SubVV(I, R, a), L = this.GetInsideBoundsEnumerator(E), O = void 0; (O = L.GetNext()) >= 0; ) {
                                var F = p[O], N = this.m_groupBuffer[O];
                                if (B !== N && M !== N) {
                                    var G = this.GetLinearVelocity(N, O, F, c), k = P.SubVV(F, T, l), z = P.SubVV(G, R, u), U = P.CrossVV(V, z), H = P.CrossVV(D, z) - P.CrossVV(k, V), W = P.CrossVV(D, k), j = void 0, q = void 0, X = h, Y = _;
                                    if (0 === U) {
                                        if (0 === H) continue;
                                        if (!((q = -W / H) >= 0 && q < y)) continue;
                                        if (P.AddVMulSV(D, q, V, X), P.AddVMulSV(k, q, z, Y), !((j = P.DotVV(X, Y) / P.DotVV(X, X)) >= 0 && j <= 1)) continue;
                                    } else {
                                        var J = H * H - 4 * W * U;
                                        if (J < 0) continue;
                                        var Z = S(J), K = (-H - Z) / (2 * U), Q = (-H + Z) / (2 * U);
                                        if (K > Q) {
                                            var $ = K;
                                            K = Q, Q = $;
                                        }
                                        if (q = K, P.AddVMulSV(D, q, V, X), P.AddVMulSV(k, q, z, Y), j = P.DotVV(X, Y) / P.DotVV(X, X), 
                                        !(q >= 0 && q < y && j >= 0 && j <= 1)) {
                                            if (!((q = Q) >= 0 && q < y)) continue;
                                            if (P.AddVMulSV(D, q, V, X), P.AddVMulSV(k, q, z, Y), !((j = P.DotVV(X, Y) / P.DotVV(X, X)) >= 0 && j <= 1)) continue;
                                        }
                                    }
                                    var tt = f;
                                    tt.x = R.x + j * V.x - G.x, tt.y = R.y + j * V.y - G.y;
                                    var et = P.MulSV(g, tt, d);
                                    if (N && this.IsRigidGroup(N)) {
                                        var it = N.GetMass(), nt = N.GetInertia();
                                        it > 0 && N.m_linearVelocity.SelfMulAdd(1 / it, et), nt > 0 && (N.m_angularVelocity += P.CrossVV(P.SubVV(F, N.GetCenter(), P.s_t0), et) / nt);
                                    } else m[O].SelfAdd(tt);
                                    this.ParticleApplyForce(O, et.SelfMul(-e.inv_dt));
                                }
                            }
                        }
                    }
                }, n.prototype.SolveStaticPressure = function(e) {
                    if (!this.m_flagsBuffer.data) throw new Error();
                    this.m_staticPressureBuffer = this.RequestBuffer(this.m_staticPressureBuffer);
                    for (var i = this.GetCriticalPressure(e), n = this.m_def.staticPressureStrength * i, r = .25 * i, s = this.m_def.staticPressureRelaxation, o = 0; o < this.m_def.staticPressureIterations; o++) {
                        for (var a = 0; a < this.m_count; a++) this.m_accumulationBuffer[a] = 0;
                        for (var c = 0; c < this.m_contactBuffer.count; c++) {
                            var l = this.m_contactBuffer.data[c];
                            if (l.flags & t.b2ParticleFlag.b2_staticPressureParticle) {
                                var u = l.indexA, h = l.indexB, _ = l.weight;
                                this.m_accumulationBuffer[u] += _ * this.m_staticPressureBuffer[h], this.m_accumulationBuffer[h] += _ * this.m_staticPressureBuffer[u];
                            }
                        }
                        for (a = 0; a < this.m_count; a++) if (_ = this.m_weightBuffer[a], this.m_flagsBuffer.data[a] & t.b2ParticleFlag.b2_staticPressureParticle) {
                            var f = (this.m_accumulationBuffer[a] + n * (_ - 1)) / (_ + s);
                            this.m_staticPressureBuffer[a] = g(f, 0, r);
                        } else this.m_staticPressureBuffer[a] = 0;
                    }
                }, n.prototype.ComputeWeight = function() {
                    for (var t = 0; t < this.m_count; t++) this.m_weightBuffer[t] = 0;
                    for (t = 0; t < this.m_bodyContactBuffer.count; t++) {
                        var e = (n = this.m_bodyContactBuffer.data[t]).index, i = n.weight;
                        this.m_weightBuffer[e] += i;
                    }
                    for (t = 0; t < this.m_contactBuffer.count; t++) {
                        e = (n = this.m_contactBuffer.data[t]).indexA;
                        var n, r = n.indexB;
                        i = n.weight, this.m_weightBuffer[e] += i, this.m_weightBuffer[r] += i;
                    }
                }, n.prototype.SolvePressure = function(e) {
                    var i = n.SolvePressure_s_f;
                    if (!this.m_flagsBuffer.data) throw new Error();
                    if (!this.m_positionBuffer.data) throw new Error();
                    if (!this.m_velocityBuffer.data) throw new Error();
                    for (var r = this.m_positionBuffer.data, s = this.m_velocityBuffer.data, o = this.GetCriticalPressure(e), a = this.m_def.pressureStrength * o, c = .25 * o, l = 0; l < this.m_count; l++) {
                        var u = this.m_weightBuffer[l], h = a * y(0, u - 1);
                        this.m_accumulationBuffer[l] = v(h, c);
                    }
                    if (this.m_allParticleFlags & n.k_noPressureFlags) for (l = 0; l < this.m_count; l++) this.m_flagsBuffer.data[l] & n.k_noPressureFlags && (this.m_accumulationBuffer[l] = 0);
                    if (this.m_allParticleFlags & t.b2ParticleFlag.b2_staticPressureParticle) for (l = 0; l < this.m_count; l++) this.m_flagsBuffer.data[l] & t.b2ParticleFlag.b2_staticPressureParticle && (this.m_accumulationBuffer[l] += this.m_staticPressureBuffer[l]);
                    for (var _ = e.dt / (this.m_def.density * this.m_particleDiameter), f = this.GetParticleInvMass(), d = 0; d < this.m_bodyContactBuffer.count; d++) {
                        var p = (b = this.m_bodyContactBuffer.data[d]).index, m = b.body, g = (u = b.weight, 
                        b.mass), x = b.normal, A = r[p], C = (h = this.m_accumulationBuffer[p] + a * u, 
                        P.MulSV(_ * u * g * h, x, i));
                        s[p].SelfMulSub(f, C), m.ApplyLinearImpulse(C, A, !0);
                    }
                    for (d = 0; d < this.m_contactBuffer.count; d++) {
                        var b;
                        p = (b = this.m_contactBuffer.data[d]).indexA, m = b.indexB, u = b.weight, x = b.normal, 
                        h = this.m_accumulationBuffer[p] + this.m_accumulationBuffer[m], C = P.MulSV(_ * u * h, x, i), 
                        s[p].SelfSub(C), s[m].SelfAdd(C);
                    }
                }, n.prototype.SolveDamping = function(t) {
                    var e = n.SolveDamping_s_v, i = n.SolveDamping_s_f;
                    if (!this.m_positionBuffer.data) throw new Error();
                    if (!this.m_velocityBuffer.data) throw new Error();
                    for (var r = this.m_positionBuffer.data, s = this.m_velocityBuffer.data, o = this.m_def.dampingStrength, a = 1 / this.GetCriticalVelocity(t), c = this.GetParticleInvMass(), l = 0; l < this.m_bodyContactBuffer.count; l++) {
                        var u = (A = this.m_bodyContactBuffer.data[l]).index, h = A.body, _ = A.weight, f = A.mass, d = A.normal, p = r[u], m = P.SubVV(h.GetLinearVelocityFromWorldPoint(p, P.s_t0), s[u], e);
                        if ((C = P.DotVV(m, d)) < 0) {
                            var g = y(o * _, v(-a * C, .5)), x = P.MulSV(g * f * C, d, i);
                            s[u].SelfMulAdd(c, x), h.ApplyLinearImpulse(x.SelfNeg(), p, !0);
                        }
                    }
                    for (l = 0; l < this.m_contactBuffer.count; l++) {
                        var A, C;
                        u = (A = this.m_contactBuffer.data[l]).indexA, h = A.indexB, _ = A.weight, d = A.normal, 
                        m = P.SubVV(s[h], s[u], e), (C = P.DotVV(m, d)) < 0 && (g = y(o * _, v(-a * C, .5)), 
                        x = P.MulSV(g * C, d, i), s[u].SelfAdd(x), s[h].SelfSub(x));
                    }
                }, n.prototype.SolveRigidDamping = function() {
                    var t = n.SolveRigidDamping_s_t0, e = n.SolveRigidDamping_s_t1, i = n.SolveRigidDamping_s_p, r = n.SolveRigidDamping_s_v, s = [ 0 ], o = [ 0 ], a = [ 0 ], c = [ 0 ], l = [ 0 ], u = [ 0 ];
                    if (!this.m_positionBuffer.data) throw new Error();
                    for (var h = this.m_positionBuffer.data, _ = this.m_def.dampingStrength, f = 0; f < this.m_bodyContactBuffer.count; f++) {
                        var d = (C = this.m_bodyContactBuffer.data[f]).index;
                        if ((S = this.m_groupBuffer[d]) && this.IsRigidGroup(S)) {
                            var p = C.body, m = C.normal, y = C.weight, g = h[d], x = P.SubVV(p.GetLinearVelocityFromWorldPoint(g, t), S.GetLinearVelocityFromWorldPoint(g, e), r);
                            if ((b = P.DotVV(x, m)) < 0) {
                                this.InitDampingParameterWithRigidGroupOrParticle(s, o, a, !0, S, d, g, m), this.InitDampingParameter(c, l, u, p.GetMass(), p.GetInertia() - p.GetMass() * p.GetLocalCenter().LengthSquared(), p.GetWorldCenter(), g, m);
                                var A = _ * v(y, 1) * this.ComputeDampingImpulse(s[0], o[0], a[0], c[0], l[0], u[0], b);
                                this.ApplyDamping(s[0], o[0], a[0], !0, S, d, A, m), p.ApplyLinearImpulse(P.MulSV(-A, m, P.s_t0), g, !0);
                            }
                        }
                    }
                    for (f = 0; f < this.m_contactBuffer.count; f++) {
                        d = (C = this.m_contactBuffer.data[f]).indexA, p = C.indexB, m = C.normal, y = C.weight;
                        var C, b, S = this.m_groupBuffer[d], T = this.m_groupBuffer[p], w = this.IsRigidGroup(S), E = this.IsRigidGroup(T);
                        S !== T && (w || E) && (g = P.MidVV(h[d], h[p], i), x = P.SubVV(this.GetLinearVelocity(T, p, g, t), this.GetLinearVelocity(S, d, g, e), r), 
                        (b = P.DotVV(x, m)) < 0 && (this.InitDampingParameterWithRigidGroupOrParticle(s, o, a, w, S, d, g, m), 
                        this.InitDampingParameterWithRigidGroupOrParticle(c, l, u, E, T, p, g, m), A = _ * y * this.ComputeDampingImpulse(s[0], o[0], a[0], c[0], l[0], u[0], b), 
                        this.ApplyDamping(s[0], o[0], a[0], w, S, d, A, m), this.ApplyDamping(c[0], l[0], u[0], E, T, p, -A, m)));
                    }
                }, n.prototype.SolveExtraDamping = function() {
                    var t = n.SolveExtraDamping_s_v, e = n.SolveExtraDamping_s_f;
                    if (!this.m_flagsBuffer.data) throw new Error();
                    if (!this.m_positionBuffer.data) throw new Error();
                    if (!this.m_velocityBuffer.data) throw new Error();
                    for (var i = this.m_velocityBuffer.data, r = this.m_positionBuffer.data, s = this.GetParticleInvMass(), o = 0; o < this.m_bodyContactBuffer.count; o++) {
                        var a = this.m_bodyContactBuffer.data[o], c = a.index;
                        if (this.m_flagsBuffer.data[c] & n.k_extraDampingFlags) {
                            var l = a.body, u = a.mass, h = a.normal, _ = r[c], f = P.SubVV(l.GetLinearVelocityFromWorldPoint(_, P.s_t0), i[c], t), d = P.DotVV(f, h);
                            if (d < 0) {
                                var p = P.MulSV(.5 * u * d, h, e);
                                i[c].SelfMulAdd(s, p), l.ApplyLinearImpulse(p.SelfNeg(), _, !0);
                            }
                        }
                    }
                }, n.prototype.SolveWall = function() {
                    if (!this.m_flagsBuffer.data) throw new Error();
                    if (!this.m_velocityBuffer.data) throw new Error();
                    for (var e = this.m_velocityBuffer.data, i = 0; i < this.m_count; i++) this.m_flagsBuffer.data[i] & t.b2ParticleFlag.b2_wallParticle && e[i].SetZero();
                }, n.prototype.SolveRigid = function(e) {
                    var i = n.SolveRigid_s_position, r = n.SolveRigid_s_rotation, s = n.SolveRigid_s_transform, o = n.SolveRigid_s_velocityTransform;
                    if (!this.m_positionBuffer.data) throw new Error();
                    if (!this.m_velocityBuffer.data) throw new Error();
                    for (var a = this.m_positionBuffer.data, c = this.m_velocityBuffer.data, l = this.m_groupList; l; l = l.GetNext()) if (l.m_groupFlags & t.b2ParticleGroupFlag.b2_rigidParticleGroup) {
                        l.UpdateStatistics();
                        var u = r;
                        u.SetAngle(e.dt * l.m_angularVelocity);
                        var h = P.AddVV(l.m_center, P.SubVV(P.MulSV(e.dt, l.m_linearVelocity, P.s_t0), O.MulRV(u, l.m_center, P.s_t1), P.s_t0), i), _ = s;
                        _.SetPositionRotation(h, u), F.MulXX(_, l.m_transform, l.m_transform);
                        var f = o;
                        f.p.x = e.inv_dt * _.p.x, f.p.y = e.inv_dt * _.p.y, f.q.s = e.inv_dt * _.q.s, f.q.c = e.inv_dt * (_.q.c - 1);
                        for (var d = l.m_firstIndex; d < l.m_lastIndex; d++) F.MulXV(f, a[d], c[d]);
                    }
                }, n.prototype.SolveElastic = function(e) {
                    var i = n.SolveElastic_s_pa, r = n.SolveElastic_s_pb, s = n.SolveElastic_s_pc, o = n.SolveElastic_s_r, a = n.SolveElastic_s_t0;
                    if (!this.m_positionBuffer.data) throw new Error();
                    if (!this.m_velocityBuffer.data) throw new Error();
                    for (var c = this.m_positionBuffer.data, l = this.m_velocityBuffer.data, u = e.inv_dt * this.m_def.elasticStrength, h = 0; h < this.m_triadBuffer.count; h++) {
                        var _ = this.m_triadBuffer.data[h];
                        if (_.flags & t.b2ParticleFlag.b2_elasticParticle) {
                            var f = _.indexA, d = _.indexB, p = _.indexC, m = _.pa, v = _.pb, y = _.pc, g = i.Copy(c[f]), x = r.Copy(c[d]), A = s.Copy(c[p]), b = l[f], S = l[d], T = l[p];
                            g.SelfMulAdd(e.dt, b), x.SelfMulAdd(e.dt, S), A.SelfMulAdd(e.dt, T);
                            var w = (g.x + x.x + A.x) / 3, E = (g.y + x.y + A.y) / 3;
                            g.x -= w, g.y -= E, x.x -= w, x.y -= E, A.x -= w, A.y -= E;
                            var B = o;
                            B.s = P.CrossVV(m, g) + P.CrossVV(v, x) + P.CrossVV(y, A), B.c = P.DotVV(m, g) + P.DotVV(v, x) + P.DotVV(y, A);
                            var M = C(B.s * B.s + B.c * B.c);
                            isFinite(M) || (M = 198177537e11), B.s *= M, B.c *= M;
                            var R = u * _.strength;
                            O.MulRV(B, m, a), P.SubVV(a, g, a), P.MulSV(R, a, a), b.SelfAdd(a), O.MulRV(B, v, a), 
                            P.SubVV(a, x, a), P.MulSV(R, a, a), S.SelfAdd(a), O.MulRV(B, y, a), P.SubVV(a, A, a), 
                            P.MulSV(R, a, a), T.SelfAdd(a);
                        }
                    }
                }, n.prototype.SolveSpring = function(e) {
                    var i = n.SolveSpring_s_pa, r = n.SolveSpring_s_pb, s = n.SolveSpring_s_d, o = n.SolveSpring_s_f;
                    if (!this.m_positionBuffer.data) throw new Error();
                    if (!this.m_velocityBuffer.data) throw new Error();
                    for (var a = this.m_positionBuffer.data, c = this.m_velocityBuffer.data, l = e.inv_dt * this.m_def.springStrength, u = 0; u < this.m_pairBuffer.count; u++) {
                        var h = this.m_pairBuffer.data[u];
                        if (h.flags & t.b2ParticleFlag.b2_springParticle) {
                            var _ = h.indexA, f = h.indexB, d = i.Copy(a[_]), p = r.Copy(a[f]), m = c[_], v = c[f];
                            d.SelfMulAdd(e.dt, m), p.SelfMulAdd(e.dt, v);
                            var y = P.SubVV(p, d, s), g = h.distance, x = y.Length(), A = l * h.strength, C = P.MulSV(A * (g - x) / x, y, o);
                            m.SelfSub(C), v.SelfAdd(C);
                        }
                    }
                }, n.prototype.SolveTensile = function(e) {
                    var i = n.SolveTensile_s_weightedNormal, r = n.SolveTensile_s_s, s = n.SolveTensile_s_f;
                    if (!this.m_velocityBuffer.data) throw new Error();
                    for (var o = this.m_velocityBuffer.data, a = 0; a < this.m_count; a++) this.m_accumulation2Buffer[a] = new P(), 
                    this.m_accumulation2Buffer[a].SetZero();
                    for (var c = 0; c < this.m_contactBuffer.count; c++) if ((g = this.m_contactBuffer.data[c]).flags & t.b2ParticleFlag.b2_tensileParticle) {
                        var l = g.indexA, u = g.indexB, h = g.weight, _ = g.normal, f = P.MulSV((1 - h) * h, _, i);
                        this.m_accumulation2Buffer[l].SelfSub(f), this.m_accumulation2Buffer[u].SelfAdd(f);
                    }
                    var d = this.GetCriticalVelocity(e), p = this.m_def.surfaceTensionPressureStrength * d, m = this.m_def.surfaceTensionNormalStrength * d, y = .5 * d;
                    for (c = 0; c < this.m_contactBuffer.count; c++) {
                        var g;
                        if ((g = this.m_contactBuffer.data[c]).flags & t.b2ParticleFlag.b2_tensileParticle) {
                            l = g.indexA, u = g.indexB, h = g.weight, _ = g.normal;
                            var x = this.m_weightBuffer[l] + this.m_weightBuffer[u], A = P.SubVV(this.m_accumulation2Buffer[u], this.m_accumulation2Buffer[l], r), C = v(p * (x - 2) + m * P.DotVV(A, _), y) * h, b = P.MulSV(C, _, s);
                            o[l].SelfSub(b), o[u].SelfAdd(b);
                        }
                    }
                }, n.prototype.SolveViscous = function() {
                    var e = n.SolveViscous_s_v, i = n.SolveViscous_s_f;
                    if (!this.m_flagsBuffer.data) throw new Error();
                    if (!this.m_positionBuffer.data) throw new Error();
                    if (!this.m_velocityBuffer.data) throw new Error();
                    for (var r = this.m_positionBuffer.data, s = this.m_velocityBuffer.data, o = this.m_def.viscousStrength, a = this.GetParticleInvMass(), c = 0; c < this.m_bodyContactBuffer.count; c++) {
                        var l = (m = this.m_bodyContactBuffer.data[c]).index;
                        if (this.m_flagsBuffer.data[l] & t.b2ParticleFlag.b2_viscousParticle) {
                            var u = m.body, h = m.weight, _ = m.mass, f = r[l], d = P.SubVV(u.GetLinearVelocityFromWorldPoint(f, P.s_t0), s[l], e), p = P.MulSV(o * _ * h, d, i);
                            s[l].SelfMulAdd(a, p), u.ApplyLinearImpulse(p.SelfNeg(), f, !0);
                        }
                    }
                    for (c = 0; c < this.m_contactBuffer.count; c++) {
                        var m;
                        (m = this.m_contactBuffer.data[c]).flags & t.b2ParticleFlag.b2_viscousParticle && (l = m.indexA, 
                        u = m.indexB, h = m.weight, d = P.SubVV(s[u], s[l], e), p = P.MulSV(o * h, d, i), 
                        s[l].SelfAdd(p), s[u].SelfSub(p));
                    }
                }, n.prototype.SolveRepulsive = function(e) {
                    var i = n.SolveRepulsive_s_f;
                    if (!this.m_velocityBuffer.data) throw new Error();
                    for (var r = this.m_velocityBuffer.data, s = this.m_def.repulsiveStrength * this.GetCriticalVelocity(e), o = 0; o < this.m_contactBuffer.count; o++) {
                        var a = this.m_contactBuffer.data[o];
                        if (a.flags & t.b2ParticleFlag.b2_repulsiveParticle) {
                            var c = a.indexA, l = a.indexB;
                            if (this.m_groupBuffer[c] !== this.m_groupBuffer[l]) {
                                var u = a.weight, h = a.normal, _ = P.MulSV(s * u, h, i);
                                r[c].SelfSub(_), r[l].SelfAdd(_);
                            }
                        }
                    }
                }, n.prototype.SolvePowder = function(e) {
                    var i = n.SolvePowder_s_f;
                    if (!this.m_flagsBuffer.data) throw new Error();
                    if (!this.m_positionBuffer.data) throw new Error();
                    if (!this.m_velocityBuffer.data) throw new Error();
                    for (var r = this.m_positionBuffer.data, s = this.m_velocityBuffer.data, o = this.m_def.powderStrength * this.GetCriticalVelocity(e), a = this.GetParticleInvMass(), c = 0; c < this.m_bodyContactBuffer.count; c++) {
                        var l = (p = this.m_bodyContactBuffer.data[c]).index;
                        if (this.m_flagsBuffer.data[l] & t.b2ParticleFlag.b2_powderParticle && (m = p.weight) > .25) {
                            var u = p.body, h = p.mass, _ = r[l], f = p.normal, d = P.MulSV(o * h * (m - .25), f, i);
                            s[l].SelfMulSub(a, d), u.ApplyLinearImpulse(d, _, !0);
                        }
                    }
                    for (c = 0; c < this.m_contactBuffer.count; c++) {
                        var p, m;
                        (p = this.m_contactBuffer.data[c]).flags & t.b2ParticleFlag.b2_powderParticle && (m = p.weight) > .25 && (l = p.indexA, 
                        u = p.indexB, f = p.normal, d = P.MulSV(o * (m - .25), f, i), s[l].SelfSub(d), s[u].SelfAdd(d));
                    }
                }, n.prototype.SolveSolid = function(t) {
                    var e = n.SolveSolid_s_f;
                    if (!this.m_velocityBuffer.data) throw new Error();
                    var i = this.m_velocityBuffer.data;
                    this.m_depthBuffer = this.RequestBuffer(this.m_depthBuffer);
                    for (var r = t.inv_dt * this.m_def.ejectionStrength, s = 0; s < this.m_contactBuffer.count; s++) {
                        var o = this.m_contactBuffer.data[s], a = o.indexA, c = o.indexB;
                        if (this.m_groupBuffer[a] !== this.m_groupBuffer[c]) {
                            var l = o.weight, u = o.normal, h = this.m_depthBuffer[a] + this.m_depthBuffer[c], _ = P.MulSV(r * h * l, u, e);
                            i[a].SelfSub(_), i[c].SelfAdd(_);
                        }
                    }
                }, n.prototype.SolveForce = function(t) {
                    if (!this.m_velocityBuffer.data) throw new Error();
                    for (var e = this.m_velocityBuffer.data, i = t.dt * this.GetParticleInvMass(), n = 0; n < this.m_count; n++) e[n].SelfMulAdd(i, this.m_forceBuffer[n]);
                    this.m_hasForce = !1;
                }, n.prototype.SolveColorMixing = function() {
                    if (!this.m_flagsBuffer.data) throw new Error();
                    if (!this.m_colorBuffer.data) throw new Error();
                    var e = .5 * this.m_def.colorMixingStrength;
                    if (e) for (var i = 0; i < this.m_contactBuffer.count; i++) {
                        var n = this.m_contactBuffer.data[i], r = n.indexA, s = n.indexB;
                        if (this.m_flagsBuffer.data[r] & this.m_flagsBuffer.data[s] & t.b2ParticleFlag.b2_colorMixingParticle) {
                            var o = this.m_colorBuffer.data[r], a = this.m_colorBuffer.data[s];
                            G.MixColors(o, a, e);
                        }
                    }
                }, n.prototype.SolveZombie = function() {
                    if (!this.m_flagsBuffer.data) throw new Error();
                    if (!this.m_positionBuffer.data) throw new Error();
                    if (!this.m_velocityBuffer.data) throw new Error();
                    for (var e = 0, i = [], n = 0; n < this.m_count; n++) i[n] = h;
                    var r = 0;
                    for (n = 0; n < this.m_count; n++) {
                        var s = this.m_flagsBuffer.data[n];
                        if (s & t.b2ParticleFlag.b2_zombieParticle) {
                            var o = this.m_world.m_destructionListener;
                            s & t.b2ParticleFlag.b2_destructionListenerParticle && o && o.SayGoodbyeParticle(this, n), 
                            this.m_handleIndexBuffer.data && (a = this.m_handleIndexBuffer.data[n]) && (a.SetIndex(h), 
                            this.m_handleIndexBuffer.data[n] = null), i[n] = h;
                        } else {
                            var a;
                            i[n] = e, n !== e && (this.m_handleIndexBuffer.data && ((a = this.m_handleIndexBuffer.data[n]) && a.SetIndex(e), 
                            this.m_handleIndexBuffer.data[e] = a), this.m_flagsBuffer.data[e] = this.m_flagsBuffer.data[n], 
                            this.m_lastBodyContactStepBuffer.data && (this.m_lastBodyContactStepBuffer.data[e] = this.m_lastBodyContactStepBuffer.data[n]), 
                            this.m_bodyContactCountBuffer.data && (this.m_bodyContactCountBuffer.data[e] = this.m_bodyContactCountBuffer.data[n]), 
                            this.m_consecutiveContactStepsBuffer.data && (this.m_consecutiveContactStepsBuffer.data[e] = this.m_consecutiveContactStepsBuffer.data[n]), 
                            this.m_positionBuffer.data[e].Copy(this.m_positionBuffer.data[n]), this.m_velocityBuffer.data[e].Copy(this.m_velocityBuffer.data[n]), 
                            this.m_groupBuffer[e] = this.m_groupBuffer[n], this.m_hasForce && this.m_forceBuffer[e].Copy(this.m_forceBuffer[n]), 
                            this.m_staticPressureBuffer && (this.m_staticPressureBuffer[e] = this.m_staticPressureBuffer[n]), 
                            this.m_depthBuffer && (this.m_depthBuffer[e] = this.m_depthBuffer[n]), this.m_colorBuffer.data && this.m_colorBuffer.data[e].Copy(this.m_colorBuffer.data[n]), 
                            this.m_userDataBuffer.data && (this.m_userDataBuffer.data[e] = this.m_userDataBuffer.data[n]), 
                            this.m_expirationTimeBuffer.data && (this.m_expirationTimeBuffer.data[e] = this.m_expirationTimeBuffer.data[n])), 
                            e++, r |= s;
                        }
                    }
                    for (var c = 0; c < this.m_proxyBuffer.count; c++) {
                        var l = this.m_proxyBuffer.data[c];
                        l.index = i[l.index];
                    }
                    for (this.m_proxyBuffer.RemoveIf(function(t) {
                        return t.index < 0;
                    }), c = 0; c < this.m_contactBuffer.count; c++) (u = this.m_contactBuffer.data[c]).indexA = i[u.indexA], 
                    u.indexB = i[u.indexB];
                    for (this.m_contactBuffer.RemoveIf(function(t) {
                        return t.indexA < 0 || t.indexB < 0;
                    }), c = 0; c < this.m_bodyContactBuffer.count; c++) {
                        var u;
                        (u = this.m_bodyContactBuffer.data[c]).index = i[u.index];
                    }
                    for (this.m_bodyContactBuffer.RemoveIf(function(t) {
                        return t.index < 0;
                    }), c = 0; c < this.m_pairBuffer.count; c++) {
                        var _ = this.m_pairBuffer.data[c];
                        _.indexA = i[_.indexA], _.indexB = i[_.indexB];
                    }
                    for (this.m_pairBuffer.RemoveIf(function(t) {
                        return t.indexA < 0 || t.indexB < 0;
                    }), c = 0; c < this.m_triadBuffer.count; c++) {
                        var f = this.m_triadBuffer.data[c];
                        f.indexA = i[f.indexA], f.indexB = i[f.indexB], f.indexC = i[f.indexC];
                    }
                    if (this.m_triadBuffer.RemoveIf(function(t) {
                        return t.indexA < 0 || t.indexB < 0 || t.indexC < 0;
                    }), this.m_indexByExpirationTimeBuffer.data) for (var d = 0, p = 0; p < this.m_count; p++) {
                        var m = i[this.m_indexByExpirationTimeBuffer.data[p]];
                        m !== h && (this.m_indexByExpirationTimeBuffer.data[d++] = m);
                    }
                    for (var g = this.m_groupList; g; g = g.GetNext()) {
                        var x = e, A = 0, C = !1;
                        for (n = g.m_firstIndex; n < g.m_lastIndex; n++) {
                            var b = i[n];
                            b >= 0 ? (x = v(x, b), A = y(A, b + 1)) : C = !0;
                        }
                        x < A ? (g.m_firstIndex = x, g.m_lastIndex = A, C && g.m_groupFlags & t.b2ParticleGroupFlag.b2_solidParticleGroup && this.SetGroupFlags(g, g.m_groupFlags | t.b2ParticleGroupFlag.b2_particleGroupNeedsUpdateDepth)) : (g.m_firstIndex = 0, 
                        g.m_lastIndex = 0, g.m_groupFlags & t.b2ParticleGroupFlag.b2_particleGroupCanBeEmpty || this.SetGroupFlags(g, g.m_groupFlags | t.b2ParticleGroupFlag.b2_particleGroupWillBeDestroyed));
                    }
                    for (this.m_count = e, this.m_allParticleFlags = r, this.m_needsUpdateAllParticleFlags = !1, 
                    g = this.m_groupList; g; ) {
                        var S = g.GetNext();
                        g.m_groupFlags & t.b2ParticleGroupFlag.b2_particleGroupWillBeDestroyed && this.DestroyParticleGroup(g), 
                        g = S;
                    }
                }, n.prototype.SolveLifetimes = function(t) {
                    if (!this.m_expirationTimeBuffer.data) throw new Error();
                    if (!this.m_indexByExpirationTimeBuffer.data) throw new Error();
                    this.m_timeElapsed = this.LifetimeToExpirationTime(t.dt);
                    var e = this.GetQuantizedTimeElapsed(), i = this.m_expirationTimeBuffer.data, n = this.m_indexByExpirationTimeBuffer.data, r = this.GetParticleCount();
                    this.m_expirationTimeBufferRequiresSorting && (Pn(n, 0, r, function(t, e) {
                        var n = i[t], r = i[e], s = n <= 0;
                        return s === r <= 0 ? n > r : s;
                    }), this.m_expirationTimeBufferRequiresSorting = !1);
                    for (var s = r - 1; s >= 0; --s) {
                        var o = n[s], a = i[o];
                        if (e < a || a <= 0) break;
                        this.DestroyParticle(o);
                    }
                }, n.prototype.RotateBuffer = function(t, e, i) {
                    if (t !== e && e !== i) {
                        if (!this.m_flagsBuffer.data) throw new Error();
                        if (!this.m_positionBuffer.data) throw new Error();
                        if (!this.m_velocityBuffer.data) throw new Error();
                        if (On(this.m_flagsBuffer.data, t, e, i), this.m_lastBodyContactStepBuffer.data && On(this.m_lastBodyContactStepBuffer.data, t, e, i), 
                        this.m_bodyContactCountBuffer.data && On(this.m_bodyContactCountBuffer.data, t, e, i), 
                        this.m_consecutiveContactStepsBuffer.data && On(this.m_consecutiveContactStepsBuffer.data, t, e, i), 
                        On(this.m_positionBuffer.data, t, e, i), On(this.m_velocityBuffer.data, t, e, i), 
                        On(this.m_groupBuffer, t, e, i), this.m_hasForce && On(this.m_forceBuffer, t, e, i), 
                        this.m_staticPressureBuffer && On(this.m_staticPressureBuffer, t, e, i), this.m_depthBuffer && On(this.m_depthBuffer, t, e, i), 
                        this.m_colorBuffer.data && On(this.m_colorBuffer.data, t, e, i), this.m_userDataBuffer.data && On(this.m_userDataBuffer.data, t, e, i), 
                        this.m_handleIndexBuffer.data) {
                            On(this.m_handleIndexBuffer.data, t, e, i);
                            for (var n = t; n < i; ++n) {
                                var r = this.m_handleIndexBuffer.data[n];
                                r && r.SetIndex(f(r.GetIndex()));
                            }
                        }
                        if (this.m_expirationTimeBuffer.data) {
                            On(this.m_expirationTimeBuffer.data, t, e, i);
                            var s = this.GetParticleCount();
                            if (!this.m_indexByExpirationTimeBuffer.data) throw new Error();
                            var o = this.m_indexByExpirationTimeBuffer.data;
                            for (n = 0; n < s; ++n) o[n] = f(o[n]);
                        }
                        for (var a = 0; a < this.m_proxyBuffer.count; a++) {
                            var c = this.m_proxyBuffer.data[a];
                            c.index = f(c.index);
                        }
                        for (a = 0; a < this.m_contactBuffer.count; a++) (l = this.m_contactBuffer.data[a]).indexA = f(l.indexA), 
                        l.indexB = f(l.indexB);
                        for (a = 0; a < this.m_bodyContactBuffer.count; a++) {
                            var l;
                            (l = this.m_bodyContactBuffer.data[a]).index = f(l.index);
                        }
                        for (a = 0; a < this.m_pairBuffer.count; a++) {
                            var u = this.m_pairBuffer.data[a];
                            u.indexA = f(u.indexA), u.indexB = f(u.indexB);
                        }
                        for (a = 0; a < this.m_triadBuffer.count; a++) {
                            var h = this.m_triadBuffer.data[a];
                            h.indexA = f(h.indexA), h.indexB = f(h.indexB), h.indexC = f(h.indexC);
                        }
                        for (var _ = this.m_groupList; _; _ = _.GetNext()) _.m_firstIndex = f(_.m_firstIndex), 
                        _.m_lastIndex = f(_.m_lastIndex - 1) + 1;
                    }
                    function f(n) {
                        return n < t ? n : n < e ? n + i - e : n < i ? n + t - e : n;
                    }
                }, n.prototype.GetCriticalVelocity = function(t) {
                    return this.m_particleDiameter * t.inv_dt;
                }, n.prototype.GetCriticalVelocitySquared = function(t) {
                    var e = this.GetCriticalVelocity(t);
                    return e * e;
                }, n.prototype.GetCriticalPressure = function(t) {
                    return this.m_def.density * this.GetCriticalVelocitySquared(t);
                }, n.prototype.GetParticleStride = function() {
                    return .75 * this.m_particleDiameter;
                }, n.prototype.GetParticleMass = function() {
                    var t = this.GetParticleStride();
                    return this.m_def.density * t * t;
                }, n.prototype.GetParticleInvMass = function() {
                    var t = this.m_inverseDiameter * (1 / .75);
                    return this.m_inverseDensity * t * t;
                }, n.prototype.GetFixtureContactFilter = function() {
                    return this.m_allParticleFlags & t.b2ParticleFlag.b2_fixtureContactFilterParticle ? this.m_world.m_contactManager.m_contactFilter : null;
                }, n.prototype.GetParticleContactFilter = function() {
                    return this.m_allParticleFlags & t.b2ParticleFlag.b2_particleContactFilterParticle ? this.m_world.m_contactManager.m_contactFilter : null;
                }, n.prototype.GetFixtureContactListener = function() {
                    return this.m_allParticleFlags & t.b2ParticleFlag.b2_fixtureContactListenerParticle ? this.m_world.m_contactManager.m_contactListener : null;
                }, n.prototype.GetParticleContactListener = function() {
                    return this.m_allParticleFlags & t.b2ParticleFlag.b2_particleContactListenerParticle ? this.m_world.m_contactManager.m_contactListener : null;
                }, n.prototype.SetUserOverridableBuffer = function(t, e, i) {
                    t.data = e, t.userSuppliedCapacity = i;
                }, n.prototype.SetGroupFlags = function(e, i) {
                    var n = e.m_groupFlags;
                    (n ^ i) & t.b2ParticleGroupFlag.b2_solidParticleGroup && (i |= t.b2ParticleGroupFlag.b2_particleGroupNeedsUpdateDepth), 
                    n & ~i && (this.m_needsUpdateAllGroupFlags = !0), ~this.m_allGroupFlags & i && (i & t.b2ParticleGroupFlag.b2_solidParticleGroup && (this.m_depthBuffer = this.RequestBuffer(this.m_depthBuffer)), 
                    this.m_allGroupFlags |= i), e.m_groupFlags = i;
                }, n.BodyContactCompare = function(t, e) {
                    return t.index === e.index ? t.weight > e.weight : t.index < e.index;
                }, n.prototype.RemoveSpuriousBodyContacts = function() {
                    Pn(this.m_bodyContactBuffer.data, 0, this.m_bodyContactBuffer.count, n.BodyContactCompare);
                    var t = n.RemoveSpuriousBodyContacts_s_n, e = n.RemoveSpuriousBodyContacts_s_pos, i = n.RemoveSpuriousBodyContacts_s_normal, r = this, s = -1, o = 0;
                    this.m_bodyContactBuffer.count = Dn(this.m_bodyContactBuffer.data, function(n) {
                        if (n.index !== s && (o = 0, s = n.index), o++ > 3) return !0;
                        var a = t.Copy(n.normal);
                        if (a.SelfMul(r.m_particleDiameter * (1 - n.weight)), !r.m_positionBuffer.data) throw new Error();
                        var l = P.AddVV(r.m_positionBuffer.data[n.index], a, e);
                        if (!n.fixture.TestPoint(l)) {
                            for (var u = n.fixture.GetShape().GetChildCount(), h = 0; h < u; h++) {
                                var _ = i;
                                if (n.fixture.ComputeDistance(l, _, h) < c) return !1;
                            }
                            return !0;
                        }
                        return !1;
                    }, this.m_bodyContactBuffer.count);
                }, n.prototype.DetectStuckParticle = function(t) {
                    if (!(this.m_stuckThreshold <= 0)) {
                        if (!this.m_bodyContactCountBuffer.data) throw new Error();
                        if (!this.m_consecutiveContactStepsBuffer.data) throw new Error();
                        if (!this.m_lastBodyContactStepBuffer.data) throw new Error();
                        ++this.m_bodyContactCountBuffer.data[t], 2 === this.m_bodyContactCountBuffer.data[t] && (++this.m_consecutiveContactStepsBuffer.data[t], 
                        this.m_consecutiveContactStepsBuffer.data[t] > this.m_stuckThreshold && (this.m_stuckParticleBuffer.data[this.m_stuckParticleBuffer.Append()] = t)), 
                        this.m_lastBodyContactStepBuffer.data[t] = this.m_timestamp;
                    }
                }, n.prototype.ValidateParticleIndex = function(t) {
                    return t >= 0 && t < this.GetParticleCount() && t !== h;
                }, n.prototype.GetQuantizedTimeElapsed = function() {
                    return Math.floor(this.m_timeElapsed / 4294967296);
                }, n.prototype.LifetimeToExpirationTime = function(t) {
                    return this.m_timeElapsed + Math.floor(t / this.m_def.lifetimeGranularity * 4294967296);
                }, n.prototype.ForceCanBeApplied = function(e) {
                    return !(e & t.b2ParticleFlag.b2_wallParticle);
                }, n.prototype.PrepareForceBuffer = function() {
                    if (!this.m_hasForce) {
                        for (var t = 0; t < this.m_count; t++) this.m_forceBuffer[t].SetZero();
                        this.m_hasForce = !0;
                    }
                }, n.prototype.IsRigidGroup = function(e) {
                    return null !== e && 0 != (e.m_groupFlags & t.b2ParticleGroupFlag.b2_rigidParticleGroup);
                }, n.prototype.GetLinearVelocity = function(t, e, i, n) {
                    if (t && this.IsRigidGroup(t)) return t.GetLinearVelocityFromWorldPoint(i, n);
                    if (!this.m_velocityBuffer.data) throw new Error();
                    return n.Copy(this.m_velocityBuffer.data[e]);
                }, n.prototype.InitDampingParameter = function(t, e, i, n, r, s, o, a) {
                    t[0] = n > 0 ? 1 / n : 0, e[0] = r > 0 ? 1 / r : 0, i[0] = P.CrossVV(P.SubVV(o, s, P.s_t0), a);
                }, n.prototype.InitDampingParameterWithRigidGroupOrParticle = function(e, i, n, r, s, o, a, c) {
                    if (s && r) this.InitDampingParameter(e, i, n, s.GetMass(), s.GetInertia(), s.GetCenter(), a, c); else {
                        if (!this.m_flagsBuffer.data) throw new Error();
                        var l = this.m_flagsBuffer.data[o];
                        this.InitDampingParameter(e, i, n, l & t.b2ParticleFlag.b2_wallParticle ? 0 : this.GetParticleMass(), 0, a, a, c);
                    }
                }, n.prototype.ComputeDampingImpulse = function(t, e, i, n, r, s, o) {
                    var a = t + e * i * i + n + r * s * s;
                    return a > 0 ? o / a : 0;
                }, n.prototype.ApplyDamping = function(t, e, i, n, r, s, o, a) {
                    if (r && n) r.m_linearVelocity.SelfMulAdd(o * t, a), r.m_angularVelocity += o * i * e; else {
                        if (!this.m_velocityBuffer.data) throw new Error();
                        this.m_velocityBuffer.data[s].SelfMulAdd(o * t, a);
                    }
                }, n.xTruncBits = 12, n.yTruncBits = 12, n.tagBits = 32, n.yOffset = 1 << n.yTruncBits - 1, 
                n.yShift = n.tagBits - n.yTruncBits, n.xShift = n.tagBits - n.yTruncBits - n.xTruncBits, 
                n.xScale = 1 << n.xShift, n.xOffset = n.xScale * (1 << n.xTruncBits - 1), n.yMask = (1 << n.yTruncBits) - 1 << n.yShift, 
                n.xMask = ~n.yMask, n.DestroyParticlesInShape_s_aabb = new St(), n.CreateParticleGroup_s_transform = new F(), 
                n.ComputeCollisionEnergy_s_v = new P(), n.QueryShapeAABB_s_aabb = new St(), n.QueryPointAABB_s_aabb = new St(), 
                n.RayCast_s_aabb = new St(), n.RayCast_s_p = new P(), n.RayCast_s_v = new P(), n.RayCast_s_n = new P(), 
                n.RayCast_s_point = new P(), n.k_pairFlags = t.b2ParticleFlag.b2_springParticle, 
                n.k_triadFlags = t.b2ParticleFlag.b2_elasticParticle, n.k_noPressureFlags = t.b2ParticleFlag.b2_powderParticle | t.b2ParticleFlag.b2_tensileParticle, 
                n.k_extraDampingFlags = t.b2ParticleFlag.b2_staticPressureParticle, n.k_barrierWallFlags = t.b2ParticleFlag.b2_barrierParticle | t.b2ParticleFlag.b2_wallParticle, 
                n.CreateParticlesStrokeShapeForGroup_s_edge = new ri(), n.CreateParticlesStrokeShapeForGroup_s_d = new P(), 
                n.CreateParticlesStrokeShapeForGroup_s_p = new P(), n.CreateParticlesFillShapeForGroup_s_aabb = new St(), 
                n.CreateParticlesFillShapeForGroup_s_p = new P(), n.UpdatePairsAndTriads_s_dab = new P(), 
                n.UpdatePairsAndTriads_s_dbc = new P(), n.UpdatePairsAndTriads_s_dca = new P(), 
                n.AddContact_s_d = new P(), n.UpdateBodyContacts_s_aabb = new St(), n.Solve_s_subStep = new un(), 
                n.SolveCollision_s_aabb = new St(), n.SolveGravity_s_gravity = new P(), n.SolveBarrier_s_aabb = new St(), 
                n.SolveBarrier_s_va = new P(), n.SolveBarrier_s_vb = new P(), n.SolveBarrier_s_pba = new P(), 
                n.SolveBarrier_s_vba = new P(), n.SolveBarrier_s_vc = new P(), n.SolveBarrier_s_pca = new P(), 
                n.SolveBarrier_s_vca = new P(), n.SolveBarrier_s_qba = new P(), n.SolveBarrier_s_qca = new P(), 
                n.SolveBarrier_s_dv = new P(), n.SolveBarrier_s_f = new P(), n.SolvePressure_s_f = new P(), 
                n.SolveDamping_s_v = new P(), n.SolveDamping_s_f = new P(), n.SolveRigidDamping_s_t0 = new P(), 
                n.SolveRigidDamping_s_t1 = new P(), n.SolveRigidDamping_s_p = new P(), n.SolveRigidDamping_s_v = new P(), 
                n.SolveExtraDamping_s_v = new P(), n.SolveExtraDamping_s_f = new P(), n.SolveRigid_s_position = new P(), 
                n.SolveRigid_s_rotation = new O(), n.SolveRigid_s_transform = new F(), n.SolveRigid_s_velocityTransform = new F(), 
                n.SolveElastic_s_pa = new P(), n.SolveElastic_s_pb = new P(), n.SolveElastic_s_pc = new P(), 
                n.SolveElastic_s_r = new O(), n.SolveElastic_s_t0 = new P(), n.SolveSpring_s_pa = new P(), 
                n.SolveSpring_s_pb = new P(), n.SolveSpring_s_d = new P(), n.SolveSpring_s_f = new P(), 
                n.SolveTensile_s_weightedNormal = new P(), n.SolveTensile_s_s = new P(), n.SolveTensile_s_f = new P(), 
                n.SolveViscous_s_v = new P(), n.SolveViscous_s_f = new P(), n.SolveRepulsive_s_f = new P(), 
                n.SolvePowder_s_f = new P(), n.SolveSolid_s_f = new P(), n.RemoveSpuriousBodyContacts_s_n = new P(), 
                n.RemoveSpuriousBodyContacts_s_pos = new P(), n.RemoveSpuriousBodyContacts_s_normal = new P(), 
                n;
            }(), function(e) {
                e.UserOverridableBuffer = function() {
                    this.data = null, this.userSuppliedCapacity = 0;
                };
                var n = function() {
                    function t() {
                        this.index = h, this.tag = 0;
                    }
                    return t.CompareProxyProxy = function(t, e) {
                        return t.tag < e.tag;
                    }, t.CompareTagProxy = function(t, e) {
                        return t < e.tag;
                    }, t.CompareProxyTag = function(t, e) {
                        return t.tag < e;
                    }, t;
                }();
                e.Proxy = n;
                var r = function() {
                    function t(t, i, n, r, s) {
                        this.m_system = t, this.m_xLower = (i & e.xMask) >>> 0, this.m_xUpper = (n & e.xMask) >>> 0, 
                        this.m_yLower = (i & e.yMask) >>> 0, this.m_yUpper = (n & e.yMask) >>> 0, this.m_first = r, 
                        this.m_last = s;
                    }
                    return t.prototype.GetNext = function() {
                        for (;this.m_first < this.m_last; ) {
                            var t = (this.m_system.m_proxyBuffer.data[this.m_first].tag & e.xMask) >>> 0;
                            if (t >= this.m_xLower && t <= this.m_xUpper) return this.m_system.m_proxyBuffer.data[this.m_first++].index;
                            this.m_first++;
                        }
                        return h;
                    }, t;
                }();
                e.InsideBoundsEnumerator = r;
                e.ParticleListNode = function() {
                    this.next = null, this.count = 0, this.index = 0;
                };
                var s = function() {
                    function t() {}
                    return t.prototype.Allocate = function(t, e) {
                        return e;
                    }, t.prototype.Clear = function() {}, t.prototype.GetCount = function() {
                        return 0;
                    }, t.prototype.Invalidate = function() {}, t.prototype.GetValidBuffer = function() {
                        return [];
                    }, t.prototype.GetBuffer = function() {
                        return [];
                    }, t.prototype.SetCount = function() {}, t;
                }();
                e.FixedSetAllocator = s;
                e.FixtureParticle = function(t, e) {
                    this.second = h, this.first = t, this.second = e;
                };
                var o = function(t) {
                    function e() {
                        return null !== t && t.apply(this, arguments) || this;
                    }
                    return ti(e, t), e.prototype.Initialize = function() {}, e.prototype.Find = function() {
                        return h;
                    }, e;
                }(e.FixedSetAllocator);
                e.FixtureParticleSet = o;
                e.ParticlePair = function(t, e) {
                    this.first = h, this.second = h, this.first = t, this.second = e;
                };
                var a = function(t) {
                    function e() {
                        return null !== t && t.apply(this, arguments) || this;
                    }
                    return ti(e, t), e.prototype.Initialize = function() {}, e.prototype.Find = function() {
                        return h;
                    }, e;
                }(e.FixedSetAllocator);
                e.b2ParticlePairSet = a;
                var l = function() {
                    function t() {}
                    return t.prototype.IsNecessary = function() {
                        return !0;
                    }, t.prototype.ShouldCreatePair = function() {
                        return !0;
                    }, t.prototype.ShouldCreateTriad = function() {
                        return !0;
                    }, t;
                }();
                e.ConnectionFilter = l;
                var u = function(t) {
                    function e(e, i, n, r) {
                        var s = t.call(this) || this;
                        return s.m_callDestructionListener = !1, s.m_destroyed = 0, s.m_system = e, s.m_shape = i, 
                        s.m_xf = n, s.m_callDestructionListener = r, s.m_destroyed = 0, s;
                    }
                    return ti(e, t), e.prototype.ReportFixture = function() {
                        return !1;
                    }, e.prototype.ReportParticle = function(t, e) {
                        if (t !== this.m_system) return !1;
                        if (!this.m_system.m_positionBuffer.data) throw new Error();
                        return this.m_shape.TestPoint(this.m_xf, this.m_system.m_positionBuffer.data[e]) && (this.m_system.DestroyParticle(e, this.m_callDestructionListener), 
                        this.m_destroyed++), !0;
                    }, e.prototype.Destroyed = function() {
                        return this.m_destroyed;
                    }, e;
                }(on);
                e.DestroyParticlesInShapeCallback = u;
                var _ = function(t) {
                    function e(e) {
                        var i = t.call(this) || this;
                        return i.m_threshold = 0, i.m_threshold = e, i;
                    }
                    return ti(e, t), e.prototype.ShouldCreatePair = function(t, e) {
                        return t < this.m_threshold && this.m_threshold <= e || e < this.m_threshold && this.m_threshold <= t;
                    }, e.prototype.ShouldCreateTriad = function(t, e, i) {
                        return (t < this.m_threshold || e < this.m_threshold || i < this.m_threshold) && (this.m_threshold <= t || this.m_threshold <= e || this.m_threshold <= i);
                    }, e;
                }(e.ConnectionFilter);
                e.JoinParticleGroupsFilter = _;
                var f = function(e) {
                    function n(i, n) {
                        void 0 === n && (n = i.length);
                        var r = e.call(this, t.b2ShapeType.e_unknown, 0) || this;
                        return r.m_shapeCount = 0, r.m_shapes = i, r.m_shapeCount = n, r;
                    }
                    return ti(n, e), n.prototype.Clone = function() {
                        throw new Error();
                    }, n.prototype.GetChildCount = function() {
                        return 1;
                    }, n.prototype.TestPoint = function(t, e) {
                        for (var i = 0; i < this.m_shapeCount; i++) if (this.m_shapes[i].TestPoint(t, e)) return !0;
                        return !1;
                    }, n.prototype.ComputeDistance = function() {
                        return 0;
                    }, n.prototype.RayCast = function() {
                        return !1;
                    }, n.prototype.ComputeAABB = function(t, e) {
                        var n = new St();
                        t.lowerBound.x = +i, t.lowerBound.y = +i, t.upperBound.x = -i, t.upperBound.y = -i;
                        for (var r = 0; r < this.m_shapeCount; r++) for (var s = this.m_shapes[r].GetChildCount(), o = 0; o < s; o++) {
                            var a = n;
                            this.m_shapes[r].ComputeAABB(a, e, o), t.Combine1(a);
                        }
                    }, n.prototype.ComputeMass = function() {}, n.prototype.SetupDistanceProxy = function() {}, 
                    n.prototype.ComputeSubmergedArea = function() {
                        return 0;
                    }, n.prototype.Dump = function() {}, n;
                }(Qe);
                e.CompositeShape = f;
                var d = function(e) {
                    function i(t) {
                        var i = e.call(this) || this;
                        return i.m_flagsBuffer = t, i;
                    }
                    return ti(i, e), i.prototype.IsNecessary = function(e) {
                        if (!this.m_flagsBuffer.data) throw new Error();
                        return 0 != (this.m_flagsBuffer.data[e] & t.b2ParticleFlag.b2_reactiveParticle);
                    }, i;
                }(e.ConnectionFilter);
                e.ReactiveFilter = d;
                var p = function(i) {
                    function n(t, e) {
                        var n = i.call(this, t) || this;
                        return n.m_contactFilter = e, n;
                    }
                    return ti(n, i), n.prototype.ShouldCollideFixtureParticle = function(e, i, n) {
                        return !(this.m_contactFilter && this.m_system.GetFlagsBuffer()[n] & t.b2ParticleFlag.b2_fixtureContactFilterParticle) || this.m_contactFilter.ShouldCollideFixtureParticle(e, this.m_system, n);
                    }, n.prototype.ReportFixtureAndParticle = function(i, n, r) {
                        var s = e.UpdateBodyContactsCallback.ReportFixtureAndParticle_s_n, o = e.UpdateBodyContactsCallback.ReportFixtureAndParticle_s_rp;
                        if (!this.m_system.m_flagsBuffer.data) throw new Error();
                        if (!this.m_system.m_positionBuffer.data) throw new Error();
                        var a = this.m_system.m_positionBuffer.data[r], c = s, l = i.ComputeDistance(a, c, n);
                        if (l < this.m_system.m_particleDiameter && this.ShouldCollideFixtureParticle(i, this.m_system, r)) {
                            var u = i.GetBody(), h = u.GetWorldCenter(), _ = u.GetMass(), f = u.GetInertia() - _ * u.GetLocalCenter().LengthSquared(), d = _ > 0 ? 1 / _ : 0, p = f > 0 ? 1 / f : 0, m = this.m_system.m_flagsBuffer.data[r] & t.b2ParticleFlag.b2_wallParticle ? 0 : this.m_system.GetParticleInvMass(), v = P.SubVV(a, h, o), y = P.CrossVV(v, c), g = m + d + p * y * y, x = this.m_system.m_bodyContactBuffer.data[this.m_system.m_bodyContactBuffer.Append()];
                            x.index = r, x.body = u, x.fixture = i, x.weight = 1 - l * this.m_system.m_inverseDiameter, 
                            x.normal.Copy(c.SelfNeg()), x.mass = g > 0 ? 1 / g : 0, this.m_system.DetectStuckParticle(r);
                        }
                    }, n.ReportFixtureAndParticle_s_n = new P(), n.ReportFixtureAndParticle_s_rp = new P(), 
                    n;
                }(Gn);
                e.UpdateBodyContactsCallback = p;
                var m = function(i) {
                    function n(t, e) {
                        var n = i.call(this, t) || this;
                        return n.m_step = e, n;
                    }
                    return ti(n, i), n.prototype.ReportFixtureAndParticle = function(i, n, r) {
                        var s = e.SolveCollisionCallback.ReportFixtureAndParticle_s_p1, o = e.SolveCollisionCallback.ReportFixtureAndParticle_s_output, a = e.SolveCollisionCallback.ReportFixtureAndParticle_s_input, l = e.SolveCollisionCallback.ReportFixtureAndParticle_s_p, u = e.SolveCollisionCallback.ReportFixtureAndParticle_s_v, h = e.SolveCollisionCallback.ReportFixtureAndParticle_s_f, _ = i.GetBody();
                        if (!this.m_system.m_positionBuffer.data) throw new Error();
                        if (!this.m_system.m_velocityBuffer.data) throw new Error();
                        var f = this.m_system.m_positionBuffer.data[r], d = this.m_system.m_velocityBuffer.data[r], p = o, m = a;
                        if (0 === this.m_system.m_iterationIndex) {
                            var v = F.MulTXV(_.m_xf0, f, s);
                            i.GetShape().GetType() === t.b2ShapeType.e_circleShape && (v.SelfSub(_.GetLocalCenter()), 
                            O.MulRV(_.m_xf0.q, v, v), O.MulTRV(_.m_xf.q, v, v), v.SelfAdd(_.GetLocalCenter())), 
                            F.MulXV(_.m_xf, v, m.p1);
                        } else m.p1.Copy(f);
                        if (P.AddVMulSV(f, this.m_step.dt, d, m.p2), m.maxFraction = 1, i.RayCast(p, m, n)) {
                            var y = p.normal, g = l;
                            g.x = (1 - p.fraction) * m.p1.x + p.fraction * m.p2.x + c * y.x, g.y = (1 - p.fraction) * m.p1.y + p.fraction * m.p2.y + c * y.y;
                            var x = u;
                            x.x = this.m_step.inv_dt * (g.x - f.x), x.y = this.m_step.inv_dt * (g.y - f.y), 
                            this.m_system.m_velocityBuffer.data[r].Copy(x);
                            var A = h;
                            A.x = this.m_step.inv_dt * this.m_system.GetParticleMass() * (d.x - x.x), A.y = this.m_step.inv_dt * this.m_system.GetParticleMass() * (d.y - x.y), 
                            this.m_system.ParticleApplyForce(r, A);
                        }
                    }, n.prototype.ReportParticle = function() {
                        return !1;
                    }, n.ReportFixtureAndParticle_s_p1 = new P(), n.ReportFixtureAndParticle_s_output = new bt(), 
                    n.ReportFixtureAndParticle_s_input = new Ct(), n.ReportFixtureAndParticle_s_p = new P(), 
                    n.ReportFixtureAndParticle_s_v = new P(), n.ReportFixtureAndParticle_s_f = new P(), 
                    n;
                }(Gn);
                e.SolveCollisionCallback = m;
            }(t.b2ParticleSystem || (t.b2ParticleSystem = {}));
            var jn = function() {
                function e(t) {
                    this.m_newFixture = !1, this.m_locked = !1, this.m_clearForces = !0, this.m_contactManager = new cn(), 
                    this.m_bodyList = null, this.m_jointList = null, this.m_particleSystemList = null, 
                    this.m_bodyCount = 0, this.m_jointCount = 0, this.m_gravity = new P(), this.m_allowSleep = !0, 
                    this.m_destructionListener = null, this.m_debugDraw = null, this.m_inv_dt0 = 0, 
                    this.m_warmStarting = !0, this.m_continuousPhysics = !0, this.m_subStepping = !1, 
                    this.m_stepComplete = !0, this.m_profile = new ln(), this.m_island = new xn(), this.s_stack = [], 
                    this.m_controllerList = null, this.m_controllerCount = 0, this.m_gravity.Copy(t);
                }
                return e.prototype.SetDestructionListener = function(t) {
                    this.m_destructionListener = t;
                }, e.prototype.SetContactFilter = function(t) {
                    this.m_contactManager.m_contactFilter = t;
                }, e.prototype.SetContactListener = function(t) {
                    this.m_contactManager.m_contactListener = t;
                }, e.prototype.SetDebugDraw = function(t) {
                    this.m_debugDraw = t;
                }, e.prototype.CreateBody = function(t) {
                    if (void 0 === t && (t = {}), this.IsLocked()) throw new Error();
                    var e = new _i(t, this);
                    return e.m_prev = null, e.m_next = this.m_bodyList, this.m_bodyList && (this.m_bodyList.m_prev = e), 
                    this.m_bodyList = e, ++this.m_bodyCount, e;
                }, e.prototype.DestroyBody = function(t) {
                    if (this.IsLocked()) throw new Error();
                    for (var e = t.m_jointList; e; ) {
                        var i = e;
                        e = e.next, this.m_destructionListener && this.m_destructionListener.SayGoodbyeJoint(i.joint), 
                        this.DestroyJoint(i.joint), t.m_jointList = e;
                    }
                    t.m_jointList = null;
                    for (var n = t.m_controllerList; n; ) {
                        var r = n;
                        n = n.nextController, r.controller.RemoveBody(t);
                    }
                    for (var s = t.m_contactList; s; ) {
                        var o = s;
                        s = s.next, this.m_contactManager.Destroy(o.contact);
                    }
                    t.m_contactList = null;
                    for (var a = t.m_fixtureList; a; ) {
                        var c = a;
                        a = a.m_next, this.m_destructionListener && this.m_destructionListener.SayGoodbyeFixture(c), 
                        c.DestroyProxies(), c.Destroy(), t.m_fixtureList = a, t.m_fixtureCount -= 1;
                    }
                    t.m_fixtureList = null, t.m_fixtureCount = 0, t.m_prev && (t.m_prev.m_next = t.m_next), 
                    t.m_next && (t.m_next.m_prev = t.m_prev), t === this.m_bodyList && (this.m_bodyList = t.m_next), 
                    --this.m_bodyCount;
                }, e._Joint_Create = function(e) {
                    switch (e.type) {
                      case t.b2JointType.e_distanceJoint:
                        return new yi(e);

                      case t.b2JointType.e_mouseJoint:
                        return new Bi(e);

                      case t.b2JointType.e_prismaticJoint:
                        return new Ri(e);

                      case t.b2JointType.e_revoluteJoint:
                        return new Vi(e);

                      case t.b2JointType.e_pulleyJoint:
                        return new Ii(e);

                      case t.b2JointType.e_gearJoint:
                        return new Si(e);

                      case t.b2JointType.e_wheelJoint:
                        return new ki(e);

                      case t.b2JointType.e_weldJoint:
                        return new Ni(e);

                      case t.b2JointType.e_frictionJoint:
                        return new Ci(e);

                      case t.b2JointType.e_ropeJoint:
                        return new Oi(e);

                      case t.b2JointType.e_motorJoint:
                        return new wi(e);

                      case t.b2JointType.e_areaJoint:
                        return new xi(e);
                    }
                    throw new Error();
                }, e._Joint_Destroy = function() {}, e.prototype.CreateJoint = function(t) {
                    if (this.IsLocked()) throw new Error();
                    var i = e._Joint_Create(t, null);
                    i.m_prev = null, i.m_next = this.m_jointList, this.m_jointList && (this.m_jointList.m_prev = i), 
                    this.m_jointList = i, ++this.m_jointCount, i.m_edgeA.prev = null, i.m_edgeA.next = i.m_bodyA.m_jointList, 
                    i.m_bodyA.m_jointList && (i.m_bodyA.m_jointList.prev = i.m_edgeA), i.m_bodyA.m_jointList = i.m_edgeA, 
                    i.m_edgeB.prev = null, i.m_edgeB.next = i.m_bodyB.m_jointList, i.m_bodyB.m_jointList && (i.m_bodyB.m_jointList.prev = i.m_edgeB), 
                    i.m_bodyB.m_jointList = i.m_edgeB;
                    var n = t.bodyA, r = t.bodyB;
                    if (!t.collideConnected) for (var s = r.GetContactList(); s; ) s.other === n && s.contact.FlagForFiltering(), 
                    s = s.next;
                    return i;
                }, e.prototype.DestroyJoint = function(t) {
                    if (this.IsLocked()) throw new Error();
                    var i = t.m_collideConnected;
                    t.m_prev && (t.m_prev.m_next = t.m_next), t.m_next && (t.m_next.m_prev = t.m_prev), 
                    t === this.m_jointList && (this.m_jointList = t.m_next);
                    var n = t.m_bodyA, r = t.m_bodyB;
                    if (n.SetAwake(!0), r.SetAwake(!0), t.m_edgeA.prev && (t.m_edgeA.prev.next = t.m_edgeA.next), 
                    t.m_edgeA.next && (t.m_edgeA.next.prev = t.m_edgeA.prev), t.m_edgeA === n.m_jointList && (n.m_jointList = t.m_edgeA.next), 
                    t.m_edgeA.prev = null, t.m_edgeA.next = null, t.m_edgeB.prev && (t.m_edgeB.prev.next = t.m_edgeB.next), 
                    t.m_edgeB.next && (t.m_edgeB.next.prev = t.m_edgeB.prev), t.m_edgeB === r.m_jointList && (r.m_jointList = t.m_edgeB.next), 
                    t.m_edgeB.prev = null, t.m_edgeB.next = null, e._Joint_Destroy(t, null), --this.m_jointCount, 
                    !i) for (var s = r.GetContactList(); s; ) s.other === n && s.contact.FlagForFiltering(), 
                    s = s.next;
                }, e.prototype.CreateParticleSystem = function(e) {
                    if (this.IsLocked()) throw new Error();
                    var i = new t.b2ParticleSystem(e, this);
                    return i.m_prev = null, i.m_next = this.m_particleSystemList, this.m_particleSystemList && (this.m_particleSystemList.m_prev = i), 
                    this.m_particleSystemList = i, i;
                }, e.prototype.DestroyParticleSystem = function(t) {
                    if (this.IsLocked()) throw new Error();
                    t.m_prev && (t.m_prev.m_next = t.m_next), t.m_next && (t.m_next.m_prev = t.m_prev), 
                    t === this.m_particleSystemList && (this.m_particleSystemList = t.m_next);
                }, e.prototype.CalculateReasonableParticleIterations = function(t) {
                    return null === this.m_particleSystemList ? 1 : Cn(this.m_gravity.Length(), function(t) {
                        for (var e = i, n = t.GetParticleSystemList(); null !== n; n = n.m_next) e = v(e, n.GetRadius());
                        return e;
                    }(this), t);
                }, e.prototype.Step = function(t, i, n, r) {
                    void 0 === r && (r = this.CalculateReasonableParticleIterations(t));
                    var s = e.Step_s_stepTimer.Reset();
                    this.m_newFixture && (this.m_contactManager.FindNewContacts(), this.m_newFixture = !1), 
                    this.m_locked = !0;
                    var o = e.Step_s_step;
                    o.dt = t, o.velocityIterations = i, o.positionIterations = n, o.particleIterations = r, 
                    o.inv_dt = t > 0 ? 1 / t : 0, o.dtRatio = this.m_inv_dt0 * t, o.warmStarting = this.m_warmStarting;
                    var a = e.Step_s_timer.Reset();
                    if (this.m_contactManager.Collide(), this.m_profile.collide = a.GetMilliseconds(), 
                    this.m_stepComplete && o.dt > 0) {
                        for (var c = e.Step_s_timer.Reset(), l = this.m_particleSystemList; l; l = l.m_next) l.Solve(o);
                        this.Solve(o), this.m_profile.solve = c.GetMilliseconds();
                    }
                    if (this.m_continuousPhysics && o.dt > 0) {
                        var u = e.Step_s_timer.Reset();
                        this.SolveTOI(o), this.m_profile.solveTOI = u.GetMilliseconds();
                    }
                    o.dt > 0 && (this.m_inv_dt0 = o.inv_dt), this.m_clearForces && this.ClearForces(), 
                    this.m_locked = !1, this.m_profile.step = s.GetMilliseconds();
                }, e.prototype.ClearForces = function() {
                    for (var t = this.m_bodyList; t; t = t.m_next) t.m_force.SetZero(), t.m_torque = 0;
                }, e.prototype.DrawParticleSystem = function(t) {
                    if (null !== this.m_debugDraw) {
                        var e = t.GetParticleCount();
                        if (e) {
                            var i = t.GetRadius(), n = t.GetPositionBuffer();
                            if (t.m_colorBuffer.data) {
                                var r = t.GetColorBuffer();
                                this.m_debugDraw.DrawParticles(n, i, r, e);
                            } else this.m_debugDraw.DrawParticles(n, i, null, e);
                        }
                    }
                }, e.prototype.DrawDebugData = function() {
                    if (null !== this.m_debugDraw) {
                        var i = this.m_debugDraw.GetFlags(), n = e.DrawDebugData_s_color.SetRGB(0, 0, 0);
                        if (i & t.b2DrawFlags.e_shapeBit) for (var r = this.m_bodyList; r; r = r.m_next) {
                            var s = r.m_xf;
                            this.m_debugDraw.PushTransform(s);
                            for (var o = r.GetFixtureList(); o; o = o.m_next) r.IsActive() ? r.GetType() === t.b2BodyType.b2_staticBody ? (n.SetRGB(.5, .9, .5), 
                            this.DrawShape(o, n)) : r.GetType() === t.b2BodyType.b2_kinematicBody ? (n.SetRGB(.5, .5, .9), 
                            this.DrawShape(o, n)) : r.IsAwake() ? (n.SetRGB(.9, .7, .7), this.DrawShape(o, n)) : (n.SetRGB(.6, .6, .6), 
                            this.DrawShape(o, n)) : (n.SetRGB(.5, .5, .3), this.DrawShape(o, n));
                            this.m_debugDraw.PopTransform(s);
                        }
                        if (i & t.b2DrawFlags.e_particleBit) for (var a = this.m_particleSystemList; a; a = a.m_next) this.DrawParticleSystem(a);
                        if (i & t.b2DrawFlags.e_jointBit) for (var c = this.m_jointList; c; c = c.m_next) this.DrawJoint(c);
                        if (i & t.b2DrawFlags.e_aabbBit) {
                            n.SetRGB(.9, .3, .9);
                            var l = e.DrawDebugData_s_vs;
                            for (r = this.m_bodyList; r; r = r.m_next) if (r.IsActive()) for (o = r.GetFixtureList(); o; o = o.m_next) for (var u = 0; u < o.m_proxyCount; ++u) {
                                var h = o.m_proxies[u].treeNode.aabb;
                                l[0].Set(h.lowerBound.x, h.lowerBound.y), l[1].Set(h.upperBound.x, h.lowerBound.y), 
                                l[2].Set(h.upperBound.x, h.upperBound.y), l[3].Set(h.lowerBound.x, h.upperBound.y), 
                                this.m_debugDraw.DrawPolygon(l, 4, n);
                            }
                        }
                        if (i & t.b2DrawFlags.e_centerOfMassBit) for (r = this.m_bodyList; r; r = r.m_next) (s = e.DrawDebugData_s_xf).q.Copy(r.m_xf.q), 
                        s.p.Copy(r.GetWorldCenter()), this.m_debugDraw.DrawTransform(s);
                        if (i & t.b2DrawFlags.e_controllerBit) for (var _ = this.m_controllerList; _; _ = _.m_next) _.Draw(this.m_debugDraw);
                    }
                }, e.prototype.QueryAABB = function(t, e, i) {
                    if (this.m_contactManager.m_broadPhase.Query(e, function(e) {
                        var n = e.userData.fixture;
                        return t ? t.ReportFixture(n) : !i || i(n);
                    }), t instanceof on) for (var n = this.m_particleSystemList; n; n = n.m_next) t.ShouldQueryParticleSystem(n) && n.QueryAABB(t, e);
                }, e.prototype.QueryAllAABB = function(t, e) {
                    return void 0 === e && (e = []), this.QueryAABB(null, t, function(t) {
                        return e.push(t), !0;
                    }), e;
                }, e.prototype.QueryPointAABB = function(t, e, i) {
                    if (this.m_contactManager.m_broadPhase.QueryPoint(e, function(e) {
                        var n = e.userData.fixture;
                        return t ? t.ReportFixture(n) : !i || i(n);
                    }), t instanceof on) for (var n = this.m_particleSystemList; n; n = n.m_next) t.ShouldQueryParticleSystem(n) && n.QueryPointAABB(t, e);
                }, e.prototype.QueryAllPointAABB = function(t, e) {
                    return void 0 === e && (e = []), this.QueryPointAABB(null, t, function(t) {
                        return e.push(t), !0;
                    }), e;
                }, e.prototype.QueryFixtureShape = function(t, i, n, r, s) {
                    var o = e.QueryFixtureShape_s_aabb;
                    if (i.ComputeAABB(o, r, n), this.m_contactManager.m_broadPhase.Query(o, function(e) {
                        var o = e.userData, a = o.fixture;
                        if (Rt(i, n, a.GetShape(), o.childIndex, r, a.GetBody().GetTransform())) {
                            if (t) return t.ReportFixture(a);
                            if (s) return s(a);
                        }
                        return !0;
                    }), t instanceof on) for (var a = this.m_particleSystemList; a; a = a.m_next) t.ShouldQueryParticleSystem(a) && a.QueryAABB(t, o);
                }, e.prototype.QueryAllFixtureShape = function(t, e, i, n) {
                    return void 0 === n && (n = []), this.QueryFixtureShape(null, t, e, i, function(t) {
                        return n.push(t), !0;
                    }), n;
                }, e.prototype.QueryFixturePoint = function(t, e, i) {
                    if (this.m_contactManager.m_broadPhase.QueryPoint(e, function(n) {
                        var r = n.userData.fixture;
                        if (r.TestPoint(e)) {
                            if (t) return t.ReportFixture(r);
                            if (i) return i(r);
                        }
                        return !0;
                    }), t) for (var n = this.m_particleSystemList; n; n = n.m_next) t.ShouldQueryParticleSystem(n) && n.QueryPointAABB(t, e);
                }, e.prototype.QueryAllFixturePoint = function(t, e) {
                    return void 0 === e && (e = []), this.QueryFixturePoint(null, t, function(t) {
                        return e.push(t), !0;
                    }), e;
                }, e.prototype.RayCast = function(t, i, n, r) {
                    var s = e.RayCast_s_input;
                    if (s.maxFraction = 1, s.p1.Copy(i), s.p2.Copy(n), this.m_contactManager.m_broadPhase.RayCast(s, function(s, o) {
                        var a = o.userData, c = a.fixture, l = a.childIndex, u = e.RayCast_s_output;
                        if (c.RayCast(u, s, l)) {
                            var h = u.fraction, _ = e.RayCast_s_point;
                            if (_.Set((1 - h) * i.x + h * n.x, (1 - h) * i.y + h * n.y), t) return t.ReportFixture(c, _, u.normal, h);
                            if (r) return r(c, _, u.normal, h);
                        }
                        return s.maxFraction;
                    }), t) for (var o = this.m_particleSystemList; o; o = o.m_next) t.ShouldQueryParticleSystem(o) && o.RayCast(t, i, n);
                }, e.prototype.RayCastOne = function(t, e) {
                    var i = null, n = 1;
                    return this.RayCast(null, t, e, function(t, e, r, s) {
                        return s < n && (n = s, i = t), n;
                    }), i;
                }, e.prototype.RayCastAll = function(t, e, i) {
                    return void 0 === i && (i = []), this.RayCast(null, t, e, function(t) {
                        return i.push(t), 1;
                    }), i;
                }, e.prototype.GetBodyList = function() {
                    return this.m_bodyList;
                }, e.prototype.GetJointList = function() {
                    return this.m_jointList;
                }, e.prototype.GetParticleSystemList = function() {
                    return this.m_particleSystemList;
                }, e.prototype.GetContactList = function() {
                    return this.m_contactManager.m_contactList;
                }, e.prototype.SetAllowSleeping = function(t) {
                    if (t !== this.m_allowSleep && (this.m_allowSleep = t, !this.m_allowSleep)) for (var e = this.m_bodyList; e; e = e.m_next) e.SetAwake(!0);
                }, e.prototype.GetAllowSleeping = function() {
                    return this.m_allowSleep;
                }, e.prototype.SetWarmStarting = function(t) {
                    this.m_warmStarting = t;
                }, e.prototype.GetWarmStarting = function() {
                    return this.m_warmStarting;
                }, e.prototype.SetContinuousPhysics = function(t) {
                    this.m_continuousPhysics = t;
                }, e.prototype.GetContinuousPhysics = function() {
                    return this.m_continuousPhysics;
                }, e.prototype.SetSubStepping = function(t) {
                    this.m_subStepping = t;
                }, e.prototype.GetSubStepping = function() {
                    return this.m_subStepping;
                }, e.prototype.GetProxyCount = function() {
                    return this.m_contactManager.m_broadPhase.GetProxyCount();
                }, e.prototype.GetBodyCount = function() {
                    return this.m_bodyCount;
                }, e.prototype.GetJointCount = function() {
                    return this.m_jointCount;
                }, e.prototype.GetContactCount = function() {
                    return this.m_contactManager.m_contactCount;
                }, e.prototype.GetTreeHeight = function() {
                    return this.m_contactManager.m_broadPhase.GetTreeHeight();
                }, e.prototype.GetTreeBalance = function() {
                    return this.m_contactManager.m_broadPhase.GetTreeBalance();
                }, e.prototype.GetTreeQuality = function() {
                    return this.m_contactManager.m_broadPhase.GetTreeQuality();
                }, e.prototype.SetGravity = function(t, e) {
                    if (void 0 === e && (e = !0), !P.IsEqualToV(this.m_gravity, t) && (this.m_gravity.Copy(t), 
                    e)) for (var i = this.m_bodyList; i; i = i.m_next) i.SetAwake(!0);
                }, e.prototype.GetGravity = function() {
                    return this.m_gravity;
                }, e.prototype.IsLocked = function() {
                    return this.m_locked;
                }, e.prototype.SetAutoClearForces = function(t) {
                    this.m_clearForces = t;
                }, e.prototype.GetAutoClearForces = function() {
                    return this.m_clearForces;
                }, e.prototype.ShiftOrigin = function(t) {
                    if (this.IsLocked()) throw new Error();
                    for (var e = this.m_bodyList; e; e = e.m_next) e.m_xf.p.SelfSub(t), e.m_sweep.c0.SelfSub(t), 
                    e.m_sweep.c.SelfSub(t);
                    for (var i = this.m_jointList; i; i = i.m_next) i.ShiftOrigin(t);
                    this.m_contactManager.m_broadPhase.ShiftOrigin(t);
                }, e.prototype.GetContactManager = function() {
                    return this.m_contactManager;
                }, e.prototype.GetProfile = function() {
                    return this.m_profile;
                }, e.prototype.Dump = function(e) {
                    if (!this.m_locked) {
                        e("const g: b2Vec2 = new b2Vec2(%.15f, %.15f);\n", this.m_gravity.x, this.m_gravity.y), 
                        e("this.m_world.SetGravity(g);\n"), e("const bodies: b2Body[] = [];\n"), e("const joints: b2Joint[] = [];\n");
                        for (var i = 0, n = this.m_bodyList; n; n = n.m_next) n.m_islandIndex = i, n.Dump(e), 
                        ++i;
                        i = 0;
                        for (var r = this.m_jointList; r; r = r.m_next) r.m_index = i, ++i;
                        for (r = this.m_jointList; r; r = r.m_next) r.m_type !== t.b2JointType.e_gearJoint && (e("{\n"), 
                        r.Dump(e), e("}\n"));
                        for (r = this.m_jointList; r; r = r.m_next) r.m_type === t.b2JointType.e_gearJoint && (e("{\n"), 
                        r.Dump(e), e("}\n"));
                    }
                }, e.prototype.DrawJoint = function(i) {
                    if (null !== this.m_debugDraw) {
                        var n = i.GetBodyA(), r = i.GetBodyB(), s = n.m_xf, o = r.m_xf, a = s.p, c = o.p, l = i.GetAnchorA(e.DrawJoint_s_p1), u = i.GetAnchorB(e.DrawJoint_s_p2), h = e.DrawJoint_s_color.SetRGB(.5, .8, .8);
                        switch (i.m_type) {
                          case t.b2JointType.e_distanceJoint:
                            this.m_debugDraw.DrawSegment(l, u, h);
                            break;

                          case t.b2JointType.e_pulleyJoint:
                            var _ = i, f = _.GetGroundAnchorA(), d = _.GetGroundAnchorB();
                            this.m_debugDraw.DrawSegment(f, l, h), this.m_debugDraw.DrawSegment(d, u, h), this.m_debugDraw.DrawSegment(f, d, h);
                            break;

                          case t.b2JointType.e_mouseJoint:
                            var p = e.DrawJoint_s_c;
                            p.Set(0, 1, 0), this.m_debugDraw.DrawPoint(l, 4, p), this.m_debugDraw.DrawPoint(u, 4, p), 
                            p.Set(.8, .8, .8), this.m_debugDraw.DrawSegment(l, u, p);
                            break;

                          default:
                            this.m_debugDraw.DrawSegment(a, l, h), this.m_debugDraw.DrawSegment(l, u, h), this.m_debugDraw.DrawSegment(c, u, h);
                        }
                    }
                }, e.prototype.DrawShape = function(i, n) {
                    if (null !== this.m_debugDraw) {
                        var r = i.GetShape();
                        switch (r.m_type) {
                          case t.b2ShapeType.e_circleShape:
                            var s = r, o = s.m_p, a = s.m_radius, c = P.UNITX;
                            this.m_debugDraw.DrawSolidCircle(o, a, c, n);
                            break;

                          case t.b2ShapeType.e_edgeShape:
                            var l = r, u = l.m_vertex1, h = l.m_vertex2;
                            this.m_debugDraw.DrawSegment(u, h, n);
                            break;

                          case t.b2ShapeType.e_chainShape:
                            var _ = r, f = _.m_count, d = _.m_vertices, p = e.DrawShape_s_ghostColor.SetRGBA(.75 * n.r, .75 * n.g, .75 * n.b, n.a);
                            if (u = d[0], this.m_debugDraw.DrawPoint(u, 4, n), _.m_hasPrevVertex) {
                                var m = _.m_prevVertex;
                                this.m_debugDraw.DrawSegment(m, u, p), this.m_debugDraw.DrawCircle(m, .1, p);
                            }
                            for (var v = 1; v < f; ++v) h = d[v], this.m_debugDraw.DrawSegment(u, h, n), this.m_debugDraw.DrawPoint(h, 4, n), 
                            u = h;
                            if (_.m_hasNextVertex) {
                                var y = _.m_nextVertex;
                                this.m_debugDraw.DrawSegment(y, u, p), this.m_debugDraw.DrawCircle(y, .1, p);
                            }
                            break;

                          case t.b2ShapeType.e_polygonShape:
                            var g = r, x = g.m_count;
                            d = g.m_vertices, this.m_debugDraw.DrawSolidPolygon(d, x, n);
                        }
                    }
                }, e.prototype.Solve = function(e) {
                    for (var i = this.m_bodyList; i; i = i.m_next) i.m_xf0.Copy(i.m_xf);
                    for (var n = this.m_controllerList; n; n = n.m_next) n.Step(e);
                    this.m_profile.solveInit = 0, this.m_profile.solveVelocity = 0, this.m_profile.solvePosition = 0;
                    var r = this.m_island;
                    for (r.Initialize(this.m_bodyCount, this.m_contactManager.m_contactCount, this.m_jointCount, null, this.m_contactManager.m_contactListener), 
                    i = this.m_bodyList; i; i = i.m_next) i.m_islandFlag = !1;
                    for (var s = this.m_contactManager.m_contactList; s; s = s.m_next) s.m_islandFlag = !1;
                    for (var o = this.m_jointList; o; o = o.m_next) o.m_islandFlag = !1;
                    for (var a = this.s_stack, c = this.m_bodyList; c; c = c.m_next) if (!c.m_islandFlag && c.IsAwake() && c.IsActive() && c.GetType() !== t.b2BodyType.b2_staticBody) {
                        r.Clear();
                        var l = 0;
                        for (a[l++] = c, c.m_islandFlag = !0; l > 0; ) {
                            if (!(i = a[--l])) throw new Error();
                            if (r.AddBody(i), i.m_awakeFlag = !0, i.GetType() !== t.b2BodyType.b2_staticBody) {
                                for (var u = i.m_contactList; u; u = u.next) {
                                    var h = u.contact;
                                    if (!h.m_islandFlag && h.IsEnabled() && h.IsTouching()) {
                                        var _ = h.m_fixtureA.m_isSensor, f = h.m_fixtureB.m_isSensor;
                                        if (!_ && !f) {
                                            if (r.AddContact(h), h.m_islandFlag = !0, !(p = u.other)) throw new Error();
                                            p.m_islandFlag || (a[l++] = p, p.m_islandFlag = !0);
                                        }
                                    }
                                }
                                for (var d = i.m_jointList; d; d = d.next) {
                                    var p;
                                    d.joint.m_islandFlag || (p = d.other).IsActive() && (r.AddJoint(d.joint), d.joint.m_islandFlag = !0, 
                                    p.m_islandFlag || (a[l++] = p, p.m_islandFlag = !0));
                                }
                            }
                        }
                        var m = new ln();
                        r.Solve(m, e, this.m_gravity, this.m_allowSleep), this.m_profile.solveInit += m.solveInit, 
                        this.m_profile.solveVelocity += m.solveVelocity, this.m_profile.solvePosition += m.solvePosition;
                        for (var v = 0; v < r.m_bodyCount; ++v) (i = r.m_bodies[v]).GetType() === t.b2BodyType.b2_staticBody && (i.m_islandFlag = !1);
                    }
                    for (v = 0; v < a.length && a[v]; ++v) a[v] = null;
                    var y = new z();
                    for (i = this.m_bodyList; i; i = i.m_next) i.m_islandFlag && i.GetType() !== t.b2BodyType.b2_staticBody && i.SynchronizeFixtures();
                    this.m_contactManager.FindNewContacts(), this.m_profile.broadphase = y.GetMilliseconds();
                }, e.prototype.SolveTOI = function(i) {
                    var r = this.m_island;
                    if (r.Initialize(64, 32, 0, null, this.m_contactManager.m_contactListener), this.m_stepComplete) {
                        for (var s = this.m_bodyList; s; s = s.m_next) s.m_islandFlag = !1, s.m_sweep.alpha0 = 0;
                        for (var o = this.m_contactManager.m_contactList; o; o = o.m_next) o.m_toiFlag = !1, 
                        o.m_islandFlag = !1, o.m_toiCount = 0, o.m_toi = 1;
                    }
                    for (;;) {
                        var a = null, c = 1;
                        for (o = this.m_contactManager.m_contactList; o; o = o.m_next) if (o.IsEnabled() && !(o.m_toiCount > 8)) {
                            var l = 1;
                            if (o.m_toiFlag) l = o.m_toi; else {
                                var u = o.GetFixtureA(), h = o.GetFixtureB();
                                if (u.IsSensor() || h.IsSensor()) continue;
                                var _ = u.GetBody(), f = h.GetBody(), d = _.m_type, p = f.m_type, m = _.IsAwake() && d !== t.b2BodyType.b2_staticBody, y = f.IsAwake() && p !== t.b2BodyType.b2_staticBody;
                                if (!m && !y) continue;
                                var g = _.IsBullet() || d !== t.b2BodyType.b2_dynamicBody, x = f.IsBullet() || p !== t.b2BodyType.b2_dynamicBody;
                                if (!g && !x) continue;
                                var A = _.m_sweep.alpha0;
                                _.m_sweep.alpha0 < f.m_sweep.alpha0 ? (A = f.m_sweep.alpha0, _.m_sweep.Advance(A)) : f.m_sweep.alpha0 < _.m_sweep.alpha0 && (A = _.m_sweep.alpha0, 
                                f.m_sweep.Advance(A));
                                var C = o.GetChildIndexA(), b = o.GetChildIndexB(), S = e.SolveTOI_s_toi_input;
                                S.proxyA.SetShape(u.GetShape(), C), S.proxyB.SetShape(h.GetShape(), b), S.sweepA.Copy(_.m_sweep), 
                                S.sweepB.Copy(f.m_sweep), S.tMax = 1;
                                var T = e.SolveTOI_s_toi_output;
                                re(T, S);
                                var w = T.t;
                                l = T.state === t.b2TOIOutputState.e_touching ? v(A + (1 - A) * w, 1) : 1, o.m_toi = l, 
                                o.m_toiFlag = !0;
                            }
                            l < c && (a = o, c = l);
                        }
                        if (null === a || 1 - 10 * n < c) {
                            this.m_stepComplete = !0;
                            break;
                        }
                        var E = a.GetFixtureA(), B = a.GetFixtureB(), M = E.GetBody(), R = B.GetBody(), P = e.SolveTOI_s_backup1.Copy(M.m_sweep), I = e.SolveTOI_s_backup2.Copy(R.m_sweep);
                        if (M.Advance(c), R.Advance(c), a.Update(this.m_contactManager.m_contactListener), 
                        a.m_toiFlag = !1, ++a.m_toiCount, a.IsEnabled() && a.IsTouching()) {
                            M.SetAwake(!0), R.SetAwake(!0), r.Clear(), r.AddBody(M), r.AddBody(R), r.AddContact(a), 
                            M.m_islandFlag = !0, R.m_islandFlag = !0, a.m_islandFlag = !0;
                            for (var D = 0; D < 2; ++D) if ((z = 0 === D ? M : R).m_type === t.b2BodyType.b2_dynamicBody) for (var V = z.m_contactList; V && r.m_bodyCount !== r.m_bodyCapacity && r.m_contactCount !== r.m_contactCapacity; V = V.next) {
                                var L = V.contact;
                                if (!L.m_islandFlag) {
                                    var O = V.other;
                                    if (O.m_type !== t.b2BodyType.b2_dynamicBody || z.IsBullet() || O.IsBullet()) {
                                        var F = L.m_fixtureA.m_isSensor, N = L.m_fixtureB.m_isSensor;
                                        if (!F && !N) {
                                            var G = e.SolveTOI_s_backup.Copy(O.m_sweep);
                                            O.m_islandFlag || O.Advance(c), L.Update(this.m_contactManager.m_contactListener), 
                                            L.IsEnabled() && L.IsTouching() ? (L.m_islandFlag = !0, r.AddContact(L), O.m_islandFlag || (O.m_islandFlag = !0, 
                                            O.m_type !== t.b2BodyType.b2_staticBody && O.SetAwake(!0), r.AddBody(O))) : (O.m_sweep.Copy(G), 
                                            O.SynchronizeTransform());
                                        }
                                    }
                                }
                            }
                            var k = e.SolveTOI_s_subStep;
                            for (k.dt = (1 - c) * i.dt, k.inv_dt = 1 / k.dt, k.dtRatio = 1, k.positionIterations = 20, 
                            k.velocityIterations = i.velocityIterations, k.particleIterations = i.particleIterations, 
                            k.warmStarting = !1, r.SolveTOI(k, M.m_islandIndex, R.m_islandIndex), D = 0; D < r.m_bodyCount; ++D) {
                                var z;
                                if ((z = r.m_bodies[D]).m_islandFlag = !1, z.m_type === t.b2BodyType.b2_dynamicBody) for (z.SynchronizeFixtures(), 
                                V = z.m_contactList; V; V = V.next) V.contact.m_toiFlag = !1, V.contact.m_islandFlag = !1;
                            }
                            if (this.m_contactManager.FindNewContacts(), this.m_subStepping) {
                                this.m_stepComplete = !1;
                                break;
                            }
                        } else a.SetEnabled(!1), M.m_sweep.Copy(P), R.m_sweep.Copy(I), M.SynchronizeTransform(), 
                        R.SynchronizeTransform();
                    }
                }, e.prototype.AddController = function(t) {
                    return t.m_next = this.m_controllerList, t.m_prev = null, this.m_controllerList && (this.m_controllerList.m_prev = t), 
                    this.m_controllerList = t, ++this.m_controllerCount, t;
                }, e.prototype.RemoveController = function(t) {
                    return t.m_prev && (t.m_prev.m_next = t.m_next), t.m_next && (t.m_next.m_prev = t.m_prev), 
                    this.m_controllerList === t && (this.m_controllerList = t.m_next), --this.m_controllerCount, 
                    t.m_prev = null, t.m_next = null, t;
                }, e.Step_s_step = new un(), e.Step_s_stepTimer = new z(), e.Step_s_timer = new z(), 
                e.DrawDebugData_s_color = new G(0, 0, 0), e.DrawDebugData_s_vs = P.MakeArray(4), 
                e.DrawDebugData_s_xf = new F(), e.QueryFixtureShape_s_aabb = new St(), e.RayCast_s_input = new Ct(), 
                e.RayCast_s_output = new bt(), e.RayCast_s_point = new P(), e.DrawJoint_s_p1 = new P(), 
                e.DrawJoint_s_p2 = new P(), e.DrawJoint_s_color = new G(.5, .8, .8), e.DrawJoint_s_c = new G(), 
                e.DrawShape_s_ghostColor = new G(), e.SolveTOI_s_subStep = new un(), e.SolveTOI_s_backup = new N(), 
                e.SolveTOI_s_backup1 = new N(), e.SolveTOI_s_backup2 = new N(), e.SolveTOI_s_toi_input = new jt(), 
                e.SolveTOI_s_toi_output = new Xt(), e;
            }(), qn = function(t, e) {
                this.prevBody = null, this.nextBody = null, this.prevController = null, this.nextController = null, 
                this.controller = t, this.body = e;
            }, Xn = function() {
                function t() {
                    this.m_bodyList = null, this.m_bodyCount = 0, this.m_prev = null, this.m_next = null;
                }
                return t.prototype.GetNext = function() {
                    return this.m_next;
                }, t.prototype.GetPrev = function() {
                    return this.m_prev;
                }, t.prototype.GetBodyList = function() {
                    return this.m_bodyList;
                }, t.prototype.AddBody = function(t) {
                    var e = new qn(this, t);
                    e.nextBody = this.m_bodyList, e.prevBody = null, this.m_bodyList && (this.m_bodyList.prevBody = e), 
                    this.m_bodyList = e, ++this.m_bodyCount, e.nextController = t.m_controllerList, 
                    e.prevController = null, t.m_controllerList && (t.m_controllerList.prevController = e), 
                    t.m_controllerList = e, ++t.m_controllerCount;
                }, t.prototype.RemoveBody = function(t) {
                    if (this.m_bodyCount <= 0) throw new Error();
                    for (var e = this.m_bodyList; e && e.body !== t; ) e = e.nextBody;
                    if (null === e) throw new Error();
                    e.prevBody && (e.prevBody.nextBody = e.nextBody), e.nextBody && (e.nextBody.prevBody = e.prevBody), 
                    this.m_bodyList === e && (this.m_bodyList = e.nextBody), --this.m_bodyCount, e.nextController && (e.nextController.prevController = e.prevController), 
                    e.prevController && (e.prevController.nextController = e.nextController), t.m_controllerList === e && (t.m_controllerList = e.nextController), 
                    --t.m_controllerCount;
                }, t.prototype.Clear = function() {
                    for (;this.m_bodyList; ) this.RemoveBody(this.m_bodyList.body);
                    this.m_bodyCount = 0;
                }, t;
            }(), Yn = function(t) {
                function e() {
                    var e = null !== t && t.apply(this, arguments) || this;
                    return e.normal = new P(0, 1), e.offset = 0, e.density = 0, e.velocity = new P(0, 0), 
                    e.linearDrag = 0, e.angularDrag = 0, e.useDensity = !1, e.useWorldGravity = !0, 
                    e.gravity = new P(0, 0), e;
                }
                return ti(e, t), e.prototype.Step = function() {
                    if (this.m_bodyList) {
                        this.useWorldGravity && this.gravity.Copy(this.m_bodyList.body.GetWorld().GetGravity());
                        for (var t = this.m_bodyList; t; t = t.nextBody) {
                            var e = t.body;
                            if (e.IsAwake()) {
                                for (var i = new P(), r = new P(), s = 0, o = 0, a = e.GetFixtureList(); a; a = a.m_next) {
                                    var c = new P(), l = a.GetShape().ComputeSubmergedArea(this.normal, this.offset, e.GetTransform(), c);
                                    s += l, i.x += l * c.x, i.y += l * c.y;
                                    var u;
                                    o += l * (u = this.useDensity ? a.GetDensity() : 1), r.x += l * c.x * u, r.y += l * c.y * u;
                                }
                                if (i.x /= s, i.y /= s, r.x /= o, r.y /= o, !(s < n)) {
                                    var h = this.gravity.Clone().SelfNeg();
                                    h.SelfMul(this.density * s), e.ApplyForce(h, r);
                                    var _ = e.GetLinearVelocityFromWorldPoint(i, new P());
                                    _.SelfSub(this.velocity), _.SelfMul(-this.linearDrag * s), e.ApplyForce(_, i), e.ApplyTorque(-e.GetInertia() / e.GetMass() * s * e.GetAngularVelocity() * this.angularDrag);
                                }
                            }
                        }
                    }
                }, e.prototype.Draw = function(t) {
                    var e = 100, i = new P(), n = new P();
                    i.x = this.normal.x * this.offset + this.normal.y * e, i.y = this.normal.y * this.offset - this.normal.x * e, 
                    n.x = this.normal.x * this.offset - this.normal.y * e, n.y = this.normal.y * this.offset + this.normal.x * e;
                    var r = new G(0, 0, .8);
                    t.DrawSegment(i, n, r);
                }, e;
            }(Xn), Jn = function(t) {
                function e() {
                    var e = null !== t && t.apply(this, arguments) || this;
                    return e.A = new P(0, 0), e;
                }
                return ti(e, t), e.prototype.Step = function(t) {
                    for (var i = P.MulSV(t.dt, this.A, e.Step_s_dtA), n = this.m_bodyList; n; n = n.nextBody) {
                        var r = n.body;
                        r.IsAwake() && r.SetLinearVelocity(P.AddVV(r.GetLinearVelocity(), i, P.s_t0));
                    }
                }, e.prototype.Draw = function() {}, e.Step_s_dtA = new P(), e;
            }(Xn), Zn = function(t) {
                function e() {
                    var e = null !== t && t.apply(this, arguments) || this;
                    return e.F = new P(0, 0), e;
                }
                return ti(e, t), e.prototype.Step = function() {
                    for (var t = this.m_bodyList; t; t = t.nextBody) {
                        var e = t.body;
                        e.IsAwake() && e.ApplyForce(this.F, e.GetWorldCenter());
                    }
                }, e.prototype.Draw = function() {}, e;
            }(Xn), Kn = function(t) {
                function e() {
                    var e = null !== t && t.apply(this, arguments) || this;
                    return e.G = 1, e.invSqr = !0, e;
                }
                return ti(e, t), e.prototype.Step = function() {
                    if (this.invSqr) for (var t = this.m_bodyList; t; t = t.nextBody) for (var i = (c = t.body).GetWorldCenter(), r = c.GetMass(), s = this.m_bodyList; s && s !== t; s = s.nextBody) {
                        var o = (l = s.body).GetWorldCenter(), a = l.GetMass();
                        (_ = (u = o.x - i.x) * u + (h = o.y - i.y) * h) < n || ((f = e.Step_s_f.Set(u, h)).SelfMul(this.G / _ / S(_) * r * a), 
                        c.IsAwake() && c.ApplyForce(f, i), l.IsAwake() && l.ApplyForce(f.SelfMul(-1), o));
                    } else for (t = this.m_bodyList; t; t = t.nextBody) {
                        var c;
                        for (i = (c = t.body).GetWorldCenter(), r = c.GetMass(), s = this.m_bodyList; s && s !== t; s = s.nextBody) {
                            var l, u, h, _, f;
                            o = (l = s.body).GetWorldCenter(), a = l.GetMass(), (_ = (u = o.x - i.x) * u + (h = o.y - i.y) * h) < n || ((f = e.Step_s_f.Set(u, h)).SelfMul(this.G / _ * r * a), 
                            c.IsAwake() && c.ApplyForce(f, i), l.IsAwake() && l.ApplyForce(f.SelfMul(-1), o));
                        }
                    }
                }, e.prototype.Draw = function() {}, e.Step_s_f = new P(), e;
            }(Xn), Qn = function(t) {
                function e() {
                    var e = null !== t && t.apply(this, arguments) || this;
                    return e.T = new V(), e.maxTimestep = 0, e;
                }
                return ti(e, t), e.prototype.Step = function(t) {
                    var i = t.dt;
                    if (!(i <= n)) {
                        i > this.maxTimestep && this.maxTimestep > 0 && (i = this.maxTimestep);
                        for (var r = this.m_bodyList; r; r = r.nextBody) {
                            var s = r.body;
                            if (s.IsAwake()) {
                                var o = s.GetWorldVector(V.MulMV(this.T, s.GetLocalVector(s.GetLinearVelocity(), P.s_t0), P.s_t1), e.Step_s_damping);
                                s.SetLinearVelocity(P.AddVV(s.GetLinearVelocity(), P.MulSV(i, o, P.s_t0), P.s_t1));
                            }
                        }
                    }
                }, e.prototype.Draw = function() {}, e.prototype.SetAxisAligned = function(t, e) {
                    this.T.ex.x = -t, this.T.ex.y = 0, this.T.ey.x = 0, this.T.ey.y = -e, this.maxTimestep = t > 0 || e > 0 ? 1 / y(t, e) : 0;
                }, e.Step_s_damping = new P(), e;
            }(Xn), $n = function() {
                function t() {
                    this.m_count = 0, this.m_ps = [], this.m_p0s = [], this.m_vs = [], this.m_ims = [], 
                    this.m_Ls = [], this.m_as = [], this.m_gravity = new P(), this.m_damping = 0, this.m_k2 = 1, 
                    this.m_k3 = .1;
                }
                return t.prototype.GetVertexCount = function() {
                    return this.m_count;
                }, t.prototype.GetVertices = function() {
                    return this.m_ps;
                }, t.prototype.Initialize = function(t) {
                    this.m_count = t.count, this.m_ps = P.MakeArray(this.m_count), this.m_p0s = P.MakeArray(this.m_count), 
                    this.m_vs = P.MakeArray(this.m_count), this.m_ims = p(this.m_count);
                    for (var e = 0; e < this.m_count; ++e) {
                        this.m_ps[e].Copy(t.vertices[e]), this.m_p0s[e].Copy(t.vertices[e]), this.m_vs[e].SetZero();
                        var i = t.masses[e];
                        this.m_ims[e] = i > 0 ? 1 / i : 0;
                    }
                    var n = this.m_count - 1, r = this.m_count - 2;
                    for (this.m_Ls = p(n), this.m_as = p(r), e = 0; e < n; ++e) {
                        var s = this.m_ps[e], o = this.m_ps[e + 1];
                        this.m_Ls[e] = P.DistanceVV(s, o);
                    }
                    for (e = 0; e < r; ++e) {
                        s = this.m_ps[e], o = this.m_ps[e + 1];
                        var a = this.m_ps[e + 2], c = P.SubVV(o, s, P.s_t0), l = P.SubVV(a, o, P.s_t1), u = P.CrossVV(c, l), h = P.DotVV(c, l);
                        this.m_as[e] = R(u, h);
                    }
                    this.m_gravity.Copy(t.gravity), this.m_damping = t.damping, this.m_k2 = t.k2, this.m_k3 = t.k3;
                }, t.prototype.Step = function(t, e) {
                    if (0 !== t) {
                        for (var i = Math.exp(-t * this.m_damping), n = 0; n < this.m_count; ++n) this.m_p0s[n].Copy(this.m_ps[n]), 
                        this.m_ims[n] > 0 && this.m_vs[n].SelfMulAdd(t, this.m_gravity), this.m_vs[n].SelfMul(i), 
                        this.m_ps[n].SelfMulAdd(t, this.m_vs[n]);
                        for (n = 0; n < e; ++n) this.SolveC2(), this.SolveC3(), this.SolveC2();
                        var r = 1 / t;
                        for (n = 0; n < this.m_count; ++n) P.MulSV(r, P.SubVV(this.m_ps[n], this.m_p0s[n], P.s_t0), this.m_vs[n]);
                    }
                }, t.prototype.SolveC2 = function() {
                    for (var e = this.m_count - 1, i = 0; i < e; ++i) {
                        var n = this.m_ps[i], r = this.m_ps[i + 1], s = P.SubVV(r, n, t.s_d), o = s.Normalize(), a = this.m_ims[i], c = this.m_ims[i + 1];
                        if (a + c !== 0) {
                            var l = a / (a + c), u = c / (a + c);
                            n.SelfMulSub(this.m_k2 * l * (this.m_Ls[i] - o), s), r.SelfMulAdd(this.m_k2 * u * (this.m_Ls[i] - o), s);
                        }
                    }
                }, t.prototype.SetAngle = function(t) {
                    for (var e = this.m_count - 2, i = 0; i < e; ++i) this.m_as[i] = t;
                }, t.prototype.SolveC3 = function() {
                    for (var e = this.m_count - 2, i = 0; i < e; ++i) {
                        var n = this.m_ps[i], r = this.m_ps[i + 1], o = this.m_ps[i + 2], a = this.m_ims[i], c = this.m_ims[i + 1], l = this.m_ims[i + 2], u = P.SubVV(r, n, t.s_d1), h = P.SubVV(o, r, t.s_d2), _ = u.LengthSquared(), f = h.LengthSquared();
                        if (_ * f != 0) {
                            var d = P.CrossVV(u, h), p = P.DotVV(u, h), m = R(d, p), v = P.MulSV(-1 / _, u.SelfSkew(), t.s_Jd1), y = P.MulSV(1 / f, h.SelfSkew(), t.s_Jd2), g = P.NegV(v, t.s_J1), x = P.SubVV(v, y, t.s_J2), A = y, C = a * P.DotVV(g, g) + c * P.DotVV(x, x) + l * P.DotVV(A, A);
                            if (0 !== C) {
                                C = 1 / C;
                                for (var b = m - this.m_as[i]; b > s; ) b = (m -= 2 * s) - this.m_as[i];
                                for (;b < -s; ) b = (m += 2 * s) - this.m_as[i];
                                var S = -this.m_k3 * C * b;
                                n.SelfMulAdd(a * S, g), r.SelfMulAdd(c * S, x), o.SelfMulAdd(l * S, A);
                            }
                        }
                    }
                }, t.prototype.Draw = function(t) {
                    for (var e = new G(.4, .5, .7), i = 0; i < this.m_count - 1; ++i) t.DrawSegment(this.m_ps[i], this.m_ps[i + 1], e);
                }, t.s_d = new P(), t.s_d1 = new P(), t.s_d2 = new P(), t.s_Jd1 = new P(), t.s_Jd2 = new P(), 
                t.s_J1 = new P(), t.s_J2 = new P(), t;
            }();
            t.b2Assert = function(t) {
                for (var e = [], i = 1; i < arguments.length; i++) e[i - 1] = arguments[i];
                if (!t) throw new (Error.bind.apply(Error, [ void 0 ].concat(e)))();
            }, t.b2Maybe = e, t.b2_maxFloat = i, t.b2_epsilon = n, t.b2_epsilon_sq = r, t.b2_pi = s, 
            t.b2_maxManifoldPoints = o, t.b2_maxPolygonVertices = a, t.b2_aabbExtension = .1, 
            t.b2_aabbMultiplier = 2, t.b2_linearSlop = c, t.b2_angularSlop = l, t.b2_polygonRadius = u, 
            t.b2_maxSubSteps = 8, t.b2_maxTOIContacts = 32, t.b2_velocityThreshold = 1, t.b2_maxLinearCorrection = .2, 
            t.b2_maxAngularCorrection = .13962634015955555, t.b2_maxTranslation = 2, t.b2_maxTranslationSquared = 4, 
            t.b2_maxRotation = 1.570796326795, t.b2_maxRotationSquared = 2.4674011002726646, 
            t.b2_baumgarte = .2, t.b2_toiBaumgarte = .75, t.b2_invalidParticleIndex = h, t.b2_maxParticleIndex = 2147483647, 
            t.b2_particleStride = .75, t.b2_minParticleWeight = 1, t.b2_maxParticlePressure = .25, 
            t.b2_maxParticleForce = .5, t.b2_maxTriadDistance = 2, t.b2_maxTriadDistanceSquared = 4, 
            t.b2_minParticleSystemBufferCapacity = 256, t.b2_barrierCollisionTime = 2.5, t.b2_timeToSleep = .5, 
            t.b2_linearSleepTolerance = .01, t.b2_angularSleepTolerance = .03490658503988889, 
            t.b2Alloc = function() {
                return null;
            }, t.b2Free = function() {}, t.b2Log = function(t) {
                for (var e = [], i = 1; i < arguments.length; i++) e[i - 1] = arguments[i];
            }, t.b2Version = _, t.b2_version = f, t.b2_branch = "master", t.b2_commit = "fbf51801d80fc389d43dc46524520e89043b6faf", 
            t.b2ParseInt = function(t) {
                return parseInt(t, 10);
            }, t.b2ParseUInt = function(t) {
                return Math.abs(parseInt(t, 10));
            }, t.b2MakeArray = d, t.b2MakeNullArray = function(t) {
                for (var e = [], i = 0; i < t; ++i) e.push(null);
                return e;
            }, t.b2MakeNumberArray = p, t.b2_pi_over_180 = .017453292519944444, t.b2_180_over_pi = 57.29577951307855, 
            t.b2_two_pi = 6.28318530718, t.b2Abs = m, t.b2Min = v, t.b2Max = y, t.b2Clamp = g, 
            t.b2Swap = function(t, e) {
                var i = t[0];
                t[0] = e[0], e[0] = i;
            }, t.b2IsValid = x, t.b2Sq = A, t.b2InvSqrt = C, t.b2Sqrt = S, t.b2Pow = T, t.b2DegToRad = function(t) {
                return .017453292519944444 * t;
            }, t.b2RadToDeg = function(t) {
                return 57.29577951307855 * t;
            }, t.b2Cos = w, t.b2Sin = E, t.b2Acos = B, t.b2Asin = M, t.b2Atan2 = R, t.b2NextPowerOfTwo = function(t) {
                return t |= t >> 1 & 2147483647, t |= t >> 2 & 1073741823, t |= t >> 4 & 268435455, 
                1 + ((t |= t >> 8 & 16777215) | t >> 16 & 65535);
            }, t.b2IsPowerOfTwo = function(t) {
                return t > 0 && 0 == (t & t - 1);
            }, t.b2Random = function() {
                return 2 * Math.random() - 1;
            }, t.b2RandomRange = function(t, e) {
                return (e - t) * Math.random() + t;
            }, t.b2Vec2 = P, t.b2Vec2_zero = I, t.b2Vec3 = D, t.b2Mat22 = V, t.b2Mat33 = L, 
            t.b2Rot = O, t.b2Transform = F, t.b2Sweep = N, t.b2Color = G, t.b2Draw = k, t.b2Timer = z, 
            t.b2Counter = U, t.b2GrowableStack = H, t.b2BlockAllocator = function() {}, t.b2StackAllocator = function() {}, 
            t.b2ContactFeature = pt, t.b2ContactID = mt, t.b2ManifoldPoint = vt, t.b2Manifold = gt, 
            t.b2WorldManifold = xt, t.b2GetPointStates = function(e, i, n, r) {
                var s;
                for (s = 0; s < n.pointCount; ++s) {
                    var a = n.points[s].id.key;
                    e[s] = t.b2PointState.b2_removeState;
                    for (var c = 0, l = r.pointCount; c < l; ++c) if (r.points[c].id.key === a) {
                        e[s] = t.b2PointState.b2_persistState;
                        break;
                    }
                }
                for (;s < o; ++s) e[s] = t.b2PointState.b2_nullState;
                for (s = 0; s < r.pointCount; ++s) for (a = r.points[s].id.key, i[s] = t.b2PointState.b2_addState, 
                c = 0, l = n.pointCount; c < l; ++c) if (n.points[c].id.key === a) {
                    i[s] = t.b2PointState.b2_persistState;
                    break;
                }
                for (;s < o; ++s) i[s] = t.b2PointState.b2_nullState;
            }, t.b2ClipVertex = At, t.b2RayCastInput = Ct, t.b2RayCastOutput = bt, t.b2AABB = St, 
            t.b2TestOverlapAABB = Tt, t.b2ClipSegmentToLine = wt, t.b2TestOverlapShape = Rt, 
            t.b2DistanceProxy = W, t.b2SimplexCache = j, t.b2DistanceInput = q, t.b2DistanceOutput = X, 
            t.b2ShapeCastInput = function() {
                this.proxyA = new W(), this.proxyB = new W(), this.transformA = new F(), this.transformB = new F(), 
                this.translationB = new P();
            }, t.b2ShapeCastOutput = function() {
                this.point = new P(), this.normal = new P(), this.lambda = 0, this.iterations = 0;
            }, t.b2_gjk_reset = function() {
                t.b2_gjkCalls = 0, t.b2_gjkIters = 0, t.b2_gjkMaxIters = 0;
            }, t.b2SimplexVertex = Y, t.b2Simplex = J, t.b2Distance = rt, t.b2ShapeCast = function(t, e) {
                t.iterations = 0, t.lambda = 1, t.normal.SetZero(), t.point.SetZero();
                var i = e.proxyA, n = e.proxyB, r = y(i.m_radius, u) + y(n.m_radius, u), s = e.transformA, o = e.transformB, a = e.translationB, l = ot.Set(0, 0), h = 0, _ = at;
                _.m_count = 0;
                for (var f = _.m_vertices, d = i.GetSupport(O.MulTRV(s.q, P.NegV(a, P.s_t1), P.s_t0)), p = F.MulXV(s, i.GetVertex(d), ct), v = n.GetSupport(O.MulTRV(o.q, a, P.s_t0)), g = F.MulXV(o, n.GetVertex(v), lt), x = P.SubVV(p, g, ut), A = y(u, r - u), C = .5 * c, b = 0; b < 20 && m(x.Length() - A) > C; ) {
                    t.iterations += 1, d = i.GetSupport(O.MulTRV(s.q, P.NegV(x, P.s_t1), P.s_t0)), p = F.MulXV(s, i.GetVertex(d), ct), 
                    v = n.GetSupport(O.MulTRV(o.q, x, P.s_t0)), g = F.MulXV(o, n.GetVertex(v), lt);
                    var S = P.SubVV(p, g, ht);
                    x.Normalize();
                    var T = P.DotVV(x, S), w = P.DotVV(x, a);
                    if (T - A > h * w) {
                        if (w <= 0) return !1;
                        if ((h = (T - A) / w) > 1) return !1;
                        l.Copy(x).SelfNeg(), _.m_count = 0;
                    }
                    var E = f[_.m_count];
                    switch (E.indexA = v, E.wA.Copy(g).SelfMulAdd(h, a), E.indexB = d, E.wB.Copy(p), 
                    E.w.Copy(E.wB).SelfSub(E.wA), E.a = 1, _.m_count += 1, _.m_count) {
                      case 1:
                        break;

                      case 2:
                        _.Solve2();
                        break;

                      case 3:
                        _.Solve3();
                    }
                    if (3 === _.m_count) return !1;
                    _.GetClosestPoint(x), ++b;
                }
                var B = _t, M = ft;
                return _.GetWitnessPoints(B, M), x.LengthSquared() > 0 && (l.Copy(x).SelfNeg(), 
                l.Normalize()), t.normal.Copy(l), t.lambda = h, t.iterations = b, !0;
            }, t.b2Pair = Vt, t.b2BroadPhase = Lt, t.b2PairLessThan = Ot, t.b2TreeNode = It, 
            t.b2DynamicTree = Dt, t.b2_toi_reset = function() {
                t.b2_toiTime = 0, t.b2_toiMaxTime = 0, t.b2_toiCalls = 0, t.b2_toiIters = 0, t.b2_toiMaxIters = 0, 
                t.b2_toiRootIters = 0, t.b2_toiMaxRootIters = 0;
            }, t.b2TOIInput = jt, t.b2TOIOutput = Xt, t.b2SeparationFunction = Yt, t.b2TimeOfImpact = re, 
            t.b2CollideCircles = ae, t.b2CollidePolygonAndCircle = he, t.b2CollidePolygons = Le, 
            t.b2CollideEdgeAndCircle = We, t.b2CollideEdgeAndPolygon = Je, t.b2MassData = Ke, 
            t.b2Shape = Qe, t.b2CircleShape = ii, t.b2PolygonShape = ni, t.b2EdgeShape = ri, 
            t.b2ChainShape = si, t.b2Filter = oi, t.b2FixtureDef = ai, t.b2FixtureProxy = ci, 
            t.b2Fixture = li, t.b2BodyDef = function() {
                this.type = t.b2BodyType.b2_staticBody, this.position = new P(0, 0), this.angle = 0, 
                this.linearVelocity = new P(0, 0), this.angularVelocity = 0, this.linearDamping = 0, 
                this.angularDamping = 0, this.allowSleep = !0, this.awake = !0, this.fixedRotation = !1, 
                this.bullet = !1, this.active = !0, this.userData = null, this.gravityScale = 1;
            }, t.b2Body = _i, t.b2World = jn, t.b2DestructionListener = en, t.b2ContactFilter = nn, 
            t.b2ContactImpulse = rn, t.b2ContactListener = sn, t.b2QueryCallback = on, t.b2RayCastCallback = an, 
            t.b2Island = xn, t.b2Profile = ln, t.b2TimeStep = un, t.b2Position = hn, t.b2Velocity = _n, 
            t.b2SolverData = fn, t.b2ContactManager = cn, t.b2MixFriction = zi, t.b2MixRestitution = Ui, 
            t.b2ContactEdge = Wi, t.b2Contact = ji, t.b2ContactRegister = $i, t.b2ContactFactory = tn, 
            t.g_blockSolve = !1, t.b2VelocityConstraintPoint = dn, t.b2ContactVelocityConstraint = pn, 
            t.b2ContactPositionConstraint = mn, t.b2ContactSolverDef = vn, t.b2PositionSolverManifold = yn, 
            t.b2ContactSolver = gn, t.b2CircleContact = qi, t.b2PolygonContact = Xi, t.b2PolygonAndCircleContact = Yi, 
            t.b2EdgeAndCircleContact = Ji, t.b2EdgeAndPolygonContact = Zi, t.b2ChainAndCircleContact = Ki, 
            t.b2ChainAndPolygonContact = Qi, t.b2Jacobian = fi, t.b2JointEdge = di, t.b2JointDef = pi, 
            t.b2Joint = mi, t.b2AreaJointDef = gi, t.b2AreaJoint = xi, t.b2DistanceJointDef = vi, 
            t.b2DistanceJoint = yi, t.b2FrictionJointDef = Ai, t.b2FrictionJoint = Ci, t.b2GearJointDef = bi, 
            t.b2GearJoint = Si, t.b2MotorJointDef = Ti, t.b2MotorJoint = wi, t.b2MouseJointDef = Ei, 
            t.b2MouseJoint = Bi, t.b2PrismaticJointDef = Mi, t.b2PrismaticJoint = Ri, t.b2_minPulleyLength = 2, 
            t.b2PulleyJointDef = Pi, t.b2PulleyJoint = Ii, t.b2RevoluteJointDef = Di, t.b2RevoluteJoint = Vi, 
            t.b2RopeJointDef = Li, t.b2RopeJoint = Oi, t.b2WeldJointDef = Fi, t.b2WeldJoint = Ni, 
            t.b2WheelJointDef = Gi, t.b2WheelJoint = ki, t.b2ControllerEdge = qn, t.b2Controller = Xn, 
            t.b2BuoyancyController = Yn, t.b2ConstantAccelController = Jn, t.b2ConstantForceController = Zn, 
            t.b2GravityController = Kn, t.b2TensorDampingController = Qn, t.b2ParticleDef = An, 
            t.b2CalculateParticleIterations = Cn, t.b2ParticleHandle = Sn, t.b2ParticleGroupDef = Tn, 
            t.b2ParticleGroup = wn, t.b2GrowableBuffer = Nn, t.b2FixtureParticleQueryCallback = Gn, 
            t.b2ParticleContact = kn, t.b2ParticleBodyContact = zn, t.b2ParticlePair = Un, t.b2ParticleTriad = Hn, 
            t.b2ParticleSystemDef = Wn, t.b2RopeDef = function() {
                this.vertices = [], this.count = 0, this.masses = [], this.gravity = new P(0, 0), 
                this.damping = .1, this.k2 = .9, this.k3 = .1;
            }, t.b2Rope = $n, Object.defineProperty(t, "__esModule", {
                value: !0
            });
        }, "object" == typeof i && void 0 !== e ? n(i) : "function" == typeof define && define.amd ? define([ "exports" ], n) : n((void 0).box2d = {});
    }, {} ],
    328: [ function(t, e) {
        "use strict";
        var i = "undefined" == typeof window ? global : window;
        i.cc = i.cc || {}, cc.internal = cc.internal || {}, t("./predefine"), t("./polyfill/string"), 
        t("./polyfill/misc"), t("./polyfill/array"), t("./polyfill/object"), t("./polyfill/array-buffer"), 
        t("./polyfill/number"), t("./polyfill/typescript"), t("./cocos2d/core/predefine"), 
        t("./cocos2d"), t("./extends"), e.exports = i.cc;
    }, {
        "./cocos2d": 284,
        "./cocos2d/core/predefine": 207,
        "./extends": 325,
        "./package": void 0,
        "./polyfill/array": 330,
        "./polyfill/array-buffer": 329,
        "./polyfill/misc": 331,
        "./polyfill/number": 332,
        "./polyfill/object": 333,
        "./polyfill/string": 334,
        "./polyfill/typescript": 335,
        "./predefine": 336
    } ],
    329: [ function() {
        "use strict";
        if (!ArrayBuffer.isView) {
            var t = Object.getPrototypeOf(Int8Array);
            ArrayBuffer.isView = "function" == typeof t ? function(e) {
                return e instanceof t;
            } : function(t) {
                if ("object" != typeof t) return !1;
                var e = t.constructor;
                return e === Float64Array || e === Float32Array || e === Uint8Array || e === Uint32Array || e === Int8Array;
            };
        }
    }, {} ],
    330: [ function() {
        "use strict";
        Array.isArray || (Array.isArray = function(t) {
            return "[object Array]" === Object.prototype.toString.call(t);
        }), Array.prototype.find || (Array.prototype.find = function(t) {
            for (var e = this.length, i = 0; i < e; i++) {
                var n = this[i];
                if (t.call(this, n, i, this)) return n;
            }
        }), Array.prototype.includes || (Array.prototype.includes = function(t) {
            return -1 !== this.indexOf(t);
        });
    }, {} ],
    331: [ function() {
        "use strict";
        if (Math.sign || (Math.sign = function(t) {
            return 0 == (t = +t) || isNaN(t) ? t : t > 0 ? 1 : -1;
        }), Math.log2 || (Math.log2 = function(t) {
            return Math.log(t) * Math.LOG2E;
        }), Number.isInteger || (Number.isInteger = function(t) {
            return "number" == typeof t && isFinite(t) && Math.floor(t) === t;
        }), !console.time) {
            var t = window.performance || Date, e = Object.create(null);
            console.time = function(i) {
                e[i] = t.now();
            }, console.timeEnd = function(i) {
                var n = e[i], r = t.now() - n;
                console.log(i + ": " + r + "ms");
            };
        }
    }, {} ],
    332: [ function() {
        "use strict";
        Number.parseFloat = Number.parseFloat || parseFloat, Number.parseInt = Number.parseInt || parseInt;
    }, {} ],
    333: [ function() {
        "use strict";
        Object.assign || (Object.assign = function(t, e) {
            return cc.js.mixin(t, e);
        }), Object.getOwnPropertyDescriptors || (Object.getOwnPropertyDescriptors = function(t) {
            var e = {}, i = Object.getOwnPropertyNames(t);
            Object.getOwnPropertySymbols && (i = i.concat(Object.getOwnPropertySymbols(t)));
            for (var n = 0; n < i.length; ++n) {
                var r = i[n];
                e[r] = Object.getOwnPropertyDescriptor(t, r);
            }
            return e;
        });
    }, {} ],
    334: [ function() {
        "use strict";
        String.prototype.startsWith || (String.prototype.startsWith = function(t, e) {
            return e = e || 0, this.lastIndexOf(t, e) === e;
        }), String.prototype.endsWith || (String.prototype.endsWith = function(t, e) {
            (void 0 === e || e > this.length) && (e = this.length), e -= t.length;
            var i = this.indexOf(t, e);
            return -1 !== i && i === e;
        }), String.prototype.trimLeft || (String.prototype.trimLeft = function() {
            return this.replace(/^\s+/, "");
        });
    }, {} ],
    335: [ function() {
        "use strict";
        var t = Object.setPrototypeOf || {
            __proto__: []
        } instanceof Array && function(t, e) {
            t.__proto__ = e;
        } || function(t, e) {
            for (var i in e) e.hasOwnProperty(i) && (t[i] = e[i]);
        };
        window.__extends = function(e, i) {
            function n() {
                this.constructor = e;
            }
            t(e, i), e.prototype = null === i ? Object.create(i) : (n.prototype = i.prototype, 
            new n());
        }, window.__assign = Object.assign || function(t) {
            for (var e, i = 1, n = arguments.length; i < n; i++) for (var r in e = arguments[i]) Object.prototype.hasOwnProperty.call(e, r) && (t[r] = e[r]);
            return t;
        }, window.__rest = function(t, e) {
            var i = {};
            for (var n in t) Object.prototype.hasOwnProperty.call(t, n) && e.indexOf(n) < 0 && (i[n] = t[n]);
            if (null != t && "function" == typeof Object.getOwnPropertySymbols) {
                var r = 0;
                for (n = Object.getOwnPropertySymbols(t); r < n.length; r++) e.indexOf(n[r]) < 0 && Object.prototype.propertyIsEnumerable.call(t, n[r]) && (i[n[r]] = t[n[r]]);
            }
            return i;
        }, window.__decorate = function(t, e, i, n) {
            var r, s = arguments.length, o = s < 3 ? e : null === n ? n = Object.getOwnPropertyDescriptor(e, i) : n;
            if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) o = Reflect.decorate(t, e, i, n); else for (var a = t.length - 1; a >= 0; a--) (r = t[a]) && (o = (s < 3 ? r(o) : s > 3 ? r(e, i, o) : r(e, i)) || o);
            return s > 3 && o && Object.defineProperty(e, i, o), o;
        }, window.__param = function(t, e) {
            return function(i, n) {
                e(i, n, t);
            };
        }, window.__metadata = function(t, e) {
            if ("object" == typeof Reflect && "function" == typeof Reflect.metadata) return Reflect.metadata(t, e);
        }, window.__awaiter = function(t, e, i, n) {
            return new (i || (i = Promise))(function(r, s) {
                function o(t) {
                    try {
                        c(n.next(t));
                    } catch (e) {
                        s(e);
                    }
                }
                function a(t) {
                    try {
                        c(n.throw(t));
                    } catch (e) {
                        s(e);
                    }
                }
                function c(t) {
                    var e;
                    t.done ? r(t.value) : (e = t.value, e instanceof i ? e : new i(function(t) {
                        t(e);
                    })).then(o, a);
                }
                c((n = n.apply(t, e || [])).next());
            });
        }, window.__generator = function(t, e) {
            var i, n, r, s, o = {
                label: 0,
                sent: function() {
                    if (1 & r[0]) throw r[1];
                    return r[1];
                },
                trys: [],
                ops: []
            };
            return s = {
                next: a(0),
                throw: a(1),
                return: a(2)
            }, "function" == typeof Symbol && (s[Symbol.iterator] = function() {
                return this;
            }), s;
            function a(t) {
                return function(e) {
                    return c([ t, e ]);
                };
            }
            function c(s) {
                if (i) throw new TypeError("Generator is already executing.");
                for (;o; ) try {
                    if (i = 1, n && (r = 2 & s[0] ? n.return : s[0] ? n.throw || ((r = n.return) && r.call(n), 
                    0) : n.next) && !(r = r.call(n, s[1])).done) return r;
                    switch (n = 0, r && (s = [ 2 & s[0], r.value ]), s[0]) {
                      case 0:
                      case 1:
                        r = s;
                        break;

                      case 4:
                        return o.label++, {
                            value: s[1],
                            done: !1
                        };

                      case 5:
                        o.label++, n = s[1], s = [ 0 ];
                        continue;

                      case 7:
                        s = o.ops.pop(), o.trys.pop();
                        continue;

                      default:
                        if (!(r = (r = o.trys).length > 0 && r[r.length - 1]) && (6 === s[0] || 2 === s[0])) {
                            o = 0;
                            continue;
                        }
                        if (3 === s[0] && (!r || s[1] > r[0] && s[1] < r[3])) {
                            o.label = s[1];
                            break;
                        }
                        if (6 === s[0] && o.label < r[1]) {
                            o.label = r[1], r = s;
                            break;
                        }
                        if (r && o.label < r[2]) {
                            o.label = r[2], o.ops.push(s);
                            break;
                        }
                        r[2] && o.ops.pop(), o.trys.pop();
                        continue;
                    }
                    s = e.call(t, o);
                } catch (a) {
                    s = [ 6, a ], n = 0;
                } finally {
                    i = r = 0;
                }
                if (5 & s[0]) throw s[1];
                return {
                    value: s[0] ? s[1] : void 0,
                    done: !0
                };
            }
        }, window.__exportStar = function(t, e) {
            for (var i in t) "default" === i || e.hasOwnProperty(i) || __createBinding(e, t, i);
        }, window.__createBinding = Object.create ? function(t, e, i, n) {
            void 0 === n && (n = i), Object.defineProperty(t, n, {
                enumerable: !0,
                get: function() {
                    return e[i];
                }
            });
        } : function(t, e, i, n) {
            void 0 === n && (n = i), t[n] = e[i];
        }, window.__values = function(t) {
            var e = "function" == typeof Symbol && Symbol.iterator, i = e && t[e], n = 0;
            if (i) return i.call(t);
            if (t && "number" == typeof t.length) return {
                next: function() {
                    return t && n >= t.length && (t = void 0), {
                        value: t && t[n++],
                        done: !t
                    };
                }
            };
            throw new TypeError(e ? "Object is not iterable." : "Symbol.iterator is not defined.");
        }, window.__read = function(t, e) {
            var i = "function" == typeof Symbol && t[Symbol.iterator];
            if (!i) return t;
            var n, r, s = i.call(t), o = [];
            try {
                for (;(void 0 === e || e-- > 0) && !(n = s.next()).done; ) o.push(n.value);
            } catch (a) {
                r = {
                    error: a
                };
            } finally {
                try {
                    n && !n.done && (i = s.return) && i.call(s);
                } finally {
                    if (r) throw r.error;
                }
            }
            return o;
        }, window.__spread = function() {
            for (var t = [], e = 0; e < arguments.length; e++) t = t.concat(__read(arguments[e]));
            return t;
        }, window.__spreadArrays = function() {
            for (var t = 0, e = 0, i = arguments.length; e < i; e++) t += arguments[e].length;
            var n = Array(t), r = 0;
            for (e = 0; e < i; e++) for (var s = arguments[e], o = 0, a = s.length; o < a; o++, 
            r++) n[r] = s[o];
            return n;
        }, window.__await = function(t) {
            return this instanceof __await ? (this.v = t, this) : new __await(t);
        }, window.__asyncGenerator = function(t, e, i) {
            if (!Symbol.asyncIterator) throw new TypeError("Symbol.asyncIterator is not defined.");
            var n, r = i.apply(t, e || []), s = [];
            return n = {}, o("next"), o("throw"), o("return"), n[Symbol.asyncIterator] = function() {
                return this;
            }, n;
            function o(t) {
                r[t] && (n[t] = function(e) {
                    return new Promise(function(i, n) {
                        s.push([ t, e, i, n ]) > 1 || a(t, e);
                    });
                });
            }
            function a(t, e) {
                try {
                    (i = r[t](e)).value instanceof __await ? Promise.resolve(i.value.v).then(c, l) : u(s[0][2], i);
                } catch (n) {
                    u(s[0][3], n);
                }
                var i;
            }
            function c(t) {
                a("next", t);
            }
            function l(t) {
                a("throw", t);
            }
            function u(t, e) {
                t(e), s.shift(), s.length && a(s[0][0], s[0][1]);
            }
        }, window.__asyncDelegator = function(t) {
            var e, i;
            return e = {}, n("next"), n("throw", function(t) {
                throw t;
            }), n("return"), e[Symbol.iterator] = function() {
                return this;
            }, e;
            function n(n, r) {
                e[n] = t[n] ? function(e) {
                    return (i = !i) ? {
                        value: __await(t[n](e)),
                        done: "return" === n
                    } : r ? r(e) : e;
                } : r;
            }
        }, window.__asyncValues = function(t) {
            if (!Symbol.asyncIterator) throw new TypeError("Symbol.asyncIterator is not defined.");
            var e, i = t[Symbol.asyncIterator];
            return i ? i.call(t) : (t = "function" == typeof __values ? __values(t) : t[Symbol.iterator](), 
            e = {}, n("next"), n("throw"), n("return"), e[Symbol.asyncIterator] = function() {
                return this;
            }, e);
            function n(i) {
                e[i] = t[i] && function(e) {
                    return new Promise(function(n, s) {
                        r(n, s, (e = t[i](e)).done, e.value);
                    });
                };
            }
            function r(t, e, i, n) {
                Promise.resolve(n).then(function(e) {
                    t({
                        value: e,
                        done: i
                    });
                }, e);
            }
        }, window.__makeTemplateObject = function(t, e) {
            return Object.defineProperty ? Object.defineProperty(t, "raw", {
                value: e
            }) : t.raw = e, t;
        };
        var e = Object.create ? function(t, e) {
            Object.defineProperty(t, "default", {
                enumerable: !0,
                value: e
            });
        } : function(t, e) {
            t.default = e;
        };
        window.__importStar = function(t) {
            if (t && t.__esModule) return t;
            var i = {};
            if (null != t) for (var n in t) Object.hasOwnProperty.call(t, n) && __createBinding(i, t, n);
            return e(i, t), i;
        }, window.__importDefault = function(t) {
            return t && t.__esModule ? t : {
                default: t
            };
        }, window.__classPrivateFieldGet = function(t, e) {
            if (!e.has(t)) throw new TypeError("attempted to get private field on non-instance");
            return e.get(t);
        }, window.__classPrivateFieldSet = function(t, e, i) {
            if (!e.has(t)) throw new TypeError("attempted to set private field on non-instance");
            return e.set(t, i), i;
        };
    }, {} ],
    336: [ function() {
        "use strict";
        var t = "undefined" == typeof window ? global : window;
        function e(e, i) {
            void 0 === t[e] && Object.defineProperty(t, e, {
                get: function() {
                    var t;
                    return "CC_WECHATGAMESUB" === e ? t = "cc.sys.platform === cc.sys.WECHAT_GAME_SUB" : "CC_WECHATGAME" === e ? t = "cc.sys.platform === cc.sys.WECHAT_GAME" : "CC_QQPLAY" === e && (t = "cc.sys.platform === cc.sys.QQ_PLAY"), 
                    cc.warnID(1400, e, t), i;
                }
            });
        }
        function i(e) {
            return "object" == typeof t[e];
        }
        (function(e, i) {
            void 0 === t[e] && (t[e] = i);
        })("CC_BUILD", !1), t.CC_BUILD = !0, t.CC_DEV = !1, t.CC_DEBUG = !1, t.CC_JSB = !1, 
        t.CC_NATIVERENDERER = !1, t.CC_SUPPORT_JIT = !1, t.CC_PHYSICS_BUILTIN = !1, t.CC_PHYSICS_CANNON = !1, 
        t.CC_EDITOR = !1, t.CC_PREVIEW = !1, t.CC_TEST = !1, t.CC_RUNTIME = !1, t.CC_JSB = !1;
        var n = !(!i("wx") || !wx.getSharedCanvas), r = !(!i("wx") || !wx.getSystemInfoSync && !wx.getSharedCanvas), s = i("bk");
        e("CC_WECHATGAMESUB", n), e("CC_WECHATGAME", r), e("CC_QQPLAY", s), t.CocosEngine = cc.ENGINE_VERSION = "2.4.3";
    }, {} ]
}, {}, [ 328 ]);